'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1046:function(I,J,d){function m(L,O=self){O.addEventListener("message",function W(Z){if(Z&&Z.data){var {id:P,type:S,path:aa}=Object.assign({path:[]},Z.data),Y=(Z.data.nUh||[]).map(x);try{const ca=aa.slice(0,-1).reduce((ja,ra)=>ja[ra],L),fa=aa.reduce((ja,ra)=>ja[ra],L);switch(S){case "GET":var X=fa;break;case "SET":ca[aa.slice(-1)[0]]=x(Z.data.value);X=!0;break;case "APPLY":X=fa.apply(ca,Y);break;case "CONSTRUCT":const ja=
new fa(...Y);X=Object.assign(ja,{[F]:!0});break;case "ENDPOINT":const {port1:ra,port2:ya}=new MessageChannel;m(L,ya);X=w(ra,[ra]);break;case "RELEASE":X=void 0;break;default:return}}catch(ca){X={value:ca,[C]:0}}Promise.resolve(X).catch(ca=>({value:ca,[C]:0})).then(ca=>{const [fa,ja]=z(ca);O.postMessage(Object.assign(Object.assign({},fa),{id:P}),ja);"RELEASE"===S&&(O.removeEventListener("message",W),"MessagePort"===O.constructor.name&&O.close())})}});O.start&&O.start()}function f(L){if(L)throw Error("Proxy has been released and is not useable");
}function a(L,O=[],V=function(){}){let Z=!1;const W=new Proxy(V,{get(P,S){f(Z);if(S===G)return()=>u(L,{type:"RELEASE",path:O.map(aa=>aa.toString())}).then(()=>{"MessagePort"===L.constructor.name&&L.close();Z=!0});if("then"===S){if(0===O.length)return{then:()=>W};P=u(L,{type:"GET",path:O.map(aa=>aa.toString())}).then(x);return P.then.bind(P)}return a(L,[...O,S])},set(P,S,aa){f(Z);const [Y,X]=z(aa);return u(L,{type:"SET",path:[...O,S].map(ca=>ca.toString()),value:Y},X).then(x)},apply(P,S,aa){f(Z);P=
O[O.length-1];if(P===y)return u(L,{type:"ENDPOINT"}).then(x);if("bind"===P)return a(L,O.slice(0,-1));const [Y,X]=l(aa);return u(L,{type:"APPLY",path:O.map(ca=>ca.toString()),nUh:Y},X).then(x)},construct(P,S){f(Z);const [aa,Y]=l(S);return u(L,{type:"CONSTRUCT",path:O.map(X=>X.toString()),nUh:aa},Y).then(x)}});return W}function l(L){L=L.map(z);return[L.map(O=>O[0]),Array.prototype.concat.apply([],L.map(O=>O[1]))]}function w(L,O){R.set(L,O);return L}function z(L){for(const [O,V]of K)if(V.w_h(L)){const [Z,
W]=V.serialize(L);return[{type:"HANDLER",name:O,value:Z},W]}return[{type:"RAW",value:L},R.get(L)||[]]}function x(L){switch(L.type){case "HANDLER":return K.get(L.name).deserialize(L.value);case "RAW":return L.value}}function u(L,O,V){return new Promise(Z=>{const W=v();L.addEventListener("message",function aa(S){S.data&&S.data.id&&S.data.id===W&&(L.removeEventListener("message",aa),Z(S.data))});L.start&&L.start();L.postMessage(Object.assign({id:W},O),V)})}function v(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}I=d(0);const F=Symbol("Comlink.proxy"),y=Symbol("Comlink.endpoint"),G=Symbol("Comlink.releaseProxy"),C=Symbol("Comlink.thrown"),H=L=>"object"===typeof L&&null!==L||"function"===typeof L,K=new Map([["proxy",{w_h:L=>H(L)&&L[F],serialize(L){const {port1:O,port2:V}=new MessageChannel;m(L,O);return[V,[V]]},deserialize(L){L.start();return a(L,[],void 0)}}],["throw",{w_h:L=>H(L)&&C in L,serialize({value:L}){return[L instanceof Error?
{lXa:!0,value:{message:L.message,name:L.name,stack:L.stack}}:{lXa:!1,value:L},[]]},deserialize(L){if(L.lXa)throw Object.assign(Error(L.value.message),L.value);throw L.value;}}]]),R=new WeakMap;d.d(J,"a",function(){return E});class E{static qmk(L){E.rib=L;E.MTk=a(L,[],void 0)}static get Endpoint(){return E.rib}static get rmk(){return E.MTk}}Object(I.a)(E,"WorkerUtils",null,[])},1057:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}Object(I.a)(m,"WaterlineOverrideSettings",null,[])},
1058:function(I,J,d){I=d(0);var m=d(423),f=d(408),a=d(578),l=d(256),w=d(448);class z extends l.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}en(){return w.a.OGf}static Qea(G,C,H){const K=new z;K.FileId=G;K.HighWaterline=C;K.LowWaterline=H;return K}}Object(I.a)(z,"GetActivitiesRequest",l.a,[]);class x extends l.a{constructor(G,C,H){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=G;this.Waterline=C;this.Settings=H}en(){return w.a.uNf}static Qea(G,C,
H){return new x(G,C,H)}}Object(I.a)(x,"GetRelevantActivitiesRequest",l.a,[]);class u extends l.a{constructor(G,C){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=G;this.WaterlineOverrideSettings=C}en(){return w.a.qTm}static Qea(G,C){return new u(G,C)}}Object(I.a)(u,"GetWywaActivitiesRequest",l.a,[]);class v{}Object(I.a)(v,"RelevantActivitiesSettings",null,[]);class F extends l.a{constructor(){super();this.FileId=null}en(){return w.a.ztd}static Qea(G){const C=new F;C.FileId=G;return C}}
Object(I.a)(F,"UpdateWaterlineRequest",l.a,[]);d.d(J,"a",function(){return y});class y{constructor(G,C,H,K,R){this.gGk=G;this.yLd=C;this.w6e=H;this.NDc=K;this.Fah=R}requestWYWAActivities(G){G=u.Qea(this.yLd(),G);return m.a.then(this.Daa(G,"wywa"),C=>C)}requestActivities(G,C){G=z.Qea(this.yLd(),G,C);return m.a.then(this.Daa(G,"activities"),H=>H)}CHo(){const G=F.Qea(this.yLd());return m.a.then(this.Daa(G,"waterline"),C=>C)}requestRelevantActivities(G,C){C=Object.assign(new v,{FirstDocumentOpen:C,MockDataEnabled:!1});
G=x.Qea(this.yLd(),G,C);return m.a.then(this.Daa(G,"relevant"),H=>H)}updateActivityState(G){return m.a.zrd(this.Fah,C=>C.rwp(G.itemIds,G.activityStatesToSet,G.activityStatesToReset,G.resetUnseenCount))}requestActivityFeed(){return m.a.zrd(this.Fah,G=>G.PGf(null))}Daa(G,C){const H={"Content-Type":"application/json; charset=utf-8"};return m.a.then(m.a.zrd(this.gGk,K=>K.nt(this.w6e,H,f.a.u6h(G,this.NDc),C)),K=>{if(!(K&&K.args&&K.args.data&&K.args.data.Ee))return null;({group:K}=a.a.N4(K.args.data.Ee));
return K&&K.Responses&&K.Responses.length?K.Responses[0]:null})}}Object(I.a)(y,"SharedActivityRepository",null,[])},1291:function(I,J,d){d.d(J,"a",function(){return f});var m;(function(a){a[a.Unknown=0]="Unknown";a[a.oQp=1]="Inference"})(m||(m={}));var f;(function(a){a[a.Unknown=0]="Unknown";a[a.RTp=1]="VoiceDictationBadge";a[a.STp=2]="VoiceDictationPhrase"})(f||(f={}))},1490:function(I,J,d){d.d(J,"a",function(){return a});I=d(0);var m=d(2),f=d(6);class a{static get Tzb(){return!!m.AFrameworkApplication.J&&
m.AFrameworkApplication.J.$("WordDesignerTelemetryPerConstructIsEnabled")}static Nqb(l,w=!1){const z=f.a.Za(l);z.Ld();return(w?z.Ub(4):z.Gla(4))?4:f.a.Za(l).vb(36)?16:f.a.Za(l).vb(14)?2:f.a.Za(l).vb(38)?32:1}}Object(I.a)(a,"ConstructTypeHelper",null,[])},1520:function(I,J,d){d.d(J,"a",function(){return Z});I=d(0);var m=d(196),f=d(19),a=d(238),l=d(2),w=d(236),z=d(5),x=d(72),u=d(11),v=d(750),F=d(127),y=d(255),G=d(3),C=d(81),H=d(61),K=d(35),R=d(451),E=d(166),L=d(20),O=d(252),V=d(7);class Z{static get sg(){return O.a.instance}static get Bc(){return m.a.instance}static wy(){return Z.ao||
(Z.ao=f.a.instance.Ra(51))}static get oC(){return null!=Z.V2g?Z.V2g:Z.V2g=f.a.instance.resolve(34)}static SPm(){this.TQ||(this.TQ=new x.a,this.TQ.add(G.a.uC),this.TQ.add(G.a.font),this.TQ.add(G.a.yY),this.TQ.add(G.a.vza),this.TQ.add(G.a.bold),this.TQ.add(G.a.lA),this.TQ.add(G.a.superscript),this.TQ.add(G.a.subscript),this.TQ.add(G.a.S6a),this.TQ.add(G.a.sza),this.TQ.add(G.a.wIa),this.TQ.add(G.a.jof),this.TQ.add(G.a.xIa),this.TQ.add(G.a.R6a),this.TQ.add(G.a.h3),this.TQ.add(G.a.y4),this.TQ.add(G.a.oE),
this.TQ.add(G.a.Dnb),this.TQ.add(G.a.JVc));return this.TQ}static Snc(W){return Z.SPm().contains(W)?!0:!1}static yx(W,P,S,aa,Y){var X=!0;if(!P.view.ue)return 2;var ca=P.view,fa=ca.lb;fa&&fa.gb.currentSelection||(Z.Bc.$b(C.a.Oe,{["Reason"]:H.a.Wn}),X=!1);Object(E.a)().VIa(F.a.F9c,ca.lb.Ng)&&(Z.Bc.$b(C.a.Oe,{["Reason"]:H.a.Grf}),X=!1);if(Object(E.a)().VIa(F.a.bab,ca.lb.Ng))return Z.Bc.$b(C.a.Oe,{["Reason"]:H.a.MWc}),8;var ja=!Z.Snc(W);Z.sg.Wnc(ca.lb.Ng,ja)&&(Z.Bc.$b(C.a.Oe,{["Reason"]:H.a.$G}),X=!1);
Object(E.a)().VIa(F.a.aee,ca.lb.Ng)&&(Z.Bc.$b(C.a.Oe,{["Reason"]:H.a.Arf}),X=!1);Object(E.a)().VIa(y.c,ca.lb.Ng)&&(Z.Bc.$b(C.a.Oe,{["Reason"]:H.a.Brf}),X=!1);Object(E.a)().VIa(v.a.lZf,ca.lb.Ng)&&(Z.Bc.$b(C.a.Oe,{["Reason"]:H.a.zrf}),X=!1);Object(E.a)().bFa(V.ParagraphReader.IX,ca.lb.Ng)&&(Z.Bc.$b(C.a.Oe,{["Reason"]:H.a.cR}),X=!1);Z.wy()&&Z.wy().instance&&Z.wy().instance.KX(ca.lb.Ng)&&(Z.Bc.$b(C.a.Oe,{["Reason"]:H.a.C8a}),X=!1);var ra=null;fa&&fa.gb.currentSelection&&(ra=fa.gb.currentSelection);if(1===
S||!X||!ra)return X?32:8;X=W===G.a.Gqc||W===G.a.Rec||W===G.a.nwc||W===G.a.rjc;ca=W===G.a.uYb||W===G.a.FNb||W===G.a.zvc;ja=W===G.a.I_a||W===G.a.J_a||W===G.a.bF;const ya=new K.GraphTransaction(15);ya.Ab(ra.Qa.node);ra=new x.a;let Ha=!1;if(X||ca||ja)a.a.mark(7121),P=Object(E.a)().Wri(P.Ok);else{a.a.mark(7119);P=R.OutlineElementGeneralizer.gla(fa.gb,!0);if(!P)return Z.Bc.$b(C.a.osa,{["Reason"]:H.a.s2d}),ya.dispose(),8;fa=W===G.a.J$a||W===G.a.vsb;P.Uw&&fa&&(Ha=Z.x_m(ra,P))}(W===G.a.V7||W===G.a.Gqc||W===
G.a.iaa||W===G.a.Rec||W===G.a.D8||W===G.a.nwc||W===G.a.nKa||W===G.a.rjc)&&P.Uw&&1<P.length&&Z.y_m(P)&&(Y||(Y={}),Object.getType(Y)===Object&&(Y.InContextSet=!0));l.AFrameworkApplication.va.Pf(P,W,S,!0,aa,Y);Ha&&Z.UTn(ra,P,Y);ya.dispose();L.StaticActiveAppFrame.za().Fe();X||ca||ja?a.a.mark(7122):a.a.mark(7120);return 32}static x_m(W,P){if(!P.Uw)return!1;let S=!1,aa=!1;for(let X=0;X<P.length;X++)if(P.getContext(X).Cl){var Y=P.getContext(X).node;Y&&(Y=Z.oC.Zqb(Y),2===Y.specialIndentType?(S=!0,W.add(X)):
1!==Y.specialIndentType&&Y.specialIndentType||(aa=!0))}return aa&&S}static UTn(W,P,S){if(P.Uw)for(let Y=0;Y<W.count;Y++){var aa=P.getContext(W.K(Y));if(!aa.Cl)continue;aa=aa.node;const X=Z.oC.Zqb(aa);2!==X.specialIndentType||w.a.UBa(S.value,X.$A)||aa.setValue(z.a.je,X.$A-X.Gha)}}static hCg(W,P){let S=!0;P.contextId!==u.a.paragraph?S=!1:Z.sg.Kab(P)?(Z.Bc.$b(C.a.Vn,{["Reason"]:H.a.$G}),S=!1):Z.wy()&&Z.wy().instance&&Z.wy().instance.KX(P)?(Z.Bc.$b(C.a.Vn,{["Reason"]:H.a.C8a}),S=!1):P.Cl&&(P=P.node,V.ParagraphReader.Vb(P)&&
P.eU&&(Z.Bc.$b(C.a.Vn,{["Reason"]:H.a.cR}),S=!1));return{returnValue:1!==W&&S,Oz:S?32:8}}static y_m(W){if(!W.Uw)return!1;let P=1;for(let aa=0;aa<W.length;aa++){var S=W.getContext(aa);if(S&&S.Cl&&S.contextId===u.a.paragraph&&(S=S.node))if(S=V.ParagraphReader.Zy(S),!aa)P=S;else if(S!==P)return!0}return!1}}Z.ao=null;Z.TQ=null;Object(I.a)(Z,"FormattingActionHelper",null,[])},1524:function(I,J,d){d.d(J,"a",function(){return f});d.d(J,"b",function(){return a});var m=d(2);const f=l=>{switch(l){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;
case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var l;return null===(l=m.AFrameworkApplication.J)||void 0===l?void 0:l.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1545:function(I,J,d){I=d(0);class m{constructor(z,x,u,v){this.Qsk=
z;this.fMk=x;this.dMk=u;this.gMk=v}get KXd(){return this.Qsk}get mve(){return this.fMk}get kve(){return this.dMk}get resultType(){return this.gMk}}Object(I.a)(m,"SearchContext",null,[2024]);class f{TYd(z,x,u,v){var F=u-x;let y;if(100<=F)F=x,y=u;else{F=Math.max(0,x+Math.ceil(F/2)-50);y=Math.min(z.length,F+100);F=Math.max(0,y-100);let C;if(F&&" "!==z.charAt(F-1)){C=Math.min(x,F+10);for(var G=F;G<C;++G)if(" "===z.charAt(G)){F=G+1;break}}if(y!==z.length&&" "!==z.charAt(y))for(C=Math.max(u,y-10),G=y-1;G>=
C;--G)if(" "===z.charAt(G)){y=G;break}}z=z.substring(F,y);return new m(z,x-F,u-F,v)}UYd(z){return this.TYd(z.sDi(),z.Dc,z.end,"")}}Object(I.a)(f,"SearchContextFactory",null,[1992]);var a=d(103),l=d(1524);d.d(J,"a",function(){return w});class w extends f{constructor(){super()}UYd(z){let x=z.Dc,u=z.end;const v=({Dc:x,end:u}=w.rFm(z,x,u)).returnValue;z=l.a(z.type);return this.TYd(v,x,u,z)}static get instance(){return null!=w.sZg?w.sZg:w.sZg=new w}static rFm(z,x,u){z=z.sDi();return w.DCj(z,x,u)}static DCj(z,
x,u){const v=a.AParagraphNode.tV(z);if(v.length<z.length){z=z.substring(0,x);const F=a.AParagraphNode.tV(z);z=z.length-F.length;x-=z;u-=z}return{returnValue:v,Dc:x,end:u}}}Object(I.a)(w,"EditorSearchContextFactory",f,[])},1548:function(I,J,d){I=d(0);var m=d(2),f=d(19),a=d(392),l=d(718),w=d(21),z=d(20),x=d(138),u=d(49),v=d(549),F=d(203),y=d(227),G=d(78),C=d(25),H=d(7),K=d(3),R=d(5),E=d(58),L=d(471),O=d(1041);class V{create(){return new O.a}}Object(I.a)(V,"FootnoteEndnoteContainerNodeFactory",null,
[433]);var Z=d(536);d.d(J,"a",function(){return W});class W{constructor(P,S,aa,Y,X,ca,fa,ja,ra){this.sPd=null;W.ga=P;this.xG=aa;this.w3e=Y;this.ssk=ca;this.$c=fa;this.ib=X;this.aGk=ja;this.Htk=ra;W.ii=S}zke(P,S){this.y2l(P);P.Ub(7);this.xG.EYi(P,S)||P.Nf(7)}y2l(P){if(this.w3e.u0i(P)){var S=!1,aa=!1;if(P.Ub(7)){do{const Y=P.currentNode;if(37===Y.type)switch(Y.getValue(R.a.h7)){case 0:aa=!0;break;case 1:S=!0}}while(P.Mi(7))}aa||this.cNh(P,0);S||this.cNh(P,1)}}cNh(P,S){const aa=this.ssk.create(E.a.jKa);
aa.setValue(R.a.h7,S);P.Wf(aa,7)}VPo(P){P&&this.iLj(P.ssa)}iLj(P){P&&(P=w.SelectionFactory.ve(P.Jb.paragraph,P.Jb.cp+1),this.ib.Kc(P))}jSn(P){let S=this.aGk(P);void 0!==S&&null!==S?this.xG.qta(S)&&(S=this.xG.VDi(S)):S=P;return this.Htk(S)}Cap(){this.sPd?W.ii.lK.removeEntry(this.sPd):this.sPd=W.ii.lK.zka(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);W.ii.lK.Pz(this.sPd)}W8k(P,S){P=this.$c.Dsa(P,37,37);let aa=!1;if(P.$d()){do{const Y=P.currentNode;this.xG.t1f(Y)?
this.dTh(Y,S):aa=!0}while(P.Mk())}aa&&this.Cap()}dTh(P,S){L.f(P,aa=>{W.bem(aa,S);return!0},12)}e_m(P,S){P=this.xG.o3c(P,S);return P?(P=this.$c.lg(P))?P.ZA():!1:!1}oyi(P,S){P=this.xG.o3c(P,S);P=this.$c.lg(P);if(P.$d()){do if(S=P.currentNode,1===S.getValue(R.a.tsa))return S;while(P.Mk())}return null}static p3c(){return new W(m.AFrameworkApplication.va,z.StaticActiveAppFrame.za(),Z.a.instance,x.PageReader.instance,u.a.instance,new V,new v.a,F.OutlineNavigator.dSn,y.WordSectionNavigator.hwf)}static get instance(){return null!=
W.CZg?W.CZg:W.CZg=W.p3c()}static get sl(){return null!=W.Q2g?W.Q2g:W.Q2g=f.a.instance.resolve(349)}static bem(P,S){S.Qrb?W.sl.ir.sha(P,G.OutlineReader.E_(P)):W.sl.ir.sha(P,0);P=C.a.createTextRange(P,0,H.ParagraphReader.textLength(P));W.ga.Pf(P,K.a.font,2,!0,new a.a,new l.a(S.fontName));W.ga.Pf(P,K.a.uC,2,!0,new a.a,new l.a(S.fontSize))}}W.ga=null;W.ii=null;Object(I.a)(W,"FootnoteEndnoteEditor",null,[430])},1580:function(I,J,d){d.d(J,"a",function(){return E});I=d(0);var m=d(19),f=d(46),a=d(65),l=d(57),
w=d(35),z=d(602),x=d(138),u=d(549),v=d(114),F=d(104),y=d(5),G=d(878),C=d(770),H=d(536),K=d(1472),R=d(1548);class E{constructor(L,O,V,Z,W,P){this.xG=L;this.eRa=V;this.w3e=Z;this.qPe=W;this.$c=P}static get Jg(){return null!=E.M4g?E.M4g:E.M4g=m.a.instance.Oa(28)}dcn(L,O,V){const Z=this.NAi(O,L.node),W=L.node.Ic;if(!W)return null;const P=new w.GraphTransaction(15);P.Ab(L.node);P.Ei=V;V=this.ecn(Z,O);E.fcn(V,W,L,O);P.dispose();return V}NAi(L,O){const V=this.$c.Vl();V.set(O);V.vb(7);V.fd(7);this.eRa.zke(V,
L);return V}ecn(L,O){const V=C.a.createNode();V.properties.setValue(y.a.h7,O);L.Wf(V,8);this.qPe.aGl(V,O);return V}static get Bg(){return null!=E.fUg?E.fUg:E.fUg=m.a.instance.resolve(323)}static get d1(){return E.JT||(E.JT=new z.WACStyleSet)}static set d1(L){E.JT=L}static p3c(){const {FootnoteEndnoteDefaultContentInserter:L}=d(1699);return new E(H.a.instance,K.a.instance,R.a.instance,x.PageReader.instance,L.instance,new u.a)}static get instance(){return null!=E.l_g?E.l_g:E.l_g=E.p3c()}static fcn(L,
O,V,Z){a.a.vd().wn&&a.a.vd().Fk.NG(V.node);const W=new v.a;W.setValue(y.a.ajc,L.id);W.setValue(y.a.h7,Z);const P=O.nu(W,f.a.create());E.Bg.Tla(V,S=>G.a.getInstance(S,P,L.id),E.Rui(V.node,Z,Object(F.a)()))}static Rui(L,O,V){let Z=null;if(L=V.Nu(L))if(L=E.d1.$aa(L))O=O?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference,this.Jg.xn?(O=L.mv().fBa(O),Z=L.mh(l.a.Xb.Be(O))):Z=L.MKa(O);return Z}}E.JT=null;Object(I.a)(E,"FootnoteEndnoteInserter",null,[457])},
1585:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{static JFo(f,a){m.Z2e=f;m.p6e=a}static GFo(f,a){m.m6e=f;m.y5a=a}static TFi(){return m.m6e===m.y5a?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,m.y5a,m.Z2e,m.p6e):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,m.m6e,m.y5a,m.Z2e,m.p6e)}}m.m6e=0;m.y5a=0;m.Z2e=null;m.p6e=null;Object(I.a)(m,"ReplaceAllContext",null,[])},1626:function(I,J,d){d.r(J);I=d(0);var m=d(2111),f=d(46),a=d(2),l=d(453),
w=d(19),z=d(2156),x=d(20),u=d(8),v=d(267),F=d(2113),y=d(12),G=d(18),C=d(1545);class H{constructor(Nb="",ib="",Rb=!1,ic=!1){this.opn=Rb;this.btn=ic;this.actionId=Nb;this.tOa=ib}}Object(I.a)(H,"SearchEntryPointContext",null,[]);class K{constructor(Nb){this.xja=null;this.Xt=!1;this.uQ=Nb}initialize(){this.u2();this.gB();this.jaa(0)}gB(){this.xja.gB()}dispose(){this.uQ=null}E4c(){return!1}get nI(){return this.xja?this.xja.nI:0}jaa(Nb){this.xja.jaa(Nb)}get isVisible(){return this.Xt}zff(Nb){this.xja&&
this.xja.pVp(Nb)}DDj(Nb){this.xja&&this.xja.xkq(Nb)}F9j(Nb){this.xja&&this.xja.gsq(Nb)}M2h(){this.xja&&this.xja.ZXp()}uwe(Nb){this.xja&&this.xja.uwe(Nb)}}Object(I.a)(K,"FindReplacePane",null,[450,11]);var R=d(77),E=d(1874),L=d(1266),O=d(180),V=d(197),Z=d(1508),W=d(92),P=d(113),S=d(85),aa=d(41),Y=d(1375),X=d(865),ca=d(1415),fa=d(1384),ja=d(1421),ra=d(1418),ya=d(94),Ha=d(1067);class Wa{constructor(Nb){this.LXk=(ib,Rb)=>{this.tPd.mb(ib)?this.tPd.W(ib,Rb):this.tPd.add(ib,Rb);(ib=this.Yim(ib))&&this.IUi(Rb,
ib,this.O7h(fa.a.getTypeName()))};this.tPd=new ya.a;this.TY=new ya.a;this.annotationType=ca.RoleDetectionAnnotation.getTypeName();Nb.bvo(this.LXk)}oH(Nb,ib){let Rb;const ic=Nb.parentPath.substr(Nb.parentPath.lastIndexOf("\\")+1),kc=Nb.content;if(!kc||this.Hsn(kc))""!==ic&&({value:Rb}=this.tPd.Ec(ic,Rb)).returnValue&&this.IUi(Rb,Nb,this.O7h(ib)),ib===fa.a.getTypeName()?(ib=null,({value:ib}=this.TY.Ec(ic,ib)).returnValue?this.TY.W(ic,Nb):this.TY.add(ic,Nb)):ib===ja.a.getTypeName()&&this.TY.remove(ic)}IUi(Nb,
ib,Rb){const ic=this.gzm(ib);ib=this.Zim(ib);0<ib&&Nb(Rb,ic,ib)}Zim(Nb){try{return Number.parseInvariant(Nb.id.substr(2))}catch(ib){u.ULS.sendTraceTag(554747009,367,10,ib.toString())}return-1}Yim(Nb){let ib;return({value:ib}=this.TY.Ec(Nb,ib)).returnValue?ib:null}Nhd(Nb){if(Nb)for(const ib of Nb)this.oH(ib,"AugLoop_Core_AddOperation")}gzm(Nb){if(Nb=Nb.content)switch(Nb.roleType){case ca.RoleType.Heading1:return 1;case ca.RoleType.Heading2:return 2;case ca.RoleType.Heading3:return 3;case ca.RoleType.Heading4:return 4;
case ca.RoleType.Heading5:return 5;case ca.RoleType.Heading6:return 6;case ca.RoleType.Heading7:return 7;case ca.RoleType.Heading8:return 8;case ca.RoleType.Heading9:return 9}return-1}Hsn(Nb){Nb=Nb.roleType;return Nb===ca.RoleType.Heading1||Nb===ca.RoleType.Heading2||Nb===ca.RoleType.Heading3||Nb===ca.RoleType.Heading4||Nb===ca.RoleType.Heading5||Nb===ca.RoleType.Heading6||Nb===ca.RoleType.Heading7||Nb===ca.RoleType.Heading8||Nb===ca.RoleType.Heading9}O7h(Nb){if(Nb===fa.a.getTypeName()||Nb===ra.a.getTypeName())return Ha.a.bOh;
if(Nb===ja.a.getTypeName())return Ha.a.Dwf;throw Error.create("Invalid operation type");}}Object(I.a)(Wa,"RoleDetectionAnnotationHandler",null,[155]);var Ma=d(148),ua=d(60),Ka=d(1775),za=d(49),Fa=d(72),ea=d(108);class la{constructor(Nb){this.TY=new ya.a;this.Rwh=Nb}oH(Nb,ib){ib===fa.a.getTypeName()?(ib=null,({value:ib}=this.TY.Ec(Nb.id,ib)).returnValue?this.TY.W(Nb.id,Nb):this.TY.add(Nb.id,Nb)):ib===ja.a.getTypeName()&&this.TY.remove(Nb.id);this.Rwh&&this.Rwh()}Nhd(Nb){if(Nb)for(const ib of Nb)this.oH(ib,
fa.a.getTypeName())}getAnnotations(){var Nb;const ib=[];if(0<(null===(Nb=this.TY)||void 0===Nb?void 0:Nb.count))for(const Rb of this.TY.values)ib.push(Rb);return ib}}Object(I.a)(la,"ContractEntityAnnotationHandler",null,[155]);var Na=d(3),Aa=d(1632);class wa{constructor(Nb){this.ga=Nb}xYn(){this.LUd()}z_n(Nb){this.ga.Pb(G.a.b$d,2,Nb)}G2n(){Aa.a.jEe();this.LUd()}LUd(){this.ga.Ob(Na.a.Gec,2)}V4n(){this.ga.Ob(Na.a.JDf,2)}onSearchQueryChanged(Nb){this.ga.Pb(Na.a.KDf,2,Nb)}z6n(){this.ga.Ob(G.a.replace,
2)}A6n(){this.ga.Ob(G.a.replaceAll,2)}v6n(){this.ga.Ob(y.a.FDf,2)}w6n(){this.ga.Ob(y.a.YDf,2)}y6n(){this.ga.Ob(Na.a.Cmg,2)}x6n(){this.ga.Ob(Na.a.ocg,2)}Yuc(Nb){this.ga.Pb(G.a.Yuc,2,Nb)}}Object(I.a)(wa,"FindReplaceActions",null,[489]);var va=d(155);class Pa{}Pa.ES=va.a.Upb;Pa.Htc=0;Pa.cAa="FindReplaceTaskPaneData";Pa.BV=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(I.a)(Pa,"FindReplaceConstants",null,[]);var Ta=d(766);class kb{p4j(Nb){var ib,Rb,ic;return X.a.crb(null===(ic=null===(Rb=
null===(ib=x.StaticActiveAppFrame.za())||void 0===ib?void 0:ib.kb)||void 0===Rb?void 0:Rb.ed)||void 0===ic?void 0:ic.ud,Nb)}clearSelection(){if(this.b_e){const Nb=this.p4j(this.b_e);Nb&&Nb.mra()}this.b_e=this.QDh=null}MPo(Nb){this.clearSelection();if(Nb){const ib=this.p4j(Nb.parentPath);if(ib){const Rb=Nb.content;Rb&&(this.QDh=Nb.id,ib.C_a([new Ta.a(Rb.range.start,Rb.range.start+Rb.range.length)]),ib.f8f(0,1));this.b_e=Nb.parentPath}}}}Object(I.a)(kb,"RangeAnnotationContentSelector",null,[]);var gb=
d(1585);class tb{constructor(Nb){this.kEk=Nb}get Ek(){return this.kEk.value}PCm(Nb){Nb=this.Ek.O9a(Nb);return this.Hln(Nb)?null:Nb}Hln(Nb){return Nb.id===this.Ek.cKa.id}static get instance(){return null!=tb.WYg?tb.WYg:tb.WYg=tb.dH()}static dH(){const Nb=new v.a(()=>z.a.instance.Ek);return new tb(Nb)}}Object(I.a)(tb,"SearchResultOrder",null,[]);var hb=d(7),Xa=d(268);class $a{constructor(Nb){this.y_e=Nb}get FH(){return this.y_e.value}getSelectedText(){var Nb=this.FH.cla;if(Nb){const ib=Nb.cpBegin,Rb=
Nb.cpEnd-ib;if(0<Rb&&(Nb=Nb.node,hb.ParagraphReader.Vb(Nb)))return Nb.characterData.substr(ib,Rb)}return null}static getInstance(){return $a.Sm()}static Sm(){const Nb=new v.a(()=>Xa.a.instance);return new $a(Nb)}}Object(I.a)($a,"SelectionHelper",null,[]);var La=d(29),bb=d(91),Gb=d(863),qb=d(868),Sa=d(360),cb=d(864),pb=d(1890);va=d(193);var vb=d(237),xb=d(338),Bb=d(104),jc=d(647);class xc extends va.a{constructor(Nb,ib,Rb){super(Nb,ib,vb.a.Psa());this.uNa=Rb;this.ENi=!1}get r2f(){return!0}get Yla(){return super.Yla|
504}static RKl(Nb){var ib=x.StaticActiveAppFrame.za().kb.ed;const Rb=xb.a.instance.Lc(3);ib&&(ib=Object(Bb.a)().BU(ib))&&(Nb=new xc(new jc.a,w.a.instance.resolve(77),Nb),Rb.Kod(Nb.sc),Nb.xF(ib),Rb.dispose(),Nb.ENi=!0)}}Object(I.a)(xc,"WordNavigationPaneReactHeadingsView",va.a,[192,99,11]);class Qc extends K{constructor(Nb,ib,Rb,ic,kc,Jb,ec,qa,sa,ab,eb,fb,Cb,lc){var bc,Za;super(Nb);this.ODb=Pa.ES;this.DQk="FindReplaceTaskPaneProps";this.Zb=R.FocusManager.instance();this.V1a=this.NSa=this.Q1=this.v$e=
null;this.L4b=a.AFrameworkApplication.J.$("AugLoopOperationsAreEnabled");this.Gok=a.AFrameworkApplication.J.$("AutoDetectedHeadingsIsEnabled");this.ZFk=null===(bc=a.AFrameworkApplication.J)||void 0===bc?void 0:bc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.D9b=null===(Za=a.AFrameworkApplication.J)||void 0===Za?void 0:Za.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneAutoFocusOnScroll",!1);this.k8j=()=>{this.isVisible&&this.pZd===F.a.intelligentPlaceholder&&
this.Vm()};this.RC=new E.a;this.Tjh=ib;this.yQa=F.a.headings;this.VRc=m.a.initial;this.gxa=new Fa.a;this.fT="";this.RHc={matchCase:!1,matchWholeWord:!1};this.o6e="";this.c8e=null;this.g6=Rb;this.wFh=!1;this.elb=ic;this.ib=kc;this.qGk=Jb;this.GHa=ec;this.XK=qa;this.qId=!0;this.p$=this.o$=!1;this.Re=sa;this.fE=ab;this.Gb=eb;this.RY=fb;this.Gch=Cb;this.Hl=lc;this.VKe&&this.GHa.Syo(()=>{this.Vm()});this.D9b&&(this.xne=this.xne.bind(this))}get caf(){return 1}get VKe(){return this.L4b&&this.Gok&&!!this.Re}get WKe(){return this.L4b&&
this.ZFk&&!!this.Re}get headingsReady(){return this.fE?this.fE.headingsReady:!1}set headingsReady(Nb){this.fE&&(this.fE.headingsReady=Nb)}get pZd(){return this.yQa}SUj(){this.yQa=F.a.headings;this.Vm()}O8o(){this.yQa=F.a.contracts;this.Vm()}JUj(){this.yQa=F.a.find;aa.a("NavigationPaneFind");this.Vm()}AVj(){this.yQa=F.a.replace;this.Vm()}dVj(){this.yQa=F.a.intelligentPlaceholder;this.Vm()}Bpd(Nb){this.wFh=Nb;this.Vm()}E4c(){return this.pZd===F.a.replace}get nI(){return this.VRc}jaa(Nb){this.VRc=Nb;
this.Vm()}zff(Nb){this.m_k(Nb);this.Vm()}m_k(Nb){const ib=this.qGk(Nb[Nb.length-1]);if(ib){let Rb=-1;for(let ic=0;ic<this.gxa.count;ic++)if(ib.id===this.gxa.K(ic).id){Rb=ic;break}-1===Rb?u.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.gxa.wD(Rb,this.m8h(Nb))}else this.gxa.addRange(this.m8h(Nb))}DDj(Nb){for(const ib of Nb)for(Nb=this.gxa.count-1;0<=Nb;Nb--)if(this.gxa.K(Nb).id===ib.id){this.gxa.removeAt(Nb);break}this.Vm()}F9j(Nb){for(const ib of Nb)for(Nb=
this.gxa.count-1;0<=Nb;Nb--)if(this.gxa.K(Nb).id===ib.id){this.gxa.W(Nb,this.l8h(ib));break}this.Vm()}M2h(){this.gxa.clear();this.c8e=null;this.Vm()}uwe(Nb){this.c8e=Nb?Nb.id:null;this.Vm()}m8h(Nb){if(!Nb)return new Fa.a;const ib=new Fa.a;for(const Rb of Nb)ib.add(this.l8h(Rb));return ib}l8h(Nb){const ib=this.elb.UYd(Nb);return{id:Nb.id,searchBeginIndex:ib.mve,searchEndIndex:ib.kve,searchResult:ib.KXd}}bFe(){}ICp(){var Nb={};this.uQ.Yuc(Nb);Nb=Nb[L.a.Value];this.v$e=Y.c(Nb)?"":Nb;this.Vm()}UVa(){return this.fT}OQb(){return this.o6e}Czg(Nb){this.fT=
Nb;this.Vm()}CIa(){}initialize(){this.TMd=window.performance.now();const Nb=this.Zb.ie(this.ODb);Nb.parent=O.AFrame.Kq;Nb.YL=!0;this.u2();this.jaa(m.a.initial)}yS(){this.isVisible?(u.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),V.UISurfaces.Ov().then(Nb=>{Nb.setSelectedTaskPane(this.ODb,this.caf);this.xca();this.qId&&this.dQj(!0);return null}).catch(Nb=>{Qc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Nb)})):(this.Ipd(),
this.qId&&this.dQj(!1))}dQj(Nb){const ib=this.Tjh();ib?this.fT=ib:Nb&&this.fT||(this.fT="");this.uQ.onSearchQueryChanged(this.fT)}Vsa(){V.UISurfaces.Ov().then(Nb=>{Nb.hideTaskPane(this.ODb,this.caf);return null}).catch(Nb=>{Qc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Nb)})}u2(){this.g6.GUa();this.Q1=this.g6.hgc(this.Zb);this.vXk()}Ipd(){V.UISurfaces.Ov().then(Nb=>{this.TMd=window.performance.now();Nb.showTaskPane(this.ODb,this.TB());Nb=[Object.assign(new La.a,{name:"Tab",
string:this.yQa})];const ib=window.performance.now()-this.TMd;aa.a("NavigationPaneOpen",!0,ib,Nb);return null}).catch(Nb=>{Qc.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],Nb)})}Vm(){V.UISurfaces.Ov().then(Nb=>{Nb.updateTaskPane(this.ODb,this.TB());return null}).catch(Nb=>{Qc.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],Nb)})}TB(){var Nb;const ib={activeTab:F.a.initial};this.RC.Byb(ib);a.AFrameworkApplication.nd("ImprovedNavPaneDiscoverability;ImprovedNavPaneDiscoverabilityCf");
const Rb=null===(Nb=a.AFrameworkApplication.J)||void 0===Nb?void 0:Nb.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedNavPaneDiscoverabilityIsEnabled",!1);return Object.assign(new Z.a,{title:Pa.BV,hideHeader:!1,width:320,location:this.caf,contentProps:ib,onOpen:()=>{this.Xt=!0;this.pyo();this.pvo();this.qId&&this.xca();a.AFrameworkApplication.nd("NavPaneAutoFocusOnScroll-tf;NavPaneAutoFocusOnScroll-cf");this.D9b&&this.jxo();x.StaticActiveAppFrame.za().Fe();x.StaticActiveAppFrame.za().d6a(this.k8j)},
onClose:()=>{try{const ic=window.performance.now();this.tha();this.Xt=!1;this.Zup();this.Bvp();this.D9b&&this.rvp();this.uQ.G2n();this.v$e="";this.VRc=m.a.initial;x.StaticActiveAppFrame.za().Hvc(this.k8j);x.StaticActiveAppFrame.za().Fe();const kc=window.performance.now()-ic;aa.a("NavigationPaneClose",!0,kc)}catch(ic){Qc.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],ic)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0,isNonClosablePane:Rb,showBackButton:Rb,
onManualClose:()=>{Rb&&aa.a("NavPaneBackButtonPressed")}})}pyo(){this.VKe&&!this.NSa&&X.a.Bm().then(()=>{this.NSa=new Wa(this.GHa);this.Re.nb(this.NSa,this.NSa.annotationType);this.Re.getAnnotationsByType(this.NSa.annotationType).then(Nb=>{this.NSa.Nhd(Nb)})})}Bvp(){this.VKe&&this.NSa&&(this.Re.xc(this.NSa,this.NSa.annotationType),this.NSa=null)}lqp(){if(this.WKe){var Nb=new pb.ContractEntitySignal;Nb=Object.assign(new qb.a,{parentPath:["Signal",Sa.a.getTypeNameFor(Nb)],items:[Object.assign(new cb.a,
{body:Nb})]});this.RY.getAugLoopRuntimeManager().submitOperation(Object.assign(new Gb.a,{operation:Nb}))}}pvo(){this.WKe&&!this.V1a&&X.a.Bm().then(()=>{this.V1a=new la(this.Vm);this.Re.nb(this.V1a,pb.ContractEntityAnnotation.getTypeName());this.lqp();this.Re.getAnnotationsByType(pb.ContractEntityAnnotation.getTypeName()).then(Nb=>{this.V1a.Nhd(Nb)})})}get lj(){return this.Hl}jxo(){this.lj.$0k(this.xne)}rvp(){this.lj.QCo(this.xne)}Zup(){this.WKe&&this.V1a&&(this.Re.xc(this.V1a,pb.ContractEntityAnnotation.getTypeName()),
this.V1a=null)}vXk(){this.RC.XN(this.ztm());this.RC.XN(this.Btm());this.RC.XN(this.gwm());this.RC.XN(this.Hom());this.RC.XN(this.$xm());this.RC.XN(this.rhm());this.RC.XN(this.onLinkExecute());this.RC.XN(this.onPivotTabExecute());this.RC.XN(this.jMm());this.RC.XN(this.hPm());this.RC.XN(this.Exm());this.RC.XN(this.VPm());this.RC.XN(this.sJm())}VPm(){return Nb=>{Nb.autoDetectedHeadingsToggleDisabled=this.GHa?!this.GHa.hcl():!0}}hPm(){return Nb=>{Nb.type=this.DQk}}onLinkExecute(){return Nb=>{Nb.onLinkExecute=
()=>{this.uQ.V4n()}}}xne(){this.lj.Fwc||(this.NUe&&this.Gb.uf(this.NUe),this.NUe=new W.a(0,1,0,()=>{this.fE.bPi(this.lj.osi());this.Vm()}),this.Gb.Yb(this.NUe))}onPivotTabExecute(){return Nb=>{Nb.onPivotTabExecute=ib=>{switch(ib){case F.a.headings:this.SUj();break;case F.a.replace:this.AVj();break;case F.a.contracts:this.O8o();break;case F.a.intelligentPlaceholder:this.dVj();break;default:this.JUj()}Y.b(this.fT)&&(this.fT=this.Tjh(),this.fT||(this.fT=""),Y.b(this.fT)||(this.uQ.onSearchQueryChanged(this.fT),
this.Vm()))}}}jMm(){return Nb=>{Nb.showOutOfSyncNotification=this.wFh}}Btm(){return Nb=>{Nb.findSearchBoxContent={onSearchQueryChanged:ib=>{this.fT=ib;this.Vm();this.uQ.onSearchQueryChanged(ib)},findOptions:this.RHc,matchCase:this.o$,matchWholeWord:this.p$,findSearchText:this.fT,onClearButtonExecute:()=>{void 0!==this.fT&&null!==this.fT&&""!==this.fT&&(this.fT="",this.ib.Kc(null),this.uQ.xYn())},onMatchCaseExecute:()=>{this.RHc.matchCase=!this.RHc.matchCase;this.o$=!this.o$;this.Vm();this.uQ.v6n()},
onMatchWholeWordExecute:()=>{this.RHc.matchWholeWord=!this.RHc.matchWholeWord;this.p$=!this.p$;this.Vm();this.uQ.w6n()},onMenuClose:()=>{if(this.Q1)this.Q1.onMenuClose()},onMenuOpen:()=>{if(this.Q1)this.Q1.onMenuOpen()}}}}rhm(){return Nb=>{Nb.activeTab=this.pZd}}Exm(){return Nb=>{Nb.autoDetectedHeadingsToggleState=this.GHa?this.GHa.icl:!1;this.fE.h0c=Nb.autoDetectedHeadingsToggleState;!Nb.autoDetectedHeadingsToggleState&&this.GHa&&this.GHa.Ord(!1)}}ztm(){return Nb=>{const ib={onReplaceAllExecute:()=>
{this.uQ.A6n()},onReplaceExecute:()=>{this.uQ.z6n()},onReplaceQueryChanged:Rb=>{this.o6e=Rb;this.Vm()},replaceSearchText:this.o6e};Nb.findReplaceContent={searchResults:this.gxa.toArray(),replaceSearchBoxContent:ib,onNextSearchResultExecute:()=>{this.uQ.x6n()},onPrevSearchResultExecute:()=>{this.uQ.y6n()},onSearchResultSelected:Rb=>{const {FindReplaceUIManager:ic}=d(1626);this.uQ.z_n(Rb);ic.xaj(1)},selectedResultId:this.c8e,summaryLabel:this.v$e,explanationText:this.Lsm(this.VRc),haveTooManySearchResults:this.VRc===
m.a.bia}}}Lsm(Nb){switch(Nb){case m.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case m.a.EYa:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case m.a.Lvc:return gb.a.TFi();case m.a.bia:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}sJm(){return Nb=>{Nb.replaceFollowUpsWithCommentsIsEnabled=!0}}$xm(){return Nb=>{var ib=this.XK.him();const Rb=[];for(const ic of ib)ib=this.XK.S4d(ic.Ic,ic.id),Rb.push({id:ic.id.toString(),intelligentPlaceholderAnchorText:ib});
Nb.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:Rb,onIntelligentPlaceholderInputExecute:ic=>{this.fT=ic;this.yQa=F.a.find;this.Vm();this.uQ.onSearchQueryChanged(ic)},onSearchResultSelected:ic=>{this.Vm();ic=f.a.Af(ic);this.XK.WPo(ic)}}}}gwm(){return Nb=>{var ib;let Rb=()=>{};this.GHa&&(Rb=Object(ea.a)(this.GHa,this.GHa.Ord,"toggleAutoDetectedHeadings"));const ic=null===(ib=a.AFrameworkApplication.J)||void 0===ib?void 0:ib.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitialHeadingsInNavPaneFix",
!1);Nb.headingsContent={onHeaderInputExecute:kc=>{this.fT=kc;this.yQa=F.a.find;this.Vm();aa.a("NavigationPaneFind");this.uQ.onSearchQueryChanged(kc)},renderHeadingContent:(kc,Jb,ec)=>{this.Gb.Yb(new W.a(0,1,100,()=>{var qa=window.performance.now()-this.TMd;if(ic)this.headingsReady=!0,this.Vm();else{var sa=this.fE.a4;this.headingsReady=!0;this.D9b&&this.Gb.Yb(new W.a(0,1,0,()=>{const ab=this.lj.osi();this.fE.bPi(ab);this.Vm()}));this.Vm();ec.style.display="none";sa.first&&(kc.style.display="block")}this.Gb.Yb(new W.a(1,
1,0,()=>{xc.RKl(this)}));sa=window.performance.now()-this.TMd;aa.a("NavigationPaneHeadingsLoaded",!0,sa,[Object.assign(new La.a,{name:"NavPaneReactHeadings",bool:!0})]);qa=[Object.assign(new La.a,{name:"HeadingFetchStart",double:qa}),Object.assign(new La.a,{name:"HeadingFetchFinished",double:sa})];aa.a("NavigationPaneHeadingsLoadDetails",!0,void 0,qa)}))},autoDetectedHeadingsToggle:Rb,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.fE.a4,onHeadingChevronClick:kc=>
{this.fE.o5l(kc);this.Vm()},onClickHeading:kc=>{this.lj.Fwc=this.D9b;if(this.Gb.iz){u.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",kc);const Jb=window.performance.now();this.Gb.Yb(new W.a(0,1,0,()=>{this.fE.onClickHeading(kc);this.Vm();const ec=window.performance.now()-Jb;aa.a("NavigationPaneAsyncOnClickHeadingItem",!0,ec)}))}else this.fE.onClickHeading(kc),this.Vm()},onClickBookmark:kc=>{this.lj.Fwc=this.D9b;if(this.Gb.iz){u.ULS.sendTraceTag(512328289,
312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",kc);const Jb=window.performance.now();this.Gb.Yb(new W.a(0,1,0,()=>{this.fE.onClickBookmark(kc);this.Vm();const ec=window.performance.now()-Jb;aa.a("NavigationPaneAsyncOnClickHeadingItem",!0,ec)}))}else this.fE.onClickBookmark(kc),this.Vm()},onShareHeadingClick:kc=>{this.fE.onShareHeadingClick(kc)},bookmarkIconUrl:Ma.a.li("BookmarkDefault.png")}}}Gom(){var Nb,ib=null===(Nb=this.V1a)||void 0===Nb?void 0:
Nb.getAnnotations();if(ib){Nb=Array(ib.length);let Rb=0;for(const ic of ib)(ib=ic.content)&&(Nb[Rb++]={id:ic.id,type:ib.type,value:ib.value});return Nb}return null}Hom(){return Nb=>{Nb.contractsContent={onHeaderInputExecute:ib=>{this.fT=ib;this.yQa=F.a.find;this.Vm();aa.a("NavigationPaneFind");this.uQ.onSearchQueryChanged(ib)},contractEntities:this.Gom(),selectedEntityId:this.Gch.QDh,onEntitySelected:ib=>{var Rb;const ic=null===(Rb=this.V1a)||void 0===Rb?void 0:Rb.getAnnotations();if(ic)for(const kc of ic)if(kc.id===
ib){this.Gch.MPo(kc);break}this.Vm()}}}}uPj(Nb){this.qId=Nb}RAp(Nb){this.Gb.Yb(new W.a(0,1,0,()=>{this.fE.AMg(Nb)&&this.Vm()}))}jMi(Nb){this.Gb.Yb(new W.a(0,1,0,()=>{const ib=this.fE.xYb;this.fE.yei(Nb)?this.Vm():0===this.fE.xYb&&0<ib&&this.Vm()}))}KLg(Nb,ib){this.Gb.Yb(new W.a(0,1,0,()=>{const Rb=this.fE.xYb;this.fE.KLg(Nb,ib)?this.Vm():0<this.fE.xYb&&0===Rb&&this.Vm()}))}bRl(Nb){this.Gb.Yb(new W.a(0,1,0,()=>{const ib=this.fE.xYb;this.fE.cRl(Nb)?this.Vm():0===this.fE.xYb&&0<ib&&this.Vm()}))}f1o(Nb){this.fE.ynp(Nb);
this.Vm()}jMg(Nb){this.fE.jMg(Nb)&&this.Vm()}h_d(Nb){this.fE.h_d(Nb)&&this.Vm()}Plo(){return 0<this.fE.xYb}xca(){this.Zb.Eg(this.ODb);u.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}tha(){if(this.bbb()){var Nb;(Nb=Object(ua.a)().Ad)?(Nb=Nb.CL,u.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(Nb=this.Zb.bX,u.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.Zb.Eg(Nb)}}bbb(){return!!this.Zb.currentScope&&
this.Zb.currentScope.name===this.ODb}static getInstance(){return Qc.Sm()}static Sm(){var Nb,ib;return new Qc(new wa(a.AFrameworkApplication.va),Object(ea.a)($a.getInstance(),$a.getInstance().getSelectedText,"getSelectedText"),Ka.a.instance,C.a.instance,za.a.instance,Object(ea.a)(tb.instance,tb.instance.PCm,"getNextSearchResult"),w.a.instance.Oa(641),w.a.instance.Oa(702),w.a.instance.Oa(454),w.a.instance.resolve(728),P.a.instance,w.a.instance.resolve(660),new kb,null===(ib=null===(Nb=x.StaticActiveAppFrame.za())||
void 0===Nb?void 0:Nb.kb)||void 0===ib?void 0:ib.Jc)}static recordQosError(Nb,ib,Rb){const ic=Object.assign(new bb.a,{extendedProperties:new Map});Rb&&ic.extendedProperties.set("exception",Rb);S.Health.instance.recordQosError(Nb,ib,!1,!0,!1,!1,ic)}}Object(I.a)(Qc,"ReactFindReplacePane",K,[449,450,11]);var fd=d(1524);d.d(J,"FindReplaceUIManager",function(){return Ac});class Ac{constructor(Nb,ib,Rb=null,ic=null,kc=null,Jb=null){this.gzd=this.J5=0;this.p$=this.o$=this.$Ib=!1;this.$m=this.nwh=this.Coa=
null;this.LLa=this.qYe=!1;this.Qj=Nb;this.Vp=Rb;this.elb=ic;this.Zsh=kc;this.Zd=Jb;Ac.wec=new H}get K0f(){return this.qYe}set K0f(Nb){Nb!==this.qYe&&(this.qYe=Nb,this.s1h())}Aye(Nb){this.J5=Nb;this.update();this.J5||this.nI!==m.a.Xxb&&this.nI!==m.a.bia?0<this.J5&&this.nI===m.a.EYa?this.jaa(m.a.Xxb):this.J5>Ac.d2j&&this.nI!==m.a.bia&&(u.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.jaa(m.a.bia)):this.jaa(m.a.EYa)}Vwe(Nb){this.gzd=Nb;this.LLa&&this.update();this.Zsh&&!this.Zsh.value.hld&&
this.Zyg()}reset(){}WDf(){this.Zd&&(this.$m=this.Zd.Xf("UserAction","Find"));if(this.LLa||!this.nI)this.LLa=!1,u.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.jaa(m.a.QKj)}Iic(){var Nb;this.LLa=!0;let ib=this.J5?m.a.Xxb:m.a.EYa;if(this.nI!==m.a.bia&&z.a.instance){const Rb=z.a.instance.Ek;0<Rb.doa&&(Rb.doa>Ac.d2j?ib=m.a.bia:this.TBp(Rb))}this.jaa(ib);this.update();this.$m&&(this.$m.stop(),this.$m=null);Ac.NKj=f.a.create().toString();Ac.xaj(0,this.ygc,this.UVa().length,this.J5);Object(fd.b)()&&
(null===(Nb=this.Qj)||void 0===Nb?0:Nb.isVisible)&&(Nb={},a.AFrameworkApplication.va.Pb(y.a.Ase,2,Nb),Nb[l.a.On]&&a.AFrameworkApplication.va.Pb(y.a.Jce,2,{CommandValueId:{query:this.UVa(),matchCase:this.o$,matchWholeWordOnly:this.p$,totalResultLimit:-1}}))}TBp(Nb){const ib=Nb.cKa;let Rb=ib;const ic=[];do ic[ic.length]=Rb,Rb=Nb.O9a(Rb);while(ib!==Rb);this.Qj.zff(ic);this.Coa&&this.Qj.uwe(this.Coa)}update(){this.Qj&&this.Qj.ICp()}get nI(){return this.Qj.nI}get ygc(){return this.Qj.pZd}Dyb(Nb){this.K0f=
Nb}s1h(){if(this.K0f)switch(this.nI){case m.a.Xxb:case m.a.EYa:case m.a.bia:this.Qj.Bpd(!0)}else this.Qj.Bpd(!1)}jaa(Nb){if(this.Qj.isVisible){switch(Nb){case m.a.EYa:case m.a.Xxb:this.nI===m.a.bia&&(Nb=m.a.bia)}this.Qj&&(this.Qj.jaa(Nb),this.s1h());this.update();this.Zyg()}}vVa(Nb,ib){const Rb=this.LLa&&this.nI!==m.a.bia;switch(Nb){case 0:Rb&&this.Qj.zff(ib);break;case 1:Rb&&this.Qj.DDj(ib);break;case 4:Rb&&this.Qj.F9j(ib);break;case 2:this.Qj.M2h();break;case 3:this.Coa=ib[0],Rb&&0<this.J5&&this.Qj.uwe(this.Coa)}}get matchCase(){return this.o$}set matchCase(Nb){this.o$!==
Nb&&(this.o$=Nb,this.H7j())}get matchWholeWord(){return this.p$}set matchWholeWord(Nb){this.p$!==Nb&&(this.p$=Nb,this.H7j())}H7j(){this.Qj.bFe()}UVa(){return this.Qj.UVa()}OQb(){return this.Qj.OQb()}Czg(Nb){this.Qj.Czg(Nb)}CIa(){this.Qj.CIa()}get BVj(){return 0<this.J5&&this.nI!==m.a.Mvc&&this.nI!==m.a.Lvc}LTo(Nb){let ib="";Nb?ib=0<this.J5?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.UVa(),this.OQb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,
this.UVa(),this.OQb()):Nb||0<this.J5&&(ib=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.Zyg(ib)}dispose(){this.Qj.dispose()}E4c(){return this.Qj.E4c()}GYo(Nb,ib=!0){Nb!==this.ygc&&(Nb===F.a.headings?(u.ULS.sendTraceTag(9056651,367,50,""),this.Qj.SUj()):Nb===F.a.find?this.Qj.JUj():Nb===F.a.replace?this.Qj.AVj():Nb===F.a.intelligentPlaceholder&&(ib||this.Qj.uPj(ib),this.Qj.dVj()))}mA(Nb,ib=!0){this.Qj.uPj(ib);Nb?(this.$Ib||this.HVf(),this.Qj.yS(),this.J5||this.nI===
m.a.EYa?a.AFrameworkApplication.J&&a.AFrameworkApplication.J.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.Qj.jaa(m.a.Xxb):this.jaa(m.a.initial)):this.Qj.Vsa()}HVf(){this.$Ib||(this.Qj.initialize(),this.$Ib=!0)}Zyg(Nb=""){var ib=this.IJm();ib&&(Nb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Nb,ib));this.elb&&ib&&this.Coa&&this.nI!==m.a.bia&&this.nI!==m.a.Mvc&&(ib=this.elb.UYd(this.Coa),Nb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
Nb,ib.KXd));(ib=this.Ksm())&&(Nb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,Nb,ib));this.Vp&&Nb&&this.nwh!==Nb&&(this.nwh=Nb,this.Vp.sendNotification(Nb,!0))}IJm(){let Nb="";switch(this.nI){case m.a.pYj:Nb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case m.a.Xxb:Nb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.gzd,this.J5);break;case m.a.bia:this.LLa&&(Nb=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,
this.gzd,this.J5));break;case m.a.EYa:Nb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case m.a.Mvc:Nb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case m.a.Lvc:Nb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return Nb}Ksm(){let Nb="";switch(this.nI){case m.a.initial:Nb=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,this.ttm());break;case m.a.EYa:Nb=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;
break;case m.a.Lvc:Nb=gb.a.TFi();break;case m.a.bia:Nb=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return Nb}ttm(){let Nb="";this.o$&&this.p$?Nb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.o$?Nb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchCase):this.p$&&(Nb=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return Nb}static getInstance(Nb){return Ac.Sm(Nb)}static Sm(Nb){const ib=Qc.getInstance();return new Ac(ib,Nb,w.a.instance.resolve(25),C.a.instance,new v.a(()=>z.a.instance.KZb),x.StaticActiveAppFrame.za().$r)}static xaj(Nb,ib=-1,Rb=-1,ic=-1){u.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:Nb,["SearchComplete.ResultsCount"]:ic,["SearchOpsCorrelation"]:Ac.NKj,["ActionId"]:Ac.wec.actionId,["SourceControlId"]:Ac.wec.tOa,["IsNavPanOpenedAlready"]:Ac.wec.opn,
["IsSearchFromNavPane"]:Ac.wec.btn,["CurrentTab"]:ib,["QueryLength"]:Rb})}static Zjl(Nb,ib,Rb){ib=void 0!==ib&&null!==ib?void 0===ib.SourceControlId||null===ib.SourceControlId?"Unknown":ib.SourceControlId:Nb===G.a.Yyb?"FindKeyboardShorcut":Nb===G.a.Zyb?"ReplaceKeyboardShorcut":"Unknown";switch(Nb){case G.a.jyc:Nb="ShowHeadingsPane";break;case G.a.Yyb:Nb="ShowFindPane";break;case G.a.Zyb:Nb="ShowReplacePane";break;case G.a.myc:Nb="ShowIntelligentPlaceholderPane";break;case G.a.w0a:Nb="ToggleNavigationPane";
break;default:Nb="Unknown"}Ac.wec=new H(Nb,ib,Rb,!0)}}Ac.d2j=100;Ac.NKj=null;Ac.wec=null;Object(I.a)(Ac,"FindReplaceUIManager",null,[421,422,11])},1627:function(I,J,d){d.r(J);I=d(0);var m=d(180),f=d(140),a=d(93),l=d(2),w=d(19),z=d(77),x=d(1070),u=d(66),v=d(20),F=d(8),y=d(18),G=d(480),C=d(1472),H=d(1845),K=d(69),R=d(369),E=d(10),L=d(454),O=d(36),V=d(263),Z=d(729),W=d(49),P=d(155),S=d(536),aa=d(1700);class Y{constructor(Xa,$a,La,bb,Gb,qb,Sa){this.Wvh=this.mAh=this.Vih=this.VK=this.Ggb=this.e4b=this.RSe=
this.KOe=this.sQe=this.lZ=this.fja=this.qja=null;this.PEe=()=>{const cb=this.$xa.kkc(this.VK),pb=this.$xa.Mum(this.VK);this.KOe.innerText=cb.toString();this.RSe.innerText=pb.toString();H.a.N_b(this.qja,1===cb?!1:!0);H.a.N_b(this.fja,cb===pb?!1:!0)};this.fWo=()=>{const cb=this.Zb.getRegion(P.a.S8a);let pb;if(this.lZ&&!this.lZ.disabled)pb=this.lZ;else if(this.qja.disabled){if(this.fja.disabled)return;pb=this.fja}else pb=this.qja;pb.focus();cb.Tk.oA(pb)};this.Sua=(cb,pb)=>{(cb=pb.Tm.currentSelection)&&
this.lZ&&H.a.N_b(this.lZ,O.a.Fm(cb)?!0:!1)};this.spf=()=>{if(!this.fja.disabled){const cb=this.$xa.mtb(this.VK)?y.a.Nke:y.a.Mke;this.ga.Ob(cb,2)}return!0};this.tpf=()=>{if(!this.qja.disabled){const cb=this.$xa.mtb(this.VK)?y.a.Pke:y.a.Oke;this.ga.Ob(cb,2)}return!0};this.rpf=()=>{this.lZ&&!this.lZ.disabled&&this.ga.Ob(y.a.y6i,2);return!0};this.Zb=Xa;this.ga=bb;this.Fg=Gb;this.oe=qb;this.ib=Sa;this.$xa=La;this.vaa=document.createElement("div");this.vaa.classList.add("FootnoteEndnoteActionBarControl");
this.vaa.style.zIndex=String(V.a.J0d);this.vaa.style.position="relative";this.UGc=document.createElement("div");this.UGc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.vaa.appendChild(this.UGc);this.qEl();this.vaa.appendChild(this.e4b);this.vaa.appendChild(this.Ggb);this.G1=f.KeyInputManager.lc(a.a.T4,0);this.A9m();this.z9m()}Yka(Xa){F.ULS.shipAssertTag(4520065,308,this.$xa.qta(Xa));if(this.VK!==Xa){this.VK=Xa;this.PEe();Xa=this.$xa.mtb(this.VK);this.eHl(Xa);this.VK.WPh(this.PEe);
let $a="",La="";const bb=this.$xa.kkc(this.VK);-1!==bb&&($a=(bb-1).toString(),La=(bb+1).toString());Xa?(this.fja.title=this.fja.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,La),this.qja.title=this.qja.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,$a)):(this.fja.title=this.fja.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,
La),this.qja.title=this.qja.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,$a));this.fxb()}}JNb(){this.VK&&(this.lZ&&this.lZ.parentNode===this.e4b&&this.e4b.removeChild(this.lZ),this.iPa(),this.VK.pDo(this.PEe),this.VK=null)}dispose(){this.Zb.ie(P.a.S8a).qt(this.G1)}eHl(Xa){3===this.ga.mode&&(Xa=Xa?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.lZ=this.Nsf("FootnoteEndnoteFormattingOptionButton",
"FootnoteEndnoteActionBarFormattingButton",Xa,null),K.a.Is(this.lZ,K.a.Yja,Xa),this.e4b.appendChild(this.lZ))}qEl(){this.e4b=document.createElement("div");this.e4b.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.Ggb=document.createElement("div");this.Ggb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.qja=this.Nsf("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");
this.Ggb.appendChild(this.qja);this.KOe=L.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.Ggb.appendChild(this.KOe);this.sQe=L.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.sQe.innerText=" / ";this.Ggb.appendChild(this.sQe);this.RSe=L.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.Ggb.appendChild(this.RSe);this.fja=this.Nsf("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");
this.Ggb.appendChild(this.fja)}Nsf(Xa,$a,La,bb){Xa=H.a.x7a(Xa,$a,La,bb,void 0===bb||null===bb);Xa.setAttribute(K.a.Sh,K.a.X$);return Xa}A9m(){const Xa=this.Zb.ie(P.a.S8a);Xa.parent=Z.a.Kq;Xa.bindAction(this.G1,y.a.U6);Xa.Pja(this.fWo)}z9m(){var Xa=new R.DOMFocusListing(()=>this.vaa);Xa.cha=!1;Xa.un(2);Xa.un(1);Xa=this.Zb.inb(this.vaa,this.Zb.ie(P.a.S8a),Xa);Xa.WZa();Xa.BP=!0}fxb(){this.lZ&&(this.Fg.nb(E.a.click,this.lZ,this.rpf),this.Vih=this.oe.exb(this.lZ,this.rpf,a.a.Tu));this.Fg.nb(E.a.click,
this.qja,this.tpf);this.mAh=this.oe.exb(this.qja,this.tpf,a.a.Tu);this.Fg.nb(E.a.click,this.fja,this.spf);this.Wvh=this.oe.exb(this.fja,this.spf,a.a.Tu);this.ib.BA(this.Sua)}iPa(){this.lZ&&(this.Fg.xc(E.a.click,this.lZ,this.rpf),this.oe.xAb(this.lZ,this.Vih));this.Fg.xc(E.a.click,this.qja,this.tpf);this.oe.xAb(this.qja,this.mAh);this.Fg.xc(E.a.click,this.fja,this.spf);this.oe.xAb(this.fja,this.Wvh);this.ib.hha(this.Sua)}static Hum(){return Y.Ium()}static Ium(){return new Y(z.FocusManager.instance(),
aa.a.instance,S.a.instance,l.AFrameworkApplication.va,v.StaticActiveAppFrame.za().dF,v.StaticActiveAppFrame.za().eF,W.a.instance)}}Object(I.a)(Y,"FootnoteEndnoteActionBarControl",null,[460]);var X=d(298),ca=d(12),fa=d(1548),ja=d(1798);class ra{constructor(Xa,$a,La,bb,Gb,qb,Sa,cb,pb,vb,xb,Bb){this.BG=null;this.kW=!1;this.nx=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.h$b=Xa;this.Dhc=$a;this.nDc=La;this.VHk=bb;this.l2e=Gb;this.Zm=qb;this.Nib=Sa;this.Fg=cb;this.Syh=pb;this.uuk=xb;this.Ls=
this.h$b.ownerDocument.createElement("div");this.Ls.id="FootnoteEndnoteControlOverlay";this.Ls.className="EditingSurfaceOverlay";this.JK=this.Iom();this.p4(!1);this.h$b.appendChild(this.Ls);this.h$b.appendChild(this.JK);this.Dhc.bind();this.Ai=null;this.ga=Bb;this.eRa=vb}sIo(){const Xa=this.Syh();Xa&&Xa.jj&&(Xa.Uxb=0,Xa.ZRd())}H6j(Xa){if(this.XTc){const $a=this.XTc.ssa;$a&&($a.tZf=Xa)}}get fK(){return this.kW}get XTc(){return this.BG}get dialog(){return this.Ai}get ko(){return null!=this.QXg?this.QXg:
this.QXg=w.a.instance.Ra(6)}qtf(){this.Ai=ja.a.Qum()}Gld(){this.Ai=null}show(Xa=!0){this.kW||(this.H6j(!0),this.uuk(),this.p4(!0),this.gB(),Xa&&this.setFocus())}setFocus(){this.kW&&(this.Dhc.pxc(),this.VHk())}update(){this.kW&&(this.BG.isConnected?this.nDc.PEe():this.dismiss())}dismiss(Xa=!1,$a=!1){this.kW&&(this.H6j(!1),this.Vca(),this.sIo(),this.p4(!1),this.l2e($a),this.Ai&&(this.ga.Ob(ca.a.jZc,2),this.Ai=null),!Xa&&this.BG&&this.BG.isConnected&&this.eRa.VPo(this.BG),this.JNb())}bHo(Xa){const $a=
null!==this.ko.instance?this.ko.instance.Cj:1;this.JK.style.width=Xa.G6h*$a+"px";this.nx.style.width=Xa.XWc*$a+"px";this.JK.style.marginLeft=Xa.Afc*$a+"px";this.Zm?this.nx.style.marginRight=Xa.Zrf*$a+"px":this.nx.style.marginLeft=Xa.Jfc*$a+"px";if(Xa=this.Syh())Xa=Xa.uK,this.JK.style.bottom=Xa.offsetHeight-Xa.clientHeight+"px"}Yka(Xa){F.ULS.shipAssertTag(4520073,308,this.Nib.qta(Xa));this.BG!==Xa&&(this.BG=Xa,this.Dhc.Yka(Xa),this.nDc.Yka(this.BG))}dispose(){this.dismiss();this.Dhc.dispose();this.nDc.dispose()}gB(){this.Fg&&
this.Fg.nb(E.a.click,this.Ls,this.onClick)}Vca(){this.Fg&&this.Fg.xc(E.a.click,this.Ls,this.onClick)}Iom(){let Xa;Xa=document.createElement("div");Xa.classList.add("FootnoteEndnoteControl");this.nx=document.createElement("div");this.nx.classList.add("FootnoteEndnoteContent");this.nx.appendChild(this.Dhc.vaa);this.nx.appendChild(this.nDc.vaa);Xa.appendChild(this.nx);return Xa}p4(Xa){Xa=(this.kW=Xa)?"":"none";this.Ls.style.display=Xa;this.JK.style.display=Xa}JNb(){this.BG&&(this.Dhc.JNb(),this.nDc.JNb(),
this.BG=null)}static Z7d(){const Xa=v.StaticActiveAppFrame.za().kb.Jc;return Xa&&Xa.jj?Xa:null}static Lum(Xa,$a,La,bb,Gb){return new ra(Xa,$a,La,bb,Gb,l.AFrameworkApplication.isRtl,S.a.instance,X.a.instance,ra.Z7d,fa.a.instance,ra.vWl,l.AFrameworkApplication.va)}static vWl(){l.AFrameworkApplication.va.Pb(ca.a.Zrb,2,!0)}}Object(I.a)(ra,"FootnoteEndnoteControl",null,[461]);var ya=d(810),Ha=d(6),Wa=d(203),Ma=d(30),ua=d(7),Ka=d(21),za=d(74),Fa=d(1699),ea=d(351),la=d(960),Na=d(583),Aa=d(1343),wa=d(60),
va=d(251);class Pa extends ea.a{constructor(Xa,$a,La,bb,Gb,qb,Sa,cb,pb,vb,xb,Bb,jc,xc,Qc,fd,Ac){super(P.a.ela,La,bb,Gb,Sa,cb,pb,vb,xb,Bb,jc,xc,Qc,fd,Ac);this.Jch=Xa;this.H4a=qb;this.H4a.krd=this;$a(this);this.features.EGg=!0}get FYi(){return!0}YPf(){const Xa=this.Jch.mGf(this);return la.ViewReference.jH(this,Xa)}eyf(Xa){Object(va.a)(Pa,Xa)||this.Jch.byf()}I4c(){return Na.a.Nej}Vv(){super.Vv();this.H4a.Xki()}xF(Xa,$a=null){super.xF(Xa,$a);this.H4a.Jki(this.qd.qk)}detach(){this.H4a.Wki();super.detach()}q4d(){this.Vv()}static v7a(){const {FootnoteEndnoteControlManager:Xa}=
d(1627);return new Pa(Xa.instance,Aa.a.krf,v.StaticActiveAppFrame.za().kb,Object(wa.a)(),()=>w.a.instance.resolve(50),w.a.instance.resolve(729),l.AFrameworkApplication.va,w.a.instance.resolve(77),w.a.instance.resolve(159),w.a.instance.Ra(18),w.a.instance.resolve(21),w.a.instance.Ra(6),w.a.instance.Oa(289),w.a.instance.Oa(17),w.a.instance.Oa(11),w.a.instance.Oa(13),w.a.instance.Oa(12))}}Object(I.a)(Pa,"FootnoteEndnoteEditView",ea.a,[]);class Ta{constructor(Xa,$a,La,bb=!1){this.WDb=null;this.gXe=this.A$g=
!1;this.odm=()=>{const Gb=String.format("{0} {1}",this.gXe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.Gw.sendNotification(Gb,!0)};this.Zb=Xa;this.$xa=$a;this.Oia=La();this.eEd=bb;this.vaa=document.createElement("div");this.vaa.classList.add("FootnoteEndnoteEditControl");this.UGc=document.createElement("div");
this.UGc.classList.add("FootnoteEndnoteEditControlDividerElement");this.FJb=(new ya.a(this.vaa,"WACViewPanel_FootnoteEndnoteEditControl")).CK;this.vaa.appendChild(this.UGc);this.vaa.appendChild(this.FJb)}get Gw(){return null!=this.yTg?this.yTg:this.yTg=w.a.instance.resolve(25)}Yka(Xa){F.ULS.shipAssertTag(4520077,308,this.$xa.qta(Xa));this.WDb!==Xa&&(this.WDb=Xa,this.Sjf(this.WDb),this.gXe=this.$xa.mtb(this.WDb),this.eEd?(this.Oia.S_b(K.a.VSd),this.Zb.ie(P.a.ela).T$(this.odm)):this.Oia.dOj(this.gXe?
WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,K.a.VSd))}JNb(){const Xa=S.a.instance.mtb(this.WDb)?"Footnote":"Endnote";F.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Xa,["CalloutHeight"]:this.vaa.scrollHeight});this.Rob();this.WDb=null}bind(){this.A$g||(this.Oia.Wdc(this.FJb),this.A$g=!0)}pxc(){const Xa=this.qLm();Xa?this.Oia.Kc(Xa):this.Oia.vod()}dispose(){this.Rob()}Sjf(Xa){this.Rob();
this.Oia.xF(Xa,Xa.qk)}Rob(){this.Oia.detach()}qLm(){let Xa=0;var $a=null,La=Ha.a.Za(this.WDb);Wa.OutlineNavigator.Mba(La);if((La=Ma.OutlineElementNavigator.Me(La))&&ua.ParagraphReader.Vb(La)){if($a=Ta.Jym(La)){Xa=$a.Jb.cp+1;$a=Fa.FootnoteEndnoteDefaultContentInserter.Mdi;const bb=$a.length;Xa+bb<=ua.ParagraphReader.textLength(La)&&La.characterData.substr(Xa,bb)===$a&&(Xa+=bb)}$a=Ka.SelectionFactory.ve(La,Xa)}return $a}static Num(){return Ta.Oum()}static Oum(){return new Ta(z.FocusManager.instance(),
S.a.instance,()=>Pa.v7a(),l.AFrameworkApplication.J.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static Jym(Xa){Xa=za.i(Xa,10);return 0<Xa.length?Xa[Xa.length-1]:null}}Object(I.a)(Ta,"FootnoteEndnoteEditControl",null,[459]);var kb=d(1126);class gb{constructor(Xa,$a){this.$Ga=Xa;this.Zm=$a}llc(Xa,$a){Xa=this.$Ga.llc(Xa);var La=$a.clientWidth;const bb=$a.scrollLeft,Gb=Xa.G6h;let qb=Xa.Afc,Sa=Xa.Afc,cb=gb.s9f,pb=gb.t9f,vb=Gb,xb=Xa.XWc;this.Zm?pb=Xa.Zrf-Sa:cb=Xa.Jfc-qb;La<Gb&&(qb=Math.max(qb-
bb,0),vb=La-qb,this.Zm?(La=$a.scrollWidth-bb-La,Sa=$a.scrollWidth-Xa.Afc-Gb,pb=Math.max(Xa.Zrf-La-Sa,gb.t9f),xb=vb-pb-gb.s9f):(cb=Math.max(Xa.Jfc-bb-qb,gb.s9f),xb=vb-cb-gb.t9f));return new kb.a(qb,vb,cb,pb,xb)}}gb.s9f=25;gb.t9f=50;Object(I.a)(gb,"FootnoteEndnoteViewPositionProvider",null,[]);class tb{constructor(Xa,$a=0,La=0){this.clientWidth=Xa;this.scrollLeft=$a;this.scrollWidth=La?La:Xa}}Object(I.a)(tb,"PageViewScrollContainerSizeInfo",null,[]);d.d(J,"FootnoteEndnoteControlManager",function(){return hb});
class hb{constructor(Xa,$a,La,bb,Gb,qb,Sa,cb){this.uG=null;this.xca=()=>{this.kq.eL(P.a.ela);this.kq.eL(P.a.S8a);this.kq.Cx(m.AFrame.Jo);this.Zb.oSc(P.a.ela);this.Zb.Eg(P.a.ela)};this.nWo=pb=>{this.kq.Cx(P.a.ela);this.kq.Cx(P.a.S8a);this.kq.eL(m.AFrame.Jo);this.Zb.FYc(P.a.ela);(pb||this.Zb.currentScope&&(this.Zb.currentScope.name===P.a.ela||this.Zb.currentScope.name===P.a.S8a))&&this.Zb.Eg(m.AFrame.Jo)};this.Zb=Xa;this.kq=$a;this.Jxk=La;this.Kxk=bb;this.Ixk=Gb;this.$Ga=qb;this.kxa=Sa;this.T1=cb;this.G1=
f.KeyInputManager.lc(a.a.T4,0);this.zVf();this.IW()}get control(){return this.uG}get dialog(){return this.control.dialog}get MWi(){return this.control.fK}qtf(){this.control.qtf()}Gld(){this.control.Gld()}bind(Xa){this.dAl(Xa)}lDg(Xa){if(this.control.XTc!==Xa.q7a)this.control.dismiss();else if(this.MWi)return;this.chc();this.control.Yka(Xa.q7a);this.control.show(Xa.Uye)}chc(){if(this.T1){const Xa=new x.a(!0);this.T1.tNa(Xa)}}O0(){this.control.setFocus()}btd(){this.control.update()}byf(Xa,$a=!1){this.chc();
this.control.dismiss(Xa,$a)}$Go(Xa){const $a=hb.Z7d().uK;Xa=this.$Ga.llc(Xa,new tb($a.clientWidth,$a.scrollLeft,$a.scrollWidth));this.control.bHo(Xa)}dispose(){this.control.dispose();this.Zb.ie(P.a.ela).qt(this.G1)}mGf(Xa){F.ULS.shipAssertTag(4520074,308,!!this.control);F.ULS.shipAssertTag(4520075,308,!!this.control.XTc);return this.nGf(this.control.XTc.id,Xa)}dAl(Xa){const $a=this.Kxk(),La=this.Ixk();this.uG=this.Jxk(Xa,$a,La,this.xca,this.nWo)}zVf(){const Xa=this.Zb.ie(P.a.ela);Xa.parent=3===l.AFrameworkApplication.va.mode?
u.a.GF:u.a.nvc;this.Zb.Mef(P.a.ela);Xa.bindAction(this.G1,y.a.U6)}IW(){this.kq.IW(P.a.ela);this.kq.IW(P.a.S8a)}nGf(Xa,$a){return()=>{const La=hb.Z7d().qd.Ic.Eb(Xa);this.kxa.cic();if(!La.isConnected)return F.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.lDg(new G.a(La,!0));return $a}}static Sm(){const Xa=new gb(w.a.instance.resolve(730),l.AFrameworkApplication.isRtl);return new hb(z.FocusManager.instance(),v.StaticActiveAppFrame.za().Jy,ra.Lum,
Ta.Num,Y.Hum,Xa,C.a.instance,w.a.instance.resolve(258),w.a.instance.resolve(71))}static Z7d(){const Xa=v.StaticActiveAppFrame.za().kb.Jc;return Xa&&Xa.jj?Xa:null}static get instance(){return null!=hb.$Zg?hb.$Zg:hb.$Zg=hb.Sm()}}Object(I.a)(hb,"FootnoteEndnoteControlManager",null,[434])},1632:function(I,J,d){function m(H,K){var R=u.a.instance;const E=v.FocusManager.instance();R.S$(H);H=E.ie(H);R=new F.DOMFocusListing(()=>K);R.cha=!0;R.un(8);R.un(2);E.inb(K,H,R).BP=!0}I=d(0);var f=d(443),a=d(2),l=d(18),
w=d(41),z=d(1017),x={get interop(){var H=null===fishBowlUx||void 0===fishBowlUx?void 0:fishBowlUx.interop;if(!H)throw Error("fishBowlUx chunk is accessed before loading");return H}},u=d(413),v=d(77),F=d(369),y=d(1021);d.d(J,"a",function(){return G});class G{static initialize(H,K,R,E){f.a.N7c("ribbon",this.Bwg);this.nia=K;this.eA=R;this.bsj=E;this.exg=H;this.fNa=document.getElementById(this.bsj);try{this.qvb=document.createElement("div"),this.qvb.id=this.Abg,this.qvb.classList.add(this.Wam),this.fNa.append(this.qvb),
this.MDn().then(()=>{this.interop=null===x||void 0===x?void 0:x.interop;this.controller=this.interop.renderFishBowlNavButton(this.qvb,{onclick:this.XRn,onVisibilityChange:this.CHp});this.DBg();this.c3o();this.$Un();w.a("MicroNavIconShown")})}catch{w.a("MicroNavFloatieInitializationFailed")}}static async DBg(){this.nia&&this.nia.execute(H=>{H.oY(()=>{setTimeout(this.controller.reposition,10)})})}static async c3o(){this.eA&&this.eA.execute(H=>{H.Zcc((K,R)=>this.HNj(R))})}static HNj(H){0==H.AMa?this.controller.changeContentContainer(!1):
this.controller.changeContentContainer(!0)}static async MDn(){return a.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("fishBowlUx"):(await Object(z.b)(this.exg)).$D.loadScript("fishBowlUx")}}var C=G;G.bsj="";G.Abg="FishBowlNavButton";G.nia=null;G.eA=null;G.Wam="FishBowlNavButton";G.controller=null;G.interop=null;G.qvb=null;G.fNa=null;G.Sde=!1;G.Bwg="NavFloatie";G.eJj=!1;G.$Un=()=>{C.eJj||(f.a.gcb("ribbon",C.Bwg),f.a.sWb("ribbon",C.Bwg),C.eJj=!0)};G.CHp=(H,K)=>{!H||
K||C.Sde||(C.Sde=!0,m(C.Abg,C.qvb));if((!H||K)&&C.Sde){C.Sde=!1;H=C.Abg;K=u.a.instance;const R=v.FocusManager.instance();R.currentScope.name===H&&R.Eg(y.a.Jo);K.Cx(H)}};G.XRn=()=>{a.AFrameworkApplication.va.Pb(l.a.w0a,2,null,void 0)};G.dispose=()=>{C.qvb&&C.controller&&(C.eA.execute(H=>{H.kue((K,R)=>C.HNj(R))}),C.nia.execute(H=>{H.BNa(()=>{C.controller.reposition()})}),C.interop.dispose(C.qvb))};G.esp=()=>{C.controller&&C.controller.hide()};G.jEe=()=>{C.controller&&C.controller.show()};Object(I.a)(G,
"NavButton",null,[])},1656:function(I,J,d){d.d(J,"a",function(){return u});I=d(0);var m=d(8),f=d(180),a=d(2),l=d(10),w=d(260),z=d(153),x=d(19);class u{constructor(v,F){this.Yu=null;this.KKd=!1;this.Qjb=0;this.Erh="";this.gMe={};this.gxj=()=>{this.Zb&&this.Zb.WN(f.AFrame.Uua,!0)};this.gne=()=>{this.AZc();this.Cgi();this.Ceg();this.pyb();return!0};this.hne=()=>{this.AZc();this.Cgi();this.Ceg();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.pyb()},0)});return!0};this.ogg=y=>{y.stopPropagation()};
this.U0e=v;this.Zb=F;this.mxh=this.ogg;this.vqh=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Hb.kCa;this.ay=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Hb.A3;this.wqh=!!a.AFrameworkApplication.J&&a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)}onMenuOpen(){0<this.Qjb?this.Qjb++:(this.Qjb++,a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>
{window.setTimeout(this.gxj,0)}):this.gxj(),this.showModal())}Cvn(){const v=document.getElementById("WACToolbarContainer");return!!v&&"block"===v.style.display}getRibbonMode(){return this.wqh&&this.Cvn()?"Toolbar":z.f()}wlm(){const v=this.getRibbonMode(),F=appChrome.selectors.getShyState();return String.format("{0}{1}",v,this.vqh&&F.isActive&&0!==F.state?"_ShyRibbon":"")}hQm(v){var F=0;if(this.ay){if(this.gMe[v])return this.gMe[v];(F=document.getElementById("BusinessBar"))||m.ULS.sendTraceTag(524142489,
340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");F=F?F.offsetTop:0;this.gMe[v]=F}return F}showModal(){if(!this.Yu)if(this.Yu=this.createElement("div"),this.Yu.setAttribute("id","ReactModalDiv"),this.Yu.style.position="absolute",this.Yu.style.bottom="0px",this.Yu.style.left="0px",this.Yu.style.right="0px",this.Yu.style.backgroundColor="white",this.Yu.style.opacity="0.0",this.ay){var v=document.getElementById("regionComposerRoot");v&&v.appendChild(this.Yu)}else this.U0e.appendChild(this.Yu);
v=this.wlm();if(v!==this.Erh){const y=this.hQm(v);var F=appChrome.selectors.getShyState();this.vqh&&F.isActive&&0!==F.state?(F=this.wqh?appChrome.api.getRibbonHeight("Multiline")-appChrome.api.getRibbonHeight("SingleLine"):appChrome.api.getRibbonHeight(z.f()),this.Yu.style.top=String.format("{0}px",y+F)):this.Yu.style.top=String.format("{0}px",y);this.Erh=v}this.Yu.style.display="block";this.Yu.style.visibility="visible";this.Yu.style.zIndex="1000";this.KKd||(window.addEventListener("wheel",this.mxh,
!0),this.Ree()?w.a.instance.nb(l.a.PP,this.Yu,this.hne):w.a.instance.nb(l.a.jt,this.Yu,this.gne),this.KKd=!0)}onMenuClose(){this.Qjb--;0<this.Qjb||(0>this.Qjb?this.Qjb=0:this.SOi())}Ceg(){this.Qjb=0;this.ayf();this.SOi()}createElement(v){v=document.createElement(v);v.setAttribute("unselectable","on");return v}ROi(){this.Zb&&this.Zb.currentScope&&this.Zb.currentScope.name===f.AFrame.Uua&&!a.AFrameworkApplication.oc.iz&&this.Zb.oV(f.AFrame.Uua,!1);this.Yu&&(this.Yu.style.zIndex="-1",this.Yu.style.visibility=
"hidden",this.Yu.style.display="none");this.KKd&&(window.removeEventListener("wheel",this.mxh,!0),this.Ree()?w.a.instance.xc(l.a.PP,this.Yu,this.hne):w.a.instance.xc(l.a.jt,this.Yu,this.gne),this.KKd=!1)}SOi(){this.Ree()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.ROi()},0)}):this.ROi()}pyb(){4===a.AFrameworkApplication.ta.Hb.Uk&&a.AFrameworkApplication.J.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?a.AFrameworkApplication.ta.pyb():this.Zb.Eg(f.AFrame.Jo)}AZc(){const v=x.a.instance.Oa(731);
v&&v.AZc()}ayf(){const v=x.a.instance.Oa(731);v&&v.ayf()}Cgi(){a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Hb.FXa&&(this.Ree()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}Ree(){return a.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(I.a)(u,"ReactModalDiv",null,[])},1686:function(I,J,d){d.d(J,"a",function(){return a});I=d(0);var m=d(1032),f=
d(5);class a{constructor(l,w){this.BQ=this.QMc=null;this.hb=l;this.vhb=w}get key(){return"COMMENT"}get Jv(){return WordEditorIntl.WordEditorStrings.L_Comment}get iP(){return this.BQ}reset(l){this.BQ=l.node}MEa(l){let w=null;if(this.QMc&&this.SWi(l,this.iP,this.QMc))return w=Object.assign(new m.a,{fG:this.key,contentObject:this.QMc}),{returnValue:!0,OG:w};this.QMc=null;const z=this.vhb.Mtf(this.iP);if(this.vhb.ZXf(z)){let x=z.$d();for(;x;){if(this.SWi(l,this.iP,x))return this.QMc=x,w=Object.assign(new m.a,
{fG:this.key,contentObject:x,description:this.MVa()}),{returnValue:!0,OG:w};x=z.Mk()}}return{returnValue:!1,OG:w}}SWi(l,w,z){if(this.VTj(z))return!1;const x=this.vhb.olc(z,!0),u=this.vhb.olc(z,!1);return x&&u&&this.hb.q$c(w,x,u)&&(w=this.vhb.OAa(x,z.id,!0))&&(x!==this.iP||w.Jb.cp<=l)&&(z=this.vhb.OAa(u,z.id,!1))&&(u!==this.iP||z.Jb.cp>l||z.Jb.cp>=l)?!0:!1}VTj(l){return l.ka(f.a.FI,!1)}MVa(){return null}}Object(I.a)(a,"CommentDetailsProvider",null,[144,136])},1693:function(I,J,d){d.d(J,"a",function(){return f});
I=d(0);J=d(517);var m=d(234);class f extends J.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new m.a,{T_:f.getTypeName(),B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(I.a)(f,"DocumentTypeClassifierAnnotation",J.a,[])},1698:function(I,J,d){var m=this&&this.tQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,
w);if(!x||("get"in x?!l.FM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1881),J);f(d(1882),J)},1699:function(I,J,d){d.r(J);d.d(J,"FootnoteEndnoteDefaultContentInserter",function(){return K});I=d(0);var m=d(19),f=d(46),
a=d(2),l=d(30),w=d(104),z=d(549),x=d(25),u=d(5),v=d(13),F=d(58),y=d(108),G=d(1142),C=d(887),H=d(1580);class K{constructor(R,E,L,O,V=null){this.$c=R;this.frk=E;this.Zm=L;K.Rh=O;this.ldh=V||K.cIl}get VN(){return null!=this.R1g?this.R1g:this.R1g=m.a.instance.resolve(110)}aGl(R,E){var L=this.$c.Vl();L.set(R);this.VN.ASb(L,null,!0);K.Rh.k0b(L.currentNode,this.Zm);R=l.OutlineElementNavigator.Me(L);K.Mha.zod(E?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,R);L=
this.ldh(L.currentNode);K.Bg.Ue(L,K.Mdi);this.gcn(R,E)}gcn(R,E){var L=this.frk(F.a.bna);L.setValue(u.a.ht,1===E?36:35);L.setValue(u.a.ika,!0);L.setValue(v.a.Qca,!0);const O=R.Ic.nu(L,f.a.create());L=this.ldh(R);K.Bg.Tla(L,V=>C.a.getInstance(V,O,!0),H.a.Rui(R,E,Object(w.a)()))}static Sm(){return new K(new z.a,Object(y.a)(G.a.instance,G.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,m.a.instance.resolve(16))}static get Mha(){return null!=K.x4g?K.x4g:K.x4g=m.a.instance.resolve(393)}static get Bg(){return null!=
K.gUg?K.gUg:K.gUg=m.a.instance.resolve(323)}static get instance(){return null!=K.m_g?K.m_g:K.m_g=K.Sm()}static cIl(R){return x.a.Tc(R,0)}}K.Mdi=" ";K.Rh=null;Object(I.a)(K,"FootnoteEndnoteDefaultContentInserter",null,[492])},1700:function(I,J,d){d.d(J,"a",function(){return w});I=d(0);var m=d(549),f=d(536),a=d(1472),l=d(1580);class w{constructor(z,x){this.kxa=x}f$d(z,x,u){return(z=this.kxa.DCi(z.node,u?z.cpBegin:z.cpEnd,x))?z.r7():null}uLi(z,x){return(z=this.kxa.JHm(z.node,z.cpBegin,x))?z.r7():null}static p3c(){return new w(f.a.instance,
a.a.instance,new m.a,l.a.instance)}static get instance(){return null!=w.LZg?w.LZg:w.LZg=w.p3c()}}Object(I.a)(w,"FootnoteEndnoteNavigator",null,[456])},1712:function(I,J,d){d.d(J,"a",function(){return w});I=d(0);var m=d(2159),f=d(2),a=d(42),l=d(19);class w{constructor(z,x,u,v,F,y){this.Lxa=z;this.Mxa=x;this.aVe=u;this.m1=v;this.Qzd=F;this.E4b=y}get TUj(){return!this.Mxa&&!this.aVe}get Mij(){return 2===this.E4b?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get sli(){return CommonUIStrings.l_OICErrorMessageNoOffice}get PPi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Wrb(){return CommonUIStrings.l_OICErrorHelpLink}get GOi(){return"OICFailure"}get icon(){return 3}get wQd(){return 2===
this.E4b?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}fqo(z){this.Yij(z)}fBn(z){this.Yij(z)}Yij(z){let x=10;1===z?(l.a.instance.resolve(120).G3f(this.E4b),x=3):2===z&&((!this.aVe||this.aVe(this.m1))&&this.Mxa&&m.a.instance.tJl(this.Mxa,this.Lxa,this.m1),x=5);(0===z||1===z)&&this.Lxa&&this.Lxa(this.m1);f.AFrameworkApplication.tld(a.a.Zpj,this.Qzd,x);this.dispose()}dispose(){this.m1=this.Mxa=
this.Lxa=null}}Object(I.a)(w,"AOICErrorDialogWithTrial",null,[11])},1798:function(I,J,d){I=d(0);var m=d(172),f=d(16),a=d(69),l=d(19),w=d(2),z=d(226),x=d(618);class u{static get lh(){return m.a.ry(u.Qn,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}u.Qn="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(I.a)(u,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var v=d(18),F=d(3);d.d(J,"a",function(){return y});class y extends m.a{constructor(G,C,H){super();this.Akh=!1;this.kZ=null;this.ldm=K=>{switch(K){case 1:this.ga.Ob(v.a.zqi,2);break;case 2:this.ga.Ob(v.a.Aqi,2);break;case 0:this.ga.Ob(v.a.Bqi,2)}};this.Fv=C;this.cW=!1;this.v7b=y.Ucm;this.ii=G;this.ga=H;this.Pg="FootnoteEndnoteFormattingOptionsDialog";this.Ed=2;this.lh=u.lh;this.Qe(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.Qe(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.gi(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.ldm,null);this.Qrb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.kZ}set fontName(G){this.kZ=G;if(G=document.getElementById("FontSizeComboBox"))G.focus(),this.ii.Fe()}get fontSize(){return this.v7b}get Qrb(){return this.Akh}set Qrb(G){this.Akh=G;this.peo()}Pba(){this.ZTd("FontStyleComboBox",
"FontPlaceholder",v.a.d4d.toString(),v.a.xxj.toString(),v.a.Bhd.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.ZTd("FontSizeComboBox","FontPlaceholder",v.a.e4d.toString(),F.a.Jid.toString(),v.a.Chd.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const G=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
f.a.$_(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),C=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',f.a.$_(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.EUc("NoStyle","IndentPlaceholderStyles",
v.a.Dqi.toString(),v.a.yxj.toString(),G,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.EUc("FirstLineIndent","IndentPlaceholderStyles",v.a.Cqi.toString(),v.a.Kog.toString(),C,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}ZTd(G,C,H,K,R,E,L){H=z.c(G,H,!0,!0,K,R,f.a.If(E),!0,L);this.yYd(G,C,H,"Medium")}EUc(G,C,H,K,R,E,L){H=z.f(G,H,K,f.a.If(R),f.a.If(E),L);this.yYd(G,C,H,"Large",E)}yYd(G,C,H,K,R=null){C=document.getElementById(C);
this.Fv.V5a(G,H);H=this.Fv.RPb(G,K);R&&a.a.ySd(H,String.format("{0}Label",G),R);C.appendChild(H);this.Fv.Oua(G)}peo(){this.Fv.Oua("NoStyle");this.Fv.Oua("FirstLineIndent")}dispose(){this.cW||(this.Fv.K0("FontStyleComboBox"),this.Fv.K0("FontSizeComboBox"),this.Fv.K0("NoStyle"),this.Fv.K0("FirstLineIndent"),this.cW=!0);this.ii.Fe();super.dispose()}static get s0a(){return l.a.instance.resolve(48).Cha}static Rum(){return new y(x.a.Pm,y.s0a,w.AFrameworkApplication.va)}static Qum(){return y.Rum()}}y.Ucm=
-1;Object(I.a)(y,"FootnoteEndnoteFormattingOptionsDialog",m.a,[])},1835:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a){this.ki=this.lGd=0;this.Vjh=a;this.vQk=f}rvb(){return this.lGd-this.ki>=this.vQk}reset(){this.ki=this.lGd=this.Vjh()}update(){this.lGd=this.Vjh()}}Object(I.a)(m,"TimeBasedTaskYieldStrategy",null,[781])},1851:function(I,J,d){var m=this&&this.tQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||("get"in
x?!l.FM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1852),J);f(d(1853),J)},1852:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1853:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.EndnoteSubDocument=
J.FootnoteSubDocument=J.ShapeSubDocument=J.TextboxSubDocument=J.CommentSubDocument=J.HeaderFooterSubDocument=J.MainSubDocument=void 0;const m=d(411);class f{constructor(v){m.SchemaObject.assign(f,this,v)}static getTypeName(){return"AugLoop_Word_MainSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[f.getTypeName()])}}J.MainSubDocument=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(v){m.SchemaObject.assign(a,
this,v)}static getTypeName(){return"AugLoop_Word_HeaderFooterSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[a.getTypeName()])}}J.HeaderFooterSubDocument=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(v){m.SchemaObject.assign(l,this,v)}static getTypeName(){return"AugLoop_Word_CommentSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[l.getTypeName()])}}J.CommentSubDocument=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class w{constructor(v){m.SchemaObject.assign(w,this,v)}static getTypeName(){return"AugLoop_Word_TextboxSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[w.getTypeName()])}}J.TextboxSubDocument=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class z{constructor(v){m.SchemaObject.assign(z,this,v)}static getTypeName(){return"AugLoop_Word_ShapeSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[z.getTypeName()])}}J.ShapeSubDocument=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class x{constructor(v){m.SchemaObject.assign(x,this,v)}static getTypeName(){return"AugLoop_Word_FootnoteSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,[x.getTypeName()])}}J.FootnoteSubDocument=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class u{constructor(v){m.SchemaObject.assign(u,this,v)}static getTypeName(){return"AugLoop_Word_EndnoteSubDocument"}static getBaseTypes(){return["AugLoop_Core_SubDocument"]}static typeGuard(v){return m.SchemaObject.matchesTypesFor(v,
[u.getTypeName()])}}J.EndnoteSubDocument=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},1881:function(I,J){Object.defineProperty(J,"__esModule",{value:!0});J.ObjectSchemaType=J.ObjectSemantic=J.SequenceType=J.IntentIds=void 0;(function(d){d.Logging="Logging";d.ZeroTermMenu="ZeroTermMenu";d.Floatie="Floatie"})(J.IntentIds||(J.IntentIds={}));(function(d){d.CommandId="CommandId";d.ControlId="ControlId"})(J.SequenceType||(J.SequenceType={}));(function(d){d.CommandIdHistory="CommandIdHistory";d.ControlIdHistory=
"ControlIdHistory";d.FilteredCommandIdHistory="FilteredCommandIdHistory";d.CanvasContext="CanvasContext";d.ApplicationContext="ApplicationContext";d.UserContext="UserContext";d.GenericSuggestions="GenericSuggestions"})(J.ObjectSemantic||(J.ObjectSemantic={}));(function(d){d.CommandExecutionSequence="CommandExecutionSequence";d.WordCanvasContext="WordCanvasContext";d.ApplicationContext="ApplicationContext";d.UserContext="UserContext";d.RankedSuggestion="RankedSuggestion"})(J.ObjectSchemaType||(J.ObjectSchemaType=
{}))},1882:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.SearchSuggestionAnnotation=J.SearchSuggestionSignal=void 0;const m=d(411);class f{constructor(l){m.SchemaObject.assign(f,this,l)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}J.SearchSuggestionSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,
this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}J.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1890:function(I,J,d){var m=this&&this.tQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);var x=Object.getOwnPropertyDescriptor(l,w);if(!x||
("get"in x?!l.FM:x.writable||x.configurable))x={enumerable:!0,get:function(){return l[w]}};Object.defineProperty(a,z,x)}:function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1891),J);f(d(1892),J);f(d(1893),J);f(d(1894),J)},1891:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1892:function(I,J){Object.defineProperty(J,
"__esModule",{value:!0})},1893:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.ContractEntityAnnotation=void 0;const m=d(411);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}
J.ContractEntityAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1894:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.ContractEntitySignal=void 0;const m=d(411);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}J.ContractEntitySignal=f;f.H_={T_:f.getTypeName(),
B_:f.getBaseTypes()}},1896:function(I,J,d){d.r(J);d.d(J,"ReactOICErrorDialogWithTrial",function(){return l});I=d(0);var m=d(108);J=d(1712);var f=d(467),a=d(172);class l extends J.a{constructor(w,z,x,u,v,F){super(w,z,x,u,v,F);z={["errorMessage"]:this.sli,["offerString"]:this.Mij};w=new a.a(!1,!1,!0);this.TUj?(w.Ed=1,z.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Wrb,["onExecute"]:()=>{f.Redirect.showHelp(this.GOi)}}):(w.Ed=4,w.Qe(2,this.PPi));w.Qe(1,this.wQd);w.Pg=this.id;z={["id"]:this.id,
["dialogIcon"]:this.icon,["bodyControls"]:z};w.gi(this.dialogTitle,Object(m.a)(this,this.fqo,"reactOICErrorDialogWithTrialHandler"),z)}}Object(I.a)(l,"ReactOICErrorDialogWithTrial",J.a,[])},1897:function(I,J,d){d.r(J);d.d(J,"OICErrorDialogWithTrial",function(){return a});I=d(0);var m=d(108);J=d(1712);var f=d(175);class a extends J.a{constructor(l,w,z,x,u,v){super(l,w,z,x,u,v);l=document.createElement("span");l.innerText=this.sli;l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));
w=document.createElement("span");w.innerText=this.Mij;l.appendChild(w);w=new f.StandardDialog;this.TUj?(w.Ed=1,w.Ref(this.Wrb,this.GOi)):(w.Ed=4,w.Qe(2,this.PPi));w.Qe(1,this.wQd);w.Pg=this.id;w.Mx(this.dialogTitle,null,this.icon,Object(m.a)(this,this.fBn,"legacyOICErrorDialogWithTrialHandler"),l)}}Object(I.a)(a,"OICErrorDialogWithTrial",J.a,[])},1899:function(I,J,d){var m=this&&this.tQ||(Object.create?function(a,l,w,z){void 0===z&&(z=w);Object.defineProperty(a,z,{enumerable:!0,get:function(){return l[w]}})}:
function(a,l,w,z){void 0===z&&(z=w);a[z]=l[w]}),f=this&&this.__exportStar||function(a,l){for(var w in a)"default"===w||Object.prototype.hasOwnProperty.call(l,w)||m(l,a,w)};Object.defineProperty(J,"__esModule",{value:!0});f(d(1900),J);f(d(1901),J)},1900:function(I,J){Object.defineProperty(J,"__esModule",{value:!0})},1901:function(I,J,d){Object.defineProperty(J,"__esModule",{value:!0});J.SearchProviderAnnotation=J.SearchProviderSignal=void 0;const m=d(411);class f{constructor(l){m.SchemaObject.assign(f,
this,l)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}J.SearchProviderSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,
[a.getTypeName()])}}J.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1999:function(I,J,d){function m(ka){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");ka?Aa.Lxo():Aa.main();tg.main(ka);Ag.main(ka);za.a.instance.Mc(new Gn,0,ka);za.a.instance.Mc(new Tk,0,ka);kk(ka);hn(ka)}var f=d(0),a=d(8),l=d(1324),w;(function(ka){ka[ka.unknown=0]="unknown";ka[ka.supported=1]="supported";ka[ka.usq=
2]="userUnsupportedAnonymous";ka[ka.vsq=3]="userUnsupportedNoLoginHint";ka[ka.p6p=4]="hostUnsupported";ka[ka.Kiq=5]="perfAutomation"})(w||(w={}));Object(f.b)("SupportStatus",w);var z=d(912),x=d(1466);class u{constructor(ka){this.OFk=ka}initialize(){return Promise.resolve(0)}Uhe(){return Promise.resolve(0)}GV(){a.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.OFk}))}cEe(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}GBe(){return!1}M4c(){return"MockAuthTokenStrategy"}}Object(f.a)(u,"MockAuthTokenStrategy",null,[458]);var v=d(1634);class F{static get(ka,Va,yb){if(!yb)return ka;let Yb=0;return Promise.race([ka,new Promise(oc=>{Yb=window.setTimeout(()=>{oc(Va)},yb)})]).then(oc=>{window.clearTimeout(Yb);return Promise.resolve(oc)}).catch(()=>{window.clearTimeout(Yb);
return Promise.resolve(Va)})}}Object(f.a)(F,"PromiseWithTimeout",null,[]);var y=d(2),G=d(623);class C{constructor(ka,Va,yb,Yb,oc){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=ka;this.scope=Va;this.silentLogin=yb;this.options=Yb;this.correlationId=oc}}Object(f.a)(C,"TokenRequestParameters",null,[493]);var H=d(17),K=d(19);class R{constructor(){this.VKh=null;let ka=y.AFrameworkApplication.J.jb(y.AFrameworkApplication.ewa),Va=y.AFrameworkApplication.J.jb(y.AFrameworkApplication.rEe);
this.$ac=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ka&&""!==ka?ka:"Unspecified",Va&&""!==Va?Va:"Unspecified")}initialize(){return new Promise(ka=>{K.a.instance.Ra(732).execute(Va=>{this.VKh=Va;ka(0)})})}ie(ka){const Va=["HTTPS:","API:"];let yb=!1;const Yb=ka.toLocaleUpperCase();for(const oc of Va)if(Yb.startsWith(oc)){yb=!0;break}return yb||this.umn(ka)?ka+"/.default":ka}umn(ka){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ka)}Uhe(){return Promise.resolve(0)}GV(ka,
Va,yb,Yb,oc,Vc,yd){if(H.a.LXa){oc=G.a.NHp;if(!oc)return Va=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Va);if(!Array.contains(oc,ka))return Va=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ka}),Promise.resolve(Va)}ka=this.ie(yb);yb=new C(yb,ka,!Yb,null,y.AFrameworkApplication.userSessionId);return this.VKh.getAccessToken(yb,Va,yd).then(Jd=>Object.assign(new x.a,
{IsSuccess:!0,Token:Jd.accessToken}),Jd=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:Jd}))}cEe(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}GBe(){return!1}M4c(){return this.$ac}}Object(f.a)(R,"ParentFrameTokenStrategy",null,[458]);var E=d(757),L=d(72);class O{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Pwj=this.OVh=
null}}Object(f.a)(O,"PromiseWrapper",null,[]);class V{constructor(ka=0){this.Bz=0;this.MNc=!1;this.Iz=new L.a;this._timeout=ka}enqueue(ka){return new Promise((Va,yb)=>{this.Iz.add(Object.assign(new O,{Pwj:ka,resolve:Va,reject:yb}));this.process()})}process(){if(this.MNc||this.Bz===this.Iz.count)return!1;const ka=this.Iz.K(this.Bz++);try{this.MNc=!0,ka.Pwj().then(Va=>{this.MNc=!1;this.Qqf(ka,Va,null,!0)}).catch(Va=>{this.MNc=!1;this.Qqf(ka,null,Va,!1)})}catch(Va){this.MNc=!1,this.Qqf(ka,null,Va,!1)}return!0}Qqf(ka,
Va,yb,Yb){if(Yb){const oc=()=>{ka.resolve(Va);this.process()};0<this._timeout?window.setTimeout(()=>{oc()},this._timeout):oc()}else{const oc=()=>{ka.reject(yb);this.process()};0<this._timeout?window.setTimeout(()=>{oc()},this._timeout):oc()}}}Object(f.a)(V,"PromiseQueue",null,[]);class Z{constructor(){this.correlationId=this.resolve=null}}Object(f.a)(Z,"ResolveWithCorrelation",null,[]);var W=d(82),P=d(172),S=d(941),aa=d(89);class Y extends P.a{constructor(ka,Va,yb,Yb,oc,Vc){super(!1,!1,!0);this.Reh=
this.MFa=null;this.q5n=()=>{this.Uqi()};this.gHl=()=>this.CJ;this.r3o=yd=>{0===yd&&(this.TRk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.OEb(null))};this.kya=ka;this.oKk=yb;this.Cv=Yb;this.TRk=oc;this.OEb=Vc;this.CJ=document.createElement("iframe");this.CJ.id="SharedAuthInteractiveFrame";this.CJ.setAttribute("name","SharedAuthInteractiveFrame");this.CJ.setAttribute("title","SharedAuthInteractiveFrame");this.CJ.setAttribute("sandbox",
"allow-scripts allow-same-origin allow-forms allow-popups");this.CJ.style.border="0";this.CJ.style.height="48px";this.CJ.style.width="190px";$addHandler(this.CJ,"error",this.q5n);ka=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.kya,Va,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",y.AFrameworkApplication.userType);this.CJ.src=ka;this.guk=new Promise(yd=>{this.Reh=yd});this.Seh=!1}U_a(){this.MFa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.oKk,
["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:y.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.gHl,["resolveDialogStyles"]:this.Reh}};this.Ed=5;this.gi(CommonUIStrings.l_SignIn,this.r3o,this.MFa)}o9j(ka=!1,Va=5){this.MFa&&this.MFa.bodyControls&&(!0!==Object(W.a)(Object,this.MFa.bodyControls).frameLoaded&&(Object(W.a)(Object,this.MFa.bodyControls).frameLoaded=!0),ka!==Object(W.a)(Object,this.MFa.bodyControls).frameLoadSuccess&&(Object(W.a)(Object,this.MFa.bodyControls).frameLoadSuccess=
ka),Va!==this.MFa.dialogButtonsOption&&(this.MFa.dialogButtonsOption=null,this.Ed=Va),this.update(this.MFa))}X$o(ka,Va){const yb=new S.a(aa.a.v3o);yb.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:y.AFrameworkApplication.isRtl,["messageCorrelationId"]:ka,["dialogStyles"]:Va};this.Cv.eeb(yb,this.CJ.contentWindow,this.kya)}Uqi(){this.o9j(!1,6)}get XRj(){return this.CJ}get BUl(){return this.guk.then(ka=>{this.Seh=!0;return ka})}get CUl(){return this.Seh}}
Object(f.a)(Y,"SharedAuthConsentDialog",P.a,[494]);var X=d(962),ca=d(85),fa=d(862),ja=d(39),ra=d(117),ya=d(91);class Ha{}Ha.kpiName="OAuthManager";Object(f.a)(Ha,"OAuthManagerConstants",null,[]);class Wa{constructor(){this.CJ=null;this.fDd=0;this.u9b=this.Hbc=this.aLe=this.OEb=this.dea=this.TIh=null;this.y0n=()=>{const ka=ja.a.Le()-this.fDd;a.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ka)};this.Wvb=ka=>{const Va=ja.a.Le()-this.fDd,yb=Object.assign(new ya.a,
{durationMs:Va});ca.Health.instance.recordKpiFailure(Ha.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,yb);a.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Va,this.xgh?JSON.stringify(ka):"")};this.U4n=ka=>{const Va=this.Dkb.loadFrame;var yb=ja.a.Le()-Va.startTime,Yb=ka.Values.AuthLibrary.toString();ka=ka.Values.Success.toString();a.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ka,Yb,yb);
Yb&&(this.$ac="SharedAuthTokenStrategy "+Yb);Yb=Boolean.parse(ka);Yb||(ka=fa.a.cH(),void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.M4c()),yb=Object.assign(new ya.a,{durationMs:yb,extendedProperties:ka}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"SharedAuthStrategyInitFailed",!1,!0,yb)));Va.resolve(Yb?0:1)};this.T4n=ka=>{if(ka.Values.interactive&&this.Hbc&&this.Hbc.Values.messageCorrelationId){const yb=this.Hbc.Values.messageCorrelationId.toString();if(ka.Values.interactive&&this.dea){this.dea.BUl.then(Yb=>
{this.Cv.eeb(this.Hbc,this.dea.XRj.contentWindow,this.kya);this.dea.X$o(yb,Yb);this.dea.o9j(!0);this.Hbc=null});return}}ka=this.Dkb.initFrame;const Va=ja.a.Le()-ka.startTime;a.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Va);ka.resolve(0)};this.d0n=ka=>{if(ka.Values.messageCorrelationId&&ka.Values.messageCorrelationId.toString()){var Va=ka.Values.messageCorrelationId.toString(),yb=this.Dkb[Va];if(yb){var Yb=ja.a.Le()-yb.startTime;a.ULS.sendTraceTag(573112906,
3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",Yb);ka.Values.isSuccess&&ka.Values.isSuccess?yb.resolve(ka.Values.response):yb.reject(ka.Values.response);this.R4j(Va)}else a.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else a.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};this.W0n=()=>{if(this.dea.CUl)this.dea.Uqi();else if(this.aLe&&
this.dea){const ka=new S.a(aa.a.$Rj);ka.Values=this.tVh(this.aLe,!0);this.Cv.eeb(ka,this.dea.XRj.contentWindow,this.kya)}};this.n0n=()=>{this.dea&&this.dea.sae()};this.Deg=ka=>{ka.Values.cancelled&&ka.Values.cancelled&&ka.Values.messageCorrelationId&&this.R4j(ka.Values.messageCorrelationId.toString());this.dea&&this.dea.hide()};this.z1n=ka=>{if(ka.Values.messageCorrelationId&&ka.Values.messageCorrelationId.toString()){var Va=this.Dkb[ka.Values.messageCorrelationId.toString()];if(Va){var yb=ja.a.Le()-
Va.startTime;a.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",yb);ka.Values.isSuccess&&ka.Values.isSuccess?Va.resolve(ka.Values.response):Va.reject(ka.Values.response)}else a.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else a.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.Cv=new X.a(null,null);this.$ac=
"SharedAuthTokenStrategy Unloaded";this.kya=G.a.t3o;this.MEh=G.a.s3o;this.xgh=G.a.enableConsoleLogging;this.pvk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.$Ok=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.NSk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.Dkb={};this.MAk=new V(1500)}M4c(){return this.$ac}initialize(){if("loadFrame"in
this.Dkb)return this.Dkb.loadFrame.OVh;if(!this.kya)return ca.Health.instance.recordKpiFailure(Ha.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),a.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);const ka=this.hBe("loadFrame");this.fDd=ja.a.Le();var Va=this.kya+this.MEh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+y.AFrameworkApplication.userSessionId+"&WacUserType="+y.AFrameworkApplication.userType;
this.NSk&&(Va+="&webworker=1");this.CJ=document.createElement("iframe");this.xVf(this.CJ);this.CJ.style.cssText="height:0;width:0;display:none;";this.CJ.id="SharedAuthFrame";this.CJ.setAttribute("name","SharedAuthFrame");this.CJ.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.CJ.setAttribute("title","SharedAuthFrame");this.CJ.src=Va;document.body.appendChild(this.CJ);Va=ja.a.Le()-this.fDd;a.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
Va,this.CJ.src);return ka}Uhe(ka){this.aLe=ka;const Va=new S.a(aa.a.$Rj);Va.Values=this.tVh(ka);ka=this.hBe("initFrame");this.Cv.eeb(Va,this.CJ.contentWindow,this.kya);a.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return ka}GV(ka,Va,yb,Yb,oc,Vc){const yd=new S.a(aa.a.w3o),Jd=this.UFi();yd.Values=this.v4j(ka,Va,yb,Yb,oc,Vc,Jd);ka=this.hBe(Jd);Yb&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",
!1)?this.MAk.enqueue(()=>new Promise(Pd=>{this.asp(Vc,yd,Pd,Jd)})):(this.Cv.eeb(yd,this.CJ.contentWindow,this.kya),a.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Va));return ka}asp(ka,Va,yb,Yb){const oc=this.Dkb[Yb];oc&&(this.Hbc=Va,this.OEb=Object.assign(new Z,{resolve:yb,correlationId:Yb}),this.dea=new Y(this.kya,this.MEh,ka,this.Cv,oc,yb),this.dea.U_a())}UFi(){return ra.a.create().toString()}v4j(ka,Va,yb,Yb,oc,Vc,yd){const Jd={};Jd.appName=
ka;Jd.appId=Va;Jd.target=yb;Jd.withPopup=Yb;Jd.claims=oc;Jd.promptMessage=Vc;Jd.messageCorrelationId=yd;return Jd}xVf(ka){$addHandler(ka,"load",this.y0n);$addHandler(ka,"error",this.Wvb);this.Cv.Nja(this.kya);this.Cv.Gv(aa.a.cSj);this.Cv.XE(aa.a.cSj,this.U4n);this.Cv.Gv(aa.a.bSj);this.Cv.XE(aa.a.bSj,this.T4n);this.Cv.Gv(aa.a.YRj);this.Cv.XE(aa.a.YRj,this.d0n);this.Cv.Gv(aa.a.dSj);this.Cv.XE(aa.a.dSj,this.z1n);this.Cv.Gv(aa.a.aSj);this.Cv.XE(aa.a.aSj,this.W0n);this.Cv.Gv(aa.a.ZRj);this.Cv.XE(aa.a.ZRj,
this.n0n);this.Cv.Gv(aa.a.WRj);this.Cv.XE(aa.a.WRj,this.Deg)}hBe(ka){const Va=new O;Va.startTime=ja.a.Le();const yb=new Promise((Yb,oc)=>{Va.resolve=Yb;Va.reject=oc});Va.OVh=yb;this.Dkb[ka]=Va;return yb}tVh(ka,Va=!1){const yb={};yb.appIds=this.njm();yb.upn=ka.loginHint;yb.authority=ka.authority;yb.authorityType=Object(l.a)(z.a,ka.authorityType);yb.tenantId=ka.tenantId;yb.correlationId=y.AFrameworkApplication.userSessionId;yb.enableConsoleLogging=this.xgh;yb.enablePopupFlash=this.pvk;yb.skipUpnCheck=
this.$Ok;yb.interactive=Va;return yb}njm(){const ka=[],Va=G.a.iif;for(const Yb in Va){var yb=Va[Yb];Array.contains(ka,yb)||Array.add(ka,yb)}return ka}cEe(ka,Va,yb,Yb,oc,Vc){const yd=new S.a(aa.a.u3o),Jd=this.UFi();yd.Values=this.v4j(ka,Va,yb,Yb,oc,Vc,Jd);this.TIh=yd;ka=this.hBe(Jd);a.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Va);this.v8o();return ka}GBe(){return!0}v8o(){this.u9b||(this.u9b=new E.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.u9b.id=16,this.u9b.c$c=!1,this.u9b.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{a.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Cv.eeb(this.TIh,this.CJ.contentWindow,this.kya)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),y.AFrameworkApplication.ta.Hb.Qya(this.u9b,!0)||a.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}R4j(ka){this.OEb&&
this.OEb.correlationId===ka&&(this.OEb.resolve(null),this.OEb=null)}}Object(f.a)(Wa,"SharedAuthTokenStrategy",null,[458]);class Ma{constructor(ka){this.A$=ka;this.$ac="UnsupportedAuthTokenStrategy Reason="+w[this.A$]}initialize(){return Promise.resolve(0)}Uhe(){return Promise.resolve(0)}GV(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:w[this.A$],ErrorMessage:"Unable to get a token. Reason: ["+w[this.A$]+"]"}))}cEe(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,
ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}GBe(){return!1}M4c(){return this.$ac}}Object(f.a)(Ma,"UnsupportedAuthTokenStrategy",null,[458]);var ua=d(1399);class Ka{constructor(ka=null){this.f5=0;this.fda=null;this.LHb=0;this.$ph=!!window.location.search.match(RegExp("wdpa=1","gi"));const Va=ja.a.Le();this.sAk=this.BTl(ka).then(yb=>yb?this.y7m():(a.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",
this.WJ(),Math.floor(ja.a.Le()-Va)),yb=fa.a.cH(),void 0!==yb&&null!==yb&&(yb.set("AuthLibrary",this.WJ()),yb=Object.assign(new ya.a,{durationMs:Math.floor(ja.a.Le()-Va),extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyPickFailed",!1,!0,yb)),Promise.resolve(1))).then(yb=>0!==yb?Promise.resolve(yb):this.ACn())}CTl(){if(this.$ph)this.f5=5,this.fda=new Ma(this.f5);else{var ka=G.a.NPn;ka&&0<ka.length?(this.f5=1,this.fda=new u(ka)):y.AFrameworkApplication.J.$("IsO365ConsumerHost")||
y.AFrameworkApplication.J.$("IsO365CommercialHost")?y.AFrameworkApplication.J.$("IsAnonymousUser")?(this.f5=2,this.fda=new Ma(this.f5)):(ka=v.a.getAuthContext().loginHint)&&ka.length?G.a.F6c?(this.f5=1,this.fda=new R):(this.f5=1,this.fda=new Wa):(this.f5=3,this.fda=new Ma(this.f5)):(this.f5=4,this.fda=new Ma(this.f5))}}WJ(){return this.fda?this.fda.M4c()||"Unknown":"None"}BTl(ka=null){a.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Va=ja.a.Le();return y.AFrameworkApplication.J.evm().then(yb=>
{yb?(this.CTl(),ka&&(this.fda=ka),a.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",G.a.clientVersion,G.a.appVersion,G.a.lYl,this.WJ(),Math.floor(ja.a.Le()-Va))):a.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ja.a.Le()-Va));return Promise.resolve(yb)},()=>{a.ULS.sendTraceTag(562128580,
3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ja.a.Le()-Va));return Promise.resolve(!1)})}y7m(){a.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.WJ());const ka=ja.a.Le();return F.get(this.fda.initialize(),2,G.a.Tng).then(Va=>{if(0===Va)a.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.WJ(),Math.floor(ja.a.Le()-ka));else if(1===Va){a.ULS.sendTraceTag(527827291,
3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ja.a.Le()-ka));var yb=fa.a.cH();void 0!==yb&&null!==yb&&(yb.set("AuthLibrary",this.WJ()),yb=Object.assign(new ya.a,{durationMs:Math.floor(ja.a.Le()-ka),extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyInitFailed",!1,!0,yb))}else 2===Va&&(a.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.WJ(),Math.floor(ja.a.Le()-ka)),yb=fa.a.cH(),void 0!==yb&&null!==yb&&(yb.set("AuthLibrary",this.WJ()),yb=Object.assign(new ya.a,{durationMs:Math.floor(ja.a.Le()-ka),extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyInitTimedOut",!1,!0,yb)));return Promise.resolve(Va)},()=>{a.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ja.a.Le()-ka));return Promise.resolve(1)})}ACn(){a.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.WJ());const ka=ja.a.Le();return F.get(this.fda.Uhe(v.a.getAuthContext()),2,G.a.Tng).then(Va=>{if(0===Va)a.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.WJ(),Math.floor(ja.a.Le()-ka));else if(1===Va){a.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ja.a.Le()-ka));var yb=fa.a.cH();void 0!==yb&&null!==yb&&(yb.set("AuthLibrary",this.WJ()),yb=Object.assign(new ya.a,
{durationMs:Math.floor(ja.a.Le()-ka),extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"StrategyLoadFailed",!1,!0,yb))}else 2===Va&&(a.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ja.a.Le()-ka)),yb=fa.a.cH(),void 0!==yb&&null!==yb&&(yb.set("AuthLibrary",this.WJ()),yb=Object.assign(new ya.a,{durationMs:Math.floor(ja.a.Le()-ka),extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,
"StrategyLoadTimedOut",!1,!0,yb)));return Promise.resolve(Va)},()=>{a.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.WJ(),Math.floor(ja.a.Le()-ka));return Promise.resolve(1)})}GV(ka,Va,yb=null,Yb){return this.NAc(ka,Va,!1,Yb,"",yb)}w4j(ka,Va,yb,Yb,oc=null){return this.NAc(ka,Va,!0,yb,Yb,oc)}NAc(ka,Va,yb,Yb,oc,Vc,yd=0){yd+=1;a.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
ka,this.s_b(ka,Va),this.WJ(),yd);var Jd=fa.a.cH();void 0!==Jd&&null!==Jd&&(Jd.set("AuthLibrary",this.WJ()),Jd.set("AppName",ka),Jd.set("Target",this.s_b(ka,Va)),ca.Health.instance.recordKpiUsage(Ha.kpiName,0,"WacOAuthFC",Jd));if(!G.a.isEnabled||this.$ph){var Pd;return this.u6f((Pd=new x.a,Pd.IsSuccess=!1,Pd.Token=null,Pd.ErrorCode="NotEnabled",Pd.ErrorMessage="OAuthManager is disabled.",Pd),ka)}const Qe=G.a.iif[ka];if(void 0===Qe||null===Qe){a.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
ka);var Cf;return this.u6f((Cf=new x.a,Cf.IsSuccess=!1,Cf.Token=null,Cf.ErrorCode="DisallowedApp",Cf.ErrorMessage="Disallowed appName: "+ka,Cf),ka)}const Wf=ja.a.Le();let gg=Wf;const Jg=this;Jd=this.sAk.then(gj=>{gg=ja.a.Le();return Jg.vfn(ka,Qe,Va,yb,Yb,oc,Vc,gj)});Pd=yb?0:G.a.Tng;let Lh;Cf=(Lh=new x.a,Lh.IsSuccess=!1,Lh.Token=null,Lh.ErrorCode="authTokenStrategy_timeout",Lh.ErrorMessage="Auth Strategy timed out after ["+Pd+"] ms when fetching token",Lh);const Qj=this,Uk=this;return F.get(Jd,Cf,
Pd).then(gj=>yd<=Ka.bNn&&(gj.ErrorCode===Ka.y1j||gj.ErrorCode===Ka.xgp)?(a.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",yd,Math.floor(ja.a.Le()-Wf)),Qj.NAc(ka,Va,yb,Yb,oc,Vc,yd)):gj.ErrorCode===Ka.W4i&&!yb&&(a.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",yd,Ka.Fji),Ka.V0l&&Qj.fda.GBe()&&Qj.fda.cEe(ka,Qe,Va,yb,Yb,oc).then(Vj=>Promise.resolve(Qj.Die(Vj,ka,Va,Qe,Wf,gg))).catch(()=>
{let Vj;const om=(Vj=new x.a,Vj.IsSuccess=!1,Vj.Token=null,Vj.ErrorCode="authTokenStrategy_failure",Vj.ErrorMessage="LoginPopup failed, GetToken could not be called",Vj);return Promise.resolve(Qj.Die(om,ka,Va,Qe,Wf,gg))}),Ka.Fji)?Qj.NAc(ka,Va,!0,Yb,oc,Vc,yd):Promise.resolve(Qj.Die(gj,ka,Va,Qe,Wf,gg))).catch(()=>{let gj;const Vj=(gj=new x.a,gj.IsSuccess=!1,gj.Token=null,gj.ErrorCode="authTokenStrategy_failure",gj.ErrorMessage="Auth Strategy failed with an unknown error",gj);return Promise.resolve(Uk.Die(Vj,
ka,Va,Qe,Wf,gg))})}vfn(ka,Va,yb,Yb,oc,Vc,yd,Jd){return 1===Jd||2===Jd?this.u6f(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===Jd?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ka):this.fda.GV(ka,Va,yb,Yb,oc,Vc,yd).then(Pd=>Promise.resolve(this.Khj(Pd,!0,ka))).catch(Pd=>Promise.resolve(this.Khj(Pd,!1,ka)))}Die(ka,Va,yb,Yb,oc,Vc){const yd={},Jd=ja.a.Le()-Vc;yd.IsSuccess=ka.IsSuccess;yd.ErrorCode=ka.IsSuccess?"Success":ka.ErrorCode||"";yd.ErrorMessage=
ka.IsSuccess?"Success":this.s_b(Va,ka.ErrorMessage||"");yd.Target=this.s_b(Va,yb||"");yd.TimeInMS=Math.floor(Jd);yd.LoadTimeInMS=Math.floor(Vc-oc);yd.AuthLibrary=this.WJ();yd.AppName=Va;yd.AuthorityType=Object(l.a)(z.a,v.a.b5d());yd.UserType=this.ORm(v.a.getAuthContext());yd.IsAuthSupportedInSession=w[this.f5];yd.RequestCount=++this.LHb;yd.AppId=Yb;a.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(yd));ka.IsSuccess||(yb=fa.a.cH(),void 0!==yb&&null!==yb&&(yb.set("AppName",Va),yb.set("AuthLibrary",
this.WJ()),yb.set("ErrorCode",ka.ErrorCode),yb.set("ErrorMessage",this.s_b(Va,ka.ErrorMessage)),Va=Object.assign(new ya.a,{durationMs:Jd,extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"TryGetTokenFailure",!1,!0,Va)));return ka}u6f(ka,Va){a.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Va,this.s_b(Va,ka.ErrorMessage));const yb=fa.a.cH();void 0!==yb&&null!==yb&&(yb.set("AppName",Va),yb.set("AuthLibrary",this.WJ()),
yb.set("ErrorCode",ka.ErrorCode),yb.set("ErrorMessage",this.s_b(Va,ka.ErrorMessage)),Va=Object.assign(new ya.a,{extendedProperties:yb}),ca.Health.instance.recordKpiFailure(Ha.kpiName,"FailureBeforeGetToken",!1,!0,Va));return Promise.resolve(ka)}GYi(ka){return ka===ua.a.TCe}s_b(ka,Va){return this.GYi(ka)&&Va?"REDACTED":Va}ORm(ka){return y.AFrameworkApplication.J.$("IsAnonymousUser")?"anonymous":!ka.loginHint||1>ka.loginHint.length?"empty":-1<ka.loginHint.indexOf("guest#")?"guest":-1<ka.loginHint.indexOf("ext#")?
"external":0>ka.upn.indexOf("@")?"no-at":"supported"}Ggn(){return 1===this.f5}Khj(ka,Va,yb){let Yb=null,oc=null,Vc=null,yd=null;ka?ka.ErrorCode||ka.ErrorMessage?(oc=ka.ErrorCode?ka.ErrorCode:Ka.Rli,Vc=ka.ErrorMessage?ka.ErrorMessage:"No message"):ka.Token?Va?Yb=ka.Token:(oc=Ka.izo,Vc="A rejected promise returned a token."):(oc=Ka.Rli,Vc=JSON.stringify(ka)):(oc=Ka.oTn,Vc="No result came from Auth Token Strategy");ka&&ka.Telemetry&&!this.GYi(yb)&&(yd=ka.Telemetry,a.ULS.sendTraceTag(579166408,3E3,50,
JSON.stringify(yd)));if(oc===Ka.iQn||oc===Ka.$np)oc=Ka.y1j,Vc="Auth Library Timed Out";oc===Ka.Obl&&-1<Vc.indexOf(Ka.YTk)&&(oc=Ka.W4i);if(oc||Vc)Yb=null;return Object.assign(new x.a,{IsSuccess:!!Yb,Token:Yb,ErrorCode:oc,ErrorMessage:Vc,Telemetry:yd})}static get Fji(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get V0l(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Ka.$np="token_renewal_error";Ka.Rli="Exception";Ka.oTn="NoResult";Ka.izo="RejectToken";Ka.iQn="monitor_window_timeout";Ka.y1j="Timeout";Ka.xgp="authTokenStrategy_timeout";Ka.Obl="login_required";Ka.YTk="AADSTS50058";Ka.W4i="Cookies Disabled";Ka.bNn=2;Object(f.a)(Ka,"OAuthManager",null,[407]);var za=d(179),Fa=d(28),ea=d(44),la=d(80),Na=d(94);class Aa{get name(){return"Common.App.OAuth.OAuthPackage"}uc(ka){ka.register(407,725).ha().Sd(()=>new Ka)}init(){const ka=K.a.instance.resolve(725);this.ftp(ka);
this.etp(ka)}etp(ka){if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var Va=y.AFrameworkApplication.J.jb("FileSource");if(y.AFrameworkApplication.J.$("IsO365ConsumerHost")||y.AFrameworkApplication.J.$("IsO365CommercialHost")||"WopiTest"===Va){var yb=G.a.gYd;if(yb&&yb.IsEnabled){var Yb=yb.Application,oc=G.a.authority;if(void 0!==Yb&&null!==Yb&&Yb.length&&void 0!==oc&&null!==oc&&oc.length){var Vc=w[ka.f5],
yd=H.a.lE,Jd=ka.WJ();oc=JSON.stringify({access_token:{["xms_cc"]:{values:["cp1"]}}});var Pd=ja.a.Le();ka.GV("CAETest",Yb,null,oc).then(Qe=>{const Cf=Math.floor(ja.a.Le()-Pd);Vc=w[ka.f5];yd=H.a.lE;Jd=ka.WJ();a.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Cf,Qe.IsSuccess,Vc,Qe.ErrorCode,Va,yd,Jd);if(Qe.IsSuccess){Qe="Bearer "+Qe.Token;
var Wf=yb.Endpoint;if(Wf){var gg=ja.a.Le();Qe={["Authorization"]:Qe};var Jg=new Na.a;Jg.add("EnforceCAE","1");Jg.add("IsCAEToken","1");Wf=ea.a.fff(Wf,Jg);y.AFrameworkApplication.Ge.kKb(Wf,1,null,Qe,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Lh=>{var Qj=Math.floor(ja.a.Le()-gg),Uk=null;Lh.yp?Lh="Canceled":Lh.ij?Lh="Faulted":(Uk=Lh.result,Lh=Uk.succeeded?"Completed":"Failed");Qj={["TaskResult"]:Lh,["BrowserTokenDurationMS"]:Cf,["BrowserValidationDurationMS"]:Qj};Uk&&(Qj.HttpStatus=
Uk.args.data.He,Uk.succeeded&&(Uk=Fa.a(Uk.args.data.Ee),Qj.ServerValidationDurationMS=Uk.ElapsedMilliseconds,Qj.ServerValidationResult=Uk.ValidatedToken,Qj.KMSI=Uk.KMSI,Qj.Scopes=Uk.Scopes,Qj.TokenExpirationS=Math.floor(parseInt(Uk.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(508950354,3E3,"Completed"===Lh?50:15,la.a.toJSON(Qj))})}}else a.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",Qe.ErrorCode,Qe.ErrorMessage)}).catch(Qe=>{const Cf=Math.floor(ja.a.Le()-
Pd);a.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",Qe.toString(),Cf)})}}}}}ftp(ka){const Va=y.AFrameworkApplication.J.jb("FileSource");if(y.AFrameworkApplication.J.$("IsO365ConsumerHost")||y.AFrameworkApplication.J.$("IsO365CommercialHost")||"WopiTest"===Va){var yb=G.a.gYd;if(yb&&yb.IsEnabled){var Yb=yb.Application,oc=G.a.authority;if(void 0!==Yb&&null!==Yb&&Yb.length&&void 0!==oc&&null!==oc&&oc.length){var Vc=w[ka.f5],yd=H.a.lE,Jd=ka.WJ();try{var Pd=new Map;void 0!==Pd&&
null!==Pd?(Pd.set("SupportStatus",Vc),Pd.set("Browser",yd),Pd.set("AuthStrategy",Jd)):Pd=null}catch(Cf){Pd=null}ca.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Pd);var Qe=ja.a.Le();ka.GV("Core",Yb).then(Cf=>{const Wf=Math.floor(ja.a.Le()-Qe);Vc=w[ka.f5];yd=H.a.lE;Jd=ka.WJ();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Wf,Cf.IsSuccess,Vc,Cf.ErrorCode,Va,yd,Jd);Pd&&(Pd.set("SupportStatus",Vc),Pd.set("Browser",yd),Pd.set("AuthStrategy",Jd));var gg=Object.assign(new ya.a,{durationMs:Wf,extendedProperties:Pd});if(Cf.IsSuccess){if(ca.Health.instance.recordKpiSuccess("WacCorePFT",gg),Cf="Bearer "+Cf.Token,y.AFrameworkApplication.Ge.rud=Cf,gg=yb.Endpoint){var Jg=ja.a.Le();y.AFrameworkApplication.Ge.kKb(gg,1,null,{["Authorization"]:Cf},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Lh=>{var Qj=Math.floor(ja.a.Le()-
Jg),Uk=null;Lh.yp?Lh="Canceled":Lh.ij?Lh="Faulted":(Uk=Lh.result,Lh=Uk.succeeded?"Completed":"Failed");Qj={["TaskResult"]:Lh,["BrowserTokenDurationMS"]:Wf,["BrowserValidationDurationMS"]:Qj};Uk&&(Qj.HttpStatus=Uk.args.data.He,Uk.succeeded&&(Uk=Fa.a(Uk.args.data.Ee),Qj.ServerValidationDurationMS=Uk.ElapsedMilliseconds,Qj.ServerValidationResult=Uk.ValidatedToken,Qj.KMSI=Uk.KMSI,Qj.Scopes=Uk.Scopes,Qj.TokenExpirationS=Math.floor(parseInt(Uk.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,
3E3,"Completed"===Lh?50:15,la.a.toJSON(Qj))})}}else ca.Health.instance.recordKpiFailure("WacCorePFT",Cf.ErrorCode,!1,!1,gg)}).catch(Cf=>{var Wf=Math.floor(ja.a.Le()-Qe);Wf=Object.assign(new ya.a,{durationMs:Wf,extendedProperties:Pd});ca.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Cf.toString(),!1,!1,Wf)})}}}}dispose(){}static main(){za.a.instance.Mc(new Aa)}static Lxo(){za.a.instance.Mc(new Aa,0,!0)}}Object(f.a)(Aa,"OAuthPackage",null,[0,1]);var wa=d(374),va=d(357),Pa=d(16);
class Ta{constructor(){new va.a}}Object(f.a)(Ta,"SdxPaneSuppressionManager",null,[]);var kb=d(267),gb=d(257),tb=d(119);class hb{constructor(ka){this.E1e=0;this.BGk=ka}rvb(){return this.E1e>=this.BGk}reset(){this.E1e=0}update(){this.E1e++}}Object(f.a)(hb,"NodeCountBasedTaskYieldStrategy",null,[781]);var Xa=d(1835);class $a{constructor(){this.Cnd=new Set}ANa(ka){this.Cnd.add(ka)}svp(ka){this.Cnd.delete(ka)}h5n(){return()=>{this.Cnd.forEach(ka=>{ka.onSessionClose()})}}i5n(){return()=>{this.Cnd.forEach(ka=>
{ka.onSessionConnect()})}}j5n(){return()=>{this.Cnd.forEach(ka=>{ka.onSessionDisconnect()})}}}Object(f.a)($a,"AlSessionLifeEventNotifier",null,[572]);var La=d(1786),bb=d(86),Gb=d(92),qb=d(46),Sa=d(5),cb=d(1415),pb=d(517),vb=d(1384),xb=d(1421),Bb=d(1418),jc=d(360),xc=d(1439),Qc=d(785),fd=d(628),Ac=d(754);class Nb{constructor(){this.token=null}}Object(f.a)(Nb,"ReleaseAnnotationParameters",null,[]);class ib{constructor(){this.value=this.id=this.parentPath=null}}Object(f.a)(ib,"SetAnnotationMetadataParameters",
null,[]);class Rb{constructor(){this.id=this.parentPath=null;this.value=0}}Object(f.a)(Rb,"SetAnnotationStateParameters",null,[]);var ic=d(592),kc=d(277),Jb=d(471),ec=d(1556),qa=d(310),sa=d(625),ab=d(7),eb=d(865);class fb extends Sys.EventArgs{constructor(ka,Va){super();this.annotation=ka;this.KTa=Va}}Object(f.a)(fb,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var Cb=d(1654);class lc{constructor(ka){this.bif=this.annotations=null;if(!ka)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),
this.annotations=null;else if(ka.items&&0<ka.items.length){const Va=lc.i8d(ka.parentPath);this.annotations=Array(ka.items.length);let yb=0;for(const Yb of ka.items){const oc=Object.assign(new Cb.a,{id:Yb.id,parentPath:Va,content:Yb.body,annotationType:jc.a.getTypeNameFor(Yb.body),parentRevId:ka.parentRevId});this.annotations[yb++]=oc}this.bif=jc.a.getTypeNameFor(ka)}}static i8d(ka){return ka?ka.join("\\"):""}}Object(f.a)(lc,"AnnotationOperation",null,[]);class bc extends Sys.EventArgs{constructor(ka){super();
this.annotationType=ka}}Object(f.a)(bc,"AnnotationActivationEventArgs",Sys.EventArgs,[]);var Za=d(1839);class Ib{constructor(){this.newState=this.oldState=0;this.handlers=new L.a}}Object(f.a)(Ib,"AnnotationResultStateUpdateData",null,[]);var Ub=d(606),rc=d(981);class yc{constructor(){this.Yhf=this.M6k=this.$hf=null}}Object(f.a)(yc,"AnnotationCallbacks",null,[]);class rb{constructor(ka,Va,yb,Yb,oc,Vc){this.fcc=null;this.FNc=new va.a(0);this.cSc=new va.a;this.Nwd=new va.a;this.yJd=new Ub.a;this.Kgg=
null;this.oj=ka;this.FRa=Va;this.QH=yb;this.VD=Yb;this.ZK=oc;this.Cd=Vc}oIp(ka,Va,yb,Yb){this.VD.Dnc(ka)&&this.oj.ee(()=>{if(!this.fcc){this.fcc=new va.a;var oc=ab.ParagraphReader.Nv(eb.a.getRootNode(),!0,!0);for(const Vc of oc)Vc&&(oc=Vc.ka(Sa.a.Zc,0))&&(this.fcc.add(oc,Vc.id),this.FNc.W(Vc.id.toString(),oc))}this.FRa.Jgg(ka,(Vc,yd)=>{if(Vc){var Jd=this.VD.MBi(ka);Vc.contentDescriptor.Zw===Jd&&((Jd=this.pvm(Vc))?Vc.Cmb?(Jd=this.Tsf(Vc,Jd))&&(yd?yb(yd,Vc.contentDescriptor):Va(Jd,Vc.contentDescriptor)):
Yb(Vc.contentDescriptor):this.wQl(Vc,Object.assign(new yc,{$hf:Va,M6k:yb,Yhf:Yb})))}})},"PAS:FEPAOT")}pvm(ka){if(3===ka.contentDescriptor.Zw){let Va;return({value:Va}=this.fcc.Ec(ka.contentDescriptor.paragraphId)).returnValue?Va:null}if(4===ka.contentDescriptor.Zw)return qb.a.nil;a.ULS.sendTraceTag(592525442,rb.pj,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}qmn(ka,Va){if(3===ka.contentDescriptor.Zw)return Va=this.ZK.value.Eb(Va).getValue(Sa.a.Vj),ka.contentDescriptor.Vj===
Va;if(4===ka.contentDescriptor.Zw&&Va===qb.a.nil)return!0;a.ULS.sendTraceTag(592525443,rb.pj,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}wQl(ka,Va){if(3===ka.contentDescriptor.Zw){const yb=ka.contentDescriptor.paragraphId;this.cSc.mb(yb)||this.cSc.add(yb,new L.a);this.cSc.K(yb).add(Yb=>{12===Yb.type&&this.fcc.add(yb,Yb.id);ka.Cmb?(Yb=this.Tsf(ka,Yb.id))&&Va.$hf(Yb,ka.contentDescriptor):Va.Yhf(ka.contentDescriptor)})}else if(4===ka.contentDescriptor.Zw)if(ka.Cmb){const yb=
this.Tsf(ka,qb.a.nil);yb&&Va.$hf(yb,ka.contentDescriptor)}else Va.Yhf(ka.contentDescriptor);else a.ULS.sendTraceTag(592525444,rb.pj,15,"DelayCallbackForAnnotation: Unsupported content type")}Tsf(ka,Va){if(this.qmn(ka,Va)){if(Va=this.VD.CTn(ka.Cmb,ka.contentDescriptor,Va.toString()))return this.Nwd.W(Va.id,ka.wdb),Va}else this.Cd.isFeatureEnabled(81)&&this.QH.HSc(ka);return null}f9j(ka,Va){const yb=this.VD.K5d(ka);yb&&(Va===xb.a.getTypeName()?this.orp(ka,yb):this.Zqp(ka,yb))}orp(ka,Va){this.VD.Dnc(ka.annotationType)&&
(this.QH.YZa(this.ZK.value,Va,ka.annotationType),this.Nwd.remove(ka.id))}Zqp(ka,Va){if(this.VD.Dnc(ka.annotationType)){Va=Object.assign(new rc.a,{Cmb:this.VD.Q6k(ka),contentDescriptor:Va,annotationType:ka.annotationType});Va=this.QH.addAnnotation(this.ZK.value,Va);this.Nwd.W(ka.id,Va);const yb=this.VD.DKi(ka.annotationType);yb&&this.yJd.contains(yb)&&(this.oj.ee(()=>{var Yb=ab.ParagraphReader.Nv(eb.a.getRootNode(),!0,!0);if(Yb&&0<Yb.count){const oc=new L.a;for(const Vc of Yb)(Yb=rb.e8d(Vc))&&oc.add(Yb);
0<oc.count&&this.QH.cOh(this.ZK.value,yb,oc.toArray())}},"PAS:TAOCPA"),this.yJd.remove(yb))}}bwb(ka){if(this.fcc)if(ka){var Va=ka.ka(Sa.a.Zc,0);if(Va&&(this.FNc.W(ka.id.toString(),Va),({value:Va}=this.cSc.Ec(Va)).returnValue))for(const yb of Va)yb(ka)}else a.ULS.sendTraceTag(592525445,rb.pj,10,"OnParagraphNodeConnected: Invalid node")}Pmj(ka,Va){if(ka){var yb=ka.id.toString();ka=ka.ka(Sa.a.Zc,0);var Yb=0;({value:Yb}=this.FNc.Ec(yb)).returnValue&&(3===Va?(this.cSc.remove(Yb),this.FNc.remove(yb)):2===
Va?this.FNc.W(yb,ka):a.ULS.sendTraceTag(592525447,rb.pj,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,rb.pj,10,"UpdatePersistedAnnotations: Invalid node")}mJm(ka){let Va;return({value:Va}=this.Nwd.Ec(ka)).returnValue?Va:qb.a.nil}zDp(ka,Va,yb){ka?Va?this.FRa.vEi(ka,Yb=>{if(Yb){const yd=rb.e8d(Va,yb);if(yd){var oc=Array(Yb.length),Vc=!1;for(let Jd=0;Jd<Yb.length;Jd++)if(Vc||yd!==Yb[Jd])oc[Jd]=Yb[Jd];else{const Pd=rb.e8d(Va);if(!Pd)return;
Vc=!0;oc[Jd]=Pd;Yb[Jd]=Pd}Vc&&this.QH.cOh(this.ZK.value,ka,oc)}}}):a.ULS.sendTraceTag(588863697,rb.pj,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,rb.pj,10,"UpdateWorkflowParagraphVersion: null workflowType")}AZo(ka){ka?this.yJd.add(ka):a.ULS.sendTraceTag(588863698,rb.pj,10,"SetPendingWorkflow: null workflowType")}ptl(ka){ka?this.yJd.remove(ka):a.ULS.sendTraceTag(588105731,rb.pj,10,"ClearPendingWorkflow: null workflowType")}static e8d(ka,Va=0){if(!ka)return null;
Va||(Va=ka.ka(Sa.a.Vj,0));ka=ab.ParagraphReader.CU(ka);if(Va&&ka)return String.format("{0}{1}{2}",ka,rb.Hao,Va);a.ULS.sendTraceTag(588091606,rb.pj,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",Va?"valid":"0",ka?"valid":"0");return null}}rb.pj=389;rb.Hao="-";Object(f.a)(rb,"PersistedAnnotationStorage",null,[770]);class $c{constructor(){this.config=this.token=null}}Object(f.a)($c,"UpdateAnnotationConfigParameters",null,[]);var cd=d(126),Rd=d(788),ge=d(371),Ze=d(1282),De=d(1330),
Df=d(268),zd=d(756),hg=d(2097),ni=d(1838),Fd=d(861),Uc=d(778);class pd{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd,Qe,Cf,Wf=null,gg){this.Vkb=gg;this.sa=new bb.a;this.pFa=new Na.a;this.y9=new Na.a;this.XD=new Na.a;this.Jcc=new Na.a;this.DKe=new Na.a;this.vGc=new ic.a(kc.a.vh());this.a3e=new L.a;this.z4b=new Na.a;this.zKe=new Na.a;this.Owd=new Na.a;this.A4b=new Na.a;this.LDc=new Na.a;this.Pwd=new Na.a;this.Xyd=new Na.a;this.IHd=[];this.JHd=[];this.DLc=null;this.CGk=new ic.a(kc.a.vh());this.BKe=new Map;
this.sGc=new Map;this.VEc=null;this.Eoa=new Na.a;this.vYc=null;this.szh=this.pnh=0;this.T4a=null;this.tNl=()=>{if(this.IHd.length||this.JHd.length)try{0<this.IHd.length&&this.BLn(),0<this.JHd.length&&this.Kup()}finally{this.Etl()}else this.Gb.uf(this.DLc),this.DLc=null};this.Btl=()=>{const Jg=new L.a;for(const Lh of this.XD.values)if(Jg.add(Lh),Jg.count===pd.LGk)break;for(const Lh of Jg)this.OUa(Lh),this.F_b(Lh,xb.a.getTypeName());this.XD.count||(this.Gb.uf(this.VEc),this.VEc=null)};this.efd=(Jg,
Lh)=>{for(const Qj of Lh.Ck)Jg=Qj.intent,!Jg.type&&this.p4o(Jg.intent,Qj.cpBegin,Qj.cpEnd,Qj.RUb)&&this.OUa(Jg.intent)};this.iBk=ka.$("AugLoopAnnotationsAttachingIsEnabled");this.hNk=ka.pD("SendReleaseMessageAnnotationList")||[];this.Cd=Qe;this.TPa=Wf;this.FRa=Vc;this.QH=yd;this.eo=yb;this.VD=Jd;this.Sda=Pd;this.ZK=Yb;this.oj=Va;this.Gb=oc;K.a.instance.resolve(323).qgf(this.efd);this.fp=Cf;this.jok=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.ZAk=
ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.RCk=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.Aph=ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.Vkb&&this.TXm();this.wA=Df.a.instance}get LBj(){return this.A4b}set LBj(ka){this.A4b=ka}nb(ka,Va){a.ULS.sendTraceTag(41521862,pd.pj,50,"New registration for annotation type: {0}.",Va);this.addHandler(ka,
Va);this.Wdf(Va).catch(yb=>{a.ULS.sendTraceTag(594396739,pd.pj,10,"Failed to activate annotation type {0}: {1}",Va,yb.toString())})}addHandler(ka,Va){if(ka&&Va&&""!==Va){var yb=null;({value:yb}=this.A4b.Ec(Va,yb)).returnValue?yb.add(ka):(yb=new L.a,yb.add(ka),this.A4b.add(Va,yb))}else a.ULS.sendTraceTag(41521861,pd.pj,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!ka,!Va,""===Va)}xc(ka,Va){a.ULS.sendTraceTag(41521863,pd.pj,50,"Unregister handler for annotation type: {0}.",
Va);let yb=null;({value:yb}=this.A4b.Ec(Va,yb)).returnValue&&(yb.remove(ka),yb.count||(a.ULS.sendTraceTag(41521864,pd.pj,50,"Unregister all handlers for annotation type: {0}.",Va),this.A4b.remove(Va),this.gXn(Va)))}uQj(ka){this.vYc||(this.vYc=this.fp.Lc(2),this.vYc.Ab(ka))}Etl(){var ka;null===(ka=this.vYc)||void 0===ka?void 0:ka.dispose();this.vYc=null}z9h(){this.DLc||(this.DLc=new Gb.a(4,2,100,this.tNl,141),this.Gb.Yb(this.DLc))}BLn(){let ka;ka=Array.dequeue(this.IHd);const Va=eb.a.yQb(this.ZK.value,
ka);if(Va)if(Va.qk){this.uQj(Va);var yb=null;if(({value:yb}=this.LDc.Ec(ka,yb)).returnValue){this.LDc.remove(ka);for(const Yb of yb)this.CLn(Va,Yb)}else a.ULS.sendTraceTag(50663568,pd.pj,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.CGk.add(ka);else a.ULS.sendTraceTag(50436127,pd.pj,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}CLn(ka,Va){try{const yb=Va.content.range,Yb=new ec.a(0,yb.start,yb.start+yb.length,qb.a.create(),Va,oc=>{this.DKe.W(Va.id,
oc.toString())});this.eo.uYa(ka,Yb);ni.a.yzb(Va,2);this.sa.Jfa&&this.sa.raiseEvent(pd.zsc,new Za.a(Va,vb.a.getTypeName()))}catch(yb){ni.a.mcd(yb,[Va],!0)}}Jcj(ka){const Va=eb.a.d$a(ka.parentPath);let yb=null;({value:yb}=this.LDc.Ec(Va,yb)).returnValue||(yb=new L.a,this.LDc.add(Va,yb),this.IHd.push(Va));yb.add(ka);this.z9h()}ELn(ka,Va){this.oj.ee(()=>{let yb;if(({value:yb}=this.y9.Ec(ka,yb)).returnValue){var Yb=this.FTj(ka);for(const oc of yb){let Vc;({value:Vc}=this.XD.Ec(oc,Vc)).returnValue&&Va(Vc)&&
pd.KSb(Vc)&&(this.Jcj(Vc),Yb&&this.sa.raiseEvent(pd.zsc,new Za.a(Vc,xb.a.getTypeName())))}}},"AS:MIFAT")}Lup(ka,Va){this.oj.ee(()=>{let yb;if(({value:yb}=this.y9.Ec(ka,yb)).returnValue)for(const Yb of yb){let oc;({value:oc}=this.XD.Ec(Yb,oc)).returnValue&&Va(oc)&&pd.KSb(oc)&&(this.iLg(oc),ni.a.yzb(oc,4))}},"AS:UIFAT")}nXn(ka){var Va=eb.a.lH(ka);let yb=null;if(({value:yb}=this.pFa.Ec(Va,yb)).returnValue){Va=0;for(var Yb=new L.a;yb.count>Va;){var oc=yb.K(Va),Vc=null;({value:Vc}=this.XD.Ec(oc,Vc)).returnValue&&
pd.KSb(Vc)?this.VD.apd(ka,Vc)?this.OUa(Vc,!this.Cd.isFeatureEnabled(81)):(oc=Vc.content.range,Vc=new ec.a(0,oc.start,oc.start+oc.length,qb.a.create(),Vc),Yb.add(Vc),Va++):Va++}0<Yb.count&&this.eo.o8f(ka,Yb)}}Kup(){let ka=null;try{let Va="";Va=Array.dequeue(this.JHd);const yb=eb.a.yQb(this.ZK.value,Va);yb&&12===yb.type?(this.uQj(yb),({value:ka}=this.Pwd.Ec(Va,ka)).returnValue?(this.eo.Ssd(Yb=>ka.contains(Yb.intent),yb,0)&&ka.toArray().forEach(Yb=>{ni.a.yzb(Yb,4)}),this.Pwd.remove(Va)):a.ULS.sendTraceTag(50663570,
pd.pj,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")):a.ULS.sendTraceTag(50436128,pd.pj,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}catch(Va){ni.a.mcd(Va,ka.toArray(),!0)}}iLg(ka){let Va;({value:Va}=this.DKe.Ec(ka.id,Va)).returnValue||(Va=eb.a.d$a(ka.parentPath));this.DKe.remove(ka.id);var yb=null;({value:yb}=this.Pwd.Ec(Va,yb)).returnValue||(yb=new L.a,this.Pwd.add(Va,yb),this.JHd.push(Va));yb.add(ka);this.z9h();yb=null;({value:yb}=this.LDc.Ec(Va,
yb)).returnValue&&yb.remove(ka)}Vce(ka){var Va;return Uc.a.qti&&(null===ka||void 0===ka?0:ka.content)&&Fd.a.typeGuard(ka.content)&&(null===(Va=ka.content)||void 0===Va?0:Va.id)?!0:!1}RYk(ka){const Va=ka.id;var yb=ka.annotationType;const Yb=ka.parentPath;if(this.VD.Etb(ka)){var oc=eb.a.crb(this.ZK.value,Yb);if(oc&&(oc=oc.ka(Sa.a.Vj,0).toString(),ka.parentRevId&&oc!==ka.parentRevId))return!1}oc=null;({value:oc}=this.y9.Ec(yb,oc)).returnValue||(oc=new L.a,this.y9.add(yb,oc));oc.add(Va);yb=null;({value:yb}=
this.pFa.Ec(Yb,yb)).returnValue||(yb=new L.a,this.pFa.add(Yb,yb));yb.add(Va);this.XD.add(Va,ka);this.Vce(ka)&&this.Jcc.add(ka.content.id,Va);this.nIp(ka);return!0}nIp(ka){const Va=this.VD.eti(ka);if(0===Va.length)this.Igi(ka);else{let yb=!1;this.FRa.V2n(Va,ka.annotationType,(Yb,oc)=>{this.XD.mb(ka.id)?(oc=this.VD.Xtb(ka,eb.a.bjm(ka)),!Yb&&oc?(y.AFrameworkApplication.nd("3c7ef686;a13cd815"),this.Zmn&&(yb=!1),this.wMg(ka,10,!1)):Yb&&this.wMg(ka,Yb),yb||(this.Igi(ka),yb=!0)):oc.S_a=!0})}}get Zmn(){if(null!=
this.U_g)var ka=this.U_g;else{var Va;ka=this.U_g=null===(Va=y.AFrameworkApplication.J)||void 0===Va?void 0:Va.getBooleanFeatureGate("Microsoft.Office.WordOnline.IgnoreAllFix",!1)}return ka}Igi(ka){const Va=pd.KSb(ka);Va&&this.Jcj(ka);!Va&&this.sa.Jfa&&this.sa.raiseEvent(pd.zsc,new Za.a(ka,vb.a.getTypeName()))}z6j(ka,Va,yb,Yb){let oc=!0;this.oj.ee(()=>{if(Yb.startsWith(eb.a.RNb)){var Vc=ka.id,yd=null;if(Va===xb.a.getTypeName())this.OUa(ka);else if(({value:yd}=this.XD.Ec(Vc,yd)).returnValue)a.ULS.sendTraceTag(41418891,
pd.pj,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",Vc,ka.annotationType),this.XD.W(Vc,ka);else if(!this.RYk(ka)){oc=!1;return}yb&&Va===vb.a.getTypeName()&&Yb!==eb.a.RNb&&this.a3e.add(ka.annotationType)}this.F_b(ka,Va)},"AS:UAS");return oc}OUo(ka){if(ka)for(const Va of ka)this.F_b(Va,Bb.a.getTypeName()),ka=Va.content,this.Xyd.mb(ka.categoryName)?this.Xyd.W(ka.categoryName,Va):this.Xyd.add(ka.categoryName,Va);else a.ULS.sendTraceTag(592802119,pd.pj,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}GPh(ka){this.sa.addHandler(pd.zsc,
ka)}FPh(ka){this.sa.addHandler(pd.zjj,ka)}Cnc(ka){return this.z4b.mb(ka)}y1k(ka){this.sa.addHandler(pd.Ule,ka)}cDo(ka){this.sa.removeHandler(pd.Ule,ka)}FTj(ka){return!eb.a.Uf(ka)&&sa.a(ka)&&this.sa.Jfa}OUa(ka,Va=!0){if(this.XD.mb(ka.id)){var yb=this.XD.K(ka.id);this.Vce(ka)&&this.Jcc.remove(ka.content.id);this.XD.remove(ka.id);var Yb=null;({value:Yb}=this.pFa.Ec(ka.parentPath,Yb)).returnValue?(Yb.remove(ka.id),pd.KSb(yb)&&this.iLg(yb)):a.ULS.sendTraceTag(50734169,pd.pj,15,"DeleteAnnotationFromStorage: No annotations in given parent path");
Yb=null;({value:Yb}=this.y9.Ec(ka.annotationType,Yb)).returnValue?Yb.remove(ka.id):a.ULS.sendTraceTag(50734170,pd.pj,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.FTj(ka.annotationType)?this.sa.raiseEvent(pd.zsc,new Za.a(yb,xb.a.getTypeName())):this.F_b(ka,xb.a.getTypeName());Va&&this.Sda.f9j(yb,xb.a.getTypeName())}}gHf(ka,Va,yb=!1){const Yb=new L.a;var oc;if(!({value:oc}=this.y9.Ec(ka,oc)).returnValue)return Yb;for(const Vc of oc)this.XD.mb(Vc)?(ka=this.XD.K(Vc),
(oc=this.VD.K5d(ka))&&(Va.equals(oc)||yb&&Va.overlaps(oc))&&Yb.add(ka)):a.ULS.sendTraceTag(577843217,pd.pj,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",Vc);return Yb}b_d(ka){let Va=null;if(({value:Va}=this.y9.Ec(ka,Va)).returnValue){ka=Va.toArray();for(const yb of ka){let Yb;({value:Yb}=this.XD.Ec(yb,Yb)).returnValue&&this.OUa(Yb)}}}Zin(ka){return jc.a.getTypeNameFor(ka)===ge.a.getTypeName()}TWi(ka){var Va,yb;return(null===(yb=null===(Va=this.Vkb)||void 0===
Va?void 0:Va.IBi)||void 0===yb?void 0:yb.call(Va))===Rd.a.DCc&&ka&&0===ka.priority?this.Vkb.rrd(ka.context.substr(ka.startInContext,ka.range.length)):!1}Bwj(ka,Va){this.oj.ee(()=>{a.ULS.x4(pd.pj,100)&&a.ULS.sendTraceTag(41418894,pd.pj,100,"Operation of type {0} with path {1} received",jc.a.getTypeNameFor(ka),ka.parentPath.join("\\"));try{const yb=new lc(ka);for(const Yb of yb.annotations)if(Yb.annotationType===De.b.getTypeName()){const oc=Yb.content.results.map(Vc=>{var yd;const Jd=null===(yd=Vc.M_)||
void 0===yd?void 0:yd.seq;yd=void 0===Jd?Yb.id:Yb.id+"_"+Jd;return{id:yd,body:{...Vc,id:yd},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.Bwj({items:oc,parentPath:ka.parentPath,parentRevId:ka.parentRevId,H_:ka.H_},Va)}else yb.bif===vb.a.getTypeName()&&this.f7o(Yb)?(y.AFrameworkApplication.nd("g8469255;j5hhe441"),this.Aph&&(this.T4a||(this.T4a=zd.a.Uz()),this.pnh++,this.T4a.RQd("AnnotationSkippedDueToInvalidContextCount",this.pnh.toString()))):this.E5c(Yb,Va,yb.bif,!0)}catch(yb){a.ULS.sendTraceTag(41418898,
pd.pj,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",yb.message,yb.stack)}},"AS:PO")}f7o(ka){var Va;y.AFrameworkApplication.nd("01dfc961;05c12706");if(this.RCk&&sa.a(ka.annotationType)){var yb;let oc=yb=null;if(this.wA){yb=this.wA.cla;var Yb=null===yb||void 0===yb?void 0:yb.node;yb=eb.a.d$a(ka.parentPath);if(eb.a.yQb(this.ZK.value,yb)!==Yb)return!1;ka=ka.content;yb=ka.context.substring(ka.startInContext,ka.startInContext+ka.range.length);oc=null===(Va=null===Yb||
void 0===Yb?void 0:Yb.characterData)||void 0===Va?void 0:Va.substring(ka.range.start,ka.range.start+ka.range.length);this.Aph&&ka&&0===ka.priority&&(Va=0<ka.range.start?Yb.characterData.charAt(ka.range.start-1):null,Yb=ka.range.start+ka.range.length<Yb.characterData.length?Yb.characterData.charAt(ka.range.start+ka.range.length):null,"en-us"==ka.language.toLocaleLowerCase()&&oc&&yb&&oc===yb&&(Va&&Va.match("[A-Za-z0-9]")||Yb&&Yb.match("[A-Za-z0-9]"))&&(this.T4a||(this.T4a=zd.a.Uz()),this.szh++,this.T4a.RQd("partialWordAnnotationsCount",
this.szh.toString())))}return oc&&yb&&oc!==yb?!0:!1}return!1}E5c(ka,Va,yb,Yb){if(this.Zin(ka.content)&&this.TWi(ka.content))this.Wca(ka,70);else{var oc=ka.parentPath;yb!==xb.a.getTypeName()&&Yb||this.xCj(ka);Yb&&yb===vb.a.getTypeName()&&sa.a(ka.annotationType)&&ka.content.isHotCritique&&this.ZAk?this.sGc.set(ka.id,{annotation:ka,time:Date.now()}):(Yb=ka.annotationType,eb.a.Uf(Yb)||Yb!==xc.a.getTypeName()?!eb.a.Uf(Yb)&&sa.a(Yb)&&ka.content&&0==ka.content.priority&&cd.a.O7?(ka=eb.a.d$a(oc))&&ka==cd.a.qhm()&&
a.ULS.sendTraceTag(539870169,pd.pj,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):yb!==xb.a.getTypeName()&&this.vGc.contains(oc)?a.ULS.sendTraceTag(41418897,pd.pj,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",oc,ka.id):this.x6j(ka,oc,yb,Va):a.ULS.sendTraceTag(595342670,pd.pj,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",oc))}}Xzo(ka){if(ka&&ka.annotationType&&this.VD.Dnc(ka.annotationType)){var Va;
if(({value:Va}=this.y9.Ec(ka.annotationType,Va)).returnValue&&(ka=this.VD.K5d(ka)))for(const yb of Va){let Yb;({value:Yb}=this.XD.Ec(yb,Yb)).returnValue&&(Va=this.VD.K5d(Yb))&&(ka.equals(Va)||ka.overlaps(Va))&&this.OUa(Yb)}}}F_b(ka,Va){this.oj.ee(()=>{let yb=null;if(({value:yb}=this.LBj.Ec(ka.annotationType,yb)).returnValue)for(const Yb of yb)Yb.oH(ka,Va)},"AS:SATH")}Atl(){a.ULS.sendTraceTag(50860999,pd.pj,50,"ClearStorage: Initiated Clearing Storage");this.VEc||(this.VEc=new Gb.a(4,2,100,this.Btl,
142),this.Gb.Yb(this.VEc))}activateAnnotation(ka,Va){let yb;if(({value:yb}=this.Owd.Ec(ka,yb)).returnValue){if(yb.contains(Va))return Promise.resolve(null);yb.add(Va)}else{let Yb;this.Owd.add(ka,(Yb=new L.a,Yb.add(Va),Yb))}return this.Wdf(ka)}Wdf(ka){a.ULS.sendTraceTag(41521865,pd.pj,50,"ActivateAnnotation: Activating annotation type {0}.",ka);if(this.z4b.mb(ka))return Promise.resolve(null);var Va=null;if(({value:Va}=this.zKe.Ec(ka,Va)).returnValue)return Va;this.bVk(ka);if(Va=this.TPa?this.TPa():
null){const yb=new Ac.a;yb.annotationType=ka;this.jok&&(this.Eoa.mb(ka)||this.Eoa.W(ka,new Ib),yb.stateUpdateHandler=(Yb,oc)=>{this.Eoa.K(ka).oldState=Yb;this.Eoa.K(ka).newState=oc;for(const Vc of this.Eoa.K(ka).handlers)Vc(ka,Yb,oc)});Va=Va.activateAnnotation(yb);this.zKe.add(ka,Va);return Va.then(Yb=>{this.zKe.remove(ka);this.z4b.add(ka,Yb.token);this.y6j(Yb.token,ka);this.sa.raiseEvent(pd.Ule,new bc(ka,!0));this.RXm(ka);return Yb})}return Promise.reject(Error.create("Error during annotation activation"))}RXm(ka){const Va=
this.VD.DKi(ka);Va&&this.FRa.vEi(Va,yb=>{if(this.Sda.Kgg){var Yb=ab.ParagraphReader.Nv(eb.a.getRootNode(),!0,!0);if(Yb&&0<Yb.count){let oc=0;for(const Vc of Yb){Yb=rb.e8d(Vc);if(!Yb)continue;let yd=!1;for(;oc<yb.length;){if(Yb===yb[oc]){yd=!0;break}oc++}if(!yd){this.Sda.Kgg(Va);break}oc++}}}})}bVk(ka){this.Sda.oIp(ka,(Va,yb)=>{0<this.gHf(ka,yb,!0).count||this.z6j(Va,vb.a.getTypeName(),!0,Va.parentPath)},(Va,yb)=>{if(3!==yb.Zw)a.ULS.sendTraceTag(591541786,pd.pj,15,"Annotation moved to unsupported location type: {0}",
yb.Zw);else if(Va.Zw!==yb.Zw)a.ULS.sendTraceTag(591541787,pd.pj,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",Va.Zw,yb.Zw);else{Va=this.gHf(ka,Va);for(const oc of Va){const Vc=oc.content;Va=eb.a.crb(this.ZK.value,oc.parentPath);if(!Va){a.ULS.sendTraceTag(591541788,pd.pj,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.eo.Ssd(yd=>yd.intent===Vc,Va,0))break;var Yb=yb.bza;Yb=new ec.a(0,Yb,Yb+yb.aza,null,Vc);this.eo.uYa(Va,
Yb)}}},Va=>{for(const yb of this.gHf(ka,Va))this.OUa(yb,!1)})}releaseAnnotation(ka,Va){let yb;if(({value:yb}=this.Owd.Ec(ka,yb)).returnValue){yb.contains(Va)&&yb.remove(Va);if(0<yb.count)return Promise.resolve(!1);this.Owd.remove(ka)}a.ULS.sendTraceTag(593790408,pd.pj,50,"ReleaseAnnotation: Releasing annotation type {0}.",ka);return this.nMj(ka)}gXn(ka){var Va=null;if(({value:Va}=this.y9.Ec(ka,Va)).returnValue){a.ULS.sendTraceTag(41418899,pd.pj,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",
ka);for(const yb of Va)if(Va=null,({value:Va}=this.XD.Ec(yb,Va)).returnValue){const Yb=Va.parentPath;let oc=null;({value:oc}=this.pFa.Ec(Yb,oc)).returnValue&&(oc.remove(yb),oc.count||this.pFa.remove(Yb));this.Vce(Va)&&this.Jcc.remove(Va.content.id);this.XD.remove(yb);pd.KSb(Va)&&this.iLg(Va)}this.y9.remove(ka)}Array.contains(this.hNk,ka)&&this.nMj(ka)}nMj(ka){let Va=null;const yb=this.TPa?this.TPa():null;if(yb){if(({value:Va}=this.z4b.Ec(ka,Va)).returnValue){const Yb=new Nb;Yb.token=Va;this.z4b.remove(ka);
this.sa.raiseEvent(pd.Ule,new bc(ka,!1));return yb.releaseAnnotation(Yb)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}l7i(){this.oj.ee(()=>{if(this.iBk){var ka=eb.a.getRootNode();if(ka){var Va=new Na.a;Jb.f(ka,yb=>{var Yb=eb.a.lH(yb),oc=null;if(({value:oc}=this.pFa.Ec(Yb,oc)).returnValue)for(const Vc of oc)Yb=null,({value:Yb}=this.XD.Ec(Vc,Yb)).returnValue&&(Yb.parent=yb,Yb.ytb=!0,Yb.FXb=2,Va.mb(Yb.annotationType)||Va.W(Yb.annotationType,new L.a),
Va.K(Yb.annotationType).add(Vc),oc=null,({value:oc}=this.y9.Ec(Yb.annotationType,oc)).returnValue&&oc.remove(Yb.id));return!0},12);for(const yb of this.y9.keys)if(ka=null,({value:ka}=this.y9.Ec(yb,ka)).returnValue)for(const Yb of ka)if(ka=null,({value:ka}=this.XD.Ec(Yb,ka)).returnValue){let oc=null;ka.parentPath===eb.a.RNb?(ka.FXb=1,ka.parent=null):({value:oc}=this.XD.Ec(ka.parentPath,oc)).returnValue?(ka.FXb=3,ka.parent=oc):(ka.FXb=0,ka.parent=null,a.ULS.sendTraceTag(41554060,pd.pj,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",
ka.id));ka.ytb=!0;Va.mb(ka.annotationType)||Va.W(ka.annotationType,new L.a);Va.K(ka.annotationType).add(Yb)}else a.ULS.sendTraceTag(41997840,pd.pj,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",Yb);else a.ULS.sendTraceTag(41997841,pd.pj,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",yb);this.y9=Va;this.a3e.clear()}else a.ULS.sendTraceTag(41554058,pd.pj,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,
pd.pj,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}P6k(ka){this.Bwj(ka,!0)}d6n(ka,Va){this.oj.ee(()=>{const yb=Va?Va+String.format("\\{0}",ka.id):eb.a.lH(ka);a.ULS.sendTraceTag(41418900,pd.pj,50,"OnTileDeleted: Tile delete event received for tile {0}.",yb);this.vGc.contains(yb)||this.vGc.add(yb);var Yb=null;if(({value:Yb}=this.pFa.Ec(yb,Yb)).returnValue){a.ULS.sendTraceTag(41418901,pd.pj,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",Yb.count,
yb);for(const oc of Yb)Yb=null,({value:Yb}=this.XD.Ec(oc,Yb)).returnValue&&(this.F_b(Yb,xb.a.getTypeName()),this.sa.Jfa&&this.sa.raiseEvent(pd.zsc,new Za.a(Yb,xb.a.getTypeName())),this.Vce(Yb)&&this.Jcc.remove(Yb.content.id),this.XD.remove(oc));this.pFa.remove(yb)}},"AS:OTD")}c6n(ka){ka=eb.a.lH(ka);this.vGc.remove(ka)&&a.ULS.sendTraceTag(41418902,pd.pj,50,"OnTileAdded: Deleted tile {0} was re-added.",ka)}FBp(ka){if(ka){a.ULS.sendTraceTag(50436131,pd.pj,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",
ka.count);var Va=new Na.a;for(var yb of ka)ka=null,({value:ka}=Va.Ec(yb.parentPath,ka)).returnValue||(ka=new Na.a,Va.add(yb.parentPath,ka)),ka.W(yb.id,yb);for(const Yb of Va){Va=eb.a.crb(this.ZK.value,Yb.key);if(!Va){a.ULS.sendTraceTag(50436160,pd.pj,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}yb=new qa.a([0]);for(let oc=0,Vc=Va.ra.length;oc<Vc;oc++)ka=Va.ra.K(oc),ka.Ck&&yb.R0a(ka.Ck,void 0,(yd,Jd)=>{if(Jd){var Pd=null,Qe=Jd.intent;Qe&&({value:Pd}=Yb.value.Ec(Qe.id,
Pd)).returnValue&&(Qe=new Qc.a,Qe.start=Jd.Jb.cp,Qe.length=yd.Jb.cp-Qe.start,Pd.content.range=Qe,Pd.c8=!1)}})}}else a.ULS.sendTraceTag(50436130,pd.pj,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(ka){a.ULS.sendTraceTag(593049729,pd.pj,50,"GetAnnotationsByType: Method called for type {0}.",ka);return this.Wdf(ka).then(()=>{const Va=new L.a;this.oj.ee(()=>{if(eb.a.Uf(ka)||ka!==xc.a.getTypeName()){this.a3e.contains(ka)&&this.l7i();var yb=null;if(({value:yb}=this.y9.Ec(ka,
yb)).returnValue){a.ULS.sendTraceTag(41418903,pd.pj,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",ka);var Yb=new L.a;for(const oc of yb)yb=null,({value:yb}=this.XD.Ec(oc,yb)).returnValue&&(yb.c8&&Yb.add(yb),Va.add(yb));Yb&&0<Yb.count&&pd.KSb(Yb.K(0))&&this.FBp(Yb)}}else for(Yb of this.Xyd.values)Va.add(Yb);Va.count||a.ULS.sendTraceTag(41418904,pd.pj,50,"GetAnnotationsByType: No annotations found for type {0}!",ka)},"AS:GABT");return Va},Va=>{a.ULS.sendTraceTag(41418905,pd.pj,10,
"Exception occurred while fetching annotations of type {0}: {1}",ka,Va);return null})}getAnnotationById(ka){let Va=null;return({value:Va}=this.XD.Ec(ka,Va)).returnValue?Va:null}Psi(ka){let Va=null;return({value:Va}=this.Jcc.Ec(ka,Va)).returnValue?(ka=null,({value:ka}=this.XD.Ec(Va,ka)).returnValue?ka:null):null}V4d(ka){let Va=null;if(this.pFa.mb(ka))for(const yb of this.pFa.K(ka))if(ka=this.getAnnotationById(yb))Va||(Va=new L.a),Va.add(ka);return Va}cYa(ka){return(ka=this.getAnnotationById(ka))?(ka.ytb||
this.l7i(),ka):null}Wca(ka,Va){this.v0o(ka,Va);this.wMg(ka,Va);this.F_b(ka,Bb.a.getTypeName())}Cwp(ka,Va){this.wAp(ka,Va);this.AYo(ka,eb.a.ajm(ka));this.F_b(ka,Bb.a.getTypeName())}Dwp(ka,Va){ka=this.VD.eti(ka);for(const yb of ka)this.QH.iMg(this.ZK.value,yb,Va)}v0o(ka,Va){const yb=this.TPa?this.TPa():null;yb&&(ka=this.cjm(ka,Va))&&yb.setAnnotationState(ka)}wMg(ka,Va,yb=!0){if(ka&&pd.IVi(ka)){var Yb=this.getAnnotationById(ka.id);!ka.content||Yb&&ka.content===Yb.content||eb.a.setAnnotationState(ka,
Va);Yb&&Yb.content&&eb.a.setAnnotationState(Yb,Va);yb&&this.sa.Jfa&&(70===Va||60===Va)&&this.sa.raiseEvent(pd.zjj,new fb(ka,Va))}}cjm(ka,Va){let yb=null;ka&&(yb=Object.assign(new Rb,{id:ka.id,value:Va}),eb.a.Uf(ka.parentPath)||(yb.parentPath=ka.parentPath.split("\\")));return yb}AYo(ka,Va){const yb=this.TPa?this.TPa():null;yb&&(ka=this.$im(ka,Va))&&yb.setAnnotationMetadata(ka)}wAp(ka,Va){if(ka&&pd.IVi(ka)){var yb=this.getAnnotationById(ka.id);!ka.content||yb&&ka.content==yb.content||eb.a.XMj(ka,Va);
yb&&yb.content&&eb.a.XMj(yb,Va)}}$im(ka,Va){if(!ka)return null;const yb=new ib;yb.id=ka.id;yb.value=Va;eb.a.Uf(ka.parentPath)||(yb.parentPath=ka.parentPath.split("\\"));return yb}p4o(ka,Va,yb,Yb){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackCardRetentionEnabled",!1)&&(ka.annotationType===hg.b.getTypeName()||ka.annotationType===hg.d.getTypeName()))return!1;const oc=ka.content;if(this.VD.Etb(ka)&&oc){const Vc=oc.range.start+oc.range.length;if(0<
Yb&&Vc<=yb||0>Yb&&Vc<=yb+Yb)return!1;if(0<Yb&&oc.range.start>=Va||0>Yb&&oc.range.start>=yb)return oc.range.start+=Yb,!1}return!this.Cd.isFeatureEnabled(53)&&oc&&oc.M_?(ka=this.VD.Xtb(ka,60),!(60===oc.M_.state&&ka)):!0}MMh(ka,Va){this.Eoa.mb(Va)||this.Eoa.W(Va,new Ib);this.Eoa.K(Va).handlers.add(ka);ka(Va,this.Eoa.K(Va).oldState,this.Eoa.K(Va).newState)}gCj(ka,Va){this.Eoa.mb(Va)&&this.Eoa.K(Va).handlers.contains(ka)&&this.Eoa.K(Va).handlers.remove(ka)}static IVi(ka){ka=jc.a.getBaseTypesFor(ka.content);
return Array.contains(ka,pb.a.getTypeName())}static KSb(ka){if(void 0===ka.content||null===ka.content||""===eb.a.d$a(ka.parentPath))return!1;const Va=jc.a.getBaseTypesFor(ka.content);return Array.contains(Va,fd.a.getTypeName())&&ka.annotationType!==cb.RoleDetectionAnnotation.getTypeName()}Bwp(ka){ka?(this.BKe.AugLoop_Text_Critique=ka,ka=this.Cnc("AugLoop_Text_Critique")?this.z4b.K("AugLoop_Text_Critique"):null,this.y6j(ka,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,pd.pj,50,"Annotation configuration could not be updated for annotation type: {0}.",
"AugLoop_Text_Critique")}y6j(ka,Va){if(ka&&this.BKe[Va]){const yb=new $c;yb.token=ka;yb.config=this.BKe[Va];this.TPa&&(this.TPa().updateAnnotationConfig(yb),a.ULS.sendTraceTag(540615553,pd.pj,50,"Annotation configuration has been updated for annotation type: {0}.",Va))}}xCj(ka){let Va=null;({value:Va}=this.XD.Ec(ka.id,Va)).returnValue&&(ka.annotationType=Va.annotationType);this.sGc.has(ka.id)&&this.sGc.delete(ka.id)}x6j(ka,Va,yb,Yb){this.Xzo(ka);this.z6j(ka,yb,Yb,Va)&&this.Sda.f9j(ka,yb)}YZa(ka){const Va=
ka.parentPath,yb=xb.a.getTypeName();this.xCj(ka);this.Wca(ka,70);this.vGc.contains(Va)||this.x6j(ka,Va,yb,!0)}iAm(ka){const Va=new L.a;ka=this.y9.Ec(ka).value;if(null===ka)return Va;for(const yb of ka)ka=this.XD.Ec(yb).value,null!==ka&&Va.push(ka);return Va}async TXm(){await Object(Ze.b)();this.rCj()}rCj(){const ka=this.iAm(ge.a.getTypeName());for(const Va of ka)this.TWi(Va.content)&&this.YZa(Va)}}pd.pj=389;pd.zsc="OnAnnotationOperation";pd.zjj="OnAnnotationLocalStateChange";pd.Ule="OnAnnotationActivationChange";
pd.LGk=20;Object(f.a)(pd,"AnnotationStorage",null,[772]);class He{constructor(){this.qwe=null;this.kpd=!1}}Object(f.a)(He,"AugmentationLoopStateManager",null,[769]);var rf=d(181),Rf=d(578),kd=d(109),ff=d(596),Te=d(448),xe=d(256);class jf extends xe.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=
!1}en(){return Te.a.EPo}static construct(ka,Va,yb,Yb,oc,Vc){const yd=new jf;yd.ExpectedEndRevisionId=ka;yd.OriginString=Va;yd.Authorization=yb;yd.AugLoopSeedUrl=Yb;yd.FileId=oc;yd.SeedBatchesInParallelIsEnabled=Vc;yd.AddDocumentKindTypeToPathIsEnabled=!0;yd.CheckOnDemandNodeVersionEnabled=!0;yd.AddSubDocumentKindTypeToPathIsEnabled=!0;return yd}}Object(f.a)(jf,"FullFileAugLoopSeedingRequest",xe.a,[]);class Gg{constructor(){this.authToken=this.url=this.pqj=null}}Object(f.a)(Gg,"ReseedingTaskInfo",
null,[]);var ng=d(20);class pg{constructor(ka,Va,yb,Yb,oc,Vc){this.hF=null;this.fjh=!1;this.u6b=null;this.G6e=0;this.hid=(yd,Jd)=>{yd=Jd.Aea;this.u6b&&kd.AT(yd,Pd=>Pd===this.u6b)&&(Jd.httpStatusCode!==rf.a.xz||Jd.gk||2!==Jd.eqe?Jd.httpStatusCode!==rf.a.xz||Jd.gk||1!==Jd.eqe?this.THj(()=>{a.ULS.sendTraceTag(50861003,pg.pj,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",
Jd.httpStatusCode,Jd.gk,Jd.eqe,Jd.Qm)}):(this.PQ.kpd=!1,this.hF.EZb(this.hid),this.Re.Atl(),a.ULS.sendTraceTag(50861002,pg.pj,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),yd=Object(W.a)(Gg,this.u6b),this.ayj(Jd.eIj,yd.pqj,yd.url,yd.authToken)):this.THj(()=>{a.ULS.sendTraceTag(50861001,pg.pj,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.w8l=yd=>{if(void 0===yd||null===yd||void 0===yd.data||null===yd.data||void 0===yd.data.Ee||
null===yd.data.Ee)a.ULS.sendTraceTag(41445393,pg.pj,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(yd.data.He!==rf.a.xz)a.ULS.sendTraceTag(41445394,pg.pj,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",yd.data.He);else try{let Jd;({group:Jd}=Rf.a.N4(yd.data.Ee)).returnValue?Jd.Responses&&Jd.Responses.length?(yd=null,Jd&&Jd.Responses&&Jd.Responses.length&&(yd=Jd.Responses[0])?(this.TH.qPa(yd),yd.StatusCode?
a.ULS.sendTraceTag(41445398,pg.pj,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",yd.StatusCode):a.ULS.sendTraceTag(41445399,pg.pj,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",yd.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,pg.pj,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):
a.ULS.sendTraceTag(41445396,pg.pj,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,pg.pj,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(Jd){a.ULS.sendTraceTag(41445400,pg.pj,10,"FileSeedingSuccessCallback: {0}",Jd.message)}};this.v8l=yd=>{void 0===yd||null===yd||void 0===yd.data||null===yd.data||void 0===yd.data.Ee||null===yd.data.Ee?a.ULS.sendTraceTag(41445401,pg.pj,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):
a.ULS.sendTraceTag(41445402,pg.pj,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",yd.data.He)};this.hpk=ka.$("AugLoopServerSideSeedingIsEnabled");this.fpk=ka.$("AugLoopReseedingIsEnabled");this.gpk=ka.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.Huh=ka.fc("MaxReseedingRetries",1);this.Gf=Va;this.$Cd=yb;this.PQ=Yb;this.TH=oc;this.Re=Vc;ng.StaticActiveAppFrame.za()&&ng.StaticActiveAppFrame.za().kb&&ng.StaticActiveAppFrame.za().kb.ed&&ng.StaticActiveAppFrame.za().kb.ed.xg&&
(this.hF=ng.StaticActiveAppFrame.za().kb.ed.xg)}aan(ka,Va,yb){if(this.hpk){var Yb=this.PQ.qwe;Yb&&Yb.trim().length?this.fjh?this.fpk&&(a.ULS.sendTraceTag(50861E3,pg.pj,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.G6e=0,this.hF?(this.PQ.kpd=!0,this.hF.rKb(this.hid),this.u6b=Object.assign(new Gg,{pqj:ka,url:Va,authToken:yb}),this.hF.RA(null,null,this.u6b)):a.ULS.sendTraceTag(592814793,pg.pj,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,
pg.pj,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.ayj(Yb,ka,Va,yb),this.fjh=!0):a.ULS.sendTraceTag(41445391,pg.pj,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,pg.pj,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}THj(ka){this.G6e<this.Huh?(a.ULS.sendTraceTag(594384E3,pg.pj,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",
++this.G6e,this.Huh),this.hF.RA(null,null,this.u6b)):(this.PQ.kpd=!1,this.hF.EZb(this.hid),ka())}ayj(ka,Va,yb,Yb){const oc=jf.construct(ka,Va,Yb,yb,y.AFrameworkApplication.rootQuerySignature,this.gpk);a.ULS.sendTraceTag(595178454,pg.pj,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.$Cd.M$a.execute(()=>{this.n_k(oc)})}n_k(ka){a.ULS.sendTraceTag(595178453,pg.pj,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");
this.Gf.Xj(tb.a.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,ff.b(ka),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.w8l,this.v8l,ka);a.ULS.sendTraceTag(42016906,pg.pj,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}pg.pj=389;Object(f.a)(pg,"FullFileAugLoopSeedingService",null,[]);class dh{constructor(){}}Object(f.a)(dh,"RuntimeManagerInitializationTracker",null,[]);class Hg{getAugLoopRuntimeManager(){return zd.a.Uz()}}Object(f.a)(Hg,"AlFactoryWrapper",
null,[767]);class Zj{Bm(){return eb.a.Bm()}}Object(f.a)(Zj,"UtilsWrapper",null,[768]);var nh=d(753),eh=d(53),xf=d(13),Ig=d(38),Mj=d(178),If=d(2096),$b=d(6),wc=d(105),ed=d(25),Dd=d(356),ee=d(404),me=d(101),Nf=d(40);class Tf{constructor(ka,Va,yb,Yb,oc){this.Ga=ka;this.kg=yb;this.Xp=Yb;this.xe=oc;this.nta=this.Ga.$("WordDesignerCaptionDetectionEnabled")}DWo(ka,Va){ka.listType=this.bAm(Va);ka.outlineLevel=ab.ParagraphReader.XAa(Va);ka.indentation=Tf.NKf(this.Xp.qX(Va));ka.alignment=Tf.TGf(ab.ParagraphReader.Zy(Va));
ka.isInsideTable=this.isInsideTable(Va);ka.isInsideTOC=Va.Jq;ka.rightIndentation=Tf.NKf(this.Xp.Y9a(Va));var yb=this.Xp.nlc(Va);ka.specialIndentType=Tf.GMm(yb);ka.specialIndentBy=Tf.NKf(yb);ka.listType!==If.e.NoList&&this.hYo(Va,ka);this.p0o(Va,ka);yb=[];this.nta&&(yb=this.Oio(Va));ka.formattedRanges=this.Zum(Va,yb);this.nta&&null!=yb&&(ka.objectReferences=0<yb.length?yb:void 0)}Zum(ka,Va){var yb=ka.ra?ka.ra.length:0,Yb=wc.FormattingReader.Us(ed.a.create(ka));let oc=me.a.tL,Vc=0,yd=me.a.lR/2;Yb&&
(yd=wc.FormattingReader.Yg(Yb,xf.a.fontSize,me.a.lR)/2,oc=wc.FormattingReader.Yg(Yb,xf.a.font,me.a.tL),Vc=wc.FormattingReader.language(Yb));Yb="Normal";var Jd=this.xe.Hq(ka);Jd&&(Yb=Jd.getValue(Ig.a.la)||"Normal",Jd.hasProperty(xf.a.font)&&(oc=Jd.getValue(xf.a.font)));if(yb){--yb;Jd=[];let Lh=null,Qj=void 0,Uk=null;this.nta&&ka.hasProperty(xf.a.Zn)&&(Uk=ka.getValue(xf.a.Zn));const gj=ka.properties.ka(Sa.a.Ika,null);for(let Vj=0;Vj<yb;Vj++){var Pd=ka.ra.K(Vj),Qe=ka.Ic,Cf=null;this.nta&&(Cf=Tf.dPf(ka,
Uk,Vj));Pd.mf&&(Lh=Tf.$xp(Qe,Pd.mf,Lh));Pd.hyperlink&&Pd.hyperlink.url?Qj=Pd.hyperlink.url:Pd.yn&&(Qj=void 0);var Wf=ka.ra.K(Vj+1).cp-1;Qe=Pd.cp;Wf=Wf-Pd.cp+1;let om=!1,Hj=!1,pn=!1,ki=yd,Wq=0,gp=0,wm=Yb,si=void 0,sl=Vc,tl=oc,Gm;if(Pd.formatting){var gg=Pd.formatting;om=wc.FormattingReader.Yg(gg,xf.a.bold,!1);Hj=wc.FormattingReader.Yg(gg,xf.a.italic,!1);pn=wc.FormattingReader.Yg(gg,xf.a.underline,!1);ki=wc.FormattingReader.Yg(gg,xf.a.fontSize,2*yd)/2;Wq=wc.FormattingReader.Yg(gg,Ig.a.capitalization,
0);gp=wc.FormattingReader.Yg(gg,xf.a.fontColor,0);sl=wc.FormattingReader.language(gg)||Vc;tl=wc.FormattingReader.Yg(gg,xf.a.font,oc);wm=Yb;var Jg=gg.uo;Jg&&(Jg=Jg.ka(Ig.a.Jw,null))&&!Jg.equals(qb.a.nil)&&gg.paragraph.Ic&&(gg=this.xe.xo().Cla(Jg,gg.paragraph.Ic))&&(wm=gg.getValue(Ig.a.la))}this.nta&&(Gm=this.oMf(Cf),null!=Gm&&this.TOh(Va,Cf,Gm,Jd.length,If.b.Inline));Lh&&(si=0<Lh.count);Pd={isDeleted:this.Ajn(gj,Pd,Vj,Qj),fontFamily:tl,fontWeight:om?If.d.Bold:If.d.Normal,fontSize:ki,italic:Hj,underline:pn?
If.h.SingleLine:If.h.None,capitalization:Tf.i8h(Wq),color:gp,styleName:wm,isFollowUp:si,languageId:Tf.Z7h(sl),start:Qe,length:Wf,link:Qj,isReference:Tf.isReference(Pd)?!0:void 0,objectType:null!==Gm&&void 0!==Gm?Gm:void 0};Cf=0<Jd.length?Jd[Jd.length-1]:void 0;Tf.Gml(Cf,Pd)?Cf.length+=Pd.length:Jd.push(Pd)}return Jd}return[{fontFamily:oc,fontWeight:If.d.Normal,fontSize:yd,italic:!1,underline:If.h.None,capitalization:Tf.i8h(0),color:0,styleName:Yb,isFollowUp:void 0,languageId:Tf.Z7h(Vc),start:0,length:ka.characterData.length}]}Ajn(ka,
Va,yb,Yb){if(this.xD()){if(Va.blob||Va.formatting&&Va.formatting.cache&&Va.formatting.cache.BTb||Yb)return!0;if(ka&&yb<ka.length)return ka[yb]}return Va.QU?!0:Va.Wh?!0:!1}xD(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static Gml(ka,Va){return!!ka&&!!Va&&ka.start+ka.length===Va.start&&ka.isDeleted===Va.isDeleted&&ka.fontFamily===Va.fontFamily&&ka.fontWeight===Va.fontWeight&&ka.fontSize===Va.fontSize&&ka.italic===
Va.italic&&ka.underline===Va.underline&&ka.capitalization===Va.capitalization&&ka.color===Va.color&&ka.highlightColor===Va.highlightColor&&ka.styleName===Va.styleName&&void 0===ka.link&&void 0===Va.link&&ka.languageId===Va.languageId&&!ka.isReference&&!Va.isReference&&!ka.isFollowUp&&!Va.isFollowUp&&void 0===ka.objectType&&void 0===Va.objectType}bAm(ka){const Va=new $b.a;Va.set(ka);Va.vb(11);Va.fd(11);return(ka=this.kg.Tw(Va))?Tf.WCl(ka.listType):If.e.NoList}hYo(ka,Va){var yb=Nf.ListItemReader.De?
ka:this.kg.zfa(ka);if(Nf.ListItemReader.isListItem(yb)){if(Nf.ListItemReader.De){if(yb=Nf.ListItemReader.Nr(yb))Va.listId=yb.listId.toString()}else yb.hasProperty(Sa.a.listID)&&(Va.listId=yb.getValue(Sa.a.listID).toString());yb=this.sBi(ka,xf.a.font);ka=this.sBi(ka,xf.a.fontSize);yb&&(Va.bulletAndNumberFontFamily=yb);ka&&(Va.bulletAndNumberFontSize=ka)}}isInsideTable(ka){const Va=new $b.a;Va.set(ka);return Va.vb(14)}p0o(ka,Va){Va.spacingBeforeParagraph=this.rHi(ka,Sa.a.Sga,Sa.a.Y3,Sa.a.Uj);Va.spacingAfterParagraph=
this.rHi(ka,Sa.a.Rga,Sa.a.X3,Sa.a.ua);Va.lineSpacing=this.tQb(ka)}rHi(ka,Va,yb,Yb){if(ab.ParagraphReader.Yg(ka,Va,!1))return 0;Va=ab.ParagraphReader.Yg(ka,yb,-1);if(0<=Va)return Va*Dd.a.BXb/100;ka=ab.ParagraphReader.Yg(ka,Yb,-1);return 0<=ka?ka/20:0}sBi(ka,Va){ka=this.Krm(ka);if(null!=ka&&null!=ka.cache)return ka.cache.getValue(Va)}Krm(ka){var Va;ka=null===(Va=ka.ra)||void 0===Va?void 0:Va.last;return null!=ka&&ka.ri?ka.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),
null)}tQb(ka){const Va=ab.ParagraphReader.Yg(ka,Sa.a.ya,Dd.a.ya);ka=ab.ParagraphReader.Yg(ka,Sa.a.xa,Dd.a.lineSpacing);switch(Va){case 0:return ka/240;case 1:return ka/20;default:return 0}}static $xp(ka,Va,yb){for(let Yb=0;Yb<Va.length;Yb++){const oc=Va.K(Yb),Vc=oc.pk,yd=ka.Eb(Vc);yd&&yd.ka(Sa.a.FI,!1)&&(yb||(yb=new ic.a(new ee.a)),oc.Uc?yb.add(Vc):yb.remove(Vc))}return yb}static Z7h(ka){return(ka=nh.a.Hg(ka))&&ka.name?ka.name.toLowerCase():void 0}static NKf(ka){return ka?2===ka.unit?Math.floor(eh.a.PLb(ka.value)/
20):Math.floor(ka.value/20):0}static GMm(ka){if(!ka)return If.g.Initial;switch(ka.specialIndentType){case 1:return If.g.FirstLine;case 2:return If.g.Hanging;default:return If.g.Initial}}static i8h(ka){switch(ka){case 2:return If.c.AllCaps;case 1:return If.c.SmallCaps;default:return If.c.NoCaps}}static TGf(ka){switch(ka){case 1:return If.a.Left;case 3:return If.a.Right;case 2:return If.a.Center;case 6:return If.a.Justified;case 0:return If.a.None;default:return If.a.Other}}static WCl(ka){switch(ka){case 15:return If.e.Any;
case 1:return If.e.Bullet;case 42:return If.e.Invalid;case 13:return If.e.Lim;case 14:return If.e.Nil;case 16:return If.e.NoList;case 0:return If.e.Numbered;default:return If.e.Invalid}}static isReference(ka){return ka.blob&&(7===ka.blob.$h||10===ka.blob.$h)||ka.ei&&0<ka.ei.length||ka.mf&&0<ka.mf.length||ka.Ib&&0<ka.Ib.length?!0:!1}static dPf(ka,Va,yb){return null==Va?null:Va[yb]&&!Va[yb].equals(qb.a.nil)&&ka.Ic?ka.Ic.Eb(Va[yb]):null}oMf(ka){if(null==ka)return null;if(ka.hasProperty(Sa.a.ht)){var Va=
ka.getValue(Sa.a.ht);if(Tf.Jtj.has(Va))return Tf.Jtj.get(Va)}if(ka.hasProperty(Sa.a.ajc)&&null!=ka.getValue(Sa.a.ajc))return If.f.FootnoteEndnote;if(ka.hasProperty(Sa.a.Hcb)&&ka.getValue(Sa.a.Hcb))return If.f.PageBreak;if(ka.hasProperty(Sa.a.dUb)&&ka.getValue(Sa.a.dUb))return If.f.Tab;Va=!1;ka.hasProperty(Mj.a.ega)?Va=ka.getValue(Mj.a.ega):ka.hasProperty(Sa.a.ema)&&(Va=ka.getValue(Sa.a.ema));return Va&&ka.hasProperty(Sa.a.imageType)&&1==ka.getValue(Sa.a.imageType)?If.f.Image:null}static Amn(ka){return ka.hasProperty(Sa.a.dmc)&&
0<=ka.getValue(Sa.a.dmc)?!0:!1}U2i(ka){return Tf.Jhp.has(ka)}nai(ka,Va,yb,Yb){return null==ka||null==Va?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):Yb===If.b.Inline&&null==yb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):Yb===If.b.Floating&&null!=yb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),
null):0>yb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):Tf.Amn(ka)?null:this.U2i(Va)?{referencedPath:["session","doc","main",ka.id.toString()],formattedRangeIndex:yb,anchorMode:null!==Yb&&void 0!==Yb?Yb:If.b.Unspecified,anchoredObjectType:Yb==If.b.Floating?Va:void 0}:null}TOh(ka,Va,yb,Yb,oc){Va=this.nai(Va,yb,Yb,oc);null!=Va&&null!=ka&&ka.push(Va)}Oio(ka){const Va=[];if(null==ka)return a.ULS.sendTraceTag(null,389,10,
"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),Va;let yb=null;ka.hasProperty(Sa.a.t6)&&(yb=ka.getValue(Sa.a.t6));if(null!=yb)for(let Yb=0;Yb<yb.length;++Yb){const oc=Tf.dPf(ka,yb,Yb),Vc=this.oMf(oc);null!=Vc&&this.TOh(Va,oc,Vc,null,If.b.Floating)}return Va}R6h(ka){if(null==ka||!ka.hasProperty(xf.a.Zn))return!1;const Va=ka.getValue(xf.a.Zn);for(let Yb=0;Yb<Va.length;Yb++){var yb=Tf.dPf(ka,Va,Yb);yb=this.oMf(yb);if(this.U2i(yb))return!0}return!1}}Tf.Jtj=new Map([[5,If.f.Image],
[11,If.f.TextBox],[7,If.f.Chart],[6,If.f.SmartArt],[10,If.f.Drawing],[2,If.f.EquationObject],[4,If.f.Ink],[19,If.f.PageBreak],[23,If.f.FootnoteEndnote],[24,If.f.FootnoteEndnote],[35,If.f.FootnoteEndnoteReferenceMark],[36,If.f.FootnoteEndnoteReferenceMark],[0,If.f.Other]]);Tf.Jhp=new Set([If.f.Image,If.f.TextBox,If.f.Chart,If.f.SmartArt,If.f.Drawing,If.f.Ink]);Object(f.a)(Tf,"FormattingExtractor",null,[766]);var oi=d(1172);class Ie extends Sys.EventArgs{constructor(ka){super();this.Xlc=ka}}Object(f.a)(Ie,
"HasNodeEventsEventArgs",Sys.EventArgs,[]);class ag extends Sys.EventArgs{constructor(ka){super();this.oba=ka}}Object(f.a)(ag,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class uf{constructor(ka,Va,yb){this.oed=ka;this.graphNode=Va;this.fullPath=yb}}Object(f.a)(uf,"NodeEvent",null,[775]);class Pe{constructor(){this.FWe=this.jUe=!1;this.yFb=null;this.sa=new bb.a;this.Kda=new va.a(0);this.Iib=new oi.a(kc.a.vh());this.lGb=new oi.a(kc.a.vh());this.HHd=[]}wPh(ka){this.sa.addHandler("IsCollectingNodeEventsChangedKey",
ka)}ftl(){this.Kda=new va.a(0);this.Xlc=!1}get Xlc(){return this.jUe}set Xlc(ka){this.jUe!==ka&&(this.jUe=ka,this.sa.raiseEvent("HasNodeEventsChangedKey",new Ie(ka),this))}get oba(){return this.FWe}set oba(ka){this.FWe!==ka&&(this.FWe=ka,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new ag(ka),this))}u_b(ka,Va){this.Iib.mb(ka)||this.Iib.W(ka,Va)}xNo(ka,Va){this.lGb.W(ka,Va)}Tim(ka){let Va=null;this.lGb.mb(ka)&&(Va=this.lGb.K(ka),this.lGb.remove(ka));return Va}wte(ka,Va){if(ka)if(this.oba){var yb=
3!==Va&&4!==Va&&5!==Va||!this.Iib.mb(String.format("{0}",ka.id))?eb.a.lH(ka):this.Iib.K(String.format("{0}",ka.id));if(({value:Yb}=this.Kda.Ec(yb)).returnValue)if(Yb||3!==Va)if(5===Yb&&3===Va){if(ka=yb.split("\\").pop(),this.lGb.mb(ka)){var Yb=this.lGb.K(ka);Yb===yb?(this.k7f(yb,Va),this.Kda.add(yb,Va)):(this.lGb.W(ka,yb),this.Iib.W(ka,Yb),this.Naj(yb),this.Kda.remove(yb),this.k7f(yb,Va),this.Kda.add(Yb,5))}}else Yb&&(4!==Yb||0!==Va&&3!==Va&&5!==Va)&&(this.k7f(yb,Va),this.Kda.add(yb,Va));else this.Naj(yb),
this.Kda.remove(yb);else this.cJn(yb,Va),this.HHd.push(ka),this.Kda.add(yb,Va);this.Xlc=0<this.Kda.count}else a.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,389,15,"node is null.")}cJn(ka,Va){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",ka,Va)}k7f(ka,Va){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",ka,Va)}Naj(ka){a.ULS.sendTraceTag(593761367,
389,100,"Removing node {0} form _nodeIdEventKindMap.",ka)}sAl(){let ka=null;var Va=!1;let yb=null;for(;this.HHd.length&&!Va;){yb=Array.dequeue(this.HHd);if(!yb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),null;this.Iib.mb(String.format("{0}",yb.id))?(ka=this.Iib.K(String.format("{0}",yb.id)),this.Iib.remove(String.format("{0}",yb.id)),this.HHd.push(yb)):ka=eb.a.lH(yb);Va=this.Kda.mb(ka)}if(!Va)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),
this.ftl(),null;Va=this.Kda.K(ka);this.Kda.remove(ka);this.Xlc=0<this.Kda.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",ka,Va);return new uf(Va,yb,ka)}dto(ka){this.yFb=ka}tAl(){if(!this.yFb)return null;for(var ka=0;ka<this.yFb.length;ka++){var Va=this.yFb.K(ka);Va=eb.a.lH(Va.node);if(this.Kda.mb(Va))return null}ka=this.yFb;this.yFb=null;return ka}ytl(){this.yFb=null}vep(){this.oba=!0}Zkn(ka){return this.Kda.mb(ka.id.toString())}}Object(f.a)(Pe,"NodeEventsCollection",
null,[765]);var Db=d(1368),Vb=d(1288),Nc=d(352),td=d(88);class Ke extends Vb.a{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd,Qe,Cf){super();this.oDd=new Db.a;this.tib=!1;this.dHc=null;this.Rma=(Wf,gg)=>{(Wf=gg.node)&&this.Eeb(Wf)&&(a.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),eb.a.b6o(Wf,this.Tpa.oba,this.L4b,this.WMk)&&(this.Tpa.wte(Wf,0),this.A7j(Wf)));this.Tpa.oba&&this.Sda.bwb(Wf)};this.Kjj=(Wf,gg)=>{Wf=gg.node;this.Tpa.u_b(String.format("{0}",Wf.id),eb.a.lH(Wf))};this.RYa=(Wf,
gg)=>{(Wf=gg.node)&&this.Eeb(Wf)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.Tpa.oba&&this.Tpa.wte(Wf,3));this.Tpa.oba&&this.Sda.Pmj(Wf,3)};this.UN=(Wf,gg)=>{Wf=gg.node;gg=gg.property;Wf&&this.Aok.has(gg)&&this.Eeb(Wf)&&(a.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.Tpa.oba&&(this.Tpa.wte(Wf,2),gg===Sa.a.Vj&&this.A7j(Wf)));this.Tpa.oba&&gg===Sa.a.Zc&&this.Sda.Pmj(Wf,2)};this.Ljj=(Wf,gg)=>{(Wf=gg.node)&&ab.ParagraphReader.Vb(Wf)&&!this.LGc.has(Wf)&&
!this.zRe.has(Wf)&&(this.LGc.add(Wf),this.z0())};this.Rmj=(Wf,gg)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(Wf=gg.node)&&this.Re.nXn(Wf)};this.ycg=()=>{this.mpd()?this.nM():this.tib&&!this.Tpa.oba&&this.K0a()};this.gE=Va;this.Tpa=yb;this.WMk=td.b(Yb.qwe);this.L4b=ka.$("AugLoopOperationsAreEnabled");this.Re=oc;this.Sda=Vc;this.VD=yd;this.Gb=Jd;this.eo=Pd;this.QH=Qe;this.LGc=new Set;this.zRe=new Set;Cf.sva(this,7);this.Aok=new Set([xf.a.Yn,xf.a.bold,xf.a.italic,xf.a.underline,
xf.a.font,xf.a.fontSize,xf.a.fontColor,Ig.a.capitalization,xf.a.si,xf.a.Zn,Sa.a.Sga,Sa.a.Y3,Sa.a.Uj,Sa.a.Rga,Sa.a.X3,Sa.a.ua,Sa.a.ya,Sa.a.xa,Sa.a.listID,Sa.a.jV,Sa.a.je,Sa.a.hDa,Sa.a.Wv,Sa.a.Vj])}get index(){return 7}get Kfd(){return this.dHc}set Kfd(ka){this.dHc=ka;this.Sda.Kgg=ka?()=>{this.dHc()}:null}init(){this.mpd()&&this.nM();this.Tpa.wPh(this.ycg)}nM(){this.gE?(this.tib=!0,this.gE.wt(this.Rma),this.gE.KT(this.Kjj),this.gE.ly(this.RYa),this.gE.ro(this.UN),this.gE.cQh(this.Rmj),this.gE.L1k(this.Ljj)):
a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}K0a(){this.gE?(this.tib=!1,this.gE.vS(this.Rma),this.gE.fha(this.Kjj),this.gE.bva(this.RYa),this.gE.XP(this.UN),this.gE.uEj(this.Rmj),this.gE.iDo(this.Ljj)):a.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}Sae(ka){ka&&this.oDd.add(ka.id,ka.ka(Sa.a.Vj,0))}A7j(ka){this.oDd.mb(ka.id)?(this.Sda.zDp(La.a.mAe,ka,this.oDd.K(ka.id)),this.oDd.remove(ka.id)):
(this.Sda.ptl(La.a.mAe),this.Kfd&&this.Kfd())}Eeb(ka){const Va=ng.StaticActiveAppFrame.za().kb.Jc;return!!Va&&Va.sw&&!!Va.qd&&!!Va.qd.Ic&&!!ka&&!!ka.Ic&&ka.Ic.id===Va.qd.Ic.id}run(){if(0!==this.LGc.size){var ka=[];for(const Va of this.LGc)ka.push(Va),this.zRe.add(Va),100<=ka.length&&(this.jki(ka),ka=[]);0<ka.length&&this.jki(ka);this.LGc.clear()}}jki(ka){const Va=new Gb.a(4,1,500,()=>{for(const yb of ka)this.zRe.delete(yb),this.Fwp(yb)},158);this.Gb.Yb(Va)}Fwp(ka){var Va=this.eo.EKa(ka,0,Yb=>this.K7o(Yb.intent));
if(0<Va.count)for(const Yb of Va){Va=this.Sda.mJm(Yb.intent.id);var yb=ka.bsa;const oc=ab.ParagraphReader.CU(ka);Yb.end<Yb.Dc||(yb=Nc.a.cYc(oc,yb,Yb.Dc,Yb.end-Yb.Dc,Yb.Dc,Yb.end-Yb.Dc,ka),this.QH.Zrg(ka.Ic,Va,yb))}}K7o(ka){return!!ka&&this.VD.Etb(ka)&&!!ka.content}mpd(){return!this.tib&&this.Tpa.oba}}Object(f.a)(Ke,"ParagraphNodeEventHandler",Vb.a,[762]);var sf=d(971),qh=d(469),Ef=d(938),jg=d(234);class Fi extends Ef.a{constructor(){super();this.H_=Object.assign(new jg.a,{T_:Fi.getTypeName(),B_:Fi.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}
Object(f.a)(Fi,"DeltaUpdateOperation",Ef.a,[]);var hf=d(864);class Ph{constructor(){this.referencedPath=null}}Object(f.a)(Ph,"ItemReference",null,[]);class mg extends hf.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(f.a)(mg,"ItemWithPath",hf.a,[]);var el=d(1558);class Tg extends el.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new jg.a,{T_:Tg.getTypeName(),B_:Tg.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}}Object(f.a)(Tg,"MoveOperation",el.a,[]);var jh=d(1416);class xg extends jh.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new jg.a,{T_:xg.getTypeName(),B_:xg.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(xg,"SelectionSignal",jh.a,[]);class Of extends xg{constructor(){super();this.content=null;this.H_=Object.assign(new jg.a,{T_:Of.getTypeName(),B_:Of.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(f.a)(Of,"SelectionContentSignal",xg,[]);class Zh{constructor(){this.range=this.tileReference=null}}Object(f.a)(Zh,"TextTileRange",null,[]);var Ei=d(1655),Pf=d(863),Gi=d(30),Xk=d(36);class Sf{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd){this._augLoopRuntimeManager=this.uBd=null;this.P8e=!1;this.jqa=this.d_e=this.hMd=null;this.qeh=2E3;this.xam=()=>{if(tb.a.YU||qh.SessionStatusManager.instance&&qh.SessionStatusManager.instance.Mo)zd.a.Uz().closeSession(),a.ULS.sendTraceTag(512623445,
389,15,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Gb.uf(this.uBd);this.oj.ee(()=>{var Pd;const Qe=Df.a.instance.cla;this.xD()&&this.IHo();for(this.XQc.reset();this.O3a.Xlc&&!this.XQc.rvb();){let gg;gg=this.O3a.sAl();if(!gg||!gg.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.XQc.update();continue}if(!this.I5o(gg)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",
gg.graphNode.id);this.XQc.update();continue}const Jg=gg.graphNode.id.toString();var Cf=-1,Wf=!0;Qe&&Xk.a.qf(Qe)&&Jg==Qe.node.id.toString()&&(Cf=Qe.cpBegin,Wf=!1);let Lh=null;if(this.eIb.contains(Jg))switch(gg.oed){case 3:this.eIb.remove(Jg);Lh=3;break;default:Lh=gg.oed}else switch(gg.oed){case 0:case 1:this.eIb.add(Jg);Lh=0;break;case 2:this.eIb.add(Jg);Lh=0;break;case 3:this.eIb.remove(Jg);Lh=3;break;default:Lh=gg.oed}if(null!=Lh){Cf=this.pDi(gg.graphNode,gg.fullPath,Lh,Cf,Wf);if(4==Lh||5==Lh){if(Cf.prevParentPath.join()!==
Cf.parentPath.join()){Wf=Object.assign(new xb.a,{parentPath:Cf.prevParentPath,items:Cf.items});const Qj=Object.assign(new vb.a,{parentPath:Cf.parentPath,items:Cf.items,prevId:Cf.prevId,nextId:Cf.nextId});Jg!==Cf.prevId&&Jg!==Cf.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",Lh,Jg,Cf.prevId,Cf.nextId,gg.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new Pf.a,
{operation:Wf}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Pf.a,{operation:Qj}));14===gg.graphNode.type&&this.ZLj(gg.graphNode,Cf.parentPath).forEach(Uk=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Pf.a,{operation:Uk}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Pf.a,{operation:Cf}));if(this.ixd&&this.jqa&&this.jqa[0]==Jg)switch(Lh){case 3:this.jqa=null;break;case 0:case 1:case 2:case 4:case 5:this.jqa[1]=null===(Pd=this.akb.drb(gg.graphNode))||
void 0===Pd?void 0:Pd.I2c(gg.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",jc.a.getTypeNameFor(Cf),Jg);switch(Lh){case 0:case 4:case 5:this.Re.c6n(gg.graphNode);break;case 3:this.Re.d6n(gg.graphNode,Cf.parentPath.join("\\"))}}this.XQc.update()}(Pd=this.O3a.tAl())&&this.XFj(Pd)},"TV:FPEFO")};this.Sua=(Pd,Qe)=>{var Cf;if(Qe.Tm&&Qe.Tm.length){if(this.ixd)if(Pd=eb.a.$Cm(Qe.Tm),!Pd)this.jqa=null;else if(!this.jqa||this.jqa[0]!=
Pd.id.toString()){const Wf=this.O3a.Zkn(Pd)?null:null===(Cf=this.akb.drb(Pd))||void 0===Cf?void 0:Cf.I2c(Pd);this.jqa=[Pd.id.toString(),Wf]}this.P8e&&this.O3a.dto(Qe.Tm.currentSelection)}};this.Ga=ka;this.O3a=Va;this.Gb=yb;this.XQc=Yb;this.epk=this.Ga.$("AugLoopOperationsAreEnabled");this.eIb=new ic.a(kc.a.vh());this.Re=oc;this.oj=Vc;this.akb=yd;this.ib=Jd;this.ixd=this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.ib.BA(this.Sua);eb.a.Bm().then(()=>{this._augLoopRuntimeManager=
zd.a.Uz();this.Ga.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new Ei.a,{handler:Pd=>{this.Re.P6k(Pd)}}));this.epk&&this.O3a.vep();this.nfp()}).catch(()=>{});this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreasedIntervalForDelayedCritiquesIsEnabled",!1)&&(this.qeh=5E3)}IHo(){const ka=this.Re.sGc.entries();for(let Va=0;Va<this.Re.sGc.size;Va++){const yb=ka.next();y.AFrameworkApplication.nd("gi204158;ef1e2812");Date.now()-yb.value[1].time>=
this.qeh&&this.Re.E5c(yb.value[1].annotation,!0,vb.a.getTypeName(),!1)}}I5o(ka){return 3===ka.oed||eb.a.cUj(ka.graphNode)}nfp(){!this.uBd&&this.O3a.oba&&(this.uBd=new Gb.a(4,2,this.Ga.fc("NodeEventsFiringInterval",500),this.xam,131),this.Gb.Yb(this.uBd))}ZLj(ka,Va){var yb,Yb=[];const oc=$b.a.Za(ka),Vc=oc.Gq();for(var yd=0;yd<Vc;yd++){let Jd=oc.eC(yd);11===Jd.type&&(Jd=Gi.OutlineElementNavigator.Me(oc));const Pd=Jd.id.toString(),Qe=null===(yb=this.akb.drb(Jd))||void 0===yb?void 0:yb.gob(Jd);Yb.push(Object.assign(new hf.a,
{body:Qe,id:Pd,revId:eb.a.nPf(Jd)}));oc.fd(ka.type)}Va.push(ka.id.toString());yb=[];yb.push(Object.assign(new vb.a,{parentPath:Va.slice(),items:Yb,prevId:null}));for(Yb=0;Yb<Vc;Yb++)yd=oc.eC(Yb),11===yd.type&&(yd=Gi.OutlineElementNavigator.Me(oc)),0<oc.Gq()&&(yb=yb.concat(this.ZLj(yd,Va))),oc.fd(ka.type);Va.pop();return yb}HKa(ka){return ka.split("\\").slice(0,-1)}pDi(ka,Va,yb,Yb=-1,oc=!0){var Vc;let yd=null,Jd=null;const Pd=ka.id.toString();var Qe=null;3!==yb&&(Qe=eb.a.Vil(ka));if(Qe)for(let Cf=
0;Cf<Qe.length;Cf++)if(Qe[Cf]===Pd){Jd=Cf+1<Qe.length?Qe[Cf+1]:null;yd=Cf?Qe[Cf-1]:null;break}Pd!==yd&&Pd!==Jd||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",yb,Pd,yd,Jd,ka.type);Qe=null===(Vc=this.akb.drb(ka))||void 0===Vc?void 0:Vc.gob(ka,Yb,oc);Yb=[Object.assign(new hf.a,{body:Qe,id:Pd,revId:eb.a.nPf(ka)})];switch(yb){case 0:case 1:return Object.assign(new vb.a,{parentPath:this.HKa(Va),
items:Yb,prevId:yd,nextId:Jd});case 4:return Object.assign(new Tg,{parentPath:this.HKa(eb.a.lH(ka)),prevParentPath:this.HKa(Va),items:Yb,prevId:yd,nextId:Jd});case 5:return yb=this.O3a.Tim(Pd),Object.assign(new Tg,{parentPath:this.HKa(null!==yb&&void 0!==yb?yb:eb.a.lH(ka)),prevParentPath:this.HKa(Va),items:Yb,prevId:yd,nextId:Jd});case 2:return Object.assign(new Bb.a,{parentPath:this.HKa(Va),items:Yb});case 3:return Object.assign(new xb.a,{parentPath:this.HKa(Va),items:Yb});default:return a.ULS.sendTraceTag(42084322,
389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",yb,Pd),Object.assign(new el.a,{parentPath:this.HKa(Va),items:Yb,prevId:yd,nextId:Jd})}}xQm(ka){return this.jqa&&this.jqa[0]===ka?this.jqa[1]:null}lSo(ka){var Va;if(!this.ixd)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!eb.a.cUj(ka))return!1;const yb=ka.id.toString();var Yb=this.eIb.contains(yb)?2:0;Yb=this.pDi(ka,eb.a.lH(ka),Yb);this._augLoopRuntimeManager.submitOperation(Object.assign(new Pf.a,
{operation:Yb}));this.eIb.add(yb);this.jqa=[yb,null===(Va=this.akb.drb(ka))||void 0===Va?void 0:Va.I2c(ka)];return!0}dRo(ka,Va){var yb;if(this.ixd){var Yb=ka.id.toString(),oc=this.HKa(eb.a.lH(ka));Va=[Object.assign(new mg,{id:Yb,revId:eb.a.nPf(ka),parentPath:oc,delta:Va})];oc=Object.assign(new Fi,{parentPath:oc,items:Va});this._augLoopRuntimeManager.submitOperation(Object.assign(new Pf.a,{operation:oc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",Yb);this.jqa=[Yb,null===
(yb=this.akb.drb(ka))||void 0===yb?void 0:yb.I2c(ka)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}xal(ka,Va){if(ka.tileReference.referencedPath.length!==Va.tileReference.referencedPath.length||ka.range.start!==Va.range.start||ka.range.length!==Va.range.length||ka.range.isInsertionPoint!==Va.range.isInsertionPoint)return!1;for(let yb=0;yb<ka.tileReference.referencedPath.length;yb++)if(ka.tileReference.referencedPath[yb]!==Va.tileReference.referencedPath[yb])return!1;
return!0}ral(ka,Va){if(ka.selectedRanges.length!==Va.selectedRanges.length||ka.content!==Va.content)return!1;for(let yb=0;yb<ka.selectedRanges.length;yb++)if(!this.xal(ka.selectedRanges[yb],Va.selectedRanges[yb]))return!1;return!0}XFj(ka){ka=this.getSelection(ka);if(!this.d_e||!this.ral(ka,this.d_e)){var Va=this.hMd?this.hMd:qb.a.create().toString(),yb=[Object.assign(new hf.a,{body:ka,id:Va})];this.hMd?Va=Object.assign(new Bb.a,{parentPath:["session","doc"],items:yb}):(this.hMd=Va,Va=Object.assign(new vb.a,
{parentPath:["session","doc"],items:yb}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Pf.a,{operation:Va}));this.d_e=ka}}getSelection(ka){var Va;if(!ka)return null;const yb=new L.a;let Yb="";for(let yd=0;yd<ka.length;yd++){var oc=ka.K(yd),Vc=(null===(Va=this.akb.drb(oc.node))||void 0===Va?void 0:Va.gob(oc.node)).content;Yb+=Vc;Vc=oc.cpBegin<Vc.length?oc.cpBegin:-1;Vc=Object.assign(new Qc.a,{start:Vc,length:oc.cpEnd-oc.cpBegin});Object.assign(Vc,{isInsertionPoint:Xk.a.qf(oc)||Xk.a.rl(oc)});
const Jd=oc.node.id.toString();oc=this.HKa(eb.a.lH(oc.node));oc.push(Jd);yb.add(Object.assign(new Zh,{range:Vc,tileReference:Object.assign(new Ph,{referencedPath:oc})}))}return Object.assign(new Of,{selectedRanges:yb.toArray(),content:Yb})}h0o(ka){(this.P8e=ka)?this.FFj():this.O3a.ytl()}FFj(){this.XFj(this.ib.gb.currentSelection)}X2(){var ka,Va,yb=null===(ka=this.ib.gb)||void 0===ka?void 0:ka.currentSelection;if(yb){ka=new L.a;var Yb="";for(const oc of yb){yb=(null===(Va=this.akb.drb(oc.node))||void 0===
Va?void 0:Va.gob(oc.node)).content;Yb+=yb;yb=Object.assign(new Qc.a,{start:oc.Jj,length:oc.Wo-oc.Jj});const Vc=oc.node.id.toString(),yd=this.HKa(eb.a.lH(oc.node));yd.push(Vc);ka.add(Object.assign(new Zh,{range:yb,tileReference:Object.assign(new Ph,{referencedPath:yd})}))}return Object.assign(new Of,{selectedRanges:ka.toArray(),content:Yb})}}xD(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(f.a)(Sf,
"TileView",null,[764]);var Pi=d(32),El=d(48);class Kh{constructor(ka){El.a.assign(Kh,this,ka)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(ka){return El.a.matchesTypesFor(ka,[Kh.getTypeName()])}}Kh.H_={T_:Kh.getTypeName(),B_:Kh.getBaseTypes()};class Vi{constructor(ka){El.a.assign(Vi,this,ka)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(ka){return El.a.matchesTypesFor(ka,[Vi.getTypeName()])}}
Vi.H_={T_:Vi.getTypeName(),B_:Vi.getBaseTypes()};class Bj{constructor(ka){El.a.assign(Bj,this,ka)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(ka){return El.a.matchesTypesFor(ka,[Bj.getTypeName()])}}Bj.H_={T_:Bj.getTypeName(),B_:Bj.getBaseTypes()};class ci{constructor(ka){El.a.assign(ci,this,ka)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(ka){return El.a.matchesTypesFor(ka,
[ci.getTypeName()])}}ci.H_={T_:ci.getTypeName(),B_:ci.getBaseTypes()};class Mg{constructor(ka){El.a.assign(Mg,this,ka)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]}static typeGuard(ka){return El.a.matchesTypesFor(ka,[Mg.getTypeName()])}}Mg.H_={T_:Mg.getTypeName(),B_:Mg.getBaseTypes()};var ij;(function(ka){ka[ka.Top=0]="Top";ka[ka.Center=1]="Center";ka[ka.Bottom=2]="Bottom"})(ij||(ij={}));var fl;(function(ka){ka[ka.none=
0]="none";ka[ka.firstRow=32]="firstRow";ka[ka.lastRow=64]="lastRow";ka[ka.firstCol=128]="firstCol";ka[ka.lastCol=256]="lastCol";ka[ka.Mfq=512]="noHBand";ka[ka.Vfq=1024]="noVBand";ka[ka.nwCell=160]="nwCell";ka[ka.neCell=288]="neCell";ka[ka.swCell=192]="swCell";ka[ka.seCell=320]="seCell";ka[ka.DPl=1184]="defaultLook"})(fl||(fl={}));Object(f.b)("TableLookFlags",fl);class Mi{gob(ka){if(ka)switch(ka.type){case 14:return this.TLl(ka);case 15:return new Kh;case 16:return this.SLl(ka)}else a.ULS.sendTraceTag(524149331,
389,10,"ConvertNodeToTile: Node can't be null.")}TLl(ka){var Va=ka.iI||[];let yb=0;for(let Yb=0;Yb<Va.length;Yb++)yb+=Va[Yb];Va=Va.map((Yb,oc)=>({columnId:oc.toString(),widthPercent:0!=yb?100*Yb/yb:0}));return new ci({columnDefs:Va,tableLook:ka.properties.ka(Sa.a.tableLook,fl.DPl),complexTable:ka.properties.ka(Sa.a.complexTable,!1),floatingTable:ka.properties.ka(Sa.a.zYi,!1)})}SLl(ka){return new Vi({rowspan:ka.properties.ka(Sa.a.rowSpan,1),colspan:ka.properties.ka(Sa.a.colSpan,1),borderInfo:{topBorder:{color:ka.properties.ka(Sa.a.G1b,
0),size:ka.properties.ka(Sa.a.rzc,4),style:ka.properties.ka(Sa.a.Lzb,"single")},leftBorder:{color:ka.properties.ka(Sa.a.E1b,0),size:ka.properties.ka(Sa.a.pzc,4),style:ka.properties.ka(Sa.a.Jzb,"single")},rightBorder:{color:ka.properties.ka(Sa.a.F1b,0),size:ka.properties.ka(Sa.a.qzc,4),style:ka.properties.ka(Sa.a.Kzb,"single")},bottomBorder:{color:ka.properties.ka(Sa.a.D1b,0),size:ka.properties.ka(Sa.a.ozc,4),style:ka.properties.ka(Sa.a.Izb,"single")}},verticalAlignment:ka.properties.ka(Sa.a.GOa,ij.Top),
ghostCell:ka.properties.ka(Sa.a.ghostCell,!1),renderCell:ka.properties.ka(Sa.a.renderCell,!1),skippedCell:ka.properties.ka(Sa.a.skippedCell,!1),fillColor:ka.properties.ka(xf.a.YG,0),verticalMerge:ka.properties.ka(Pi.a.vMerge,null)})}I2c(ka){return null===ka||void 0===ka?void 0:ka.properties}}Object(f.a)(Mi,"TableElementNodeToTileConverter",null,[763]);class dk{constructor(ka,Va,yb){this.Vq=Va;this.AEa=yb;this.O1d=!1;this.dHc=null;this.Toj=(Yb,oc)=>{this.zDa(oc.node,0)};this.Poj=(Yb,oc)=>{Yb=oc.node;
this.AEa.u_b(Yb.id.toString(),eb.a.lH(Yb))};this.Uoj=(Yb,oc)=>{this.zDa(oc.node,3)};this.goe=(Yb,oc)=>{this.zDa(oc.node,2)};this.Woj=(Yb,oc)=>{this.zDa(oc.node,0)};this.Xoj=(Yb,oc)=>{this.zDa(oc.node,3)};this.Voj=(Yb,oc)=>{Yb=oc.node;this.AEa.u_b(Yb.id.toString(),eb.a.lH(Yb))};this.hoe=(Yb,oc)=>{this.zDa(oc.node,2)};this.Roj=(Yb,oc)=>{this.zDa(oc.node,0)};this.Qoj=(Yb,oc)=>{Yb=oc.node;this.AEa.u_b(Yb.id.toString(),eb.a.lH(Yb))};this.Soj=(Yb,oc)=>{this.zDa(oc.node,3)};this.eoe=(Yb,oc)=>{var Vc;Yb=
oc.node;if(oc.property===Sa.a.ghostCell){if(oc=Yb.Lg?Yb:null===(Vc=Yb.ECa)||void 0===Vc?void 0:Vc.dP){Vc=$b.a.Za(oc);var yd=Vc.Gq();for(var Jd=0;Jd<yd;Jd++){Vc.eC(Jd);var Pd=Gi.OutlineElementNavigator.Me(Vc);this.AEa.u_b(Pd.id.toString(),String.format("{0}\\{1}",eb.a.lH(oc),Pd.id));this.zDa(Pd,4);Vc.fd(16)}}}else if(oc.property===xf.a.qg){oc=$b.a.Za(Yb);Vc=oc.Gq();let Qe=null;yd=[];for(Jd=0;Jd<Vc;Jd++){oc.eC(Jd);Pd=Gi.OutlineElementNavigator.Me(oc);this.AEa.xNo(Pd.id.toString(),String.format("{0}\\{1}",
eb.a.lH(Yb),Pd.id));if(14!==Pd.type){if(Qe=eb.a.lH(Pd))this.AEa.u_b(Pd.id.toString(),Qe),this.zDa(Pd,5)}else yd.push(Pd);oc.fd(16)}Qe&&yd.forEach(Cf=>{this.AEa.u_b(Cf.id.toString(),String.format("{0}\\{1}",Qe.split("\\").slice(0,-1).join("\\"),Cf.id));this.zDa(Cf,5)})}this.zDa(Yb,2)};this.ycg=()=>{this.mpd()?this.nM():this.O1d&&!this.AEa.oba&&this.K0a()};this.L4b=ka.$("AugLoopOperationsAreEnabled")}get Kfd(){return this.dHc}init(){this.mpd()&&this.nM();this.AEa.wPh(this.ycg)}nM(){const {S_j:ka,iCe:Va,
H_j:yb}=this.Oxi();if(ka&&Va&&yb){this.O1d=!0;var Yb=this.Poj,oc=this.Uoj,Vc=this.goe;ka.wt(this.Toj);ka.KT(Yb);ka.ly(oc);ka.ro(Vc);Yb=this.Voj;oc=this.Xoj;Vc=this.hoe;Va.wt(this.Woj);Va.KT(Yb);Va.ly(oc);Va.ro(Vc);Yb=this.Qoj;oc=this.Soj;Vc=this.eoe;yb.wt(this.Roj);yb.KT(Yb);yb.ly(oc);yb.ro(Vc)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}K0a(){const {S_j:ka,iCe:Va,H_j:yb}=this.Oxi();if(ka&&Va&&yb){this.O1d=!1;var Yb=this.Poj,oc=this.Uoj,
Vc=this.goe;ka.vS(this.Toj);ka.fha(Yb);ka.bva(oc);ka.XP(Vc);Yb=this.Voj;oc=this.Xoj;Vc=this.hoe;Va.vS(this.Woj);Va.fha(Yb);Va.bva(oc);Va.XP(Vc);Yb=this.Qoj;oc=this.Soj;Vc=this.eoe;yb.vS(this.Roj);yb.fha(Yb);yb.bva(oc);yb.XP(Vc)}else a.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}zDa(ka,Va){ka&&this.Eeb(ka)&&this.AEa.oba&&this.L4b&&this.AEa.wte(ka,Va)}Oxi(){return{S_j:this.Vq.jf(14),iCe:this.Vq.jf(15),H_j:this.Vq.jf(16)}}Eeb(ka){const Va=ng.StaticActiveAppFrame.za().kb.Jc;
return!!Va&&Va.sw&&!!Va.qd&&!!Va.qd.Ic&&!!ka&&!!ka.Ic&&ka.Ic.id===Va.qd.Ic.id}mpd(){return!this.O1d&&!!this.AEa.oba}}Object(f.a)(dk,"TableNodeEventHandler",null,[762]);class zg{constructor(ka,Va){this.Urj=ka;this.rjp=Va}drb(ka){return ka?14===ka.type||15===ka.type||16===ka.type?this.rjp:12===ka.type?this.Urj:null:null}}Object(f.a)(zg,"NodeToTileConverterHolder",null,[580]);var Gf=d(338);class Ag{get name(){return"Box4.AugmentationLoop"}uc(ka){this.Z=ka;const Va=this.Z.resolve(71),yb=Va.$("AugLoopTaskUseTimeBasedYieldStrategy"),
Yb=new Pe,oc=yb?new Xa.a(Va.fc("AugLoopTaskAllowedRunTimeBeforeYielding",10),ja.a.Le):new hb(Va.fc("AugLoopTaskNodesToRunBeforeYielding",10));this.Z.ia(736,()=>wa.a.instance).ha();this.Z.ia("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new He).as(692).ha();this.Z.ia(739,()=>new Ke(Va,tb.a.ff.Pl.jf(12),Yb,this.Z.resolve(692),this.Z.resolve(454),this.Z.resolve(733),this.Z.resolve(734),y.AFrameworkApplication.oc,this.Z.resolve(735),this.Z.resolve(338),this.Z.resolve(201))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").ha();
eb.a.Yye()&&this.Z.ia(740,()=>new dk(Va,tb.a.ff.Pl,Yb)).ha();this.Z.ia(1247,()=>new Ta).ha();this.Z.ia(737,()=>new Tf(this.Z.resolve(71),this.Z.Oa(23),this.Z.resolve(10),this.Z.resolve(34),this.Z.resolve(8))).ha();this.Z.ia(734,()=>new La.a(new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed.ud),this.Z.resolve(735))).ha();this.Z.ia(733,()=>new rb(this.Z.resolve(736),this.Z.resolve(337),this.Z.resolve(338),this.Z.resolve(734),new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed.ud),ka.resolve(23))).ha();const Vc=
this.Z.resolve(726);this.Z.ia(454,()=>new pd(this.Z.resolve(71),this.Z.resolve(736),this.Z.resolve(735),new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed.ud),y.AFrameworkApplication.oc,this.Z.Oa(337),this.Z.Oa(338),this.Z.Oa(734),this.Z.Oa(733),ka.resolve(23),Gf.a.instance,()=>{try{return zd.a.Uz()}catch(yd){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",yd),null}},Vc)).ha();this.Z.ia(738,()=>new zg(new sf.a(this.Z.resolve(737)),
new Mi)).ha();this.Z.ia(741,()=>new Sf(Va,Yb,y.AFrameworkApplication.oc,oc,this.Z.resolve(454),this.Z.resolve(736),this.Z.resolve(738),this.Z.resolve(327))).ha();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.Z.ia(659,()=>new Zj).ha();this.Z.ia(660,()=>new Hg).ha()}init(){if(y.AFrameworkApplication.cI.BootFailed)a.ULS.sendTraceTag(512624089,389,15,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.J.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,
389,50,"Initializing Box4 Augmentation Loop package.");const ka=new pg(this.Z.resolve(71),y.AFrameworkApplication.Ge,tb.a.Rca,this.Z.resolve(692),gb.a.instance,this.Z.resolve(454)),Va=new $a;this.Z.register(572,1721).ha().mFp(()=>Va);y.AFrameworkApplication.nd("b8afb343;bjdjj400");const yb=eb.a.yCn(this.Z.resolve(78).$D,this.Z.resolve(725),ka,this.Z.resolve(643),Va);this.Z.ia("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new dh(yb)).ha();this.Z.resolve(739).init();eb.a.Yye()&&this.Z.resolve(740).init();
this.Z.resolve(337).init();this.Z.resolve(741)}}dispose(){}static main(ka){za.a.instance.Mc(new Ag,0,ka);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(f.a)(Ag,"Box4AugmentationLoopPackage",null,[0,1]);var Ti=d(605),em=d(35),Eg=d(11),Md=d(478),Re=d(1653);class Vm{constructor(ka,Va,yb,Yb=null,oc=null,Vc=null){this.eP=new Re.a(Va,Yb,oc,Vc);this.Jb=ka;this.Uc=yb}get type(){return this.eP.type}get id(){return this.eP.id}get intent(){return this.eP.intent}Mf(ka){return new Vm(ka,
this.type,this.Uc,this.id,this.intent,this.eP.QCa)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.eP,this.Uc)}}Object(f.a)(Vm,"IntentObject",null,[250]);var um=d(485),ce=d(154),nd=d(253);class Sk{constructor(){this.QHc=new ce.a}gRd(ka,Va,yb,Yb,oc=null,Vc=null,yd=null){ka=ka.A_(Va,ka.ra.irp(Va));ka.Ck||(ka.Ck=new um.a(ka));ka.Ck.add(new Vm(ka,yb,Yb,oc,Vc,yd));ka.rab=!0}WCj(ka){return ka.Jb&&ka.Jb.Ck&&ka.Jb.Ck.Skd(Va=>Va===ka,[ka.type])?!0:!1}XCj(ka,Va){if(ka.type===Va.type&&ka.Uc&&
!Va.Uc&&ka.Jb&&ka.Jb.Ck&&ka.Jb.Ck.contains(ka)&&Va.Jb&&Va.Jb.Ck&&Va.Jb.Ck.contains(Va)){var yb=[ka.type];ka.Jb.Ck.Skd(Yb=>Yb===ka,yb);Va.Jb.Ck.Skd(Yb=>Yb===Va,yb)}}fGp(ka,Va,yb){if(!Va)return!1;yb=new qa.a([yb]);for(let Yb=0;Yb<ka.length;Yb++){const oc=ka.K(Yb);if(!oc.Ck)continue;let Vc=!0;yb.R0a(oc.Ck,void 0,yd=>{yd.id&&Va.equals(yd.id)&&(Vc=!1)});if(!Vc)return!1}return!0}Ygo(ka,Va,yb,Yb){let oc=null,Vc=null;Va=new qa.a([Va]);const yd=ka.ra;for(let Jd=0;Jd<yd.length;Jd++){const Pd=yd.K(Jd);if(!Pd.Ck)continue;
let Qe=!0;Va.R0a(Pd.Ck,void 0,(Cf,Wf)=>{if(Wf){var gg=Wf.Jb.cp<yb,Jg=Cf.Jb.cp>Yb;gg&&Cf.Jb.cp<=yb||Wf.Jb.cp>=Yb&&Jg||(gg&&Jg?Qe=!1:gg?oc=Cf:Jg?Vc=Wf:this.XCj(Wf,Cf))}});if(!Qe)return!1}if(oc){if(!this.WCj(oc))return!1;this.gRd(ka,yb,oc.type,oc.Uc,oc.id,oc.intent,oc.eP.QCa)}if(Vc){if(!this.WCj(Vc))return!1;this.gRd(ka,Yb,Vc.type,Vc.Uc,Vc.id,Vc.intent,Vc.eP.QCa)}return!0}sCg(ka){let Va;return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:Va}=
this.QHc.Ec(ka.type,Va)).returnValue?Va.sCg(ka):!0}DLn(ka,Va){if(this.sCg(Va)){var yb=Va.id,Yb=Va.type,oc=Va.Dc,Vc=Va.end;if(({cpEnd:Vc}=Sk.Iak(ka,oc,Vc)).returnValue){if(Md.a(Yb)){if(!this.fGp(ka.ra,yb,Yb))return}else if(!this.Ygo(ka,Yb,oc,Vc))return;this.gRd(ka,oc,Yb,!0,yb,Va.intent,Va.eP.QCa);this.gRd(ka,Vc,Yb,!1,yb,Va.intent,Va.eP.QCa)}}}khd(ka,Va){ng.StaticActiveAppFrame.za().VAf(ka,()=>{const yb=new em.GraphTransaction(2);try{yb.Ab(ka);const Yb=ka.S0();try{const oc=ka.S6();try{Va()}finally{oc&&
oc.dispose()}}finally{Yb&&Yb.dispose()}}finally{yb&&yb.dispose()}})}uYa(ka,Va){this.khd(ka,()=>{this.DLn(ka,Va)})}FLn(ka,Va){if(Va.count){var yb=new Ub.a,Yb=new nd.a;for(var oc of Va){var Vc=oc.value;Md.a(oc.key)||Vc.Sc((Jd,Pd)=>Jd.Dc!==Pd.Dc?Jd.Dc-Pd.Dc:Jd.end-Pd.end);if(Sk.kGp(Vc))for(var yd of Vc)Vc=yd.end,({cpEnd:Vc}=Sk.Iak(ka,yd.Dc,Vc)).returnValue&&(Vc=Vc!==yd.end?new ec.a(yd.type,yd.Dc,Vc,yd.id,yd.intent,yd.eP.QCa):yd,yb.add(Vc.Dc),yb.add(Vc.end),Sk.uYk(Yb,Vc))}ka.n1d(yb);ka=ka.ra;for(yb=0;yb<
ka.length;yb++){oc=ka.K(yb);if(yd=oc.Ck)for(const Pd of Va.keys)yd.QDj(Pd);let Jd;({value:Jd}=Yb.Ec(oc.cp,Jd)).returnValue||(Jd=null);if(Jd){yd||(yd=oc.Ck=new um.a(oc));for(const Pd of Jd)yd.add(Pd.Mf(oc))}oc.rab=!0}}}o8f(ka,Va){const yb=new ce.a;for(const Yb of Va){let oc;({value:oc}=yb.Ec(Yb.type,oc)).returnValue||(oc=new L.a,yb.W(Yb.type,oc));oc.add(Yb)}this.khd(ka,()=>{this.FLn(ka,yb)})}Mup(ka,Va,yb){ka=ka.ra;const Yb=new qa.a([8]);Va===yb&&(yb+=1);for(let oc=0;oc<ka.length;oc++){const Vc=ka.K(oc);
Vc.Ck&&Yb.R0a(Vc.Ck,void 0,(yd,Jd)=>{Jd&&Math.max(Jd.Jb.cp,Va)<Math.min(yd.Jb.cp,yb)&&this.XCj(Jd,yd)})}}jLg(ka,Va,yb){this.khd(ka,()=>{this.Mup(ka,Va,yb)})}Oup(ka,Va){ka=ka.ra;for(let yb=0;yb<ka.length;yb++){const Yb=ka.K(yb);Yb.Ck&&Yb.Ck.QDj(Va)}}wAb(ka,Va){this.khd(ka,()=>{this.Oup(ka,Va)})}Nup(ka,Va,yb){let Yb=!1;Va=Va.ra;yb=[yb];for(let oc=0;oc<Va.length;oc++){const Vc=Va.K(oc);Vc.Ck&&(Yb=Vc.Ck.Skd(ka,yb)||Yb)}return Yb}Ssd(ka,Va,yb){let Yb=!1;this.khd(Va,()=>{Yb=this.Nup(ka,Va,yb)});return Yb}vkc(ka,
Va,yb,Yb){return!ka||0>yb||Yb>ka.characterData.length||yb>Yb?new L.a:this.EKa(ka,Va,oc=>Math.max(oc.Dc,yb)<=Math.min(oc.end,Yb))}EKa(ka,Va,yb){return Sk.cym(ka,Va,yb)}static cym(ka,Va,yb){const Yb=new L.a;ka=ka.ra;Va=new qa.a([Va]);if(!ka)return Yb;for(let oc=0;oc<ka.length;oc++){const Vc=ka.K(oc);Vc.Ck&&Va.R0a(Vc.Ck,void 0,(yd,Jd)=>{Jd&&(yd=new ec.a(Jd.type,Jd.Jb.cp,yd.Jb.cp,Jd.id,Jd.intent,Jd.eP.QCa),yb(yd)&&Yb.add(yd))})}return Yb}K3c(ka,Va){const yb=new L.a;if(!Sk.gwn(ka.contextId))return yb;
let Yb;const oc=ka.node;ka.contextId!==Eg.a.paragraph?(Yb=ka.cpBegin,ka=ka.cpEnd):(Yb=0,ka=oc.characterData.length);yb.addRange(this.vkc(oc,Va,Yb,ka));return yb}$wo(ka){this.QHc.mb(0)||this.QHc.W(0,ka)}static Iak(ka,Va,yb){ka=ab.ParagraphReader.textLength(ka);if(Va>=ka)return{returnValue:!1,cpEnd:yb};yb>ka&&(yb=ka);return{returnValue:!0,cpEnd:yb}}static kGp(ka){if(!ka.count)return!0;const Va=new Ti.a,yb=ka.K(0).type,Yb=Md.a(yb);let oc=-1;for(const Vc of ka){if(Vc.type!==yb||(Md.c(Vc.type)?Vc.Dc>Vc.end:
Vc.Dc>=Vc.end))return!1;if(Yb){ka=Vc.id;if(!ka||ka.equals(qb.a.nil)||Va.contains(ka))return!1;Va.add(ka)}else if(-1===oc)oc=Vc.end;else if(oc>Vc.Dc)return!1}return!0}static uYk(ka,Va){let yb;({value:yb}=ka.Ec(Va.Dc,yb)).returnValue||(yb=new L.a,ka.W(Va.Dc,yb));yb.add(new Vm(null,Va.type,!0,Va.id,Va.intent,Va.eP.QCa));({value:yb}=ka.Ec(Va.end,yb)).returnValue||(yb=new L.a,ka.W(Va.end,yb));yb.add(new Vm(null,Va.type,!1,Va.id,Va.intent,Va.eP.QCa))}static gwn(ka){return ka===Eg.a.Fd||ka===Eg.a.Vc||ka===
Eg.a.paragraph}}Object(f.a)(Sk,"IntentRangeEditor",null,[581]);class tg{constructor(){this.Z=null}get name(){return"Box4.Intent"}uc(ka){this.Z=ka;this.Z.ia("Box4.Intent.IntentRangeEditor",()=>new Sk).as(735).ha()}init(){this.Z.resolve(67)}dispose(){}static main(ka){za.a.instance.Mc(new tg,0,ka);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}Object(f.a)(tg,"PackageManager",null,[0,1]);var Bk=d(1010),jj=d(251),af=d(1290);class di{constructor(ka){this.PJn=ka;this.LJn=[]}get handler(){return this.PJn}get lsa(){return this.LJn}}
Object(f.a)(di,"RegisteredListener",null,[]);class Fl{constructor(ka,Va){this.type=0;this.payload=null;this.type=ka;this.payload=Va}}Object(f.a)(Fl,"OfficeSharedCommentsEvent",null,[1776]);class kh{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(f.a)(kh,"ViewContainerEvent",null,[1776]);var Xf=d(584);class fh{constructor(ka){this.K7f=!1;this.eua=new L.a;this.eje=ka}two(ka){ka=new di(ka);this.eua.add(ka)}T5j(ka){for(let Va=0;Va<this.eua.count;++Va)if(this.eua.K(Va).handler===
ka){this.eua.removeAt(Va);break}}u_a(ka=!1){const Va=()=>{if(y.AFrameworkApplication.Xl)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let oc=0;oc<this.eua.count;++oc){const Vc=this.eua.K(oc);for(;0<Vc.lsa.length;){var yb=Array.dequeue(Vc.lsa);if(Object(jj.a)(kh,yb)){var Yb=Vc.handler;Yb(yb)}else Object(jj.a)(Fl,yb)&&(Yb=Vc.handler,Yb(yb.type,yb.payload))}}};ka?Va():this.K7f||(this.K7f=!0,Xf.a.q6(this.eje,()=>{Va();this.K7f=!1},af.a.gcm))}}
Object(f.a)(fh,"GenericEventHost",null,[]);class Cj{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(f.a)(Cj,"BasicEventPayload",null,[1821]);class Dj{constructor(ka){this.nextPopulatedContextDetails=
0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ka}}Object(f.a)(Dj,"CommentContextDetails",null,[]);class Vl{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(f.a)(Vl,"ContextChangeWithSelectedThreadIndex",null,[1821]);class kj{constructor(){this.tasks=this.comments=null}}Object(f.a)(kj,"LoadCommentsNoVirtualization",null,[1821]);class ql extends fh{constructor(ka){super(ka);
this.TCh=0}u_o(){this.TCh=1656}gxo(ka,Va,yb,Yb,oc,Vc){ka=new di(ka);Vc&&Array.enqueue(ka.lsa,this.lFl(Vc,this.TCh));Vc=Va?Va.length:0;Array.enqueue(ka.lsa,this.K9h(Vc,yb,Yb,0));Vc&&Array.enqueue(ka.lsa,this.R$h(Va,oc));this.eua.add(ka);this.u_a()}z2b(ka){this.T5j(ka)}XQo(ka,Va,yb,Yb=0){this.xSb(this.K9h(ka,Va,yb,Yb));this.u_a()}YQo(ka,Va,yb){this.xSb(this.MFl(ka,Va,yb));this.u_a()}wRo(ka,Va){this.xSb(this.R$h(ka,Va));this.u_a()}selectComment(ka){this.xSb(this.Qai(ka,6));this.u_a()}highlightComment(ka){this.xSb(this.Qai(ka,
7));this.u_a()}BMg(ka,Va){this.xSb(this.jJl(ka,Va));this.u_a()}Mlg(ka,Va){this.xSb(this.uLl(ka,Va));this.u_a()}lFl(ka,Va=0){const yb=new Cj;yb.modelCapabilityFlags=ka;yb.richTextCapabilityFlags=Va;return new Fl(12,yb)}K9h(ka,Va,yb,Yb){const oc=new Cj;oc.numberOfComments=ka;oc.numberOfThreads=Va;oc.contextDetails=Object.assign(new Dj(yb),{nextPopulatedContextDetails:Yb});oc.contextDrafts=null;oc.rehydrationDrafts=null;return new Fl(0,oc)}MFl(ka,Va,yb){const Yb=new Cj;Yb.comments=ka;Yb.numberOfThreads=
Va;Yb.tasks=yb;return new Fl(2,Yb)}R$h(ka,Va){const yb=new kj;yb.comments=ka;yb.tasks=Va;return new Fl(1,yb)}Qai(ka,Va){const yb=new Cj;yb.commentId="";ka&&(yb.commentId=ka);return new Fl(Va,yb)}jJl(ka,Va){const yb=new Cj;yb.changes=[];yb.contextDetails=Object.assign(new Dj(Va),{nextPopulatedContextDetails:ka});return new Fl(10,yb)}uLl(ka,Va){const yb=new Cj;yb.commentId=ka;yb.smartReplies=Va;return new Fl(15,yb)}xSb(ka){for(let Va=0;Va<this.eua.count;++Va)Array.enqueue(this.eua.K(Va).lsa,ka)}}Object(f.a)(ql,
"OfficeSharedCommentsEventHost",fh,[1811]);var Pl=d(298),on=d(205),vl=d(300);class co{constructor(){this.B8e=this.s8g=!1;this.X5=this.Aq=this.Tmh=this.zth=this.RPd=this.k$b=this.AHh=this.Zbh=this.$D=this.TPc=null}initialize(ka,Va,yb,Yb=null,oc=null,Vc=null,yd=null,Jd=null,Pd=null,Qe=null){this.$D=ka;this.Zbh=Va;this.AHh=yb;this.k$b=Yb;this.RPd=oc;this.zth=Vc;this.Tmh=yd;this.Aq=Jd;this.s8g=!0;this.X5=Pd;this.TPc=Qe}ice(ka=null,Va=null){if(!this.s8g)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),
new Promise((yb,Yb)=>{Yb(Xf.a.DF(-2130915313))});if(this.B8e)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.TPc||(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?this.TPc=appResourceLoader.loadChunk("sharedComments"):this.TPc=this.$D.loadScript("sharedComments"));return this.TPc.then(()=>{ka&&ka();this.B8e||(this.X5&&this.X5.execute(yb=>{yb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate",
"InitializeFloodgateServiceInCommentsPane")}),Va&&Va(),sharedComments.instantiate(this.Zbh,this.AHh,this.k$b,this.RPd,this.zth,this.Tmh,this.Aq));this.B8e=!0})}}Object(f.a)(co,"CommentActivationManager",null,[1869]);class fm extends fh{constructor(ka){super(ka)}Wyo(ka){this.two(ka)}Ivp(ka){this.T5j(ka)}eRj(ka){ka=this.JFl(ka);for(let Va=0;Va<this.eua.count;++Va)Array.enqueue(this.eua.K(Va).lsa,ka);this.u_a(!0)}JFl(ka){const Va=new kh;Va.eventType=3;Va.viewContainerVisibilityState=ka;return Va}Fcm(){const ka=
this.BMl();for(let Va=0;Va<this.eua.count;++Va)Array.enqueue(this.eua.K(Va).lsa,ka);this.u_a(!0)}BMl(){const ka=new kh;ka.eventType=2;return ka}}Object(f.a)(fm,"ViewContainerEventHost",fh,[1755]);class Hk{constructor(){this.actionBehavior=this.actionType=0}}Object(f.a)(Hk,"CommentUIActionPayload",null,[]);var gn=d(308);class Mm{constructor(ka,Va){this.gMh=(yb,Yb,oc,Vc,yd)=>{if(this.qDc.mb(yb)){var Jd=this.qDc.K(yb);if(!this.uBb.mb(Jd))return 8;const Pd=this.uBb.K(Jd);if(Pd.preCallback){const Qe=Pd.preCallback(yb,
Yb,oc,Vc,yd);if(2!==Qe)return Qe}if(!Pd.registeredCallback)return 1===oc?8:2;Jd=Object.assign(new Hk,{actionType:Jd});1===oc&&(Jd.actionBehavior=1);Jd=Pd.registeredCallback(Jd);return Pd.postCallback?Pd.postCallback(Jd,yb,Yb,oc,Vc,yd):Jd?32:8}return 2};this.ga=ka;this.uBb=Va;this.qDc=new gn.a;for(const yb of this.uBb)this.qDc.W(yb.value.canvasActionId,yb.key),ka=yb.value,ka.delayActionsUntilRegistration||this.qa(ka)}qa(ka){ka.withFlags?this.ga.fb(ka.canvasActionId,ka.canvasContextId,this.gMh,97):
this.ga.qa(ka.canvasActionId,ka.canvasContextId,this.gMh)}TZa(ka,Va){this.uBb.mb(ka)&&(this.uBb.K(ka).delayActionsUntilRegistration&&this.qa(this.uBb.K(ka)),this.uBb.K(ka).registeredCallback=Va)}}Object(f.a)(Mm,"OfficeSharedCommentsActionHost",null,[1810]);var sk=d(1842),km=d(77),jk=d(124),gm=d(1359),wi=d(12),Nm=d(22),Ej=d(549),wl=d(1775),rl=d(66),ug=d(311),Yk=d(49),te=d(15),Un=d(1031),Wh=d(1024),cj=d(1509),Kf=d(180),nf=d(10),bg=d(31),Qg=d(707),ob=d(415),Lb=d(18),fc=d(2105);class Jc{constructor(ka){this.mZ=
ka;this.guc=new va.a;this.y$a=new va.a;this.N9m();this.b2m=[new fc.a(bg.a.X4h,bg.a.oxl),new fc.a(bg.a.OWd,bg.a.nxl),new fc.a(bg.a.P4h,bg.a.bxl),new fc.a(bg.a.IWd,bg.a.axl),new fc.a(bg.a.Y4h,bg.a.qxl),new fc.a(bg.a.PWd,bg.a.pxl)]}XZa(ka){this.mZ.XZa(ka);this.kAo(ka)}T_f(ka,Va){return!!ka&&!!ka.objectId&&Va.contains(qb.a.Af(ka.objectId))}NXa(ka){ka=Object(W.a)(749,ka);return!!ka&&!!ka.objectId}kAo(ka){for(const Va of this.b2m)ka.classList.remove(Va.className,Va.A5c);ka.classList.remove(bg.a.jlg,bg.a.RWd,
bg.a.rqf,bg.a.QWd,Jc.cRg)}N9m(){const ka=new va.a,Va=new va.a;ka.add(0,null);ka.add(1,bg.a.OWd);ka.add(2,bg.a.X4h);ka.add(3,bg.a.RWd);Va.add(0,null);Va.add(1,bg.a.IWd);Va.add(2,bg.a.P4h);Va.add(3,bg.a.rqf);this.y$a.W(1,ka);this.y$a.W(2,Va);this.y$a.W(3,Va);this.guc.add(0,null);this.guc.add(1,bg.a.PWd);this.guc.add(2,bg.a.Y4h);this.guc.add(3,bg.a.QWd)}}Jc.cRg="CommentImportant";Object(f.a)(Jc,"CommentHighlightUtils",null,[]);class Tc{constructor(){this.O0d=0;this.gMb=null}}Object(f.a)(Tc,"CommentGuidsInElementInfo",
null,[]);class qd{constructor(){this.GNi=!1;this.tra=this.pXb=null;this.wZa=this.TRb=0}}Object(f.a)(qd,"HighlightInfoForElement",null,[]);class Wc{constructor(){this.$Qi=this.bRi=this.aRi=-1;this.aPi=[];this.nfc=[];this.w7c=this.x7c=-1;this.pWi=!1}}Object(f.a)(Wc,"HighlightInfoForElementsInPara",null,[]);class Zd{constructor(){this.fLg=this.pgg=null}}Object(f.a)(Zd,"OnAnchorMouseOutData",null,[]);var ie=d(1396);class vf{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd){this.ENe=ka;this.kda=Va;this.ml=yb;this.z5=
Yb;this.ga=oc;this.Gb=Vc;this.Ij=yd;this.U3a=this.Hj=null;this.KYn=Pd=>{if(!this.Hj||this.z5.vee)return!0;if(Pd=Pd.zq){if(this.Hj.lB&&Pd[0].toString()===this.Hj.lB.objectId)return!0;this.U3a&&Pd[0].equals(this.U3a.fLg[0])?this.Gb.uf(this.U3a.pgg):(this.U3a&&(this.Gb.uf(this.U3a.pgg),this.ga.Pb(wi.a.SWd,2,this.U3a.fLg)),this.Hj.Np.qWi(Pd[0])&&!this.Ij.jn||this.ga.Pb(wi.a.uqf,2,Pd));this.U3a=null}return!0};this.JYn=Pd=>{if(this.z5.vee)return!0;const Qe=Pd.zq;Qe&&(Pd=new Gb.a(2,1,0,()=>{this.ga.Pb(wi.a.SWd,
2,Qe);this.U3a=null}),this.Gb.Yb(Pd),this.U3a=Object.assign(new Zd,{pgg:Pd,fLg:Qe}));return!0};this.mkj=Pd=>{const Qe=new Gb.a(2,1,0,()=>{if(this.Hj&&!this.Hj.Np.ez){var Cf=Pd.zq;if(!Cf)Cf=ng.StaticActiveAppFrame.za().xq.currentScope,this.Hj.lB&&(!Cf||Cf.name!==Kf.AFrame.zR&&Cf.name!==Kf.AFrame.zt)&&this.Hj.clearSelection();else if(!this.Hj.lB||Cf.toString()!==this.Hj.lB.objectId)if(Cf=this.Hj.Np.W2(Cf.toString()))Cf=Object.assign(new gm.a,{commentId:Cf.id,v4:!1,wca:1}),this.ga.Pb(Lb.a.selectComment,
2,Cf)}});this.Gb.Yb(Qe);return!1};Jd.execute(Pd=>{this.Hj=Pd})}QXh(ka,Va,yb,Yb){const oc=new Wc,Vc=[],yd=this.kda.NXa(Va)?Va.objectId:null;for(let Qe=0,Cf=ka.length;Qe<Cf;Qe++){var Jd=ka[Qe],Pd=ie.g(Jd);const Wf=ie.d(Jd);Jd=new Ti.a;const gg=new qd;if(Pd){const Jg=new ob.a(ie.c);Pd=this.Xni(Pd,yd,Jg);0<Pd.length&&(this.szp(Pd,yb,Jd,gg,yd,Yb),Vc.push(Object.assign(new Tc,{O0d:Qe,gMb:Jg})))}Wf&&(Pd=this.Xni(Wf,yd),0<Pd.length&&(this.uzp(Pd,yb,Jd,gg,oc,yd,Yb,Qe),this.Ixp(Vc,Pd,Qe,gg)));0<yb.count&&this.vzp(Va,
yb,gg,Yb);this.Gxp(Vc,gg);oc.aPi.push(gg)}return oc}hTh(ka,Va,yb){let Yb=!1;for(let oc=0,Vc=ka.length;oc<Vc;oc++){const yd=ka[oc],Jd=Va.aPi[oc],Pd=Qg.a(yd);if(1!==Pd&&2!==Pd&&3!==Pd)continue;const Qe=3===Pd||2===Pd&&-1!==yd.className.indexOf(bg.a.MWa);this.kda.XZa(yd);this.yZk(yd,Jd,Qe,Yb);this.OXk(yd,oc,Pd,Jd,Va,yb);this.PXk(yd,oc,Va,Jd);Yb=Qe}}Xni(ka,Va,yb=null){const Yb=[];for(let oc=0;oc<ka.length;oc++)this.ENe.BSj(ka[oc],ka[oc].toString()===Va)&&(Yb.push(ka[oc]),yb&&yb.add(ka[oc]));return Yb}szp(ka,
Va,yb,Yb,oc,Vc){var yd;let Jd=!1,Pd=!1;for(const Cf of ka){Va.add(Cf);yb.add(Cf);var Qe=Cf.toString();Qe===oc?(Qe=Vc?1:2,Yb.wZa=Qe,Yb.TRb=Qe):this.T_f(this.Hj.lB,Va)&&(Qe===(null===(yd=this.Hj.lB)||void 0===yd?void 0:yd.objectId)&&(Pd=!0),Jd=!0)}0<ka.length&&!Yb.wZa&&(Yb.wZa=Pd?1:3,Yb.TRb=Jd?1:3)}uzp(ka,Va,yb,Yb,oc,Vc,yd,Jd){var Pd,Qe;const Cf=new ob.a(ie.c);yd=yd?1:2;let Wf=!1;for(const gg of ka){const Jg=gg.toString();Va.contains(gg)||(Jg===Vc?oc.$Qi=Jd:(oc.aRi=Jd,Yb.wZa=3,(null===(Pd=this.Hj.lB)||
void 0===Pd?void 0:Pd.objectId)===Jg&&(oc.bRi=Jd,Yb.wZa=1)),Cf.add(gg));Jg===(null===(Qe=this.Hj.lB)||void 0===Qe?void 0:Qe.objectId)&&(Wf=!0);Va.remove(gg);yb.contains(gg)&&this.tzp(Yb,gg,Jg,Vc,yd);Jg===Vc&&(Yb.wZa=yd)}0<ka.length&&!Yb.wZa&&(Yb.wZa=Wf?1:3);0<Cf.count&&oc.nfc.push(Object.assign(new Tc,{O0d:Jd,gMb:Cf}))}Ixp(ka,Va,yb,Yb){0!==ka.length&&(Va.forEach(oc=>{for(let Vc=ka.length-1;0<=Vc;Vc--){const yd=ka[Vc];if(yd.gMb.contains(oc)){yd.O0d===yb&&(Yb.tra?Yb.tra.push(oc):Yb.tra=[oc]);yd.gMb.remove(oc);
break}}}),ka=ka.filter(oc=>0<oc.gMb.count))}vzp(ka,Va,yb,Yb){var oc,Vc;this.T_f(ka,Va)?yb.TRb=Yb?1:2:yb.TRb||(yb.TRb=null!=(null===(oc=this.Hj.lB)||void 0===oc?void 0:oc.objectId)&&Va.contains(qb.a.Af(null===(Vc=this.Hj.lB)||void 0===Vc?void 0:Vc.objectId))?1:3);yb.pXb||(yb.pXb=[]);for(const yd of Va)yb.pXb.push(yd)}Gxp(ka,Va){if(0<ka.length){Va.tra||(Va.tra=[]);for(const yb of ka[ka.length-1].gMb)Va.tra.push(yb)}}tzp(ka,Va,yb,Yb,oc){ka.GNi=!0;ka.pXb||(ka.pXb=[]);ka.pXb.push(Va);yb===Yb&&(ka.TRb=
oc)}T_f(ka,Va){return!!ka&&!!ka.objectId&&Va.contains(qb.a.Af(ka.objectId))}yZk(ka,Va,yb,Yb){!Va.wZa||yb||Yb||((yb=this.kda.guc.K(Va.wZa))&&ka.classList.add(yb),Va.GNi&&ka.classList.add(bg.a.jlg))}OXk(ka,Va,yb,Yb,oc,Vc){Yb=this.kda.y$a.K(yb).K(Yb.TRb);Va<oc.$Qi?Yb=Vc?this.kda.y$a.K(yb).K(1):this.kda.y$a.K(yb).K(2):Va<oc.aRi&&!Yb&&(Yb=Va<oc.bRi?this.kda.y$a.K(yb).K(1):this.kda.y$a.K(yb).K(3));Yb&&(Va=oc.pWi,ka.classList.add(Yb),Va&&ka.classList.add(Jc.cRg))}PXk(ka,Va,yb,Yb){Yb.tra||(Yb.tra=this.Dnm(Va,
yb)||Yb.pXb);Va=null;Yb.tra&&0<Yb.tra.length&&(this.ml.nb(nf.a.M3,ka,this.KYn,Yb.tra),this.ml.nb(nf.a.FCa,ka,this.JYn,Yb.tra),Va=Yb.tra[0]);this.ml.nb(nf.a.click,ka,this.mkj,Va);this.ml.nb(nf.a.xM,ka,this.mkj,Va)}Dnm(ka,Va){for(;0<Va.nfc.length&&Va.nfc[0].O0d===ka;)Va.nfc.splice(0,1);if(0<Va.nfc.length){ka=[];for(const yb of Va.nfc[0].gMb)ka.push(yb);return ka}return null}}Object(f.a)(vf,"AllMarkupModeHighlightChangeHandler",null,[745]);var vg=d(1363);class Ch extends vg.a{constructor(ka){super(100,
25);this.oDc=new va.a(0);this.Pnk=6E4;this.bcm=()=>{const Va=this.oDc.keys;if(Va.length){var yb="";for(let Yb=0;Yb<Va.length;Yb++)yb+=Va.K(Yb)+":"+this.oDc.K(Va.K(Yb))+";";this.Wua(yb);this.oDc=new va.a(0)}};this.EBb=new L.a;this.EBb.add(1);this.EBb.add(6);this.EBb.add(2);this.EBb.add(4);this.EBb.add(10);this.EBb.add(11);this.uj=ka;ka.Dqg&&window.setInterval(this.bcm,this.Pnk)}wNa(ka){this.uj.xtp&&this.uj.Dqg&&(this.EBb.contains(ka)?this.bro(ka):this.Wua(ka+""))}bro(ka){this.oDc.W(ka,this.oDc.e3(ka,
0)+1)}}Object(f.a)(Ch,"CommentActionInTypingRecorder",vg.a,[754]);var ek=d(1563),dj=d(236);class Cd{static zBo(ka){ka&&ka.atmention&&delete ka.atmention.isCurrentUser;return ka}}Object(f.a)(Cd,"DeltaFormatHelpers",null,[]);class gh{constructor(){this.optional=this.attributes=null}}Object(f.a)(gh,"Operation",null,[]);class Xe extends gh{constructor(){super();this.insert=null}}Object(f.a)(Xe,"DeltaOperation",gh,[]);class xh{constructor(){this.ops=null}}Object(f.a)(xh,"Delta",null,[]);var Pj=d(1144),
tj=d(737),Fj=d(464),lm=d(167),Oa=d(149),cc=d(51),Lc=d(79),rd=d(100),Oe=d(501),xd=d(58),pa=d(1142),Fb=d(1561);class Mb extends Fb.ACommentFormatTranslator{constructor(ka,Va,yb){super(ka,yb);this.xe=Va}$Ig(ka){const Va=new ek.a;for(let yb=0;yb<ka.length;yb++){const Yb=ka[yb];Yb.$Sb=!0;this.Z7k(Va,Yb);Va.Vla("\n")}return[Va.$jc()]}lnp(ka,Va){ka=ek.a.Rqb(ka[0]);ka=this.fvj(ka);const yb=new L.a;let Yb=0,oc=null,Vc=null;for(;Yb<ka.ops.length;){const yd=ka.ops[Yb];oc||(oc=pa.a.instance.createInstance(xd.a.paragraphNode),
oc.$Sb=!0,oc.Zg(Sa.a.Zc,dj.a.gG()),Va(oc),oc.ra.clear(),oc.vva(""));"\n"===yd.insert?(Vc=this.K5f(oc,Vc),this.U1o(oc),yb.add(oc),oc=null):Vc=this.IDn(oc,yd,Vc);Yb++}return yb.toArray()}enp(ka){ka=ek.a.Rqb(ka[0]);ka=this.fvj(ka);let Va=0;const yb=new Pj.a(new tj.a);for(;Va<ka.ops.length;){var Yb=ka.ops[Va];if("\n"===Yb.insert)Yb={},Yb["2"]=Pj.c.NRg,Yb[Sa.a.Zc.toString()]=dj.a.gG(),yb.JSc(new Pj.b("para_"+Va,new Fj.a(yb.getLength()),new tj.b(Yb)));else{const oc=this.WJm(Yb.attributes);yb.wD(new Fj.a(yb.getLength()),
Yb.insert,new tj.b(oc))}Va++}return yb}U1o(ka){const Va=ka.FZh();for(let yb=0;yb<Va;yb++)ka.qe.Mq.W(yb,Mb.QSn),ka.qe.Ot.W(yb,Mb.bcg)}K5f(ka,Va){var yb=ka.m1d();yb.cp===ka.characterData.length?yb.ri=!0:(yb=Object.assign(new lm.a(ka,ka.characterData.length),{ri:!0}),ka.ra.add(yb));yb=ka.ra.last;if(Va){Va=!!Va.Hw;const Yb=this.t6h(ka,yb,!Va,Va,null);yb.formatting=Yb;Va&&(ka=this.r6h(ka,yb),yb.zX=ka.Lk);yb.yn=!0;Va=null}yb.cp||yb.formatting||(yb.formatting=new Oa.a(yb,qb.a.nil));return Va}IDn(ka,Va,yb){const Yb=
ka.m1d(),oc=!!Va.attributes&&!!Va.attributes.link,Vc=!!Va.attributes&&!!Va.attributes.atmention,yd=this.t6h(ka,Yb,oc,Vc,Va);Yb.formatting=yd;yb&&(yb.Hw&&(yb=this.r6h(ka,Yb),Yb.zX=yb.Lk),Yb.yn=!0,yb=null);if(oc||Vc)this.dDn(Yb,ka,Va),yb=Yb.hyperlink;ka.vva(ka.characterData+Va.insert);return yb}r6h(ka,Va){Va=new Oa.a(Va,qb.a.create());let yb=this.OYd();yb.setValue(Sa.a.aUb,!0);yb=ka.Ic.WP(yb);Va.Lk=yb.id;return Va}t6h(ka,Va,yb,Yb,oc){Va=new Oa.a(Va,qb.a.create());let Vc=pa.a.instance.createInstance(xd.a.O_a);
if(yb||Yb)Vc.setValue(xf.a.DE,!0),Vc.setValue(xf.a.sba,!0),yb&&this.sUo(ka,Vc);oc&&oc.attributes&&this.v_o(oc.attributes,Vc);Vc=ka.Ic.WP(Vc);Va.Lk=Vc.id;return Va}sUo(ka,Va){(ka=this.xe.MF(ka))&&(ka=ka.mh(cc.StyleReader.XBc))&&Va.setValue(Ig.a.Jw,ka.id)}v_o(ka,Va){this.e0b(ka.weight>=ek.a.Hdd,Va,xf.a.bold,!0);this.e0b(ka.italic,Va,xf.a.italic,!0);this.e0b(ka.underline,Va,xf.a.underline,!0);this.e0b(ka.underline,Va,xf.a.underlineType,me.a.tAb);this.e0b(ka.strikethrough,Va,xf.a.strikethrough,!0);if(Lc.a.jUb(ka.highlight)){var yb=
Lc.a.CWa(ka.highlight);this.e0b(!!ka.highlight,Va,xf.a.highlight,Lc.a.qca(yb))}Lc.a.jUb(ka.color)&&(yb=Lc.a.CWa(ka.color),this.e0b(!!ka.color,Va,xf.a.fontColor,Lc.a.qca(yb)))}WJm(ka){const Va={};if(ka){ka.weight>=ek.a.Hdd&&(Va["1647"]="1",Va["1649"]="1");ka.italic&&(Va["1651"]="1",Va["1653"]="1");ka.underline&&(Va["1695"]="single");ka.strikethrough&&(Va["1659"]="1");if(Lc.a.jUb(ka.highlight)&&ka.highlight){const yb=Lc.a.CWa(ka.highlight);Va["1693"]=Lc.a.qca(yb)}Lc.a.jUb(ka.color)&&ka.color&&(ka=Lc.a.CWa(ka.color),
Va["1677"]=Lc.a.qca(ka))}return Va}e0b(ka,Va,yb,Yb){ka&&Va.setValue(yb,Yb)}dDn(ka,Va,yb){if(yb.attributes&&yb.attributes.atmention){var Yb=rd.a.KKa(yb.attributes.atmention.email);yb=yb.optional&&yb.optional.atmention&&yb.optional.atmention.contentId?yb.optional.atmention.contentId:Mb.agm(1===yb.attributes.atmention.resolveState);Yb=new Oe.a(ka,Yb,!0,void 0,void 0,void 0,yb);this.BEl(Yb,Va.Ic);ka.hyperlink=Yb}else Va=rd.a.KKa(yb.attributes.link),Yb=this.AHl(ka.paragraph.ra.first),ka.hyperlink=new Oe.a(ka,
Va,!1,Yb.Lk)}AHl(ka){let Va=this.Gai();Va=ka.paragraph.Ic.WP(Va);ka=new Oa.a(ka,qb.a.nil);ka.Lk=Va.id;return ka}BEl(ka,Va){var yb=String.format(' HYPERLINK "{0}"',ka.url),Yb=ka.Hw;const oc=this.OYd();oc.setValue(Sa.a.ht,15);oc.setValue(Sa.a.Hw,Yb);oc.setValue(Sa.a.KXa,!0);oc.setValue(Sa.a.S2,yb);ka.Tya(Va.WP(oc).id);Yb=this.OYd();Yb.setValue(Sa.a.ht,47);Yb.setValue(Sa.a.S2,yb);ka.Tya(Va.WP(Yb).id);yb=this.OYd();yb.setValue(Sa.a.ht,16);ka.Tya(Va.WP(yb).id)}Gai(){const ka=pa.a.instance.createInstance(xd.a.O_a);
ka.setValue(xf.a.DE,!0);ka.setValue(xf.a.sba,!0);ka.setValue(xf.a.isHidden,!0);return ka}OYd(){const ka=this.Gai();ka.setValue(xf.a.Qca,!0);return ka}fvj(ka){const Va=new L.a;for(let yb=0;yb<ka.ops.length;yb++){const Yb=ka.ops[yb];Yb.optional=Cd.zBo(Yb.optional);if(-1!==Yb.insert.indexOf("\n")&&"\n"!==Yb.insert){const oc=Yb.insert.split("\n");for(let Vc=0;Vc<oc.length;Vc++)if(yb!==ka.ops.length-1||Vc!==oc.length-1||oc[Vc])Va.add(Object.assign(new Xe,{insert:oc[Vc],attributes:Yb.attributes,optional:Yb.optional})),
Vc!==oc.length-1&&Va.add(Object.assign(new Xe,{insert:"\n"}))}else Va.add(Yb)}return Object.assign(new xh,{ops:Va.toArray()})}static agm(ka){return Fb.ACommentFormatTranslator.mbl+ra.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(ka?"Z":"")}}Mb.QSn=0;Mb.bcg=0;Object(f.a)(Mb,"CommentDeltaFormatTranslator",Fb.ACommentFormatTranslator,[]);var Ic=d(1686),ld=d(1513);class Kd{get userPrincipalName(){return this.J.jb("UserPrincipalName")}constructor(ka,Va,yb,Yb,oc){this.vj=ka;this.J=Va;
this.jI=yb;this.Sg=Yb;this.BY=oc}KF(ka){return this.vj.KF(ka)}ein(ka){ka=this.vj.KF(ka);return ka?!ka.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}h9c(ka){return this.vj.h9c(ka)}isCurrentUserMentioned(ka){var Va,yb;ka=this.vj.snm(ka);for(const Yb of ka){if(!Yb.text||0===Yb.text.length)continue;ka=ek.a.Rqb(Yb.text[0]);let oc=0;for(;ka.ops&&oc<ka.ops.length;){const Vc=null===(yb=null===(Va=ka.ops[oc])||void 0===Va?void 0:Va.attributes)||void 0===yb?void 0:
yb.atmention;if(Vc&&Vc.email===this.userPrincipalName)return!0;oc++}}return!1}kfd(){this.jI.f4("OnContentFilterUpdate")}cia(){var ka;this.Sg.jn&&(null===(ka=this.BY)||void 0===ka?void 0:ka.execute(Va=>Va.logActivity("WordWebCommentFilterActivity","CommentFilterFpsIsEnabled")))}}Object(f.a)(Kd,"CommentFilterActor",null,[753]);var ue=d(140),Ye=d(2098),Bf=d(889),Fg=d(599);class ah{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd){this.yi=ka;this.Gb=Va;this.oj=yb;this.u1a=Yb;this.Ij=oc;this.s1=Vc;this.Mh=yd;this.VW=
Jd;this.zS=Pd;this.TDb=null;this.Faf=0;this.vFd=!1;this.UJd=0;this.H2b=this.Rpd=this.bbh=this.oKc=this.HJb=!1;this.oBc=()=>{this.VW.WCg()&&this.Mh.oBc(this.vFd,this.Yhg)};this.Jvb=()=>{this.Mh.Jqa.zta()&&(this.hkd(this.Mh.Jqa.Jc),this.Mh.Jqa.Gvc(this.Jvb))};this.Yhg=()=>{this.Ufb();this.VW.Xhg()};this.QFg=()=>{!this.HJb&&this.VW.iCg()&&(this.UJd=this.Icf.scrollTop,this.HJb=!0,this.u1a.wNa(2))};this.Pqg=(Qe,Cf)=>{this.HJb&&(Qe=this.Icf.scrollTop,Qe-this.UJd?(this.oKc||Cf.sGe||this.updatePosition(),
this.oKc||1!==Cf.sGe||this.Ufb(),this.ohf(Qe),this.VW.Ugg()):this.oKc=this.HJb=!1)};this.Icf=this.Mh.kia;this.$ma=Fg.a.Voe;this.ru=this.Mh.ru;this.Mh.h6h()}get $de(){return this.VW.e1f()}get $ma(){return this.Mh.$ma}set $ma(ka){this.Mh.$ma=ka}get aUh(){return"1"===this.ru.wH.style.opacity}ORj(ka){this.Rpd||(this.Rpd=!0,this.Mh.tuj(),this.TDb=ka(this.ru.Sla,this.Mh.GDj,()=>{this.updatePosition()}),this.Mh.Q$i(this.TDb),this.VW.initialize(this.TDb,this),this.Mh.initialize(this.TDb,this.VW.Lvb),this.Mh.cBj(),
this.Mh.IRj(),this.Mh.JRj(),this.Mh.NRj(this.VW.Kkf,this.VW.One,this.VW.Nne),this.zrg())}Qod(){}Tye(){return this.Mh.FSj()}setInitialActiveContainerId(ka,Va,yb=null){this.Mh.setInitialActiveContainerId(ka,0,yb)}updatePosition(){if(!this.H2b&&this.$de&&this.yi.Usa()){var ka=ja.a.Le()-this.Faf<Fg.a.k9j;ka||this.vFd||this.Ufb(ka)}}Kjf(){this.Ufb()}v_a(ka,Va,yb){this.s1.f4("OnFloatingCommentsVisibilityChange",!0);this.Mh.v_a(ka,Va,yb)}uJa(ka,Va,yb=!1){this.Mh.uJa(ka,Va,()=>{this.yi.Y5c()||this.Mh.uae();
this.VW.$eg()},yb)}Ecc(ka,Va,yb){this.Mh.Ecc(ka,Va,yb,this.Mh.lj,this.VW.c4c,this.VW.Hdg)}Usj(ka){this.H2b=!0;ka();this.H2b=!1}eld(ka,Va,yb){this.Mh.eld(ka,Va,yb)}$ec(){this.Mh.$ec()}I9j(){const ka="1"===this.ru.wH.style.opacity;switch(!0){case ka&&!this.yi.Y5c():this.Mh.uae();break;case !ka&&this.yi.Y5c():this.Mh.$0b()}}nJg(ka=!0){this.VW.QCg&&this.Mh.Z1j(ka)}static kxi(ka,Va=null){const yb=new Na.a;for(const Yb of ka)Yb.Qf||Yb.Gr!==Ye.a.kE&&(!Va||Va(Yb))&&ah.wWk(yb,Yb.objectId,Yb);return yb}static wWk(ka,
Va,yb){let Yb;({value:Yb}=ka.Ec(Va,Yb)).returnValue||(Yb=[],ka.W(Va,Yb));Yb.push(yb)}hkd(ka){ka&&(ka.r6(()=>{this.oBc()}),this.UJd=this.Icf.scrollTop,ka.lQh(this.QFg),ka.mQh(this.Pqg))}zrg(){this.Mh.lj?this.hkd(this.Mh.lj):this.Mh.Jqa?this.Mh.Jqa.Wcc(this.Jvb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}ohf(ka){this.ru.wH.style.top=ka-this.UJd+"px";this.oKc=!1}Ufb(ka=!1){ka=new Gb.a(0,1,0,()=>{this.Oyf()},129,void 0,!ka);this.Gb.Yb(ka);this.vFd=
!0;this.oKc=this.HJb;this.u1a.wNa(10)}SMf(ka){return this.Mh.FUa({contentAnchorPositions:ka.contentAnchorPositions})}Oyf(){this.vFd=!1;if(this.ru.Sla&&this.TDb&&this.yi.Usa()){this.Mh.B1d();var ka=0;this.oj.ee(()=>{ka=this.Mh.$5d()},"FCM:UP:GET");var Va=null,yb=null;this.oj.ee(()=>{const Yb=this.VW.Gvi(ka,this.Mh.lj);Va=Yb.$xl;yb=this.SMf(Yb)},"FCM:UP:GP");this.oj.ee(()=>{this.HJb?(this.Mh.oji(yb),this.HJb=!1):this.TDb.emitEvent(3,yb);this.s1.Xse()},"FCM:UP:RC");this.TDb.setFirstCommentRenderDone();
"0"===this.ru.wH.style.opacity&&0<Va.count&&!this.Ij.jn&&this.Ij.lOa&&this.oj.ee(()=>{this.Mh.$0b()},"FCM:UP:SFC");!this.bbh&&0<Va.count&&(Xf.a.q6(this.Gb,this.Mh.maj,af.a.laj),this.bbh=!0);this.Faf=ja.a.Le();this.u1a.wNa(6)}else this.Faf=ja.a.Le()}}Object(f.a)(ah,"FloatingCommentManager",null,[21,707]);var Rg=d(125),Dh=d(1364),ej;(function(ka){ka[ka.aoq=0]="singleHint";ka[ka.gfq=1]="multiHint";ka[ka.llq=2]="resolvedHint";ka[ka.hfq=3]="multiResolvedHint";ka[ka.entryPoint=4]="entryPoint";ka[ka.unknown=
void 0]="unknown"})(ej||(ej={}));Object(f.b)("CommentIconType",ej);var ak=d(153),df=d(1102);const dc={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[ej.unknown]:""},zc={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],[2]:["OfficeIconColors_mCommentResolvedHintIconCenter",
"OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[ej.unknown]:[]},je=(ka,Va)=>{switch(ka){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(Va){case 3:return df.a.d5h;
case 2:return df.a.e5h;case 1:return df.a.f5h}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(Va){case 3:return df.a.a5h;case 2:return df.a.b5h;case 1:return df.a.c5h}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(Va){case 3:return df.a.g5h;case 2:return df.a.h5h;
case 1:return df.a.i5h}}},Le=(ka,Va)=>{ak.a("renderIcon")&&appChrome.api.renderIcon(ka,Va)};class Ed{}Ed.cPi=16;Ed.A3m=1;Ed.aVf=20;Ed.rdk=2;Object(f.a)(Ed,"CommentIconConstants",null,[]);class rj{constructor(){this.JWd=0;this.KTc=!1}}Object(f.a)(rj,"CommentHintCensus",null,[]);class ad{constructor(ka,Va,yb,Yb,oc){this.cch=ka;this.jcc=yb;this.ruk=Yb;this.rka=oc;this.tTa=-1;this.DNe=new Set(Va)}get y(){if(-1!==this.tTa)return this.tTa;const ka=Sys.UI.DomElement.getBounds(this.cch),Va=this.cch.getClientRects();
return this.tTa=0<Va.length&&Va[0]?this.ruk?ka.y/this.jcc+Ed.rdk:Math.floor(Va[0].height)/(2*this.jcc)+ka.y/this.jcc-Ed.cPi/2:0}get NWd(){return Array.from(this.DNe)}e0k(ka){this.DNe=new Set([...this.DNe,...ka])}}Object(f.a)(ad,"HintInfo",null,[773]);class $f extends Dh.a{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd,Qe,Cf,Wf,gg,Jg){super();this.uj=ka;this.Fg=Va;this.ml=yb;this.tG=Yb;this.ga=oc;this.yi=Qe;this.Hwa=Cf;this.u1a=Wf;this.Ij=gg;this.Prk=Jg;this.kyd=new Map;this.tEb=this.gIb=null;this.nAc={eAb:-1,
scg:-1}}Q_a(ka){let Va=!1;tb.a.Ack&&ka.ic.jj?wa.a.instance.ee(()=>{Va=ie.n(ka,!0)},"CHA:SCIVE"):wa.a.instance.ee(()=>{Va=ie.m(ka.htmlElement,!0)},"CHA:SCI");return Va}DUa(ka){const Va=this.zoom,yb=ka.V3,Yb=ka.jLa;let oc=0;for(let Jd=0;Jd<ka.B7.length;Jd++)if(0<ka.B7[Jd].width){oc=Jd;break}const Vc=ka.J6a(1,Ed.aVf,Va,oc);this.u1a.wNa(1);let yd=[];Yb.forEach((Jd,Pd)=>{const Qe=ka.B7[Pd].y/Va;Jd=this.QHl(this.swm(Jd,Pd),Cf=>this.BHl(yb,Cf,Cf.y-Qe,Vc),()=>$f.GJl(yb));yd=yd.concat(Jd)});return yd}QHl(ka,
Va,yb){yb=yb();const Yb=[];for(const oc of ka){ka=Va(oc);for(const yd of oc.NWd)this.kyd.set(yd.toString(),ka);const Vc=this.aDi(oc.NWd);this.W7j(Vc,ka);null==yb.rka&&(yb.rka=oc.rka);yb.appendChild(ka);Yb.push(ka)}this.lmc(this.tEb);this.bsb(this.gIb);return[yb]}aDi(ka){var Va,yb;let Yb=0,oc=0;for(const Vc of ka)if(this.yi.d0f(Vc)){if(this.uj.contentFilterApiEnabled&&this.Ij.jn&&(ka=this.yi.W2(Vc.toString()),null===(yb=(Va=this.Prk).isContentInFilteredContent)||void 0===yb||!yb.call(Va,ka.id)))continue;
this.yi.qWi(Vc)?oc+=1:Yb+=1}Va=new rj;Va.JWd=Yb+oc;Va.KTc=0===Yb;return Va}dBc(ka){if(ka=this.kyd.get(ka.objectId)){var Va=ie.g(ka);Va=this.aDi(Va);this.W7j(Va,ka)}}W7j(ka,Va){let yb,Yb;if(this.uj.contentFilterApiEnabled&&0===ka.JWd)Va.style.display="none";else if(1===ka.JWd?(yb=ka.KTc?2:0,Yb=ka.KTc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=ka.JWd&&(yb=ka.KTc?3:1,Yb=ka.KTc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:
WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),Va.style.display="block",ka=Va.firstElementChild)this.aXo(ka,yb),ka.title=Yb+". "+ka.title,Le(dc[yb],ka)}aXo(ka,Va){ka.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;Rg.a.Im(ka,$f.j5h,Va)}swm(ka,Va){ka=this.CHl(ka,Va);ka.sort((yb,Yb)=>yb.y-Yb.y);return this.lOn(ka)}CHl(ka,Va){const yb=[],Yb=this.uj.Kr,oc=this.zoom;ka=ie.f(ka,!0);for(let Vc=0,yd=ka.length;Vc<yd;Vc++){const Jd=ka[Vc],Pd=ie.g(Jd);Pd&&yb.push(new ad(Jd,
Pd,oc,Yb,Va))}return yb}lOn(ka){let Va=null;const yb=[];for(let Yb=0;Yb<ka.length;Yb++)Va&&Math.abs(ka[Yb].y-Va.y)<Ed.cPi+Ed.A3m?Va.e0k(ka[Yb].NWd):(Va=ka[Yb],yb.push(Va));return yb}BHl(ka,Va,yb,Yb){const oc=ka.Jh.ownerDocument,Vc=oc.createElement("div");Vc.className=$f.Z4h;Vc.style.top=yb+"px";Vc.style.left=Yb+"px";Vc.style.right="auto";Vc.style.zIndex="40";Rg.a.Im(Vc,bg.a.sWc,Va.NWd);Va=oc.createElement("span");this.pMg(Va,Vc);Le(dc[0],Va);this.YE(Va,ka);return Vc}pMg(ka,Va){ka.title=CommonUIStrings.l_CommentHintTooltip;
ka.setAttribute("role","button");Va.appendChild(ka)}YE(ka,Va){this.Fg.YI(nf.a.click,ka,this.o0n.bind(this),Va);this.Fg.nb(nf.a.fD,ka,this.r0n.bind(this));this.ml.nb(nf.a.M3,ka,this.t0n.bind(this));this.ml.nb(nf.a.cM,ka,this.s0n.bind(this));this.tG.nb(ka,this.q0n.bind(this))}static GJl(ka){ka=ka.Jh.ownerDocument.createElement("div");ka.className=$f.i9n;return ka}q0n(){return!0}r0n(){return!0}o0n(ka){const Va=ie.g(ka.Uy.parentNode);ka.eventName===nf.a.xM&&(this.Hwa.bpf(),this.Z2h());this.ga.Pb(wi.a.$4h,
2,Va);return!0}t0n(ka){this.yKa(this.tEb)!==ka.Uy&&(ka=ie.g(ka.Uy.parentNode),this.ga.Pb(wi.a.uqf,2,ka));return!0}s0n(){this.ga.Ob(wi.a.SWd,2);return!0}lmc(ka){this.Z2h();this.tEb=ka;this.Y8k()}Y8k(){this.Z8k(this.yKa(this.tEb),this.yKa(this.gIb))}bsb(ka){this.Tsl();this.gIb=ka;if(ka=this.yKa(this.gIb)){const Va=this.Q6d(ka);this.Bxe(ka,Va,1)}}yKa(ka){if(!ka)return null;let Va=null;if(ka=this.yi.W2(ka))if(ka=ka.Qf?this.yi.KF(ka.Qf):ka)Va=ka.objectId;return Va&&this.kyd.has(Va)?this.kyd.get(Va).firstChild:
null}Z2h(){this.Vsl(this.yKa(this.tEb),this.yKa(this.gIb))}Vsl(ka,Va){if(ka){const yb=this.Q6d(ka);this.Bxe(ka,yb,ka===Va?1:3);this.tEb=null}}Z8k(ka,Va){ka&&(ka.title=0<this.nAc.scg&&1<this.nAc.eAb?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.nAc.scg,this.nAc.eAb):CommonUIStrings.l_CommentHintTooltip,Va!==ka&&(Va=this.Q6d(ka),this.Bxe(ka,Va,2)))}Tsl(){const ka=this.yKa(this.tEb),Va=this.yKa(this.gIb);if(Va){const yb=this.Q6d(Va);this.Bxe(Va,yb,ka===
Va?2:3);this.gIb=null}}Bxe(ka,Va,yb){this.Imn()?this.RWo(ka,yb):this.OYo(ka,Va,yb)}RWo(ka,Va){ka=null===ka||void 0===ka?void 0:ka.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===ka||void 0===ka?void 0:ka.length)&&(ka[0].style.fill=2===Va||1===Va?"Highlight":"ButtonText")}OYo(ka,Va,yb){Va=zc[Va];for(let oc=0;oc<Va.length;oc++){var Yb=Va[oc];const Vc=je(Yb,yb);if(!this.fjn(Vc)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${Vc}.`);break}Yb=null===ka||void 0===
ka?void 0:ka.querySelectorAll("."+Yb);0<(null===Yb||void 0===Yb?void 0:Yb.length)&&(Yb[0].style.fill=`var(${Vc})`)}}Imn(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}Q6d(ka){return Rg.a.Eb(ka,$f.j5h)}fjn(ka){var Va;const yb=document.getElementById(rl.a.PZc);return!(null===(Va=null===yb||void 0===yb?void 0:yb.style)||void 0===Va||!Va.getPropertyValue(ka))}}$f.Z4h="clip16x16 HintContainer";$f.i9n="OutlineElementHintMargin";$f.j5h="CommentIconType";
Object(f.a)($f,"CommentHintActor",Dh.a,[748]);var dg=d(983);class Wg extends dg.a{get QCg(){return this.i3()}get Uyf(){return this.hMp.hHi()}constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd,Qe,Cf){super();this.Sg=ka;this.Bu=Va;this.vj=yb;this.$i=Yb;this.GQd=oc;this.jI=Vc;this.Mh=yd;this.getSelectedText=Jd;this.hMp=Pd;this.focusManager=Qe;this.i7a=Cf;this.Wed=()=>{};this.Gme=()=>{};this.x9g=!1;this.Nol={[0]:()=>this.lei(),[1]:()=>this.uyc.Kjf(),[2]:()=>this.lei()};this.Xhg=()=>{this.GQd.wNa(11)};this.Kkf=Wf=>
{for(const gg of ie.u)Wf.bindAction(ue.KeyInputManager.Hx(gg),Lb.a.Mmf)};this.One=()=>{this.Gme()};this.Nne=(Wf,gg)=>{if(Wf.name!==Kf.AFrame.zt&&gg){var Jg=this.vj.ou?this.vj.ou.id:"";this.Sg.HWb||(this.Sg.HWb=Xf.a.q6(this.$i,()=>{this.Wed(Jg)}))}};this.zoj=()=>{};this.Lvb=()=>{this.vUj()};this.Hdg=(Wf,gg)=>{0===gg&&(this.jI.Xse(),this.GQd.wNa(0))};this.$eg=()=>{this.GQd.wNa(5)};this.c4c=Wf=>{let gg=0;const Jg=this.vj.GR();for(let Lh=0;Lh<Jg.length;Lh++){if(Jg[Lh].Qf||Jg[Lh].done)continue;if((Jg[Lh].Gr===
Ye.a.kE?Jg[Lh].MA.draftId:Jg[Lh].id)===Wf.contentId)break;const Qj=this.qy.getContentAnchorPosition(Jg[Lh].id);!Qj||4<Math.abs(Wf.anchorTop-Qj.anchorTop)||gg++}return gg};this.sjj=()=>{this.jI.Xse()};this.Ugg=()=>{this.GQd.wNa(2)};this.vUj=()=>{if(!this.x9g&&this.Mh.kia){const Wf=this.Mh.kia.getElementsByClassName($f.Z4h);for(let gg=0;gg<Wf.length;gg++)Wf[gg].style.opacity="1";this.x9g=!0}}}initialize(ka,Va){this.qy=ka;this.uyc=Va;this.ikd();this.Bu.ribbonCommentFilteringEnabled&&this.wxo();this.yxo()}oWo(ka,
Va){this.Gme=ka;this.Wed=Va}Svi(ka,Va){return{j6a:this.dom(ka,Va),containerContentByType:{}}}Gvi(ka,Va){const yb=ah.kxi(this.vj.GR(),this.vj.ota),Yb=[],oc=ie.e(!0);var Vc=this.vj.GR();Va=this.yjo(Va,Vc,yb);!Va.ymg&&Va.contentAnchorPosition&&(Yb.push(Va.contentAnchorPosition),Va.contentAnchorPosition=null);for(Vc=0;Vc<oc.length;Vc++){const yd=oc[Vc],Jd=ie.g(yd);if(Jd)for(let Pd=0;Pd<Jd.length;Pd++){const Qe=this.getContentAnchorPosition(ka,yb,yd,Jd[Pd]);Qe&&(Yb.push(Qe),Va.ymg&&Va.contentAnchorPosition&&
Qe.contentId===Va.ymg.id&&(Yb.push(Va.contentAnchorPosition),Va.contentAnchorPosition=null))}}Va.contentAnchorPosition&&Yb.splice(0,0,Va.contentAnchorPosition);return{$xl:yb,contentAnchorPositions:Yb}}e1f(){var ka;return!(null===(ka=this.qy)||void 0===ka||!ka.getAreContainersEnabled())}i3(){return this.vj.Usa()}iCg(){return this.i3()}rpd(){return this.i3()}WCg(){return this.qy&&this.Mh.kia&&this.i3()}Knp(){this.jI.f4("OnFloatingCommentsVisibilityChange",this.Sg.lOa);if(this.Sg.lOa)this.Mh.$0b();else{const ka=
this.vj.yL;ka.lB&&ka.clearSelection();this.Mh.uae()}}ooj(ka){0!==ka&&this.Wed(this.vj.ou?this.vj.ou.id:"")}getContentAnchorPosition(ka,Va,yb,Yb){let oc=null;return({value:oc}=Va.Ec(Yb.toString(),oc)).returnValue?(Va=oc[0])&&!Va.Qf?{...(new Bf.a),anchorTop:(Fg.a.b3c(yb)-ka)/this.Mh.Yea,anchorLeft:0,containerContentType:0,contentId:Va.id}:null:null}yjo(ka,Va,yb){var Yb,oc;const Vc={};"CREATE"===(null===(oc=null===(Yb=this.vj.ez)||void 0===Yb?void 0:Yb.MA)||void 0===oc?void 0:oc.sessionType)&&(Yb=this.Mh.kia.querySelectorAll(ie.b),
ka=this.Mh.lti((0<Yb.length?Yb[0]:null)||this.getSelectedText(),this.vj.ez.MA.draftId,0,ka),Vc.ymg=this.hGm(Va,yb),Vc.contentAnchorPosition=ka);return Vc}hGm(ka,Va){var yb=Array.indexOf(ka,this.vj.ez);for(--yb;-1<yb;yb--)if(Va.mb(ka[yb].objectId))return ka[yb]}dom(ka,Va){return this.Gvi(ka,Va).contentAnchorPositions}ikd(){this.jI.h4("OnAfterTrackChangeMarkupViewChange",(ka,Va)=>{if(Va)this.Nol[Va.rk]()})}yxo(){this.jI.h4("OnFloatingCommentsToggle",this.Knp.bind(this))}lei(){const ka=ie.i();if(0!==
ka.length){var Va=ah.kxi(this.vj.GR()),yb=this.vj.yL;for(let Yb=0;Yb<ka.length;Yb++){const oc=ie.g(ka[Yb]);for(let Vc=0;Vc<oc.length;Vc++){let yd;({value:yd}=Va.Ec(oc[Vc].toString(),yd)).returnValue&&(yd.forEach(Jd=>{var Pd;Jd&&!Jd.Qf&&(this.uyc.uJa(Jd.id,0,!1),(null===(Pd=yb.lB)||void 0===Pd?void 0:Pd.id)===Jd.id&&yb.clearSelection())}),this.focusManager.Eg(Kf.AFrame.Jo))}}}}wxo(){this.jI.h4("OnContentFilterUpdate",this.y_n.bind(this))}y_n(){var ka;let Va=[],yb=new Set;const Yb=null===(ka=this.i7a)||
void 0===ka?void 0:ka.getAllContent().filter(oc=>{if(null===oc||void 0===oc?0:oc.contentId){const Vc=oc.contentId;if(yb.has(Vc))return!1;if(!this.C6m(oc))return Va.push(oc),!1;yb.add(Vc);return!0}return!1});this.Mh.N8l(Yb,Va)}C6m(ka){var Va,yb;const Yb=this.Sg.filter;return ka.contentId&&(null===(yb=(Va=this.i7a).isDraftContent)||void 0===yb?0:yb.call(Va,ka.contentId))?!0:Yb.mentionsToCurrentUser&&!this.i7a.isCurrentUserMentioned(ka)?!1:!0}}Object(f.a)(Wg,"CommentFloatingContainerActor",dg.a,[752]);
var Ji=d(1366),Gl=d(2106),ma=d(198);class db extends Ji.a{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd){super();this.sEk=ka;this.vhb=Va;this.ENe=yb;this.oj=oc;this.kda=Jd;this.s1=Pd;this.Hj=null;this.rk=1;Yb.execute(Qe=>{this.Hj=Qe});this.I5=[];this.mFc=new ma.ScriptSharpLegacyMap;this.ivo(Vc,yd);this.ikd()}get Gj(){return this.sEk.value}get hxl(){return this.vhb}get Mfa(){return!!this.Hj}get csb(){return 0}get z$a(){return this.I5}get rlh(){return this.mFc.mb(this.rk)?this.mFc.K(this.rk):this.mFc.K(0)}NXa(ka){return this.kda.NXa(ka)}S9a(ka,
Va){if(ka=Object(W.a)(749,ka))for(const yb of this.Qjo(ka))Va.add(yb)}RMa(ka,Va){this.Mfa&&this.oj.ee(()=>{this.M2n(ka,Va)},"CHA:OPHC")}M2n(ka,Va){if(this.Hj.Np.Usa()){var yb=this.As.iJa,Yb=new ic.a(new ee.a),oc=Va.pNa("*"),Vc=this.Hnm(yb),yd=!!yb&&!yb.action||!!Vc&&Vc===this.Hj.lB,Jd;this.oj.ee(()=>{this.ENe.ZDm(ka.id,Yb,null===Vc||void 0===Vc?void 0:Vc.objectId)},"OPHC:GOI");this.oj.ee(()=>{Jd=this.rlh.QXh(oc,Vc,Yb,yd);Jd.pWi=this.nWi(yb)&&0===yb.action},"OPHC:BHI");this.oj.ee(()=>{this.rlh.hTh(oc,
Jd,yd)},"OPHC:AH")}}Hnm(ka){let Va=null;!this.nWi(ka)||0!==ka.action&&2!==ka.action||(Va=this.As.iJa.fC);return Va||this.Hj.lB}Qjo(ka){if(!ka)return[];ka=this.Gj.Eb(qb.a.Af(ka.objectId));return this.hxl.c8d(ka,null)}dCj(){return!1}GH(ka,Va,yb){this.Mfa&&(ka=Object.assign(new Gl.a,{action:ka,type:0,fC:Va,jM:yb}),this.As.GH(ka))}bpf(){this.Mfa&&(this.GH(3,this.Hj.xmc,this.Hj.xmc),this.Hj.xmc=null)}ivo(ka,Va){this.mFc.add(1,ka);this.mFc.add(0,Va)}ikd(){this.s1.h4("OnBeforeTrackChangeMarkupViewChange",
(ka,Va)=>{Va&&Va.$bg!==this.rk&&(this.rk=Va.$bg)})}nWi(ka){return ka&&0===ka.type}}Object(f.a)(db,"CommentHighlightActor",Ji.a,[751,571]);var Ob=d(1013),Qb=d(329),sc=d(515),Oc=d(1410);class vc{constructor(ka,Va){this.Nxl=ka;this.Bdg=Va}}Object(f.a)(vc,"CommentEndParaIdBeforeChangeInfo",null,[]);var ub=d(1564);class ae{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd){this.U3f=ka;this.Sg=Va;this.vj=yb;this.jI=Yb;this.Vq=oc;this.hl=Vc;this.lxl=yd;this.Bu=Jd;this.pCb=null;this.Ejo=()=>{if(!this.vj.Usa()){var Pd=
ie.l();[bg.a.rqf].forEach(Qe=>{this.vtl(Pd,Qe)})}};this.zjo=(Pd,Qe)=>{(Pd=Qe.lL)&&!ie.t(Pd)&&(Qe=this.vj.hIf(Pd),qb.a.xt(Qe.uqd,Qe.z_c)||this.u7j(Qe,Pd)||this.G1h(Qe.IIa,Qe.qUa,Pd)||this.CMg(Pd))};this.AXn=(Pd,Qe)=>{Qe.property===Sa.a.vAa&&(Pd=ie.h(Qe.node,qb.a.nil),this.pCb=new vc(Qe.node.id,Pd))};this.MYn=(Pd,Qe)=>{Pd=Qe.node;if(Qe.property===Sa.a.vAa&&Pd){var Cf=ie.k(Pd,qb.a.nil);Qe=ie.h(Pd,qb.a.nil);var Wf=this.pCb?this.ud.Eb(this.pCb.Bdg):null;!ie.t(Pd)&&Cf&&!Cf.equals(Qe)&&this.pCb&&Pd.id.equals(this.pCb.Nxl)&&
!Cf.equals(this.pCb.Bdg)&&Wf&&Wf.isConnected&&this.eff(this.pCb.Bdg,Pd.id);Qe&&this.Sg.pz.mb(Qe)&&(Cf=this.Sg.pz.K(Qe),Cf.s$a&&(a.ULS.shipAssertTag(572835481,327,!!Cf.IP,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),Cf.IP&&Cf.IP.contains(Pd.id)&&(Cf.IP.remove(Pd.id),Cf.IP.count||(Cf.s$a=!1),this.Sg.aY.mb(Pd.id)?this.Sg.aY.K(Pd.id).remove(Qe):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.Cfd=(Pd,Qe)=>{Pd=
Qe.node.id;this.Sg.pz.mb(Pd)&&this.FBo(Pd)};this.kXn=(Pd,Qe)=>{Qe&&Qe.node&&this.L1a.mb(Qe.node)&&(Pd=this.L1a.K(Qe.node).Uoe,this.L1a.mb(Pd)||(Pd=this.L1a.K(Qe.node),this.G1h(Pd.qvf?Pd.currentNode:Pd.Uoe,Pd.qvf?Pd.Uoe:Pd.currentNode,Pd.lL)||this.CMg(Pd.lL)),this.L1a.remove(Qe.node))};this.PYn=(Pd,Qe)=>{const Cf=Pd.pk;if(!Qe&&this.Gkb.mb(Cf)){var Wf;(Wf=this.Gkb).W(Cf,Wf.K(Cf)&(Pd.Uc?-2:-3));this.Gkb.K(Cf)||(this.CMg(this.ud.Eb(Cf)),this.Gkb.remove(Cf))}};this.L1a=new sc.a(new Ob.a);this.Gkb=new oi.a(ie.c);
this.jI.h4("OnCommentNodeAdded",this.zjo);this.jI.h4("OnCommentNodeDeleted",this.Ejo);this.Bu.contentFilterApiEnabled?(this.jI.h4("OnCommentPaneOpen",this.Fen.bind(this)),this.jI.h4("OnCommentPaneClose",this.Een.bind(this)),this.jI.h4("OnContentFilterUpdate",this.kfd.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Pd=>{this.jI.h4(Pd,this.Cen.bind(this))});this.jI.h4("OnFloatingCommentsVisibilityChange",this.Den.bind(this));ka=this.Vq.jf(12);ka.ly(this.Cfd);ka.wt(this.kXn);this.Vq.jf(40).USc(this.AXn);
this.Vq.jf(40).ro(this.MYn);Qb.a.UZa(this.PYn)}get tv(){return this.U3f.value}get ud(){return this.tv.ud}ZDm(ka,Va,yb){if(this.tao(ka))for(const Yb of this.Sg.pz.K(ka).IP)!this.BSj(Yb,yb===Yb.toString())||Va.add(Yb)}BSj(ka,Va){const yb=this.ud.Eb(ka),Yb=ie.t(yb);if(!yb||Yb)return!1;ka=this.vj.W2(ka.toString());return!ka||this.Bu.contentFilterApiEnabled&&this.Sg.jn&&!this.lxl.isContentInFilteredContent(ka.id)||!this.Sg.jn&&!this.vj.ota(ka)&&!Va?!1:!0}tao(ka){return this.X$n(ka)}vtl(ka,Va){ka=ka.querySelectorAll(`.${Va}`);
if(0!==ka.length)for(let yb=0;yb<ka.length;yb++)ka[yb].classList.remove(Va)}CMg(ka){if(ka){var Va=Oc.a.c8d(ka,null),yb=new Ub.a;for(let Yb=1;Yb<Va.length-1;Yb++)this.eff(Va[Yb].id,ka.id),yb.add(Va[Yb]);Qg.b(yb)}}Den(){const ka=new Ub.a;for(const Va of this.vj.GR())!Va.Qf&&Va.Gr!==Ye.a.kE&&this.vj.ota(Va)&&this.vj.nFe(Va,ka);Qg.b(ka)}X$n(ka){if(!this.Sg.m0)return!1;let Va=null;if(({value:Va}=this.Sg.pz.Ec(ka,Va)).returnValue)return Va.s$a;let yb=!1;this.hl.ee(()=>{const Yb=ie.e();for(let oc=0;oc<Yb.length;oc++)yb=
this.$Ap(Yb[oc],ka,yb);yb||(this.Sg.pz.add(ka,new ub.a),this.Sg.pz.K(ka).s$a=!1)},"CHORA:PHOC");return yb}$Ap(ka,Va,yb){ka=ie.g(ka);if(!ka)return yb;for(let Yb=0;Yb<ka.length;Yb++){const oc=this.ud.Eb(ka[Yb]);oc&&!ie.t(oc)&&(yb=yb||this.ppl(oc,Va))}return yb}ppl(ka,Va){var yb=this.vj.hIf(ka);if(this.u7j(yb,ka))return!1;var Yb=yb.uqd;const oc=yb.z_c;yb=yb.IIa;if(Yb!==qb.a.nil&&(Yb.equals(oc)||Yb.equals(Va)))return!1;for(Yb=ab.ParagraphReader.mg(yb,!1);Yb&&!Yb.id.equals(oc);){if(Yb.id.equals(Va))return this.eff(Va,
ka.id),!0;Yb=ab.ParagraphReader.mg(Yb,!1)}return!1}eff(ka,Va){this.Sg.aY.mb(Va)||this.Sg.aY.add(Va,new ic.a(new ee.a));this.Sg.aY.K(Va).add(ka);this.Sg.pz.mb(ka)?this.Sg.pz.K(ka).IP||(this.Sg.pz.K(ka).IP=new ic.a(new ee.a)):this.Sg.pz.add(ka,new ub.a(!0));this.Sg.pz.K(ka).s$a=!0;this.Sg.pz.K(ka).IP.add(Va)}FBo(ka){if(this.Sg.pz.K(ka).IP)for(const Va of this.Sg.pz.K(ka).IP)this.Sg.aY.mb(Va)?this.Sg.aY.K(Va).remove(ka):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");
this.Sg.pz.remove(ka)}Cen(){const ka=new Ub.a;for(const Va of this.vj.GR())Va.Qf||Va.Gr===Ye.a.kE||this.vj.ota(Va)||this.vj.nFe(Va,ka);Qg.b(ka)}Fen(){this.cXf("OnCommentPaneOpen")}kfd(){this.cXf("OnContentFilterUpdate")}Een(){this.cXf("OnCommentPaneClose")}cXf(ka){const Va=new Ub.a;for(const yb of this.vj.GR())yb.Qf||yb.Gr===Ye.a.kE||this.vj.yL.r_h(ka,yb)||this.vj.nFe(yb,Va);Qg.b(Va)}u7j(ka,Va){let yb=!1;if(!ka.RAe||!ka.d1d){yb=!0;if(!ka.IIa||!ka.qUa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",
!ka.IIa,!ka.qUa),!0;ka.RAe||this.L1a.mb(ka.IIa)||this.L1a.add(ka.IIa,{lL:Va,currentNode:ka.IIa,Uoe:ka.qUa,qvf:!0});ka.d1d||this.L1a.mb(ka.qUa)||this.L1a.add(ka.qUa,{lL:Va,currentNode:ka.qUa,Uoe:ka.IIa,qvf:!1})}return yb}G1h(ka,Va,yb){ka=Oc.a.OAa(ka,yb.id,!0);Va=Oc.a.OAa(Va,yb.id,!1);let Yb;ka||({value:Yb}=this.Gkb.Ec(yb.id,Yb),this.Gkb.W(yb.id,Yb&1));Va||({value:Yb}=this.Gkb.Ec(yb.id,Yb),this.Gkb.W(yb.id,Yb&2));return!ka||!Va}}Object(f.a)(ae,"CommentHighlightOnRestActor",null,[750]);var Ve=d(547),
ve=d(443),ef=d(537);class We{constructor(ka,Va){this.FJb=ka;this.jpa=Va}getViewContainer(){return this.FJb}registerForViewContainerEvents(ka){this.jpa.Wyo(ka)}unregisterForViewContainerEvents(ka){this.jpa.Ivp(ka)}}Object(f.a)(We,"ViewContainerProvider",null,[1754]);class sg{constructor(ka,Va,yb,Yb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ka;this.appLocale=Va;this.uiCulture=yb;this.dataCulture=Yb}}Object(f.a)(sg,"LocalizationDetails",null,[]);var ke=
d(1104),Ue=d(1431),Eh=d(488);class xi{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd,Qe,Cf,Wf,gg,Jg,Lh,Qj,Uk,gj,Vj,om,Hj,pn,ki,Wq,gp,wm,si,sl,tl,Gm,go){this.Fr=ka;this.vj=Va;this.hMb=yb;this.A2=Yb;this.Bu=oc;this.Sg=Vc;this.J3d=yd;this.mmc=Jd;this.Sp=Pd;this.Qb=Qe;this.dynamicScriptLoader=Cf;this.dLo=Wf;this.focusManager=gg;this.Dqf=Jg;this.zqf=Lh;this.nMh=Qj;this.fHp=Uk;this.BY=gj;this.jI=Vj;this.PMo=om;this.g6l=Hj;this.Rij=pn;this.gHp=ki;this.iMb=Wq;this.VW=gp;this.Mh=wm;this.zS=si;this.Wrf=sl;this.Gcb=
tl;this.TWd=Gm;this.rBl=go;this.TDd=this.j4a=null;this.Omh=!1;this.u2e=[];this.SCh=this.Pmh=!1;this.initialize=(vi,hp)=>{this.H8m(hp)};this.sOl=vi=>Lc.a.PXd(vi);this.QYn=()=>{this.XRi()};this.kum=(vi,hp,Sp)=>{vi={...(new ke.a),containerPanel:vi,paneOpenedCallback:hp,paneClosedCallback:Sp,ulsLogger:new Ve.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,viewportInfo:this.Mh.XIf(),destroyAllContainersCallback:()=>{this.Sg.jn||a.ULS.sendTraceTag(571342851,
327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.Bu.K3d,synchronousContainerPositioningEnabled:!1,trackChangeInSidetrackEnabled:this.Bu.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.Bu.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.Bu.contentNavigationApiEnabled,contentFilterApiEnabled:this.Bu.contentFilterApiEnabled,
returnToDraftFixEnabled:!0,ribbonCommentFilteringEnabled:this.Bu.ribbonCommentFilteringEnabled}};this.Bu.contentNavigationApiEnabled&&(vi.sidetrackContentNavigationApi=this.Wrf,vi.featureGateApiSettings=this.VW.Uyf,vi.telemetryDetails=this.Rij,this.Bu.contentFilterApiEnabled&&(vi.contentFilterAPI=this.rBl));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(vi)};this.F_n=vi=>{2!==this.Fr.mode&&3!==this.Fr.mode&&this.vj.ou&&vi===this.vj.ou.id&&this.Fr.clearSelection();ng.StaticActiveAppFrame.za().Fe(!0)};
this.okj=(vi,hp)=>{this.Ty("onCSCStart",window.performance.now());this.jmb&&!vi&&(this.D7n(),this.Ty("openInFishbowl",!0));this.hMb.nmb&&this.Bu.BNb&&this.Qb.Ob(wi.a.xMa,2);hp&&hp();this.Ty("onCSCEnd",window.performance.now())};this.jI.h4("OnCommentInit",this.initialize);this.jI.h4("OnCommentRenderedOnce",this.QYn);this.VW.oWo(()=>{},this.F_n);Eh.a.e6c&&(this.Sg.lOa=!1)}get MQa(){return this.Fr}get jmb(){return this.Sg.jmb}Ty(ka,Va){this.Gcb.Ty(Bk.a.comments,ka,Va,!0)}H8m(ka){if(this.Sg.m0)ka&&ka.FMa&&
ka.FMa();else if(this.Omh)(null===ka||void 0===ka?0:ka.FMa)&&this.u2e.push(ka.FMa);else{var Va=this.Bu.Ulc;this.Ty("hasCommentOnBoot",Va);Va?(this.iMb.logKpiUsage(Ue.a.fMb,0),y.AFrameworkApplication.tga("3f3e3317;d8ebf581")):ve.a.dVn();this.Omh=!0;this.Ty("initInProgress",!0);this.vj.initialize(this.Fr);this.hMb.initialize(this.Fr,null);this.hMb.KRj(this.Fr);this.mmc.F9m(this.A2.a0o);this.Ty("InitAMSetup",window.performance.now());ef.a.iq(this.g6l).continueWith(yb=>{(this.j4a=yb.result)||a.ULS.sendTraceTag(574734881,
327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.Dqf.initialize(this.j4a);this.MQa.pqf.initialize(this.MQa,this.vj,this.j4a,this.Dqf);this.nMh.initialize(this.dynamicScriptLoader,this.MQa.pqf,this.Rij,this.j4a,new We(this.fHp,this.gHp),this.KBi(),"",this.Dqf.hHi(),this.BY,tb.a.Jye);this.Ty("AMInitialized",window.performance.now());this.Bu.contentNavigationApiEnabled?(tb.a.ZOb?tb.a.ZOb:this.Mh.O7i()).then(()=>{this.Ty("FCMLoaded",window.performance.now());this.Qod();this.ice(ka)}):
this.ice(ka)})}}rgo(){var ka;null===(ka=sharedComments.setDarkModeColorHandler)||void 0===ka?void 0:ka.call(sharedComments,this.sOl)}ice(ka){this.TDd=this.nMh.ice(void 0,this.rgo.bind(this));this.O7c(ka);this.Sg.m0=!0;this.Bu.yEg&&this.zqf.initialize()}O7c(ka){if(!this.Sg.hSb){this.Ty("InitCSStart",window.performance.now());var Va=this.Sp.Xf("Task","InitiateCommentingSession");this.iMb.logKpiUsage(Ue.a.k5h,0);try{const yb=this.Sp.Xf("Task","InitiateCommentingSession-UpdateModel");this.TWd.$8m();yb.stop();
this.Ty("initAtBoot",window.performance.now());this.Bu.Kr&&this.vj.Usa()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",ja.a.Le()));jk.a.get_instance().vK(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.Sg.hSb=!0;this.TDd.then(()=>{this.Ty("SCLoaded",window.performance.now());this.Mh.v9m();this.Ty("FCMInitiated",window.performance.now());if(this.Bu.Kr){let oc=!1;if(this.jmb){var Yb=this.A2.D5d(this.jmb);Yb?
(y.AFrameworkApplication.nd("3ge3g205;cha3g788"),Yb=this.A2.E5d(Yb,0),Yb)?this.vj.ota(Yb)||(oc=!0,this.E7n(Yb)):(oc=!0,this.fcb()):oc=!0}Yb=ka?ka.hlj:null;this.Bu.contentNavigationApiEnabled?this.okj(oc,Yb):this.WCn(oc,Yb)}ka&&ka.FMa&&ka.FMa();for(const oc of this.u2e)oc();this.Pmh&&this.XRi();this.u2e=[]})}catch(yb){a.ULS.jA(539567713,327,10,yb,`Comments Initialization Failed: ${yb}`),this.iMb.logKpiFailure(Ue.a.k5h,"CommentsInitializationFailed",{isInternal:!0},{name:Ue.a.eMb,isInternal:!0})}finally{Va.stop(),
this.Ty("InitCSEnd",window.performance.now())}this.Qb.Ob(wi.a.O4h,2)}}E7n(ka){this.Qb.Ob(wi.a.V0,2);this.VW.vUj();Xf.a.q6(y.AFrameworkApplication.oc,()=>{this.A2.selectComment(ka,{...(new gm.a),v4:!0,wca:1});this.focusManager.Eg(Kf.AFrame.zt);a.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.UT)},af.a.RPo);this.iMb.$w(wi.a.tqf)}fcb(){this.Qb.Ob(wi.a.fcb,2)}WCn(ka,Va){(tb.a.ZOb?tb.a.ZOb:this.Mh.O7i()).then(()=>
{this.Ty("FCMLoaded",window.performance.now());this.Qod();this.okj(ka,Va)}).catch(yb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+yb.toString())})}Qod(){this.zS.trackChangeInSidetrackEnabled?(this.J3d.Qod(),this.Ty("STSet",window.performance.now())):this.J3d.ORj(this.kum)}XRi(){this.SCh||(this.Sg.m0&&this.TDd?(this.TDd.then(()=>{const ka=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.PMo.execute(Va=>{ka.registerSafelinksNavigator(Va.PAc.bind(Va))});
this.dLo.execute(Va=>{Va.lvo(ka)})}),this.SCh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.Pmh=!0))}KBi(){return new sg(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}D7n(){this.A2.bLj(this.jmb,{...(new gm.a),KCg:!1,a9c:!0});this.iMb.$w(wi.a.tqf)}}Object(f.a)(xi,"CommentInitActor",null,[]);class Xd{constructor(ka,Va,yb,Yb){this.Fg=ka;this.tG=
Va;this.ga=yb;this.Wj=Yb;this.TFe=this.D2a=null}get zoom(){let ka=1;this.Wj&&this.Wj.instance&&(ka=this.Wj.instance.Cj);return 0<ka?ka:1}H7l(ka,Va){if(!this.TFe||!ka.jLa||Va>=ka.jLa.length)return null;const yb=this.zoom,Yb=ka.V3,oc=ka.J6a(1,Ed.aVf,yb,Va);return this.GGl(Yb,(this.TFe.y-ka.B7[Va].y)/yb+Ed.rdk,oc)}GGl(ka,Va,yb){if(this.D2a)return(ka=this.D2a.parentElement)&&ka.removeChild(this.D2a),this.GNj(this.D2a,Va,yb),this.D2a;const Yb=ka.Jh.ownerDocument,oc=Yb.createElement("div");oc.className=
Xd.ixl;this.GNj(oc,Va,yb);Va=Yb.createElement("span");this.pMg(Va,oc);Le(dc[4],Va);this.Awo(Va,ka);return this.D2a=oc}pMg(ka,Va){ka.title=CommonUIStrings.l_CommentNewCommentButton;ka.setAttribute("role","button");Va.appendChild(ka)}Awo(ka,Va){this.Fg.YI(nf.a.click,ka,this.k_n.bind(this),Va);this.Fg.nb(nf.a.fD,ka,this.m_n.bind(this));this.tG.nb(ka,this.l_n.bind(this))}oae(){if(this.D2a){const ka=this.D2a.parentElement;ka&&ka.removeChild(this.D2a)}}GNj(ka,Va,yb){ka.style.left=yb+Ed.aVf+"px";ka.style.top=
Va+"px";ka.style.right="auto";ka.style.display="block";ka.style.position="absolute";ka.style.overflow="hidden";ka.style.cursor="default";ka.style.zIndex="40"}m_n(){return!0}k_n(ka){this.ga.pE=30;this.ga.Ob(wi.a.xMa,2);ka=ka.Uy;Le(dc[4],ka);ka=ka.parentElement;(null===ka||void 0===ka?0:ka.parentElement)&&ka.parentElement.removeChild(ka);return!0}l_n(){return!0}}Xd.ixl="clip16x16 EntryPointContainer";Object(f.a)(Xd,"CommentMarginEntryPointActor",null,[]);var Ge=d(425),qg=d(83),Ui=d(221),Qh=d(33),zh=
d(106);class Si{constructor(ka,Va,yb,Yb,oc,Vc,yd){this.U3f=ka;this.DAn=Va;this.Np=yb;this.Sg=Yb;this.Bu=oc;this.xqf=Vc;this.iMb=yd;this.Nwj=new Set;this.dVb=new Set;this.mgd=new Ui.a;this.ofc=new Map;this.o5h=K.a.instance.rf(93);this.jMb=new Set;this.oka=this.C5d()}get tv(){return this.U3f.value}get ud(){return this.tv.ud}get LIa(){return this.DAn.value}C5d(){const ka=new $b.a;ka.set(this.tv);this.LIa.Ybb(ka);return ka}$8m(){this.Sg.hSb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",
Qh.Debug.a9a());this.Bu.contentNavigationApiEnabled||(this.Bu.Ulc&&this.Y8m(),this.Np.lmj())}SXn(){this.RHj();this.jMb.forEach(ka=>{this.KSg(ka)});this.jMb.clear();this.Np.lmj()}KSg(ka){if(Ge.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${ka}`);var Va=this.ofc.get(ka).Lyc,yb=this.ofc.get(ka).Xhc;Va===qb.a.nil||yb===qb.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${Va} or end ${yb} has invalid value`):(this.o5h.value.j7a.set(ka,Va),this.o5h.value.h7a.set(ka,
yb),a.ULS.sendTraceTag(512235651,327,50,`Start ${Va} and End ${yb} mapping info for Comment ${ka} added on Comment Model load`))}}hbn(ka){const Va=[];for(const yb of ka)ka=yb.pk.toString(),this.b7j(ka,yb.paragraph.id,yb.Uc),yb.Uc&&(this.Nwj.has(ka)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",yb.pk):(this.Nwj.add(ka),(ka=this.yWk(yb))&&Va.push(ka)));return Va}b7j(ka,Va,yb){Ge.a.isEnabled&&(this.ofc.has(ka)||this.ofc.set(ka,{Lyc:qb.a.nil,Xhc:qb.a.nil}),
yb?this.ofc.get(ka).Lyc=Va:this.ofc.get(ka).Xhc=Va)}yWk(ka){var Va=this.ud.Eb(ka.pk);this.oka.Yj(Va);if(40!==this.oka.nf||!Va)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!Va,!ka.pk),this.oka=39===this.oka.nf?this.oka:this.C5d(),null;Va=this.Np.vYd(this.oka);let yb;if(({index:yb}=this.Np.ZDe(Va)).returnValue)if(this.Np.Aef(Va,yb),this.dVb.add(Va.objectId),ie.q(Va)||this.jMb.add(Va.objectId),
Va.Qf)this.nEf(Va);else return{contentId:Va.id,containerContentType:0,gca:{xd:ka.Jb.cp,GP:ka.paragraph.Gk}};else this.mgd.add(Va);return null}nEf(ka){if(ka.Qf){var Va=this.Np.KF(ka.Qf);if(Va&&Va.Qf){const yb=this.Np.KF(Va.Qf);yb&&(yb.Qf?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(ka.Qf=Va.Qf,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${ka.objectId} parentObjectId: ${Va.objectId}`)))}}}Y8m(){const ka=new va.a(0),
Va=qg.a.Zo(this.Np.c1a),yb=new Set;this.Bu.g9n&&!Ge.a.isEnabled&&this.iZk(Va,ka);const Yb=this.C5d(),oc=new Set,Vc=new Set,yd=new em.GraphTransaction(2);try{if(yd.pu(Yb),Yb.pv(1)){for(;Va.moveNext();){if(!ab.ParagraphReader.Eh(Va.iterator))continue;const Pd=Va.iterator.currentNode,Qe=ab.ParagraphReader.IPb(Pd);Ge.a.isEnabled&&this.JLn(Pd,Qe,ka);yb.add(Pd.id.toString());this.cwj(Qe,Vc,Yb,oc)}this.RHj();const Jd=this.Inm(yb);0<Jd.length&&this.wKo(Jd,yb,Yb,Vc);this.jMb.forEach(Pd=>{this.KSg(Pd)});this.jMb.clear()}}finally{yd&&
yd.dispose()}0==this.dVb.size&&this.Bu.Ulc&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");ld.a.bHn(oc,Vc,this.ud)}cwj(ka,Va,yb,Yb){for(const oc of ka){ka=this.Bu.Kr?!oc.Uc:oc.Uc;const Vc=oc.pk.toString();this.b7j(Vc,oc.paragraph.id,oc.Uc);ka?Va.has(Vc)||Yb.add(Vc):Va.has(Vc)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",oc.pk):(Va.add(Vc),this.zWk(oc,yb))}}wKo(ka,Va,yb,Yb){const oc=this.oFm(ka);ld.a.uql(oc);
const Vc=new Set,yd=new Set;oc.forEach(Pd=>{Va.has(Pd.id.toString())||yd.has(Pd.id.toString())||(yd.add(Pd.id.toString()),Pd=ab.ParagraphReader.IPb(Pd),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Pd.length} CommentRangeObjects`),this.cwj(Pd,Yb,yb,Vc))});const Jd=[];ka.forEach(Pd=>{this.dVb.has(Pd)||Jd.push(Pd)});0<Jd.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${Jd.length} Failed To Load on Retry: ${Jd.join(",")}`),this.iMb.logKpiFailure(Ue.a.fMb,"CommentsFailedToLoadOnRetry",
{isInternal:!0},{name:Ue.a.eMb,isInternal:!0}))}oFm(ka){const Va=[];ka.forEach(yb=>{if(yb=this.xqf.Evi(yb))yb=ie.k(yb),(yb=this.ud.Eb(yb))&&yb.qk&&Va.push(yb)});return Va}zWk(ka,Va){const yb=this.ud.Eb(ka.pk);Va.Yj(yb);40===Va.nf&&yb?(ka=this.Np.vYd(Va),({index:Va}=this.Np.ZDe(ka)).returnValue?(this.Np.Aef(ka,Va),this.dVb.add(ka.objectId),ie.q(ka)||this.jMb.add(ka.objectId),ka.Qf&&this.nEf(ka)):this.mgd.add(ka)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",
!yb,!ka.pk),39===Va.nf||this.C5d())}Inm(ka){const Va=[],yb=this.xqf.Cnm();if(this.dVb.size===yb.length)return Va;yb.forEach(Yb=>{!this.dVb.has(Yb)&&ld.a.twn(Yb,ka,this.xqf,this.ud)&&Va.push(Yb)});return Va}RHj(){for(let ka=0;ka<this.mgd.length;ka++){const Va=this.mgd.K(ka);let yb;({index:yb}=this.Np.ZDe(Va)).returnValue?(this.Np.Aef(Va,yb),ie.q(Va)||this.jMb.add(Va.objectId),this.dVb.add(Va.objectId),Va.Qf&&this.nEf(Va)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",
Va.rBa,Va.k8a,Va.objectId,Va.Qf))}this.mgd.clear()}iZk(ka,Va){ka.Dp(yb=>{if(11===yb.nf){var Yb=yb.currentNode;const oc=Yb.ka(zh.a.Gqf,null),Vc=Yb.ka(zh.a.Eqf,null);yb=!!oc&&0<oc.length;const yd=!!Vc&&0<Vc.length;yb&&oc.forEach(Pd=>{const Qe=this.ud.Eb(Pd);Qe&&!ie.t(Qe)&&Va.add(Pd,0)});yd&&Vc.forEach(Pd=>{Va.mb(Pd)&&Va.remove(Pd)});(Yb=Yb.ka(xf.a.aH,null))&&Yb.forEach(Pd=>{const Qe=this.ud.Eb(Pd);ab.ParagraphReader.Vb(Qe)&&!this.Sg.pz.mb(Pd)&&this.Sg.pz.add(Pd,new ub.a)});const Jd=Va.keys;for(let Pd=
0;Pd<Jd.length;Pd++){Yb&&0<Va.K(Jd.K(Pd))&&(this.Sg.aY.mb(Jd.K(Pd))||this.Sg.aY.add(Jd.K(Pd),new ic.a(new ee.a)),Yb.forEach(Cf=>{const Wf=this.ud.Eb(Cf);ab.ParagraphReader.Vb(Wf)&&(this.Sg.pz.K(Cf).IP||(this.Sg.pz.K(Cf).IP=new ic.a(new ee.a)),this.Sg.aY.K(Jd.K(Pd)).add(Cf),this.Sg.pz.K(Cf).s$a=!0,this.Sg.pz.K(Cf).IP.add(Jd.K(Pd)))}));let Qe;Va.W(Qe=Va.keys.K(Pd),Va.K(Qe)+1)}return yb||yd}return!0},null)}JLn(ka,Va,yb){ka&&(this.dlk(Va,yb),this.Sg.pz.mb(ka.id)||this.Sg.pz.add(ka.id,new ub.a),yb.forEach((Yb,
oc)=>{0<oc&&(this.Sg.aY.mb(Yb)||this.Sg.aY.add(Yb,new ic.a(new ee.a)),this.Sg.pz.K(ka.id).IP||(this.Sg.pz.K(ka.id).IP=new ic.a(new ee.a)),this.Sg.aY.K(Yb).add(ka.id),this.Sg.pz.K(ka.id).s$a=!0,this.Sg.pz.K(ka.id).IP.add(Yb));yb.W(Yb,oc+1);return!0}))}dlk(ka,Va){ka.forEach(yb=>{if(yb.Uc){const Yb=this.ud.Eb(yb.pk);Yb&&!ie.t(Yb)&&Va.W(yb.pk,0)}else Va.mb(yb.pk)&&Va.remove(yb.pk)})}}Object(f.a)(Si,"CommentModelBootLoader",null,[747]);var Xi=d(1028);class Ql{constructor(ka){this.l5h=ka;this.WHc=null;
this.evh=void 0;this.fvh=null;this.KMc=new Map;this.VQe=new Map}Nyo(){Xi.a.UZa(this.Fxp.bind(this))}Fxp(ka,Va){const yb=ka.id.toString();var Yb=ka.getValue(Sa.a.eH).toString();Va?(this.KMc.delete(yb),this.VQe.delete(Yb)):(this.KMc.set(yb,ka),this.VQe.set(Yb,ka));0===this.KMc.size&&this.WHc&&(ka=+new Date-+this.WHc,this.WHc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${ka}`));Va||this.evh!==Yb||(Va=+new Date-
+this.fvh,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${Va}`),Yb=new ya.a,Yb.durationMs=Va,this.l5h.logKpiFailure(Ue.a.LWd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:Yb},{name:Ue.a.T4h,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Yb}));this.WHc||(this.WHc=new Date)}set LPn(ka){this.evh=ka;this.fvh=new Date;if(ka=this.Anm(ka))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${ka.id} present but failed to load`),
ka=new ya.a,this.l5h.logKpiFailure(Ue.a.LWd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:Ue.a.T4h,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ka})}Cnm(){return[...this.KMc.keys()]}Anm(ka){return this.VQe.get(ka)}Evi(ka){return this.KMc.get(ka)}}Object(f.a)(Ql,"CommentNodeTracker",null,[]);class Zk{get contentType(){return 0}constructor(ka,Va,yb,Yb,oc){this.Svg=ka;this.Np=Va;this.A2=yb;this.yL=Yb;this.Sg=oc;this.Svg.CBj(this)}fLj(ka,Va,yb){0===Va?(Va=this.Np.h9c(ka),
this.A2.selectComment(Va?this.Np.ez:this.Np.KF(ka),Object.assign(new gm.a,{v4:yb||Va,wca:1}))):this.yL.clearSelection()}hTj(ka){if(this.Sg.jn||this.Np.h9c(ka.contentId))return!0;const Va=this.Np.KF(ka.contentId);if(Va)return this.Np.ota(Va);a.ULS.sendTraceTag(508878870,327,10,`Failed to find comment for contentId: ${ka.contentId}`);return!1}}Object(f.a)(Zk,"CommentReviewSuggestionContentActor",null,[48]);class Tj{get RZj(){return this.yGg}constructor(ka,Va){this.TWd=ka;this.Bu=Va;this.yGg=new Set([12])}initialize(){}W7i(ka){if(!ab.ParagraphReader.Vb(ka.node))return[];
ka=ab.ParagraphReader.IPb(ka.node);return this.TWd.hbn(ka)}Sjj(){this.TWd.SXn()}pNi(){return this.Bu.Bbp?this.Bu.Ulc:!0}}Object(f.a)(Tj,"CommentReviewSuggestionContentProvider",null,[51]);var ji=d(453),Bd=d(87),$h=d(123),rh=d(750),il=d(1512);class Cg{constructor(){this.commentId=null;this.S$c=!1}}Object(f.a)(Cg,"CommentToSelectOnPaneLoadData",null,[]);class Yn{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd,Qe,Cf,Wf,gg,Jg,Lh,Qj){this.Fr=ka;this.Np=Va;this.KIa=yb;this.A2=Yb;this.jI=oc;this.Sg=Vc;this.J3d=yd;
this.Bu=Jd;this.hMb=Pd;this.NUb=Qe;this.Qb=Cf;this.V3f=Wf;this.focusManager=gg;this.hl=Jg;this.Kxl=Lh;this.i7a=Qj;this.jjd=(Uk,gj,Vj,om,Hj)=>{if(1===Vj||!Hj)return 32;Hj[ji.a.On]=Eh.a.e6c?this.Sg.jn:this.Sg.lOa;return 32};this.Qb.qa(wi.a.U0b,Bd.a.frame,this.Fr.U0b.bind(this.Fr));this.Qb.qa(wi.a.p0d,Bd.a.frame,this.p0d.bind(this));this.Qb.qa(wi.a.qqf,Bd.a.frame,this.IYn.bind(this));this.Qb.qa(wi.a.Vwl,Bd.a.frame,this.HYn.bind(this));this.Qb.qa(wi.a.Sgj,Bd.a.frame,this.a2n.bind(this));this.Qb.qa(wi.a.Egi,
Bd.a.frame,this.RZn.bind(this));this.Qb.qa(wi.a.$4h,Bd.a.frame,this.p0n.bind(this));this.Qb.fb(wi.a.uqf,Bd.a.frame,this.J8k.bind(this),64);this.Qb.fb(wi.a.SWd,Bd.a.frame,this.lAo.bind(this),64);this.Qb.qa(Lb.a.selectComment,Bd.a.frame,this.A2.OPo.bind(this.A2));this.Bu.oBn&&this.Qb.qa(Lb.a.Bhe,Bd.a.frame,this.Bhe.bind(this));this.hNh(Lb.a.UYc,!1);this.hNh(Lb.a.xwf,!0);this.Qb.fb(Lb.a.UWd,Bd.a.frame,this.UWd.bind(this),64);this.Qb.qa(Lb.a.jJg,Bd.a.frame,this.m6n.bind(this));this.Qb.fb(Lb.a.jjd,Bd.a.frame,
this.jjd.bind(this),96);this.Qb.qa(Lb.a.A$i,Bd.a.frame,$h.ActionManager.$f);this.Qb.qa(Lb.a.Mmf,Bd.a.frame,this.Ajl.bind(this));this.Qb.qa(Lb.a.kei,Bd.a.frame,(Uk,gj)=>rh.a.dma(gj.Ok)&&rh.a.loc()?8:32);this.Bu.ribbonCommentFilteringEnabled&&(this.Qb.qa(Lb.a.W2d,Bd.a.frame,this.W2d.bind(this)),this.Qb.qa(Lb.a.X2d,Bd.a.frame,this.X2d.bind(this)),this.Qb.qa(Lb.a.Y2d,Bd.a.frame,this.Y2d.bind(this)),this.Qb.qa(Lb.a.Xue,Bd.a.frame,this.Xue.bind(this)))}get vj(){return this.Np}get mode(){return this.Fr.mode}get lB(){return this.Fr.lB}get uE(){return this.Bu.Kr}get Gj(){return this.NUb.value}get lb(){return this.V3f.value}get yL(){return this.Fr}p0d(ka,
Va,yb,Yb,oc){return oc?oc?(ka=this.A2.D5d(oc.NavigationId))&&this.A2.E5d(ka,1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}IYn(ka,Va,yb,Yb,oc){oc&&this.jI.f4("OnCommentInit",{...(new il.a),FMa:()=>{var Vc=this.A2.D5d(oc.NavigationId);if(Vc){var yd=this.A2.E5d(Vc,1);yd?this.hMb.isVisible?(this.Ymd(yd,1),this.focusManager.aF(Kf.AFrame.zt)):this.vj.ota(yd)?(Vc=ie.s(yd),
this.A2.selectComment(yd,{...(new gm.a),v4:!Vc,wca:1}),this.focusManager.aF(Kf.AFrame.zR)):(this.Sg.jn||this.Qb.Ob(wi.a.V0,2),Xf.a.q6(y.AFrameworkApplication.oc,()=>{this.Ymd(yd,1)},af.a.Ymd)):this.Qb.Ob(wi.a.fcb,2)}}});return 32}HYn(ka,Va,yb,Yb,oc){oc?(ka=this.vj.E2c(oc))?this.yL.Esc(ka.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.yL.Esc(null);return 32}a2n(ka,Va,yb,Yb,oc){if(oc){if(this.Sg.hSb){for(ka=0;ka<oc.length;ka++)this.vj.BNj(oc[ka]);
this.Fr.rZb()}else this.vj.k0k(oc);this.jHn(oc)}return 32}RZn(ka,Va,yb,Yb,oc){if(oc)if(this.Sg.hSb){for(ka=0;ka<oc.length;ka++)this.vj.BNj(oc[ka],!0);this.Fr.rZb()}else this.vj.etl();return 32}p0n(ka,Va,yb,Yb,oc){this.uE||this.Sg.jn||this.Qb.Ob(wi.a.V0,2);if(oc){ka=null;if(!this.lB||2!==this.mode&&3!==this.mode){if(!oc)return 8;if(this.uE)ka=this.v9l(oc);else for(Va=0;Va<oc.length&&(ka=this.vj.W2(oc[Va].toString()),this.J3d.$de&&(!ka||ka.done));Va++);}else ka=this.lB;this.Ymd(ka,1);ka&&this.Sg.m0&&
this.focusManager.Eg(this.uE&&!this.Sg.jn?Kf.AFrame.zR:Kf.AFrame.zt)}else a.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}J8k(ka,Va,yb,Yb,oc){var Vc;if(!oc)return 32;if(oc&&0<oc.length){Va=ka=yb=0;Yb=!1;for(let yd=0;yd<oc.length;yd++)oc[yd].toString()===(null===(Vc=this.lB)||void 0===Vc?void 0:Vc.objectId)?(Yb=!0,ka++):this.Np.d0f(oc[yd])&&(Yb&&0===yb&&(yb=yd,Va=ka),ka++);(Vc=this.Np.W2(oc[yb].toString()))?(this.KIa.nAc.scg=Va+1,this.KIa.nAc.eAb=
ka,this.yL.Esc(Vc.id)):(oc=oc[yb],this.Gj.Eb(oc)?a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${oc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",oc.toString()))}return 32}lAo(){this.yL.Esc(null);return 32}hNh(ka,Va){this.Qb.qa(ka,Bd.a.frame,(yb,Yb,oc)=>this.vZn(oc,Va))}m6n(ka,Va,yb){var Yb;if(1===yb)return this.Np.ez?8:32;if(2===yb){if(Eh.a.e6c||this.Sg.jn)return this.Qb.Ob(wi.a.V0,
2),this.Sg.lOa=this.Sg.jn,32;if(!this.Np.Y5c())return 32;this.Sg.lOa=!this.Sg.lOa;this.jI.f4("OnFloatingCommentsToggle");null===(Yb=ng.StaticActiveAppFrame.za())||void 0===Yb?void 0:Yb.Fe(!0)}return 32}Bhe(ka,Va,yb){2===yb&&(ka=this.vj.fp.Lc(7),ka.Ab(this.vj.c1a),Va=new ek.a,Va.Vla(`${String.fromCodePoint(128077)} \n`),this.Np.Xfc(Yk.a.instance.gb.currentSelection,void 0,Va),this.Kxl.oae(),ka.dispose());return 32}vZn(ka,Va=!1){if(2===ka)ka=this.vj.fp.Lc(15),ka.Ab(this.vj.c1a),this.hl.ee(()=>{this.UYc(Va)},
"ECM:DAC"),ka.dispose();else if(1===ka&&(!this.vj.Usa()||this.Bu.TQl&&Va&&!this.vj.Y_m()))return 2;return 32}UYc(ka=!1){this.Fr.mode=1;const Va=this.vj.GR();for(const yb of Va)yb.Gr===Ye.a.kE||ka&&!yb.done||yb.Qf||this.Fr.deleteComment(yb);this.focusManager.Eg(Kf.AFrame.Jo);0<(ka?this.vj.GR().filter(yb=>yb.done):this.vj.GR()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",ka):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",
ka)}UWd(ka,Va,yb){if(2===yb)if(ka=this.focusManager.currentScope.name,ka!==Kf.AFrame.zt&&ka!==Kf.AFrame.zR){!this.uE||this.Sg.jn?(this.Sg.jn||this.Qb.Ob(wi.a.V0,2),this.focusManager.Eg(Kf.AFrame.zt)):this.focusManager.Eg(Kf.AFrame.zR);var Yb=this.lb.gb.currentSelection;if(!Yb||!Yb.Qa)return 2;ka=Yb.Qa.cpBegin;Va=Yb.Qa.node;Yb=!!this.lB&&(Xk.a.Fm(Yb)||Yb.HN)&&ie.r(this.lB,Va,this.Gj,ka);ka=!!this.lB&&(2===this.mode||3===this.mode);if(Yb||ka)return this.yL.hLj(this.lB.id,!0),32;Yb=this.uE&&!this.Sg.jn?
this.vj.Fvi(!0,!0):null;this.yL.XPo(Yb)}else this.vj.ou&&(this.Fr.mmc.aLj(this.vj.ou,!0),this.Fr.mmc.bsb(null===(Yb=this.vj.ou)||void 0===Yb?void 0:Yb.objectId)),this.focusManager.Eg(Kf.AFrame.Jo);return 32}Ajl(){return 4}jHn(ka){const Va=new Set;for(let yb=0;yb<ka.length;yb++){const Yb=this.vj.E2c(ka[yb]);Yb&&Va.add(Yb.Qf?Yb.Qf:Yb.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",Va.size.toString())}Ymd(ka,Va){ka?this.hMb&&!this.Sg.m0?this.Sg.Qnb=Object.assign(new Cg,{commentId:ka.id,
S$c:!1}):this.A2.selectComment(ka,Object.assign(new gm.a,{v4:!!Va,wca:Va})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}v9l(ka){let Va=null,yb=!1;for(let Yb=0;Yb<ka.length;Yb++){const oc=ka[Yb].toString();if(this.vj.d0f(ka[Yb])){Va||(Va=oc);if(yb&&this.vj.ou.objectId!==oc)return this.vj.W2(oc);yb=yb||!!this.vj.ou&&this.vj.ou.objectId===oc}}return Va?this.vj.W2(Va):null}Kwe(ka){this.Sg.filter=ka;this.i7a.onRibbonFilterChanged(ka);this.Qb.Ob(Lb.a.mIj,2);this.jI.f4("OnContentFilterUpdate")}W2d(ka,
Va,yb){if(2===yb)this.Kwe({...this.Sg.filter,resolutionStatus:2===this.Sg.filter.resolutionStatus?0:2});else if(1===yb&&!this.vj.Usa())return 2;return 32}X2d(ka,Va,yb){if(2===yb)this.Kwe({...this.Sg.filter,mentionsToCurrentUser:!this.Sg.filter.mentionsToCurrentUser});else if(1===yb&&!this.vj.Usa())return 2;return 32}Y2d(ka,Va,yb){if(2===yb)this.Kwe({...this.Sg.filter,resolutionStatus:1===this.Sg.filter.resolutionStatus?0:1});else if(!(1!==yb||this.hMb.isVisible&&this.vj.Usa()))return 2;return 32}Xue(ka,
Va,yb){if(2===yb)this.Kwe({mentionsToCurrentUser:!1,resolutionStatus:0});else if(1===yb&&!this.vj.Usa())return 2;return 32}}Object(f.a)(Yn,"CommentsActionManager",null,[]);var vk=d(168),mm=d(37),Ud=d(197),Fe=d(1844),Rc=d(530),ui=d(29),uj;(function(ka){ka[ka.sYp=0]="commentDeeplink";ka[ka.Mnl=1]="catchUpActivity"})(uj||(uj={}));Object(f.b)("DeeplinkSource",uj);class Ck{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd,Qe,Cf,Wf,gg){this.ga=ka;this.yi=Va;this.Zx=yb;this.FNe=Yb;this.gT=oc;this.KEh=Vc;this.Zb=yd;
this.Ij=Jd;this.uj=Pd;this.EFb=Qe;this.HNe=Cf;this.uJ=Wf;this.m9e=!1;this.a0o=Jg=>{if(this.uj.Kr&&!this.Ij.jn){const Lh=new Gb.a(0,1,0,()=>{this.mNj(Jg)},136,void 0,!0);y.AFrameworkApplication.oc.Yb(Lh)}else this.mNj(Jg)};gg.execute(Jg=>{this.GG=Jg})}get Np(){return this.yi}get lb(){return this.EFb.value}pji(ka){let Va=ka.Gr===Ye.a.kE?ka.MA.draftId:ka.id,yb=null;ka.Qf&&(Va=ka.Qf,yb=()=>{this.KEh.selectComment(ka.id)});this.gT.setInitialActiveContainerId(Va,0,yb)}OPo(ka,Va,yb,Yb,oc){if(!oc.commentId)return 2;
ka=this.yi.KF(oc.commentId);if(!ka)return 2;this.ayb(ka,oc);return 32}eLj(ka,Va){var yb,Yb;if(ka){var oc=(null===(Yb=null===(yb=this.yi.ez)||void 0===yb?void 0:yb.MA)||void 0===Yb?void 0:Yb.draftId)===ka?this.yi.ez:this.yi.KF(ka);this.selectComment(oc,Va)}}selectComment(ka,Va){ka&&this.ayb(ka,Va)}bLj(ka,Va){var yb=this.D5d(ka);yb&&((yb=this.E5d(yb,0))?Va.KCg?(this.Ij.Qnb=Object.assign(new Cg,{commentId:yb.id,S$c:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):
(this.ayb(yb,Object.assign(new gm.a,{commentId:yb.id,wca:1,v4:!0,a9c:!0})),this.uj.Kr&&void 0!==ka&&null!==ka&&this.pji(yb),Xf.a.q6(y.AFrameworkApplication.oc,()=>{this.Zb.Eg(this.uj.Kr&&!this.Ij.jn?Kf.AFrame.zR:Kf.AFrame.zt)},af.a.qWo),vk.a.instance.tf(mm.a.adi,(new Date).getTime()),ka=this.uj.Kr?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",ka+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,ka,(new Date).getTime()-y.AFrameworkApplication.UT)):
this.ga.Ob(wi.a.fcb,2))}D5d(ka){let Va=null;var yb=null;if(Pa.a.Poc(ka))Va=ka;else if(({hv:yb}=Fa.d(ka)).returnValue&&(ka=yb))return Rc.a.comment in ka&&(Va=ka[Rc.a.comment]),Va;Va||(yb=yb?Object.keys(yb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",yb?yb.join(","):"Not Json."));return Va?Va.toString():null}E5d(ka,Va){const yb=this.yi.E2c(ka),Yb=0===Va;Yb&&this.uJ.logKpiUsage(Ue.a.LWd,0);if(!yb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",
ka,Va);const oc=new ui.a;oc.name="DeepLinkSource";oc.string=uj[Va];this.uJ.logActivity("CommentDeeplinkNotFound",{dataFields:[oc]});Yb&&(Va=new ya.a,Va.extendedProperties=new Map([["ErrorLevel","warning"]]),this.uJ.logKpiFailure(Ue.a.LWd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:Va}),this.HNe.LPn=ka)}return yb}mNj(ka){this.m9e=!0;this.lb.Kc(ka);this.m9e=!1}ayb(ka,Va){if(ka){this.Ij.lOa||this.ga.Ob(Lb.a.jJg,2);this.Ij.HWb&&(y.AFrameworkApplication.oc.uf(this.Ij.HWb),this.Ij.HWb=
null);var yb=this.yi.ou,Yb=this.Np.PMf(ka),oc=2===Va.wca,Vc={};oc&&(Vc.TriggeredByFindReplace=!0);if(this.Ij.jn)oc&&(Vc.PaneAlreadyOpen=!0),Ud.UISurfaces.Ov().then(yd=>{yd.setSelectedTaskPane(Fe.a.VWd);return null});else if(ka.Gr!==Ye.a.kE&&!this.Np.ota(ka))this.Ij.m0?this.ga.Ob(Lb.a.V0,2):this.Ij.Qnb=Object.assign(new Cg,{commentId:ka.id,S$c:Va.a9c}),oc&&(Vc.OpeningPaneToSelect=!0);else if(this.uj.Kr){const yd=Yb.Gr===Ye.a.kE;yd?this.gT.v_a(Yb.MA.draftId,0,Va.v4):this.gT.v_a(Yb.id,0,Va.v4);!yd&&
oc&&(Vc.SelectingDHC=!0)}Xf.a.q6(y.AFrameworkApplication.oc,()=>{this.Ij.m0&&(Va.v4&&this.Zb.Eg(this.uj.Kr&&!this.Ij.jn?Kf.AFrame.zR:Kf.AFrame.zt),Va.a9c&&this.Np.ota(ka)||!Va.v4&&!Va.wca||this.KEh.selectComment(ka.id))},af.a.Ezg);oc=this.Np.PMf(yb);this.GG&&oc&&oc.id!==Yb.id&&this.GG.fireEvent(9,{comment:oc});this.yi.selectComment(ka);this.GG&&ka.Gr===Ye.a.normal&&!ka.Qf&&this.GG.fireEvent(8,{comment:ka});this.FNe.highlightComment(ka,!0);this.Zx.GH(0,Yb,yb);ng.StaticActiveAppFrame.za().Fe(!0);0<
Object.keys(Vc).length&&this.uJ.$w(Lb.a.selectComment,{em:Vc})}}}Object(f.a)(Ck,"CommentSelectionActor",null,[746]);class Wm extends jh.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new jg.a,{T_:Wm.getTypeName(),B_:Wm.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(f.a)(Wm,"CommentSmartReplySignal",jh.a,[]);class Bm extends pb.a{constructor(){super();this.DomainName=
this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new jg.a,{T_:Bm.getTypeName(),B_:Bm.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(f.a)(Bm,"SmartReply",pb.a,[]);var Xm=d(868);class nj{constructor(ka){this.Gwa=ka}Zfc(ka,Va){return Object.assign(new Xm.a,{parentPath:["Signal",Wm.getTypeName()],items:[Object.assign(new hf.a,{body:Object.assign(new Wm,{commentId:ka,
comment:Va})})]})}Mlg(ka){const Va=new L.a;if(ka&&ka.CommentId&&ka.ResultSets&&0<ka.ResultSets.length&&ka.ResultSets[0].Documents&&0<ka.ResultSets[0].Documents.length){for(const yb of ka.ResultSets[0].Documents)Va.add(yb.Caption);0<Va.count&&this.Gwa.Mlg(ka.CommentId,Va.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return Bm.getTypeName()}}Object(f.a)(nj,"BaseCommentSmartReplyProvider",null,[1937]);class ep extends nj{constructor(ka,
Va,yb,Yb){super(ka);this.Re=Va;this.XC=yb;this.ipk=Yb}initialize(){this.XC.Bm().then(()=>{this.Re.nb(this,nj.prototype.getTypeName.call(this))})}invoke(ka,Va){this.XC.Bm().then(()=>{this.ipk.getAugLoopRuntimeManager().submitOperation(Object.assign(new Pf.a,{operation:this.Zfc(ka,Va)}))})}oH(ka,Va){ka&&jc.a.getTypeNameFor(ka.content)===this.getTypeName()&&Va===vb.a.getTypeName()?this.Mlg(ka.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(f.a)(ep,"CommentSmartReplyProvider",
nj,[155]);var sj=d(34),Ik=d(138),Yi=d(618);class Rh{constructor(ka,Va,yb,Yb,oc,Vc){this.Ga=ka;this.Cd=Va;this.Ez=yb;this.w_e=Yb;this.HNe=oc;this.zS=Vc;this.AEb=!1;this.HNe.Nyo();this.$bh=this.xDm();this.Dqg&&(sj.a.addHandler(window.self,nf.a.fRh,()=>{this.AEb=!0}),sj.a.addHandler(window.self,nf.a.gRh,()=>{this.AEb=!1}));0<this.$bh&&y.AFrameworkApplication.nd("77dda873;fe8jd931")}get tv(){return this.Ez?this.Ez.value:null}get LIa(){return this.w_e.value}get xtp(){return this.AEb}get Ulc(){return 0<
this.$bh}get Kr(){return this.zS.Kr}get $Vl(){return!0}get P1b(){return this.Cd.isFeatureEnabled(106)&&!Yi.a.j$c}get fRo(){return this.Cd.isFeatureEnabled(30)&&this.Ga.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get Wwl(){return this.Ga.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get Dqg(){return!1}get shj(){return this.Ga.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get BNb(){return this.Kr&&!this.Ulc&&!this.Ga.jb("BootActivityNavigationId")&&H.a.hu}get nbl(){return this.Ga.$("AtMentionUserFloodGateCampaignIsEnabled")}get mxl(){return this.Ga.$("CommentFriendlyTimestampsIsEnabled")}get RVl(){return this.Ga.jb("DisabledChangeGatesInSharedComments")}get K3d(){return this.zS.K3d}get d1b(){return H.a.bS?
this.nAe:this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get nAe(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SimpleMarkupModeInSafari",!1)}get yEg(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",!1)}get H0(){return this.Ga.jb("PresenceUserId")}get eha(){return Yi.a.UGe&&!!Ik.PageReader.instance&&Ik.PageReader.instance.WAa(ng.StaticActiveAppFrame.za().kb.ed).eha}get spb(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",
!1)}get okp(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1)}get byl(){return this.Ga.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get oBn(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.zS.contentNavigationApiEnabled}get g9n(){return this.Cd.isFeatureEnabled(79)}get contentFilterApiEnabled(){return this.zS.contentFilterApiEnabled}get Bbp(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",
!1)}get ribbonCommentFilteringEnabled(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCommentFilteringEnabled",!1)}get TQl(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.DeleteAllCommentsCheckFixEnabled",!1)}get Mjf(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.AtMentionBookmarkFixup",!1)}xDm(){if(this.tv&&this.LIa){const ka=new $b.a;ka.set(this.tv);this.LIa.Ybb(ka);let Va=0;39===ka.nf&&(Va=ka.Gq());return Va}return-1}}Object(f.a)(Rh,
"CommentsSettings",null,[]);class ze{constructor(){this.z8g=null;this.m0=!1;this.HWb=this.Qnb=null;this.pz=new sc.a(new ee.a);this.aY=new sc.a(new ee.a);this.dqg=this.hSb=!1;this.lOa=!0;this.filter={mentionsToCurrentUser:!1,resolutionStatus:0}}get jn(){return Eh.a.jn}set jn(ka){Eh.a.jn=ka}get jmb(){return this.z8g}set jmb(ka){this.z8g=ka}}ze.rk=1;Object(f.a)(ze,"CommentsState",null,[]);var Yf=d(1361);class wb{constructor(ka){this.kda=ka}QXh(ka,Va,yb){const Yb=new Wc;Va=this.kda.NXa(Va)?Va.objectId:
null;if(!Va)return Yb;Va=qb.a.Af(Va);if(yb.contains(Va))return Yb.x7c=0,Yb.w7c=ka.length,Yb;for(let Vc=0,yd=ka.length;Vc<yd;Vc++){var oc=ka[Vc];yb=ie.g(oc);oc=ie.d(oc);yb&&Yf.a.J6h(yb,Va)&&(Yb.x7c=Vc);if(oc&&Yf.a.J6h(oc,Va)){Yb.w7c=Vc;break}}return Yb}hTh(ka,Va,yb){const Yb=-1===Va.x7c&&-1===Va.w7c,oc=-1<Va.x7c?Va.x7c:-1;Va=-1<Va.w7c?Va.w7c:ka.length;const Vc=!Yb&&oc===Va;var yd=!1;for(let Jd=0;Jd<ka.length;Jd++){const Pd=ka[Jd],Qe=Qg.a(Pd);if(1!==Qe&&2!==Qe&&3!==Qe)continue;this.kda.XZa(Pd);if(Yb||
Jd<oc||Jd>Va)continue;const Cf=3===Qe||2===Qe&&-1!==Pd.className.indexOf(bg.a.MWa),Wf=yb?1:2;this.K9k(Jd,oc,Va,Wf,Cf,yd,Pd,Vc);if(Jd!==Va||Vc)(yd=this.kda.y$a.K(Qe).K(Wf))&&Pd.classList.add(yd),yd=Cf}}K9k(ka,Va,yb,Yb,oc,Vc,yd,Jd){ka!==Va&&ka!==yb||oc||Vc||((ka=this.kda.guc.K(Yb))&&yd.classList.add(ka),Jd&&yd.classList.add(bg.a.jlg))}}Object(f.a)(wb,"DefaultHighlightChangeHandler",null,[745]);var gc;(function(ka){ka[ka.success=0]="success";ka[ka.Wn=1]="noSelection";ka[ka.H7p=2]="invalidContent"})(gc||
(gc={}));Object(f.b)("AnchorCreationResult",gc);var Sc=d(60),Xc=d(21),se=d(274),Qf=d(252),Jf=d(1022);class lf{}Object(f.a)(lf,"EditorAnchorInfo",null,[729]);class tf{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd){this.KAn=ka;this.V3f=Va;this.vj=yb;this.HBa=Yb;this.KIa=oc;this.fq=Vc;this.jI=yd;this.Bu=Jd;this.zJg=Pd;this.BEh=null;this.HBa.yNa(this.KIa);this.Bu.contentFilterApiEnabled&&(this.jI.h4("OnCommentPaneOpen",this.Czp.bind(this)),this.jI.h4("OnCommentPaneClose",this.Bzp.bind(this)),this.jI.h4("OnContentFilterUpdate",
this.kfd.bind(this)))}get lb(){return this.V3f.value}get Gj(){return this.KAn.value}initialize(){}F9m(ka){this.BEh=ka}dispose(){}bsb(ka){this.KIa.bsb(ka)}lmc(ka){this.KIa.lmc(ka)}highlightComment(ka){this.aLj(ka,!1);this.KIa.bsb(ka.objectId)}dBc(ka){this.KIa.dBc(ka)}yKa(ka){return this.KIa.yKa(ka)}kfd(){this.RIe("OnContentFilterUpdate")}Czp(){this.RIe("OnCommentPaneOpen")}Bzp(){this.RIe("OnCommentPaneClose")}RIe(ka){const Va=[],yb=new Set;for(const oc of this.vj.GR())if(!oc.Qf&&oc.Gr!==Ye.a.kE&&!this.vj.yL.r_h(ka,
oc)){var Yb=this.AEm(oc);yb.has(Yb.id.toString())||(yb.add(Yb.id.toString()),(Yb=Yb.Ce(Object(Sc.a)().Ad.sc))&&Va.push(Yb))}Va.forEach(oc=>{this.HBa.eBc(oc)})}AEm(ka){var Va,yb,Yb;const oc=null===(Va=this.Gj)||void 0===Va?void 0:Va.Eb(ka.objectId);if(!oc)return null;ka=ie.k(oc);Va=null===(yb=this.Gj)||void 0===yb?void 0:yb.Eb(ka);return null===(Yb=this.zJg.instance)||void 0===Yb?void 0:Yb.dRb(Va)}aLj(ka,Va){if(!ka.Gr){var yb=this.Gj.Eb(qb.a.Af(ka.objectId)),Yb=Oc.a.ufa(yb,this.Gj,!0);yb=Oc.a.ufa(yb,
this.Gj,!1);if(Yb&&yb){const oc=Yb.Jb.paragraph;Yb=Yb.Jb.cp;if(this.xtn(oc,Yb))ng.StaticActiveAppFrame.za().Fe(!0);else{Yb=Xc.SelectionFactory.ve(oc,Yb);yb=ed.a.Tc(yb.Jb.paragraph,yb.Jb.cp);if(tf.sg.qba(Yb.Qa)||tf.sg.qba(yb))ka.xXa=!0,ka.Vbb();ka=Va?Xc.SelectionFactory.Yy(Yb,yb):Yb;this.BEh(ka)}}}}Ssl(){this.KIa.lmc(null);this.KIa.bsb(null)}zEl(){const ka=new lf;return{returnValue:gc.success,anchor:ka}}xtn(ka,Va){if(ka&&Object(jj.a)(Jf.a,this.fq.Ad)){var yb=ka.Ce(this.fq.Ad.sc);ka=document.getElementById(rl.a.b1a);
if(yb&&ka){Va=se.a.Cr(yb,Va);if(!Va)return!1;Va=Va.y;yb=Sys.UI.DomElement.getBounds(ka).y;ka=ka.offsetHeight;if(Va>=yb&&Va<=yb+ka)return!0}}return!1}static get sg(){return Qf.a.instance}static getInstance(){return tf.Sm()}static Sm(){return tf._instance||(tf._instance=new tf(new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed.ud),new kb.a(()=>Yk.a.instance),K.a.instance.resolve(742),K.a.instance.resolve(363).instance,K.a.instance.resolve(743),Object(Sc.a)(),K.a.instance.resolve(744),K.a.instance.resolve(745),
K.a.instance.Ra(597)))}}tf._instance=null;Object(f.a)(tf,"EditorCommentHintManager",null,[717,718,11]);var ei=d(65),Ug=d(2102),Gc=d(353),Fn=d(1109);class Wl extends sk.a{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd,Qe,Cf,Wf,gg,Jg,Lh,Qj,Uk,gj,Vj,om,Hj,pn,ki,Wq,gp,wm){super(yd);this.Fi=Va;this.EFb=Jd;this.pqf=Qe;this.Hwa=Cf;this.oFc=Wf;this.gT=gg;this.uj=Jg;this.Vp=Lh;this.F5b=Qj;this.Ij=Uk;this.s1=gj;this.Zd=om;this.uJ=Hj;this.VW=ki;this.i7a=Wq;this.zJg=wm;this.uOi=this.CGh=this.X2a=null;this.Jvb=()=>{this.qwa.zta()&&
(this.tBj(this.qwa.Jc),this.qwa.Gvc(this.Jvb))};this.Ldd=si=>{ie.x(void 0,si.mode)?1===si.mode&&(this.iF=0):this.iF=1;this.yi.ez&&0===this.iF?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.yi.ez.MA.sessionType):this.Ij.m0&&(this.uE||this.q5.isVisible)&&this.rZb()};this.TWn=()=>{this.Ij.hSb?this.mode=0:this.iF=0};this.VMa=(si,sl)=>{var tl;si=sl.Tm.currentSelection;if((this.uE||this.Oga&&this.Oga.isVisible)&&!this.F5b.m9e&&
si){sl=Xk.a.Fm(si);var Gm=si.HN;null!==(tl=this.uOi)&&void 0!==tl&&tl.bfa||(this.Np||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),tl=this.Np&&this.Np.btb(this.ga,!1),1!==this.mode||sl&&!Gm||!tl?this.oFc.oae():this.JIl(si));2!==this.mode&&3!==this.mode&&this.uj.Wwl&&this.Drp(si,sl,Gm)}};this.pql=()=>{if(this.vj&&this.vj.ez&&!tb.a.uXf){var si=this.vj.ez;si.MA.sessionType!==Ug.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${si.Gr} present on app shutdown`),
(si=ld.a.Crm(si))&&this.uJ.logKpiFailure(si,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:Ue.a.eMb,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.cXn=()=>{if(this.Ij.m0){var si=()=>!0;this.uE&&!this.Ij.jn&&(si=sl=>this.Np.ota(sl));si=this.Np.KHf(si);this.rZb(si)}};this.ga=yd;this.iF=ie.x(this.ga.mode,void 0)?0:1;this.q5=oc;this.yi=Yb;this.Bda=Vc;this.Zb=Pd;this.Nxo();yb.vdb(this.Hwa);this.lb.BA(this.VMa);ka.CWR(()=>ka.result.xC.Vya(this.TWn));y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.c6a(this.Ldd);this.s1.h4("OnAfterTrackChangeMarkupViewChange",this.cXn);y.AFrameworkApplication.JH&&y.AFrameworkApplication.JH(this.pql);gp.execute(si=>{this.GG=si});pn.execute(si=>{si.VBl.execute(sl=>{this.uOi=sl})})}Nxo(){this.qwa&&(this.qwa.zta()?this.tBj(this.qwa.Jc):this.qwa.Wcc(this.Jvb))}tBj(ka){ka.r6(()=>{this.gfp()})}get qwa(){var ka;return null===(ka=Yi.a.Pm)||void 0===ka?void 0:ka.kb}get lb(){return this.EFb.value}get vj(){return this.yi}get Np(){return this.yi}get uE(){return this.uj.Kr}get dhj(){return!0}get SLj(){return!0}get xmc(){return this.X2a}set xmc(ka){this.X2a=
ka}get mode(){return super.mode}set mode(ka){ka!==this.iF&&(super.mode=ka,this.Vbb())}get lB(){return this.model&&this.model.ou?this.model.ou.Qf?this.model.KF(this.model.ou.Qf):this.model.ou:null}get Gj(){return this.Fi.value}get wUj(){return!1}get eha(){return this.uj.eha}rZb(ka=null){var Va=this.Np;const yb=!this.iF,Yb=this.Oga.jxl,oc=Va.O7d();Yb.BMg(oc?5:1,yb);ka=this.uj.d1b&&ka?ka:Va.jIf(this.uj.d1b&&this.uE&&!this.Ij.jn);Yb.YQo(ka,oc,Va.O1a);this.eMg();Va=0;ld.a.zyf&&(Va=+new Date-+ld.a.zyf);
clearTimeout(ld.a.YBj);a.ULS.sendTraceTag(572281362,327,50,`Comment Context Reloaded, Time Taken: ${Va}`)}lfd(ka,Va,yb=!1){this.Ij.jn?this.gT.I9j():Va?this.gT.uJa(ka.Gr===Ye.a.kE?ka.MA.draftId:ka.id,0,yb):this.Npo(ka)}Npo(ka){const {kmp:Va}=this.yi.txm(ka),yb=this.Bda.yKa(ka.objectId);yb&&this.gT.Ecc(ka.id,yb.parentElement,0,Va)}kLj(ka){const Va=this.lB;this.$md();this.Hwa.GH(0,this.yi.ou,Va);this.uE&&this.yi.ou&&!this.Ij.jn&&this.gT.v_a(this.yi.ou.id,0,1===ka)}YPo(){const ka=this.lB;this.bnd();this.Hwa.GH(0,
this.yi.ou,ka);this.uE&&this.yi.ou&&!this.Ij.jn&&this.gT.v_a(this.yi.ou.id,0,!1)}dBc(ka){this.Bda.dBc(ka)}t0l(ka,Va){this.gT.Ecc(ka,null,0,Va)}nco(ka){this.gT.Usj(ka)}v0l(ka,Va){this.gT.eld(ka,Va,0)}Lyp(){this.gT.Kjf()}dLj(ka){if(ka&&(2!==this.mode||ka.Gr===Ye.a.kE)){var Va=this.yi.ou;Va!==ka&&(this.yi.selectComment(ka),this.q5.isVisible?this.Ij.m0?(this.q5.selectComment(ka,1),this.jpa.selectComment(ka.id)):this.Ij.Qnb=Object.assign(new Cg,{commentId:ka.id,S$c:!1}):this.uE&&!ka.done&&(this.hLj(ka.id,
!1),this.jpa.selectComment(ka.id)),!this.q5.isVisible&&this.uE&&ka.done||(this.mmc.bsb(ka.objectId),this.Hwa.GH(0,this.lB,Va)))}}O7c(){}HAf(){this.Ij.hSb=!1}iKb(ka){this.uj.shj&&this.yi.ou&&this.clearSelection();super.iKb(ka);this.uJ.logKpiUsage(Ue.a.Cqf,0);this.eMg();if(this.uE){const Va=this.yi.LPm(ka.draftId);this.t0l(ka.draftId,Va)}}omb(ka,Va){this.uJ.logKpiUsage(Ue.a.XWd,0);super.omb(ka,Va)}Fza(ka){this.uE&&null!=ka.MA&&this.yi.zCj(ka.MA.draftId);super.Fza(ka);this.Bda.bsb(ka.objectId);a.ULS.sendTraceTag(50426376,
327,50,"{0}:  added by user action.",ie.a(ka));this.uJ.logKpiUsage(Ue.a.R4h,0);this.vql(ka);ld.a.KGp(ka,this.Gj,this.uJ);this.uJ.$w(Lb.a.Q4h,{succeeded:!0,em:{actionType:ka.Qf?Ug.a.reply:Ug.a.create}})}Snb(ka){super.Snb(ka);this.uJ.$w(Lb.a.Q4h,{succeeded:!0,em:{actionType:Ug.a.cpb}})}vql(ka){if(ka.Qf){var Va=this.yi.PMf(ka);if(Va.lTc&&Va.mTc){var yb=this.Gj.Eb(qb.a.Af(Va.mTc));Va=Va.mTc===Va.lTc?null:this.Gj.Eb(qb.a.Af(Va.lTc));ld.a.wRg(yb,ka,!0);ld.a.wRg(Va,ka,!1)}}}VYc(ka){super.VYc(ka);this.lB&&
this.lB.id===ka.id&&(super.clearSelection(),this.uE&&this.gT.$ec());if(this.uE)if(ie.s(ka)){var Va=[];let yb=null;for(const Yb of this.model.GR())Yb!==ka&&(Yb.Qf===ka.Qf&&Va.push(Yb),Yb.id===ka.Qf&&(yb=Yb));yb&&yb.id&&yb.objectId&&!yb.done&&this.Np.FI(yb.objectId)&&!this.Np.Htj(yb.objectId)&&!Va.length&&this.lfd(yb,!0)}else Va=ka.Gr===Ye.a.kE,ka.done||this.lfd(ka,!0),Va&&this.yi.zCj(ka.MA.draftId)}dpb(ka,Va){1===this.mode&&ka&&(this.yi.c_c(ka,Va),Ug.a.cpb===Va.sessionType&&this.uJ.logKpiUsage(Ue.a.W4h,
0),this.uj.P1b&&3!==Ug.a.SKf(Va.sessionType)&&this.F5b.selectComment(ka,Object.assign(new gm.a,{v4:!1,wca:0})))}rwe(ka){this.uE&&!this.Ij.jn||super.rwe(ka)}deleteComment(ka){ka.Gr!==Ye.a.kE&&this.Np.zei(qb.a.Af(ka.objectId));this.X2a&&this.X2a.id===ka.id&&(this.yi.ou&&this.X2a.id===this.yi.ou.id?this.X2a=null:this.Hwa.bpf());!this.yi.ou||this.yi.ou.id!==ka.id&&this.yi.ou.Qf!==ka.id?this.yi.ou&&this.Hwa.GH(0,this.yi.ou,null):void 0===ka.Qf||null===ka.Qf?this.clearSelection():this.yi.selectComment(this.yi.KF(ka.Qf));
ka.xXa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",ie.a(ka));super.deleteComment(ka);a.ULS.sendTraceTag(50426377,327,50,`${ie.a(ka)} deleted by user action. DurableId: ${ka.k8a}`)}NLb(ka,Va){super.NLb(ka,Va);this.uE&&!this.Ij.jn&&Va&&(this.yi.ou&&this.yi.ou.id===ka.id&&this.clearSelection(),this.xmc&&this.xmc.id===ka.id&&this.Hwa.bpf())}XPo(ka=null){(ka=this.Np.ynm(ka))?this.F5b.selectComment(ka,Object.assign(new gm.a,{v4:!0,wca:1})):this.kLj(1)}JIl(ka){var Va,
yb=this.qwa.Jc;if(yb){var Yb=ka.Qa.node,oc=null===(Va=this.zJg.instance)||void 0===Va?void 0:Va.dRb(Yb);if(oc)for(const Vc of yb.l7(oc))if(Vc&&Vc instanceof Gc.a&&(Va=Vc,yb=Fn.a.rai(Va),this.oFc.TFe=this.R7l(Yb,ka),oc=this.Mkl(yb),null!==oc)){if(ka=this.oFc.H7l(yb,oc))yb.jLa[oc].appendChild(ka),Va.kG(ka);break}}}R7l(ka,Va){let yb;for(const Yb of ka.nJ)if(Yb&&Yb){yb=Yb;break}ka=Va.Qa.Jj;Va=!(null===yb||void 0===yb||!yb.Ap)&&0<yb.Ap.length;return 0>ka||!Va||null===yb||void 0===yb||!yb.DBf?null:se.a.t2(ka,
yb,!1,!1)}Mkl(ka){var Va;const yb=null===(Va=this.oFc.TFe)||void 0===Va?void 0:Va.y;for(const [Yb,oc]of ka.B7.entries())if(ka=yb-oc.y,-2<=ka&&ka<oc.height+2)return Yb;return null}Vbb(){tb.a.Nrb=2===this.mode||3===this.mode;1!==this.mode&&this.oFc.oae()}Drp(ka,Va,yb){const Yb=this.Zb.currentScope;let oc=null;if(Va||yb){Va=ka.Qa.cpBegin;ka=ka.Qa.node;if(this.lB&&ie.r(this.lB,ka,this.Gj,Va))return;oc=this.bCm(ka,Va)}oc?!this.uE||this.Ij.jn?Xf.a.q6(y.AFrameworkApplication.oc,()=>{this.dLj(oc)},af.a.QPo):
this.dLj(oc):!this.yi.ou||Yb&&Yb.name===Kf.AFrame.zR||this.clearSelection()}bCm(ka,Va){let yb=null;const Yb=this.model.GR();for(let oc=Yb.length-1;0<=oc;oc--){const Vc=Yb[oc];if(Vc.objectId&&!(Vc.Qf||this.uE&&!this.Oga.isVisible&&Vc.done)&&ie.r(Vc,ka,this.Gj,Va)){yb=Vc;break}}return yb}selectComment(ka,Va=1){this.F5b.eLj(ka,Object.assign(new gm.a,{v4:1===Va,wca:Va}))}hLj(ka,Va){const yb=this.yi.KF(ka);yb?this.uE&&!ie.s(yb)&&yb.Gr!==Ye.a.kE&&this.gT.v_a(ka,0,Va):a.ULS.sendTraceTag(42332933,327,10,
"Selected Comment isn't in the model.")}clearSelection(){const ka=this.model.ou;this.GG&&ka&&this.GG.fireEvent(9,{comment:ka});super.clearSelection();this.Hwa.GH(1,ka,ka);this.uE&&ka&&this.gT.$ec()}Xsn(){var ka;return 500>(null===(ka=this.CGh)||void 0===ka?void 0:ka.Hi)}Esc(ka,Va=1){if(!this.uj.shj||!this.yi.ez){var yb=this.yi.KF(ka),Yb=null;yb||(Yb=this.X2a);var oc=this.Xsn(),Vc=!1;1===Va&&this.jpa&&(oc?Vc=!0:this.jpa.highlightComment(ka));ka?yb?oc?Vc=!0:this.Bda.lmc(yb.objectId):a.ULS.sendTraceTag(37323346,
327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.Bda.lmc(null);yb?oc?Vc=!0:(this.X2a=yb,this.Hwa.GH(2,yb,Yb)):(this.X2a=null,this.Hwa.GH(3,null,Yb));Vc&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}gfp(){this.Zd&&(this.CGh=this.Zd.Xf("UserAction","StartScrollDetectionStopwatch"))}notify(ka,Va){this.Vp.sendNotification(ka,Va)}eMg(){this.i7a.onContentChanged()}r_h(ka,Va){var yb,Yb;switch(ka){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.vbp(Va);
case "OnContentFilterUpdate":return!(null===(Yb=(yb=this.i7a).isContentInFilterUpdateDiff)||void 0===Yb?0:Yb.call(yb,Va.id));default:return!0}}vbp(ka){return!ka.done&&this.Np.ota(ka)===this.i7a.isContentInFilteredContent(ka.id)}static getInstance(){return Wl.Sm()}static Sm(){Wl.gh||(Wl.gh=new Wl(ei.a.Rsa(),new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed.ud),K.a.instance.resolve(369).instance,K.a.instance.resolve(746),K.a.instance.resolve(747),tf.getInstance(),y.AFrameworkApplication.va,new kb.a(()=>
Yk.a.instance),km.FocusManager.instance(),K.a.instance.resolve(748),K.a.instance.resolve(749),K.a.instance.resolve(750),K.a.instance.resolve(751),K.a.instance.resolve(745),K.a.instance.resolve(25),K.a.instance.resolve(752),K.a.instance.resolve(753),K.a.instance.resolve(744),Yi.a.Pm.kb.Jc,ng.StaticActiveAppFrame.za().$r,K.a.instance.resolve(754),K.a.instance.Ra(755),K.a.instance.resolve(756),K.a.instance.resolve(611),K.a.instance.Ra(757),K.a.instance.Ra(597)),Wl.gh.A0b=!0);return Wl.gh}}Wl.gh=null;
Object(f.a)(Wl,"EditorCommentManager",sk.a,[714,715,716,11]);var Xg=d(1774);class Zi{constructor(ka,Va,yb,Yb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ka;this.body=Va;this.confirmButton=yb;this.cancelButton=Yb}}Object(f.a)(Zi,"ViewContainerModalDialogStrings",null,[]);d(1372);class Go{constructor(ka,Va){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;
this.canvasActionId=ka;this.canvasContextId=Va}}Object(f.a)(Go,"CommentUIAction",null,[]);var Ym=d(1508);class Jk{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd,Qe,Cf,Wf,gg,Jg,Lh,Qj,Uk){this.ga=ka;this.Fg=Va;this.oe=yb;this.Zb=Yb;this.kq=oc;this.ii=Vc;this.g6=yd;this.Gwa=Jd;this.RPd=Pd;this.Gcf=Qe;this.Gb=Cf;this.gT=Wf;this.uj=gg;this.Ij=Jg;this.F5b=Lh;this.s1=Qj;this.gpa=Uk;this.FNe=this.Hj=null;this.FEh=this.B8g=!1;this.sOc=null;this.I9o=(gj,Vj,om)=>2!==om||this.Ij.m0?1===om?32:2:(this.s1.f4("OnCommentInit",
Object.assign(new il.a,{FMa:()=>{this.ga.Ob(wi.a.V0,2)}})),32);this.gVf=(gj,Vj,om)=>1!==om||this.Ij.m0?2:8;this.sVk=(gj,Vj,om)=>{if(1===om)return!this.btb()||this.nmb?8:this.Ij.m0?2:32;if(!this.Ij.m0)return this.nmb=!0,this.s1.f4("OnCommentInit",Object.assign(new il.a,{FMa:()=>{this.Kr||this.Ij.jn||this.ga.Ob(wi.a.V0,2)}})),32;this.Kr||this.Ij.jn||this.ga.Ob(wi.a.V0,2);(this.Kr||this.Ij.jn)&&this.Zb.Eg(this.Ij.jn?Kf.AFrame.zt:Kf.AFrame.zR);return 2};this.RQl=(gj,Vj,om)=>1===om&&qh.SessionStatusManager.instance.Nk?
8:2;this.xVl=(gj,Vj,om,Hj)=>1!==Hj||(this.Kr||this.isVisible)&&this.Hj.model.ou?gj||this.Hj.model.ou?32:8:8;this.Zrb=(gj,Vj,om,Hj,pn)=>{if(1===om||!this.Ij.jn)return 32;if(!this.Kr&&2===om&&(2===this.Hj.mode||3===this.Hj.mode))return pn=new Zi(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.RPd.invokeModalConfirmationDialog(()=>{this.XYn(gj,Vj,om,Hj)},()=>{this.bYn()},pn),32;this.qae();
if(this.Kr)return 32;pn&&this.nji();return 32};this.cvc=(gj,Vj,om,Hj,pn)=>{if(1===om)return 32;pn[ji.a.On]=this.isVisible;return 32};this.qDc=this.sEl()}get isVisible(){return this.Ij.jn}get nmb(){return this.B8g}set nmb(ka){this.B8g=ka}get x3o(){return"SharedCommentsTaskPaneProps"}get Igd(){return null}get Tgj(){return null}get nN(){return this.kq}get Oga(){return null}get jxl(){return this.Gwa}get Kr(){try{return this.uj.Kr}catch(ka){return!1}}KBi(){return new sg(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,
y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}sEl(){const ka=new ce.a,Va=new Go(wi.a.xMa,Bd.a.frame);Va.preCallback=this.sVk;const yb=new Go(Lb.a.mcg,Bd.a.frame),Yb=new Go(Lb.a.Bmg,Bd.a.frame),oc=new Go(Lb.a.deleteComment,Bd.a.frame);oc.preCallback=this.RQl;oc.postCallback=this.xVl;const Vc=new Go(Lb.a.mIj,Bd.a.frame);this.Kr&&(yb.preCallback=this.gVf,Yb.preCallback=this.gVf,Vc.preCallback=this.gVf);const yd=new Go(wi.a.V0,Bd.a.frame);yd.preCallback=this.I9o;ka.W(6,yd);ka.W(0,
Va);ka.W(1,yb);ka.W(2,Yb);ka.W(3,oc);ka.W(7,Vc);return ka}KRj(ka){this.FEh||(this.BQk=this.G8d(),this.g6.GUa(),this.H2o(),this.B2o(ka),this.FEh=!0)}B2o(ka){this.Hj=ka;this.FNe=ka.mmc;this.Hj.Dli=this.Gwa}initialize(ka){this.KRj(ka);this.Wb()}CVf(){this.sOc&&this.Zb.Eg(Kf.AFrame.zt);this.nmb&&!this.Kr?(this.ga.Ob(wi.a.xMa,2),this.nmb=!1):this.Ij.Qnb&&Xf.a.q6(y.AFrameworkApplication.oc,()=>{const ka=this.Ij.Qnb.commentId,Va=this.Ij.Qnb.S$c;this.ga.Pb(Lb.a.selectComment,2,Object.assign(new gm.a,{commentId:ka,
wca:1,v4:!0,a9c:Va}));Va&&(Xf.a.q6(y.AFrameworkApplication.oc,()=>{this.Zb.Eg(Kf.AFrame.zt)},af.a.Ezg),vk.a.instance.tf(mm.a.adi,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.UT);this.Ij.Qnb=null},af.a.PPo)}dispose(){}N8(){}selectComment(){this.isVisible||this.Kr||this.eVj();this.ii.Fe(!0)}Wb(){this.ga.qa(wi.a.Zrb,Bd.a.frame,this.Zrb);this.ga.fb(wi.a.cvc,Bd.a.frame,this.cvc,96)}Vbb(){-1!==
this.Hj.mode&&(this.Hj.mode||this.nji())}nji(){const ka=this.Hj,Va=ka.Np,yb=Va.O7d(),Yb=Va.jIf(this.uj.d1b&&this.uj.Kr&&!this.Ij.jn);this.Gwa.XQo(Yb.length,yb,!ka.mode,yb?5:1);this.Gwa.wRo(Yb,Va.O1a)}H2o(){const ka=this.Zb.ie(Kf.AFrame.zt);ka.parent=Kf.AFrame.Kq;ka.YL=!0;ka.hve=!0;ka.JAb=!0;ka.Z5a((Va,yb)=>{Fg.a.q_h(yb.name)&&(this.Ij.HWb=Xf.a.q6(this.Gb,()=>{yb.name!==Kf.AFrame.zR&&2!==this.Hj.mode&&3!==this.Hj.mode&&(this.Hj.clearSelection(),this.ii.Fe(!0));this.Ij.HWb=null},af.a.NYn))});this.kq.IW(Kf.AFrame.zt);
for(const Va of ie.u)ka.bindAction(ue.KeyInputManager.Hx(Va),Lb.a.Mmf)}dWo(){this.sOc&&this.Gcf.Fcm()}q1h(){this.Rwk&&this.dWo()}XYn(ka,Va,yb,Yb){const oc=this.Hj,Vc=oc.Np.ez;Vc&&Vc.MA?oc.pqf.endCommentSession(Vc.MA.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.Zrb(ka,Va,yb,Yb,!0);Xf.a.q6(this.Gb,()=>{this.ii.Fe(!0)},af.a.pLo)}bYn(){this.sOc&&this.Zb.Eg(Kf.AFrame.zt);this.ii.Fe(!0)}vNa(ka){ka.qt(this.Zb.LZ);ka.qt(this.Zb.MZ)}U0b(ka,Va,yb){if(1===
yb)return 32;this.eVj();return 32}eVj(){this.isVisible||(this.Ij.lOa=!0,this.Ij.m0?(this.wWl(),this.Ij.jn=!0,this.s1.Xse(),this.Zb.oSc(Kf.AFrame.zt),this.Kr&&this.uj.d1b&&this.Hj.rZb(this.Hj.model.KHf(()=>!0)),this.Rwk=!0,Ud.UISurfaces.Ov().then(ka=>{ka.showTaskPane(Fe.a.VWd,this.BQk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.Hj.Esc(null),this.ii.Fe(!0),this.vNa(this.Zb.ie(Kf.AFrame.zt)),this.s1.f4("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,
327,50,"New Comment Pane opened.")):this.s1.f4("OnCommentInit",Object.assign(new il.a,{FMa:()=>{this.Ij.jn||this.ga.Ob(wi.a.V0,2)}})))}wWl(){this.ga.Pb(Lb.a.U6,2,null);this.ga.Pb(Lb.a.dX,2,null)}btb(){return this.gpa.btb(this.ga,!1)}iKb(){}show(){this.isVisible||this.ga.Ob(wi.a.V0,2)}dpb(){return 2}qae(){this.Hj.M$n();this.Ij.jn=!1;if(this.Kr&&this.uj.d1b){const Va=this.Hj.model;this.Hj.rZb(Va.KHf(yb=>Va.ota(yb)))}var ka=km.FocusManager.instance();ka.currentScope&&ka.currentScope.name===Kf.AFrame.zt&&
ka.Eg(this.Kr&&(2===this.Hj.mode||3===this.Hj.mode||this.Hj.vj.ou)?Kf.AFrame.zR:ka.bX);this.kq.Cx(Kf.AFrame.zt);this.Zb.FYc(Kf.AFrame.zt);Ud.UISurfaces.Ov().then(Va=>{Va.hideTaskPane(Fe.a.VWd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.Kr&&(ka=this.Hj.model.ou)&&this.Mxp(ka);this.s1.f4("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}Mxp(ka){ka.done?this.Hj.clearSelection():this.F5b.pji(ka)}V5n(ka=null){this.Gcf.eRj(3);
this.CVf();if(ka){this.q1h();sj.a.mrg(ka,[nf.a.contextMenu]);const Va=this.Zb.ie(Kf.AFrame.zt);this.Fg.DSc(Kf.AFrame.zt,ka,Va.JAb)}}D3n(ka){this.kq.eL(Kf.AFrame.zt);1!==ka&&Xf.a.q6(y.AFrameworkApplication.oc,()=>{this.Zb.aF(Kf.AFrame.zt)},af.a.Ezg)}onTaskPaneClose(){this.Ij.m0&&this.Gcf.eRj(1)}G8d(){const ka={type:this.x3o,p3p:this.q1h};return Object.assign(new Ym.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:ka,hideHeader:!1,width:300,location:2,onOpen:Va=>{this.sOc=Va;this.V5n(Va);
this.gT.nJg(!0)},onClose:()=>{this.sOc=null;this.ga.Pb(wi.a.Zrb,2,!0);this.ii.Fe(!0);this.onTaskPaneClose();const Va=this.Hj.Np;this.Ij.lOa&&Va.Y5c()&&this.gT.nJg(!1)},onShow:Va=>{this.D3n(Va)}})}V0(){return 32}}Object(f.a)(Jk,"OfficeSharedCommentPane",null,[11,705,706]);var zo=d(1661),Li=d(175);class $k{constructor(ka,Va){this.containerType="full-pane";this.identifier=null;this.ga=ka;this.identifier=Va}openView(){this.ga.Ob(wi.a.U0b,2)}closeView(){this.ga.Pb(wi.a.Zrb,2,!0)}invokeModalConfirmationDialog(ka,
Va,yb){const Yb=new Li.StandardDialog;yb&&yb.title&&yb.body&&yb.confirmButton&&yb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),yb=new Zi("","","",""));Yb.Ed=1;Yb.Qe(1,yb.confirmButton);Yb.Qe(0,yb.cancelButton);Yb.Mx(yb.title,yb.body,1,oc=>{1===oc?ka():Va()})}}Object(f.a)($k,"ViewContainerAPI",null,[701,702]);class Kk{constructor(ka,Va,yb){this.Vop=ka;this.Sg=Va;this.VOa=yb;this.hd=new bb.a;this.Vop.execute(Yb=>{this.VOa.Jte("OnBeforeTrackChangeMarkupViewChange",
(oc,Vc)=>{Vc&&Vc.$bg!==Yb.rk&&this.hd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",Vc)});this.VOa.Jte("OnAfterTrackChangeMarkupViewChangeEventKey",(oc,Vc)=>{Vc&&Vc.rk===Yb.rk&&(ze.rk=Yb.rk,this.hd.raiseEvent("OnAfterTrackChangeMarkupViewChange",Vc))})})}h4(ka,Va){this.hd.addHandler(ka,Va)}f4(ka,Va){this.hd.raiseEvent(ka,Va)}Xse(){this.Sg.dqg||(this.Sg.dqg=!0,this.hd.raiseEvent("OnCommentRenderedOnce"))}}Object(f.a)(Kk,"WordCommentEventsActor",null,[]);var lq=d(1841);class jr{constructor(){this.insertIndex=
0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(f.a)(jr,"InitCommentSessionResult",null,[]);class mc extends jr{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(f.a)(mc,"BeginDraftingHostResult",jr,[]);var wk=d(2162),Ho=d(2104),Zl=d(1027);class kr{constructor(ka,Va,yb,Yb,oc,Vc,yd,Jd,Pd,Qe,Cf,Wf,gg,Jg,Lh){this.$i=ka;this.Gwa=Va;this.gnk=yb;this.cqp=Yb;this.zqf=oc;this.Bu=Vc;this.fv=yd;this.focusManager=Jd;this.BY=
Pd;this.Qb=Qe;this.hl=Cf;this.A2=Wf;this.Sg=gg;this.Lxl=Jg;this.Jxl=Lh;this.k$b=this.r$=this.pp=null;this.Wrk="WordWebCommitNewCommentActivity";this.Xrk="WordWebCommitTaskActivity";this.Trk="WordWebCommentReactionActivity";this.ech=null}get gpa(){return this.r$}gho(ka){var Va;const yb=this.gpa.ez,Yb=this.r$.GR();if(Yb&&yb){const oc=Zl.a.Lpb(null!==(Va=yb.authorId)&&void 0!==Va?Va:"");Va=new lq.a(yb.authorId,yb.Pdc,yb.author,null!==oc&&void 0!==oc?oc:"",!0);ka.author=Va;ka.insertIndex=Array.indexOf(Yb,
yb);ka.authorName=yb.author;ka.authorIdentity="";return null}return Xf.a.DF(-2130915320)}initialize(ka,Va,yb,Yb){this.pp=ka;this.r$=Va;this.k$b=yb;this.ech=Yb}beginDraftingAsync(ka){if(!ka)return new Promise((Yb,oc)=>{oc(Xf.a.DF(-2130915327))});const Va=new mc,yb=Ug.a.SKf(ka.sessionType);return void 0===yb||null===yb?new Promise((Yb,oc)=>{oc(Xf.a.DF(-2130915317))}):new Promise((Yb,oc)=>{Xf.a.q6(this.$i,()=>{if(1!==this.pp.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",
this.pp.mode),oc(Xf.a.DF(-2130915325));else{this.Q0h();try{switch(yb){case 0:if(!this.pp.Oga.btb()){oc(Xf.a.DF(-2130915326));return}this.Lxl.oae();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${ka.draftId}`);this.pp.iKb(ka);break;case 1:if(!ka.threadId||""===ka.threadId){oc(Xf.a.DF(-2130915324));return}if(this.Bu.yEg){const Jd=this.r$.KF(ka.threadId);if(Jd){const Pd=this.r$.Avi(Jd,!1),Qe=wk.a.JPb(Jd,Pd,Jd.authorId===this.Bu.H0);Qe&&this.zqf.invoke(ka.threadId,Qe)}else a.ULS.sendTraceTag(579170962,
327,10,"Smart reply provider not invoked since comment is null",this.pp.mode)}this.pp.omb(ka.threadId,ka);break;case 3:if(!ka.threadId||""===ka.threadId){oc(Xf.a.DF(-2130915324));return}var Vc=this.r$.KF(ka.threadId);if(!Vc){oc(Xf.a.DF(-2130915323));return}this.pp.dpb(Vc,ka);break;case 2:if(!ka.commentId||""===ka.commentId){oc(Xf.a.DF(-2130915324));return}const yd=this.r$.KF(ka.commentId);if(!yd){oc(Xf.a.DF(-2130915323));return}this.pp.dpb(yd,ka)}}catch(yd){oc(yd);this.KGj();a.ULS.sendTraceTag(553677466,
327,10,`Drafting Exception ${yd} on Session ${yb}`);return}(Vc=this.gho(Va))?oc(Vc):Yb(Va);this.KGj()}},af.a.beginDraftingAsync)})}commit(ka,Va,yb){const Yb=this.gpa.ez;if(!Yb)throw Xf.a.DF(-2130915320);var oc=Yb.MA;if(!oc)throw Xf.a.DF(-2130915320);const Vc=Ug.a.SKf(oc.sessionType);if(void 0===Vc||null===Vc)throw Xf.a.DF(-2130915317);if(ka!==oc.draftId)throw Xf.a.DF(-2130915327);let yd=!1,Jd=!1;oc=!1;switch(Vc){case 3:if(!yb)throw Xf.a.DF(-2130915327);break;case 0:this.hl.ee(()=>{if(!this.pp.Oga.btb())throw Xf.a.DF(-2130915326);
Yb.text=[Va];this.pp.uE&&!this.Sg.jn?this.pp.nco(()=>{this.pp.Fza(Yb);this.pp.v0l(ka,Yb.id)}):this.pp.Fza(Yb);Jd=yb&&null!=yb.Task;yd=!0;Xf.a.q6(this.$i,()=>{this.ayb(Yb.id)},af.a.ayb)},"WESCA:C:C");break;case 1:this.hl.ee(()=>{Yb.text=[Va];this.pp.Fza(Yb);Jd=yb&&null!=yb.Task;yd=!0},"WESCA:C:R");break;case 2:this.hl.ee(()=>{Yb.text=[Va];this.pp.Snb(Yb);this.gwj(Lb.a.$En)},"WESCA:C:E");break;default:throw Xf.a.DF(-2130915322);}yb&&(yb.Resolve&&(this.DNj(Yb,yb.Resolve.isResolved),yb.Resolve.isResolved&&
!this.Sg.jn&&this.pp.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),yb.Task&&this.pp.kyl(Yb,yb.Task),yb.Reaction&&(oc=!0,yb.Reaction.isActive?this.pp.XQd(Yb,yb.Reaction.reactionType):this.pp.Xte(Yb,yb.Reaction.reactionType)));this.Bu.byl&&Jd&&this.BY.execute(Pd=>Pd.logActivity(this.Xrk,"CommentsTasksFpsIsEnabled"));yd&&this.BY.execute(Pd=>{Pd.logActivity(this.Wrk,"CommentsFpsIsEnabled")});oc&&this.BY.execute(Pd=>{Pd.logActivity(this.Trk,"CommentReactionsFpsIsEnabled")});return Yb.id}endCommentSession(ka){const Va=
this.gpa.ez;if(Va){if(Va.MA&&Va.MA.draftId!==ka)throw Xf.a.DF(-2130915327);if(Va.Gr===Ye.a.kE)this.pp.deleteComment(Va),!this.pp.uE||Va.Qf||this.Sg.jn||this.focusManager.Eg(Kf.AFrame.Jo);else{if(3!==this.pp.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}Va.Gr=Ye.a.normal;Va.t_a=Ho.a.succeeded;Va.MA=null;this.pp.Lnf()}}this.fv&&this.fv.Fe(!0);this.gpa.O7d()||this.Gwa.BMg(1,!this.pp.mode)}deleteComment(ka){(ka=this.r$.KF(ka))?
(this.pp.deleteComment(ka),this.pp.uE&&!this.Sg.jn?ka.Qf||this.focusManager.Eg(Kf.AFrame.Jo):this.focusManager.aF(Kf.AFrame.zt),this.cqp.FCg(ka)&&this.gwj(Lb.a.A$i)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(ka){this.ayb(ka,0)}highlightComment(ka){this.pp.Esc(ka,0)}setThreadResolvedState(ka,Va){(ka=this.r$.KF(ka))&&this.DNj(ka,Va)}DNj(ka,Va){if(ka.Qf&&""!==ka.Qf)throw Xf.a.DF(-2130915321);this.pp.NLb(ka,Va);Va&&!this.Sg.jn&&this.focusManager.Eg(Kf.AFrame.Jo)}presentLinkToComment(ka){var Va=
this.r$.KF(ka);Va?(Va=this.gpa.c6d(Va))?(ka={["nav"]:btoa(`{"${Rc.a.comment}":${Va}}`),["mode"]:"copy"},this.Jxl.$w(Lb.a.presentLinkToComment),this.Qb.Pb(wi.a.Maa,2,ka,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",ka):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",ka)}selectFirstThreadInNextCommentContext(){this.pp.kLj(0)}selectLastThreadInPreviousCommentContext(){this.pp.YPo()}registerForCommentEvents(ka){const Va=
this.gpa.jIf(this.Bu.d1b&&this.Bu.Kr&&!this.Sg.jn),yb=this.gpa.O1a,Yb=this.gpa.O7d(),oc=!this.pp.mode;this.Gwa.u_o();this.ech.pBm().then(Vc=>{this.Gwa.gxo(ka,Va,Yb,oc,yb,Vc);this.Gwa.BMg(Yb?5:1,oc);this.fv&&this.fv.Fe(!0)})}unregisterForCommentEvents(ka){this.Gwa.z2b(ka)}registerForAction(ka,Va){this.gnk.TZa(ka,Va)}unregisterForAction(){}checkAtMentionCapability(){return this.k$b?this.k$b.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),
new Promise(ka=>{ka(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}Q0h(){const ka=this.pp.uE&&!this.Sg.jn?Kf.AFrame.zR:Kf.AFrame.zt;if(ka===Kf.AFrame.zt){if(!this.Sg.jn)return;Ud.UISurfaces.Ov().then(Va=>{Va.setSelectedTaskPane(Fe.a.VWd);return null})}this.focusManager.aF(ka)}ayb(ka,Va=1){this.Q0h();this.A2.eLj(ka,Object.assign(new gm.a,{wca:Va,v4:1===Va}))}KGj(){this.pp.Oga.nmb&&(this.pp.Oga.nmb=!1)}gwj(ka){this.Qb.Ob(ka,
2)}}Object(f.a)(kr,"WordEditorSharedCommentAPI",null,[703,704]);class Io{constructor(ka,Va,yb,Yb,oc,Vc,yd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ka;this.parentId=Va;this.commentBody=yb;this.author=Yb;this.date=oc;this.commentFlags=Vc;this.usersByReactionType=yd}}Object(f.a)(Io,"OfficeSharedCommentModel",null,[]);d(1635);class Vo{constructor(ka,Va){this.Ga=ka;this.NUb=Va;this.EMh="AD";this.nFc=
new va.a;this.scf=new va.a;this.Rbl=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.bch=new Ti.a}get userPrincipalName(){return this.Ga.jb("UserPrincipalName")}get $cb(){return this.Ga.jb("PresenceProvider")}get H0(){return this.Ga.jb("PresenceUserId")}get Gj(){return this.NUb.value}Ghj(ka){const Va=this.Rbl.exec(ka);return Va?Va[1]:ka}gHi(ka,Va=!1){let yb=0;ka.done&&(yb=ka.Qf&&""!==ka.Qf?yb|4:yb|8);ka.a7h&&(yb|=2);Va&&(yb|=1);this.FCg(ka)&&(yb|=16);ka.F_f&&(yb|=32);this.V_m(ka)||(yb|=128);return yb}V_m(ka){return ka?
(ka=this.Gj.Eb(ka.objectId))?ka.hasProperty(Sa.a.cU):!1:!1}FCg(ka){if(!ka)return!1;if(void 0===ka.authorId||null===ka.authorId||""===ka.authorId)return this.S6f(ka.id,ka.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.H0||null===this.H0||""===this.H0)return this.S6f(ka.id,ka.objectId,"PresenceUserId null or empty"),!1;if(this.H0==ka.authorId&&ka.Pdc==this.$cb)return!1;const Va=this.n2d(ka.authorId),yb=this.n2d(this.H0);if(this.$cb===this.EMh&&Va&&yb&&Va[0]!=this.userPrincipalName&&
Va[1]!=yb[1])return!0;this.S6f(ka.id,ka.objectId,"Unknown");return!1}isCurrentUser(ka){if(!ka||void 0===ka.authorId||null===ka.authorId||""===ka.authorId||void 0===this.H0||null===this.H0||""===this.H0)return!1;if(this.H0==ka.authorId&&ka.Pdc==this.$cb)return!0;ka=this.n2d(ka.authorId);const Va=this.n2d(this.H0);return this.$cb===this.EMh&&ka&&Va?ka[0]==this.userPrincipalName||ka[1]==Va[1]:!1}n2d(ka){if(void 0===ka||null===ka)return null;ka=ka.split("::");return 3===ka.length?ka.slice(1,3):null}S6f(ka,
Va,yb){ka&&!this.bch.contains(ka)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${Va}; reason: ${yb}`),this.bch.add(ka))}Cri(ka,Va){var yb;if(!ka)return null;const Yb=ka.Hfe;let oc=!1;ie.x(Va,void 0)&&(oc=!0);Va=ka.author?this.Ghj(ka.author):"";const Vc=Zl.a.Lpb(null!==(yb=ka.authorId)&&void 0!==yb?yb:"");yb=new lq.a(ka.authorId?ka.authorId:"",ka.Pdc,Va,null!==Vc&&void 0!==Vc?Vc:"",this.isCurrentUser(ka));return new Io(ka.id?ka.id:"",ka.Qf?ka.Qf:"",ka.text&&ka.text.length?
ka.text[0]:null,yb,ka.date||Yb?ka.date:new Date,this.gHi(ka,oc),this.iHi(ka.usersByReactionType))}Vem(ka,Va,yb){const Yb=[],oc=new va.a;if(!ka)return Yb;for(const Vc of ka)Vc.Gr!==Ye.a.kE&&yb(Vc)&&(Vc.id&&this.nFc.mb(Vc.id)?(ka=this.nFc.K(Vc.id),ka=this.aJl(Vc,ka,Va),Yb.push(ka),oc.W(Vc.id,ka)):Vc.id?(ka=this.Cri(Vc,Va),Yb.push(ka),oc.W(Vc.id,ka)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.nFc=oc;return Yb}vlm(ka,Va,yb){const Yb=[];for(const oc of ka)oc.Gr!==Ye.a.kE&&
yb(oc)&&(oc.id&&this.nFc.mb(oc.id)?Yb.push(this.nFc.K(oc.id)):oc.id&&Yb.push(this.Cri(oc,Va)));return Yb}aJl(ka,Va,yb){var Yb=ka.Hfe,oc=ie.x(yb,void 0);yb=ka.Qf?ka.Qf:"";const Vc=ka.text&&ka.text.length?ka.text[0]:null,yd=ka.author?this.Ghj(ka.author):"",Jd=ka.authorId?ka.authorId:"",Pd=ka.Pdc?ka.Pdc:"",Qe=Zl.a.Lpb(Jd);Yb=ka.date||Yb?ka.date:new Date;oc=this.gHi(ka,oc);const Cf=this.isCurrentUser(ka),Wf=this.iHi(ka.usersByReactionType);return Va.parentId===yb&&Va.commentBody===Vc&&Va.author.DisplayName===
yd&&Va.author.UserId===Jd&&Va.author.Provider===Pd&&Va.author.IsCurrentUser===Cf&&Va.date===Yb&&Va.commentFlags===oc&&this.oal(Va.usersByReactionType,Wf)?Va:(Va=new lq.a(Jd,Pd,yd,null!==Qe&&void 0!==Qe?Qe:"",Cf),new Io(ka.id,yb,Vc,Va,Yb,oc,Wf))}oal(ka,Va){if(!ka&&!Va)return!0;if(!Va||!ka)return!1;var yb=Object.keys(ka);if(yb.length!==Object.keys(Va).length)return!1;for(const Yb of yb){if(!(Yb in Va))return!1;yb=ka[Yb];const oc=Va[Yb];if(yb.length!==oc.length)return!1;for(let Vc=0;Vc<yb.length;Vc++)if(!this.dal(yb[Vc],
oc[Vc]))return!1}return!0}dal(ka,Va){return ka||Va?ka&&Va&&ka.UserId===Va.UserId&&ka.Provider===Va.Provider&&ka.Email===Va.Email&&ka.DisplayName===Va.DisplayName&&ka.IsCurrentUser===Va.IsCurrentUser?!0:!1:!0}iHi(ka){if(!ka)return null;const Va={},yb=this.Ga.jb("PresenceUserId");for(const oc of Object.keys(ka)){const Vc=[];var Yb=ka[oc];for(const yd of Yb){Yb=yd.UserId===yb;let Jd;this.scf.mb(yd.UserId)?(Jd=this.scf.K(yd.UserId),Jd.IsCurrentUser=Yb):(Jd=new lq.a(yd.UserId,yd.Provider,yd.DisplayName,
yd.Email,Yb),this.scf.add(yd.UserId,Jd));Vc.push(Jd)}Va[oc]=Vc}return Va}}Object(f.a)(Vo,"WordEditorSharedCommentModelTranslator",null,[598]);class Jo{constructor(){this.Aq=null;this.bxd=this.kAh=this.F9g=this.zHh=this.wKh=this.Uvh=this.oCh=!1}hHi(){this.Aq||(a.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.mQj());return this.Aq}pBm(){return new Promise((ka,Va)=>{this.bxd?ka(this.pCi()):this.bNj().then(()=>{ka(this.pCi())}).catch(yb=>
{Va(yb)})})}pCi(){this.bxd||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ka;ka=33;this.F9g&&(ka|=2);this.oCh&&(ka|=8);this.wKh&&(ka|=16);this.Uvh&&(ka|=4);this.zHh&&(ka|=64);this.kAh&&(ka|=128);return ka}}Object(f.a)(Jo,"OfficeSharedCommentsAppCapabilities",null,[1809]);class eo extends Jo{constructor(ka){super();this.j4a=null;this.uj=ka;this.G0o();this.mQj()}G0o(){this.zHh=this.uj.P1b;
this.wKh=!1;this.kAh=this.Uvh=this.oCh=!0}initialize(ka){this.j4a=ka;this.bNj()}mQj(){this.Aq={};this.Aq.LivePersonaPicker="true";this.Aq.PersonaColor="true";this.Aq.DiscreteHostedComments=this.uj.$Vl.toString();this.Aq.NewCommentButton="true";this.Aq.DisabledChangeGates=this.uj.RVl;this.Aq.CommentsFluentUI="true";this.Aq.CommentTasks=this.uj.P1b.toString();this.Aq.CommentTasksFromReply=this.Aq.CommentTasks;this.Aq.CommentFriendlyTimestamps=this.uj.mxl.toString();this.Aq.AtMentionFloodgateSurvey=
this.uj.nbl.toString();this.Aq.HyperlinksInComments="true";this.Aq.LogDraftCommentIdPair="true";this.Aq.RichTextFormattingInWeb="true";this.Aq.RichContentEditIntegration="true";this.Aq.HyperlinksWithDisplayText="true";this.Aq.SmartReplies=this.uj.yEg.toString();this.Aq.LinkToComment="true";this.Aq.TaskPaneWithNewInfrastructure="true";this.Aq.CommentReactions="true";this.Aq.WebThemeIntegration="true";this.Aq.NewSelectionInteractions="true";this.Aq.HighlightsAndFontColorInWebComments="true";this.Aq.TruncationUIWithReadMoreText=
"true";this.Aq.CtrlEnterTip="true";this.Aq.AtMentionHintMessage="true";this.Aq.LivePersonaCardForWeb="true";this.Aq.TaskHistoryRecordIDs=this.uj.okp.toString();this.Aq.ContentNavigation=this.uj.contentNavigationApiEnabled.toString()}bNj(){return new Promise((ka,Va)=>{this.j4a?this.j4a.atMentionsEnabledAsync().then(yb=>{this.F9g=yb;this.bxd=!0;ka(this.bxd)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),
Va(Xf.a.DF(-2130915320)))})}}Object(f.a)(eo,"WordSharedCommentsAppCapabilities",Jo,[597]);class uc{constructor(){this._initialized=!1;this.ayl={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:Ue.a.VCf,vetoPillar:7};this.wkp={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:zo.a.VCf,vetoPillar:7}}get Gcb(){return null!=this.m2g?this.m2g:this.m2g=(()=>this.Z.resolve(414))()}m2(ka){this.Gcb.m2(Bk.a.comments,ka,!0)}get name(){return"WordEditor.Comments"}uc(ka){this.Z=
ka;this.m2("CPConfigStart");ka.ia(754,()=>new Un.a(ca.Health.instance,new Wh.a,this.ayl)).as(754).ha();ka.ia(1196,()=>new Un.a(ca.Health.instance,new Wh.a,this.wkp)).as(1196).ha();ka.ia(758,()=>new Ql(this.Z.resolve(754))).as(758).ha();ka.ia(745,()=>new Rh(y.AFrameworkApplication.J,this.Z.resolve(23),new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed),new kb.a(()=>cj.a.instance),this.Z.resolve(758),this.Z.resolve(607))).as(745).ha();ka.ia(753,()=>new ze).ha();ka.ia(744,()=>new Kk(ka.Ra(263),ka.resolve(753),
ka.resolve(629))).ha();ka.ia("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new Vo(y.AFrameworkApplication.J,new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed.ud))).as(771).ha();ka.ia("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new Mb(ka.resolve(745),ka.resolve(8),this.Z.resolve(754))).as(1194).ha();ka.ia("Common.Comments.OfficeSharedCommentsEventHost",()=>new ql(y.AFrameworkApplication.oc)).as(766).ha();ka.ia("WordEditor.Comments.CommentActionInTypingRecorder",()=>new Ch(this.Z.resolve(745))).as(765).ha();
ka.ia(780,Xg.a.getInstance).as(746).as(1005).as(742).ha();ka.ia(778,()=>new Si(new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed),new kb.a(()=>cj.a.instance),ka.resolve(742),ka.resolve(753),ka.resolve(745),ka.resolve(758),this.Z.resolve(754)));ka.ia(604,()=>new Kd(ka.resolve(742),y.AFrameworkApplication.J,ka.resolve(744),ka.resolve(753),ka.Ra(2))).ha();ka.resolve(604);ka.ia("WordEditor.Comments.CommentHighlightOnRestActor",()=>new ae(new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed),ka.resolve(753),
ka.resolve(742),ka.resolve(744),ka.resolve(59).Pl,wa.a.instance,this.Z.resolve(611),ka.resolve(745))).as(760).ha();ka.ia(759,()=>new Jc(ka.resolve(373))).ha();ka.ia(764,()=>new wb(ka.resolve(759))).ha();ka.ia(763,()=>new vf(ka.resolve(760),ka.resolve(759),y.AFrameworkApplication.ta.e9,y.AFrameworkApplication.ta.OOa,y.AFrameworkApplication.va,y.AFrameworkApplication.oc,ka.resolve(753),ka.Ra(761))).ha();ka.ia("WordEditor.Comments.CommentHighlightActor",()=>new db(new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed.ud),
ka.resolve(762),ka.resolve(760),ka.Ra(761),wa.a.instance,ka.resolve(763),ka.resolve(764),ka.resolve(759),ka.resolve(744))).as(749).ha();ka.ia(743,()=>new $f(ka.resolve(745),Pl.a.instance,on.a.instance,vl.a.instance,y.AFrameworkApplication.va,Nm.TableCellReader.non,te.moveToLastRenderedCellOfTheRow,new Ej.a,ka.Ra(11),ka.resolve(742),ka.resolve(749),ka.resolve(765),ka.resolve(753),ka.resolve(611))).as(781).ha();ka.ia(750,()=>new Xd(Pl.a.instance,vl.a.instance,y.AFrameworkApplication.va,ka.Ra(6))).ha();
ka.ia("WordEditor.Comments.ViewContainerAPI",()=>new $k(y.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as(767).ha();ka.ia("Common.Comments.CommentActivationManager",()=>new co).as(777).ha();ka.ia("Common.Comments.ViewContainerEventHost",()=>new fm(y.AFrameworkApplication.oc,"OfficeSharedCommentPaneSurface")).as(768).ha();ka.ia("WordEditor.Comments.CommentSmartReplyProvider",()=>new ep(this.Z.resolve(766),this.Z.resolve(454),this.Z.resolve(659),this.Z.resolve(660))).as(772).ha();ka.ia("WordEditor.Comments.WordSharedCommentsAppCapabilities",
()=>new eo(ka.resolve(745))).as(773).ha();this.m2("CPConfigEnd")}init(){this.m2("CPInitStart");this.Z.resolve(23).Qr.continueWith(()=>{try{this.No(),this.m2("CPInitEnd")}catch(ka){throw a.ULS.jA(524300632,327,10,ka,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",ka),this.Gcb.Ty(Bk.a.comments,"CPInitException",ka,!0),ka;}})}No(){const ka=this.Z.resolve(745);this.m2("onAfterGFNLoadedStart");this.Z.ia("WordEditor.Comments.OfficeSharedCommentPane",()=>new Jk(y.AFrameworkApplication.va,
y.AFrameworkApplication.ta.dF,y.AFrameworkApplication.ta.eF,y.AFrameworkApplication.ta.xq,y.AFrameworkApplication.ta.Jy,ng.StaticActiveAppFrame.za(),wl.a.instance,this.Z.resolve(766),this.Z.resolve(767),this.Z.resolve(768),y.AFrameworkApplication.oc,this.Z.resolve(751),ka,this.Z.resolve(753),this.Z.resolve(752),this.Z.resolve(744),this.Z.resolve(742))).as(747).as(769).ha();this.Z.ia("Common.Comments.OfficeSharedCommentsActionHost",()=>new Mm(y.AFrameworkApplication.va,this.Z.resolve(769).qDc)).as(770).ha();
this.Z.ia("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new kr(y.AFrameworkApplication.oc,this.Z.resolve(766),this.Z.resolve(770),this.Z.resolve(771),this.Z.resolve(772),ka,ng.StaticActiveAppFrame.za(),y.AFrameworkApplication.ta.xq,this.Z.Ra(2),y.AFrameworkApplication.va,wa.a.instance,this.Z.resolve(752),this.Z.resolve(753),this.Z.resolve(750),this.Z.resolve(754))).as(748).ha();sk.a.factory=Wl.getInstance;this.Z.ia(779,Wl.getInstance).as(437).as(761).ha();this.Z.ia("WordEditor.Comments.CommentFloatingContainerActor",
()=>new Wg(this.Z.resolve(753),this.Z.resolve(745),this.Z.resolve(742),y.AFrameworkApplication.oc,this.Z.resolve(765),this.Z.resolve(744),this.Z.resolve(608),()=>document.querySelector(`#${rl.a.b1a} .${ug.a.Jgc}`),this.Z.resolve(773),y.AFrameworkApplication.ta.xq,this.Z.resolve(611))).as(756).ha();const Va=this.Z.resolve(607),yb=Va.trackChangeInSidetrackEnabled;yb&&this.Z.resolve(636).gBj(this.Z.resolve(756));this.Z.ia(775,()=>new ah(this.Z.resolve(742),y.AFrameworkApplication.oc,wa.a.instance,this.Z.resolve(765),
this.Z.resolve(753),this.Z.resolve(744),this.Z.resolve(608),this.Z.resolve(756),Va)).ha();this.Z.ia(751,()=>yb?this.Z.resolve(774):this.Z.resolve(775)).as(362).ha();this.Z.ia("WordEditor.Comments.CommentSelectionActor",()=>new Ck(y.AFrameworkApplication.va,this.Z.resolve(746),this.Z.resolve(749),tf.getInstance(),this.Z.resolve(751),this.Z.resolve(766),y.AFrameworkApplication.ta.xq,this.Z.resolve(753),ka,new kb.a(()=>Yk.a.instance),this.Z.resolve(758),this.Z.resolve(754),this.Z.Ra(757))).as(752).ha();
this.Z.ia(782,()=>new xi(this.Z.resolve(761),this.Z.resolve(742),this.Z.resolve(769),this.Z.resolve(752),ka,this.Z.resolve(753),this.Z.resolve(751),tf.getInstance(),ng.StaticActiveAppFrame.za().$r,y.AFrameworkApplication.va,this.Z.resolve(78).$D,this.Z.Ra(776),y.AFrameworkApplication.ta.xq,this.Z.resolve(773),this.Z.resolve(772),this.Z.resolve(777),this.Z.resolve(767),this.Z.Ra(2),this.Z.resolve(744),this.Z.Ra(65),this.Z.Ra(143),this.Z.resolve(609),this.Z.resolve(768),this.Z.resolve(754),this.Z.resolve(756),
this.Z.resolve(608),Va,this.Z.resolve(610),this.Z.resolve(414),this.Z.resolve(778),this.Z.resolve(611))).ha();this.Z.ia(784,()=>new Yn(this.Z.resolve(779),this.Z.resolve(780),this.Z.resolve(781),this.Z.resolve(752),this.Z.resolve(744),this.Z.resolve(753),this.Z.resolve(751),ka,this.Z.resolve(747),new kb.a(()=>ng.StaticActiveAppFrame.za().kb.ed.ud),y.AFrameworkApplication.va,new kb.a(()=>Yk.a.instance),km.FocusManager.instance(),wa.a.instance,this.Z.resolve(750),this.Z.resolve(611))).as(784).ha();
this.Z.resolve(782);ka.contentNavigationApiEnabled&&(this.Z.ia(598,()=>new Tj(this.Z.resolve(778),this.Z.resolve(745))).ha(),this.Z.ia(783,()=>new Zk(this.Z.resolve(603),this.Z.resolve(742),this.Z.resolve(752),this.Z.resolve(761),this.Z.resolve(753))).ha(),this.Z.resolve(598),this.Z.resolve(783));const Yb=ka.Kr,oc=this.Z.resolve(779);this.Z.resolve(784);oc&&Yb&&(this.Z.resolve(753).jmb=uc.dui(),ka.BNb||this.Z.resolve(744).f4("OnCommentInit"));ld.a.mHn();ka.Ulc&&ng.StaticActiveAppFrame.za().kb.lki();
sk.a.instance&&(ka.BNb||jk.a.get_instance().$k(4,()=>{this.OYn(Yb)},11).continueWith(()=>{this.X8m()}),this._initialized=!0);this.hvo(this.Z.Ra(325),this.Z.resolve(164),this.Z.resolve(762))}X8m(){this.Z.resolve(744).f4("OnCommentInit")}OYn(ka){ka||this.gUm()}gUm(){const ka=uc.dui();ka&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.UT),this.Z.resolve(744).f4("OnCommentInit",Object.assign(new il.a,{FMa:()=>{sk.a.instance.Oga.isVisible||
y.AFrameworkApplication.va.Ob(wi.a.V0,2);this.Z.resolve(752).bLj(ka,Object.assign(new gm.a,{KCg:!0}))}})),this.Z.resolve(754).$w(wi.a.tqf))}hvo(ka,Va,yb){ka&&ka.execute(Yb=>{Yb.nY(new Ic.a(Va,yb))})}dispose(){this._initialized&&(sk.a.instance&&sk.a.instance.dispose(),this._initialized=!1)}static dui(){return y.AFrameworkApplication.J.jb("BootActivityNavigationId")}}Object(f.a)(uc,"PackageManager",null,[0,1]);const hn=ka=>{const Va=K.a.instance.Ra(414),yb=window.performance.now();Va.execute(Yb=>{Yb.Ty(Bk.a.comments,
"CPMain",yb,!0)});za.a.instance.Mc(new uc,0,ka)};var Mn=d(984);class vm{isComment(ka){return Oc.a.isComment(ka)}ode(ka){return Oc.a.ode(ka)}ZXf(ka){return Oc.a.ZXf(ka)}Meg(ka,Va){Oc.a.Meg(ka,Va)}Qeg(ka,Va){Oc.a.Qeg(ka,Va)}Mtf(ka){return Oc.a.Mtf(ka)}Ybb(ka){return cj.a.instance.Ybb(ka)}deleteComment(ka,Va){Oc.a.deleteComment(ka,Va)}e_d(ka,Va){Oc.a.e_d(ka,Va)}nxb(ka){Oc.a.nxb(ka)}ufa(ka,Va,yb){return Oc.a.ufa(ka,Va,yb)}OAa(ka,Va,yb){return Oc.a.OAa(ka,Va,yb)}olc(ka,Va){return Oc.a.olc(ka,Va)}D2c(ka,
Va,yb,Yb=null){return Oc.a.D2c(ka,Va,yb,Yb)}Ccc(ka,Va,yb,Yb){Oc.a.Ccc(ka,Va,yb,Yb)}WQd(ka,Va,yb,Yb){return Oc.a.WQd(ka,Va,yb,Yb)}get ZSb(){return Oc.a.ZSb}set ZSb(ka){Oc.a.ZSb=ka}bXb(ka,Va){Oc.a.bXb(ka,Va)}Akd(ka){Oc.a.Akd(ka)}gsg(ka){Oc.a.gsg(ka)}c8d(ka,Va){return Oc.a.c8d(ka,Va)}Neg(ka,Va){Oc.a.Neg(ka,Va)}Peg(ka,Va){Oc.a.Peg(ka,Va)}kme(ka,Va,yb,Yb,oc,Vc){Oc.a.kme(ka,Va,yb,Yb,oc,Vc)}$Af(ka,Va){Oc.a.$Af(ka,Va)}aid(ka,Va,yb,Yb){return Oc.a.aid(ka,Va,yb,Yb)}fid(ka,Va,yb,Yb){return Oc.a.fid(ka,Va,yb,
Yb)}}Object(f.a)(vm,"CommentEditorProxy",null,[596]);class xl{constructor(){this.Z=null}get H1b(){return null!=this.i5g?this.i5g:this.i5g=(()=>this.Z.Ra(785))()}get Gcb(){return null!=this.n2g?this.n2g:this.n2g=(()=>this.Z.resolve(414))()}m2(ka){this.Gcb.m2(Bk.a.comments,ka,!0)}get name(){return"WordEditor.CommentsInteractive"}uc(ka){this.Z=ka;this.m2("CIPConfigStart");ka.ia("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new vm).as(762).ha();this.m2("CIPConfigEnd")}init(){this.m2("CIPInitStart");
this.Z.resolve(23).Qr.continueWith(()=>{this.No();this.m2("CIPInitEnd")})}No(){this.F3m()}dispose(){}F3m(){Qb.a.UZa(Oc.a.Qeg);Mn.a.IRd(Oc.a.Neg);Mn.a.JRd(Oc.a.Peg);Mn.a.S1k(Oc.a.LYn);this.H1b.execute(Va=>{Va.wgf(Oc.a.bXb)});const ka=tb.a.ff.Pl;ka.jf(39).ro(Oc.a.Meg);Mn.a.i1k(Oc.a.PXn);Mn.a.a1k(Oc.a.dXn);Ge.a.isEnabled&&ka.jf(12).ly(Oc.a.Oik)}}Object(f.a)(xl,"PackageManager",null,[0,1]);const kk=ka=>{const Va=K.a.instance.Ra(414),yb=window.performance.now();Va.execute(Yb=>{Yb.Ty(Bk.a.comments,"CIPMain",
yb,!0)});za.a.instance.Mc(new xl,0,ka)};var Hl=d(2161),al=d(104),Ng=d(1660);class Ep{constructor(ka,Va,yb,Yb,oc,Vc,yd){this.eTa=ka;this.iea=Va;this.I$=yb;this.$c=Yb;this.cyk=oc;this.I1e=Vc;this.PFb=yd;Ng.a.R1k((Jd,Pd)=>{this.V_k(Pd.graphNode,Pd.Xwl)});Ng.a.w2k((Jd,Pd)=>{this.HDl(Pd.graphNode,Pd.Lul)})}g7d(){var ka=this.cyk();const Va=this.$c.Vl();Va.set(ka);if(this.iea.ktp(Va))return Va;Va.set(ka);Object(al.a)().iS(Va);ka=this.I$.VLl(Va.currentNode);Va.Yj(ka);return Va}w9d(ka){const Va=this.g7d();
let yb=null;this.iea.m4d(Va,Yb=>{this.I$.GIi(Yb)===ka&&(yb=Yb);return!yb});return yb}CIi(ka){const Va=this.g7d();let yb=null;this.iea.m4d(Va,Yb=>{this.I$.tlc(Yb)===ka&&(yb=Yb);return!yb});return yb}gaj(ka,Va,yb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",ka,Va,yb)}HIi(){const ka=this.g7d(),Va=[];this.iea.m4d(ka,yb=>{Va.push(this.I$.GIi(yb));return!0});return Va}uob(ka,Va){if(!Va.length)return this.PFb&&a.ULS.sendTraceTag(42812043,
3003,10,"A task must always have at least one history record."),null;const yb=this.g7d(),Yb=ra.a.create().toString(),oc=new Ui.a;for(let Vc of Va)oc.add(Vc),this.gaj(Vc.type,Yb,Vc.completion);Va=this.eTa.Dyg(oc);this.I$.uob(yb.currentNode,Yb,ka,Va);this.I1e();return Yb}uf(ka){(ka=this.w9d(ka))?(this.I$.uf(ka),this.I1e()):this.PFb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}tlc(ka){ka=this.w9d(ka);return ka?this.I$.tlc(ka):(this.PFb&&a.ULS.sendTraceTag(42812044,
3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}DIi(ka){return this.I$.tlc(ka)}FIi(ka){ka=this.w9d(ka);if(!ka)return this.PFb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;ka=this.I$.cOf(ka);return this.eTa.Sgc(ka).toArray()}i8k(ka,Va){if(!Va.length)return this.PFb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const yb=this.w9d(ka);if(!yb)return this.PFb&&a.ULS.sendTraceTag(42812046,
3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const Yb=this.I$.cOf(yb),oc=this.eTa.Sgc(Yb);for(let Vc of Va)oc.add(Vc),this.gaj(Vc.type,ka,Vc.completion);ka=this.eTa.Dyg(oc);ka!==Yb&&(this.I$.e0o(yb,ka),this.I1e());return!0}V_k(ka,Va){if(Va=this.CIi(Va)){const yb=this.$c.Vl();yb.set(ka);this.I$.Yb(Va.clone(),this.I$.q3l(Va,yb))}}Ozj(ka,Va,yb){if(Va.mb(ka))return Va.K(ka);const Yb=ra.a.create().toString();Va.add(ka,Yb);yb&&this.PFb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");
return Yb}HDl(ka,Va){const yb=new nd.a;var Yb=this.$c.Vl();Yb.set(ka);Yb.Ub(38)&&this.iea.m4d(Yb,oc=>{const Vc=this.I$.tlc(oc);void 0!==Vc&&null!==Vc&&yb.add(Vc,oc);return!0});for(let oc of Va)if(ka=null,({value:ka}=yb.Ec(oc.key,ka)).returnValue)if(oc.value===oc.key)ka=this.CIi(oc.key),this.I$.T0o(ka,parseInt(oc.key));else{ka=this.I$.cOf(ka);if(!ka||""===ka){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}ka=this.eTa.Sgc(ka);
Yb=new Na.a;for(let Vc=0;Vc<ka.length;Vc++){if(ka.K(Vc).commentId){const yd=Number.parseInvariant(ka.K(Vc).commentId);Va.mb(yd)?ka.K(Vc).commentId=Va.K(yd).toString():ka.K(Vc).commentId=null}ka.K(Vc).recordId=this.Ozj(ka.K(Vc).recordId,Yb,!1);-1===ka.K(Vc).type&&(ka.K(Vc).undoId=this.Ozj(ka.K(Vc).undoId,Yb,!0))}this.uob(oc.value,ka.toArray())}}static Ts(){return new Ep(K.a.instance.resolve(786),K.a.instance.resolve(787),K.a.instance.resolve(788),new Ej.a,()=>ng.StaticActiveAppFrame.za().kb.ed,()=>
{K.a.instance.Ra(72).execute(ka=>{ka.editHappened()})},!0)}}Object(f.a)(Ep,"TaskActor",null,[700]);var nm=d(1093);class Mf{create(){return new nm.a}}Object(f.a)(Mf,"TaskContentNodeFactory",null,[433]);var Cm=d(1052);class Yg{create(){return new Cm.a}}Object(f.a)(Yg,"TaskNodeFactory",null,[433]);class Uj{constructor(ka,Va,yb,Yb,oc,Vc){this.iea=ka;this.Qc=Va;this.$c=yb;this.wQk=Yb;this.zQk=oc;this.O4b=Vc}rKl(ka,Va,yb){const Yb=this.zQk.create(xd.a.Ezc);Yb.setValue(Sa.a.taskId,ka);Yb.setValue(Sa.a.M1b,
Va);Yb.setValue(Sa.a.DEa,yb);return Yb}vlc(ka){const Va=this.Qc.Lc(4);Va.Ab(ka);this.O4b();return Va}GIi(ka){return this.iea.eUb(ka)?ka.getValue(Sa.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}tlc(ka){return this.iea.eUb(ka)?ka.hasProperty(Sa.a.M1b)?ka.getValue(Sa.a.M1b):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}cOf(ka){return this.iea.eUb(ka)?ka.getValue(Sa.a.DEa):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),null)}VLl(ka){if(7!==
ka.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const Va=this.vlc(ka);try{const yb=this.wQk.create(xd.a.KOa),Yb=this.$c.Vl();Yb.set(ka);Yb.o6(yb,38,Uj.kkp);return yb}finally{Va&&Va.dispose()}}uob(ka,Va,yb,Yb){if(!this.iea.I1f(ka))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const oc=this.vlc(ka);try{const Vc=this.rKl(Va,yb,Yb),yd=this.$c.Vl();yd.set(ka);yd.o6(Vc,1,new qb.a(ra.a.Wza(yb.toString()),1));return Vc}finally{oc&&oc.dispose()}}uf(ka){if(this.iea.eUb(ka))if(ka.anchor&&
ka.anchor.Lr){var Va=ka.anchor.Lr.gt.node;if(this.iea.I1f(Va)){var yb=this.vlc(Va);try{const Yb=this.$c.Vl();Yb.set(Va);Yb.Yj(ka.anchor.node);Yb.Tg()}finally{yb&&yb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}e0o(ka,Va){if(this.iea.eUb(ka)){var yb=this.vlc(ka);try{ka.setValue(Sa.a.DEa,Va)}finally{yb&&
yb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}T0o(ka,Va){if(this.iea.eUb(ka)){var yb=this.vlc(ka);try{const Yb=ka.hasProperty(Sa.a.M1b)?ka.getValue(Sa.a.M1b):null;void 0===Yb||null===Yb||Yb===Va?ka.Zg(Sa.a.M1b,Va):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{yb&&yb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}q3l(ka,Va){if(!Va.pv(38)){const yb=this.$c.Vl();yb.set(ka);yb.vb(71);yb.fd(71);ka=Jb.b(yb.currentNode,
ka.Lj().Ic,!0);Va.Wf(ka,38)}return Va.Ub(38)}Yb(ka,Va){if(this.iea.I1f(Va)){var yb=this.vlc(Va);try{const Yb=this.$c.Vl();Yb.set(Va);Yb.Wf(ka,1)}finally{yb&&yb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Ts(){return new Uj(K.a.instance.resolve(787),new Gf.a,new Ej.a,new Mf,new Yg,()=>{Yi.a.Pm.kb.ed.nH.eaa(10)})}}Uj.kkp=new qb.a(ra.a.Af("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),1);Object(f.a)(Uj,"TaskEditor",null,[603]);class Zm{constructor(ka,Va){this.Ez=ka;this.PGb=
Va}eUb(ka){return!!ka&&72===ka.type}hvn(ka){return!!ka&&71===ka.nf}I1f(ka){return!!ka&&71===ka.type}ktp(ka){ka.set(this.Ez.value);this.PGb.iS(ka);return!!ka.Ub(38)}m4d(ka,Va){if(ka&&Va)if(this.hvn(ka))for(var yb=!0,Yb=ka.Ub(1);yb&&Yb;)this.eUb(Yb)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",Yb.type),yb=Va(Yb),Yb=ka.Nf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",ka.nf);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Ts(){return new Zm(new kb.a(()=>
ng.StaticActiveAppFrame.za().kb.ed),Object(al.a)())}}Object(f.a)(Zm,"TaskNavigator",null,[602]);class Tk{constructor(){this.Z=null}get name(){return"WordEditor.Tasks"}init(){this.Z.resolve(23).Qr.continueWith(()=>{this.No()})}dispose(){}uc(ka){this.Z=ka;ka.ia("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new Hl.a).as(786).ha();ka.ia("WordEditor.Tasks.TaskNavigator",()=>Zm.Ts()).as(787).ha();ka.ia("WordEditor.Tasks.TaskEditor",()=>Uj.Ts()).as(788).ha();ka.ia("WordEditor.Tasks.TaskActor",()=>
Ep.Ts()).as(1195).ha()}No(){this.Z.resolve(23).isFeatureEnabled(106)}}Object(f.a)(Tk,"TasksPackage",null,[0,1]);var Wo=d(93),fo=d(1656),Vn=d(413),po=d(107);class Rp{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(f.a)(Rp,"TaskPaneGroupAppProps",null,[]);var dq=d(182);class Rl{static pyl(ka,Va){km.FocusManager.BM()&&
(on.a.instance.SHa(ka,Va,!1),dq.a.instance.SHa(ka,Va,!1),y.AFrameworkApplication.ta.Jy.IW(ka))}}Object(f.a)(Rl,"ReactTaskPaneManagerUtils",null,[]);var yl=d(174),fj=d(369);class Fp{constructor(){this.type=null}}Object(f.a)(Fp,"SampleTaskPaneProps",null,[]);var Sl=d(1658),Gp=d(108);class th{constructor(){this.entry=null;this.show=!1}}Object(f.a)(th,"AnimationBatchEntry",null,[]);var Vq=d(375),tt=d(1657),fp=d(169);class Dk{constructor(){this.Yyh=[];this.Zyh=[];this.xqa={};this.pQa=this.oQa=null;this.mOd=
!1;this.Q1=null;this.uLd=this.sGd=0;this.JDc=[];this.eYe=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.Ntb;this.ay=!1}initialize(){this.mOd=!1;(this.ay=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.A3)&&this.Auf()}Cuf(ka,Va,yb,Yb){Va=this.y9d(Va);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.Auf();const oc=document.createElement("div");oc.id=Va;oc.className=Dk.UHp;oc.style.width="0";this.eYe||(this.jXk(yb,Va,oc),this.xqa[Va]=ka.Cuf(Va,yb,Yb,oc));return oc}Auf(){this.mOd||
this.W2o()}jXk(ka,Va,yb){let Yb=null,oc=null;0===ka?(Yb=this.oQa,oc=this.Yyh):1===ka&&(Yb=this.pQa,oc=this.Zyh);if(Yb){ka=!1;for(let Vc=0;Vc<oc.length;Vc++)if(!ka)oc[Vc]===Va&&(ka=!0);else if(oc[Vc]in this.xqa){this.fdn(Yb,yb,this.xqa[oc[Vc]]);return}Yb.appendChild(yb)}}fdn(ka,Va,yb){ka.insertBefore(Va,yb.element)}iXl(ka){ka=this.y9d(ka);if(ka in this.xqa){const Va=this.xqa[ka];Va.element.parentNode.removeChild(Va.element);delete this.xqa[ka]}}JVj(ka){ka=this.y9d(ka);ka in this.xqa&&(ka=this.xqa[ka])&&
!ka.isVisible&&(this.VUj(ka,!0),this.KQh(ka.position,!0,this.DZh(ka,!0)),1===ka.position&&1<la.a.count(this.xqa)&&this.XIn())}N1m(ka){ka=this.y9d(ka);ka in this.xqa&&(ka=this.xqa[ka])&&ka.isVisible&&(this.VUj(ka,!1),this.KQh(ka.position,!1,this.DZh(ka,!1)))}hgc(ka){if(this.Q1)return this.Q1;const Va=document.createElement("div");document.body.appendChild(Va);Va&&(this.Q1=new fo.a(Va,ka));return this.Q1}VUj(ka,Va){ka.element&&(ka.isVisible=Va,this.JDc.push(Object.assign(new th,{entry:ka,show:Va})));
0===ka.position?this.sGd+=Va?1:-1:this.uLd+=Va?1:-1;1===this.JDc.length&&window.setTimeout(Object(Gp.a)(this,this.Yep,"startPaneAnimation"),0);this.ay&&ka.element&&ka.element.parentNode&&(0===ka.position&&!this.sGd||1===ka.position&&!this.uLd?(ka.element.parentNode.style.minHeight="0px",ka.element.parentNode.style.height="0px",ka.element.parentNode.style.overflow="hidden"):(ka.element.parentNode.style.minHeight="",ka.element.parentNode.style.height="",ka.element.parentNode.style.overflow=""))}Yep(){this.Kmj();
var ka=kd.where(kd.asEnumerable(this.JDc),oc=>0===oc.entry.position),Va=kd.where(ka,oc=>!oc.show);if(kd.any(Va)&&kd.Ct(Va)!==kd.Ct(ka)){for(var yb of Va)yb.entry.element.style.width="0";ka=kd.where(ka,oc=>oc.show)}Va=kd.where(kd.asEnumerable(this.JDc),oc=>1===oc.entry.position);yb=kd.where(Va,oc=>!oc.show);if(kd.any(yb)&&kd.Ct(yb)!==kd.Ct(Va)){for(var Yb of yb)Yb.entry.element.style.width="0";Va=kd.where(Va,oc=>oc.show)}for(const oc of kd.concat(ka,Va))ka=oc.entry,fp.WacAirSpace.vY(ka.element,Vq.a.ADg),
Yb=new tt.a(ka.element),oc.show?Yb.Uhf(0,ka.width):Yb.Uhf(ka.width,0),fp.WacAirSpace.animate(Yb,null,null);this.JDc.length=0}Kmj(){}DZh(ka,Va){let yb=ka.width;ka=0===ka.position?this.sGd:this.uLd;if(Va&&1===ka||!Va&&!ka)yb+=1;return yb}W2o(){this.mOd||(this.oQa||(this.oQa=document.createElement("div"),this.oQa.id=Dk.SHp,this.oQa.className=Dk.ybk,Sys.UI.DomElement.addCssClass(this.oQa,"alignLeft"),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.vba&&Sys.UI.DomElement.addCssClass(this.oQa,
"FlexBoxLayout"),this.eYe&&Sys.UI.DomElement.addCssClass(this.oQa,Dk.vbk),this.OOh(0,this.oQa)),this.pQa||(this.pQa=document.createElement("div"),this.pQa.id=Dk.THp,this.pQa.className=Dk.ybk,Sys.UI.DomElement.addCssClass(this.pQa,"alignRight"),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.vba&&Sys.UI.DomElement.addCssClass(this.pQa,"FlexBoxLayout"),this.eYe&&Sys.UI.DomElement.addCssClass(this.pQa,Dk.vbk),this.OOh(1,this.pQa)),this.$oj(this.oQa,this.pQa),this.mOd=!0)}$oj(){}VHa(ka,Va){Array.add(1===
ka?this.Zyh:this.Yyh,Va)}y9d(ka){return ka+"-Entry"}XIn(){let ka=0;for(const Va of la.a.LR(this.xqa)){const yb=Object(W.a)(1927,this.xqa[Va]);yb&&yb.isVisible&&1===yb.position&&ka++}2===ka?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<ka&&a.ULS.sendTraceTag(595179605,320,50,ka+" simultaneous panes open")}}Dk.SHp="WACTaskPaneContainerLeft";Dk.THp="WACTaskPaneContainerRight";Dk.ybk="WACTaskPaneContainer";Dk.UHp="WACTaskPaneEntry";Dk.vbk="WACReactTaskPaneContainer";Object(f.a)(Dk,
"BaseTaskPaneManager",null,[1928]);var Nn=d(634),Em=d(302);class Om extends Dk{constructor(ka,Va){super();this.pMc=this.oMc=this.Kcf=this.Jcf=0;this.Oqi=()=>{Object(Sc.a)().forEach(yb=>{yb.q4d()})};this.ga=ka;this.Gnh=Va}OOh(ka,Va){const yb=ng.StaticActiveAppFrame.za().nG;yb.parentNode&&(ka?1===ka&&(this.ay?((ka=Object(Em.a)("FarPane"))&&ka.appendChild(Va),Va.classList.add("regionComposer"),ng.StaticActiveAppFrame.za().fL.registerBoundingWindowRectsChanged("farPane",(Yb,oc)=>{"DP"===oc||3===oc?Va.classList.add("DL"):
Va.classList.remove("DL")})):yb.parentNode.insertBefore(Va,yb.nextSibling)):this.ay?((ka=Object(Em.a)("NearPane"))&&ka.appendChild(Va),Va.classList.add("regionComposer")):yb.parentNode.insertBefore(Va,yb))}KQh(ka,Va,yb){this.ay||(Va=Va?yb:-yb,ka?this.pMc+=Va:this.oMc+=Va)}Kmj(){if(!this.ay){var ka=ng.StaticActiveAppFrame.za().nG;fp.WacAirSpace.vY(ka,Vq.a.ADg);if(this.Jcf!==this.oMc){const Va=new Nn.a(ka);Va.y6k(this.Jcf,this.oMc,this.Gnh);fp.WacAirSpace.animate(Va,null,this.Oqi);this.Jcf=this.oMc}this.Kcf!==
this.pMc&&(ka=new Nn.a(ka),ka.z6k(this.Kcf,this.pMc,this.Gnh),fp.WacAirSpace.animate(ka,null,this.Oqi),this.Kcf=this.pMc)}}}Object(f.a)(Om,"TaskPaneManager",Dk,[]);var Il=d(155);class Fm extends Om{get fYi(){null==this.eJe&&(this.eJe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",!1):!1);return this.eJe}constructor(ka,Va){super(ka,Va);this.LZ=ue.KeyInputManager.lc(Wo.a.wz,0);this.MZ=ue.KeyInputManager.lc(Wo.a.wz,
4);this.K6e=this.$Lc=null;this.eth="AccCheckerTaskPane";this.sa=new bb.a;this.isPaneOpen=!1;this.eJe=this.WRe=null;this.VHa(0,"SampleTaskPane");this.VHa(0,Il.a.Upb);this.VHa(1,Il.a.fbl);this.VHa(1,"CustomTaskPane");this.VHa(1,Il.a.BWf);this.VHa(1,Kf.AFrame.zt);this.VHa(1,Kf.AFrame.BMh);this.VHa(1,Kf.AFrame.wMh);this.VHa(1,Il.a.w4d);this.VHa(1,Il.a.eZc);this.VHa(1,Il.a.V_c);this.HCk=(this.m9g=!!y.AFrameworkApplication.ta&&!!y.AFrameworkApplication.ta.Hb)&&y.AFrameworkApplication.ta.Hb.z0f;this.JBk=
Yi.a.Rpc;this.PBk=this.m9g&&y.AFrameworkApplication.ta.Hb.I$c;this.initialize();ka.fb(Lb.a.TDg,Eg.a.application,Fm.TDg,96)}get eve(){if(!ng.StaticActiveAppFrame.za()||!ng.StaticActiveAppFrame.za().nG)return null;this.K6e||(this.K6e=new fo.a(ng.StaticActiveAppFrame.za().nG,km.FocusManager.instance()));return this.K6e}Wb(){}$oj(ka,Va){const yb=Vn.a.instance,Yb=km.FocusManager.instance(),oc=po.EventHandlerManager.instance,Vc=this;Ud.UISurfaces.Ov().then(yd=>{Vc.$Lc=Vc.hgc(Yb);let Jd;yd.renderTaskPaneGroups(ka,
Va,(Jd=new Rp,Jd.middleContainer=ng.StaticActiveAppFrame.za().nG,Jd.onTabStripFocus=()=>{Yb.aF(Il.a.mzc)},Jd.onOpen=(Pd,Qe)=>{Vc.A0f(Pd)&&Rl.pyl(Pd,Qe);oc.Kef(Qe,"focus",Vc.zGi(Pd,Yb),!0);var Cf=Vc.XZi(Pd),Wf=yd.selectors.getTabbedTaskPaneCount(Cf?1:2);Cf=Cf?Il.a.VBe:Il.a.mzc;1===Wf&&(yb.S$(Cf),this.isPaneOpen=!0,this.zyj({isPaneOpen:this.isPaneOpen,O1b:Qe}));Qe=Vc.eKf(Pd);if(Wf=Yb.ie(Qe))Wf.LWc=Cf,Vc.J7o(Pd)&&(Wf.qt(Vc.LZ),Wf.qt(Vc.MZ)),yb.BYi(Qe)&&yb.Cx(Qe);this.fYi&&this.i2d&&this.i2d.dismissFloatie(!0)},
Jd.onClose=(Pd,Qe)=>{Vc.A0f(Pd);const Cf=Vc.XZi(Pd),Wf=Cf?Il.a.VBe:Il.a.mzc;yd.selectors.getTabbedTaskPaneCount(Cf?1:2)||(yb.Cx(Wf),this.isPaneOpen=!1,this.zyj({isPaneOpen:this.isPaneOpen,O1b:Qe}));oc.jsg(Qe,"focus",Vc.zGi(Pd,Yb),!0);this.fYi&&this.i2d&&this.i2d.dismissFloatie(!0)},Jd.setFocusCallback=(Pd,Qe)=>{Vc.A0f(Pd)&&Qe&&(Pd=Yb.ie(Vc.eKf(Pd)),Pd.ztl(),Pd.Pja(Qe))},Jd.onOverflowMenuOpen=()=>{if(Vc.$Lc)Vc.$Lc.onMenuOpen()},Jd.onOverflowMenuClose=()=>{if(Vc.$Lc)Vc.$Lc.onMenuClose()},Jd.onShow=
(Pd,Qe)=>{2===Qe&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{Yb.Eg(Pd)},0)})},Jd.onHide=(Pd,Qe,Cf)=>{Cf&&1!==Qe&&Yb.Eg(Yb.bX)},Jd.onResizeStart=()=>{if(ng.StaticActiveAppFrame.za()&&(ng.StaticActiveAppFrame.za().nG.className=rl.a.wOg,Vc.eve))Vc.eve.onMenuOpen()},Jd.onResizeEnd=()=>{if(ng.StaticActiveAppFrame.za()&&(yl.a.A1i()||(ng.StaticActiveAppFrame.za().nG.className+=" "+ng.StaticActiveAppFrame.za().Z_h),Vc.eve))Vc.eve.onMenuClose()},Jd));this.Ina(Il.a.mzc,Yb,Va,Vc);this.Ina(Il.a.VBe,
Yb,ka,Vc);return null})}Ina(ka,Va,yb,Yb){const oc=Va.ie(ka);oc.parent=Kf.AFrame.Kq;oc.YL=!0;on.a.instance.SHa(ka,yb,!1);dq.a.instance.SHa(ka,yb,!1);ka=new fj.DOMFocusListing(()=>yb);ka.un(3);ka.un(2);ka.un(4);ka.un(1);Va.gra(()=>yb,oc,ka).BP=!0;oc.qt(Yb.LZ);oc.qt(Yb.MZ)}eKf(ka){return ka===this.eth?Il.a.DLh:ka}zGi(ka,Va){return()=>{Va.aF(this.eKf(ka))}}J7o(ka){return ka===this.eth?!1:!0}sln(ka){return ka===Il.a.Upb}A0f(ka){return this.sln(ka)||ka===Il.a.DLh||0<=ka.indexOf("AppForOfficePanel")||ka===
Il.a.w4d||ka===Il.a.BWf&&this.HCk||ka===Il.a.eZc&&this.JBk||ka===Il.a.V_c&&this.PBk||ka===Sl.a.gPb?!0:!1}XZi(ka){return ka===Il.a.Upb||"SampleTaskPane"===ka}static gPm(){return new Fm(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static TDg(ka,Va,yb,Yb,oc){if(1===yb)return 32;Ud.UISurfaces.Ov().then(Vc=>{Vc.showTaskPane(oc,Object.assign(new Ym.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new Fp,{type:"SampleTaskPaneProps"})}));return null});return 32}e6a(ka){this.sa.addHandler("onPaneToggle",
ka)}Wkd(ka){this.sa.removeHandler("onPaneToggle",ka)}zyj(ka){this.sa.raiseEvent("onPaneToggle",ka)}get i2d(){this.WRe||(this.WRe=K.a.instance.Oa(789));return this.WRe}}Object(f.a)(Fm,"TaskPaneManager",Om,[600]);class Gn{constructor(){this.DW=null}get name(){return"WordEditor.TaskPaneManager"}uc(){}init(){this.DW=Fm.gPm();this.DW.Wb();ng.StaticActiveAppFrame.za().lfb=this.DW}dispose(){}}Object(f.a)(Gn,"PackageManager",null,[0,1]);d.d(J,"a",function(){return m})},2014:function(I,J,d){I=d(0);var m=d(2),
f=d(123),a=d(46),l=d(236),w=d(19),z=d(16),x=d(85),u=d(196),v=d(41),F=d(29),y=d(13),G=d(38),C=d(5),H=d(8),K=d(82),R=d(308),E=d(79),L=d(11),O=d(6),V=d(105),Z=d(127),W=d(30),P=d(227),S=d(90),aa=d(228),Y=d(15),X=d(74),ca=d(149),fa=d(881),ja=d(3),ra=d(81),ya=d(61),Ha=d(119),Wa=d(101),Ma=d(35),ua=d(484),Ka=d(451),za=d(36),Fa=d(21),ea=d(49),la=d(166),Na=d(20),Aa=d(26),wa=d(252),va=d(7),Pa=d(1029),Ta=d(1490),kb=d(1520),gb=d(303),tb=d(238),hb=d(77),Xa=d(486),$a=d(520);class La extends gb.a{constructor(pb,
vb,xb,Bb,jc,xc,Qc,fd){super();this.WDh=this.wx=null;this.init(pb);this.sm("FormattingViewOperation");this.Asb(m.AFrameworkApplication.va,vb,Bb,jc,xc);this._context=xb;this.Egb=0;this.Ns=!0;this.Cwk=Qc;this.ao=fd}get lfa(){return this.ao.instance}run(){const pb=this._context.view;var vb=null;pb.ue&&(vb=pb.lb);if(vb){var xb=vb.gb.currentSelection,Bb=!kb.a.Snc(this.actionId);!xb||La.sg.Z0f(xb,Bb)?(La.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.$G}),this.Ns=!1):this.lfa&&this.lfa.ioc(xb)?(La.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.C8a}),
this.Ns=!1):Object(la.a)().bFa(va.ParagraphReader.IX,vb.Ng)&&(La.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.cR}),this.Ns=!1)}else La.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.Aga}),this.Ns=!1;1!==this.behavior&&this.Ns||(this.Ns&&(xb=vb.gb.currentSelection,1===vb.gb.length&&1===xb.length&&za.a.gm(xb.Qa)&&X.b(xb.Qa)&&(La.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.OWc}),this.Ns=!1)),(xb=this.Ns)&&this.actionId===ja.a.J8&&((xb=Array.from(vb.gb.currentSelection).some(V.FormattingReader.Crf))||La.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.dzf})),this.us=
xb?32:8,this.Egb=3);this.Egb||(tb.a.mark(5730),this.WDh=$a.SelectionReferenceFactory.instance.VMb(),xb=vb.gb.currentSelection.Qa,this.wx=new Ma.GraphTransaction(15),this.wx.Ab(xb.node),this.wx.Ei=this.actionId,this.Egb=1);if(1===this.Egb){this.aD||this.Ind(this._context.Ok);if(1===this.edb())return;this.Egb=2}if(2===this.Egb){if(this.actionId===ja.a.J8)if(vb=vb.Ng,vb.Uw)for(xb=0;xb<vb.length;xb++)Bb=vb.getContext(xb),this.X4j(Bb);else this.X4j(vb);Xa.a.Srf&&this.drp(this.actionId,this.td);this.WDh.gva(this.actionId===
ja.a.yY||this.actionId===ja.a.vza);(vb=Object(K.a)(13,this.td))&&!vb.P_a||hb.FocusManager.instance().Eg(pb.CL);this.wx.dispose();this.wx=null;Na.StaticActiveAppFrame.za().Fe();tb.a.mark(5731);this.Egb=3;this.us=32}3===this.Egb&&(this.Cwk.process(this.actionId,this._context,this.behavior,this.response),this.zva())}drp(pb,vb){const xb={};xb.FormattingActionId=pb;xb.FormattingActionData=vb;8===this.ga.Pb(ja.a.GSd,2,xb)&&H.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",
pb,vb)}X4j(pb){(za.a.Vw(pb)||za.a.rl(pb))&&Ha.a.lQ.Hha(pb.node)}static get sg(){return wa.a.instance}static get Bc(){return u.a.instance}}Object(I.a)(La,"FormattingViewOperation",gb.a,[]);var bb=d(1019),Gb=d(47),qb=d(40);d.d(J,"a",function(){return cb});const Sa=new Set([ja.a.h3,ja.a.y4,ja.a.oE,ja.a.wIa,ja.a.xIa,ja.a.R6a,ja.a.sza,ja.a.S6a]);class cb{constructor(pb,vb,xb=null,Bb,jc,xc,Qc,fd,Ac,Nb,ib,Rb,ic){this.kpiName="ChangeCaseCommandUsage";this.Kaa="wwaengidc";this.nub=new Map;this.$th=new Set;
this.rPb=()=>new fa.a(2);this.rxj=(kc,Jb,ec,qa,sa)=>{qa=!0;Jb.contextId!==L.a.view&&(qa=!1);if(1===ec&&!qa)return 8;if(kc===ja.a.Kid)kc=sa.formatting,sa=sa.AEg;else{if(!Jb.view||!Jb.view.ue)return 2;Jb=Jb.view;if(!Jb.lb||!Jb.lb.gb.currentSelection)return 8;kc=sa;sa=Jb.lb.gb}this.czl(sa,kc);return 32};this.Bif=(kc,Jb,ec,qa,sa,ab)=>new La(kc,Jb,ec,qa,sa,ab,this.hxk,cb.wy());this.ESd=(kc,Jb,ec,qa,sa)=>{var ab,eb,fb;let Cb=!0,lc=Jb;const bc=!kb.a.Snc(kc);Jb.contextId!==L.a.Fd&&Jb.contextId!==L.a.Vc?Cb=
!1:(cb.sg.qba(lc,!1,bc)&&(cb.Bc.$b(ra.a.Vn,{["Reason"]:ya.a.$G}),Cb=!1),cb.wy()&&cb.wy().instance&&cb.wy().instance.KX(lc)&&(Cb=!1),Cb&&za.a.gm(Jb)&&X.b(lc)&&(cb.Bc.$b(ra.a.Vn,{["Reason"]:ya.a.OWc}),Cb=!1),va.ParagraphReader.IX(Jb)&&(cb.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.cR}),Cb=!1));if(1===ec||!Cb)return Cb?32:8;if(Jb.contextId===L.a.Vc)return 2;(Jb=null===(ab=this.Ip)||void 0===ab?void 0:ab.q8d(lc))&&(lc=Jb);this.H7o(kc)&&(ab=za.a.p2b(lc),za.a.qf(ab)||(lc=ab));ab="boolean"===typeof sa&&sa;Jb=!1;(null===
(eb=this.xda)||void 0===eb?0:eb.annotateRange)&&(null===(fb=this.xda)||void 0===fb?0:fb.Woc(lc.node))&&(Jb=this.LW(lc,kc,sa,ab));Jb&&kc!==ja.a.J8||cb.OD.LW(lc,Za=>{this.ixc(Za,kc,sa,lc.cpEnd)},ab);lc.node.Jq&&(eb=[Object.assign(new F.a,{name:"Source",string:"CharacterFormatting"})],v.a("TOCFormatting",!0,void 0,eb));this.Dhn(kc)&&this.gVd(lc,kc);qa&&Ta.a.Tzb&&(qa.Ft|=Ta.a.Nqb(lc.node));return 32};this.Qrd=(kc,Jb,ec)=>1!==ec&&2===ec?(this.nub.set("Source","Shortcut"),kc=Jb.node.characterData.substr(Jb.cpBegin,
Jb.cpEnd-Jb.cpBegin),cb.r1f(kc,0,kc.length)?this.gVd(Jb,ja.a.wIa):cb.wun(kc,kc.length)?this.gVd(Jb,ja.a.sza):this.gVd(Jb,ja.a.xIa)):32;this.Dnb=(kc,Jb,ec)=>{let qa=!0;kc=!kb.a.Snc(kc);Jb.contextId!==L.a.Fd&&Jb.contextId!==L.a.Vc?qa=!1:(cb.sg.qba(Jb,!1,kc)&&(cb.Bc.$b(ra.a.Vn,{["Reason"]:ya.a.$G}),qa=!1),qa&&za.a.gm(Jb)&&X.b(Jb)&&(cb.Bc.$b(ra.a.Vn,{["Reason"]:ya.a.OWc}),qa=!1),qa&&va.ParagraphReader.IX(Jb)&&(cb.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.cR}),qa=!1));if(1===ec||!qa)return qa?32:8;Jb=Jb.node;this.Dv.XLb(Jb,
!1);Jb.Jq&&(Jb=[Object.assign(new F.a,{name:"Source",string:"ClearFormatting"})],v.a("TOCFormatting",!0,void 0,Jb));return 32};this.JVc=(kc,Jb,ec,qa,sa)=>{kc={};kc[bb.a.CPa]=6168;kc[bb.a.BPa]=6169;const ab=Jb.view;var eb=null;ab.jj&&(eb=ab);var fb=!0;let Cb=32;eb&&(eb=eb.lb.gb.currentSelection)&&(cb.sg.Z0f(eb)?(cb.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.$G}),Cb=8,fb=!1):1===ec&&(Cb=32,fb=!1));fb&&(fb=new Ma.GraphTransaction(1===ec?3:15),fb.Ab(ab.root),Cb=bb.a.Iua(ja.a.Dnb,Jb,ec,qa,sa,kc,12),fb.dispose());
return Cb};this.Jif=(kc,Jb,ec,qa,sa)=>{var ab,eb=!0,fb=32;const Cb=!kb.a.Snc(kc);Jb.contextId!==L.a.Vc?eb=!1:cb.sg.qba(Jb,!1,Cb)&&(cb.Bc.$b(ra.a.Vn,{["Reason"]:ya.a.$G}),eb=!1);if(1===ec||!eb)return eb?32:8;ec=Jb.node;kc===ja.a.oE&&(cb.Ll.LVc(ec),this.Dv.r3h(ec),eb=this.hy.MF(ec).mh(this.hy.wordStyleIdNormal),this.hw.gQ(eb,ec,!0));ec=cb.tk.ZNf(Jb);!ec&&(eb=null===(ab=this.Ip)||void 0===ab?void 0:ab.q8d(Jb))&&(Jb=eb,ec=Fa.SelectionFactory.Yo(Jb));if(ec)fb=ea.a.RMb(ec),fb=m.AFrameworkApplication.va.Pf(fb,
kc,2,!1,qa,sa);else{qa=Object(K.a)(13,sa);ab=V.FormattingReader.Us(Jb);if(!ab)return 16;ab=ab.cache;switch(kc){case ja.a.font:cb.Opi();if(qa&&qa.td){const {fontName:lc,Zha:bc,bold:Za,italic:Ib}=cb.hKf(qa.td);cb.tk.uxe(lc);cb.tk.XAg(bc);Object(ua.a)()&&(kc=1==Za,sa=1==Ib,kc||sa)&&(cb.tk.YN(kc),cb.tk.lA(sa))}break;case ja.a.gx:H.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");cb.tk.gx(sa);break;case ja.a.yva:cb.tk.gx(sa);this.VP.zTa(sa)||H.ULS.sendTraceTag(594899723,
340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.kka:cb.tk.kka();break;case ja.a.yY:H.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");cb.tk.gEa(sa);break;case ja.a.yca:cb.tk.gEa(sa);this.VP.zTa(sa)||H.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ja.a.vza:cb.tk.SVd();break;case ja.a.uC:cb.Opi();cb.tk.uC(qa.td);break;case ja.a.h3:kc=cb.tk.yI(y.a.fontSize,ab.fontSize);
cb.tk.uC(this.Je.h3(kc));break;case ja.a.y4:kc=cb.tk.yI(y.a.fontSize,ab.fontSize);cb.tk.uC(this.Je.y4(kc));break;case ja.a.bold:kc=cb.tk.yI(y.a.bold,ab.isBold);cb.tk.YN(!kc);break;case ja.a.lA:kc=cb.tk.yI(y.a.italic,ab.isItalic);cb.tk.lA(!kc);break;case ja.a.underline:kc=cb.tk.yI(y.a.underline,ab.isUnderline);cb.tk.M8(!kc);break;case ja.a.Aha:cb.tk.Aha(sa);break;case ja.a.superscript:kc=cb.tk.yI(y.a.superscript,ab.isSuperscript);cb.tk.Bva(!kc);break;case ja.a.subscript:kc=cb.tk.yI(y.a.subscript,ab.isSubscript);
cb.tk.gOa(!kc);break;case ja.a.strikethrough:kc=cb.tk.yI(y.a.strikethrough,ab.isStrikethrough);cb.tk.Gna(!kc);break;case ja.a.Eu:kc=cb.tk.yI(G.a.Eu,ab.isDoubleStrikethrough);cb.tk.pxe(!kc);break;case ja.a.oE:cb.tk.Cxb();break;case ja.a.J8:sa.hasProperty(y.a.iK)&&cb.tk.J8(sa.getValue(y.a.iK));sa.hasProperty(C.a.noProof)&&(kc=sa.getValue(C.a.noProof),cb.tk.NYo(kc));break;default:this.$th.has(kc)||(this.$th.add(kc),(sa=f.ActionManager.qea(kc))&&sa.length||(sa="UnknownAction"),H.ULS.sendTraceTag(523120736,
324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${sa} (${kc})`))}}Na.StaticActiveAppFrame.za().Fe();return fb};this.MW=(kc,Jb,ec,qa,sa)=>{qa=cb.Bc.wq(ja.a.EVo);var ab=!0;Jb.contextId!==L.a.Yc&&(ab=!1);if(1===ec||!ab)return ab?32:8;ec=Jb.node;qb.ListItemReader.De?ab=qb.ListItemReader.isListItem(ec):(ab=O.a.Za(ec),ab.Ld(),ab=ab.Gla(4),ab=!!ab&&cb.Nd.uta(ab));if(ab&&!Ha.a.Lqc)return 8;var eb=!va.ParagraphReader.textLength(ec);qa.properties.W("Action",kc.toString());qa.properties.W("ListContext",
ab.toString());qa.properties.W("IsEmptyParagraph",eb.toString());H.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",kc,ab,eb);ab=ec.ra.last;this.aCo(ec,kc);var fb=!!ab.formatting;const Cb=ec.getValue(C.a.uAa);eb=this.Qd.u8a(ec);fb=!fb&&Cb&&Cb.equals(a.a.nil)?new ca.a(ab,a.a.nil):eb.Mf(eb.Jb);this.ixc(eb,kc,sa,ab.cp);cb.Oj.T_b(ec,ab,Jb.cpBegin,Jb.cpEnd,fb,eb,cb.Pd.Ag);qa.end();return 32};this.Sqa=(kc,Jb,ec)=>{kc=!0;const qa=O.a.Za(Jb.node);qa.Ld();Jb.contextId===
L.a.Yc&&(qb.ListItemReader.De?qb.ListItemReader.isListItem(Jb.node):qa.Gla(4))||(cb.Bc.$b(ra.a.Vn,{["Reason"]:ya.a.C4f}),kc=!1);return(qb.ListItemReader.De?qb.ListItemReader.isListItem(Jb.node):cb.Nd.uta(qa.currentNode))?1!==ec&&kc?32:kc?32:8:8};this.Tua=(kc,Jb,ec,qa,sa)=>{kc=!0;Jb.contextId!==L.a.paragraph&&(kc=!1);if(1===ec&&!kc)return 8;ec=Jb.node;-1!==sa.si?sa.si!==va.ParagraphReader.Zy(ec)&&(sa.si=0):sa.si=va.ParagraphReader.Zy(ec);kc=this.Xp.Zqb(ec);sa.Iu?(!sa.w_m&&this.z_m(sa.Iu,kc)&&2===sa.Iu.specialIndentType&&
(sa.Iu.specialIndentType=0),sa.Iu.wsb===kc.wsb&&l.a.UBa(sa.Iu.$A,kc.$A)||(sa.Iu.$A=Number.MAX_VALUE),sa.Iu.xsb===kc.xsb&&l.a.UBa(sa.Iu.Sfa,kc.Sfa)||(sa.Iu.Sfa=Number.MAX_VALUE)):sa.Iu=kc;Jb=Object(la.a)().eVh(Jb.Ok);void 0!==Jb&&null!==Jb&&(Jb=Jb.node,void 0!==Jb&&null!==Jb&&(Jb=P.WordSectionNavigator.instance.jS(Jb),void 0!==Jb&&null!==Jb&&(Jb=cb.ig.Mv(Jb)-(cb.ig.vN(Jb)+cb.ig.wN(Jb)+Ha.a.fFa),kc.v7c=Jb-kc.$A,kc.u7c=Jb-kc.Sfa,sa.Iu.u7c=Math.min(sa.Iu.u7c,kc.u7c),sa.Iu.v7c=Math.min(sa.Iu.v7c,kc.v7c))));
Jb=this.qZ.fWa(ec);sa.jQ?(sa.jQ.beforeSpacing=cb.SQh(Jb.beforeSpacing,sa.jQ.beforeSpacing),sa.jQ.afterSpacing=cb.SQh(Jb.afterSpacing,sa.jQ.afterSpacing),sa.jQ.lineSpacing.unit===Jb.lineSpacing.unit&&l.a.UBa(sa.jQ.lineSpacing.value,Jb.lineSpacing.value)||(sa.jQ.lineSpacing.unit=0,sa.jQ.lineSpacing.value=0)):sa.jQ=Jb;Jb=new O.a;Jb.set(ec);Jb.vb(11);if(ec=Jb.fd(11))sa.isRtl=S.a.zo(ec);ec=cb.Nd.Tw(Jb);Jb=16;void 0!==ec&&null!==ec&&(Jb=ec.listType);sa.listType=cb.Bpm(sa.listType,Jb);sa.jz=16===sa.listType?
null:ec;return 32};this.Dmo=(kc,Jb,ec,qa,sa)=>{sa.isRtl=S.a.zo(W.OutlineElementNavigator.Cm(Jb.node));return 32};this.LTh=(kc,Jb,ec)=>{if(kc===ja.a.t0b)kc=!0;else if(kc===ja.a.s0b)kc=!1;else return 2;kc&&this.waj(Jb);if(1===ec)return 32;this.Rh.j0b(W.OutlineElementNavigator.Cm(Jb.node),kc);return 32};this.tmo=(kc,Jb,ec,qa,sa)=>{kc=Jb.node;sa.isRtl=S.a.isRtl(W.OutlineElementNavigator.Cm(kc));sa.si=Z.a.Zy(kc);return 32};this.Eno=(kc,Jb,ec,qa,sa)=>{kc=Jb.node;sa.isRtl=S.a.isRtl(W.OutlineElementNavigator.Cm(kc));
sa.si=Aa.TableReader.Zy(kc);-1!==sa.si&&sa.si||(sa.si=sa.isRtl?3:1);return 32};this.Cdc=(kc,Jb,ec,qa,sa)=>{let ab;if(!({Oz:ab}=kb.a.hCg(ec,Jb)).returnValue)return ab;const eb=Jb.node;switch(kc){case ja.a.s0b:this.Rh.Exc(eb,!1);break;case ja.a.t0b:this.waj(Jb);this.Rh.Exc(eb,!0);break;case ja.a.J8:ab=m.AFrameworkApplication.va.Pf(Jb.Ok,kc,ec,!0,qa,sa),32===ab&&va.ParagraphReader.kn(Jb)&&cb.nid&&cb.nid.Hha(eb)}return 32};this.Psl=(kc,Jb,ec,qa,sa)=>{const ab={};ab[bb.a.CPa]=6168;ab[bb.a.BPa]=6169;var eb=
Jb.view;const fb=new Ma.GraphTransaction(1===ec?3:15);fb.Ab(eb.root);let Cb=bb.a.Iua(kc,Jb,ec,qa,sa,ab,0),lc=null;eb.jj&&(lc=eb);eb=!0;let bc=null;lc&&(bc=lc.lb.gb.currentSelection)&&(kc=!kb.a.Snc(kc),cb.sg.Z0f(bc,kc)?(cb.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.$G}),Cb=8,eb=!1):1===ec&&(Cb=32,eb=!1),Object(la.a)().bFa(va.ParagraphReader.IX,lc.lb.Ng)&&(cb.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.cR}),Cb=8,eb=!1));eb&&this.Bun(bc)&&(Cb=bb.a.Iua(ja.a.Dnb,Jb,ec,qa,sa,ab,12));fb.dispose();return Cb};this.Osl=(kc,Jb,ec)=>
{kc=!0;Jb.contextId!==L.a.paragraph&&Jb.contextId!==L.a.Vc?kc=!1:cb.sg.Kab(Jb)&&(cb.Bc.$b(ra.a.Vn,{["Reason"]:ya.a.$G}),kc=!1);if(1===ec||!kc)return kc?32:8;Jb=Jb.node;ec=new Ma.GraphTransaction(15);ec.Ab(Jb);cb.Ll.LVc(Jb);this.Dv.XLb(Jb,!0);this.hw.jpf(Jb);ec.dispose();return 2};this.RVm=(kc,Jb,ec)=>{kc=!0;Jb.contextId!==L.a.view&&(kc=!1);if(1===ec&&!kc)return 8;if(!Jb.view||!Jb.view.ue)return 2;Jb=Jb.view;if(!Jb.lb||!Jb.lb.gb.currentSelection)return 8;if(Object(la.a)().bFa(va.ParagraphReader.IX,
Jb.lb.Ng))return cb.Bc.$b(ra.a.Oe,{["Reason"]:ya.a.cR}),8;Jb=Jb.lb.gb;for(const qa of Jb)for(const sa of qa)if(sa&&sa.contextId!==L.a.Fd&&sa.contextId!==L.a.Vc&&sa.contextId!==L.a.paragraph&&sa.contextId!==L.a.Yc)return 2;return 32};this.ldb=(kc,Jb,ec,qa,sa)=>{kc=!0;Jb.contextId!==L.a.paragraph&&(kc=!1);if(1===ec&&!kc)return 8;sa.Iu||(Jb=Jb.node,ec=this.Xp.Zqb(Jb),sa.Iu=ec,Jb=W.OutlineElementNavigator.Cm(Jb),sa.isRtl=Jb?S.a.zo(Jb):!1);return 32};this.Fno=(kc,Jb,ec,qa,sa)=>{Jb=Jb.node;kc=W.OutlineElementNavigator.Cm(Jb);
sa.Iu||(Jb=this.KFm(Jb),Jb=this.Xp.Zqb(Jb),sa.Iu=Jb,sa.isRtl=S.a.isRtl(kc));return 32};this.hxk=pb;this.xda=vb;this.X9=xb;this.Ip=Bb;this.Je=jc;this.Qd=xc;this.Dv=Qc;this.qZ=fd;this.hw=Nb;this.hy=Ac;this.Rh=ib;this.Xp=ic}get VP(){return null!=this.t3g?this.t3g:this.t3g=w.a.instance.Oa(790)}get $3d(){return!!this.X9&&this.X9.enabled}Wb(){const pb=m.AFrameworkApplication.va,vb=this.Dmo;(cb.qc?cb.qc.zE(34):m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("Box4EndOfParagraphFormattingIsEnabled"))?
(pb.qa(ja.a.font,L.a.Yc,this.MW),pb.qa(ja.a.uC,L.a.Yc,this.MW),pb.qa(ja.a.h3,L.a.Yc,this.MW),pb.qa(ja.a.y4,L.a.Yc,this.MW),pb.qa(ja.a.gx,L.a.Yc,this.MW),pb.qa(ja.a.yva,L.a.Yc,this.MW),pb.qa(ja.a.kka,L.a.Yc,this.MW),pb.qa(ja.a.yY,L.a.Yc,this.MW),pb.qa(ja.a.yca,L.a.Yc,this.MW),pb.qa(ja.a.vza,L.a.Yc,this.MW),pb.qa(ja.a.bold,L.a.Yc,this.MW),pb.qa(ja.a.lA,L.a.Yc,this.MW),pb.qa(ja.a.underline,L.a.Yc,this.MW),pb.qa(ja.a.Aha,L.a.Yc,this.MW),pb.qa(ja.a.superscript,L.a.Yc,this.MW),pb.qa(ja.a.subscript,L.a.Yc,
this.MW),pb.qa(ja.a.strikethrough,L.a.Yc,this.MW),pb.qa(ja.a.Eu,L.a.Yc,this.MW),pb.qa(ja.a.J8,L.a.Yc,this.MW),pb.qa(ja.a.oE,L.a.Yc,this.MW)):Ha.a.Lqc&&(pb.qa(ja.a.font,L.a.Yc,this.Sqa),pb.qa(ja.a.uC,L.a.Yc,this.Sqa),pb.qa(ja.a.gx,L.a.Yc,this.Sqa),pb.qa(ja.a.yva,L.a.Yc,this.Sqa),pb.qa(ja.a.kka,L.a.Yc,this.Sqa),pb.qa(ja.a.bold,L.a.Yc,this.Sqa),pb.qa(ja.a.lA,L.a.Yc,this.Sqa),pb.qa(ja.a.superscript,L.a.Yc,this.Sqa),pb.qa(ja.a.subscript,L.a.Yc,this.Sqa),pb.qa(ja.a.strikethrough,L.a.Yc,this.Sqa),pb.qa(ja.a.Eu,
L.a.Yc,this.Sqa),pb.qa(ja.a.h3,L.a.Yc,this.Sqa),pb.qa(ja.a.y4,L.a.Yc,this.Sqa));const xb=Ha.a.r0a.GXc(Bb=>Ka.OutlineElementGeneralizer.gla(Bb.gb,!0));pb.fb(ja.a.jof,L.a.view,this.RVm,100);pb.fb(ja.a.Qrd,L.a.Fd,this.Qrd,1028);pb.qa(ja.a.HZa,L.a.view,this.rxj);pb.qa(ja.a.Kid,L.a.view,this.rxj);pb.qa(ja.a.Tua,L.a.view,xb);pb.qa(ja.a.Tua,L.a.paragraph,this.Tua);pb.qa(ja.a.Tua,L.a.image,this.tmo);pb.qa(ja.a.Tua,L.a.kPa,vb);pb.qa(ja.a.Tua,L.a.table,this.Eno);pb.qa(ja.a.ldb,L.a.view,xb);pb.qa(ja.a.ldb,L.a.paragraph,
this.ldb);pb.qa(ja.a.ldb,L.a.table,this.Fno);pb.Pc(ja.a.HZa,99);pb.Pc(ja.a.Kid,1127);pb.Pc(ja.a.Tua,97);pb.Pc(ja.a.ldb,97);this.QO(pb,ja.a.font);this.QO(pb,ja.a.uC);this.QO(pb,ja.a.h3);this.QO(pb,ja.a.y4);pb.lmb(ja.a.lqi,L.a.view,this.Bif);pb.Pc(ja.a.lqi,1092);this.QO(pb,ja.a.gx);this.QO(pb,ja.a.yva);this.QO(pb,ja.a.kka);this.QO(pb,ja.a.yY);this.QO(pb,ja.a.yca);this.QO(pb,ja.a.R6a);this.QO(pb,ja.a.wIa);this.QO(pb,ja.a.xIa);this.QO(pb,ja.a.sza);this.QO(pb,ja.a.S6a);this.QO(pb,ja.a.vza);this.QO(pb,
ja.a.bold);pb.K_b(ja.a.bold,this.rPb);this.QO(pb,ja.a.lA);pb.K_b(ja.a.lA,this.rPb);this.QO(pb,ja.a.underline);pb.K_b(ja.a.underline,this.rPb);this.QO(pb,ja.a.Aha);this.QO(pb,ja.a.superscript);pb.K_b(ja.a.superscript,this.rPb);this.QO(pb,ja.a.subscript);pb.K_b(ja.a.subscript,this.rPb);this.QO(pb,ja.a.strikethrough);pb.K_b(ja.a.strikethrough,this.rPb);this.QO(pb,ja.a.Eu);pb.K_b(ja.a.Eu,this.rPb);pb.fb(ja.a.dXa,L.a.Fd,this.ESd,96);pb.lmb(ja.a.J8,L.a.view,this.Bif);pb.qa(ja.a.J8,L.a.paragraph,this.Cdc);
pb.qa(ja.a.J8,L.a.Fd,this.ESd);pb.qa(ja.a.J8,L.a.Vc,this.Jif);pb.qa(ja.a.oE,L.a.view,this.Psl);pb.qa(ja.a.oE,L.a.paragraph,this.Osl);pb.qa(ja.a.oE,L.a.Fd,this.ESd);pb.qa(ja.a.oE,L.a.Vc,this.Jif);pb.Pc(ja.a.oE,1036);pb.qa(ja.a.Dnb,L.a.Fd,this.Dnb);pb.qa(ja.a.Dnb,L.a.Vc,this.Dnb);pb.qa(ja.a.JVc,L.a.view,this.JVc);pb.qa(ja.a.s0b,L.a.view,kb.a.yx);pb.qa(ja.a.s0b,L.a.paragraph,this.Cdc);pb.qa(ja.a.s0b,L.a.kPa,this.LTh);pb.Pc(ja.a.s0b,1028);pb.qa(ja.a.t0b,L.a.view,kb.a.yx);pb.qa(ja.a.t0b,L.a.paragraph,
this.Cdc);pb.qa(ja.a.t0b,L.a.kPa,this.LTh);pb.Pc(ja.a.t0b,1028)}QO(pb,vb){pb.lmb(vb,L.a.view,this.Bif);pb.qa(vb,L.a.Fd,this.ESd);pb.qa(vb,L.a.Vc,this.Jif);pb.Pc(vb,1036)}czl(pb,vb){for(const fd of pb)for(const Ac of fd){pb=null;if(Ac.contextId===L.a.Fd){if(X.b(Ac))continue;pb=[];var xb=Ac.node.ra;if(xb){var Bb=xb.length-1;const Nb=Ac.cpBegin,ib=Ac.cpEnd;let Rb=!1;const ic=Ac.node.characterData;if(ic&&""!==ic){var jc=ic.substr(Nb,ib-Nb);jc&&""!==jc&&z.a.Lrf(jc,0,jc.length)&&(Rb=!0)}jc=!1;for(let kc=
0;kc<Bb;kc++){var xc=xb.K(kc).cp,Qc=xb.K(kc+1).cp;if(xb.K(kc).formatting&&Math.max(xc,Nb)<Math.min(Qc,ib)){if(ic&&""!==ic&&(xc=xc<Nb?Nb:xc,Qc=ic.substr(xc,(Qc<ib?Qc:ib)-xc),!Rb&&z.a.Lrf(Qc,0,Qc.length)))continue;jc=!0;pb.push(xb.K(kc).formatting)}else if(jc)break}xb.K(Bb).formatting&&Ac.cpEnd>xb.K(Bb).cp&&pb.push(xb.K(Bb).formatting)}}else if(Ac.contextId===L.a.paragraph&&!va.ParagraphReader.IX(Ac)){if(pb=[],xb=Ac.node.ra)for(Bb=0;Bb<xb.length;Bb++)xb.K(Bb).formatting&&pb.push(xb.K(Bb).formatting)}else if(Ac.contextId===
L.a.Yc)pb=[V.FormattingReader.Us(Ac)];else if(Ac.contextId===L.a.Vc){this.bmo(Ac,vb);return}if(pb&&0<pb.length)for(const Nb of pb)if(V.FormattingReader.OLg(vb,Nb.cache,Ac))return}}bmo(pb,vb){if(pb=V.FormattingReader.Us(pb)){pb=pb.cache;var xb=cb.tk.yI(y.a.bold,pb.isBold);vb.bold=xb?1:0;xb=cb.tk.yI(y.a.italic,pb.isItalic);vb.italic=xb?1:0;xb=cb.tk.yI(y.a.underline,pb.isUnderline);vb.underline=xb?1:0;vb.underlineType=cb.tk.yI(y.a.underlineType,pb.underlineType);xb=cb.tk.yI(y.a.superscript,pb.isSuperscript);
vb.superscript=xb?1:0;xb=cb.tk.yI(y.a.subscript,pb.isSubscript);vb.subscript=xb?1:0;xb=cb.tk.yI(y.a.strikethrough,pb.isStrikethrough);vb.strikethrough=xb?1:0;xb=cb.tk.yI(G.a.Eu,pb.isDoubleStrikethrough);vb.Eu=xb?1:0;xb=cb.tk.yI(y.a.font,pb.wI);vb.fontName=Wa.a.w9a(xb);vb.Zha=pb.Se;vb.fontSize=cb.tk.yI(y.a.fontSize,pb.fontSize);vb.fontColor=cb.tk.yI(y.a.fontColor,pb.fontColor);vb.highlight=cb.tk.yI(y.a.highlight,pb.highlight)}}H7o(pb){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isUnderlineButtonSelectionBugFixEnabled",
!1)?pb===ja.a.Aha||pb===ja.a.Eu||pb===ja.a.yY:pb===ja.a.underline||pb===ja.a.Aha||pb===ja.a.strikethrough||pb===ja.a.Eu||pb===ja.a.yY}static hKf(pb){return"string"===typeof pb?{fontName:pb,Zha:-1,bold:2,italic:2}:pb}LW(pb,vb,xb,Bb){var jc;const xc=pb.cpBegin,Qc=pb.cpEnd,fd=pb.node;var Ac=V.FormattingReader.Us(pb);let Nb=xc;const ib=null===(jc=m.AFrameworkApplication.J)||void 0===jc?void 0:jc.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);jc=cb.Pd.Ag;if(ib&&(jc||fd.Pv))return!1;
if(Sa.has(vb))for(const Rb of fd.ra)if(!(Rb.cp<=xc)){if(Rb.cp>=Qc)break;Rb.formatting&&Rb.formatting.cache.fontSize!=Ac.cache.fontSize&&(Ac=this.mKf(pb.node,Ac,vb,xb,ib?null:Bb),this.xda.annotateRange(pb.node,ib?fd.ra.i8a(Nb):Nb,ib?fd.ra.i8a(Rb.cp):Rb.cp,Ac),Nb=Rb.cp,Ac=Rb.formatting)}vb=this.mKf(pb.node,Ac,vb,xb,ib?null:Bb);this.xda.annotateRange(pb.node,ib?fd.ra.i8a(Nb):Nb,ib?fd.ra.i8a(Qc):Qc,vb);return!0}mKf(pb,vb,xb,Bb,jc){const xc={},Qc=Object(K.a)(13,Bb),fd=vb.cache;switch(xb){case ja.a.bold:2===
Bb.value&&(Bb.value=fd.isBold?0:1);xc[y.a.bold.id]=1===Bb.value;break;case ja.a.lA:2===Bb.value&&(Bb.value=fd.isItalic?0:1);xc[y.a.italic.id]=1===Bb.value;break;case ja.a.underline:2===Bb.value&&(Bb.value=fd.isUnderline?0:1);Bb=1===Bb.value;xc[y.a.underline.id]=Bb;xc[y.a.underlineType.id]=Bb?Wa.a.tAb:Wa.a.KV;break;case ja.a.Aha:xc[y.a.underlineType.id]=Bb.number;xc[y.a.underline.id]=Bb.number!==Wa.a.KV;break;case ja.a.superscript:2===Bb.value&&(Bb.value=fd.isSuperscript?0:1);xc[y.a.superscript.id]=
1===Bb.value;1===Bb.value&&(xc[y.a.subscript.id]=!1);break;case ja.a.subscript:2===Bb.value&&(Bb.value=fd.isSubscript?0:1);xc[y.a.subscript.id]=1===Bb.value;1===Bb.value&&(xc[y.a.superscript.id]=!1);break;case ja.a.strikethrough:6!==m.AFrameworkApplication.va.pE?H.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):H.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Bb.value&&(Bb.value=fd.isStrikethrough?0:1);xc[y.a.strikethrough.id]=1===
Bb.value;break;case ja.a.Eu:2===Bb.value&&(Bb.value=fd.isDoubleStrikethrough?0:1);xc[G.a.Eu.id]=1===Bb.value;break;case ja.a.font:if(Qc&&Qc.td){const {fontName:Nb,Zha:ib,bold:Rb,italic:ic}=cb.hKf(Qc.td);Bb=Nb.substr(0,cb.edj);this.$3d&&(xc[C.a.r2.id]=Bb,xc[C.a.FF.id]=Bb,xc[C.a.J6.id]=Bb,xc[C.a.A7.id]=Bb,xc[C.a.Ye.id]=ib,xc[C.a.vf.id]=ib,xc[C.a.Te.id]=ib,xc[C.a.$e.id]=ib);xc[y.a.font.id]=Bb;xc[C.a.Se.id]=ib;if(Object(ua.a)()){Bb=1==Rb;var Ac=1==ic;if(Bb||Ac)xc[y.a.bold.id]=Bb,xc[y.a.italic.id]=Ac}}break;
case ja.a.gx:Bb=Pa.a.instance.mka(pb,Bb);xc[y.a.fontColor.id]=Bb;break;case ja.a.yva:Ac=Pa.a.instance.mka(pb,Bb);xc[y.a.fontColor.id]=Ac;this.VP.zTa(Bb)||H.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.kka:xc[y.a.fontColor.id]=E.a.auto;break;case ja.a.yY:xc[y.a.highlight.id]=parseInt(Bb,16);break;case ja.a.yca:xc[y.a.highlight.id]=parseInt(Bb,16);this.VP.zTa(Bb)||H.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");
break;case ja.a.vza:xc[y.a.highlight.id]=E.a.auto;break;case ja.a.uC:xc[y.a.fontSize.id]=this.Je.yfc(Qc.td);break;case ja.a.h3:fd&&fd.fontSize&&(xc[y.a.fontSize.id]=this.pxm(fd.fontSize));break;case ja.a.y4:fd&&fd.fontSize&&(xc[y.a.fontSize.id]=this.oqm(fd.fontSize));break;case ja.a.dXa:if(Bb=null===(Ac=cb.wB)||void 0===Ac?void 0:Ac.dXa)for(const Nb of Bb.fk())xc[Nb.id]=Bb.wf(Nb);break;case ja.a.oE:if(Bb=vb.uo)for(const Nb of Bb.fk())xc[Nb.id]=null;xc[C.a.WLb.id]=!0;break;case ja.a.wIa:case ja.a.xIa:case ja.a.R6a:case ja.a.sza:case ja.a.S6a:fd.uWa&&
2===fd.capitalization&&(xc[G.a.capitalization.id]=0)}null!=jc&&(xc[m.AFrameworkApplication.QFf]=jc);return xc}pxm(pb){pb=this.Je.h3(pb);return this.Je.yfc(pb)}oqm(pb){pb=this.Je.y4(pb);return this.Je.yfc(pb)}ixc(pb,vb,xb,Bb){var jc=pb.cache;const xc=Object(K.a)(13,xb);switch(vb){case ja.a.bold:2===xb.value&&(xb.value=jc.isBold?0:1);this.Je.YN(pb,1===xb.value);break;case ja.a.lA:2===xb.value&&(xb.value=jc.isItalic?0:1);this.Je.lA(pb,1===xb.value);break;case ja.a.underline:2===xb.value&&(xb.value=jc.isUnderline?
0:1);this.Je.M8(pb,1===xb.value);break;case ja.a.Aha:this.Je.Aha(pb,xb);break;case ja.a.superscript:2===xb.value&&(xb.value=jc.isSuperscript?0:1);this.Je.Bva(pb,1===xb.value);break;case ja.a.subscript:2===xb.value&&(xb.value=jc.isSubscript?0:1);this.Je.gOa(pb,1===xb.value);break;case ja.a.strikethrough:6!==m.AFrameworkApplication.va.pE?H.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):H.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===
xb.value&&(xb.value=jc.isStrikethrough?0:1);this.Je.Gna(pb,1===xb.value);break;case ja.a.Eu:2===xb.value&&(xb.value=jc.isDoubleStrikethrough?0:1);this.Je.pxe(pb,1===xb.value);break;case ja.a.font:if(xc&&xc.td){const {fontName:Qc,Zha:fd,bold:Ac,italic:Nb}=cb.hKf(xc.td);this.Je.uha(pb,Qc.substr(0,cb.edj));this.Je.XAg(pb,fd);Object(ua.a)()&&(xb=1==Ac,Bb=1==Nb,xb||Bb)&&(this.Je.YN(pb,xb),this.Je.lA(pb,Bb))}break;case ja.a.gx:H.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");
this.Je.gx(pb,xb,null);break;case ja.a.yva:this.Je.gx(pb,xb,null);this.VP.zTa(xb)||H.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.kka:this.Je.kka(pb);break;case ja.a.yY:H.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");this.Je.gEa(pb,xb);break;case ja.a.yca:this.Je.gEa(pb,xb);this.VP.zTa(xb)||H.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");
break;case ja.a.vza:this.Je.SVd(pb);break;case ja.a.uC:this.Je.uC(pb,xc.td);break;case ja.a.h3:this.Je.ZLi(pb);break;case ja.a.y4:this.Je.UVj(pb);break;case ja.a.J8:jc=xb.ka(C.a.noProof,!1);this.Je.Mxe(pb,xb.getValue(y.a.iK),Bb,jc);break;case ja.a.dXa:this.Je.wxe(pb);break;case ja.a.oE:this.Je.lra(pb);break;case ja.a.wIa:case ja.a.xIa:case ja.a.R6a:case ja.a.sza:case ja.a.S6a:jc.uWa&&2===jc.capitalization&&this.Je.Bsl(pb)}}aCo(pb,vb){ja.a.oE===vb&&W.OutlineElementNavigator.Cm(pb).properties.removeProperty(y.a.U3)}z_m(pb,
vb){return this.eUh(pb,vb)||this.eUh(vb,pb)}eUh(pb,vb){return(1===pb.specialIndentType||!pb.specialIndentType)&&2===vb.specialIndentType}KFm(pb){var vb;pb=O.a.Za(pb);pb.vb(11);Y.moveToCell(pb,0,0);pb.$d();if(null===(vb=Gb.a.getInstance())||void 0===vb?0:vb.oma)return S.a.yN(pb);pb.O_();return pb.currentNode}Bun(pb){return!pb||za.a.Fm(pb)||1===pb.length&&za.a.gm(pb.Qa)&&!za.a.ktb(pb.Qa)?!1:!0}waj(pb){cb.jDh.mb(pb.contextId)||(H.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",pb.contextId),cb.jDh.W(pb.contextId,
!0))}Dhn(pb){return pb===ja.a.R6a||pb===ja.a.wIa||pb===ja.a.xIa||pb===ja.a.sza||pb===ja.a.S6a}gVd(pb,vb){const xb=pb.node,Bb=xb.characterData.substr(pb.cpBegin,pb.cpEnd-pb.cpBegin);this.nub.set("Command",vb.toString());x.Health.instance.recordKpiUsage(this.kpiName,1,this.Kaa,this.nub);vb=cb.rlp(Bb,vb);xb.vva(xb.characterData.substr(0,pb.cpBegin)+vb+xb.characterData.substr(pb.cpEnd));return 32}static get tk(){return cb.wB||(cb.wB=w.a.instance.resolve(106))}static wy(){return cb.ao||(cb.ao=w.a.instance.Ra(51))}static get sg(){return wa.a.instance}static get Bc(){return u.a.instance}static get qc(){return null!=
cb.yWg?cb.yWg:cb.yWg=w.a.instance.Oa(23)}static get nid(){return Ha.a.lQ}static get Pd(){return null!=cb.v6g?cb.v6g:cb.v6g=w.a.instance.resolve(46).instance}static get Oj(){return null!=cb.X5g?cb.X5g:cb.X5g=w.a.instance.resolve(39).instance}static get OD(){return null!=cb.z5g?cb.z5g:cb.z5g=w.a.instance.resolve(377)}static get Nd(){return null!=cb.v1g?cb.v1g:cb.v1g=w.a.instance.resolve(10)}static get Ll(){return null!=cb.g1g?cb.g1g:cb.g1g=w.a.instance.resolve(31)}static get ig(){return aa.a.instance}static Bpm(pb,
vb){return 42===pb?vb:pb!==vb||16===pb?16:pb}static SQh(pb,vb){pb.LWi||(vb.LWi?vb=pb:vb.unit===pb.unit&&l.a.UBa(vb.value,pb.value)||(vb.value=-1));return vb}static rlp(pb,vb){switch(vb){case ja.a.wIa:return pb.toLowerCase();case ja.a.xIa:return 6!==m.AFrameworkApplication.va.pE?H.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):H.ULS.sendTraceTag(539305616,340,50,"User changed the case from keyboard shortcut"),pb.toUpperCase();case ja.a.R6a:case ja.a.sza:return cb.cpl(pb,vb===
ja.a.sza);case ja.a.S6a:return cb.Qnp(pb);default:return pb}}static Qnp(pb){let vb="";for(let xb=0;xb<pb.length;xb++)vb=pb.charAt(xb)===pb.charAt(xb).toUpperCase()?vb+pb.charAt(xb).toLowerCase():vb+pb.charAt(xb).toUpperCase();return vb}static cpl(pb,vb){let xb,Bb,jc=!0,xc=pb.length,Qc=0,fd=cb.r1f(pb,Qc,xc);for(;0<xc;){Bb=xb=!1;var Ac=xc;let ib;var Nb=void 0;for(Nb=0;0<Ac&&cb.Frl(pb.charAt(Qc+Nb));Nb++,Ac--)Bb=cb.Pfe(pb.charAt(Qc+Nb));for(ib=Nb;0<Ac&&!(xb=cb.Pfe(pb.charAt(Qc+Nb)))&&" "!==pb.charAt(Qc+
Nb)&&"/"!==pb.charAt(Qc+Nb);Nb++,Ac--);Ac=Nb-ib;if(0>=Ac)break;Qc+=ib;Nb=pb.substr(Qc,Ac);Nb=Nb===Nb.toUpperCase();if(fd||!Nb)pb=jc||Bb||vb?pb.substr(0,Qc)+pb.charAt(Qc).toUpperCase()+pb.substr(Qc+1,Ac-1).toLowerCase()+pb.substr(Qc+Ac):pb.substr(0,Qc)+pb.substr(Qc,Ac).toLowerCase()+pb.substr(Qc+Ac);xc-=Ac+ib;Qc+=Ac;if(jc=xb)Qc++,xc--,fd=cb.r1f(pb,Qc,xc)}return pb}static r1f(pb,vb,xb){for(;0<xb&&!cb.Pfe(pb.charAt(vb));){if(pb.charAt(vb)!==pb.charAt(vb).toUpperCase())return!1;vb++;xb--}return!0}static wun(pb,
vb){for(var xb=0;0<vb&&!cb.Pfe(pb.charAt(xb));){if(pb.charAt(xb)!==pb.charAt(xb).toLowerCase())return!1;xb++;vb--}return!0}static Pfe(pb){return"."===pb||"!"===pb||"?"===pb?!0:!1}static Frl(pb){return-1==="0123456789".indexOf(pb)&&pb.toUpperCase()===pb.toLowerCase()}static Opi(){const pb=w.a.instance.Ra(2);pb&&pb.execute(vb=>{vb.logActivity("FontsSurveyActivity","FontsFloodgateSurvey")})}}cb.jDh=new R.a;cb.wB=null;cb.ao=null;cb.edj=31;Object(I.a)(cb,"TextFormattingActor",null,[])},2111:function(I,
J,d){d.d(J,"a",function(){return m});I=d(0);var m;(function(f){f[f.initial=0]="initial";f[f.pYj=1]="startSearch";f[f.QKj=2]="searching";f[f.Xxb=3]="searchComplete";f[f.Mvc=4]="replaceAllInProgress";f[f.Lvc=5]="replaceAllComplete";f[f.bia=6]="tooManyResults";f[f.EYa=7]="noMatchesFound"})(m||(m={}));Object(I.b)("FindReplaceViewType",m)},2113:function(I,J,d){d.d(J,"a",function(){return m});var m;(function(f){f[f.initial=0]="initial";f[f.headings=1]="headings";f[f.find=2]="find";f[f.replace=3]="replace";
f[f.intelligentPlaceholder=4]="intelligentPlaceholder";f[f.contracts=5]="contracts"})(m||(m={}))},2142:function(I,J,d){function m(b,h){h=Object.assign(new fa.a,{name:"LinkType",string:h});f(ub.a.Jbn,b,[h])}function f(b,h,r,A=!0){h&&h.UILocation&&Object($b.d)(b,A,$b.e,0,h.UILocation,0,r)}function a(b,h){const r=$a.a.instance;return new gB(b,h,r.rf(929).value,r.rf(930).value,r.resolve(242),r.resolve(82),r.resolve(323),r.resolve(46).instance,r.resolve(39).instance,vp.a.instance,r.Oa(66))}function l(b,
h){var r;return b===it.none?"none":null===(r=FC[b])||void 0===r?void 0:r[h]}function w(){const b=$a.a.instance.Oa(1102);void 0===b&&v.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function z(){const b=$a.a.instance.Oa(1103);void 0===b&&v.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");return b}function x(b){b.Ra(659).execute(async h=>{var r,A,M,ba;await h.Bm();h=pG.a.Uz();
const oa=await h.getSession();null!==(ba=null===(M=null===(A=null===(r=null===oa||void 0===oa?void 0:oa.sessionManager)||void 0===r?void 0:r.networkWorkerManager)||void 0===A?void 0:A.globalUrl)||void 0===M?void 0:M.startsWith)&&void 0!==ba&&ba.call(M,"ws://localhost")&&(r={message:new Hb.y({seq:0,ops:[new Q.a({parentPath:["session"],items:[{id:"doc",body:new ac.d({isReadonly:!1})}]}),new Q.a({parentPath:["session","doc"],items:[{id:"headerfooters",body:new Ec.HeaderFooterSubDocument},{id:"comments",
body:new Ec.CommentSubDocument},{id:"main",body:new Ec.MainSubDocument}]})]})},h.submitCustomMessage(r))})}d.r(J);var u=d(0),v=d(8),F=d(108),y=d(2),G=d(28),C=d(16),H=d(186),K=d(89);class R{constructor(b){this.UIg=0;this.VRb=this.Guc=this.yEa=null;this.yV=y.AFrameworkApplication.ta.$r;this.Y_=b;this.Y_.Gv(K.a.SNj);this.Y_.XE(K.a.SNj,Object(F.a)(this,this.K3n,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.VRb)return v.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.VRb;
this.yEa=this.yV.Xf("ComponentAttach","getCustomAuthConfig");return this.VRb=new Promise((b,h)=>{const r={};let A=!1,M=!1,ba=0;this.UIg=window.setInterval(()=>{4>ba?(ba++,this.Y_.sendMessage(K.a.getCustomAuthConfig,r)):(window.clearInterval(this.UIg),A=!0,v.ULS.sendTraceTag(588087303,344,10,G.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.Guc=(oa,Ja)=>{window.clearInterval(this.UIg);A||M||(M=!0,oa?(v.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),
b(oa)):(v.ULS.sendTraceTag(589050654,369,10,G.c({["error"]:Ja.toString()})),h(Ja)))};this.Y_.sendMessage(K.a.getCustomAuthConfig,r)})}K3n(b){try{const h=G.a(b.Values[H.a.Pjl]);let r=y.AFrameworkApplication.J.jb("Application")||"";r=C.a.xh(r);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";
h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";this.yEa&&(this.yEa.stop(),this.yEa=null);this.Guc(h,"")}catch(h){v.ULS.sendTraceTag(589050655,344,10,G.c({["error"]:h.message,["stack"]:h.stack})),this.Guc(null,h.message)}}}Object(u.a)(R,"AccountSwitchingManager",null,[257]);var E=d(179);class L{get name(){return"Common.App.AccountSwitching"}uc(b){b.register(R,"Common.App.AccountSwitching.AccountSwitchingManager").as(1070).ha().Sd(()=>new R(b.resolve(7)))}init(){}dispose(){}static main(){E.a.instance.Mc(new L)}}
Object(u.a)(L,"AccountSwitchingPackage",null,[0,1]);var O;(function(b){b[b.$8a=0]="generalException";b[b.xce=1]="invalidArgument";b[b.Fcg=2]="notAllowed";b[b.cif=3]="apiNotAvailable";b[b.Ovp=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.oef=6]="adalTimeout";b[b.fak=7]="userNotSignedIn";b[b.Rtd=8]="userAborted";b[b.cWj=9]="silentSignInFailed";b[b.s8c=10]="invalidResourceUrl";b[b.PWf=11]="invalidGrant";b[b.p6h=12]="connectionLost";b[b.vpf=13]="clientError";b[b.Jyg=14]="serverError"})(O||
(O={}));Object(u.b)("ErrorCodes",O);d(1833);class V{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(u.a)(V,"OutstandingRequest",null,[]);class Z{}Z.uTn="AADSTS50058";Z.s8c="AADSTS50001";Z.nTn="AADSTS65001";Z.eUn="AADSTS70011";Z.Rtd="13002";Z.Afo="Popup Window is null";Z.zfo="Popup Window closed";Z.oef="Token renewal operation failed due to timeout";Z.aop="tokenRevoked";Object(u.a)(Z,"WopiHostErrorType",null,[]);var W=d(623),
P=d(46),S=d(1832);class aa{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(u.a)(aa,"WopiIdentityInfo",null,[883]);class Y{constructor(b,h,r){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=r}}Object(u.a)(Y,"WopiIdentityToken",null,[870]);var X=d(17),ca=d(185),fa=d(29),ja=d(235);class ra{constructor(b){this._initialized=!1;this.J3n=h=>{let r=null;try{const M=h.Values[H.a.fFg],
ba=h.Values[H.a.cep],oa=h.Values[H.a.MXj],Ja=h.Values[H.a.kep];let jb=null,zb=null;const Eb=this.ytc[M];if("undefined"!==typeof Eb&&Eb){var A=[];Array.add(A,Object.assign(new fa.a,{name:H.a.eFg,string:Eb.requestParameters.correlationId}));ca.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:A}));r=Eb.requestCallback;delete this.ytc[M];"undefined"!==typeof ba&&ba&&ba.length?zb=new Y(ba,oa,Ja):jb=O[this.ZKn(h)];A="getAccessToken_"+
M;A in this.dBe&&(this.dBe[A].stop(),delete this.dBe[A]);r(zb,jb)}else v.ULS.sendTraceTag(37856066,344,10,G.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:M}))}catch(M){h=h.Values[H.a.fFg],h in this.ytc&&delete this.ytc[h],this.hie(),v.ULS.sendTraceTag(37856067,344,10,G.c({["error"]:M.message,["stack"]:M.stack})),r&&r(null,"generalException")}};this.ytc={};this.dBe={};this.yV=y.AFrameworkApplication.ta.$r;this.OTf=b}K_c(b){this._initialized||(b.Gv(K.a.wuc),b.XE(K.a.wuc,
this.J3n),this._initialized=!0)}getAccessToken(b,h,r=null){this.XX(b,h);return new Promise((A,M)=>{if(this.AXf(h))if(h in this.ytc)M("unresolvedPendingRequest");else{var ba=window.setTimeout(()=>{v.ULS.sendTraceTag(37856032,344,10,G.c({["error"]:"Request timeout.",["callerId"]:h}));M("timeout")},12E4);this.JGf(b,h,r,(oa,Ja)=>{window.clearTimeout(ba);oa?A(oa):(v.ULS.sendTraceTag(37856033,369,15,G.c({["error"]:O[Ja]})),M(Ja))})}else v.ULS.sendTraceTag(37856034,344,10,G.c({["error"]:"Caller is not allowed."})),
M("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,r)=>{this.AXf(b)?this.WHm((A,M)=>{A?h(A):(v.ULS.sendTraceTag(37856064,369,10,G.c({["error"]:M.toString()})),r(M))}):(v.ULS.sendTraceTag(37856065,344,10,G.c({["error"]:"Caller is not allowed."})),r("notAllowed"))})}getAuthContext(b){return new Promise((h,r)=>{const A=this.getAuthContextSync(b);A?h(A):r("notAllowed")})}getAuthContextSync(b){if(this.AXf(b)){const h=new S.a;h.upn=y.AFrameworkApplication.J.jb("UserPrincipalName");h.userId=
y.AFrameworkApplication.J.jb("LoggableUserId");h.authority=y.AFrameworkApplication.J.jb("HostAuthAuthority");h.tenantId=y.AFrameworkApplication.J.jb("TenantId");h.isAnonymous=y.AFrameworkApplication.J.$("IsAnonymousUser");h.supportsAuthToken=this.b4m(b);b=y.AFrameworkApplication.J.jb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}v.ULS.sendTraceTag(40751647,344,10,G.c({["error"]:"Caller is not allowed."}));return null}b4m(b){const h=W.a.F6c;return X.a.LXa?
h&&W.a.p0j?Array.contains(W.a.p0j,b.toLowerCase()):!1:h}JGf(b,h,r,A){var M=[];Array.add(M,Object.assign(new fa.a,{name:"CallerId",string:h}));Array.add(M,Object.assign(new fa.a,{name:H.a.eFg,string:b.correlationId}));ca.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:M}));M=P.a.create().toString();const ba="getAccessToken_"+M,oa=this.yV.Xf("ComponentAttach",ba);this.dBe[ba]=oa;const Ja={};Ja[H.a.fFg]=M;Ja[H.a.hep]=b.resource;
Ja[H.a.iep]=b.scope;Ja[H.a.MXj]=y.AFrameworkApplication.J.jb("HostAuthType");Ja[H.a.lep]=y.AFrameworkApplication.J.jb("UserPrincipalName");Ja[H.a.jep]=b.silentLogin;Ja[H.a.eep]=b.options;Ja[H.a.eFg]=b.correlationId;Ja[H.a.fep]=h;r&&(Ja[H.a.addinName]=r.AddinName,Ja[H.a.dep]=r.AddinTrustId);this.OTf.execute(jb=>{this.K_c(jb);jb.sendMessage(K.a.getAuthToken,Ja)});this.ytc[M]=new V(b,A)}WHm(b){const h=y.AFrameworkApplication.J.jb("UserName"),r=y.AFrameworkApplication.J.jb("UserPrincipalName"),A=y.AFrameworkApplication.J.jb("LoggableUserIdSpace"),
M=new aa;M.email=r;M.displayName=h;switch(A){case "OrgIdPuid":M.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":M.authority="MicrosoftAccount";break;default:M.authority=A}b(M,null)}AXf(b){var h=y.AFrameworkApplication.WTm();b=b.toLowerCase();for(const r of h)if(b===r.toLowerCase())return!0;h=W.a.iif;for(const r in h)if(b===h[r].toLowerCase())return!0;return!1}ZKn(b){b=b.Values[H.a.gep];this.hie();v.ULS.sendTraceTag(39068821,344,15,G.c({["error"]:b}));return b?-1<b.indexOf(Z.uTn)?
9:-1<b.indexOf(Z.Afo)||-1<b.indexOf(Z.zfo)?12:-1<b.indexOf(Z.s8c)?10:-1<b.indexOf(Z.Rtd)?8:-1<b.indexOf(Z.eUn)||-1<b.indexOf(Z.nTn)||b===Z.aop?11:-1<b.indexOf(Z.oef)?6:0:13}XX(b,h){b=this.huo(b.resource);v.ULS.sendTraceTag(39921882,344,50,G.c({["callerId"]:h,["resource"]:b}))}hie(){v.ULS.sendTraceTag(39068822,344,50,G.c({["userAgent"]:window.navigator.userAgent}))}huo(b){return(b?b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(u.a)(ra,"WopiIdentityManager",null,
[845]);class ya{constructor(){this.Z=null;this.nz=()=>{try{this.Z.resolve(732)}catch(b){v.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}}get name(){return"Common.App.WopiIdentity"}uc(b){this.Z=b;b.register(ra,1228).as(732).ha().Sd(()=>new ra(b.Ra(7)))}init(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.xp(this.nz)}dispose(){}static main(){E.a.instance.Mc(new ya)}}Object(u.a)(ya,"WopiIdentityPackage",null,[0,1]);var Ha=d(515),Wa=d(277),Ma=
d(82),ua;(function(b){b[b.dWp=0]="applicationFeatureHelperHandler";b[b.jYp=1]="cloudPolicySettings";b[b.JVp=2]="alternateAuthToken"})(ua||(ua={}));Object(u.b)("ApplicationFeatureHelperRequestType",ua);class Ka{constructor(){this.message=null;this.httpStatusCode=0}}Object(u.a)(Ka,"HttpRequstToPromiseRejectData",null,[]);var za=d(85),Fa=d(44),ea=d(181),la=d(541);class Na{constructor(b,h){this.Ga=b;this.Gf=h}MMb(b,h,r,A=null,M=null,ba=null,oa=null,Ja=null){const jb=ua[r],zb=jb+"RequestFailure";za.Health.instance.recordKpiUsage(zb,
0,"jpittsdirects",null);return new Promise((Eb,Sb)=>{v.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",jb);const nc=null!=oa?oa:this.Ga.fc("ApplicationFeatureHelperRequestQueueTimeout",15E3),Dc=null!=Ja?Ja:this.Ga.fc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Gf.$5a(b,1,null,this.B3c(r,A),ba,1,Zc=>{v.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",
jb);try{if(void 0===Zc||null===Zc||void 0===Zc.data||null===Zc.data||void 0===Zc.data.Ee||null===Zc.data.Ee){za.Health.instance.recordKpiFailure(zb,"Invalid RequestSucceededEventArgs",!1,!0,null);const de=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",jb);Sb(this.x7(de,Zc))}else if(Zc.data.He!==ea.a.xz){za.Health.instance.recordKpiFailure(zb,"HttpStatusCode_"+Zc.data.He.toString(),!1,!0,null);const de=
String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Zc.data.He,jb);Sb(this.x7(de,Zc))}else{void 0!==M&&null!==M&&void 0!==Zc.data.wi&&null!==Zc.data.wi&&M(Zc.data.wi);var Gd=h(Zc.data.Ee);if(Gd)v.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",jb),Eb(Gd);else{za.Health.instance.recordKpiFailure(zb,
"Parse Failure",!1,!0,null);const de=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",jb);Sb(this.x7(de,Zc))}}}catch(de){za.Health.instance.recordKpiFailure(zb,"Unexpected Failure",!1,!0,null),Gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",de,jb),Sb(this.x7(Gd,Zc))}},Zc=>{if(Zc.data){za.Health.instance.recordKpiFailure(zb,"HttpStatusCode_"+Zc.data.He.toString(),!1,!0,null);var Gd=
la.a.TQb(Zc.data.Ee||"No Data");Gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Zc.data.He,Gd,jb)}else za.Health.instance.recordKpiFailure(zb,"Invalid RequestFailedEventArgs",!1,!0,null),Gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",jb);Sb(this.x7(Gd,Zc))},void 0,void 0,nc,Dc)})}x7(b,h){const r=new Ka;r.message=b;r.httpStatusCode=
h&&h.data?h.data.He:-1;return r}B3c(b,h){const r={};r["x-UserDataSignature"]=this.Ga.jb("UserDataSignature");r["x-LicensingIsEnabled"]=this.Ga.$("LicensingIsEnabled").toString();r["x-CacheIsEnabled"]=this.Ga.$("LicensingRedisIsEnabled").toString();r["x-OcpsIsEnabled"]=this.Ga.$("OcpsIsEnabled").toString();r["x-LicensingAADIdIsEnabled"]=this.Ga.$("LicensingAadIdIsEnabled").toString();0===b&&(r["x-LicenseCheckOnTenantEnabled"]="true",r["x-SupportUserConsentDependentFeatures"]="true",r["x-AFHUserConsentGroupValue"]=
"0",r["x-UseShellServiceForUserConsentGroup"]="true",r["x-SMBUserLicensingEnabled"]="true",r["x-AFHPIPLComplianceEnabled"]=Fa.a.KL(window.location.href,"wd_afhpipl")||"false",r["x-ConsumerLicensingSNICertIsEnabled"]=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),r["x-MSGraphInLicensingIsEnabled"]=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",!1).toString());if(h)for(const A of h.keys)r[A]=h.K(A);
return r}}Object(u.a)(Na,"HttpRequestToPromiseUtility",null,[]);var Aa;(function(b){b[b.mJn=0]="loki";b[b.nWp=1]="augloopACLP"})(Aa||(Aa={}));Object(u.b)("AlternateAuthSupportApp",Aa);class wa{constructor(){this.Token=null;this.ExpirationTime=0}}Object(u.a)(wa,"WacAlternateAuthToken",null,[]);class va{constructor(b,h){this.Znp=3E5;this.Pao=r=>{let A=null;({hv:A}=G.d(r));return A};if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=
b;this.Hwd=new Ha.a(Wa.a.vh());this.ZIc=new Na(b,h);void 0!==W.a.n7f&&null!==W.a.n7f&&void 0!==W.a.Kie&&null!==W.a.Kie&&0<W.a.Kie&&(b=new wa,b.Token=W.a.n7f,b.ExpirationTime=W.a.Kie,this.Hwd.W("loki",b))}Iim(){let b=null;this.Hwd.mb(Aa[0])&&(b=this.Hwd.K(Aa[0]));return void 0===b||null===b||this.sge(b)?this.K7l():Promise.resolve(b.Token)}sge(b){return b.ExpirationTime-Date.now()<this.Znp}K7l(){const b=new Ha.a(Wa.a.vh());b.W("X-AlternateAuthApp",Aa[0]);return this.ZIc.MMb(this.TVa("/afhs/AlternateAuthHelperHandler.ashx"),
this.Pao,2,b).then(h=>{v.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",Aa[0]);this.Hwd.W(Aa[0],h);return h.Token},h=>{h=Object(Ma.a)(Ka,h);v.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",h.message,h.httpStatusCode);return null})}TVa(b){const h=this.Ga.$("SuiteOriginForAFHSIsEnabled")?this.Ga.jb("SuiteOrigin"):this.Ga.jb("WebServiceBase");return String.format("{0}{1}?{2}",
h,b,y.AFrameworkApplication.xm)}}Object(u.a)(va,"AlternateAuthHelper",null,[821]);var Pa=d(606);class Ta{constructor(b,h,r){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=r}}Object(u.a)(Ta,"FeatureStateChangeArgs",null,[]);var kb=d(862),gb=d(204),tb=d(80),hb=d(117),Xa;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(Xa||(Xa={}));Object(u.b)("FeatureState",Xa);var $a=d(19),La=d(12),bb=d(91);class Gb{constructor(b,h,r=null,
A=null,M=null){this.Ppb=this.eqa=this.fCh=this.Hjb=this.wNd=null;this.Uao=ba=>{(ba=G.b(ba))?(v.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),v.ULS.sendTraceTag(50938594,3004,50,"{0}",ba)):v.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return ba.Features};this.tWm=()=>{v.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.Ppb.then(ba=>{this.BAj(ba)}).catch(()=>{this.BAj({})})};this.Qio=ba=>{try{ba&&"Date"in ba&&(this.eqa=new Date(ba.Date),v.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.eqa.toString()))}catch(oa){v.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",oa)}};this.ZIc=new Na(b,h);this.Ga=b;this.wEk=b.fc("LicensingMaxRetryAttempts",0);this.WEd=b.$("IsO365ConsumerHost");this.PXe=b.$("IsO365CommercialHost");
this.iXe=b.$("PremiumUpsellIsEnabled");this.r8b=!1;this.n_e=0;this.Hbh=r;this.gKh=A;this.ga=M;this.Gjb=b.$("LicensingIsEnabled");this.sGb=b.$("OcpsIsEnabled")&&this.PXe;this.tcf=b.$("ShowPrivacyDialog")&&!!A;this.g8b=b.$("IsAnonymousUser");this.v2d=new Promise(ba=>{ba(!1)});this.oAb=new Promise(ba=>{ba(!0)});this.Opb=new Ha.a(Wa.a.vh());this.MPd=!0;this.hth=this.nzm();this.Jab()&&!this.g8b?(void 0!==y.AFrameworkApplication.ta&&null!==y.AFrameworkApplication.ta&&(this.wNd=y.AFrameworkApplication.ta.$r,
void 0!==this.wNd&&null!==this.wNd&&(this.Hjb=this.wNd.rYa("WebServiceCall","ApplicationFeatureHelperService"))),this.Ppb=this.CKg()):this.Ppb=new Promise(ba=>{ba({})});this.Ppb.catch(ba=>{ba=Object(Ma.a)(Ka,ba);v.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",ba?ba.httpStatusCode.toString():"Unknown")});this.MPd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ba=>{this.r8b=ba;return null})}nzm(){const b=this.Ga.my("AllLicensedFeatures")?this.Ga.pD("AllLicensedFeatures"):
[],h=new Pa.a;for(let r=0;r<b.length;r++)h.add(b[r]);return h}Jab(){return this.PXe||this.WEd}CKg(b=0,h=!1){v.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const r=kb.a.cH();r&&(r.set("retryAttempt",b.toString()),r.set("forceRefresh",h.toString()),r.set("isO365ConsumerHost",this.WEd.toString()),r.set("isO365CommercialHost",this.PXe.toString()),r.set("isFreemiumUpsellSettingEnabled",this.iXe.toString()));za.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",r);za.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",r);void 0!==this.Hjb&&null!==this.Hjb&&this.Hjb.start();let A=null;h&&(A=new Ha.a(Wa.a.vh()),A.W("x-LicensingForceRefresh","true"));this.fCh=new Date;return(this.Gjb?this.ZIc.MMb(this.TVa("/afhs/ApplicationFeatureHelperHandler.ashx"),this.Uao,0,A,this.Qio,["Date"]):Promise.resolve({})).then(M=>{const ba=Object.assign(new bb.a,{durationMs:this.HYj()});ba.extendedProperties=r;ba.extendedProperties&&
M&&(ba.extendedProperties.set("featureCount",tb.a.count(M).toString()),ba.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in M).toString()),ba.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in M).toString()),"FreemiumUpsell"in M&&ba.extendedProperties.set("isFreemiumUpsellEnabled",M.FreemiumUpsell.toString()),this.eqa&&ba.extendedProperties.set("fromCache",(this.eqa<this.fCh).toString()));za.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
ba);return M},M=>{const ba=Object.assign(new bb.a,{durationMs:this.HYj()}),oa=Object(Ma.a)(Ka,M);if(!oa)return v.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),za.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ba),new Promise((Ja,jb)=>{jb(M)});ba.extendedProperties=r;ba.extendedProperties&&ba.extendedProperties.set("status",oa.httpStatusCode.toString());
za.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ba);return 408===oa.httpStatusCode&&++b<=this.wEk?this.CKg(b):new Promise((Ja,jb)=>{jb(oa)})})}TVa(b){var h=this.Ga.$("SuiteOriginForAFHSIsEnabled")?this.Ga.jb("SuiteOrigin"):this.Ga.jb("WebServiceBase");h=String.format("{0}{1}",h,b);this.Ga.my("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ga.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=Gb.B7d(this.Ga))&&0<b.length&&(this.MPd&&(b+="ucbf"),h=new gb.QueryStringBuilder(h),
h.Ae("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.sGb&&!this.tcf&&!this.Gjb)return this.oAb;v.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",b);if("ConnectedServices"===b){var r=this.sGb?this.Hbh.rN("ControllerConnectedServicesEnabled"):this.oAb;const ba=this.tcf?this.gKh.getSettings().then(oa=>2!==oa.nL,()=>h):this.oAb;return r.then(oa=>oa?ba:this.v2d)}if("FreemiumUpsell"===b&&(!this.iXe||!this.WEd||
this.g8b))return this.v2d;r=null;r=this.sGb?this.Hbh.isFeatureEnabled(b):this.oAb;let A=null;A=this.Gjb?this.iln(b,h):this.oAb;let M=null;M=this.tcf?this.gKh.isFeatureEnabled(b):this.oAb;return r.then(ba=>ba?M.then(oa=>oa?A:this.v2d):this.v2d).then(ba=>{this.J$i(b,ba,!0);return ba},()=>{this.J$i(b,h,!1);return h})}J$i(b,h,r){v.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,r)}getFeatureTier(b,h){if(!this.Gjb)return new Promise(r=>{r(2)});v.ULS.sendTraceTag(42804871,
3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.Ppb.then(r=>this.E9d(b,r,h),()=>h)}isFreemiumUpsellEnabled(){if(this.iXe&&this.WEd&&!this.g8b){if(this.r8b&&2!==this.n_e||!this.r8b&&1!==this.n_e)v.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.r8b.toString()),this.n_e=this.r8b?2:1;return this.r8b}return!1}launchUpsellExperience(b,h=null){v.ULS.sendTraceTag(594564814,3004,
50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var r=kb.a.cH();r&&(r.set("experienceId",b),h&&r.set("campaignId",h));za.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",r);(r=$a.a.instance.Oa(791))?r.s6i(b,this.tWm,h):(v.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),za.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,
null),this.ga.Pb(La.a.C4d,2,{["experience"]:b}))}Yua(b,h){if(!this.Gjb)return null;if(!b||!h)return v.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const r=hb.a.create().toString();this.Opb.mb(b)||this.Opb.W(b,new Ha.a(Wa.a.vh()));this.Opb.K(b).add(r,h);v.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",r,b));return r}CZb(b,
h){this.Gjb&&(b&&this.Opb.mb(b)?h&&hb.a.isValid(h)?this.Opb.K(b).mb(h)?(v.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.Opb.K(b).remove(h)):v.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):v.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
h,b)):v.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}E9d(b,h,r){return this.MPd?b in h?h[b].LicenseTier:r:b in h?this.Hbo(h[b],r):r}Hbo(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}BAj(b){v.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.CKg(0,!0);
h.then(r=>{this.Ppb=h;tb.a.count(r)>tb.a.count(b)?za.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):za.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(const A of this.Opb.keys)if(A in r){const M=this.E9d(A,r,0);A in b?this.E9d(A,b,0)!==M&&this.Vcg(A,!0,M):this.Vcg(A,!0,M)}else A in b&&this.Vcg(A,!1,this.E9d(A,b,0))}).catch(r=>{za.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);v.ULS.sendTraceTag(594051086,
3004,10,JSON.stringify(r))})}Vcg(b,h,r){v.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,r);h=new Ta(b,h,r);r=this.Opb.K(b);for(const A of r)try{A.value(h)}catch(M){v.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",b,A.key,M.message))}}hln(b,h){if(this.Gjb){const r=
this.hth.contains(b);let A=!0,M="",ba=!1;return this.Ppb.then(oa=>{b in oa?(oa=oa[b],M=Xa[oa.FeatureState],A=1!==oa.FeatureState):A=!r;this.Y$i(b,r,M,ba,h,A);return A},()=>{ba=!0;r&&(A=h);this.Y$i(b,r,M,ba,h,A);return A})}return this.oAb}Y$i(b,h,r,A,M,ba){v.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,A,r,M,ba)}iln(b,h){if(this.MPd)return this.hln(b,h);if(this.Gjb){if(this.hth.contains(b))return this.Ppb.then(r=>
b in r,()=>h);v.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.oAb}HYj(){if(void 0!==this.Hjb&&null!==this.Hjb){const b=this.Hjb.Hi;this.Hjb.stop();return b}return null}static B7d(b){try{if(X.a.HBe){const h=b.jb("UserDataSignature").split(".");if(1<h.length){const r=window.self.atob(h[1]),A=JSON.parse(r).LocalStorageKey;if(void 0!==A&&null!==A&&0<A.length)return A}}}catch(h){v.ULS.sendTraceTag(578863816,
3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(u.a)(Gb,"ApplicationFeatureHelper",null,[822]);var qb=d(72);class Sa{constructor(b,h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(u.a)(Sa,"CloudPolicySettingsCacheData",null,[]);var cb=d(1256),pb=d(595),vb=d(299);class xb{static $Vj(){return y.AFrameworkApplication.J.$("SideCarIsEnabled")?xb.jwe&&
xb.g9c?new Promise(b=>{b(!0)}):new Promise((b,h)=>{xb.jwe=vb.a.create(y.AFrameworkApplication.J.jb("SideCarUrl"));pb.a.y_(xb.jwe);xb.jwe.n2((r,A)=>{(xb.g9c=A.succeeded)?b(A.succeeded):h(A.succeeded)})}):new Promise(b=>{b(!1)})}}xb.g9c=!1;xb.jwe=null;Object(u.a)(xb,"SideCarLoader",null,[]);class Bb{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(u.a)(Bb,"CloudPolicySettingsData",null,[]);class jc{constructor(b,h){this.IMe=0;this.oWd=null;this.Yao=r=>{let A=
null;({hv:A}=G.d(r));r=!!A;v.ULS.sendTraceTag(50622687,3004,r?50:10,"ParseCloudPolicySettingsResponse: Success={0}",r);return A};this.cjo=r=>{try{if(void 0!==r&&null!==r&&"CheckIn-Interval"in r){const A=parseInt(r["CheckIn-Interval"]);void 0!==A&&null!==A&&0<A&&(this.IMe=A)}}catch(A){v.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",A)}};this.ZIc=new Na(b,h);this.Ga=b;h=b.jb("HostAuthType");this.sGb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===
h||null===h)&&"aad"===h.toLowerCase();this.Dwh=G.b(b.jb("OcpsDefaultSettings")||"{}");this.lLc=this.B7d();h=this.Ga.my("ServicesControlsMicrosoftControllerServicesList")?this.Ga.pD("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Qyd=new Pa.a;for(let r=0;r<h.length;r++)this.Qyd.add(h[r]);this.sGb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.oWd=this.gsp():this.oWd=this.BKg(this.sGb,this.TVa("/afhs/CloudPolicySettings.ashx"),this.Yao);this.oWd.then(()=>null).catch(r=>{r=Object(Ma.a)(Ka,
r);v.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",r?r.httpStatusCode.toString():"Unknown")})}rN(b,h=!0,r=!0){if(!this.sGb){const oa=this;return new Promise(Ja=>{Ja(oa.h4c(b))})}const A=this,M=this,ba=this.oWd.then(oa=>{try{let Ja=null;oa.PolicySettings&&"unknown"in oa.PolicySettings&&(Ja=oa.PolicySettings.unknown);if(Ja){if(b in Ja&&void 0!==Ja[b]&&null!==Ja[b])return new Promise(zb=>{zb("0"!==Ja[b])});const jb=b.toLowerCase();if(jb in Ja&&void 0!==
Ja[jb]&&null!==Ja[jb])return new Promise(zb=>{zb("0"!==Ja[jb])});if(r)return v.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default"),new Promise(zb=>{zb(A.h4c(b))});v.ULS.sendTraceTag(508395746,3004,50,"Policy"+b+" not found, returning PolicyNotConfigured error");return new Promise((zb,Eb)=>{Eb("PolicyNotConfigured")})}return new Promise(jb=>{jb(A.h4c(b))})}catch(Ja){return v.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",Ja.message),A.handleError(Ja.toString(),
h,A.h4c(b))}},oa=>M.handleError(oa,h,M.h4c(b)));ba.then(oa=>{v.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,oa);return null});return ba}isFeatureEnabled(b,h=!0){if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.kln(b,h);let r=new Promise(M=>{M(!0)}),A="";this.Qyd.contains(b)&&(A="ControllerConnectedServicesEnabled",r=this.rN(A,h));r.then(M=>{v.ULS.sendTraceTag(50651668,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,M,A);return null});return r}kln(b,h=!0){let r=new Promise(M=>{M(!0)}),A="";"mso_sendASmile"===b?A="Enabled":"Survey"===b||"FloodgateSurvey"===b?A="SurveyEnabled":this.Qyd.contains(b)&&(A="ControllerConnectedServicesEnabled");""!==A&&(r=this.rN(A,h));r.then(M=>{v.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
b,M,A);return null});return r}handleError(b,h,r){return h?new Promise(A=>{A(r)}):new Promise((A,M)=>{M(b)})}BKg(b,h,r){if(!b)return Promise.resolve(new Bb);let A=!1,M=null;za.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ba=this.Ssf("GetCloudPolicySettings");return(new Promise((oa,Ja)=>{if(void 0!==this.lLc&&null!==this.lLc&&0<this.lLc.length){const jb=this.Irp();if(void 0!==jb&&null!==jb){A=!0;oa(jb);return}}this.ZIc.MMb(h,r,1,null,this.cjo,["CheckIn-Interval"],
this.Ga.fc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ga.fc("CloudPolicySettingsRequestSentTimeout",3E4)).then(jb=>{v.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Ysp(jb);oa(jb);return jb},jb=>{Ja(jb);return null})})).then(oa=>{({rz:ba,returnValue:M}=this.aBe(ba));var Ja=kb.a.cH();Ja&&Ja.set("FromCache",A.toString());Ja=Object.assign(new bb.a,{durationMs:M,extendedProperties:Ja});za.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Ja);return oa})}gsp(){return xb.$Vj().then(()=>
{v.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}TVa(b){const h=this.Ga.$("SuiteOriginForAFHSIsEnabled")?this.Ga.jb("SuiteOrigin"):this.Ga.jb("WebServiceBase");return String.format("{0}{1}",h,b)}h4c(b){return b in this.Dwh?"0"!==this.Dwh[b]:!0}Irp(){try{const b=cb.a.instance.getItem(this.lLc);if(void 0===b||null===b)return v.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;v.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return v.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return v.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;
if((new Date(h.ExpirationTime)).getTime()<Date.now())return v.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const r=new Bb;r.PolicySettings=h.PolicySettings;r.ControllerConnectedServicesFeatureNames=new qb.a;this.Ga.my("ServicesControlsMicrosoftControllerServicesList")&&this.Ga.pD("ServicesControlsMicrosoftControllerServicesList");for(const A of this.Qyd)r.ControllerConnectedServicesFeatureNames.add(A);v.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");
return r}catch(b){return v.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}Ysp(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)v.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.IMe)v.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new Sa(b,this.IMe),r=JSON.stringify(h);
v.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",r);cb.a.instance.setItem(this.lLc,r);v.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){v.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}B7d(){const b=Gb.B7d(this.Ga);return b&&0<b.length?"OCPS"+b:null}Ssf(b){const h=$a.a.instance.Oa(38);return void 0!==h&&null!==h?h.Xf("WebServiceCall",b):null}aBe(b){if(void 0!==
b&&null!==b){const h=b.Hi;b.stop();return{returnValue:h,rz:null}}return{returnValue:null,rz:b}}}Object(u.a)(jc,"CloudPolicySettingsHelper",null,[819]);class xc{constructor(){this.lii=this.aak=this.nL=0;this.mii=this.bak=this.yMb="";this.F9e=this.U0a=2}clone(){const b=new xc;b.nL=this.nL;b.aak=this.aak;b.lii=this.lii;b.yMb=this.yMb;b.bak=this.bak;b.mii=this.mii;b.U0a=this.U0a;b.F9e=this.src;return b}get src(){return this.F9e}serialize(b=null){const h={};if(!b||b.contains(xc.xWb))h[xc.xWb]=this.nL;
if(!b||b.contains(xc.Hed))h[xc.Hed]=this.yMb;if(!b||b.contains(xc.Ied))h[xc.Ied]=this.U0a;return JSON.stringify(h)}static create(b,h=null){const r=new xc;r.F9e=b;void 0!==h&&null!==h&&(xc.xWb in h&&(r.nL=h[xc.xWb]),xc.Hed in h&&(r.yMb=h[xc.Hed]),xc.Ied in h&&(r.U0a=h[xc.Ied]));return r}static deserialize(b,h){try{const r=JSON.parse(b);if(void 0!==r&&null!==r)return xc.create(h,r);v.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",b);throw Error.argument("settingsData");
}catch(r){throw v.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",r.toString()),r;}}}xc.xWb="CCS";xc.Hed="CCSTime";xc.Ied="OfficePrivacyRoamedNoticeShown";Object(u.a)(xc,"UserPrivacySettings",null,[]);var Qc=d(143);class fd{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=b;this.Gf=h;this.z8e=this.Ne=null}TVa(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",this.Ga.appSettings.RoamingServiceHandlerWebServiceBase||
"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(y.AFrameworkApplication.xm);return h.toString()}executeRequest(b,h,r,A=null){return this.Gf.kKb(b,h,A,null,r,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,r)=>{try{if(void 0===this.Ne||null===this.Ne||void 0===b||null===b)v.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),r("Can't determine setting changes to save");else{var A=this.Ne.nL!==b.nL;if(2===this.Ne.src&&A)this.INo(b),
h(!0);else{var M=this.QSo(b);if(void 0===M||null===M||!M.length)v.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),r("No changes to save");else if(1===this.Ne.src)h(this.T4j(M));else if(0===this.Ne.src){v.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",M);const ba=this.executeRequest(this.TVa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",M);ba.continueWith(()=>{if(ba.yp||ba.ij)v.ULS.sendTraceTag(50860929,
3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var oa=ba.result;void 0!==oa.args&&null!==oa.args&&void 0!==oa.args.data&&null!==oa.args.data&&oa.args.data.He===ea.a.xz?(v.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(v.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(ba){v.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",ba.toString()),
h(!1)}})}QSo(b){if(void 0===this.Ne||null===this.Ne||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new qb.a;0===b.src?(this.Ne.nL!==b.nL&&(h.add(xc.xWb),h.add(xc.Hed)),this.Ne.U0a!==b.U0a&&h.add(xc.Ied)):1===b.src&&this.Ne.nL!==b.nL&&h.add(xc.xWb);return h.count?b.serialize(h):(v.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.z8e){const b=this;this.z8e=new Promise(h=>
{try{b.Ne?h(b.Ne.clone()):b.Zrp().then(r=>{b.Ne=r;h(b.Ne.clone());return null},()=>{b.Xrp().then(r=>{b.Ne=r;h(b.Ne.clone());return null},()=>{b.Yrp().then(r=>{b.Ne=r;h(b.Ne.clone());return null},()=>{v.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Ne=new xc;h(b.Ne.clone());return null});return null});return null})}catch(r){v.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",r.toString()),b.Ne=new xc,h(b.Ne.clone())}})}return this.z8e}Zrp(){return new Promise((b,
h)=>{try{const A=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ga.$("PrivacyDialogShouldCheckRoaming")||A){var r=this.executeRequest(this.TVa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");r.continueWith(()=>{try{if(r.yp||r.ij)v.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const M=r.result;if(M&&M.args&&M.args.data)if(M.args.data.He!==ea.a.xz)v.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",
M.args.data.He);else{if(M.args.data.Ee){b(fd.parse(M.args.data.Ee,0));v.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",M.args.data.Ee);return}v.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else v.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(M){v.ULS.sendTraceTag(50860938,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",M.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else v.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(A){v.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",A.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}Xrp(){return new Promise((b,
h)=>{try{const r=Qc.a.get("WacUPToggleState");let A=null;void 0!==r&&null!==r&&0<r.length&&(A=decodeURIComponent(r));if(void 0!==A&&null!==A&&0<A.length){const M=fd.parse(A,1);v.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",M.toString());b(M)}else{const M=xc.create(1),ba=new qb.a;ba.add(xc.xWb);const oa=M.serialize(ba);this.T4j(oa)?(v.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",
oa),b(M)):(v.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",oa),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(r){v.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",r.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}Yrp(){return new Promise(b=>{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");const r=xc.create(2);h?(r.nL=
2,y.AFrameworkApplication.kgi(),v.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.nL=1,v.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString()));b(r)}catch(r){v.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",r.toString()),h=xc.create(2),h.nL=1,b(h)}})}INo(b){v.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");
2===b.nL?y.AFrameworkApplication.kgi():y.AFrameworkApplication.P0l();v.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}T4j(b){try{v.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Ga.jb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");v.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Qc.a.hRj("WacUPToggleState",
b,Qc.a.mMa,h)}catch(h){return v.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const r=this.Ga.my("ServicesControlsMicrosoftControllerServicesList")?this.Ga.pD("ServicesControlsMicrosoftControllerServicesList"):[],A=new Pa.a;for(let M=0;M<r.length;M++)A.add(r[M]);return A.contains(b)?2!==h.nL:!0},()=>{v.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);
return!0})}static parse(b,h){try{return v.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),xc.deserialize(b,h)}catch(r){throw v.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",r.toString()),r;}}}Object(u.a)(fd,"UserPrivacySettingsHelper",null,[820]);class Ac{constructor(){this.Z=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}uc(b){this.Z=b;this.Z.register(819,84).ha().Sd(()=>new jc(y.AFrameworkApplication.J,
y.AFrameworkApplication.Ge));this.Z.register(820,83).ha().Sd(()=>new fd(y.AFrameworkApplication.J,y.AFrameworkApplication.Ge));this.Z.register(821,153).ha().Sd(()=>new va(y.AFrameworkApplication.J,y.AFrameworkApplication.Ge));this.Z.register(822,4).ha().Sd(()=>new Gb(y.AFrameworkApplication.J,y.AFrameworkApplication.Ge,this.Z.resolve(84),this.Z.resolve(83),y.AFrameworkApplication.va))}init(){y.AFrameworkApplication.J.xp(()=>{const b=this.Z.resolve(4);y.AFrameworkApplication.J.$("LicensingIsEnabled")&&
(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{v.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,y.AFrameworkApplication.J.jb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{v.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,y.AFrameworkApplication.J.jb("IsAnonymousUser"));
return null}));this.Z.resolve(153);this.alp()})}dispose(){}alp(){try{y.AFrameworkApplication.J.$("SideCarIsEnabled")&&xb.$Vj().then(b=>{v.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){E.a.instance.Mc(new Ac)}}Object(u.a)(Ac,"ApplicationFeatureHelperPackage",null,[0,1]);var Nb=d(173);class ib{G7d(b,h){let r;const A=[];for(;r=h.exec(b);){const M=r.index;A.push(new Nb.a(M,M+r[0].length))}return A}isEndPuncSpecialCase(b){const h=
this.G7d(b,ib.Ucp);for(const r of h)if(r.end===b.length)return!0;return!1}j0c(b){for(const h of ib.t5l){const r=this.G7d(b,h);if(0<r.length&&!r[0].Dc)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var A=b.substring(r,h);b=this.G7d(A,ib.bki);for(h=b.length-1;0<=h;h--){const M=A.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(M))return A=A.substring(b[h].Dc,A.length),r+b[h].end+this.j0c(A)}return r}findEndBoundary(b,h,r){var A=b.substring(h,r);b=this.G7d(A,ib.bki);for(r=0;r<b.length;r++){const M=
A.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(M))return A=A.substring(b[r].Dc,A.length),h+b[r].end+this.j0c(A)}return-1}}ib.oCf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";ib.pCf=
"([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";ib.qCf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";ib.t5l=[new RegExp(ib.oCf,
"ig"),new RegExp(ib.pCf,"ig"),new RegExp(ib.qCf,"ig")];ib.GEg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";ib.JEg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";ib.IEg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
ib.HEg=ib.JEg+"|"+ib.IEg;ib.KEg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";ib.LEg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";ib.MEg="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
ib.NEg="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";ib.Byg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
ib.HEg+"|"+ib.KEg+"|"+ib.LEg+")";ib.Ayg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
ib.MEg+")";ib.vcg=ib.GEg+"|"+ib.NEg;ib.FEg=ib.vcg+"|"+ib.Byg+"|"+ib.Ayg;ib.bki=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");ib.Ucp=new RegExp(ib.FEg,"g");Object(u.a)(ib,"ProofingSentenceSeparatorScriptSharp",null,[814]);class Rb{uvd(b,h){const r=[];let A;for(;null!=(A=h.exec(b));){const M=A.index;r.push({Dc:M,end:M+A[0].length})}return r}isEndPuncSpecialCase(b){return this.uvd(b,Rb.Xjk).some(h=>
h.end==b.length)}j0c(b){for(const h of Rb.qgk){const r=this.uvd(b,h);if(0<r.length&&0==r[0].Dc)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var A=b.substring(r,h);b=this.uvd(A,Rb.JQg);for(h=b.length-1;0<=h;h--){const M=A.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(M))return A=A.substring(b[h].Dc,A.length),r+b[h].end+this.j0c(A)}return r}findEndBoundary(b,h,r){var A=b.substring(h,r);b=this.uvd(A,Rb.JQg);for(r=0;r<b.length;r++){const M=A.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(M))return A=
A.substring(b[r].Dc,A.length),h+b[r].end+this.j0c(A)}return-1}}Rb.Yek="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Rb.Sjk="[\u2639\u263a\u263b]";Rb.MRg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Rb.Zfk="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Rb.Qik="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Rb.SRg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Rb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Rb.LRg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Rb.Ohk="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Rb.Nhk="[\uff21-\uff3a\uff41-\uff5a]";Rb.Lhk="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Rb.Khk="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Rb.Mhk="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Rb.GHe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Rb.IQg="[\u3002\uff61]";Rb.Svd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Rb.ygk="[\u00bb\u2019\u201d\u203a\"']";Rb.dIe=Rb.Yek+"|"+Rb.Sjk;Rb.Phk="[\u2028\u2029\n\r]";Rb.Jhk="("+Rb.Svd+"|"+Rb.MRg+"|"+Rb.SRg+"|"+Rb.LRg+
")";Rb.Ihk="("+Rb.Svd+"|"+Rb.MRg+"|"+Rb.SRg+"|"+Rb.Symbol+"|"+Rb.LRg+"|"+Rb.Zfk+"|"+Rb.Qik+")";Rb.oCf="("+Rb.GHe+"("+Rb.dIe+"|"+Rb.ygk+"|"+Rb.Svd+")*"+Rb.Phk+")";Rb.pCf="("+Rb.GHe+"("+Rb.dIe+")*("+Rb.Svd+")+)";Rb.qCf="("+Rb.IQg+"("+Rb.dIe+")*)";Rb.qgk=[new RegExp(Rb.oCf,"ig"),new RegExp(Rb.pCf,"ig"),new RegExp(Rb.qCf,"ig")];Rb.GEg="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Rb.JEg="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Rb.IEg="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Rb.HEg=Rb.JEg+"|"+Rb.IEg;Rb.KEg="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Rb.LEg="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Rb.MEg="(("+Rb.Ohk+"|"+Rb.Lhk+"|"+Rb.Mhk+")[.])+|(("+Rb.Khk+")[.\ufe52\uff0e])+";Rb.NEg="("+Rb.Nhk+")[.\ufe52\uff0e]";Rb.Byg=Rb.Jhk+"("+Rb.HEg+"|"+Rb.KEg+"|"+Rb.LEg+")";Rb.Ayg=Rb.Ihk+"("+Rb.MEg+")";Rb.vcg=Rb.GEg+"|"+Rb.NEg;Rb.FEg=Rb.vcg+"|"+Rb.Byg+"|"+Rb.Ayg;Rb.JQg=new RegExp(Rb.GHe+"|"+Rb.IQg,"ig");Rb.Xjk=new RegExp(Rb.FEg,"g");Object(u.a)(Rb,"ProofingSentenceSeparator",null,[814]);class ic{constructor(){this.Z=null}get name(){return"Box4.ProofingGrammarCheck"}uc(b){this.Z=b;y.AFrameworkApplication.J.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ia(216,()=>new Rb).ha():b.ia(216,()=>new ib).ha()}init(){this.Z.resolve(216)}dispose(){}static main(){E.a.instance.Mc(new ic)}}Object(u.a)(ic,"Box4GrammarCheckPackage",null,[0,1]);var kc=d(140),Jb=d(60),ec=d(1850),qa=d(20);class sa{constructor(){this.Z=null}get name(){return"Box4.AtMentions"}uc(b){this.Z=b;this.Z.ia(292,()=>new ec.a(this.Z.resolve(215),this.Z.resolve(212),this.Z.resolve(792),Object(Jb.a)(),"@",["@","/"])).ha()}init(){y.AFrameworkApplication.J.xp(()=>{this.Z.resolve(292).Udc(qa.StaticActiveAppFrame.za().kb,
kc.KeyInputManager.instance)})}dispose(){this.Z.resolve(292).dispose()}static main(){E.a.instance.Mc(new sa)}}Object(u.a)(sa,"Box4AtMentionsPackage",null,[0,1]);class ab{get name(){return"Box4.Workers"}uc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new ab)}}Object(u.a)(ab,"Box4WorkersPackage",null,[0,1]);var eb=d(308),fb=d(94);class Cb{constructor(){this.PPa=new fb.a}F8(b,h){this.PPa.W(b,h)}SGf(b){({value:b}=this.PPa.Ec(b));return b}}Object(u.a)(Cb,"AggregationMethodsForActivityName",null,
[]);var lc=d(254);class bc{constructor(){this.dKd=new eb.a;this.PPa=new eb.a}F8(b,h,r){this.PPa.mb(b)&&this.PPa.K(b)||this.PPa.W(b,new Cb);this.PPa.K(b).F8(h,r)}SGf(b,h){return this.PPa.mb(b)&&this.PPa.K(b)?this.PPa.K(b).SGf(h):null}y4c(b){this.dKd.mb(b)&&this.dKd.K(b)||this.dKd.W(b,new lc.a);return this.dKd.K(b)}Rci(b,h){this.y4c(b).add(h)}}Object(u.a)(bc,"ActivityAggregationInfo",null,[853]);var Za=d(251),Ib=d(970),Ub=d(986);class rc extends Ib.a{constructor(b,h){super(b);this.Pbf=(this.pnk=h)?
h.cum():Ub.a.AGf()}get QHa(){return this.pnk}get activityName(){return this.QHa.name}get startTime(){return this.QHa.startTime}get endTime(){return this.QHa.endTime}end(){}cancel(){}iFf(){}Yyp(){this.njc.W("AM",this.QHa.mode.toString());this.njc.W("C",this.QHa.count.toString());this.njc.W("DA",this.QHa.yii.toFixed(2));this.njc.W("DV",this.QHa.VZl.toFixed(2))}hNf(b){return this.QHa.hNf(b)}RNf(){return this.QHa.RNf()}Ucc(){for(const b of this.QHa.RHa)b.Ucc()}}Object(u.a)(rc,"AggregatedActivity",Ib.a,
[]);class yc{constructor(b,h){this.hKe=0;this.mFa=b;this.v1a=h}h5k(b,h){this.hKe=h;for(h=0;h<b.count;h++){const r=b.K(h);this.i5k(r)}}i5k(b){const h=Object(Ma.a)(rc,b);if(h)if(1===this.hKe)this.g5k(h);else if(2===this.hKe){this.j5k(h);for(const r of this.v1a.y4c(this.mFa)){const A=h.QHa.RHa.K(0);A.properties.mb(r)&&b.properties.W(r,A.properties.K(r))}}}g5k(b){for(const h of this.v1a.y4c(this.mFa))this.fJj(b,h)}j5k(b){for(const h of b.RNf())this.fJj(b,h)}fJj(b,h){const r=this.v1a.SGf(this.mFa,h);if(r){const A=
b.hNf(h);b.properties.W(h,r(A))}}}Object(u.a)(yc,"PropertyAggregationHelper",null,[]);var rb=d(1063);class $c{constructor(b,h,r,A,M){this.u4b=b;this.v1a=h;this.ich=M;this.QJe=A;this.SDk=r}get uMh(){return this.SDk.value}uWc(b){if(Object(Za.a)(rb.a,b))b.uWc();else if(Object(Za.a)(rc,b)&&this.QJe.z_h(b.activityName.toString())){b=Object(Ma.a)(rc,b);b.Yyp();b=b.rcj();var h=[];Array.add(h,b);b=G.c(h);v.ULS.sendTraceTag(6907266,213,50,b)}}aIa(b,h){const r=(new Date).getTime();var A=this.ich.list.K(b);
const M=({l5k:A}=this.Shm(A)).returnValue;this.ich.list.W(b,new qb.a);h&&(A=this.TDl(A,r,this.u4b.wLi));0<A.count&&(new yc(b,this.v1a)).h5k(A,M)}TDl(b,h,r){const A=new qb.a;for(let M=0;M<b.count;M++){const ba=b.K(M);ba.startTime>h-r?ba.Ucc():A.add(ba)}return A}Shm(b){const h=this.uMh.u1j(b);b=this.uMh.Emp(b);const r=this.m5k(h,b);return{returnValue:r,l5k:1===r?h:b}}m5k(b,h){return b.count*this.u4b.Rej<h.count?1:2}get enabled(){return this.u4b.enabled}Ucc(){}}Object(u.a)($c,"ActivityAggregationManager",
null,[851]);class cd{constructor(b){this.enabled=!1;this.idj=500;this.uej=2;this.Rej=5;this.wLi=3E4;this.r0c(b.appSettings)}r0c(b){this.enabled=Boolean.parse(b[cd.BAf]||"false");this.idj=parseInt(b[cd.KMn]||"500");this.uej=parseInt(b[cd.pPn]||"2");this.Rej=parseInt(b[cd.PPn]||"5");this.wLi=parseInt(b[cd.oUm]||"30000")}}cd.BAf="ActivityAggregationEnabled";cd.KMn="ActivityAggregationMaxInterval";cd.pPn="ActivityAggregationMinChain";cd.PPn="ActivityAggregationModeFactor";cd.oUm="ActivityAggregationGraceWindow";
Object(u.a)(cd,"ActivityAggregationParams",null,[]);class Rd{constructor(b,h){this.v1a=b;this.y8g=h}u1j(b,h=1){if(!b||!b.count)return b;const r=new qb.a;var A=null;for(let M=0;M<b.count;M++){const ba=b.K(M);if(!ba)continue;const oa=ba.activityName;A?A.Ywn(ba)?A.add(ba):(A=A.process(),r.addRange(A),A=this.y8g(oa,h),A.add(ba)):(A=this.y8g(oa,h),A.add(ba))}A&&(b=A.process(),r.addRange(b));return r}Emp(b){if(!b||!b.count)return b;const h={};var r=null;for(let M=0;M<b.count;M++){const ba=b.K(M);if(ba){if(!r){r=
new qb.a;var A=this.v1a.y4c(ba.activityName);for(const oa of A)r.add(oa)}A=this.vIm(ba,r);null!==A&&(A in h&&h[A]||(h[A]=new qb.a),h[A].add(ba))}}b=new qb.a;for(const M of tb.a.LR(h))r=this.u1j(h[M],2),b.addRange(r);return b}vIm(b,h){let r="";for(const A of h)r+=A,r=b.properties.mb(A)&&void 0!==b.properties.K(A)&&null!==b.properties.K(A)?r+b.properties.K(A):r+"null";return r}}Object(u.a)(Rd,"ActivityAggregationSchemes",null,[852]);class ge{constructor(b,h,r,A,M){this.rt=this.ki=0;this.u4b=r;this.yDc=
A;this.v1a=M;this.name=b;this.QC=h;this.RHa=new qb.a}get mode(){return this.QC}get count(){return this.RHa.count}get startTime(){return this.ki}get endTime(){return this.rt}get yii(){if(!this.count)return 0;let b=0;for(const h of this.RHa)b+=h.endTime-h.startTime;return b/this.count}get VZl(){if(!this.count)return 0;let b=0;const h=this.yii;for(const r of this.RHa){const A=r.endTime-r.startTime;b+=(A-h)*(A-h)}return b/this.count}add(b){this.count?this.rt=b.endTime>this.endTime?b.endTime:this.endTime:
(this.ki=b.startTime,this.rt=b.endTime);this.RHa.add(b)}Ywn(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.u4b.idj}process(){if(this.count>=this.u4b.uej){const b=new qb.a,h=this.yDc(this);b.add(h);return b}return this.RHa}hNf(b){const h=new qb.a;for(const r of this.RHa)if(r.properties.mb(b)){const A=r.properties.K(b);h.add(A)}else h.add(null);return h}RNf(){const b=this.v1a.y4c(this.name),h=new lc.a;for(const r of this.vim())b.contains(r)||h.add(r);return h}vim(){const b=new lc.a;if(!this.RHa)return b;
for(const h of this.RHa)for(const r of h.properties.keys)b.add(r);return b}cum(){return this.RHa.K(0).uniqueID}}Object(u.a)(ge,"ActivityCollection",null,[850]);class Ze{constructor(){this.sCb=new eb.a}get list(){return this.sCb}add(b){const h=b.activityName;if(this.sCb.mb(h)&&this.sCb.K(h)){const r=this.qxm(this.sCb.K(h),b);this.sCb.K(h).insert(r,b)}else this.sCb.W(h,new qb.a),this.sCb.K(h).add(b)}qxm(b,h){for(let r=b.count-1;0<=r;r--)if(h.startTime>b.K(r).startTime)return r+1;return 0}}Object(u.a)(Ze,
"CompletedActivitiesHelper",null,[844]);class De{constructor(){this.Z=null}get name(){return"Common.App.ActivityAggregator"}init(){y.AFrameworkApplication.JH(()=>{this.Z.resolve(793)})}dispose(){}uc(b){this.Z=b;const h=A=>new rc(()=>b.Oa(132),A),r=(A,M)=>new ge(A,M,b.resolve(794),h,b.resolve(181));b.register($c,793).as(132).ha().Sd(()=>new $c(b.resolve(794),b.resolve(181),b.rf(795),b.resolve(133),b.resolve(796)));b.register(cd,794).ha().Sd(()=>new cd(y.AFrameworkApplication.J));b.register(bc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as(181).ha().Sd(()=>
new bc);b.register(Rd,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as(795).ha().Sd(()=>new Rd(b.resolve(181),r));b.register(Ze,796).ha().Sd(()=>new Ze)}static main(){E.a.instance.Mc(new De)}}Object(u.a)(De,"ActivityAggregatorPackage",null,[0,1]);var Df=d(706),zd=d(10),hg=d(1276);class ni{constructor(b){this.yAh=0;this.DMe=null;this.svc=()=>{v.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(h=>{h.getChatsContainer(this.oYn)}).catch(h=>
{v.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",h)}),this.chat.getChatsCounter().then(h=>{h.onChatsCountChange(this.mpl)}).catch(h=>{v.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",h)}),this.chat.getKeyboard().then(h=>{h.onKeyDown(this.rYn)}).catch(h=>{v.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",h)}))}catch(h){v.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",h)}};this.mpl=
h=>{v.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",h);if(!h)this.LBg.nYn();else if(1===h&&!this.yAh){const r=document.getElementById(this.DMe?this.DMe:hg.a.QLb);r?this.LBg.sYn(r,this.Gpp):v.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.yAh=h};this.oYn=h=>{this.DMe=h};this.rYn=h=>{h.ctrlKey&&"f6"===h.key.toLowerCase()&&this.Fpp(h.shiftKey)};this.Gpp=()=>{v.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(h=>{h.focusConversationInput()}).catch(h=>
{v.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",h)})}catch(h){v.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",h)}};this.VKk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get LBg(){return this.VKk.value}Wb(){this.isInitialized?this.svc():this.txo(this.svc)}txo(b){Df.a.instance.nb(zd.a.oip,window.self,()=>{b();return!0})}Fpp(b){v.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.LBg.pYn(b)}}Object(u.a)(ni,
"ChatManager",null,[841]);var Fd=d(86);class Uc{constructor(){this.sa=new Fd.a;this.zRk=!1}X2k(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}E2k(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get wop(){return this.zRk}Cyj(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(u.a)(Uc,"HeaderEventSource",null,[]);var pd=d(180),He=d(369),rf=d(93);class Rf{constructor(b,h,r,A,M){this.bPd=null;this.qYn=()=>{this.bPd&&this.bPd()};this.Zb=b;this.kq=
h;this.ml=r;this.CRk=A;this.ga=M}eBj(b,h,r,A=null){const M=this.Zb.ie(h);M.parent=r;M.YL=!0;A&&M.T$(A);this.ml.SHa(h,b,!1);this.CRk.SHa(h,b,!1);h=new He.DOMFocusListing(()=>b);h.un(2);h.un(1);h.un(8);h.un(5);h.un(3);h.un(6);this.Zb.gra(()=>b,M,h).BP=!0;h=kc.KeyInputManager.lc(rf.a.wz,0);r=kc.KeyInputManager.lc(rf.a.wz,4);M.qt(h);M.qt(r)}onFlexPaneOpen(b){this.eBj(b,hg.a.Hrc,hg.a.BWa);this.Zb.Eg(hg.a.Hrc);this.kq.S$(hg.a.Hrc)}onFlexPaneClose(){this.kq.Cx(hg.a.Hrc);this.Zb.Eg(hg.a.BWa)}sYn(b,h){this.bPd||
(this.bPd=h,this.eBj(b,hg.a.QLb,pd.AFrame.VO,this.qYn));this.Zb.Eg(hg.a.QLb);this.kq.S$(hg.a.QLb)}nYn(){this.kq.Cx(hg.a.QLb);this.Zb.r4d(pd.AFrame.Jo)}pYn(b){this.ga.Ob(b?La.a.MCf:La.a.o2d,2)}}Object(u.a)(Rf,"ReactSharedHeaderFocusManager",null,[840]);var kd=d(123),ff=d(1038),Te=d(39),xe=d(87);class jf{constructor(b){this.Cgj=(h,r,A,M,ba)=>{if(1===A)return 32;h=8;2===A&&(A=this.eIf(ba,"experience","gopremiumribbon"),ba=Fa.a.Xaa("2116536"),ba=Fa.a.Lp(ba,"ocid",ff.b(y.AFrameworkApplication.ta.Hb.Uk,
y.AFrameworkApplication.ta.Hb.Lma,A)),Te.a.Cn(ba,"_blank",void 0,"NavigateToUpsellPage"),h=32,this.ga.Ob(La.a.QFj,2),v.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return h};this.launchUpsellExperience=(h,r,A,M,ba)=>{if(1===A)return 32;var oa=8;2===A&&(v.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(oa=$a.a.instance.Oa(4))?(h=this.eIf(ba,"experience","gopremium"),ba=this.eIf(ba,"dimeCampaignId",null),oa.launchUpsellExperience(h,ba),oa=32):(v.ULS.sendTraceTag(594874952,
340,15,"ApplicationFeatureHelper not available"),oa=this.Cgj(h,r,A,M,ba)));return oa};this.ga=b}Wb(){this.ga.qa(La.a.C4d,xe.a.frame,this.Cgj);this.ga.qa(La.a.Ari,xe.a.frame,this.launchUpsellExperience);this.ga.qa(La.a.NGo,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.QFj,xe.a.frame,kd.ActionManager.$f)}eIf(b,h,r){b&&b[h]&&(r=Object(Ma.a)(String,b[h]));return r}}Object(u.a)(jf,"UpsellActor",null,[839]);class Gg{constructor(){this.Z=null}get name(){return"Common.App.Header"}init(){$a.a.instance.resolve(797).Wb();
$a.a.instance.resolve(798).Wb()}dispose(){}uc(b){this.Z=b;this.Z.register(Uc,694).ha();this.Z.register(jf,"Common.App.Header.UpsellActor").as(797).ha().Sd(()=>new jf(y.AFrameworkApplication.va));this.Z.register(Rf,"Common.App.Header.ReactSharedHeaderFocusManager").as(799).ha().Sd(()=>new Rf(y.AFrameworkApplication.ta.xq,y.AFrameworkApplication.ta.Jy,y.AFrameworkApplication.ta.e9,y.AFrameworkApplication.ta.KCe,y.AFrameworkApplication.va));this.Z.register(ni,"Common.App.Header.ChatManager").as(798).ha().Sd(()=>
new ni(this.Z.rf(799)))}static main(){E.a.instance.Mc(new Gg)}}Object(u.a)(Gg,"CommonAppHeaderPackage",null,[0,1]);var ng=d(757);class pg{static Dti(b,h){switch(b){case 3:return pg.kTm(h);case 2:return pg.OEm(h);case 1:return pg.Hsm(h)}return""}static kTm(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static OEm(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static Hsm(b){switch(b){case 1:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return y.AFrameworkApplication.J.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static bY(b,h,r){if(X.a.Di||X.a.CI)window.setTimeout(()=>{pg.oAj(r,pg.S9d())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(pg.iSh(r),b,0,!1)}static cul(b,h,r,A){h&&A&&A();
pg.bY(b,h,r)}static S9d(){return X.a.Di?1:X.a.CI?2:X.a.fbb?3:X.a.om?4:0}static RSm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static SSm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get q_f(){return"zh-CN"===window.navigator.language}static oAj(b,h){1===h?(v.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=pg.Dti(b,h),8<X.a.A$a?Te.a.Cn(b,void 0,void 0,"RedirectToAppStore"):Te.a.dqb(b)):document.hidden||(pg.q_f?(b=y.AFrameworkApplication.J.appSettings.WildFireUrlChinaStoreAndroid.toString())?(v.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Te.a.dqb(b)):v.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(v.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(pg.Dti(b,
h),null,null)))}static iSh(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get rze(){return(X.a.fbb||X.a.om)&&X.a.Ur}static get e7o(){return X.a.Di||X.a.CI}static Xti(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static g_i(b){return(b=pg.lym(b))&&""!==b?Boolean.parse(b):!1}static eBg(b){pg.CXo(b)}static lym(b){try{return localStorage.getItem(b)}catch(h){return v.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static CXo(b){try{localStorage.setItem(b,"true")}catch(h){v.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}pg.n2h="ChromeExtensionBarDismiss";Object(u.a)(pg,"WildFireUtilities",null,[]);var dh=d(357);class Hg{constructor(){this.yKe=new dh.a;this.wKe=new dh.a;this.vKe=new dh.a;this.Bgl(this.yKe);this.Agl(this.wKe);this.zgl(this.vKe);this.dVe=new dh.a;
this.cVe=new dh.a;this.bVe=new dh.a;this.djl(this.dVe);this.cjl(this.cVe);this.bjl(this.bVe);this.XMe=new dh.a;this.Ngl(this.XMe);this.dKb(this.XMe);this.dKb(this.vKe);this.dKb(this.wKe);this.dKb(this.yKe);this.dKb(this.cVe);this.dKb(this.dVe);this.dKb(this.bVe)}h9d(b,h){switch(b){case 1:return this.aUm(h);case 2:return this.Vim(h)}return pg.rze?this.XMe:null}Bgl(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}Agl(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}zgl(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}djl(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}Ngl(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}cjl(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}bjl(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}dKb(b){b.add("Corporation","Microsoft Corporation")}aUm(b){switch(b){case 3:return this.dVe;case 2:return this.cVe;case 1:return this.bVe}return null}Vim(b){switch(b){case 3:return this.yKe;case 2:return this.wKe;case 1:return this.vKe}return null}static get instance(){Hg._instance||
(Hg._instance=new Hg);return Hg._instance}}Hg._instance=null;Object(u.a)(Hg,"WildFireStringFactory",null,[]);class Zj{constructor(b,h,r,A,M=null,ba=null){this.O2e=null;this._id=b;this.s4e=h;this.syk=M;this.PJc=A;this.pPc=ba;this.Ugb=null;this.NRc=r;this.FQc=Hg.instance.h9d(h,b)}jFl(){this.Ugb=new ng.a(this.title,this.message,null);this.Ugb.addButton(this.tjl,Object(F.a)(this,this.VXn,"onButtonOneClick"),"");this.NRc&&this.Ugb.EOh(this.zjl,Object(F.a)(this,this.$Xn,"onButtonTwoClick"));this.Ugb.lka=
Object(F.a)(this,this.bWl,"dismissBar");this.Ugb.image=3;this.Ugb.id=16;this.Ugb.closeable=!0}get title(){return this.FQc.K("Headline")}get message(){return this.FQc.K("CallToAction")}get tjl(){return this.NRc?this.FQc.K("InstallButton"):this.FQc.K("UseAppButton")}get zjl(){return this.NRc?this.FQc.K("OpenAppButton"):""}VXn(){this.NRc?this.wdn():this.BEp()}$Xn(){this.NRc&&this.w7n()}get yYh(){return this.Ugb}get wua(){this.O2e||(this.O2e=this.syk());return this.O2e}wdn(){v.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.PJc&&this.pPc&&this.pPc();pg.oAj(this._id,this.s4e)}w7n(){this.wua&&(v.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.PJc&&this.pPc&&this.pPc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(pg.iSh(this._id),this.wua,0,!1))}BEp(){pg.rze?this.pjl():(v.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),pg.eBg("BizBarClicked"),1!==this.s4e&&2!==this.s4e||pg.cul(this.wua,this.PJc,this._id,this.pPc))}pjl(){this.PJc?
v.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):v.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Te.a.dqb(y.AFrameworkApplication.J.appSettings.WildFireChromeExtensionUrl.toString())}cWl(){this.PJc?v.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):v.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");pg.eBg(pg.n2h)}bWl(){pg.rze?this.cWl():(pg.eBg(pg.Xti(this._id)),v.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static Iuf(){const b=y.AFrameworkApplication.ta.Hb;
new Zj(b.Uk,pg.S9d(),8<X.a.A$a,1===b.Lma,()=>b.SW,b.Lwg());v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(u.a)(Zj,"WildFireBusinessBar",null,[]);class nh{get name(){return"Common.App.WildFire"}xef(b){const h=y.AFrameworkApplication.ta.Hb;let r=!1;b&&(b.jFl(),b.yYh&&(r=h.Qya(b.yYh,!0)));return r}pFl(){var b=y.AFrameworkApplication.ta.Hb;b=new Zj(b.Uk,pg.S9d(),!1,1===b.Lma);this.xef(b)&&v.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}Iuf(b,h,r,A,M,ba){b=new Zj(b,
r,A,h,M,ba);this.xef(b)&&v.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}IMl(){const b=y.AFrameworkApplication.ta.Hb;var h=y.AFrameworkApplication.J;const r=b.Uk,A=1===b.Lma;if(h.$(pg.RSm(r))){var M=pg.S9d(),ba=8<X.a.A$a;if(2!==r||2!==M||!A){h=h.$(pg.SSm(r));var oa=b.Lwg(),Ja=()=>b.SW;h&&!pg.g_i(pg.Xti(r))&&this.Iuf(r,A,M,ba,Ja,oa)}}}init(){var b=y.AFrameworkApplication.J;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;pg.rze&&b&&!pg.g_i(pg.n2h)?this.pFl():
(document.body&&pg.e7o&&this.IMl(),y.AFrameworkApplication.va.qa(La.a.K3f,xe.a.frame,Object(F.a)(this,this.K3f,"launchWildFireBusinessBar")))}K3f(b,h,r,A,M){if(1===r)return 32;if(!M)return 8;this.Iuf(M.app,M.mode,M.platform,M.useTwoButton,null,null);return 32}dispose(){}uc(){}static main(){E.a.instance.Mc(new nh)}}Object(u.a)(nh,"PackageManager",null,[0,1]);class eh{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(u.a)(eh,"BrowserInfo",null,[]);class xf{constructor(){this.Version=
this.Name=null}}Object(u.a)(xf,"PluginInfo",null,[]);class Ig{static W7(){if(y.AFrameworkApplication.J.$("LogBrowserInfoIsEnabled")){var b=Ig.sfm();try{const h=JSON.stringify(b);v.ULS.sendTraceTag(6903563,102,50,h)}catch(h){v.ULS.sendTraceTag(6903564,102,15,h.message)}}else v.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static bHm(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let r=0;r<b.length;r++){const A=b[r].name,M=b[r].version;
Array.add(h,Object.assign(new xf,{Name:A,Version:M}))}return h}static sfm(){const b=new eh,h=new Sys.StringBuilder;Ig.ZJ(r=>{b.DocElemClientHeight=r},()=>document.documentElement.clientHeight,h);Ig.ZJ(r=>{b.DocElemClientWidth=r},()=>document.documentElement.clientWidth,h);Ig.ZJ(r=>{b.DocElemOffsetHeight=r},()=>document.documentElement.offsetHeight,h);Ig.ZJ(r=>{b.DocElemOffsetWidth=r},()=>document.documentElement.offsetWidth,h);Ig.ZJ(r=>{b.ScreenAvailHeight=r},()=>window.screen.availHeight,h);Ig.ZJ(r=>
{b.ScreenAvailWidth=r},()=>window.screen.availWidth,h);Ig.ZJ(r=>{b.ScreenWidth=r},()=>window.screen.width,h);Ig.ZJ(r=>{b.ScreenHeight=r},()=>window.screen.height,h);Ig.ZJ(r=>{b.ScreenLogicalXdpi=r},()=>window.screen.logicalXDPI,h);Ig.ZJ(r=>{b.ScreenLogicalYdpi=r},()=>window.screen.logicalYDPI,h);Ig.ZJ(r=>{b.ScreenDeviceXdpi=r},()=>window.screen.deviceXDPI,h);Ig.ZJ(r=>{b.ScreenDeviceYdpi=r},()=>window.screen.deviceYDPI,h);Ig.ZJ(r=>{b.WinInnerHeight=r},()=>window.self.innerHeight,h);Ig.ZJ(r=>{b.WinInnerWidth=
r},()=>window.self.innerWidth,h);Ig.ZJ(r=>{b.WinOuterHeight=r},()=>window.self.outerHeight,h);Ig.ZJ(r=>{b.WinOuterWidth=r},()=>window.self.outerWidth,h);Ig.ZJ(r=>{b.WinOrientation=r},()=>window.self.orientation,h);Ig.ZJ(r=>{b.WinDevicePixelRatio=r},()=>window.self.devicePixelRatio,h);Ig.ZJ(r=>{b.SupportsTouch=r},()=>X.a.Uqd,h);Ig.ZJ(r=>{b.NavAppName=r},()=>window.navigator.appName,h);Ig.ZJ(r=>{b.NavAppVersion=r},()=>window.navigator.appVersion,h);Ig.ZJ(r=>{b.NavLanguage=r},()=>window.navigator.browserLanguage||
window.navigator.language,h);Ig.ZJ(r=>{b.NavUserAgent=r},()=>window.navigator.userAgent,h);Ig.ZJ(r=>{b.NavPlatform=r},()=>window.navigator.platform,h);Ig.ZJ(r=>{b.NavPlugins=r},Ig.bHm,h);Ig.ZJ(r=>{b.CalculatedDevicePixelRatio=r},()=>Ig.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static ZJ(b,h,r){try{const A=h();b(A)}catch(A){r.isEmpty()||r.append(" | "),r.append(A.message||
"null")}}}Object(u.a)(Ig,"BrowserInfoLogger",null,[]);class Mj{get name(){return"Common.App.BrowserInfoLogger"}uc(){}init(){Ig.W7()}dispose(){}static main(){E.a.instance.Mc(new Mj)}}Object(u.a)(Mj,"BrowserInfoLoggerPackage",null,[0,1]);class If{constructor(){this.sa=new Fd.a}tKb(b){this.sa.addHandler("OnEditHappenedEvent",b)}mue(b){this.sa.removeHandler("OnEditHappenedEvent",b)}Boo(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(u.a)(If,"EditNotificationEventSource",null,[]);var $b=d(41),wc=d(92);
class ed{constructor(b,h,r,A,M,ba,oa=0){this.$Qe=!1;this.ZQe=this.oGb=null;this.cKh=!1;this.qnd=()=>{this.$Qe&&(this.Yib.CWR(()=>this.Yib.result.sendMessage(K.a.q_l,null)),v.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.$Qe=!1)};this.HGo=()=>{try{this.zCd&&($b.c(La.a.Hzf),this.zCd=!1)}catch(Ja){this.zCd=!1,v.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+Ja)}};this.Gb=h;this.OHd=b;this.Yib=
r;this.Hia=A;this.aKh=M;this.Vuk=ba;this.rAd=0;this.zCd=!1;try{0<oa&&(this.rAd=oa,3E5>this.rAd&&(this.rAd=3E5),this.Gb&&!this.ZQe&&(this.ZQe=new wc.a(3,2,this.rAd,this.HGo),this.Gb.Yb(this.ZQe)))}catch(Ja){v.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Ja)}}get SFe(){return this.cKh}editHappened(){this.SFe?this.zCd=!0:(this.cKh=!0,za.Health.instance.addQosPillar("Save"),za.Health.instance.addQosPillar("ContentCreation"),
$b.c(La.a.Hzf));this.$Qe=!0;this.aKh&&this.aKh.xMh();this.Hia&&this.Hia.Boo();y.AFrameworkApplication.fh&&y.AFrameworkApplication.fh.mLn();this.Vuk&&!this.oGb&&(this.qnd(null),this.oGb=new wc.a(3,2,this.OHd,this.qnd,113),this.Gb.Yb(this.oGb))}}Object(u.a)(ed,"EditNotificationManager",null,[804]);class Dd{constructor(b,h,r,A,M){this.ZTe=this.oGb=null;this.I7b=this.MJe=!1;this.lBj=()=>{const ba=document.getElementById(y.AFrameworkApplication.zTc);!this.I7b&&this.ml&&ba&&(this.ml.nb(zd.a.M3,ba,this.O9f,
null),this.I7b=!0);this.g2e(()=>{this.dispose()})};this.O9f=()=>{this.I7b&&(this.ml.xc(zd.a.M3,document.getElementById(y.AFrameworkApplication.zTc),this.O9f),this.I7b=!1);this.xMh();return!1};this.qnd=()=>{this.MJe&&(this.Yib.CWR(()=>this.Yib.result.sendMessage(K.a.ZEp,null)),v.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.MJe=!1)};this.Gb=h;this.OHd=b;this.Yib=r;this.ml=A;this.g2e=M;this.lBj(null)}xMh(){this.MJe=!0;this.ZTe||(this.ZTe=
new wc.a(3,2,this.OHd,this.lBj,112),this.Gb.Yb(this.ZTe));this.oGb||(this.qnd(null),this.oGb=new wc.a(3,2,this.OHd,this.qnd,111),this.Gb.Yb(this.oGb))}dispose(){this.I7b&&(this.ml.xc(zd.a.M3,document.getElementById(y.AFrameworkApplication.zTc),this.O9f),this.I7b=!1)}}Object(u.a)(Dd,"UserActivityHostNotificationManager",null,[803,11]);var ee=d(205),me=d(113),Nf=d(537);class Tf{constructor(){this.Z=null;this.nz=()=>{Tf.r_l&&0<Tf.Kzf&&(this.Z.register(If,800).ha(),this.Z.register(Dd,"Common.App.HostNotification.UserActivityHostNotificationManager").as(801).ha().Sd(()=>
new Dd(6E4,me.a.instance,Nf.a.iq(this.Z.Ra(7)),ee.a.instance,y.AFrameworkApplication.JH)),this.Z.register(ed,"Common.App.HostNotification.EditNotificationManager").as(72).ha().Sd(()=>new ed(Tf.Kzf,me.a.instance,Nf.a.iq(this.Z.Ra(7)),this.Z.resolve(800),this.Z.Oa(801),Tf.s_l,Tf.k_l)),this.Z.resolve(72),v.ULS.shipAssertTag(38086291,209,0<Tf.Kzf,"EditNotification Interval is less than or equal to 0."))}}get name(){return"Common.App.EditNotification"}init(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.xp(this.nz)}uc(b){this.Z=
b}dispose(){}static get Kzf(){return y.AFrameworkApplication.J?parseInt(y.AFrameworkApplication.J.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get k_l(){return y.AFrameworkApplication.J?parseInt(y.AFrameworkApplication.J.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get r_l(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("EditNotificationIsEnabled")}static get s_l(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("EditNotificationPostMessageIsEnabled")}static main(){E.a.instance.Mc(new Tf)}}
Object(u.a)(Tf,"CommonHostNotificationPackage",null,[0,1]);class oi{constructor(b,h,r){this.yIb=null;this.Bze=()=>{this.yIb=null;v.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.vih.display()};this.t9o=(A,M,ba,oa,Ja)=>A!==La.a.Bze?2:1===ba?32:2===ba&&Ja?(v.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",Ja),Ja?this.ixb():(this.yIb?(v.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),
this.Gb.uf(this.yIb)):(v.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.vih.remove(null)),this.yIb=null),32):8;this.Gb=b;this.ga=h;this.vih=r.create()}ixb(){this.yIb?v.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(v.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.yIb=new wc.a(2,1,3E4,this.Bze,67),this.Gb.Yb(this.yIb))}TZa(){this.ga.qa(La.a.Bze,xe.a.frame,this.t9o)}}Object(u.a)(oi,"FloatPaneActor",null,
[806]);var Ie=d(97),ag=d(96),uf=d(34),Pe=d(69);class Db{constructor(b,h,r,A,M){this.K_e=this.PIc=this.MKd=this.D4a=this.mja=this.K1a=this.PLe=this.Qda=this.ANc=this.gLc=this.hLc=this.JSe=null;this.x1n=()=>{const ba=this.Ga.fc("O365AdPaneShowingDuration",60);this.M9h();this.Qda.style.display="block";this.Qda.style.height=this.mja.height+"px";this.PIc=new wc.a(2,1,1E3*ba,Object(F.a)(this,this.hide,"hide"),67);this.Gb.Yb(this.PIc);this.TCj()};this.w1n=()=>{v.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");
this.TCj();this.mja=null};this.xnj=()=>{v.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.PIc&&this.Gb.uf(this.PIc);this.hide();return!0};this.Gb=h;this.Ga=b;this.Fg=r;this.Z=M;this.qFa=A}M9h(){this.Qda=document.createElement("div");this.Qda.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.Qda.style.width=this.mja.width+"px";(this.K_e=this.zDm(this.qFa))?(this.D4a=document.createElement("a"),
this.D4a.setAttribute(Pe.a.Sh,Pe.a.FA),this.Fg.nb(zd.a.click,this.D4a,this.xnj),this.D4a.href=this.K_e,this.D4a.target="_blank",this.D4a.appendChild(this.mja),this.Qda.appendChild(this.D4a)):this.Qda.appendChild(this.mja);this.K1a=document.createElement("a");this.K1a.setAttribute(Pe.a.Sh,Pe.a.X$);this.K1a.className="StandardButton WACFloatPaneCloseButton";this.K1a.title=CommonUIStrings.l_Close;this.K1a.tabIndex=-1;this.PLe=ag.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.PLe.setAttribute(Pe.a.Sh,Pe.a.FA);this.K1a.appendChild(this.PLe);this.Fg.nb(zd.a.click,this.K1a,this.onClose);this.Qda.appendChild(this.K1a);this.ANc.appendChild(this.Qda)}dxm(b){const h=this.Ga.$("O365PromotionHasStarted");switch(b){case 2:return Ie.a.Mea(String.format("adppt{0}.png",h?"sale":""));case 1:return Ie.a.Mea(String.format("adxls{0}.png",h?"sale":""));case 3:return Ie.a.Mea(String.format("addoc{0}.png",h?"sale":""))}return null}zDm(b){const h=this.Ga.jb("O365AdPaneRedirectedURL");
switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.PIc=null;this.Qda&&!this.MKd&&(b?v.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):v.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.Qda.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.Qda.style.height="0px",this.MKd=new wc.a(2,1,1E3,Object(F.a)(this,
this.remove,"remove"),67),this.Gb.Yb(this.MKd))}remove(){this.Qda&&this.ANc&&(this.D4a&&this.Fg.xc(zd.a.click,this.D4a,this.xnj),this.Fg.xc(zd.a.click,this.K1a,this.onClose),this.ANc.removeChild(this.Qda),this.Qda=null);this.MKd=null}display(){if(this.JSe=this.Z.Oa(802))if(this.ANc=this.JSe.container){var b=this.dxm(this.qFa);b?(v.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.mja=document.createElement("img"),this.mja.className="WACFloatPaneImage",this.hLc=this.x1n,
uf.a.addHandler(this.mja,zd.a.load,this.hLc),this.gLc=this.w1n,uf.a.addHandler(this.mja,zd.a.error,this.gLc),this.mja.src=b):v.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else v.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else v.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}TCj(){this.hLc&&this.mja&&uf.a.removeHandler(this.mja,zd.a.load,
this.hLc);this.hLc=null;this.gLc&&this.mja&&uf.a.removeHandler(this.mja,zd.a.error,this.gLc);this.gLc=null}dispose(){this.hide()}}Object(u.a)(Db,"FloatPane",null,[837]);class Vb{constructor(b,h,r,A,M){this.Gb=h;this.Ga=b;this.Fg=r;this.Z=M;this.qFa=A}create(){return new Db(this.Ga,this.Gb,this.Fg,this.qFa,this.Z)}}Object(u.a)(Vb,"FloatPaneFactory",null,[805]);var Nc=d(298);class td{constructor(){this.Z=null}get name(){return"Common.App.FloatPane"}get wYi(){return y.AFrameworkApplication.J.$("O365AdvertisementIsEnabled")&&
y.AFrameworkApplication.J.$("IsShowAdvertisementPaneEnabled")}init(){this.wYi&&(v.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Z.resolve(803).ixb(),v.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Z.resolve(803).TZa())}uc(b){this.Z=b;this.wYi&&(this.Z.register(Vb,"Common.App.FloatPane.FloatPaneFactory").as(804).Sd(()=>new Vb(y.AFrameworkApplication.J,y.AFrameworkApplication.oc,Nc.a.instance,y.AFrameworkApplication.ta.Hb.Uk,this.Z)).ha(),
this.Z.register(oi,"Common.App.FloatPane.FloatPaneActor").as(803).Sd(()=>new oi(y.AFrameworkApplication.oc,y.AFrameworkApplication.va,this.Z.resolve(804))).ha())}dispose(){}static main(){E.a.instance.Mc(new td)}}Object(u.a)(td,"FloatPanePackage",null,[0,1]);var Ke=d(1634);class sf{}Object(u.a)(sf,"LokiTokenResult",null,[]);class qh{constructor(b){this.VHd=b}GLf(){const b=this.sAm();return b?qh.Jab?new Promise((h,r)=>{this.VHd.continueWith(()=>{this.VHd.yp||this.VHd.ij?r(Error.create("Error downloading auth library")):
this.VHd.result.GV("Loki",b).then(A=>{A=y.AFrameworkApplication.J.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.vAm():A.IsSuccess&&A.Token?Object.assign(new sf,{isSuccess:!0,token:A.Token,errorMessage:null}):Object.assign(new sf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(A)});h(A);return A})})}):Promise.resolve(Object.assign(new sf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new sf,{isSuccess:!1,
token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Ke.a.Mti())}))}vAm(){const b=y.AFrameworkApplication.J.jb("LokiUserDataSignature")||"";return Object.assign(new sf,{isSuccess:!0,token:b,errorMessage:null})}sAm(){let b=null;const h=Ke.a.b5d();2===h?b=y.AFrameworkApplication.J.jb("LokiAADAppId"):1===h&&(b=y.AFrameworkApplication.J.jb("LokiMSAAppId"));return b}static get Jab(){return y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost")}}
Object(u.a)(qh,"LokiTokenManager",null,[808]);class Ef{get name(){return"Common.App.LivePersonaUtils"}init(){$a.a.instance.resolve(152)}dispose(){}uc(b){b.register(qh,"Common.App.LivePersonaUtils.LokiTokenManager").as(152).ha().Sd(()=>new qh(Nf.a.iq(b.Ra(725))))}static main(){E.a.instance.Mc(new Ef)}}Object(u.a)(Ef,"LivePersonaUtilsPackage",null,[0,1]);class jg{constructor(b){this.rKe=b}AXi(b){if(!this.rKe)return!0;b=Fa.a.CKf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.rKe.length;h++)if(b.endsWith(this.rKe[h]))return!0;
return!1}}Object(u.a)(jg,"DomainAllowListManager",null,[]);class Fi{constructor(b,h){this.Hvf=null;this.Paf=b;this.url=h}get tNg(){return Fa.a.lca(this.url)}get ot(){return this.Paf}dJg(){const b={},h=this.ot;b.a=this.tNg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);
b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.Hvf;return b}round(b){return Math.round(1E3*b)/1E3}}
Object(u.a)(Fi,"PerformanceTimingEntry",null,[]);const hf=(b,h)=>{var r,A;const M={};let ba=null;switch(b){case 0:ba="ResourceTiming";b=h.a;null!=b&&(M.Url=b);b=h.b;null!=b&&(M.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(M.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(M.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(M.FetchStart=b);b=null==h.f?null:h.f.toString();null!=b&&(M.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(M.DomainLookupEnd=b);b=
null==h.h?null:h.h.toString();null!=b&&(M.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(M.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(M.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(M.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(M.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(M.ResponseEnd=b);b=h.n;null!=b&&(M.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(M.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&
(M.EncodedBodySize=b);b=null==h.q?null:h.q.toString();null!=b&&(M.TransferSize=b);h=null!==(A=null===(r=h.r)||void 0===r?void 0:r.toString())&&void 0!==A?A:null;null!=h&&(M.responseStatus=h);break;case 1:ba="PerformanceTiming",r=h.a,null!=r&&(M.Url=r),r=null==h.b?null:h.b.toString(),null!=r&&(M.NavigationStart=r),r=null==h.c?null:h.c.toString(),null!=r&&(M.UnloadEventStart=r),r=null==h.d?null:h.d.toString(),null!=r&&(M.UnloadEventEnd=r),r=null==h.e?null:h.e.toString(),null!=r&&(M.RedirectStart=r),
r=null==h.f?null:h.f.toString(),null!=r&&(M.RedirectEnd=r),r=null==h.g?null:h.g.toString(),null!=r&&(M.FetchStart=r),r=null==h.h?null:h.h.toString(),null!=r&&(M.DomainLookupStart=r),r=null==h.i?null:h.i.toString(),null!=r&&(M.DomainLookupEnd=r),r=null==h.j?null:h.j.toString(),null!=r&&(M.ConnectStart=r),r=null==h.k?null:h.k.toString(),null!=r&&(M.ConnectEnd=r),r=null==h.l?null:h.l.toString(),null!=r&&(M.SecureConnectionStart=r),r=null==h.m?null:h.m.toString(),null!=r&&(M.RequestStart=r),r=null==h.n?
null:h.n.toString(),null!=r&&(M.ResponseStart=r),r=null==h.o?null:h.o.toString(),null!=r&&(M.ResponseEnd=r),r=null==h.p?null:h.p.toString(),null!=r&&(M.DomLoading=r),r=null==h.q?null:h.q.toString(),null!=r&&(M.DomInteractive=r),r=null==h.r?null:h.r.toString(),null!=r&&(M.DomContentLoadedEventStart=r),r=null==h.s?null:h.s.toString(),null!=r&&(M.DomContentLoadedEventEnd=r),r=null==h.t?null:h.t.toString(),null!=r&&(M.DomComplete=r),r=null==h.u?null:h.u.toString(),null!=r&&(M.LoadEventStart=r),r=null==
h.v?null:h.v.toString(),null!=r&&(M.LoadEventEnd=r),h=h.w,null!=h&&(M.CustomText=h)}M.Table=ba;return Sys.Serialization.JavaScriptSerializer.serialize(M)};var Ph=d(37),mg=d(168),el=d(156);class Tg{constructor(b,h=null,r=null){this.pg=b;this.sNg=this;this.yxk=h||(()=>window.location.href);this.GQe=new jg(r)}run(){if(Tg.qLb(window.performance))try{const M=this.yxk();if(Tg.MRk.exec(M)&&this.GQe.AXi(M)){var b=new Fi(window.performance.timing,M);el.a.instance.mro(b.ot.fetchStart);el.a.instance.nro(b.ot.navigationStart);
el.a.instance.w0(Ph.a.zem,"connectStart","requestStart");el.a.instance.w0(Ph.a.Iem,"requestStart","responseStart");el.a.instance.w0(Ph.a.Lem,"responseStart","responseEnd");this.sNg.zbb(1,b.dJg());this.pg.tf(Ph.a.mKa,b.ot.fetchStart);this.pg.tf(Ph.a.Fem,b.ot.domainLookupStart);this.pg.tf(Ph.a.Eem,b.ot.domainLookupEnd);this.pg.tf(Ph.a.Bem,b.ot.connectStart);this.pg.tf(Ph.a.Nem,b.ot.secureConnectionStart);this.pg.tf(Ph.a.Aem,b.ot.connectEnd);this.pg.tf(Ph.a.Jem,b.ot.requestStart);this.pg.tf(Ph.a.mjc,
b.ot.responseStart);this.pg.tf(Ph.a.Gem,b.ot.responseEnd-b.ot.responseStart);this.pg.tf(Ph.a.Kem,b.ot.responseStart-b.ot.requestStart);var h=0,r=0,A=0;({transferSize:h,DAf:r,dwf:A}=this.Bsp(M)).returnValue&&(this.pg.tf(Ph.a.Pem,h),this.pg.tf(Ph.a.Cem,A),this.pg.tf(Ph.a.Hem,r));this.pg.tf(Ph.a.D1c,b.ot.navigationStart)}}catch(M){v.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",M)}}Bsp(b){let h,r,A;A=r=h=-1;if(void 0===window.performance.getEntriesByName||null===
window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,DAf:r,dwf:A};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,DAf:r,dwf:A};b=b[0];var M=b.transferSize;void 0!==h&&null!==h&&(h=M);M=b.decodedBodySize;void 0!==M&&null!==M&&(A=M);b=b.encodedBodySize;void 0!==b&&null!==b&&(r=b);return{returnValue:!0,transferSize:h,DAf:r,dwf:A}}zbb(b,h){v.ULS.sendTraceTag(4551815,306,50,hf(b,h))}static get instance(){return Tg._instance||
(Tg._instance=new Tg(mg.a.instance,null,y.AFrameworkApplication.J.$("PerfTimingLoggerFilterDomainsIsEnabled")?y.AFrameworkApplication.J.pD("ResourceLoggerDomainAllowList"):null))}static qLb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}Tg._instance=null;Tg.MRk=RegExp("^https?://.*","i");Object(u.a)(Tg,"PerformanceTimingLogger",null,[807]);class jh{constructor(b,h){this.Hvf=null;this.Paf=b;this.behavior=h;this.url=this.ot.name}get tNg(){return 2===this.behavior?this.url:
Fa.a.lca(this.url)}get ot(){return this.Paf}dJg(){const b={},h=this.ot;b.a=this.tNg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);
b.o=this.round(jh.V9a(h,"decodedBodySize"));b.p=this.round(jh.V9a(h,"encodedBodySize"));b.q=this.round(jh.V9a(h,"transferSize"));b.n=this.Hvf;b.r=jh.V9a(h,"responseStatus")||0;return b}round(b){return Math.round(1E3*b)/1E3}static V9a(b,h){return b[h]}}Object(u.a)(jh,"ResourceTimingEntry",null,[843]);class xg{constructor(b,h=null,r=100){this.p9g=b;this.tNd=h;this.Rgb={};this.Bqk=r;this.L8g=y.AFrameworkApplication&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",
!1)}arp(b){var h=b.name.toLowerCase();const r=Fa.a.JQb(h);this.pHj(r,h)&&(r in this.Rgb?v.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.z3i(b),h.encodedsize=jh.V9a(b,"encodedBodySize"),h.decodedsize=jh.V9a(b,"decodedBodySize"),this.Rgb[r]=h))}brp(b){var h=b.name.toLowerCase();const r=Fa.a.JQb(h);this.wJo(r,h)&&(r in this.Rgb?v.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",
r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.z3i(b),h.encodedsize=jh.V9a(b,"encodedBodySize"),h.decodedsize=jh.V9a(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.Rgb[r]=h))}pHj(b,h){if(this.p9g)return Array.contains(this.p9g,b);if(this.tNd)for(b=Fa.a.yU(h),h=0;h<this.tNd.length;h++)if(this.tNd[h]&&
b.endsWith(this.tNd[h]))return!0;return!1}wJo(b,h){return this.pHj(b,h)?b.endsWith(".js")||b.endsWith(".css"):!1}z3i(b){try{const h=jh.V9a(b,"transferSize");if(void 0!==h&&null!==h)return!h;v.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.Bqk}catch(h){v.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}Mto(){if(tb.a.Uf(this.Rgb))v.ULS.sendTraceTag(575931855,
306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=y.AFrameworkApplication.flightId?y.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new bb.a,{extendedProperties:kb.a.cH()});h.extendedProperties.set("Flights",G.c(b));this.caj(h,this.Rgb,za.Health.instance)}}RGf(b){let h=0,r=0,A=0,M=0,ba=0;const oa=this.Rgb;for(const zb in oa){var Ja=zb,jb=oa[zb];Ja.endsWith(".js")&&(jb=Object(Ma.a)(Object,jb),jb.responseend<b&&(h+=1,r+=jb.decodedsize,M+=jb.encodedsize,
A+=jb.iscached?0:jb.encodedsize,Ja=Ja.toLowerCase(),this.L8g&&(y.AFrameworkApplication.J.jb("Slice1Name").toLowerCase().endsWith(Ja)?ba|=1:Ja.endsWith(".common.js")||Ja.endsWith(".othercommon.js")||Ja.endsWith(".ext.js")?ba|=2:Ja.endsWith("common50.min.js")&&(ba|=4))))}b={};b.filesLoaded=h;b.decodedBytes=r;b.transferredBytes=A;b.encodedBytes=M;this.L8g&&(b.lazyChunksLoaded=ba);return b}caj(b,h,r){if(h){var A=0,M=0,ba=0,oa=0,Ja=0,jb=0,zb=0,Eb=0,Sb=0,nc=0,Dc=0;for(const Gd in h){var Zc=h[Gd];try{const de=
Object(Ma.a)(Object,Zc);if(!de)continue;const he=de.iscached?Boolean.parse(de.iscached.toString()):!1,fe=de.fetchstart?this.parseFloat(de.fetchstart.toString()):0,Yd=(de.responseend?this.parseFloat(de.responseend.toString()):0)-fe,Td=de.encodedsize?this.parseFloat(de.encodedsize.toString()):0,wf=de.decodedsize?this.parseFloat(de.decodedsize.toString()):0;A+=Yd;oa+=Td;zb+=wf;nc++;he?(ba+=Yd,jb+=Td,Sb+=wf,Dc++):(M+=Yd,Ja+=Td,Eb+=wf)}catch(de){v.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",
de.message)}}b.extendedProperties.set("StaticResources",G.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",A.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",M.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ba.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",oa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Ja.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",
jb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",zb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Eb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Sb.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",nc.toString());b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Dc.toString());r.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",
null);r.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(u.a)(xg,"AppStaticResourceManager",null,[]);class Of extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(u.a)(Of,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Zh{constructor(b,h,r=null,A=null,M=100,ba=!1){this.RYe=!1;this.qp=null;this.PFc=0;this.sa=new Fd.a;this.MBb=null;this.N1=!1;this.lIh=0;this.Gb=b;this.ceh=0;this.sNg=this;this.GQe=
new jg(r);this.ZM=h;A&&(this.MBb=new xg(null,A,M));this.Onk=ba}get DXh(){try{return!(void 0===this.ZM||null===this.ZM)&&!(void 0===this.ZM.getEntriesByType||null===this.ZM.getEntriesByType)}catch(b){return v.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get aPl(){return this.ceh}get isActive(){return this.N1}get VIg(){return this.lIh}tPh(b){this.sa.addHandler(Zh.BBf,b)}$Dj(b){this.sa.removeHandler(Zh.BBf,b)}uc(b,h){const r=
this.VIg!==b;this.lIh=b;this.isActive&&this.Gb&&r&&(this.uf(),this.Yb());this.ceh=h}activate(){!this.isActive&&this.DXh&&(this.Yb(),this.N1=!0)}deactivate(b){this.isActive&&(this.uf(),b&&this.flush(),this.N1=!1)}flush(){if(this.isActive&&this.DXh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.PFc&&v.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",b.length-this.PFc);const h=!(void 0===window.performance.clearResourceTimings||
null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.PFc=0);const r=[];for(let A=this.PFc;A<b.length;A++)this.GQe.AXi(b[A].name)&&(this.MBb&&(this.Onk?this.MBb.brp(b[A]):this.MBb.arp(b[A])),r.push(new jh(b[A],this.aPl)));h||(this.PFc=b.length);this.sa.raiseEvent(Zh.BBf,new Of(r));for(b=0;b<r.length;b++)0!==r[b].behavior&&2!==r[b].behavior||this.sNg.zbb(0,r[b].dJg());0<r.length&&v.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
r.length)}catch(h){v.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}zbb(b,h){v.ULS.sendTraceTag(4310804,306,50,hf(b,h))}hro(){this.MBb.Mto()}RGf(b){return this.MBb.RGf(b)}Yb(){this.Gb&&0<this.VIg&&(this.qp=new wc.a(3,2,1E3*this.VIg,()=>{this.flush()},5),this.Gb.Yb(this.qp),this.RYe=!0)}uf(){this.RYe&&(this.Gb.uf(this.qp),this.qp=null,this.RYe=!1)}}Zh.BBf="EntriesAvailable";Object(u.a)(Zh,"ResourceTimingLogger",null,[798,807]);class Ei{constructor(){this.Z=
null}get name(){return"Common.ResourceTiming"}init(){this.Z.resolve(74);Tg.instance.run()}dispose(){}uc(b){this.Z=b;let h=null;if(y.AFrameworkApplication.J.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=y.AFrameworkApplication.J.pD("ResourceLoggerDomainAllowList")}catch(ba){v.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const r=[];r.push(Fa.a.yU(Ie.a.A4).toLowerCase());r.push(Fa.a.yU(Ie.a.Vod).toLowerCase());const A=y.AFrameworkApplication.J.fc("AppStaticResourceMonitorCacheThresholdInMs",
100),M=y.AFrameworkApplication.J.$("PPTAggregateResourceTimingV2Enabled");b.register(798,74).ha().Sd(()=>new Zh(y.AFrameworkApplication.oc,window.performance,h,r,A,M))}static main(){E.a.instance.Mc(new Ei)}}Object(u.a)(Ei,"ResourceTimingPackage",null,[0,1]);var Pf=d(267);class Gi{constructor(){this.IJe={}}YUk(b){this.IJe[b.id.toString()]=b}BUn(b){const h=this.IJe;for(const r in h)h[r].notify(b,!1);this.IJe={}}mmo(b,h){h&&this.YUk(h);return this.Nnj(b,h)}nAf(b){this.BUn(b)}mji(b,h){b.notify(h,!0)}}
Object(u.a)(Gi,"AEventEmitter",null,[631]);var Xk;(function(b){b[b.Hcg=0]="notStarted";b[b.waiting=1]="waiting";b[b.hze=2]="shouldRetry";b[b.complete=3]="complete"})(Xk||(Xk={}));Object(u.b)("EventResultState",Xk);class Sf{constructor(){this._state=0}get state(){return this._state}set state(b){v.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:Xk[this._state],["NewState"]:Xk[b]},"ResultType",this.$Fi());this._state=b}}Object(u.a)(Sf,"AEventResult",null,[630]);class Pi extends Sf{constructor(){super();
this.i$e=this.TNc=null;this.state=0;this.qWe=this.inh=!1}get Tga(){return this.TNc}get afb(){return this.i$e}get Edn(){return this.inh}$Fi(){return"GetMoreInfo Result"}}Object(u.a)(Pi,"GetMoreInfoResult",Sf,[866,630]);var El=d(1261),Kh=d(1486),Vi=d(1039);class Bj{constructor(b,h,r,A,M,ba,oa,Ja){this.qtc=(jb,zb,Eb,Sb,nc)=>{nc&&nc.MenuItemId&&(v.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:nc.SourceControlId,["AppType"]:Vi.a[this.zga]}),Te.a.Cn(nc.MenuItemId.toString(),"_blank",void 0,
"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};this.kig=(jb,zb,Eb,Sb,nc)=>{if(nc&&nc.MenuItemId){const Dc=y.AFrameworkApplication.J.$("WacInTabOpenMRUIsEnabledForUiHost"),Zc=y.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures");v.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Dc,Zc);if(Dc&&Zc){v.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:nc.SourceControlId,["AppType"]:Vi.a[this.zga]});jb=nc.MenuItemId.toString();
const Gd={};Gd[H.a.ovc]="1";Gd[H.a.documentUrl]=jb;Gd[H.a.reason]=Kh.a.open;v.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");y.AFrameworkApplication.DN().execute(de=>{de.sendMessage(K.a.SNb,Gd)})}else this.qtc(jb,zb,Eb,Sb,nc)}return 32};this.h0d=()=>{this.faj();return 32};this.ga=b;this.Gf=h;this.ii=r;this.qFa=A;this.Gb=M;this.mF=ba;this.Ryk=oa;this.PNd=Ja}jvo(){this.$rc.qa(La.a.qtc,xe.a.frame,this.qtc);this.$rc.qa(La.a.kig,xe.a.frame,this.kig);y.AFrameworkApplication.Lka?
this.faj():this.$rc.fb(La.a.h0d,xe.a.frame,this.h0d,96)}iYa(b,h,r=""){if(h&&h.rH){const A=El.a[h.status];h=h.rH.getTime();const M=this.eq()-h;v.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:A,["ElapsedMs"]:M,["StartTime"]:h,["Notes"]:r})}else v.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}faj(){var b=y.AFrameworkApplication.J.$("QPGVCI"),h=Fa.a.KL(document.URL,"wdNewAndOpenCt",
b);if(h){h=parseInt(h);var r=Fa.a.KL(document.URL,"wdPreviousSession",b);b=Fa.a.KL(document.URL,"wdPreviousCorrelation",b);var A=y.AFrameworkApplication.J.$("NAOPLP");if(y.AFrameworkApplication.Lka){var M=y.AFrameworkApplication.Lka.getTime();!h||h>M?v.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:M,["SessionId"]:r,["Correlation"]:b}):v.ULS.sendTraceTag(5849683,202,A?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",
{["ClickToLoadTime"]:M-h,["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}else v.ULS.sendTraceTag(5849681,202,A?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}}get $rc(){return this.ga.value}get ged(){return this.Gf.value}get Pgj(){return this.ii.value}get zga(){return this.qFa.value}get Vke(){return this.Gb.value}get eq(){return this.mF}get DYa(){return this.Ryk.value}get h0a(){return this.PNd.value}static get instance(){return Bj._instance||
(Bj._instance=Bj.Ts())}static Ts(){return new Bj(new Pf.a(()=>y.AFrameworkApplication.va),new Pf.a(()=>y.AFrameworkApplication.Ge),new Pf.a(()=>y.AFrameworkApplication.ta),new Pf.a(()=>y.AFrameworkApplication.ta.Hb.Uk),new Pf.a(()=>y.AFrameworkApplication.oc),()=>(new Date).getTime(),new Pf.a(()=>y.AFrameworkApplication.ta.Hb.DYa),new Pf.a(()=>y.AFrameworkApplication.h0a))}}Bj._instance=null;Object(u.a)(Bj,"NewAndOpenCommonHelpers",null,[628]);class ci{constructor(b,h,r){this.nMd=this.qp=null;this.V6e=
0;this.pNk=b;this.Gb=h;this.Ceh=r}T4k(){this.V6e=this.bwc+1}bvg(b){this.qp&&(this.Gb.uf(this.qp),this.qp=null);b&&(this.V6e=0)}Vep(b){const h=this.Pmp;0<=h?(this.T4k(),this.bvg(!1),this.qp=new wc.a(4,1,h,b,107),this.Gb.Yb(this.qp)):(this.bvg(!0),v.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.Ceh}))}get bwc(){return this.V6e}get Pmp(){return this.bwc>=this.GMj.length?-1:this.GMj[this.bwc]}get GMj(){if(!this.nMd){const b=(this.pNk.value||"0").split(",");this.nMd=[];for(let h=
0;h<b.length;h++){const r=parseInt(b[h]);isNaN(r)?v.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.Ceh,["Entry"]:b[h]}):Array.add(this.nMd,r)}}return this.nMd}}Object(u.a)(ci,"RetryHelper",null,[]);class Mg extends Gi{constructor(b,h){super();this.LGa=b;this.XOc=new ci(h,this.Ndd.Vke,"GetMoreInfo");this.$p=new Pi}sKn(){this.e8f("Document opened")}HIl(b){return()=>{this.e8f(b,!0)}}Nnj(b,h=null){v.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",
{["Trigger"]:b});3===this.$p.state?(h&&this.mji(h,this.$p),v.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):this.e8f(b);return this.$p}e8f(b,h=!1){this.XOc.bvg(!h);1===this.$p.state?v.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.XOc.bwc}):(v.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.XOc.bwc}),this.$p.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.Ndd.DYa,y.AFrameworkApplication.xm),this.Ndd.ged.$5a(h,1,null,null,[Mg.Lzh,Mg.DGh],5,this.rHl(),this.qHl(b)))}rHl(){return b=>{var h=!1;let r=!1;var A=!1,M;y.AFrameworkApplication.J.$("GetMoreInfoDataFromResponseBody")&&(b.data.Ee?({hv:M}=G.d(b.data.Ee)).returnValue?M?(A=!0,this.$p.i$e=M.StorageServiceDisplayName,this.$p.TNc=Mg.r4i(M.PersonalFileStorageUrl)?M.PersonalFileStorageUrl:"",""===this.$p.Tga&&"SharePointOnlineConsumer"===y.AFrameworkApplication.J.jb("FileSource")&&(this.$p.TNc=Fa.a.lca(y.AFrameworkApplication.breadcrumbFolderUrl)),
h=""===this.$p.Tga&&""!==this.$p.afb):v.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):v.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));A||((M=b.data.wi)?(this.$p.i$e=
(M[Mg.DGh]||"").toString(),h=(M[Mg.Lzh]||"").toString(),this.$p.TNc=Mg.r4i(h)?h:"",""===this.$p.Tga&&"SharePointOnlineConsumer"===y.AFrameworkApplication.J.jb("FileSource")?(this.$p.TNc=Fa.a.lca(y.AFrameworkApplication.breadcrumbFolderUrl),h=""===this.$p.Tga&&""!==this.$p.afb):h=""===h&&""!==this.$p.afb):(v.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),r=!0));A=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.XOc.bwc,r,h,A);this.Ndd.iYa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,A);this.WMj(3,h,r)}}qHl(b){return h=>{this.Ndd.iYa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");this.WMj(2);this.XOc.Vep(this.HIl(b))}}WMj(b,h=!1,r=!1){this.$p.state=b;this.$p.inh=h;this.$p.qWe=r;this.nAf(this.$p)}get Ndd(){return this.LGa.value}static get instance(){return Mg._instance||(Mg._instance=Mg.Ts())}static Ts(){return new Mg(new Pf.a(()=>Bj.instance),
new Pf.a(()=>y.AFrameworkApplication.FBm))}static r4i(b){if(!b)return v.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(C.a.xh(b).startsWith("https://"))return!0;v.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Mg.Lzh="PersonalFileStorageUrl";Mg.DGh="StorageServiceDisplayName";Mg._instance=null;Object(u.a)(Mg,"GetMoreInfoActor",Gi,[]);class ij{constructor(b,h,r,A,M){this.dAk=6E4;this.GQi="inactive";this.oMh="active";
this.N1=!0;this.Gb=b;this.Xxk=h;this.mF=r;this.JOd=A;this.sa=new Fd.a;M&&this.Mep();this.Crh=this.hBi()}OMh(b){this.sa.addHandler(this.oMh,b)}cZk(b){this.sa.addHandler(this.GQi,b)}Mep(){const b=new wc.a(5,2,this.dAk,Object(F.a)(this,this.u6m,"inactiveLoop"),108);this.v6m.Yb(b)}u6m(){const b=this.hBi(),h=this.eq()-b;h>this.cDe&&this.N1&&(v.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.N1=!1,this.sa.raiseEvent(this.GQi));b-this.Crh>this.cDe&&(this.N1=!0,
this.sa.raiseEvent(this.oMh));this.Crh=b}get v6m(){return this.Gb.value}get hBi(){return this.Xxk}get eq(){return this.mF}get cDe(){return this.JOd.value}static get instance(){return ij._instance||(ij._instance=ij.Ts())}static Ts(){return new ij(new Pf.a(()=>me.a.instance),()=>y.AFrameworkApplication.y3f.getTime(),()=>(new Date).getTime(),new Pf.a(()=>y.AFrameworkApplication.cDe),!0)}}ij._instance=null;Object(u.a)(ij,"InactivityManager",null,[]);var fl=d(1687);class Mi extends Sf{constructor(){super();
this.UFk=this.Bvh=this.Avh=null;this.state=this.mIh=0;this.qWe=!1}get o$f(){return this.Avh}get Kfj(){return this.Bvh}get Vmp(){return this.mIh}$Fi(){return"MruActor Result"}}Object(u.a)(Mi,"MruResult",Sf,[629,630]);class dk{constructor(b,h,r){this.task=null;this.Fbe=b;this.maxRetries=h;this.$i=r;this.retryCount=this.q8c=0;this.b5e=this.Uad=null}crn(b,h){return b===ea.a.djc||20===h||18===h||3===h}Asn(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===
b||23===b||26===b||27===b||28===b}get Uqe(){return this.b5e}reset(){this.q8c=this.retryCount=0;this.b5e=this.Uad=null;this.task&&(this.$i.uf(this.task),this.task=null)}fan(b,h,r,A){this.b5e=String.format("{0}_{1}",r,A);if(this.retryCount>=this.maxRetries)return v.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.crn(r,A))return v.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Asn(A)&&1<=this.q8c)return this.Uad=r,!1;h=Math.max(h,this.Fbe*
Math.pow(2,this.q8c));if(26===A)h=Math.max(h,3E4);else if(27===A||28===A)h=Math.max(h,6E4);9===A||412===r&&(null==this.Uad||412!==this.Uad)?h=500:this.q8c+=1;this.Uad=r;this.retryCount+=1;this.task&&this.$i.uf(this.task);v.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",h);this.task=new wc.a(2,1,h,b,107);this.$i.Yb(this.task);return!0}}Object(u.a)(dk,"RetryManager",null,[]);var zg=d(153);class Gf{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=
this.documentUrl=null}}Object(u.a)(Gf,"WriteOptions",null,[]);var Ag=d(753);class Ti extends Gi{constructor(b,h,r,A,M,ba,oa){super();this.NMp=Ja=>{this.BMi(Ja.data)};this.OMl=Ja=>{if(Ja.data.He===ea.a.kgc)this.BMi(Ja.data);else{var jb=Ja.data.He===ea.a.u8,zb=kb.a.cH();this.LMi(this.dmb,Ja,this.wMl(),zb);zb&&(zb.set("StatusCode",Ja.data.He.toString()),jb||this.Ief(Ja.data,zb));za.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Ja.data.He),jb,!1,Object.assign(new bb.a,
{extendedProperties:zb}))}};this.RBm=Ja=>{this.uCi(Ja)};this.QBm=Ja=>{this.uCi(Ja,!0)};this.NBm=Ja=>{this.tCi(Ja)};this.LBm=Ja=>{this.tCi(Ja,!0)};this.LGa=b;this.KEk=h;this.Lkb=new dk(y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.JP.Vke);this.dmb=new dk(y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.JP.Vke);this.YKk=r;this.mLh=A;this.NTk={};this.Opa=new Mi;this.uxk=M;this.wHd="";this.rO=ba;this.Cgh=oa;this.EKd="";this.cLk=y.AFrameworkApplication.J.fc("WordRecentLinksCount",25)}get fHe(){return this.NTk}Zyo(){this.JP.$rc.qa(La.a.HEj,xe.a.frame,Object(F.a)(this,this.fEo,"renameMruEntry"))}fEo(){return this.KPg("Rename")}KKn(){this.tcj("File Opened")}LKn(){this.tcj("IntervalUpdate")}tcj(b){v.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.KPg(b)}ola(b){(b=C.a.ola(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}Y4d(){switch(this.JP.zga){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}URm(b){var h=this.uxk();if(!h)return null;const r=new Gf;r.documentUrl=this.Cgh.value?encodeURI(h):h;r.mruItemId=this.wHd;r.app=this.Y4d();if(h=this.rO())r.folderName=h.breadcrumbFolderName,
h=h.HA,r.documentName=C.a.FL(h),r.documentExt=this.ola(h);b&&(r.documentName?r.documentName.length?255<=r.documentName.length?b.set("DocumentNameLength","Long"):2084<=r.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength","Null"));return JSON.stringify(r)}KPg(b,h=!1){if(4===this.JP.zga&&!y.AFrameworkApplication.e0d)return 2;var r=kb.a.cH();r&&(r.set("Trigger",b),r.set("IsRetry",h?"true":"false"),r.set("MruIdSent",this.wHd?"true":"false"),
r.set("URLEncoded",this.Cgh.value?"true":"false"));za.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",r);b=this.URm(r);if(!b)return h=!y.AFrameworkApplication.x3b,r&&(r.set("WebEditingIsEnabled",y.AFrameworkApplication.x3b?"true":"false"),r.set("ProtectedFile",y.AFrameworkApplication.I0?"true":"false")),za.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new bb.a,{extendedProperties:r})),2;this.dmb&&!h&&this.dmb.reset();r=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",
this.JP.DYa,this.d6f);this.mLh?this.fHe["X-FileId"]=y.AFrameworkApplication.xm:r+=String.format("&{0}",y.AFrameworkApplication.xm);y.AFrameworkApplication.sessionStartInfoSettings&&(this.fHe["X-Office-AudienceGroup"]=Object(Ma.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");this.fHe["X-Timeout"]=15E3;return this.JP.ged.Xj(r,2,b,this.fHe,!0,5,this.NMp,this.OMl,null,void 0,void 0,void 0,void 0,"4")}BMi(b){const h=kb.a.cH();this.dmb&&(h&&this.dmb.Uqe&&(h.set("LastError",
this.dmb.Uqe),h.set("NumRetries",this.dmb.retryCount.toString())),this.dmb.reset());const r=fl.c(b.Ee);r&&r.diagnostics_data&&(this.wHd=r.diagnostics_data.mru_id);b=+b.bP-+b.rH;h&&h.set("RequestDuration",b.toString());za.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new bb.a,{extendedProperties:h}))}wMl(){return()=>{this.KPg("Retry",!0)}}PBm(){this.Mcd("Polling")}OBm(){this.Mcd("Retry",!0)}vKn(){this.Mcd("Open")}uKn(){this.Mcd("Activity")}tKn(){this.Mcd("ActivityRecentLinks",!1,!0)}Mcd(b,
h=!1,r=!1){v.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const A=kb.a.cH();A&&(A.set("Trigger",b),A.set("IsRetry",h?"true":"false"),r&&A.set("RecentLinks","true"));za.Health.instance.recordKpiUsage("GetMru",0,"smartfio",A);this.Lkb&&!h&&this.Lkb.reset();r?this.t$h(this.QBm,this.LBm,!0):this.t$h(this.RBm,this.NBm)}Ief(b,h){b&&b.wi&&(b=b.wi["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}cGn(b,h){b&&(h&&h.set("RequestDuration",(+b.bP-+b.rH).toString()),za.Health.instance.recordKpiSuccess("GetMru",
Object.assign(new bb.a,{extendedProperties:h})))}uCi(b,h=!1){var r="";let A=null,M=null,ba=null;const oa=fl.c(b.data.Ee);oa&&(A=oa.places?oa.places.items:[],M=oa.documents?oa.documents.items:[],(ba=fl.a(oa,h))&&(r=G.c(ba)));y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.FXa&&zg.c()&&(h?this.EKd=r:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(r,!0)));r=kb.a.cH();this.Lkb&&(r&&this.Lkb.Uqe&&(r.set("LastError",this.Lkb.Uqe),r.set("NumRetries",this.Lkb.retryCount.toString())),
this.Lkb.reset());h&&r&&r.set("RecentLinks","true");ba||A||M?(h?this.JP.iYa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Success"):this.JP.iYa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.lFe(3,ba,A,M),this.cGn(b.data,r)):(h?this.JP.iYa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.JP.iYa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),r&&this.Ief(b.data,r),za.Health.instance.recordKpiFailure("GetMru",
"JsonParseFailed",!1,!1,Object.assign(new bb.a,{extendedProperties:r})),this.lFe(3,null,null,null,!0));this.nAf(this.Opa)}LMi(b,h,r,A){let M=0,ba=0;const oa=fl.c(h.data.Ee);oa&&(null!=oa.response_code&&(M=oa.response_code,A&&A.set("MruResponseCode",M.toString()),9===M&&(this.wHd="")),oa.error_data&&null!=oa.error_data.retry_after_ms&&(ba=oa.error_data.retry_after_ms,A&&A.set("ExpectedRetryAfter",ba.toString())));b&&(h=b.fan(r,ba,h.data.He,M),A&&(A.set("CurrentRetryCount",b.retryCount.toString()),
A.set("RetryScheduled",h?"true":"false")))}tCi(b,h=!1){const r=b.data.He===ea.a.u8,A=kb.a.cH();A&&(A.set("StatusCode",b.data.He.toString()),h&&A.set("RecentLinks","true"),r||this.Ief(b.data,A));h?this.JP.iYa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.JP.iYa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.lFe(2);this.LMi(this.Lkb,b,Object(F.a)(this,this.OBm,"getMruFromServerRetryTask"),A);za.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",
b.data.He),r,!1,Object.assign(new bb.a,{extendedProperties:A}));this.nAf(this.Opa);y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.FXa&&zg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.EKd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}lFe(b,h=null,r=null,A=null,M=!1){if(3!==this.Opa.state||3===b)this.Opa.Avh=h,this.Opa.Bvh=r,this.Opa.UFk=A,this.Opa.state=b,this.Opa.qWe=M,this.Opa.mIh=this.JP.eq()}Nnj(b,h){v.ULS.sendTraceTag(6029918,
202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Opa.state});h&&3===this.Opa.state&&this.mji(h,this.Opa);return this.Opa}t$h(b,h,r=!1){this.lFe(1);let A;const M={};A=r?String.format(this.JP.DYa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.cLk,"OfficeSuite",this.d6f,"ClassicMru"):String.format(this.JP.DYa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.Y4d(),this.d6f);this.YKk.value||(A+="&entity=docs");y.AFrameworkApplication.sessionStartInfoSettings&&
(M["X-Office-AudienceGroup"]=Object(Ma.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");r&&(M["X-Office-Application"]="147");this.mLh?M["X-FileId"]=y.AFrameworkApplication.xm:A+=String.format("&{0}",y.AFrameworkApplication.xm);this.JP.ged.Xj(A,1,null,M,!0,5,b,h,null)}get JP(){return this.LGa.value}get d6f(){return this.KEk.value}static get instance(){return Ti._instance||(Ti._instance=Ti.Ts())}static Ts(){return new Ti(new Pf.a(()=>Bj.instance),new Pf.a(()=>Ag.a.Hg(y.AFrameworkApplication.lcid).name),
new Pf.a(()=>y.AFrameworkApplication.ta.Hb.sH),y.AFrameworkApplication.J.$("MruWriteFileIdInHeader"),()=>y.AFrameworkApplication.ta.Hb.SW,()=>y.AFrameworkApplication.Ht,new Pf.a(()=>y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled")))}}Ti._instance=null;Object(u.a)(Ti,"MruActor",Gi,[]);class em{constructor(){this.GRc=this.iBh=this.Z=null;this.ji=!1;this.ERl=()=>{me.a.instance.uf(this.Mfj)};this.BNh=()=>{me.a.instance.Yb(this.Mfj)}}get name(){return"Common.App.NewAndOpen.Core"}uc(b){this.Z=b;b.register(628,
805).ha().Sd(()=>Bj.instance);b.register(631,806).ha().Sd(()=>Mg.instance);b.register(631,807).ha().Sd(()=>Ti.instance)}init(){y.AFrameworkApplication.J.xp(()=>{this.L$a()})}L$a(){this.Z.resolve(805);this.Z.resolve(806);this.Z.resolve(807);var b=!1;Bj.instance.jvo();y.AFrameworkApplication.yMa&&(b=!0);y.AFrameworkApplication.mqg&&(Ti.instance.vKn(),0<y.AFrameworkApplication.Lfj&&this.BNh(),this.P2o(),b=!0);y.AFrameworkApplication.h0a&&b&&Mg.instance.sKn();y.AFrameworkApplication.OAp&&(b=Ti.instance,
b.Zyo(),b.KKn(),me.a.instance.Yb(this.PAp))}P2o(){ij.instance.OMh(Object(F.a)(Ti.instance,Ti.instance.uKn,"makeGetMruRequestActivityTrigger"));ij.instance.OMh(this.BNh);ij.instance.cZk(this.ERl)}get Mfj(){return this.iBh||(this.iBh=new wc.a(5,2,y.AFrameworkApplication.Lfj,Object(F.a)(Ti.instance,Ti.instance.PBm,"getMruFromServerTask"),109))}get PAp(){return this.GRc||(this.GRc=new wc.a(2,2,6E4*y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),
Object(F.a)(Ti.instance,Ti.instance.LKn,"makeUpdateMruTask"),197))}dispose(){this.ji||(this.ji=!0,this.GRc&&(me.a.instance.uf(this.GRc),this.GRc=null))}}Object(u.a)(em,"CorePackageManager",null,[0,1,11]);var Eg=d(1477),Md=d(151);class Re{static h1l(b){return Re.nYh("New",b)}static i1l(b){return Re.nYh("Open",b)}static TXh(b,h){return Re.G6a("LoadingMenuSection",Re.RDn,b,Re.GUc("lblLoading",h))}static HUc(b,h,r=null,A=null){return Re.G6a("MessageMenuSection",Re.Jfj,h,Re.GUc("lblMessage",b,r,A))}static Shl(b){return Re.TXh(b,
CommonUIStrings.l_VoicedLoadingText)}static Thl(b,h){return Re.HUc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Tga,h.afb)}static Rhl(b,h){return Re.HUc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.afb,"\n\n"),b.labelText)}static XXh(b){return Re.HUc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static Phl(b,h,r){return Re.G6a("menuNewBlank",Re.H0m,r?b.labelText:null,Re.CUc(b.pOi,b.qOi,b.rOi,null,b.B$a,b.X6c,h,"blank"))}static Lil(){return Re.GUc("lblTemplatesLoading",
CommonUIStrings.l_VoicedLoadingText)}static lYh(){return Re.GUc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static Mil(b,h){return Re.G6a("menuNewTemplates",b,null,h)}static Nhl(b,h){return Re.G6a("menuNewMoreTemplates",Re.xqi,null,Re.CUc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static Ggl(b,h,r){let A="";r&&h&&(A=Re.G6a("BrowseMoreMenuSection",Re.xqi,null,Re.CUc("btnBrowseMore",h,h,null,null,null,b||
"1959943459",r)));return A}static GUc(b,h,r=null,A=null){let M=A;h&&0<h.length&&(M=Re.$gj.Gwb(h).trimEnd(),M=0<=M.indexOf("{0}")?String.format(M,A):String.format("{0} {1}",M,A));r=r&&A?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',C.a.If(r),C.a.If(A),C.a.If(M)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',C.a.If(b||""),Re.$gj.Gwb(C.a.If(h||"")),r)}static CUc(b,h,
r,A,M,ba,oa,Ja){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',C.a.If(b||""),C.a.If(h||""),C.a.If(r||""),A||"32by32",C.a.If(M||""),C.a.If(ba||""),oa,C.a.If(Ja||""))}static nYh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static G6a(b,h,r,A){r=r?String.format('Title="{0}"',
C.a.If(r)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',C.a.If(b||""),C.a.If(h||""),r,A)}}Re.Jfj="MenuMru";Re.RDn="MenuLoading";Re.H0m="MenuHeader";Re.xqi="MenuFooter";Re.$gj=Md.a.sE("\n","&#10;");Object(u.a)(Re,"NewAndOpenXmlUtilities",null,[]);class Vm{constructor(){this.folderName=this.folderUrl=
this.hostName=this.hostUrl=null}}Object(u.a)(Vm,"HostInformation",null,[]);class um{constructor(b,h,r,A,M,ba){this.ZQc=this.mx=this.zxd=null;this.UMd=this.c9e=!1;this.Suh=0;this.iYe=!1;this.wqe=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;2!==jb||this.iYe||(this.Suh=(new Date).getTime(),v.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.nze,["CachedNewMenuXmlExists"]:!!this.zxd,["ShouldCallGetMoreInfo"]:this.kS.h0a}));return this.lfo(Eb)};this.LGa=
b;this.MHc=h;this.Q2a=new Pf.a(()=>new Eg.a(r.value,Object(F.a)(this,this.wQb,"getMoreInfoEventReceived")));this.SFk=A;this.Yjb=M;this.wOk=ba;this.$Pc=this.nze;this.sFd=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("GateTemplateRenderingByGetMoreInfoResponse");this.hDk=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment1",!1);this.Qqh=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment2",
!1)}get u6(){switch(this.kS.zga){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Wb(){const b=this.kS.$rc;b.qa(La.a.Xke,xe.a.frame,Object(F.a)(this,this.Xke,"newDocument"));b.qa(La.a.wqe,xe.a.frame,this.wqe)}Xke(b,h,r,A,M){if(1===r)return 32;if(2===r&&M){if(y.AFrameworkApplication.J.$("BackstagePremiumTemplateExperienceEnabled")&&M.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),y.AFrameworkApplication.va.Ob(La.a.Kgo,
2);if(M.MenuItemId&&M.SourceControlId)return"NewDocumentHome"===M.SourceControlId&&$b.a("NewDocumentFromHomeTab"),this.ZXc(M.MenuItemId,M.SourceControlId)}return 8}ZXc(b,h){var r=this.ale.bai;if(null===r)return 8;var A=y.AFrameworkApplication.J.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const M=y.AFrameworkApplication.dub;"blank"===b&&this.tpn()&&(v.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",this.u6),b="blankNew");if(M&&A){v.ULS.sendTraceTag(51455198,
202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const ba={};ba[H.a.template]=b;ba[H.a.u6]=this.u6;ba[H.a.lcid]=y.AFrameworkApplication.lcid.toString();ba[H.a.reason]=Kh.a.Xtf;ba[H.a.uiCulture]=y.AFrameworkApplication.uiCulture;ba[H.a.dataCulture]=y.AFrameworkApplication.dataCulture;y.AFrameworkApplication.DN().execute(oa=>{oa.sendMessage(K.a.ZXc,ba)})}else A=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",
r,C.a.ej(this.yMa),C.a.ej(b),C.a.ej(this.u6),C.a.ej(y.AFrameworkApplication.lcid.toString()),C.a.ej(A.toString()),C.a.ej(h),C.a.ej(y.AFrameworkApplication.hN),y.AFrameworkApplication.xm),(r=y.AFrameworkApplication.J.jb("ScenarioId"))&&""!==r&&(h+="&wdscenarioid="+C.a.ej(r)),h+="&"+y.AFrameworkApplication.Z8d(),y.AFrameworkApplication.yXa&&(h+="&"+y.AFrameworkApplication.D7d()),(r=this.mx?this.mx.Tga:null)?h+="&DestinationUrl="+C.a.ej(r):3===this.kS.zga&&this.kS.h0a&&v.ULS.sendTraceTag(508928088,202,
10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),Te.a.Cn(h,"_blank",void 0,"CreateNewDocument");2!==this.kS.zga&&3!==this.kS.zga||v.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Vi.a[this.kS.zga],["Template"]:b});y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.kS.zga&&("blank"===b||"blankNew"===b?$b.b("ConsumerTemplateNewBlank"):
(b=[Object.assign(new fa.a,{name:"TemplateId",string:b})],$b.b("ConsumerTemplateNew",null,0,!0,0,b)));return 32}tpn(){let b=!1;switch(this.kS.zga){case 3:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)}return b}wIn(b){let h=
Number.MAX_VALUE,r=Number.MIN_VALUE;const A=window.performance;if(A&&"undefined"!==typeof A.getEntriesByName){for(let ba=0;ba<b.length;ba++){var M=A.getEntriesByName(b[ba]);M&&0<M.length&&(M=M[0],h=Math.min(parseInt(String(M.fetchStart)),h),r=Math.max(parseInt(String(M.responseEnd)),r))}r>h&&v.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:r-h,["MinFetchStart"]:h,["MaxResponseEnd"]:r})}}lfo(b){b&&(this.zxd?b.PopulationXML=this.zxd:(this.kS.h0a&&
!this.mx&&this.NSn.NR("Opened New menu",!0),b.PopulationXML=this.Jgm(this.NIi())));return 32}y1i(){return!this.kS.h0a||!!this.mx&&3===this.mx.state&&!!this.mx.afb&&!!this.mx.Tga}B0f(){return y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.FXa&&!this.sFd?!0:this.y1i()}NIi(){if(!this.nze&&!this.sFd&&!this.B0f())return null;if(this.$Pc&&!this.UMd){let h=!1;var b="9";const r=y.AFrameworkApplication.J.appSettings;"NumberOfTemplatesInBackstage"in r&&(b=r.NumberOfTemplatesInBackstage);let A=this.u6;
"TemplateCollectionId"in r&&(A=r.TemplateCollectionId);this.hDk&&(A="WordConsumerWAC",b="10");this.Qqh&&(A="WordConsumerWAC",b="10",h=!0);b=String.format(this.kS.DYa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",C.a.ej(y.AFrameworkApplication.lcid.toString()),C.a.ej(A),b);Boolean.parse(r.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(r.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in r&&(b+="&templateTier="+r.TemplateTier);this.Qqh&&(b+="&col=officetemplateswordonlinestartexp2");
b=h?b+"&p=1":b+"&p=0";b+="&"+y.AFrameworkApplication.Z8d();y.AFrameworkApplication.yXa&&(b+="&"+y.AFrameworkApplication.D7d());this.kS.ged.Xj(b,1,null,null,!1,2,M=>{this.kS.iYa("CreateNewActor.GetTemplateListJson",M.data);this.$kp(M.data.Ee)},M=>{this.kS.iYa("CreateNewActor.GetTemplateListJson",M.data);this.Zkp()},null,void 0,void 0,void 0,void 0,"5");this.$Pc=!1}return this.ZQc}$kp(b){this.ZQc=b;this.$Pc=!1;this.Zjd();this.sFd?this.B0f()?this.myf():this.mx&&(v.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),
this.lyf()):this.myf()}myf(){if(y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.FXa&&zg.c()){const b=y.AFrameworkApplication.J.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),h=y.AFrameworkApplication.dub;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.ZQc,!0,b&&h));3===this.kS.zga&&v.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}Zkp(){this.UMd=this.$Pc=!0;this.Zjd();this.lyf();za.Health.instance.recordQosError("TemplateServiceReturnedFailure",
["TemplateServiceFailed"],!1,!0,!0,!1,null)}lyf(){y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.FXa&&zg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.kS.zga&&v.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}lPf(b){var h=0;for(var r=0;r<b.length;r++)if("ST"===b[r].ImageType){h=r;break}const A=b.length?b[h]:null;b=A?A.Url||"":"";var M;let ba=r=h=!1;if(A&&(M=A.AspectRatio))M=parseFloat(M),1>M?h=!0:1.5<M?r=!0:1===M&&(ba=!0);
else switch(v.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.kS.zga){case 3:h=!0;break;case 2:r=!0;break;case 5:ba=!0}return{returnValue:b,$5m:h?"95by123":r?"123by69":ba?"100by100":"123by95"}}Jgm(b){b=({Sye:h}=this.Qhl(b,this.ale,this.ale.KUc||"1056925771")).returnValue;if(h){this.zxd=b;var h=(new Date).getTime()-this.Suh;v.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}wQb(b,
h){v.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.mx||3!==b.state?2===b.state&&(v.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.c9e=!0,this.Zjd()):(this.mx=b,h||this.Zjd(),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.FXa&&zg.c()&&zg.d("setFileMenuHostInformation")&&(b=Object.assign(new Vm,{hostUrl:this.mx.Tga,hostName:this.mx.afb,folderUrl:y.AFrameworkApplication.breadcrumbFolderUrl,folderName:y.AFrameworkApplication.breadcrumbFolderName}),
v.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b)),this.sFd&&this.ZQc&&this.ZQc.length&&(this.B0f()?this.myf():this.lyf(),v.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}Qhl(b,h,r){let A;A=!1;const M=this.y1i();let ba="";this.kS.h0a&&(this.c9e?(ba=Re.XXh(h),this.c9e=!1,v.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):
this.mx?M?ba=Re.Thl(h,this.mx):this.mx.Edn?(A=!0,this.$Pc=!1,ba=Re.Rhl(h,this.mx),v.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(A=!0,ba=Re.XXh(h),v.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.mx.Tga,["StorageServiceDisplayNameIsSet"]:!!this.mx.afb})):(ba=Re.Shl(h.labelText),v.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));
M&&(ba+=Re.Phl(h,r,!ba)+({Sye:A}=this.Kil(b,r)).returnValue);return{returnValue:Re.h1l(ba),Sye:A}}Kil(b,h){let r;r=!1;if(!this.nze)return r=!0,v.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Sye:r};let A="",M="",ba="MenuTemplate";if(this.UMd)A=Re.lYh(),this.UMd=!1,v.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const oa=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);A=this.Jil(oa,
h);v.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");y.AFrameworkApplication.ahj&&"OneDrive"===this.yMa&&(M=Re.Nhl(this.OSn,y.AFrameworkApplication.ahj))}catch(oa){v.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),A=Re.lYh()}r=!0}else ba="MenuLoading",A=Re.Lil(),v.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Re.Mil(ba,A)+M,Sye:r}}Jil(b,h){let r="";
const A=[];for(let ba=0;ba<b.length;ba++){var M=b[ba];let oa="";if(M){const Ja=M.Title,jb=M.AssetId;M=M.Thumbnails;jb&&Ja&&M&&({$5m:M,returnValue:oa}=this.lPf(M),r+=Re.CUc("jbtnNewTemplate"+ba,Ja,null,M,null,oa,h,jb))}A[ba]=oa}b=new wc.a(4,1,5E3,()=>{this.wIn(A)},106);this.kS.Vke.Yb(b);return r}Zjd(){this.iYe=!0;this.kS.Pgj.rPa(this.ale.q1c);this.iYe=!1}get kS(){return this.LGa.value}get ale(){return this.MHc.value}get NSn(){return this.Q2a.value}get OSn(){return this.SFk.value}get yMa(){return this.Yjb.value}get nze(){return this.wOk.value}}
Object(u.a)(um,"CreateNewActor",null,[]);class ce{constructor(){this._initialized=!1;this.l$e={}}rD(b){this.$ki();return this.get(b)}contains(b){this.$ki();return b.toString()in this.l$e}$ki(){this._initialized||(this.J_k(),this._initialized=!0)}pmb(b,h){this.l$e[b.toString()]=h}get(b){return this.l$e[b.toString()]}}Object(u.a)(ce,"AIntlHelper",null,[]);class nd extends ce{constructor(){super()}J_k(){this.pmb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.pmb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.pmb(2,CommonUIStrings.l_Open);this.pmb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.pmb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.pmb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return nd._instance||(nd._instance=new nd)}static d8n(b){return nd.instance.rD(b)}}nd._instance=null;Object(u.a)(nd,"MruActorIntlHelper",ce,[]);var Sk;(function(b){b[b.success=0]="success";b[b.Kk=1]="failure";b[b.g1b=2]="spinner";b[b.none=3]="none"})(Sk||(Sk={}));Object(u.b)("DisplayState",Sk);
class tg{constructor(b,h,r,A,M,ba,oa,Ja){this.$Le=null;this.Vcf=!0;this.yxd="";this.uRk=0;this.e9b=null;this.NZe=3;this.Jlg=(jb,zb,Eb,Sb,nc)=>1!==Eb&&nc?this.jfo(nc):32;this.Ga=Ja;this.LGa=b;this.rya=h;this.mwk=r;this.fqk=A;this.eqk=M;this.Q2a=new Pf.a(()=>new Eg.a(ba.value,null));this.$xk=new Pf.a(()=>new Eg.a(oa.value,Object(F.a)(this,this.hRn,"mruEventResultReceived")));this.Ga.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ga.$("UiHostSupportsDocRebootFeatures")}hRn(b,h){this.e9b=b;h||this.GAj()}ayo(){this.JP.$rc.fb(La.a.Jlg,
xe.a.frame,this.Jlg,96)}jfo(b){this.W1l();this.V1l();b.PopulationXML=Re.i1l(this.yxd+this.$Le);return 32}W1l(){var b=3;let h=!1;if(this.yxd&&this.uRk===this.e9b.Vmp)v.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.NZe;else{v.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var r=this.JP.eq();this.e9b=this.gRn.NR("File Open opened",!0);this.yxd&&2!==
this.NZe&&3!==this.e9b.state?h=!0:(b=this.LLm(this.e9b),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.FXa&&zg.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.yxd=({FSn:b}=this.Lgm(this.e9b)).returnValue);r=this.JP.eq()-r;v.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:r})}2!==b&&(r={["DisplayState"]:Sk[b]},1!==b&&(r.IsStale=h),v.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",
r));this.NZe=b}LLm(b){let h;try{h=G.c(b.o$f)}catch(r){h=null,v.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",r)}return h}V1l(){this.Vcf?(v.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.$Le=({eIp:this.Vcf}=this.pKn()).returnValue):v.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");v.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.Vcf,
["NotDisplayingLink"]:!this.$Le})}Lgm(b){let h;1===b.state||0===b.state?(v.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=Re.TXh(this.e$a(2),this.e$a(5))):3===b.state&&b.o$f?(h=this.Ohl(b.o$f),b=0):(v.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=Re.HUc(this.e$a(1),this.e$a(2)),b=1);return{returnValue:h,FSn:b}}Ohl(b){let h;const r=this.xdd.KUc||"2155708348";if(b.length){h=Re.GUc("lblRecentDocuments",this.e$a(3));
let A=0;for(let M=0;M<b.length;M++){const ba=b[M];"FileName"in ba&&"DocumentUrl"in ba&&"Path"in ba&&(h+=Re.CUc("MruButton"+M,ba.FileName.toString(),ba.Path.toString(),null,this.xdd.B$a,this.xdd.X6c,r,ba.DocumentUrl.toString()),ba.IsPinned&&A++)}h=Re.G6a("RecentDocumentsMenuSection",Re.Jfj,this.e$a(2),h);v.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:A})}else h=Re.HUc(this.e$a(0),this.e$a(2)),v.ULS.sendTraceTag(5849664,
202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}pKn(){let b;b=!0;let h=this.Yfl;var r=this.Xfl;if(h&&r||!this.JP.h0a)b=!1;else{const A=this.H7d.NR("File Open",!1);3===A.state&&(h=A.Tga,r=A.afb,b=!1)}r=r?String.format(this.e$a(4),r):null;return{returnValue:Re.Ggl(this.xdd.KUc,r,h),eIp:b}}GAj(){this.JP.Pgj.rPa(this.xdd.q1c)}get JP(){return this.LGa.value}get e$a(){return this.rya.value}get xdd(){return this.mwk.value}get Yfl(){return this.fqk.value}get Xfl(){return this.eqk.value}get H7d(){return this.Q2a.value}get gRn(){return this.$xk.value}}
Object(u.a)(tg,"MruRenderer",null,[]);var Bk=d(1487);class jj{constructor(b,h,r,A,M,ba,oa){this.mx=null;this.GDh=!1;this.fxa=this.l5=0;this.wQb=Ja=>{if(!this.mx&&3===Ja.state)this.mx=Ja;else if(2===Ja.state){this.GDh?v.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.H7d.NR("NewDocumentFromStream",!0),this.GDh=!0);return}this.$tf()};this.ISn=Ja=>{if(Ja&&Ja.data&&Ja.data.Ee)if(({hv:jb}=G.d(Ja.data.Ee)).returnValue)if(Ja=jb,Ja.StatusCode!==ea.a.xz&&Ja.StatusCode!==
ea.a.kgc)v.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.u6,this.fxa,Ja.StatusCode),this.F9b(null);else if(Ja.NewDocumentUrl&&""!==Ja.NewDocumentUrl){var jb=(new Date).getTime()-this.l5;v.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.u6,this.fxa,jb);this.iGk(Ja.NewDocumentUrl)}else v.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",
this.u6,this.fxa),this.F9b(null);else v.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.u6,this.fxa,{["ResponseData"]:Bk.a.tsd(Ja.data.Ee)}),this.F9b(null);else v.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.u6,this.fxa),this.F9b(null)};this.HSn=Ja=>{Ja&&Ja.data&&v.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",
this.u6,this.fxa,Ja.data.status);this.F9b(null)};this.iGk=b;this.F9b=h;this.BHd=r;this.MHc=A;this.Yjb=M;this.LGa=ba;this.Q2a=new Pf.a(()=>new Eg.a(oa.value,this.wQb))}ZXc(){!this.mx&&this.Sbg.h0a?this.H7d.NR("NewDocumentFromStream",!0):this.$tf()}$tf(){this.l5=(new Date).getTime();var b=this.p8l.bai;if(null===b)this.F9b(null);else{var h=this.BHd.menuItemId,r=this.BHd.tOa,A=this.BHd.ygp,M=this.BHd.x8l;this.fxa="streamBase64"===A?M.length/1024:0;v.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",
this.u6,this.fxa);var ba=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,C.a.ej(this.yMa),C.a.ej(h),C.a.ej(this.u6),C.a.ej(y.AFrameworkApplication.lcid.toString()),C.a.ej(ba.toString()),C.a.ej(r),C.a.ej(y.AFrameworkApplication.hN),y.AFrameworkApplication.xm,C.a.ej(A));b+="&"+y.AFrameworkApplication.Z8d();y.AFrameworkApplication.yXa&&(b+="&"+y.AFrameworkApplication.D7d());(h=this.mx?this.mx.Tga:null)&&(b+=
"&DestinationUrl="+C.a.ej(h));this.Sbg.ged.Xj(b,2,M,{"Content-Type":"application/json; charset=utf-8"},!0,2,this.ISn,this.HSn,null,void 0,void 0,void 0,void 0,"31")}}get u6(){switch(this.Sbg.zga){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get p8l(){return this.MHc.value}get yMa(){return this.Yjb.value}get Sbg(){return this.LGa.value}get H7d(){return this.Q2a.value}}Object(u.a)(jj,"NewDocumentFromStreamOperation",null,[]);class af{constructor(b,
h,r,A){this.MHc=b;this.Yjb=h;this.LGa=r;this.Zxk=A}create(b,h,r){return new jj(b,h,r,this.MHc,this.Yjb,this.LGa,this.Zxk)}}Object(u.a)(af,"NewDocumentFromStreamOperationFactory",null,[836]);var di=d(136);class Fl{get name(){return"Common.App.NewAndOpen.UX"}uc(b){b.register(af,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as(1217).ha().Sd(()=>new af(new Pf.a(()=>y.AFrameworkApplication.ta.Hb.QJf()),new Pf.a(()=>y.AFrameworkApplication.yMa),new Pf.a(()=>b.Oa(805)),new Pf.a(()=>b.Oa(806))))}init(){y.AFrameworkApplication.J.xp(()=>
{this.L$a()})}L$a(){const b=Nf.a.iq($a.a.instance.Ra(805)),h=Nf.a.iq($a.a.instance.Ra(806));y.AFrameworkApplication.yMa&&di.Task.WAA.call(null,b,h).continueWith(()=>{const r=new um(new Pf.a(()=>b.result),new Pf.a(()=>y.AFrameworkApplication.ta.Hb.QJf()),new Pf.a(()=>h.result),new Pf.a(()=>y.AFrameworkApplication.ta.Hb.RJf().KUc||"1959943459"),new Pf.a(()=>y.AFrameworkApplication.yMa),new Pf.a(()=>y.AFrameworkApplication.vpn));r.Wb();r.Zjd()});if(y.AFrameworkApplication.mqg){const r=Nf.a.iq($a.a.instance.Ra(807));
di.Task.WAA.call(null,b,h,r).continueWith(()=>{const A=new tg(new Pf.a(()=>b.result),new Pf.a(()=>nd.d8n),new Pf.a(()=>y.AFrameworkApplication.ta.Hb.RJf()),new Pf.a(()=>y.AFrameworkApplication.c8n),new Pf.a(()=>y.AFrameworkApplication.b8n),new Pf.a(()=>h.result),new Pf.a(()=>r.result),y.AFrameworkApplication.J);A.ayo();A.GAj()})}}dispose(){}}Object(u.a)(Fl,"UXPackageManager",null,[0,1,11]);var kh=d(175);class Xf extends kh.StandardDialog{constructor(){super();this.Ed=0;this.Qe(1,CommonUIStrings.l_DialogClose)}oR(b){this.Iy(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}vyf(b){this.Iy(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(u.a)(Xf,"ErrorDialog",kh.StandardDialog,[809]);var fh=d(334);class Cj{vti(){v.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new fh.a;b.hg("api.onedrive.com");return b.task}}Object(u.a)(Cj,"OneDriveConsumerEndpointHelper",null,[797]);var Dj=d(42);class Vl{constructor(b,h,r,A){this.zGb=
this.LMa=null;this.y8e=this.A8e=!1;this.S9b=null;this.Ga=b;this.C4b=h;this.GFb=r;this.xJ=A}get SRh(){return this.C4b}get J(){return this.Ga}Lkc(){this.S9b||(this.S9b=this.ptc?vb.a.create(this.ptc,null,null,null,!1):null);return this.S9b}setup(b){this.zGb=b;this.A8e||this.y8e?this.A8e&&this.zGb&&this.zGb(!0):(b=this.Lkc())?(this.y8e=!0,b.wbb.continueWith(h=>{this.l2n(h)}),pb.a.y_(b)):(v.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.zGb(!1))}Zfg(b){v.ULS.sendTraceTag(20509838,
352,15,"Failure during OneDrive API download: {0}",b.zk?b.zk.toString():"No error detail.")}l2n(b){this.y8e=!1;if(b.ij)this.Zfg(b),this.zGb(!1);else try{this.A8e=!0,v.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.rVf(),v.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.zGb(!0)}catch(h){v.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.zGb(!1)}}vqd(b){this.LMa=b;this.GFb?v.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):
(v.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(F.a)(this,this.Xdg,"onApiReady")))}Xdg(b){b?this.phe():this.vq()}vq(){this.xJ().oR(Dj.a.g7n)}ME(b){v.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.LMa&&this.LMa(!0,b)}dispose(){this.S9b&&this.S9b.dispose()}}Object(u.a)(Vl,"AOneDriveFilePickerApiManager",null,[838,11]);class kj extends Vl{constructor(b,h,r,A,M,ba){super(h,r,A,ba);this.Ah=null;this.mya=
b;this.EOk=M}get ptc(){return this.J.jb("OneDriveApiUrl")}start(b,h){this.Ah=b;this.vqd(h)}rVf(){WL.init(1===this.SRh||2===this.SRh?{["client_id"]:this.J.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.J.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}vqd(b){this.LMa=b;!this.GFb&&this.mya.D8c?(v.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(F.a)(this,this.Xdg,"onApiReady"))):(v.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),
this.EOk())}phe(){try{v.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Ah).then(Object(F.a)(this,this.ME,"onSuccess"),Object(F.a)(this,this.onFailure,"onFailure"))}catch(b){v.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.vq()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){v.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}v.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",
b.error.code,b.error.message)}else v.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.LMa&&this.LMa(!1,b);this.vq()}}Object(u.a)(kj,"OneDriveFilePickerApiManagerV5",Vl,[]);class ql extends Vl{constructor(b,h,r,A,M){super(b,h,r,A);this.VCd=this.Rxh=null;this.mDe=()=>{this.VCd.style.visibility="hidden"===this.VCd.style.visibility?"":"hidden"};this.rvk=M;this.options={};this.options.clientId=this.J.jb("OneDriveApiV7ClientId");this.options.cancel=this.mDe}get ptc(){return this.J.jb("OneDriveApiV72Url")}start(b,
h){this.VCd=h;const r=this.rvk.vti();r.continueWith(()=>{v.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Rxh=r.result;this.vqd((A,M)=>{this.mDe();b(A,M)})},3);r.continueWith(()=>{v.ULS.sendTraceTag(24134242,352,15,r.zk.message);this.mDe()},5)}rVf(){this.options.success=b=>{const h={};h.data=b;this.ME(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.Rxh;this.options.advanced.iframeParentDiv=this.VCd}phe(){try{v.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.mDe(),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.vq()}}onFailure(b){this.LMa&&this.LMa(!1,b);this.vq()}}Object(u.a)(ql,"OneDriveFilePickerApiManagerV7",Vl,[]);class Pl extends Vl{constructor(b,h,r,A){super(b,h,r,A);this.zok=b;this.options={};this.options.advanced=
{};this.options.action="query";this.options.clientId=this.J.jb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get ptc(){return this.J.jb("OneDriveApiV72Url")}start(b,h,r,A){this.options.advanced.iframeParentDiv=r;this.options.advanced.endpointHint=A;this.options.cancel=h;this.zok.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.vqd(b)}vqd(b){this.LMa=b;this.GFb?v.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(v.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(F.a)(this,this.Xdg,"onApiReady")))}rVf(){this.options.success=b=>{const h={};h.data=b;this.ME(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}phe(){try{v.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){v.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.vq()}}Zfg(b){v.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.zk?b.zk.toString():"No error detail.");pb.a.bCo(this.ptc);this.S9b=null}vq(){this.xJ().vyf(Dj.a.bNo)}onFailure(b){this.LMa&&this.LMa(!1,b)}}Object(u.a)(Pl,"OneDriveFilePickerApiManagerV72",Vl,[]);class on{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(u.a)(on,"IExtraData",
null,[]);class vl extends Pl{constructor(b,h,r,A){super(b,h,r,A);this.options.advanced.filter=b.jb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=y.AFrameworkApplication.cSh;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.jb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new on(y.AFrameworkApplication.userSessionId))}get ptc(){return this.J.jb("OneDriveApiV72Url")}phe(){try{v.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",y.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){v.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.vq()}}}Object(u.a)(vl,"OneDriveFilePickerApiOpenManagerV72",
Pl,[]);class co{constructor(b){this.Sq=null;this.EBm=h=>{if(h.data.He===ea.a.u8&&"X-NewKey"in h.data.wi){v.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const r={};r["X-Key"]=h.data.wi["X-NewKey"];this.$xg(r)}else 0<this.T6e?(v.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.T6e),this.T6e--,this.$xg()):(v.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.Sq.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};this.GBm=h=>{"PersonalFileStorageUrl"in h.data.wi&&""!==h.data.wi.PersonalFileStorageUrl?(v.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Sq.hg(h.data.wi.PersonalFileStorageUrl)):(v.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Sq.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};
this.Gf=b;this.T6e=3}vti(){this.Sq=new fh.a;v.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.$xg();return this.Sq.task}$xg(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",y.AFrameworkApplication.fNb);this.Gf.$5a(h,1,null,b,["PersonalFileStorageUrl","X-NewKey"],2,this.GBm,this.EBm,void 0,void 0,void 0,void 0,"21")}}Object(u.a)(co,"OneDriveForBusinessEndpointHelper",null,[797]);var fm=d(755);class Hk{constructor(){this.Z=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}uc(b){this.Z=
b;this.Z.register(kj,1031).as(1550).ha().Sd(()=>new kj(fm.a.instance,y.AFrameworkApplication.J,y.AFrameworkApplication.a7,y.AFrameworkApplication.Vta,y.AFrameworkApplication.WDg,()=>new Xf));y.AFrameworkApplication.Vtb?this.Z.register(797,808).ha().Sd(()=>new Cj):this.Z.register(797,808).ha().Sd(()=>new co(y.AFrameworkApplication.Ge));this.Z.register(ql,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ha().Sd(()=>new ql(y.AFrameworkApplication.J,y.AFrameworkApplication.a7,y.AFrameworkApplication.Vta,
()=>new Xf,this.Z.resolve(808)));this.Z.register(Pl,1563).ha().Sd(()=>new Pl(y.AFrameworkApplication.J,y.AFrameworkApplication.a7,y.AFrameworkApplication.Vta,()=>new Xf));this.Z.register(vl,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ha().Sd(()=>new vl(y.AFrameworkApplication.J,y.AFrameworkApplication.a7,y.AFrameworkApplication.Vta,()=>new Xf))}static main(){E.a.instance.Mc(new Hk)}}Object(u.a)(Hk,"PackageManager",null,[0,1]);class gn{constructor(b,h,r,A,M,ba){this.PolicyCookie=
this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=r;this.PolicyCookieTTL=A;this.WasServiceDown=M;this.AffinitizedUrl=ba}}Object(u.a)(gn,"SafeLinksData",null,[]);class Mm{constructor(b,h){this.oCe=b;this.rz=h}}Object(u.a)(Mm,"SafeLinksGetUrlReputationRequestData",null,[]);class sk{constructor(b,h,r,A){this.f0n=M=>{let ba="OnGetUrlReputationSuccessCallback: ",
oa=10;const Ja=M.data.state;try{const jb=G.b(M.data.Ee).reputationResults[0],zb=jb.navigateUrl.length,Eb=Ja.oCe.length,Sb=jb.navigateUrl===Ja.oCe;jb.navigateUrl&&0<jb.navigateUrl.length&&(Ja.oCe=jb.navigateUrl);ba+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",M.data.He,jb.verdict,Eb.toString(),zb.toString(),Sb.toString());oa=50}catch(jb){ba+=String.format("Exception {0}",jb.message)}this.tMi(Ja,ba,oa)};this.e0n=M=>{let ba=
"OnGetUrlReputationFailureCallback: ";const oa=M.data.state;try{ba+=String.format("HttpStatus {0}",M.data.He)}catch(Ja){ba+=String.format("Exception {0}",Ja.message)}this.tMi(oa,ba,10)};this.Ga=b;this.Gf=h;this.tyk=r;sk.Zd=A}PAc(b,h,r){try{var A=null;sk.Zd&&(A=sk.Zd.Xf("WebServiceCall","SafeLinksGetUrlReputation"));const M=new Mm(h,A);A={};A.AffinitizedUrl=b;A.TargetUrl=h;A.PolicyCookie=r;const ba=G.c(A);this.Gf.Xj(this.tyk,2,ba,null,!1,2,this.f0n,this.e0n,M,void 0,void 0,3E3,3E3,"36");return!0}catch(M){v.ULS.sendTraceTag(588788033,
378,10,M.message)}return!1}tMi(b,h,r){b.rz&&(b.rz.stop(),b.rz=null);v.ULS.sendTraceTag(588788034,378,r,h);Te.a.Cn(b.oCe,void 0,"noopener,noreferrer","SafeLinksNav")}}sk.Zd=null;Object(u.a)(sk,"SafeLinksNavigationHelper",null,[]);var km;(function(b){b[b.Z0p=0]="enabledByPolicy";b[b.NVl=1]="disabledByPolicy";b[b.N_p=2]="disabled_GetPolicyFailure";b[b.O_p=3]="disabled_PendingGetPolicyRequest"})(km||(km={}));Object(u.b)("SafeLinksNavigationState",km);class jk{constructor(b,h,r,A=!1,M=null,ba=null){this.iEb=
this.hEb=0;this.x9c=this.pCd=!1;this.tkb=null;this.L8b=!0;this.oMd=null;this.EKm=jb=>{let zb=ea.a.cUn,Eb="";try{this.pCd=this.x9c=!1;var Sb=jb.data.state;const Td=({rz:Sb}=this.aBe(Sb)).returnValue,wf=Object.assign(new bb.a,{durationMs:Td});za.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",wf);v.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",jb.data.He,jb.data.Ee.length,Td);if(jb.data.He!==ea.a.xz)Eb=
"Unexpected httpStatus: "+jb.data.He.toString();else{Sb=null;try{Sb=G.b(jb.data.Ee)}catch(Lf){Eb="Exception:"+Lf.toString()+" deserializing response";return}if(Sb){var nc=Sb.IsSafeLinksEnabled;if(void 0===nc||null===nc||0>=nc.length)Eb="Invalid isSafeLinksEnabledString";else{v.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",nc);var Dc=jk.dkg(nc);if(void 0===Sb.WebAffinitizedUrl||null===Sb.WebAffinitizedUrl||0>=Sb.WebAffinitizedUrl.length)Eb="Invalid WebAffinitizedUrl";else if(void 0===
Sb.PolicyCookie||null===Sb.PolicyCookie||0>=Sb.PolicyCookie.length)Eb="Invalid PolicyCookie";else if(void 0===Sb.PolicyCookieTTL||null===Sb.PolicyCookieTTL)Eb="Invalid PolicyCookieTTL";else{var Zc=Sb.WebAffinitizedUrl,Gd=Sb.PolicyCookie,de=Sb.AffinitizedUrl,he=new Date;he.setMinutes(he.getMinutes()+(5<Sb.PolicyCookieTTL?Sb.PolicyCookieTTL-5:0));var fe=he.getTime(),Yd=new gn(nc,Zc,Gd,fe,!1,de);this.lNj(Yd);zb=jb.data.He;this.tkb&&(Dc?(this.H4j(this.tkb),this.iEb=this.hEb=0):(v.ULS.sendTraceTag(26019602,
378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),za.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Te.a.dqb(this.tkb)),this.tkb=null)}}}else Eb="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Td){Eb="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Td.toString()}finally{zb!==ea.a.xz&&this.sMi(zb,Eb)}};this.DKm=jb=>{this.pCd=!1;let zb=500,Eb="";try{let Sb=jb.data.state;const nc=({rz:Sb}=this.aBe(Sb)).returnValue,
Dc=Object.assign(new bb.a,{durationMs:nc});zb=jb.data.He;za.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+zb.toString(),!1,!0,Dc);Eb="Request Failed, Status="+El.a[jb.data.status]+" Duration: "+nc}catch(Sb){Eb="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+Sb.toString()}finally{this.sMi(zb,Eb)}};v.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Ga=b;this.Gf=h;this.RPa=r;jk.Zd=ba;this.uTk=A?this.Ga.jb("SafeLinksHandlerWebServiceBase"):
this.Ga.jb("WebServiceBase");this.RSk=this.Ga.jb("SafeLinksHashedUserId");this.AMp=this.Ga.jb("SafeLinksWorkloadIdHeaderValue");this.PGd=this.Ga.fc("SafeLinksMaxGetPolicyBootRetries",2);this.QGd=this.Ga.fc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.AEd=this.Ssn();this.zEd=this.Rsn();jk.fKh=this.Ga.jb("UserPrincipalName")||"";jk.$Qc=this.Ga.jb("TenantId")||"";v.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.AEd,this.zEd);if(this.AEd&&
this.zEd){h=(b=this.Hqb())?b.IsSafeLinksEnabled.toLowerCase():"";r=this.h0f();v.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,r);var oa=!b||"unknown"===h||b.WasServiceDown||r,Ja=kb.a.cH();Ja&&(Ja.set("shouldGetSafeLinksDataFromServer",oa.toString()),Ja.set("isSafeLinksEnabledCacheValue",h.toString()));M?(this.L8b=!1,M.execute(jb=>{jb.isFeatureEnabled("MsoUrlreputation",!0).then(zb=>{this.L8b=zb;Ja.set("isUserLicensedForSafeLinks",this.L8b.toString());
za.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ja);this.L8b&&oa&&this.S8d(!0);return null})})):(za.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Ja),oa&&this.S8d(!0))}}get appName(){return this.RPa}get EGe(){return this.uTk}get userId(){return this.RSk}get WJi(){try{if(""===jk.HTe){const b={};b["X-AppName"]=this.appName;b["X-AppVersion"]=y.AFrameworkApplication.buildVersion;b.OS=this.Ga.jb("PlatformNameAndVersion")||"";const h=JSON.stringify(b);
jk.HTe=window.self.btoa(h)}}catch(b){v.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",b.message)}return jk.HTe}get dHm(){const b=this.EGe?this.EGe+"/":"",h=new gb.QueryStringBuilder("SafeLinksHandler.ashx");h.Ae("app",this.appName);this.Ga.$("SafeLinksUseDebugHeader")&&h.Ae("action","debug");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Ae("s2satpop","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.Ae("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),y.AFrameworkApplication.xm)}get wRm(){const b=this.EGe?this.EGe+"/":"",h=new gb.QueryStringBuilder("SafeLinksHandler.ashx");h.Ae("app",this.appName);this.Ga.$("SafeLinksUseDebugHeader")&&h.Ae("action","debug");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Ae("s2satpop","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Ae("s2saat","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.Ae("s2se03","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&h.Ae("sladpar",this.WJi);h.Ae("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),y.AFrameworkApplication.xm)}get lSn(){jk.y7e||(jk.y7e=new sk(this.Ga,this.Gf,this.wRm,jk.Zd));return jk.y7e}PAc(b){if(!b)return v.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.Qmn(b);v.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
h,this.AEd,this.zEd,this.L8b);if(!(h&&this.AEd&&this.zEd&&this.L8b))return!1;h=0;const r=({state:h}=this.I7o()).returnValue;v.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",km[h]);const A=kb.a.cH();A&&A.set("SafeLinksNavigationState",km[h]);za.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",A);if(!r)return 2!==h&&3!==h||za.Health.instance.recordKpiFailure("SafeLinksNavigations",km[h],!1,!0,null),!1;v.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.f8o())return this.h0f()?!1:this.lSn.PAc(this.Rhm(),b,this.LEi());if(!this.h0f())return this.H4j(b),!0;this.tkb=b;v.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.x9c=!1;this.S8d();return!0}Qmn(b){b=b.toLowerCase();const h=this.Ga.pD("SafeLinksUnsupportedProtocols");if(h)for(let r=0;r<h.length;r++)if(b.startsWith(h[r]))return!1;return!0}S8d(b=!1){var h=kb.a.cH();h&&h.set("isOnBootRequest",b.toString());
za.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);za.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.Ssf("SafeLinksGetPolicy");this.Gf.Xj(this.dHm,1,null,null,!0,2,this.EKm,this.DKm,h,void 0,void 0,void 0,void 0,"23");this.x9c=b;this.pCd=!0;b?this.hEb++:this.iEb++}sMi(b,h=""){try{if(v.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.hEb<this.PGd&&this.iEb<this.QGd)this.S8d(this.x9c);
else{this.x9c=!1;v.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.hEb,this.iEb,b,h);h=null;const r=kb.a.cH();r&&(r.set("HttpStatus",b.toString()),h=Object.assign(new bb.a,{extendedProperties:r}));za.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const A=new gn("false","","",0,!0,"");this.lNj(A);this.tkb&&(v.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}",
"disabled_GetPolicyFailure"),za.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),Te.a.dqb(this.tkb),this.tkb=null)}}catch(r){v.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",r.toString())}}H4j(b){const h=this.LEi(),r=this.KSm(),A={};A.Url=b;A.SafeLinksCookie=h;A.CorrelationId=hb.a.create().toString();A.WorkloadId=this.AMp;A.UserAgentInfo=X.a.lE+"|"+this.appName;this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",
!1)&&(A.User=jk.fKh,A.TenantId=jk.$Qc,A.AdditionalProperties=this.WJi);v.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",A.CorrelationId);Te.a.Xlg(Te.a.owa(4),r,A)}Ssn(){const b=this.Ga.jb("IsSafeLinksEnabledForUser");return b?jk.dkg(b):!1}Rsn(){const b=this.Ga.pD("SafeLinksDisabledBrowsers");if(X.a.I7){if(this.Ga.my("SafeLinksForTeamsIsEnabled")&&this.Ga.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,
X.a.lE))return!1;return"officecomhwa"===(this.Ga.jb(y.AFrameworkApplication.ewa)||"").toLowerCase()?!1:!0}f8o(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&X.a.$9c?!0:X.a.I7||X.a.E4i}I7o(){let b;b=0;const h=this.Hqb(),r=h?h.IsSafeLinksEnabled:"";if(""!==r)return h.WasServiceDown?(v.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===
r.toLowerCase()?(v.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:jk.dkg(r),state:b};if(this.pCd)return b=3,v.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.hEb>=this.PGd||this.iEb>=this.QGd)return b=2,v.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.hEb,this.PGd,this.iEb,this.QGd),{returnValue:!1,state:b};
v.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.PGd+this.QGd-(this.hEb+this.iEb));return{returnValue:!0,state:b}}LEi(){const b=this.Hqb();return b?b.PolicyCookie:""}KSm(){const b=this.Hqb();return b?b.WebAffinitizedUrl:""}Rhm(){const b=this.Hqb();return b?b.AffinitizedUrl:""}Jsm(){const b=new Date;try{const h=this.Hqb();b.setTime(h?h.PolicyCookieTTL:
0)}catch(h){v.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}h0f(){const b=this.Jsm();return!!b&&b.getTime()<Date.now()}Hqb(){if(!this.oMd){const b=cb.a.instance.getItem(this.userId);if(!b||""===b)return null;this.oMd=JSON.parse(b)}return this.oMd}lNj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");
this.oMd=b;b.WasServiceDown||this.QMp(b)}QMp(b){b=JSON.stringify(b);cb.a.instance.setItem(this.userId,b)}Ssf(b){return void 0!==jk.Zd&&null!==jk.Zd?jk.Zd.Xf("WebServiceCall",b):null}aBe(b){if(void 0!==b&&null!==b){const h=b.Hi;b.stop();return{returnValue:h,rz:null}}return{returnValue:null,rz:b}}static dkg(b){return"false"!==b.toLowerCase()?!0:!1}}jk.Zd=null;jk.y7e=null;jk.$Qc="";jk.fKh="";jk.HTe="";Object(u.a)(jk,"SafeLinksManager",null,[810]);const gm=b=>{switch(b){case 3:return"Word";case 1:return"Excel";
case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},wi=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class Nm{constructor(){this.Z=null;this.nz=()=>{y.AFrameworkApplication.J.$("WACSafeLinksIsEnabled")&&(this.Z.register(jk,"Common.App.SafeLinks.SafeLinksManager").as(65).ha().Sd(()=>new jk(y.AFrameworkApplication.J,y.AFrameworkApplication.Ge,String.format("{0}-{1}",gm(y.AFrameworkApplication.ta.Hb.Uk),
wi(y.AFrameworkApplication.ta.Hb.Lma)),!1,this.Z.Ra(4),y.AFrameworkApplication.ta.$r)),this.Z.Oa(65))}}get name(){return"Common.App.SafeLinks"}uc(b){this.Z=b}init(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.xp(this.nz)}dispose(){}static main(){E.a.instance.Mc(new Nm)}}Object(u.a)(Nm,"SafeLinksPackage",null,[0,1]);var Ej=d(220);class wl{constructor(b){this.sa=new Fd.a;this.ii=b}tmb(b){this.sa.addHandler(wl.eEa,b)}Vkd(b){this.sa.removeHandler(wl.eEa,b)}DTa(b){this.sa.addHandler(wl.y0a,b)}HZb(b){this.sa.removeHandler(wl.y0a,
b)}Agf(b){this.sa.addHandler(wl.lAc,b)}pDg(){this.sa.raiseEvent(wl.eEa)}OSf(){return Ej.a.instance.HXa(y.AFrameworkApplication.Nz)}}wl.eEa="SE";wl.Bnd="SEP";wl.y0a="SER";wl.lAc="TRP";Object(u.a)(wl,"NullSessionExpirationManager",null,[794,795]);class rl{constructor(){this.SPc=this.ilb=!1;this.ftc=()=>{Ej.a.instance.DEj(this.ftc);v.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.dSf()};this.Rfd=()=>{Ej.a.instance.UDo(this.Rfd);this.SPc||this.ilb||(v.ULS.sendTraceTag(20492680,217,50,
"SessionExpiringDetected - Showing expiring dialog."),this.SPc=!0,this.YDg())};const b=y.AFrameworkApplication.Nz;0>=b||(this.Nz=b,v.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Nz,["NowGetTime"]:(new Date).getTime(),["BootTime"]:y.AFrameworkApplication.UT}),Ej.a.instance.rQh(this.ftc),Ej.a.instance.qQh(this.Rfd))}dSf(){this.ilb||(y.AFrameworkApplication.wS(Dj.a.znd),this.ilb=!0,this.Vze())}}Object(u.a)(rl,"ASessionExpirationManager",null,
[]);var ug=d(172),Yk=d(539);class te{constructor(b,h,r,A){this.CIg="";this.lwd=b;this.rEh=r;this.nEh=A;this.Coh=h;b=(new Date(this.lwd)).format(y.AFrameworkApplication.ASj);this.CIg=this.Coh?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}$wc(b){1===b?this.rEh&&this.rEh(this.Coh):0===b&&y.AFrameworkApplication.va.Pb(La.a.close,2,Yk.g)}dispose(){this.nEh&&this.nEh()}}te.id="SessionExpirationDialog";Object(u.a)(te,"SessionExpirationDialogSharedProperties",
null,[]);class Un{}Un.lh="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(u.a)(Un,"SessionExpirationDialogHtml",null,[]);class Wh extends ug.a{constructor(b,h,r,A){super(h);const M={};this.d5a=new te(b,h,r,A);this.Pg=te.id;y.AFrameworkApplication.v_h?(this.Ed=1,this.Qe(0,CommonUIStrings.l_DialogClose)):(this.Ed=0,this.Gu=!1);h||1===y.AFrameworkApplication.ta.mode?this.Qe(1,CommonUIStrings.l_SessionExpirationRefreshButton):
this.Qe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.lh=Un.lh;M.WACSessionExpirationText=this.d5a.CIg;this.gi(CommonUIStrings.l_DefaultDialogTitle,Object(F.a)(this,this.$wc,"sessionExpirationDialogHandler"),M);this.H8(this.Ej("WACSessionExpirationText"))}$wc(b){this.d5a.$wc(b)}kTf(){this.hide()}dispose(){super.dispose();this.d5a&&this.d5a.dispose()}}Object(u.a)(Wh,"LegacySessionExpirationDialog",ug.a,[882]);class cj extends kh.StandardDialog{constructor(b,h,r,A){super(h);this.d5a=
new te(b,h,r,A);this.Pg=te.id;y.AFrameworkApplication.v_h?(this.Ed=1,this.Qe(0,CommonUIStrings.l_DialogClose)):(this.Ed=0,this.Gu=!1);h||1===y.AFrameworkApplication.ta.mode?this.Qe(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Qe(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Mx(CommonUIStrings.l_DefaultDialogTitle,this.d5a.CIg,0,Object(F.a)(this,this.$wc,"sessionExpirationDialogHandler"))}$wc(b){this.d5a.$wc(b)}kTf(){this.hide()}dispose(){super.dispose();this.d5a&&this.d5a.dispose()}}
Object(u.a)(cj,"SessionExpirationDialog",kh.StandardDialog,[882]);const Kf=(b,h,r,A)=>y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.sH&&y.AFrameworkApplication.J.$("ReactStandardSessionExpirationDialogIsEnabled")?new cj(b,h,r,A):new Wh(b,h,r,A);var nf=d(200);class bg extends rl{constructor(b){super();this.SMd=this.Iac=!0;this.X1=null;this.sa=new Fd.a;this.fhc=()=>{this.X1=null};this.axc=h=>{(h||this.ii.vTd())&&this.ii.x8(null)};this.ii=b}tmb(b){this.sa.addHandler(bg.eEa,b)}Vkd(b){this.sa.removeHandler(bg.eEa,
b)}DTa(b){this.sa.addHandler(bg.y0a,b)}HZb(b){this.sa.removeHandler(bg.y0a,b)}Agf(b){this.sa.addHandler(bg.lAc,b)}OSf(){return Ej.a.instance.HXa(y.AFrameworkApplication.Nz)}pDg(b){this.Iac=b}YDg(){this.X1||nf.a.gP||(this.SMd&&(this.X1=Kf(this.Nz,!1,this.axc,this.fhc)),this.sa.raiseEvent(bg.Bnd))}Vze(){this.X1&&(this.X1.qma&&this.X1.kTf(),this.X1=null);this.Iac&&(this.X1=Kf(this.Nz,!0,this.axc,this.fhc));this.sa.raiseEvent(bg.eEa)}}bg.eEa="SE";bg.Bnd="SEP";bg.y0a="SER";bg.lAc="TRP";Object(u.a)(bg,
"SessionExpirationManager",rl,[794,795]);class Qg{}Qg.bUk="Aborting";Qg.OQd="ActivityDuration";Qg.error="Error";Qg.NBf="Errors";Qg.ZB="Failed";Qg.UOb="FirstActivity";Qg.initialized="Initialized";Qg.o5i="KickedOut";Qg.ezn="LastActivity";Qg.SHj="RetryOverride";Qg.Sue="RequestGroups";Qg.Bxb="Requests";Qg.fve="Responses";Qg.Qwe="SessionDuration";Qg.status="Status";Qg.success="Success";Qg.vhp="Successful";Qg.tokens="Tokens";Qg.tlg="PollingDuration";Object(u.a)(Qg,"SessionExpirationStrings",null,[]);class ob{constructor(b){this.YD=
{};this.Doa={};this.k4a={};this.X$i=15;this.Eqh=!1;this.rNk=new Date;this.KFd=new Date;this.mdk=()=>{v.ULS.sendTraceTag(41964821,217,50,v.ULS.Lad({["Aggregate"]:this.Doa,["Current"]:this.YD}))};this.Gb=b;this.QQ=new wc.a(2,2,6E4*this.X$i,this.mdk,135,"SL",!1);this.Gb.Yb(this.QQ);this.Y9m()}Y9m(){this.Doa[Qg.Sue]=0;this.Doa[Qg.Bxb]=0;this.Doa[Qg.fve]=0;this.Doa[Qg.status]=Qg.initialized;this.Doa[Qg.UOb]=new Date;this.Doa[Qg.Qwe]=0;this.Doa[Qg.OQd]=0;this.Doa[Qg.Qwe]=0;this.YD[Qg.Qwe]=0;this.Doa[Qg.OQd]=
0;this.YD[Qg.OQd]=0}get xeo(){this.k4a[Qg.tlg]=+new Date-+this.k4a[Qg.UOb];return this.k4a}WUf(b,h){var r=b[h];r=r?r:0;r++;b[h]=r;this.Zzg(b)}Zzg(b){const h=new Date;b[Qg.OQd]=+h-+this.KFd;this.KFd=h;b[Qg.Qwe]=+this.KFd-+this.rNk;b[Qg.ezn]=this.KFd}Aca(b,h){this.YD[b]=h;this.Zzg(this.YD)}qzg(b,h){this.YD[b]=h;this.Zzg(this.YD)}Tmc(b){this.WUf(this.YD,b);this.WUf(this.Doa,b);this.WUf(this.k4a,b)}flush(){this.Eqh||(this.Doa[Qg.status]=this.YD[Qg.status],this.mdk(this.QQ),this.Gb.l4(this.QQ,6E4*this.X$i))}fIo(){const b=
this.YD[Qg.status];b&&(this.Doa[Qg.status]=b);this.YD={}}uIo(){this.k4a={};this.k4a[Qg.tlg]=0;this.k4a[Qg.UOb]=new Date}stop(){v.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.Eqh=!0;this.Gb.uf(this.QQ)}}Object(u.a)(ob,"SessionLogger",null,[790]);class Lb{constructor(b,h){this.OOd=b;this.dGa=h}get tokens(){return this.OOd}get errors(){return this.dGa}}Object(u.a)(Lb,"TokenRefreshArgs",null,[802]);var fc=d(469);class Jc extends Sys.EventArgs{constructor(b,
h,r,A,M,ba,oa){super();this.k4a=b;this.neo=h;this.Sue=A;this.ZB=M;this.Bxb=ba;this.fve=oa}}Object(u.a)(Jc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Tc=d(24);class qd{constructor(b,h=null,r=null){this.SPc=this.ilb=!1;this.SMd=this.Iac=!0;this.sa=new Fd.a;this.VPc=this.EKc=this.HKd=!1;this.fHb=null;this.Vzh=10;this.cFd=!1;this.iuo=()=>{this.R5c(!1);return!Ej.a.instance.HXa(y.AFrameworkApplication.Nz)};this.UTk=(A,M)=>{Ej.a.instance.Vfe?this.ftc(A,M):this.SYe?(this.EKc=!1,this.R5c(!1)):
(this.ilb||v.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.ftc(A,M))};this.VTk=(A,M)=>{Ej.a.instance.Ufe?this.Rfd(A,M):(Tc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.EKc=!1,this.R5c(!0))};this.Cdf=(A,M)=>{Ej.a.instance.Ufe?this.Rfd(A,M):this.R5c(!0)};this.ftc=()=>{this.SYe||Ej.a.instance.DEj(this.ftc);v.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.dSf(Ej.a.instance.Vfe)};this.Ynp=
()=>{const A=this.Hc.xeo;v.ULS.sendTraceTag(555255521,217,50,"{0}",G.c(A));this.sa.raiseEvent(qd.lAc,new Jc(A,A[Qg.tlg],A[Qg.UOb],A[Qg.Sue],A[Qg.ZB],A[Qg.Bxb],A[Qg.fve]))};this.ugo=()=>{3E5<+new Date-+this.bsh?(v.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.R5c(!1)):v.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")};this.Xaf=b;this.SYe=y.AFrameworkApplication.$wn;this.Gb=me.a.instance;v.ULS.sendTraceTag(39408093,
217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:y.AFrameworkApplication.Nz,["NowGetTime"]:(new Date).getTime(),["BootTime"]:y.AFrameworkApplication.UT});this.Hc=h||new ob(me.a.instance);this.Aja=r;Ej.a.instance.rQh(this.UTk);Ej.a.instance.qQh(this.Cdf);fc.SessionStatusManager.instance.ygf(this.Cdf);fc.SessionStatusManager.instance.m3k(this.ugo);this.bsh=new Date;y.AFrameworkApplication.Zwn&&(Ej.a.instance.Rnf=this.iuo);b=!1;y.AFrameworkApplication.J&&(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",
!1),this.Vzh=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=y.AFrameworkApplication.J.$("WopiTokenRefreshWhenNetworkResumed"));b?fc.SessionStatusManager.instance.ygf(this.VTk):fc.SessionStatusManager.instance.ygf(this.Cdf)}tmb(b){this.sa.addHandler(qd.eEa,b)}Vkd(b){this.sa.removeHandler(qd.eEa,b)}DTa(b){this.sa.addHandler(qd.y0a,
b)}HZb(b){this.sa.removeHandler(qd.y0a,b)}Agf(b){this.sa.addHandler(qd.lAc,b)}OSf(){return Ej.a.instance.HXa(y.AFrameworkApplication.Nz)}R5c(b){if(!this.HKd&&!this.EKc)if(this.Aja&&this.Aja.Mo)this.VPc=!0,this.Hc.Aca(Qg.status,Qg.o5i),this.Hc.flush(),this.Hc.stop();else if(v.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.VPc),this.VPc)this.Vze();else{this.Hc.flush();this.Hc.fIo();this.Hc.Tmc(Qg.Sue);this.HKd=!0;this.cFd||(this.Hc.uIo(),this.cFd=!0,this.LEl());
const h=this.Xaf.Buo(b);h.continueWith(()=>{if(this.Xaf.Fko(h))this.Hc.Tmc(Qg.vhp),this.Hc.Aca(Qg.status,Qg.success),this.SMd=!1,this.SYe&&(this.Iac=!1),this.EKc=!1,this.bsh=new Date,this.dgp(),this.sa.raiseEvent(qd.y0a,new Lb(h.result.tokens,null));else{const r=h.result.errors;this.Hc.Tmc(Qg.ZB);this.Hc.Aca(Qg.status,Qg.ZB);b||(this.VPc=this.Xaf.u$c(r));this.VPc&&(this.Hc.Aca(Qg.bUk,JSON.stringify(r)),v.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.EKc=!0;this.sa.raiseEvent(qd.y0a,
new Lb(null,r))}this.Hc.flush();this.HKd=!1})}}Rfd(){this.SPc||this.ilb||(v.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.SPc=!0,this.YDg(Ej.a.instance.Ufe))}dSf(b){if(!this.ilb){var h=b?Dj.a.bTo:Dj.a.znd;const r=Object.assign(new bb.a,{extendedProperties:new Map});r.extendedProperties.set("ErrorCode",String.format("{0}",h));y.AFrameworkApplication.wS(h,void 0,["SessionExpired"],r);b||(b=new Date,h=new Date(y.AFrameworkApplication.UT),v.ULS.sendTraceTag(51642974,
217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&za.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,r),2592E5>+b-+h&&za.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,r));this.ilb=!0;this.Vze()}}dgp(){this.cFd&&(this.Gb.uf(this.fHb),this.cFd=!1)}LEl(){this.fHb=new wc.a(2,2,1E3*this.Vzh,this.Ynp,135);this.Gb.Yb(this.fHb)}}qd.eEa="SE";
qd.Bnd="SEP";qd.y0a="SER";qd.lAc="TRP";Object(u.a)(qd,"ASessionExpirationManagerWithRefresh",null,[]);class Wc extends qd{constructor(b,h,r=null,A=null){super(h,r,A);this.X1=null;this.fhc=()=>{this.X1=null};this.axc=M=>{(M||this.ii.vTd())&&this.ii.x8(null)};this.ii=b}pDg(b){this.Iac=b}YDg(b){if(!this.X1&&!nf.a.gP){if(b)this.X1=Kf(y.AFrameworkApplication.RNa,!1,this.axc,this.fhc);else if(this.SMd){if(this.HKd)return;this.X1=Kf(y.AFrameworkApplication.Nz,!1,this.axc,this.fhc)}v.ULS.sendTraceTag(39408096,
217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",qd.Bnd,b);this.sa.raiseEvent(qd.Bnd)}}Vze(){this.X1&&(this.X1.qma&&this.X1.kTf(),this.X1=null);if(this.Iac){this.Hc.stop();if(this.Aja&&this.Aja.Mo)return;this.X1=Kf(y.AFrameworkApplication.Nz,!0,this.axc,this.fhc)}v.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",qd.eEa);this.sa.raiseEvent(qd.eEa)}}Object(u.a)(Wc,"SessionExpirationManagerWithRefresh",qd,[794,795]);class Zd{constructor(b,h,r=null,A=null){this.OJh=!1;this._instance=null;
this._frame=b;this.pp=h;this.Hc=r||new ob(me.a.instance);this.Aja=A}create(){this.OJh=y.AFrameworkApplication.gbb;if(!this.OJh)return new bg(this._frame);v.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(y.AFrameworkApplication.cJp){case 1:v.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new wl(this._frame);break;case 2:v.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");
this._instance=new Wc(this._frame,this.pp,this.Hc,this.Aja);break;default:v.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new bg(this._frame)}v.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(u.a)(Zd,"SessionExpirationManagerFactory",null,[793]);class ie{}Object(u.a)(ie,"Error",null,[]);class vf{}Object(u.a)(vf,"NamedResult",null,[]);class vg extends vf{}
Object(u.a)(vg,"ErrorInfo",vf,[]);var Ch=d(1059);class ek{constructor(b,h,r,A=null,M=!1,ba=null,oa=!1,Ja=!1,jb=!1,zb=!1,Eb=!1){this.eHa=0;this.Cja=this.qp=null;this.OOd=new qb.a;this.dGa=new qb.a;this.Sq=null;this.nKc=!1;this.iRc=this.jRc=null;this.zHo=()=>{this.AGj()};this.Gb=b;this.Zzh=h;this.Zzh.execute(Sb=>{Sb.XE(K.a.QTf,Object(F.a)(this,this.u0n,"onHostResponseReceived"))});this.V5=r;this.tIh=new Ch.a("WebServiceCall","TokenRefresh");this.Hc=A||new ob(b);this.jNk=M;this.lf=ba?ba:fc.SessionStatusManager.instance;
this.zgh=oa;this.KAd=Ja;this.ENk=jb;this.FNk=zb;this.PEh=Eb}u0n(b){if(b.MessageId!==K.a.QTf)Tc.b(39408099,306,15,"Unexpected message.");else{var h=new qb.a,r=new qb.a;this.Hc.Tmc(Qg.fve);var A=b.Values[H.a.NMj];if(!A||0>=A.length)Tc.b(40122317,306,15,"Found no tokens in the dictionary"),A=b.Values;Tc.b(40122318,306,100,"The Tokens array contains {0} tokens",A.length);this.Hc.Aca("Correlation",b.CorrelationId);var M="";for(let Ja=0;Ja<A.length;Ja++){this.Hc.qzg(Qg.tokens,A.length);var ba=A[Ja],oa=
ba;if(!oa||!oa.Name)continue;this.Hc.Tmc(oa.Name);const jb=ba;if(jb&&jb.Value)Tc.b(39408128,306,100,"Received token with name: {0}",jb.Name),h.add(jb),this.OOd.add(jb),this.KAd||this.Hc.Aca(Qg.status,Qg.success),this.zgh&&this.lf&&this.lf.LIo();else if(ba=this.PKm(ba),Tc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",oa.Name,JSON.stringify(ba),this.Cja),r.add(ba),this.KAd||(this.dGa.add(ba),M=JSON.stringify(ba),this.Hc.Aca(Qg.error,JSON.stringify(ba)),
this.Hc.Aca(Qg.status,Qg.ZB)),this.zgh)for(const zb of ba.Errors)oa=this.wsm(zb),this.lf&&this.lf.s0k(oa)}this.KAd?(0<r.count?this.iRc?this.iRc(new Lb(h,r)):Tc.b(512267295,306,15,"Received errors but the promise has completed"):this.jRc?this.jRc(new Lb(h,r)):Tc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Tc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.Cja)):(0<r.count&&""!==
M?(A=Object.assign(new bb.a,{extendedProperties:new Map}),A.extendedProperties.set("Errors",M),A.extendedProperties.set("RetryCount",this.eHa.toString()),A.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),A.extendedProperties.set("IsTokenExpiring",this.nKc.toString()),this.J0f()&&A.extendedProperties.set("IsAppShuttingDown",y.AFrameworkApplication.Xl.toString()),za.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,A)):za.Health.instance.recordKpiSuccess("WACTokenRefresh",
null),Tc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.Cja),0<r.count&&!this.u$c(r)?(b=this.V5.bGi(r),b!==this.V5.cwc&&(this.Hc.qzg(Qg.SHj,b),this.Gb.l4(this.qp,b))):(this.Hc.flush(),this.qp&&(Tc.b(39408131,306,100,"Deleting task {0} from task manager",this.qp.name),this.Gb.uf(this.qp)),this.Sq&&!this.Sq.task.isCompleted?this.Sq.hg(new Lb(h,r)):Tc.b(512267293,306,15,"Received results but the task has completed")))}}PKm(b){if(!b)return null;
const h=Object.assign(new vg,{Name:b.Name,Errors:[],SPCorrelationId:b.SPCorrelationId});for(const r of b.Errors)b=new ie,b.Id=r.Id,b.Details=la.a.TQb(r.Details,500),h.Errors.push(b);return h}AGj(){y.AFrameworkApplication.nd("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.eHa>=this.V5.Bje?(Tc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Cja),this.IGl(this.Sq)):(za.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.VLj())}VLj(){const b=
{};b[H.a.NMj]=this.V5.tokens;this.ENk&&(b[H.a.gTo]=this.FNk);const h=hb.a.create().toString();Tc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.V5.tokens),this.eHa+1,h,this.Cja);this.Zzh.execute(r=>{r.sendMessage(K.a.nif,b,h)});this.eHa++;this.Hc.Tmc(Qg.Bxb)}IGl(b){const h=new qb.a;for(let r=0;r<this.V5.tokens.length;r++){const A=Object.assign(new vg,{Name:this.V5.tokens[r],Errors:[Object.assign(new ie,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
h.add(A);this.dGa.add(A)}this.Gb.uf(this.qp);this.Hc.Aca(Qg.NBf,JSON.stringify(this.dGa));this.Hc.Aca(Qg.status,Qg.ZB);b&&!b.task.isCompleted&&b.hg(new Lb(new qb.a,this.dGa))}J0f(){return y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("SkipSessionExpiredVetoForShutdown")}Buo(b){y.AFrameworkApplication.nd("ej4if276;fheca743");y.AFrameworkApplication.nd("5d4fi128;abe10395");this.tIh.start();this.J0f()&&this.Gb.Vrb&&(Tc.b(508351137,306,15,"Restarting taskmanager, is shutting down {0}",
y.AFrameworkApplication.Xl),this.Gb.restart());this.nKc=b;this.Cja=hb.a.create().toString();Tc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Cja,this.nKc);this.eHa=0;this.dGa.clear();this.OOd.clear();this.Sq=new fh.a;this.KAd?this.BGj(this.V5.Bje).then(h=>{this.Sq&&!this.Sq.task.isCompleted&&this.Sq.hg(h);this.iRc=this.jRc=null;this.Hc.Aca(Qg.NBf,JSON.stringify(this.dGa));this.Hc.Aca(Qg.status,Qg.success);this.Hc.flush()}).catch(h=>{this.Sq&&!this.Sq.task.isCompleted&&
this.Sq.hg(Object(Ma.a)(802,h));this.iRc=this.jRc=null;this.Hc.Aca(Qg.NBf,JSON.stringify(this.dGa));this.Hc.Aca(Qg.status,Qg.ZB);this.Hc.flush()}):(this.qp=new wc.a(this.V5.priority,2,this.V5.cwc,this.zHo,98,K.a.nif,!0),this.jNk&&this.AGj(),this.Gb.Yb(this.qp));return this.Sq.task}BGj(b){const h=this,r=new Promise((Ja,jb)=>{h.jRc=Ja;h.iRc=jb;za.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.VLj()}),A=this,M=new Promise((Ja,jb)=>{window.setTimeout(()=>{jb(A.i$h("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},
A.V5.cwc)});let ba=b;const oa=this;return new Promise((Ja,jb)=>{ba--;Promise.race([r,M]).then(zb=>{za.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ja(zb)}).catch(zb=>{var Eb=oa.V5.cwc;if(Object(Za.a)(802,zb)&&(zb=Object(Ma.a)(802,zb),0<zb.errors.count)){oa.zFn(zb.errors);oa.nNh(zb.errors);if(oa.u$c(zb.errors)){jb(zb);return}const Sb=oa.V5.bGi(zb.errors);Sb!==oa.V5.cwc?(oa.Hc.qzg(Qg.SHj,Sb),Eb=Sb):oa.yvn(zb.errors)&&(Eb=0)}ba?window.setTimeout(()=>{oa.BGj(ba).then(Ja).catch(jb)},Eb):(Eb=
oa.i$h("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),oa.nNh(Eb.errors),jb(Eb),Tc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",oa.Cja))})})}nNh(b){for(const h of b)this.dGa.add(h)}yvn(b){if(!b.count)return!1;b=b.K(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}i$h(b,h){const r=new qb.a;for(let A=0;A<this.V5.tokens.length;A++){const M=this.JGl(this.V5.tokens[A],b,h);r.add(M)}return new Lb(new qb.a,
r)}JGl(b,h,r){return Object.assign(new vg,{Name:b,Errors:[Object.assign(new ie,{Id:h,Details:r})]})}zFn(b){if(b.count){b=b.K(b.count-1);b=JSON.stringify(b);var h=Object.assign(new bb.a,{extendedProperties:new Map});h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.eHa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.nKc.toString());this.J0f()&&h.extendedProperties.set("IsAppShuttingDown",
y.AFrameworkApplication.Xl.toString());za.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.Hc.Aca(Qg.error,b);this.Hc.Aca(Qg.status,Qg.ZB)}}Fko(b){this.tIh.stop();const h=this.YZm(b.result.errors);v.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!h,this.Cja,this.nKc,this.eHa,this.dGa.count,0<b.result.errors.count?
b.result.errors.K(0).Name:"",0<b.result.errors.count&&0<b.result.errors.K(0).Errors.length?b.result.errors.K(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.K(0).Errors.length?b.result.errors.K(0).Errors[0].Details:"");return h?!1:this.Eko(b.result.tokens)}u$c(b){return this.V5.u$c(b)}Eko(b){for(let h=0;h<b.count;h++){const r=b.K(h);if(r.Name===H.a.accessToken){const A=(new Date).getTime();r.Expiry>y.AFrameworkApplication.Nz?(v.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",
{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:A,["BootTime"]:y.AFrameworkApplication.UT},"PreviousAccessTokenTtl",y.AFrameworkApplication.Nz),y.AFrameworkApplication.accessToken=r.Value,y.AFrameworkApplication.Nz=Math.floor(r.Expiry),y.AFrameworkApplication.ePg=A,y.AFrameworkApplication.uTa=Math.floor(r.Expiry)):v.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:A,["BootTime"]:y.AFrameworkApplication.UT},
"PreviousAccessTokenTtl",y.AFrameworkApplication.Nz)}}return!0}YZm(b){let h=!1;for(let r=0;r<b.count;r++){h=!0;const A=b.K(r);v.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",A.Name,JSON.stringify(A.Errors),this.Cja,A.SPCorrelationId)}return h}E3i(b){return b.includes("aadInteractionRequired")||b.includes("sessionRevocation")||b.includes("blockAccessForTenantRestrictions")||b.includes("revoked")||b.includes("Due to organizational policies, you can't access these resources from this network location")?
!0:!1}wsm(b){let h=Dj.a.znd;const r=parseInt(b.Id);b=b.Details.toString();if(isNaN(r))h=Dj.a.jck;else{switch(r){case 401:h=Dj.a.IGe;this.PEh&&this.E3i(b)&&(h=Dj.a.wud);break;case 403:h=Dj.a.hck;this.PEh&&this.E3i(b)&&(h=Dj.a.wud);break;case 500:h=Dj.a.ick;break;case 503:h=Dj.a.lck}h===Dj.a.znd&&(h=500<r?Dj.a.kck:Dj.a.gck)}return h}}Object(u.a)(ek,"TokenRefreshManager",null,[792]);class dj{constructor(){this.cwc=y.AFrameworkApplication.fJp;this.Bje=y.AFrameworkApplication.dJp;this.tokens=y.AFrameworkApplication.YTm();
this.priority=y.AFrameworkApplication.gJp;this.yCh=this.q_o();this.idf=y.AFrameworkApplication.XTm()}u$c(b){b=JSON.stringify(b);if(this.idf&&0<this.idf.length)for(const h of this.idf)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}bGi(b){try{if(b)for(const h of b)if(h.Errors)for(const r of h.Errors)if(r.Id in this.yCh)return Number.parseInvariant(this.yCh[r.Id].toString())}catch(h){v.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.cwc}q_o(){const b=
{};try{if(!y.AFrameworkApplication.$9d()||0>=y.AFrameworkApplication.$9d().length||""===y.AFrameworkApplication.$9d()[0])return b;for(const h of y.AFrameworkApplication.$9d())0<h.length&&(b[h]=y.AFrameworkApplication.eJp)}catch(h){v.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",h.toString())}return b}}Object(u.a)(dj,"TokenRefreshPolicy",null,[791]);class Cd{constructor(){this.Z=null}get name(){return"Common.App.SessionExpiration"}init(){y.AFrameworkApplication.J.xp(()=>
{this.L$a()})}L$a(){this.Z.resolve(809);this.Z.resolve(723);this.Z.resolve(682)}dispose(){}uc(b){this.Z=b;b.register(790,811).ha().Sd(()=>new ob(me.a.instance));b.register(791,810).ha().Sd(()=>new dj);b.register(792,812).ha().Sd(()=>new ek(me.a.instance,y.AFrameworkApplication.DN(),b.resolve(810),b.resolve(811),y.AFrameworkApplication.J.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Oa(117),y.AFrameworkApplication.J.$("WopiAllowTokenRefreshErrorTracking"),y.AFrameworkApplication.J.$("WopiTokenRefreshSyncMessageWithTimeout"),
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAddAllowAADPopupInPostMessage",!1),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAllowAADPopupForTokenRefresh",!1),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RevokedTokenExperiment",!1)&&y.AFrameworkApplication.J.$("ShowTokenRevocationErrorMessage")));b.register(793,809).ha().Sd(()=>new Zd(y.AFrameworkApplication.ta,b.resolve(812),b.resolve(811),
b.Oa(117)));b.register(794,682).ha().Sd(()=>b.resolve(809).create());b.register(795,723).ha().Sd(()=>b.resolve(682))}static main(){E.a.instance.Mc(new Cd)}}Object(u.a)(Cd,"SessionExpirationPackage",null,[0,1]);var gh=d(759),Xe=d(414),xh=d(340),Pj=d(208);class tj extends Pj.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(u.a)(tj,"PersonaButtonProps",Pj.a,[]);class Fj{cgc(b,h){if(b&&!(1>b.length)&&h){var r=Object.assign(new xh.a,{ExternalId:"msPresenceOuter",
ControlList:[]});this.ZGl(b,r.ControlList);h.push(r)}}ZGl(b,h){const r=Object.assign(new gh.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Xe.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,r);h=Object.assign(new xh.a,{Title:"",ControlList:[]});Array.add(r.Menu.MenuSectionList,h);this.$Jl(b,h.ControlList)}$Jl(b,h){for(let r=0;r<b.length;r++){const A=Object.assign(new tj,{ExternalId:String.format("CoauthorPersona_{0}",
r),Command:"336231556",DisplayName:b[r].userName,LabelText:b[r].userName,ImageBackColor:b[r].color,PersonaId:b[r].email,IsAnonymous:b[r].isAnonymous});Array.add(h,A)}}}Object(u.a)(Fj,"PresenceContextMenuSectionBuilder",null,[114]);var lm=d(102);class Oa{constructor(b,h,r,A){this.Cwa=this.Ut=this.qp=this.Ai=this.YPa=null;this.Pbl=()=>{this.XMd.vVh()};this.Tra=M=>{1===M?(fm.a.$pe(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),y.AFrameworkApplication.va.Ob(La.a.I3f,2)):
(this.u8o(),y.AFrameworkApplication.va.Ob(La.a.U_h,2))};this.kjl=()=>{this.GVl();y.AFrameworkApplication.va.Ob(La.a.T_h,2)};this.XMd=b;this.BOk=A;this.XMd.D8c&&(this.qp=new wc.a(3,2,5E3,this.Pbl,2),y.AFrameworkApplication.oc.Yb(this.qp),this.Wb(h,r));this.XMd.d1k(()=>{this.DWb()});this.XMd.nPh(()=>{this.EWb()})}get $Q(){return this.Ut||(this.Ut=$a.a.instance.Oa(447))}get zYh(){return this.Cwa||(this.Cwa=$a.a.instance.Oa(813))}Wb(b,h){const r=y.AFrameworkApplication.va;r.fb(La.a.wVh,xe.a.frame,b,96);
r.fb(La.a.xVh,xe.a.frame,h,96);r.qa(La.a.T_h,xe.a.frame,kd.ActionManager.nU);r.qa(La.a.U_h,xe.a.frame,kd.ActionManager.nU);r.qa(La.a.I3f,xe.a.frame,kd.ActionManager.nU)}DWb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);y.AFrameworkApplication.va.Ob(La.a.wVh,2)}EWb(){this.Kkp();y.AFrameworkApplication.va.Ob(La.a.xVh,2)}Kkp(){this.Ai&&(this.Ai.hide(),this.Ai.dispose(),this.Ai=null);this.YPa&&this.$Q&&(y.AFrameworkApplication.Xl||this.$Q.removeEntry(this.YPa),this.YPa.dispose(),this.YPa=
null)}showDialog(b){lm.a.LD(this.Ai);this.Ai=new kh.StandardDialog;this.BOk||(this.Ai.Gu=!1,this.Ai.Ed=0);this.Ai.Qe(1,CommonUIStrings.l_SignIn);this.Ai.AY(CommonUIStrings.l_DefaultDialogTitle,b,this.Tra)}u8o(){this.$Q&&this.zYh&&(this.YPa=this.zYh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.YPa.closeable=!0,this.YPa.addButton(CommonUIStrings.l_SignIn,Oa.H6a,""),this.YPa.lka=this.kjl,this.$Q.Pz(this.YPa,!1))}GVl(){this.qp&&(y.AFrameworkApplication.oc.uf(this.qp),
this.qp=null)}dispose(){this.qp=this.Ai=this.YPa=null}static H6a(){fm.a.$pe();y.AFrameworkApplication.va.Ob(La.a.I3f,2)}}Object(u.a)(Oa,"SignOutResponseUI",null,[11]);class cc{get name(){return"Common.App.UI"}uc(b){b.register(Fj,"Common.App.UI.PresenceContextMenuSectionBuilder").as(1082).ha()}init(){}dispose(){lm.a.LD(cc.mya);cc.mya=null}static main(){E.a.instance.Mc(new cc)}static i8m(b,h,r){cc.g8o()&&(cc.mya=new Oa(fm.a.instance,b,h,r))}static g8o(){return y.AFrameworkApplication.Ske&&!y.AFrameworkApplication.cga}}
cc.mya=null;Object(u.a)(cc,"CommonAppUIPackage",null,[0,1]);class Lc{get name(){return"Common.App.DialogWithLinkToResource"}uc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new Lc)}}Object(u.a)(Lc,"CommonAppDialogWithLinkToResourcePackage",null,[0,1]);var rd=d(77);class Oe{constructor(b){this.Lz=b;this.Bz=Array.indexOf(this.Lz,this.dla)}dispose(){this.Lz=null}get Hra(){return this.Lz[this.Bz]}oA(b){this.Hnd(b,!1);return!0}gjc(b){this.Hnd(b,!0)}Hnd(b,h){b&&(this.Hra!==b||h)&&(b.tabIndex=0,rd.FocusManager.bO(b));
Array.contains(this.Lz,b)&&(this.Bz=Array.indexOf(this.Lz,b))}get Bvj(){let b=this.Bz;do if(b)if(0<b&&b<this.Lz.length)b--;else break;else b=this.Lz.length-1;while(!He.DOMFocusListing.n8a(this.Lz[b])&&b!==this.Bz);return this.Lz[b]}get ghj(){let b=this.Bz;do if(b===this.Lz.length-1)b=0;else if(0<=b&&b<this.Lz.length-1)b++;else break;while(!He.DOMFocusListing.n8a(this.Lz[b])&&b!==this.Bz);return this.Lz[b]}get dla(){let b=0;for(;!He.DOMFocusListing.n8a(this.Lz[b])&&b<this.Lz.length;)b++;return He.DOMFocusListing.n8a(this.Lz[b])?
this.Lz[b]:null}get pqc(){let b=this.Lz.length-1;for(;!He.DOMFocusListing.n8a(this.Lz[b])&&0<b;)b--;return He.DOMFocusListing.n8a(this.Lz[b])?this.Lz[b]:null}}Object(u.a)(Oe,"DialogFocusListing",null,[88]);var xd=d(76);class pa extends kh.StandardDialog{constructor(b,h,r,A=null){super();this.oja=this.ey=this.xib=null;this.Lz=[];this.K5n=M=>{this.ey&&(this.ey.target="_blank",this.ey.submit());M.preventDefault()};this.qii=()=>{v.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");
return!1};this.nio=()=>{v.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.$m&&this.$m.stop()};this.pJd=h;this.ml=b;this.kzk=r;this.kMd=A;this.$m=new Ch.a("LoadResource","LoadPrintablePdf")}EJa(){this.Ed=5;this.width=40;const b=document.createElement("span");b.id=this.Ej("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.oja=document.createElement("iframe");
this.oja.name="pdfObjectFrame";this.oja.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.oja.onload=this.nio;if(this.kMd&&0<this.kMd.count){var r=Fa.a.MMf(this.pJd,this.kMd);const A=Fa.a.Asg(this.pJd,this.kMd);this.ey=document.createElement("form");this.ey.id="printPreviewPostForm";this.ey.method="POST";this.ey.target=this.oja.name;this.ey.action=A;for(const M of r)r=document.createElement("input"),r.type="hidden",r.name=M.key,r.value=M.value,this.ey.appendChild(r)}else this.oja.setAttribute("src",
this.pJd);Sys.UI.DomElement.addCssClass(this.oja,nf.a.Bwh);this.kzk?(Sys.UI.DomElement.addCssClass(this.oja,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Pe.a.Is(this.oja,Pe.a.EA,Pe.a.qq)):(Sys.UI.DomElement.addCssClass(this.oja,"DirectPrintPdfObject"),this.Lz.push(this.oja));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.oja);this.ey&&b.appendChild(this.ey);b.appendChild(document.createElement("br"));b.appendChild(this.aAl(this.ey?
"#":this.pJd));this.$m.start();this.evb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.H8(this.Ej("DirectPrintHeaderContent"));this.ey&&this.ey.submit();this.aHl();v.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}aAl(b){const h=document.createElement("span");var r=document.createElement("span");r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(r);y.AFrameworkApplication.J&&(2===y.AFrameworkApplication.ta.Hb.Uk&&y.AFrameworkApplication.J.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===y.AFrameworkApplication.ta.Hb.Uk&&y.AFrameworkApplication.J.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===y.AFrameworkApplication.ta.Hb.Uk?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===y.AFrameworkApplication.ta.Hb.Uk&&(b.innerText=CommonUIStrings.l_InternalError_Directive,v.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.xib=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(r=
document.createElement("a"),r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,r.href=b,r.target="_blank",r.id="PrintPDFLink",r.className="AllowBrowserClick",this.xib=r,h.appendChild(document.createElement("br")),h.appendChild(r),this.ey&&uf.a.addHandler(r,"click",this.K5n),this.ml.nb(zd.a.click,this.xib,this.qii,null));this.Lz.push(this.xib);return h}aHl(){if(0<this.Lz.length){const b=new Oe(this.Lz),h=rd.FocusManager.instance().gu();h&&(this.xib.focus(),h.Tk=b,h.BP=!0)}}kcd(){v.ULS.sendTraceTag(21031114,
328,50,"Download PDF from Direct Print dialog button clicked")}dispose(){this.xib&&(this.ml.xc(zd.a.click,this.xib,this.qii),this.xib=null);xd.a.Fy(this.oja);this.oja=null;super.dispose()}}Object(u.a)(pa,"DirectPrintDialog",kh.StandardDialog,[897]);class Fb{constructor(b){this.ml=b}brm(b,h,r=null){return new pa(this.ml,b,h,r)}}Object(u.a)(Fb,"DirectPrintDialogFactory",null,[886]);class Mb{constructor(b,h){this._url=b;this.rIk=h}ghi(){this.rIk?Te.a.pZl(this._url):Te.a.Cn(this._url,"_blank",void 0,
"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(u.a)(Mb,"OpenUrlInTabDialogDownloadBehavior",null,[880,11]);class Ic extends kh.StandardDialog{constructor(b,h=!0,r=!1,A=null,M=null,ba=!1,oa=null){super();this.z7b=this.y7b=this.ey=this.P5=null;this.zWn=Sb=>{this.Wli(Sb);return!0};this.AWn=Sb=>this.Oad(Sb,this.Wli);this.Wli=Sb=>{this.ey&&this.ey.submit();this.zOb(Sb.Ef)};this.Tra=Sb=>{1===Sb?(this.kcd(),this.ey?Ic.dO&&this.$yj():this.MQe.ghi()):2===Sb&&(this.Dde?this.C8h():this.Ode&&
this.k0l());this.dispose()};var Ja=this.ZIg?this.ZIg:CommonUIStrings.l_DefaultDialogTitle;Ic.hmc=ba;this.Gqk=oa;this.MQe=A||new Mb(b,!0);const jb=[],zb=[];Ic.dO&&(this.WRd&&this.WRd.forEach(Sb=>{Array.add(jb,Sb)}),this.IQh&&this.IQh.forEach(Sb=>{Array.add(zb,Sb)}));h?r?this.Dde?(this.Ed=12,this.Qe(1,this.buttonText),this.Qe(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),this.Qe(3,CommonUIStrings.l_DialogClose)):this.Ode?(this.Ed=12,this.Qe(1,this.buttonText),this.Qe(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),
this.Qe(3,CommonUIStrings.l_DialogClose)):(this.Ed=4,this.Qe(1,this.buttonText),this.Qe(2,CommonUIStrings.l_DialogClose)):(this.Ed=6,this.Qe(0,CommonUIStrings.l_DialogClose)):this.Ed=5;ba=document.createElement("span");this.nYc&&(ba.className=this.nYc);A=document.createElement("a");A.innerText=this.Kqc;A.href=b;A.target="_blank";A.id=this.Mbd;A.className=pd.AFrame.Khf;if(oa=!X.a.I7&&!X.a.E4i&&!!M&&0<M.count){const Sb=Fa.a.MMf(b,M);M=Fa.a.Asg(b,M);A.href="#";A.target="_self";this.ey=document.createElement("form");
this.ey.id="printPreviewPostForm1";this.ey.method="post";this.ey.target="_blank";this.ey.action=M;for(var Eb of Sb)M=document.createElement("input"),M.type="hidden",M.name=Eb.key,M.value=Eb.value,this.ey.appendChild(M)}else this.ey=null;this.ey||Ic.hmc?Ic.hmc||Array.add(zb,{["type"]:"AppLinkProps",["id"]:this.Mbd,["text"]:this.Kqc,["onExecute"]:()=>{this.$yj()}}):Array.add(zb,{["type"]:"AppLinkProps",["id"]:this.Mbd,["text"]:this.Kqc,["handler"]:{["href"]:oa?"#":b,["target"]:oa?"_self":"_blank"}});
this.Ubb&&Array.add(jb,this.Ubb);r?(b=document.createElement("span"),b.innerText=this.Ubb.replace("{0}",""),ba.appendChild(b)):this.mej?(b=document.createElement("span"),b.id=this.Ej("message"),Eb=document.createElement("span"),M=document.createElement("span"),oa=this.Ubb.split("{0}"),Eb.innerText=oa[0],M.innerText=oa[1],b.appendChild(Eb),b.appendChild(A),b.appendChild(M),ba.appendChild(b)):(b=document.createElement("span"),b.innerText=this.Ubb,ba.appendChild(b),ba.appendChild(document.createElement("br")),
ba.appendChild(document.createElement("br")),ba.appendChild(A),Ic.hmc||Array.add(jb,"{0}"));this.ey&&ba.appendChild(this.ey);Ic.dO&&(this.Cub&&(this.sbd?this.qNh(this.Cub,this.sbd):(Array.add(jb,"{0}"),Array.add(zb,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.Cub,["onExecute"]:()=>{}}))),this.SQd(jb,zb));this.evb(Ja,null,this.dUf,null,this.Tra,Ic.dO?null:ba);this.H8(this.Ej("message"));!Ic.dO&&this.sbd&&this.Cub&&(Ja=document.createElement("div"),Ja.className="WACDialogLearnMoreLinkContainer",
this.P5=document.createElement("a"),this.P5.innerText=this.Cub,this.P5.href=this.sbd,this.P5.target="_blank",this.P5.id=this.Ej("LearnMoreLinkId"),this.P5.className=pd.AFrame.Khf,Ja.appendChild(this.P5),h?this.Oc.insertBefore(Ja,this.Oc.lastChild):this.Oc.appendChild(Ja),this.H8(String.format("{0} {1}",this.Ej("message"),this.Ej("LearnMoreLinkId"))));this.ZGc=A;r?this.q4(this.qJ):this.q4(this.ZGc);this.qie();y.AFrameworkApplication.ta.e9.nb(zd.a.click,this.ZGc,Object(F.a)(this,this.pii,"downloadLinkClicked"),
null);this.P5&&y.AFrameworkApplication.ta.e9.nb(zd.a.click,this.P5,Object(F.a)(this,this.R6i,"learnMoreLinkClicked"),null);this.fZ=!1}get dUf(){return null}get ZIg(){return null}get Ubb(){return null}get g_h(){return this.Gqk}get sbd(){return null}get Cub(){return null}get mej(){return!1}get buttonText(){return CommonUIStrings.l_Open}get nYc(){return null}get WRd(){return null}get IQh(){return null}get Dde(){return!1}get Ode(){return!1}C8h(){this.Maa({SourceControlId:"CopyLink"},{ControlId:"CopyLink"})}k0l(){this.Maa({SourceControlId:"Share"},
{ControlId:"Share"})}Maa(b,h){const r=y.AFrameworkApplication.va;r.pE=8;r.Pb(La.a.Maa,2,b,h)}$qa(){this.ey&&(this.y7b||(this.y7b=this.zWn,this.ur.nb(zd.a.click,this.qJ,this.y7b)),this.z7b||(this.z7b=this.AWn,this.oe.nb(zd.a.hi,this.qJ,this.z7b)));super.$qa()}kcd(){}pii(){this.t6f();this.ey?this.ey.submit():this.MQe.ghi();return!0}R6i(){return!1}dispose(){this.MQe.dispose();this.ZGc&&(y.AFrameworkApplication.ta.e9.xc(zd.a.click,this.ZGc,Object(F.a)(this,this.pii,"downloadLinkClicked")),this.ZGc=null);
this.P5&&(y.AFrameworkApplication.ta.e9.xc(zd.a.click,this.P5,Object(F.a)(this,this.R6i,"learnMoreLinkClicked")),this.P5=null);this.ur&&this.y7b&&(this.ur.xc(zd.a.click,this.qJ,this.y7b),this.y7b=null);this.oe&&this.z7b&&(this.oe.xc(zd.a.hi,this.qJ,this.z7b),this.z7b=null);super.dispose()}$yj(){this.ey&&(document.body.appendChild(this.ey),this.ey.submit(),document.body.removeChild(this.ey))}static get dO(){return y.AFrameworkApplication.ta.Hb.sH&&y.AFrameworkApplication.ta.Hb.t1i}static get hmc(){return Ic.ilh}static set hmc(b){Ic.ilh=
b}}Ic.ilh=!1;Object(u.a)(Ic,"ADialogWithLinkToResource",kh.StandardDialog,[]);class ld extends Ic{constructor(b,h,r=null,A=!0,M=!1,ba=null){super(b,!0,!(ld.LAb&&A),new Mb(b,h),r,M,ba);ld.LAb=ld.LAb&&A;if(ld.LAb){h=document.createElement("iframe");A=null;M=this.Efi;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(r&&0<r.count){ba=Fa.a.MMf(b,r);b=Fa.a.Asg(b,r);A=document.createElement("form");A.id="printPreviewPostForm";A.method="POST";A.target=h.name;A.action=b;for(const oa of ba)b=document.createElement("input"),
b.type="hidden",b.name=oa.key,b.value=oa.value,A.appendChild(b)}else h.src=b;M.appendChild(h);A&&(M.appendChild(A),A.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");Pe.a.Is(h,Pe.a.EA,Pe.a.qq)}}get dUf(){return"Print_32x32x32"}get ZIg(){return ld.LAb?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get Ubb(){return ld.LAb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get WRd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Ic.hmc){let h=
CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==y.AFrameworkApplication.ta.Hb.uci&&(h=y.AFrameworkApplication.ta.Hb.uci);Array.add(b,h)}return ld.LAb?b:null}get Kqc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Mbd(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get nYc(){return y.AFrameworkApplication.Y7a?"UIFontDialogTextLarge":null}qie(){v.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}t6f(){y.AFrameworkApplication.En.H$a(9540);
v.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}kcd(){v.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get LAb(){return!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.sH&&y.AFrameworkApplication.J.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(X.a.I7||X.a.Mt||X.a.yj||X.a.bS)&&!y.AFrameworkApplication.vad&&y.AFrameworkApplication.J.$("ShouldHostDefaultToNativeBrowserPrintExperience")&&ld.SJh}static set LAb(b){ld.SJh=b}}ld.SJh=!1;Object(u.a)(ld,
"PrintDialogWithLinkToPdf",Ic,[]);class Kd{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.Crn=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.Onn=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.v1b=(b.DirectPrintSupportedMimeTypes||"").split(Kd.Oxf);this.vzb=(b.DirectPrintSupportedPlugins||"").split(Kd.Oxf);this.j6m=(b.DirectPrintImmersivePreviewPlugins||"").split(Kd.Oxf);this.JXi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");
this.Khn=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.Krl=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.v9f=14;this.wej=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.v9f=parseInt(h[0]),this.wej=parseInt(h[1])):v.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else v.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}
Kd.Oxf=",";Object(u.a)(Kd,"DirectPrintBrsSettings",null,[]);class ue{constructor(b,h){this.zGg=b;this.vzb=h}}Object(u.a)(ue,"DirectPrintProbeResults",null,[]);var Ye=d(190);class Bf{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){this.KPd=null;this.bIm=()=>{var Eb=this.SNm();const Sb=this.Bno(),nc={},Dc={};for(let Zc=0;Zc<this.mU.v1b.length;Zc++)nc[this.mU.v1b[Zc]]=Eb[Zc];for(Eb=0;Eb<this.mU.vzb.length;Eb++)Dc[this.mU.vzb[Eb]]=Sb[Eb];return new ue(nc,Dc)};this.muk=b;this.kMc=h;this.m1e=r;this.OBk=A;this.YCk=
M;this.iOc=new Pf.a(this.bIm);this.DGc=ba;this.fth=jb;this.AW=oa;this.lKc=Ja;this.tDk=zb}get mU(){return this.muk}start(){}Kio(){this.mU.Crn&&this.FHn()}Ano(){const b=Array(this.mU.v1b.length);if(void 0!==this.kMc&&null!==this.kMc)for(let h=0;h<this.mU.v1b.length;h++)b[h]=this.mU.v1b[h]in this.kMc&&this.OBk(this.kMc[this.mU.v1b[h]]);return b}Bno(){const b=Array(this.mU.vzb.length),h=!(void 0===this.m1e||null===this.m1e);for(let r=0;r<this.mU.vzb.length;r++){const A=this.mU.vzb[r];b[r]=h&&A in this.m1e?
!0:this.YCk(A)}return b}SNm(){const b=this.Ano(),h=Array(b.length);for(let r=0;r<b.length;r++)h[r]=b[r]?this.y6l(this.kMc[this.mU.v1b[r]]):null;return h}y6l(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}FHn(){v.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.iOc.value.zGg,this.iOc.value.vzb)}Z7o(){return this.tDk||!this.mU.isEnabled||y.AFrameworkApplication.vad?!1:this.Fhp()}e8o(){if(null!=this.KPd)return this.KPd;const b=Bf.IXi(this.mU);
return this.KPd=this.mU.JXi&&b||this.Ihn()}Ihn(){return X.a.Ur&&this.mU.Khn&&X.a.Jrl>=this.mU.Krl?!0:!1}Fhp(){if(!this.lKc(this.mU))return!1;var b=tb.a.g$a(this.iOc.value.zGg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=tb.a.g$a(this.iOc.value.vzb);for(const h of b)if(h)return!0;return!1}j_m(){const b=tb.a.g$a(this.iOc.value.zGg);for(const h of b)if(Ye.a.contains(this.mU.j6m,h))return!0;return!1}E$o(b,h=null){y.AFrameworkApplication.ta&&y.AFrameworkApplication.J.$("DirectPrintDialogAsStandardDialogIsEnabled")?
this.fth(b,h):this.Z7o()?this.MWl(b,this.j_m()&&!0,h):this.fth(b,h)}MWl(b,h,r=null){const A=this.AW.Xf("UserAction","OpenDirectPrintDialog");this.DGc.brm(b,h,r).EJa();A.stop()}static Cun(b){try{return new ActiveXObject(b),!0}catch(h){v.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static Nkn(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new Kd(y.AFrameworkApplication.J.appSettings);let r=
null;try{r=window.navigator.mimeTypes}catch(zb){v.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let A=null;try{A=window.navigator.plugins}catch(zb){v.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const M=Bf.Nkn,ba=Bf.Cun;b=b.resolve(814);const oa=y.AFrameworkApplication.ta.$r,Ja=Bf.Dun,jb=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.sH&&!y.AFrameworkApplication.J.$("PrintDialogFallbackLinkEnabled");return new Bf(h,r,A,M,
ba,b,oa,Ja,(zb,Eb)=>new ld(zb,!1,Eb,!0,jb),y.AFrameworkApplication.cga)}static Dun(b){return X.a.Ur||X.a.Mt&&b.Onn||b.JXi&&Bf.IXi(b)?!0:!1}static IXi(b){var h=X.a.Chc;if(h){var r=h.split(".");if(2===r.length)return h=parseInt(r[0]),r=parseInt(r[1]),h>b.v9f||h===b.v9f&&r>=b.wej}return!1}}Object(u.a)(Bf,"DirectPrintManager",null,[801]);class Fg{constructor(){this.hDb=this.Z=null}get name(){return"Common.App.DirectPrint"}uc(b){this.Z=b;b.register(Fb,814).ha().Sd(()=>new Fb(y.AFrameworkApplication.ta.e9));
b.register(801,815).ha().Sd(()=>Bf.create(this.Z))}init(){this.hDb=this.Z.resolve(815);this.hDb.start()}dispose(){}}Object(u.a)(Fg,"PackageManager",null,[0,1]);class ah{constructor(b,h=3E4){this.pJg=9E5;this.rJg=1E4;this.xbj=this.urc=null;this.F7f=0;this.Fob=Date.now;this.XPm=b;this.vfb=h;this.U4d()}mJi(b=!0){const h=this.Fob();if(h<this.F7f+this.pJg)return h>this.F7f+this.rJg&&this.U4d(),this.xbj;b&&this.U4d();return null}getToken(b=!0){return(b=this.mJi(b))?Promise.resolve(b):this.U4d()}U4d(){return this.urc=
this.urc||new Promise(b=>{this.XPm().then(h=>{this.urc=null;""!==h&&h&&(this.xbj=h,this.F7f=this.Fob(),b(h));b(null)}).catch(()=>{this.urc=null;b(null)});window.setTimeout(()=>{this.urc=null;b(null)},this.vfb)})}}Object(u.a)(ah,"OAuthCacheManager",null,[]);var Rg=d(120),Dh=d(297);class ej{constructor(){this.Jba=null;this.Hgh={};this.x0a=new Ha.a(Wa.a.vh())}getToken(b,h){if(this.x0a.mb(h))return this.x0a.K(h).getToken();const r=new ah(()=>this.nJi(b,h));this.x0a.W(h,r);return r.getToken()}WPm(b,h){if(this.x0a.mb(h))return this.x0a.K(h).mJi();
const r=new ah(()=>this.nJi(b,h));this.x0a.W(h,r);return null}nJi(b,h){if(!this.Jba)try{this.Jba=$a.a.instance.resolve(725)}catch(r){v.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+r)}return this.Jba?new Promise(r=>{const A=Date.now();this.Jba.GV(b,h).then(M=>{const ba=M.Token;!M.IsSuccess||this.Avn(ba)?(this.Pwc("GetTokenInternalImplicitJS",!1,Date.now()-A,b,M.ErrorCode,M.ErrorMessage,h),r(null)):(this.Pwc("GetTokenInternalImplicitJS",!0,Date.now()-A,b,M.ErrorCode,M.ErrorMessage,
h),r(ba))}).catch(M=>{M=M?G.c(M):"";this.Pwc("GetTokenInternalImplicitJS",!1,Date.now()-A,b,"Caught Exception",M,h);r(null)})}):new Promise(r=>{this.Pwc("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");r(null)})}Pwc(b,h,r,A,M="",ba="",oa=""){var Ja="Search"===A;const jb=[];b=Rg.a.Uaa(Ja?"Event":"EventName",b,2);A=Rg.a.Uaa("AppName",A,2);Array.add(jb,b);Array.add(jb,A);Ja&&(A=Rg.a.Uaa("LatencyType","FetchToken",2),Array.add(jb,A));M&&""!==M&&(M=Rg.a.Uaa("ErrorCode",M,
2),Array.add(jb,M));ba&&""!==ba&&(ba=Rg.a.Uaa("ErrorMessage",ba,2),Array.add(jb,ba));oa&&""!==oa&&(ba=!(oa in this.Hgh),this.Hgh[oa]=ba,ba=Rg.a.Uaa("WarmUpCall",ba.toString(),1),Array.add(jb,ba),oa=Rg.a.Uaa("Service",this.PLm(oa),2),Array.add(jb,oa));Ja=Ja?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new Dh.a,{name:Ja,samplingPolicy:2,dataFields:jb,succeeded:h,durationMs:r});ca.a.sendActivityEvent(h)}PLm(b){return b===y.AFrameworkApplication.o7f?"Loki":
b===y.AFrameworkApplication.pGg?"Substrate":y.AFrameworkApplication.J&&b===y.AFrameworkApplication.J.jb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}Avn(b){return!b||!b.length}}Object(u.a)(ej,"SearchOAuthManager",null,[789]);class ak{constructor(){this.Z=null}get name(){return"Common.App.SearchOAuthManager"}uc(b){this.Z=b;this.Z.register(789,1174).ha().Sd(()=>new ej)}init(){}dispose(){}static main(){E.a.instance.Mc(new ak)}}Object(u.a)(ak,"SearchOAuthPackage",null,[0,1]);var df=d(119),
dc=d(221),zc=d(6),je=d(127),Le=d(36),Ed=d(7);class rj{constructor(b,h,r){this.c2e=this.GHb=this.$1e=this.FHb=this.c_e=null;this.yWm=A=>{try{this.xWm(A)}catch(M){A=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",M.message,M.stack),v.ULS.sendTraceTag(5285580,334,10,A)}};this.Vp=b;this.Zuk=h;this.ib=r;this.init()}init(){this.Zuk.nb(this.yWm);this.FHb=new dh.a;this.$1e=new dh.a;this.GHb=new dh.a;this.c2e=new dc.a}nY(b){this.FHb.add(b.key,b)}uZb(b){this.GHb.add(b.key,
b)}xWm(b){let h;const r=this.ib.gb.currentSelection;({uvf:h}=rj.bsp(r)).returnValue&&(b=rj.Eom(b,this.c_e,h),this.djo(b,h,r),this.c_e=h)}djo(b,h,r){b=this.Vhm(b,h,r);let A;({notification:A}=rj.Srp(b)).returnValue&&this.Vp.sendNotification(A,!1)}Vhm(b,h,r){const A=new dh.a;A.W(1,new dc.a);A.W(0,new dc.a);b.forEach(M=>{3===M?(rj.yCg(h.node)||this.OHo(h,r),this.HFm(A,h)):M||this.dpm(A,h);return!0});return A}OHo(b,h){this.FHb.forEach((r,A)=>{A.reset(b,h);return!0})}dpm(b,h){let r=new dh.a;rj.yCg(h.node)||
(r=this.bpm(h.cpBegin));this.cpm(b,this.$1e,r,rj.FLj(this.c_e,h));this.$1e=r}bpm(b){const h=new dh.a;this.FHb.forEach((r,A)=>{r=null;({OG:r}=A.MEa(b)).returnValue&&h.W(A.key,r);return!0});return h}cpm(b,h,r,A){const M=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((ba,oa)=>{const Ja=this.FHb.K(ba).Jv||oa.title;let jb;({value:jb}=r.Ec(ba)).returnValue?A&&jb.contentObject!==oa.contentObject&&(Ja&&b.K(1).add(Ja),ba=this.FHb.K(ba).Jv,ba=String.format(M,jb.title,ba),jb.description&&(ba+=
", "+jb.description),b.K(0).add(ba)):Ja&&b.K(1).add(Ja);return!0});r.forEach((ba,oa)=>{h.mb(ba)||(ba=this.FHb.K(ba).Jv,ba=String.format(M,oa.title,ba),oa.description&&(ba+=", "+oa.description),b.K(0).add(ba));return!0})}HFm(b,h){h=this.mNm(h.node);h=this.Evl(h);this.nNm(b,this.c2e,h);this.c2e=h}mNm(b){const h=new zc.a;h.set(b);if(!h.vb(1))return null;const r=new dc.a;for(;1!==h.nf;)this.GHb.forEach((A,M)=>{let ba;({Sea:ba}=M.s2b(h)).returnValue&&r.add(ba);return!0}),h.rc();r.reverse();return r}Evl(b){b=
b.toArray();let h=0;for(;h<b.length-1;){var r=b[h];if(r.fG===b[h+1].fG&&(this.GHb.K(r.fG),({Ivl:r}={returnValue:!1,Ivl:null}).returnValue)){b.splice(h,2,r);continue}h++}return new dc.a(b)}nNm(b,h,r){var A;for(A=0;A<Math.min(r.length,h.length)&&r.K(A).contentId.equals(h.K(A).contentId);A++){var M=this.GHb.K(r.K(A).fG).Oqb(r.K(A),h.K(A));M&&(r.K(A).description&&(M+=", "+r.K(A).description),b.K(0).add(M))}for(M=A;M<r.length;M++){let ba=this.GHb.K(r.K(M).fG).Oqb(r.K(M),null);ba&&(r.K(M).description&&
(ba+=", "+r.K(M).description),b.K(0).add(ba))}for(r=A;r<h.length;r++)(A=this.GHb.K(h.K(r).fG).Jv)&&b.K(1).add(A)}static Eom(b,h,r){const A=new dc.a;(b=b||rj.CQo(h,r))?(A.add(3),A.add(0)):rj.FLj(h,r)&&A.add(0);return A}static CQo(b,h){return!b||!b.node.id.equals(h.node.id)}static FLj(b,h){return!b||!b.equals(h)}static bsp(b){let h=null;if(!b||!(Le.a.Fm(b)||(b=Le.a.yk(b,!0,!1),Le.a.Fm(b)||b.Qa&&rj.yCg(b.Qa.node))))return{returnValue:!1,uvf:h};h=b.Qa;return{returnValue:!!h,uvf:h}}static Srp(b){const h=
new dc.a;b.K(1).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,r);h.add(r);return!0});b.K(0).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,r);h.add(r);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static yCg(b){return je.a.Lt(b)||Ed.ParagraphReader.Hza(b)}}Object(u.a)(rj,"AccessibilityContextManager",null,[796]);class ad{constructor(b,h){this.iqh=!1;this.vPc=null;this.gMd=this.APd=
!1;this.cgh=null;this.cSd=(r,A)=>{(A.pQ||A.qva)&&this.KUn(A.pQ,A.qva)};this.Gb=b;this.zQ=h}get d0m(){return!!this.vPc}nb(b){this.iqh||(this.zQ.EPh(this.cSd),this.iqh=!0);this.cgh=b}KUn(b,h){this.d0m&&this.Gb.uf(this.vPc);this.APd=this.APd||b;this.gMd=this.gMd||h;this.vPc=new wc.a(5,1,ad.p4l,()=>{this.cgh(this.APd,this.gMd);this.reset()},126);this.Gb.Yb(this.vPc)}reset(){this.vPc=null;this.gMd=this.APd=!1}}ad.p4l=100;Object(u.a)(ad,"EditingViewOnAfterValidateEventsConsolidator",null,[788]);var $f=
d(49);class dg{constructor(){this.Z=null}get name(){return"Box4.Accessibility"}init(){df.a.yUh&&this.Z.resolve(325)}dispose(){}uc(b){this.Z=b;b.ia("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new ad(y.AFrameworkApplication.oc,b.resolve(230))).as(816).ha();b.ia("Box4.Accessibility.AccessibilityContextManager",()=>new rj(b.resolve(25),b.resolve(816),$f.a.instance)).as(325).ha()}static main(){E.a.instance.Mc(new dg)}}Object(u.a)(dg,"Box4AccessibilityPackage",null,[0,1]);var Wg=
d(196),Ji=d(1048),Gl=d(1623),ma=d(895),db=d(238),Ob=d(1453),Qb=d(35),sc=d(21),Oc=d(100),vc=d(25),ub=d(3);class ae extends Ob.a{get NBa(){return null!=this.p_g?this.p_g:this.p_g=$a.a.instance.Oa(66)}get wuj(){return null!=this.l3g?this.l3g:this.l3g=$a.a.instance.Oa(817)}get BE(){return!0}get commandId(){return ub.a.Ybl}Xra(b){db.a.mark(7012);const h=new Qb.GraphTransaction(15);h.Ab(b);var r=this.NI,A=this.J3,M=Ed.ParagraphReader.text(b),ba=M.substring(r,A);const oa=({icg:Ja}=C.a.YFg(ba)).returnValue;
ba!==oa&&(r+=Ja,A=r+oa.length);ba=vc.a.createTextRange(b,r,A);var Ja=M.substring(r,A);ae.Inn(M,r,A)&&(this.Qd.Ue(vc.a.createTextRange(b,r-1,A+1),Ja,!0,!1),--r,--A,ba=vc.a.createTextRange(b,r,A),r=sc.SelectionFactory.ve(b,A),$f.a.instance.Kc(r));r=Oc.a.KKa(Ja);ae.Rp.CF(ba,r,!1);M=Ja="";A=!1;this.NBa&&({Srg:Ja,nPb:M}=this.NBa.sKg(r)).returnValue&&(r=Ja,A=!0,Ja=Oc.a.VA(ba,!1),ae.Rp.rV(Ja[0].paragraph,Ja[0].hyperlink),""!==M&&(this.Qd.Ue(ba,M,!0,!1),ba=vc.a.createTextRange(b,this.NI,this.NI+M.length),
b=sc.SelectionFactory.ve(b,this.NI+this.NI+M.length),$f.a.instance.Kc(b)),ae.Rp.CF(ba,r,!1));h.dispose();!A&&this.wuj&&this.wuj.Rfo(ba,r);db.a.mark(7013)}set BE(b){super.BE=b}static get Rp(){return null!=ae.sYg?ae.sYg:ae.sYg=$a.a.instance.resolve(82)}static Inn(b,h,r){r=r!==b.length&&('"'===b.charAt(r)||"\u201d"===b.charAt(r));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&r}}Object(u.a)(ae,"HyperlinkAction",Ob.a,[]);class Ve{constructor(b){this.Qd=b}FHl(b,h,r){return new ae(null,b,h,
r,this.Qd)}}Object(u.a)(Ve,"HyperlinkActionFactory",null,[782]);var ve=d(252);class ef{constructor(){this.Z=null}get name(){return"Box4.AutoCorrect"}uc(b){this.Z=b;b.ia("Box4.AutoCorrect.AutoCorrectRules",()=>new Gl.a(b.resolve(207),b.resolve(323),ve.a.instance,y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.resolve(818),b.resolve(180).instance)).as(105).ha();b.ia("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new Ji.a(b.resolve(217),y.AFrameworkApplication.J.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as(818).ha();
b.ia("Box4.AutoCorrect.AutoCorrectScheduler",()=>new ma.a(b.resolve(105),$f.a.instance,Wg.a.instance,y.AFrameworkApplication.J,b.resolve(818),b.resolve(50),b.resolve(741))).as(70).ha();b.ia("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new Ve(b.resolve(323))).as(207).ha()}init(){this.Z.resolve(105).KCn();const b=y.AFrameworkApplication.J;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.Z.resolve(818).Ejm()}dispose(){}static main(){E.a.instance.Mc(new ef)}}
Object(u.a)(ef,"Box4AutoCorrectPackage",null,[0,1]);class We{get name(){return"Box4.Clipboard"}init(){}dispose(){}uc(){}static main(){E.a.instance.Mc(new We)}}Object(u.a)(We,"Box4ClipboardPackage",null,[0,1]);class sg{get name(){return"Box4.ImageEditors"}uc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new sg)}}Object(u.a)(sg,"Box4ImageEditorsPackage",null,[0,1]);var ke=d(614),Ue=d(877),Eh=d(673),xi=d(645),Xd=d(1107);class Ge{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,
h,r,A,M){const ba=new Ge;ba.DocumentId=M;ba.UserId=r;ba.WACSessionId=A;ba.Revision=b;ba.ChangeStateList=Xd.a.BMj(h);return ba}}Object(u.a)(Ge,"LocalUnsavedChange",null,[]);class qg{constructor(){this.bie=null}jFe(b){return new Promise((h,r)=>{this.O9h().then(A=>{const M=A.transaction(qg.ccd,"readwrite");M.objectStore(qg.ccd).put(b);M.oncomplete=()=>h();M.onerror=()=>r(M.error.message)}).catch(r)})}WVd(b,h,r){return new Promise((A,M)=>{this.O9h().then(ba=>{const oa=ba.transaction(qg.ccd,"readwrite");
oa.objectStore(qg.ccd).delete([b,h,r]);oa.oncomplete=()=>A();oa.onerror=()=>M(oa.error.message)}).catch(M)})}static isSupported(){return"indexedDB"in window}O9h(){return new Promise((b,h)=>{if(qg.isSupported())if(this.bie)b(this.bie);else{var r=window.indexedDB.open(qg.WDn,qg.XDn);r.onsuccess=()=>{this.bie=r.result;b(r.result)};r.onerror=()=>{h(r.error.message)};r.onupgradeneeded=()=>{const A=r.result,M=A.createObjectStore(qg.ccd,{keyPath:["DocumentId","UserId","WACSessionId"]});M.createIndex("DocumentId, UserId",
["DocumentId","UserId"],{unique:!1});M.createIndex("UserId",["UserId"],{unique:!1});this.bie=A;b(A)}}else h("This browser does not support IndexedDB.")})}}qg.WDn="LocalUnsavedChangeDatabase";qg.XDn=1;qg.ccd="LocalUnsavedChange";Object(u.a)(qg,"LocalUnsavedChangeStore",null,[]);class Ui{constructor(b,h,r,A,M,ba){this.d$i=b;this.Mdb=h;this.CDm=r;this.x3c=A;this.apl=M;this.TDa=ba}initialize(){const b=Ue.a.DNf(this.CDm());this.oZd=this.qYc=b;this.TDa.I2k(this.Snj.bind(this));this.TDa.J2k(this.Tnj.bind(this))}dispose(){this.TDa.zDo(this.Snj.bind(this));
this.TDa.ADo(this.Tnj.bind(this))}Snj(b,h){this.gAp(h.jB)}Tnj(b,h){this.Owp(h.jB)}Owp(b){b.equals(this.qYc)||(this.qYc=b,b.equals(this.oZd)?this.WVd():this.jFe())}gAp(b){b.equals(this.oZd)||(this.oZd=b,b.equals(this.qYc)?this.WVd():this.jFe())}zIl(){const b=Object(xi.b)({jB:this.oZd,ym:this.qYc,fileId:this.x3c().Fq,bha:this.x3c().bha,contextId:this.x3c().contextId,g2d:this.qYc.id,Mdb:this.Mdb,cee:Eh.a.iTb(this.x3c()),qbe:!1,cellId:this.x3c().ud.id},!1);return Ge.construct(b,this.apl.T2c(),Ui.userId,
Ui.sessionId,Ui.documentId)}jFe(){const b=this.zIl();this.d$i.jFe(b).then(()=>{v.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(h=>{v.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}WVd(){this.d$i.WVd(Ui.documentId,Ui.userId,Ui.sessionId).then(()=>{v.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{v.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",
b)})}static isSupported(){return qg.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=Ui.sVg?Ui.sVg:Ui.sVg=y.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=Ui.S6g?Ui.S6g:Ui.S6g=y.AFrameworkApplication.J.jb("LoggableUserId")}static get sessionId(){return null!=Ui.X3g?Ui.X3g:Ui.X3g=y.AFrameworkApplication.J.jb("SessionId")}}Object(u.a)(Ui,"LocalUnsavedChangeManager",null,[785]);class Qh{get name(){return"Box4.LocalUnsavedChange"}init(){this.tXi()&&
Ui.isSupported()&&(this.c6f=this.container.resolve(819),this.c6f.initialize())}dispose(){this.c6f&&this.c6f.dispose()}uc(b){this.container=b;if(this.tXi()){b.ia(820,()=>new qg).ha();var h=(r,A,M)=>new ke.a(r,A,M);b.ia(819,()=>new Ui(b.resolve(820),h,()=>qa.StaticActiveAppFrame.za().kb.ed.ud,()=>qa.StaticActiveAppFrame.za().kb.ed,b.resolve(505),b.resolve(821))).ha()}}static main(){E.a.instance.Mc(new Qh)}tXi(){return y.AFrameworkApplication.J.$("DisconnectedScenarioIsEnabled")}}Object(u.a)(Qh,"LocalUnsavedChangePackage",
null,[0,1]);class zh{get name(){return"Box4.NotebookLevelEditors"}uc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new zh)}}Object(u.a)(zh,"Box4NotebookLevelEditorsPackage",null,[0,1]);var Si=d(1470);class Xi{get name(){return"Box4.Search"}uc(b){b.ia("Box4.Search.FindManagerHelper",()=>Si.FindManagerHelper.instance).as(1184).ha()}init(){}dispose(){}}Object(u.a)(Xi,"PackageManager",null,[0,1]);class Ql{get name(){return"Box4.TableEditors"}uc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new Ql)}}
Object(u.a)(Ql,"Box4TableEditorsPackage",null,[0,1]);class Zk{get name(){return"Box4.TextLevelEditors"}uc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new Zk)}}Object(u.a)(Zk,"Box4TextLevelEditorsPackage",null,[0,1]);var Tj=d(125),ji=d(336),Bd=d(178),$h=d(424),rh=d(309);class il{constructor(b,h,r){this.px=this.QQa=this.$Sa=null;this.pG=this.cPe=this.fQa=0;this.Hpa=this.LEd=this.M2a=this.L2a=!1;this.xDd=this.mmh=this.pmh=0;this.tGa=b;this.ga=h;this.io=r}$R(b){return!qa.StaticActiveAppFrame.za().kb.isEditingAllowed||
fc.SessionStatusManager.instance.Nk?!1:""!==this.y3c(b.Ef)}SN(b){if(!this.$R(b))return!1;this.oXo(b);this.pG=this.tGa.Zjc();this.j_o(b);this.k_o();({toc:this.LEd,Opc:this.Hpa}=this.SPj(this.cPe));this.l_o();this.$Sa=b.tK;this.px=new Sys.UI.Point(0,0);[this.pmh,this.mmh]=this.tGa.getDimensions();v.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}$X(b){this.QQa=b.tK;this.ekl();this.xDd=rh.d(this.px.x,this.px.y,this.pmh,this.mmh,this.LEd,this.Hpa,this.xDd,y.AFrameworkApplication.J.$("SmoothImageHelperGetScaleIsEnabled"));
this.tGa.LMg(this.xDd,this.LEd,this.Hpa);return!0}$F(){this.setSize();v.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}A0(){this.tGa.avg();v.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}oXo(b){this.tGa=Tj.a.Eb(b.Ef,$h.a)}k_o(){this.cPe=(Math.floor((this.pG+22)/45)%8+this.fQa)%8}SPj(b){let h,r;if(this.pG&&90!==this.pG&&180!==this.pG&&270!==this.pG&&360!==this.pG||this.Lnn(b))return{toc:!0,Opc:!0};h=r=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:r=!0}return{toc:r,
Opc:h}}l_o(){this.M2a=this.L2a=!1;switch(this.cPe){case 0:this.M2a=this.L2a=!0;break;case 1:case 2:this.M2a=!0;break;case 7:case 6:this.L2a=!0}}Lnn(b){return!(b%2)}y3c(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==r)return r}return""}j_o(b){switch(this.y3c(b.Ef)){case "WACImageResizeHandleNW":this.fQa=
0;break;case "WACImageResizeHandleN":this.fQa=1;break;case "WACImageResizeHandleNE":this.fQa=2;break;case "WACImageResizeHandleE":this.fQa=3;break;case "WACImageResizeHandleSE":this.fQa=4;break;case "WACImageResizeHandleS":this.fQa=5;break;case "WACImageResizeHandleSW":this.fQa=6;break;case "WACImageResizeHandleW":this.fQa=7}}ekl(){var b=1;this.io.instance&&(b=this.io.instance.Cj);const h=(this.QQa.x-this.$Sa.x)/b;b=(this.QQa.y-this.$Sa.y)/b;this.px.x=this.L2a?-h:h;this.px.y=this.M2a?-b:b}setSize(){const b=
new ji.DictionaryPropertySet;b.setValue(Bd.a.m7c,100*this.xDd);b.setValue(Bd.a.pQi,!0);if(90===this.pG||270===this.pG){let h,r;({toc:h,Opc:r}=this.SPj(this.fQa));b.setValue(Bd.a.zUf,h);b.setValue(Bd.a.AUf,r)}else b.setValue(Bd.a.zUf,this.LEd),b.setValue(Bd.a.AUf,this.Hpa);this.ga.Pb(ub.a.Lmc,2,b)}}Object(u.a)(il,"ImageResizeDragAdapter",null,[96]);var Cg=d(134),Yn=d(639);class vk{constructor(b,h,r,A){this.HVe=this.QQa=this.$Sa=this.BLd=null;this.FId=this.gQd=0;this.Db=null;this.ga=b;this.ib=h;this.io=
r;this.uth=this.iHa=0;this.od=A}$R(b){return qa.StaticActiveAppFrame.za().kb.isEditingAllowed&&!fc.SessionStatusManager.instance.Nk&&b&&this.Ksn(b.Ef)?(this.BLd=this.ib.Ng)?!0:!1:!1}I3d(){}ENf(){return null}SN(b){if(!this.$R(b))return!1;this.tGa=Tj.a.Eb(b.Ef,$h.a);if(!this.tGa)return!1;this.ZLd=this.tGa.vca;if(!this.ZLd)return!1;this.BLd=this.ib.Ng;this.Db=je.a.Tn(this.BLd);if(!this.Db)return!1;this.$Sa=this.JVa(b);this.HVe=Sys.UI.DomElement.getBounds(this.ZLd);this.gQd=0<je.a.U6d(this.Db)?je.a.U6d(this.Db):
0;this.FId=je.a.LKf(this.Db);return!0}$X(b){this.QQa=this.JVa(b);this.mkl();if(this.tGa)return this.tGa.uFe(this.iHa,this.uth),!0;v.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}$F(){this.gQd=this.iHa=rh.e(this.iHa);this.L8()}A0(){this.tGa.uFe(this.FId,0)}Ksn(b){return b.classList.contains(Yn.c)||b.classList.contains(Yn.b)||b.classList.contains(Yn.a)||!!b.parentElement&&b.parentElement.classList.contains(Yn.a)}JVa(b){return this.od.Ad.h9a(b)}mkl(){var b=
1;this.io&&this.io.instance&&(b=this.io.instance.Cj);var h=new Sys.UI.Point(this.HVe.x+this.ZLd.clientWidth/2*b,this.HVe.y+this.ZLd.clientHeight/2*b);b=rh.a(this.$Sa,h);h=rh.a(this.QQa,h);this.iHa=Math.round(Cg.a.goo(h-b));0<this.gQd&&(this.iHa+=this.gQd-this.FId);this.uth=this.iHa;this.iHa+=this.FId}L8(){const b=new ji.DictionaryPropertySet;b.setValue(Bd.a.j7c,0);b.setValue(Bd.a.CX,this.iHa);this.ga.Pb(ub.a.gba,2,b)}}Object(u.a)(vk,"ImageRotateDragAdapterSimplified",null,[595,96]);class mm{constructor(){this.Z=
null}get name(){return"Box4.Images"}uc(b){this.Z=b;this.Z.ia("Box4.Images.ImageResizeDragAdapter",()=>new il(null,y.AFrameworkApplication.va,$a.a.instance.Ra(6))).as(359).ha();this.Z.ia("Box4.Images.ImageRotateDragAdapterUpdated",()=>new vk(y.AFrameworkApplication.va,$f.a.instance,$a.a.instance.Ra(6),Object(Jb.a)())).as(360).ha()}init(){this.Z.resolve(359);this.Z.resolve(360)}dispose(){}static main(){E.a.instance.Mc(new mm)}}Object(u.a)(mm,"Box4ImagesPackage",null,[0,1]);var Ud=d(67),Fe=d(106),Rc=
d(5),ui=d(510),uj=d(459),Ck=d(578),Wm=d(257),Bm=d(249),Xm=d(1787),nj=d(1688),ep=d(1160);class sj extends nj.a{constructor(b,h,r){super(b,h,r);this.DJd=this.Rlb=null}get yV(){return y.AFrameworkApplication.ta.$r}n6d(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}cGe(b){return sj.qoa(b,this.ZJi())}ZJi(){return sj.xcf}qoa(b,h=null){b=this.cGe(b);return 0!==b?(h&&h.cRd(),2===b&&(h=this.n6d(b),this.vq(this.Kxi(b),
h)),!1):!0}DAa(b,h){v.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.Thg=h;db.a.mark(5576);this.DJd=this.yV.Xf("LoadResource","PictureUploadTime");this.cce()?this.kld(b):this.ltc()}vq(b,h){const r=new kh.StandardDialog;r.Ed=0;r.Iy(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}ltc(){v.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.ltc();this.DJd&&(this.DJd.stop(),this.DJd=null)}Leb(){this.Rlb=(new ep.a).create();this.Rlb.message=CommonUIStrings.l_ImageUploadWait;
this.Rlb.Ed=5;this.Rlb.Gu=!1;this.Rlb.rM(null,null,null)}gfc(){this.Rlb&&(this.Rlb.close(),this.Rlb=null)}static s0m(b,h){b=C.a.xh(b);for(let r=0;r<h.length;++r)if(b.endsWith(h[r]))return!0;return!1}static qoa(b,h=null){h||(h=sj.xcf);return b?sj.s0m(b,h)?0:2:1}}sj.xcf=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(u.a)(sj,"PictureUploader",nj.a,[]);var Ik=d(276),Yi;(function(b){b[b.$Fe=0]="validPicture";b[b.ked=1]="noPictureSpecified";b[b.mUi=2]="invalidExtension";b[b.dqe=3]="pictureTooLarge"})(Yi||
(Yi={}));Object(u.b)("PictureValidationResult",Yi);var Rh=d(53),ze=d(13),Yf=d(38),wb=d(991);class gc{constructor(){this.vR=null}}Object(u.a)(gc,"ImageData",null,[]);var Sc=d(139),Xc=d(192),se=d(43),Qf=d(295),Jf=d(65),lf=d(857),tf=d(1576),ei=d(1633);class Ug extends ug.a{constructor(b,h=!0){super(!1,!1,Ug.dO);this.E$b=null;this.Rhh=!1;this.Lz=[];this.ar=null;this.Q_n=r=>{this.zNk&&(this.ar=this.TQj(r,this.Tlb))};this.J6n=()=>{this.ar&&this.ar.vR&&(this.Rhh||(this.ar.vxo(this.lfg),this.Rhh=!0),this.ar.Jni())};
this.lfg=r=>{this.E$b.uploadStatusLabel=r;this.p9(this.titleText,Object(F.a)(this,this.Ube,"insertDialogHandler"),this.E$b)};this.Uhg=()=>{this.kwj()};this.onKeyDown=r=>{4!==rd.FocusManager.instance().qwj(r)&&r.preventDefault()};this.Tlb=b;this.zNk=h;this.zda=this.kHh=!1;this.I5a=null;this.sSe=!1;this.lh=this.wUl;this.Pg="InsertFileDialog";this.Qe(1,this.wQd);Ug.dO?(this.E$b={["id"]:this.Pg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:this.J6n}},
["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:this.Q_n},this.gi(this.titleText,Object(F.a)(this,this.Ube,"insertDialogHandler"),this.E$b),this.fZ=!0):(this.showDialog(this.titleText,Object(F.a)(this,this.Ube,"insertDialogHandler")),h&&this.y1o(),(b=this.f5d(1))&&this.Lz.push(b),(b=this.f5d(0))&&this.Lz.push(b),this.C8j(),this.fZ=!1)}get D$j(){return this.Tlb}validate(){this.ar.vR||v.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.ar.vR.value?
!0:(Ug.Iy(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}Ube(b){1===b&&this.isEnabled()?Ug.dO&&this.ar.vR&&!this.ar.vR.value?(this.E$b.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.p9(this.titleText,Object(F.a)(this,this.Ube,"insertDialogHandler"),this.E$b)):(this.sae(),this.Tlb.DAa(this.ar,Object(F.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}y1o(){this.sSe=!1;this.ar=this.TQj(document.getElementById("uploadFrameContainer"),this.Tlb);y.AFrameworkApplication.J.$("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.I5a=this.Uhg,uf.a.addHandler(this.ar.cK,"load",this.I5a));this.ar.vR||v.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.kwj()}kwj(){if(this.ar&&!this.sSe){var b=this.ar.vR;b&&(uf.a.addHandler(b,zd.a.kj,this.onKeyDown),b=[b],this.Lz=b.concat.apply(b,this.Lz),this.C8j(),this.sSe=!0)}}dispose(){if(this.ar&&!Ug.dO){const b=this.ar.vR;b&&uf.a.removeHandler(b,zd.a.kj,this.onKeyDown);this.I5a&&uf.a.removeHandler(this.ar.cK,"load",this.I5a)}this.ar=null;super.dispose()}C8j(){if(0<
this.Lz.length){const b=new Oe(this.Lz),h=rd.FocusManager.instance().gu();h&&(this.Lz[0].focus(),h.Tk=b,h.BP=!0)}}static get dO(){return y.AFrameworkApplication.ta.Hb.sH&&y.AFrameworkApplication.ta.Hb.v1i}static Iy(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}Object(u.a)(Ug,"InsertFileDialog",ug.a,[]);class Gc{static get lh(){return ug.a.ry(Gc.Qn,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Gc.Qn="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(u.a)(Gc,"InsertImageDialogHtml",null,[]);class Fn extends Ug{constructor(b,h=!0){super(b,h)}get wQd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get wUl(){return Gc.lh}validate(){this.ar.vR||v.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(Ma.a)(sj,this.D$j);const h=b.cGe(this.ar.vR.value);return 0!==h?(b=b.n6d(h),Ug.Iy(b),!1):!0}}Object(u.a)(Fn,"InsertImageDialog",Ug,[]);class Wl extends Fn{constructor(b){super(b)}TQj(b,
h){const r=y.AFrameworkApplication.ta.Hb.sH&&y.AFrameworkApplication.ta.Hb.v1i;return new ei.a(b,Object(F.a)(h,h.lwb,"onUploadFrameInitialized"),Object(F.a)(h,h.ooa,"uploadResponseReceived"),y.AFrameworkApplication.J,!r)}isEnabled(){return Wl.VR.hka(this.D$j.context)}static get VR(){return null!=Wl.DYg?Wl.DYg:Wl.DYg=$a.a.instance.resolve(822)}}Object(u.a)(Wl,"Box4InsertImageDialog",Fn,[]);class Xg{hCl(b){return new Promise((h,r)=>{this.iCl(b).then(A=>{h(A)},A=>{r(A)})})}P7h(b){return new Promise((h,
r)=>{const A=new FileReader;A.addEventListener("load",()=>{h(A.result)},!1);A.addEventListener("error",()=>{r("FileReader exception ("+A.error.name+")")});A.readAsDataURL(b)})}iCl(b){return new Promise((h,r)=>{this.P7h(b).then(A=>{this.psf(A,"image/jpeg").then(M=>{h(M)},M=>{r(M)})},A=>{r(A)})})}psf(b,h){return new Promise((r,A)=>{const M=new Image;M.addEventListener("load",()=>{const ba=document.createElement("canvas"),oa=ba.getContext("2d");ba.width=M.width;ba.height=M.height;oa.drawImage(M,0,0);
r(ba.toDataURL(h))});M.addEventListener("error",()=>{A("Image failed to load")});M.src=b})}}Object(u.a)(Xg,"ImageFormatConverter",null,[]);var Zi=d(232),Go=d(1044);const Ym=["ImageInsertFailed"];class Jk extends sj{constructor(b,h,r,A,M,ba,oa,Ja=!0){var jb;super(b,h,r);this.Po=oa;this.qGa=this.Km=this.pJ=this.Sf=null;this.B2d="wwpicturesfc";this.kpiName="ImageFileExtension";this.AKc="LocalDeviceUpload";this.T7=new Map;this.Pni=0;this.Slb=null;this.qSe="";this.fxa=0;this.Vp=null;this.rJc="";this.tuh=
50;this.rjh=this.BHc=this.oQc=this.EMc=!1;this.iFk=19922944;this.zwh=0;this.uSe=[];this.Qhh=[];this.Awh=0;this.Y2n=()=>{Xc.a.xV&&this.Po.lM([25],this.Yd)};this.Pgg=zb=>{v.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(zb){var Eb={},Sb=this.pJ?this.pJ.properties.wc.toString():this.Sf.wc.toString();Eb[uj.a.nodeId]=this.pJ?this.pJ.id.toString():this.Sf.id.toString();Eb[uj.a.classId]=Sb;this.Lf.hasProperty(Rc.a.imageType)&&(Eb[ui.a.imageType]=this.Lf.getValue(Rc.a.imageType));
this.Lf.hasProperty(Rc.a.BX)&&(Eb[ui.a.BX]=this.Lf.getValue(Rc.a.BX));this.Lf.hasProperty(Fe.a.Oka)&&(Eb[ui.a.Oka]=this.Lf.getValue(Fe.a.Oka));this.Lf.hasProperty(Rc.a.Qub)&&(Eb[ui.a.Qub]=this.Lf.getValue(Rc.a.Qub));tf.d(zb,this.Sf,this.Km,Eb)&&(this.Nqd(zb),Jk.psc++)}else v.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.x_n=zb=>{if(!this.cWf){var Eb=this.hyi(this.ar);Eb&&(this.qSe=Eb.name,this.fxa=Eb.size);if(!this.qoa(zb,this.ar)||!this.dOg(Eb,this.ar)){Eb=Object.assign(new bb.a,
{extendedProperties:new Map});Eb.extendedProperties.set("type",this.qoa(zb,this.ar)?"Image too large":"FileType invalid");this.wie(Eb);this.rie();return}}this.DAa(this.ar,null)};this.Lf=A;this.In=M;this.ga=ba;this.Yd=Xc.a.uq||Xc.a.xV?Ik.a.getInstance(Sc.a):Ik.a.getInstance(Zi.a);this.wth=r.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.Luh=r.fc("ImageUploadMaxByteSize",Number.MAX_VALUE);Ja&&this.showDialog();null===(jb=Qf.a.c$a())||void 0===jb?void 0:jb.addHandler(this);Go.a.qrg(this.Y2n)}get NZi(){return this.J.$("JfifImageInsertIsEnabled")}get cS(){return this.AKc}get fileExtension(){return this.qSe}get fileSize(){return this.fxa}get C$j(){return this.Slb}get Gw(){return this.Vp||
(this.Vp=$a.a.instance.resolve(25))}get cWf(){return this.cS===this.AKc}showDialog(){tf.a(this.J)?(this.Tob=!1,this.ar=new ei.a(document.body,Object(F.a)(this,this.lwb,"onUploadFrameInitialized"),Object(F.a)(this,this.ooa,"uploadResponseReceived"),this.J,!1,void 0,!0)):tf.b()||this.ovb&&X.a.UF?(this.Tob=!1,this.ar=new ei.a(document.body,Object(F.a)(this,this.lwb,"onUploadFrameInitialized"),Object(F.a)(this,this.ooa,"uploadResponseReceived"),this.J,!1)):(this.Tob=!0,this.ar=(new Wl(this)).ar)}Kxi(b){switch(b){case Yi.ked:return se.a.ked;
case Yi.mUi:return se.a.Gcn;case Yi.dqe:return se.a.U5f}return Dj.a.unknown}kld(b){this.cWf||(this.Sf.Lj()?(v.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),lf.a.instance.pNg(this.Sf.Lj()),this.Sf.Lj().xg.jD(this.Pgg,Object(F.a)(this,this.pYb,"processFailure"),b)):this.pYb(b,157))}mrn(){return tf.c(this.Sf)}Nqd(b){b.Nqd();this.Slb=b.Slb}ooa(b){this.Pni=+new Date-+this.C$j;this.rie();v.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");tf.e(this,
b,this.Sf)}mNg(){v.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.ltc();Jk.psc--;this.ga.Ob(La.a.Wfb,2);this.Sf?lf.a.instance.pBc(this.Sf.Lj(),0):v.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.Gw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}pYb(b,h){var r;if(this.zKo(b))v.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,h.toLocaleString());else{b=Object.assign(new bb.a,
{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());Xc.a.uq?this.Yd.logKpiFailure({kpiName:Sc.d.OKa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:Object(rh.c)(Sc.d.Olc,b,null,!1)}):(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?this.Yd.logKpiFailure({kpiName:Zi.c.dLa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,
isInternal:!0,additionalValues:b},optionalVeto:{name:Zi.c.Jmc,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b}}):za.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Ym,!1,!0,!1,!1,b);r=this.MBf(h);v.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Sf.GL();var A=new Qb.GraphTransaction(15,ub.a.EX);A.Ab(this.Sf);Jk.VR.D_a(this.Lf,r);Jk.VR.oDj(this.Sf,
this.pJ);je.a.LOj(this.Lf,wb.a.ZB);A.dispose();this.fVj(r);this.In.bfc(b,!1);this.ltc();Jk.psc--;lf.a.instance.pBc(this.Sf.Lj(),h)}}fVj(b){const h=new kh.StandardDialog;h.Ed=0;h.Iy(se.a.oUi,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}MBf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}Zgk(){if(this.rJc&&0<this.rJc.length){const b=new ji.DictionaryPropertySet;b.setValue(Bd.a.hY,this.rJc);b.setValue(Bd.a.ega,
!0);this.ga.Pb(ub.a.C6,2,b)}this.j9o()}j9o(){let b="";this.rjh?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.EMc&&this.BHc&&this.oQc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.EMc&&this.BHc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.EMc&&this.oQc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.oQc&&this.BHc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.oQc?
b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.BHc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.EMc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.fVj(b),this.Zhk())}h0k(b){this.rJc+=String.format('<img src="{0}"></img>',b);this.Awh++}wGn(){this.oQc=!0;v.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new bb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.wie(b)}vGn(){this.BHc=
!0;v.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new bb.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");this.wie(b)}M$i(b){this.rjh=!0;v.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}wep(b){const h=new Xg;if(this.cGe(b.name)===Yi.$Fe)return h.P7h(b);if(sj.qoa(b.name,ei.a.ycf)===Yi.$Fe)return h.hCl(b)}sCl(b){return new Promise(h=>{const r=this.wep(b);void 0===r&&(this.M$i("Failed starting conversion work"),
h());r.then(A=>{A.length>this.iFk?this.wGn():this.h0k(A);h()},A=>{this.M$i(A);h()})})}kwn(b){return this.cGe(b.name)===Yi.$Fe||sj.qoa(b.name,ei.a.ycf)===Yi.$Fe}Obn(){const b=[];if(this.ar.vR.files){this.zwh=this.ar.vR.files.length;this.ar.vR.files.length>this.tuh&&(this.EMc=!0);this.Leb();for(let h=0;h<this.ar.vR.files.length&&this.tuh;h++){const r=this.ar.vR.files[h];this.uSe.push(r.name);this.Qhh.push(r.size);r&&(this.kwn(r)?b.push(this.sCl(r)):this.vGn())}}Promise.all(b).then(()=>{this.gfc();this.Zgk()});
return!0}Icn(){this.Km=hb.a.create();this.Lf||(this.Lf=new ji.DictionaryPropertySet);this.wth&&this.qGa&&this.Lf.setValue(Fe.a.$9i,this.qGa);var b=480;let h=320;const r=this.context.view.Oh.editingElement.clientWidth;0<r&&r<b&&(h=Math.floor(1*r/b*h),b=r,this.Lf.setValue(Fe.a.Oka,r));this.Lf.setValue(ze.a.Tta,Rh.a.zn(b,0));this.Lf.setValue(ze.a.Sta,Rh.a.zn(h,1));this.Lf.setValue(Yf.a.c0,wb.a.vPa);this.Lf.setValue(Bd.a.ega,!0);this.Lf.setValue(Rc.a.Qub,Box4Intl.Box4Strings.l_Picture);b=Jk.VR.jhi(this.context,
this.Lf,this.Km);if(!b)return!1;this.Sf=b.node;this.Lf=(this.pJ=b.blob)?this.pJ.properties:this.Sf.properties;Jf.a.vd().wn&&Jf.a.vd().Fk.NG(this.Sf);return!0}cce(){return this.cWf?this.Obn():this.Icn()}Zhk(){this.T7.set("FileExtensions",this.Rnm());this.T7.set("FileSizeInBytes",this.Qhh.toString());this.T7.set("Source",this.cS);this.T7.set("NumberOfImagesAttemptedToInsert",this.zwh.toString());this.T7.set("NumberOfImagesPasted",this.Awh.toString());if(Xc.a.uq){this.T7.set("ErrorLevel","warning");
var b=Object.assign(new bb.a,{extendedProperties:this.T7});this.Yd.logKpiFailure({kpiName:Sc.d.OKa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})}else(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?(this.T7.set("ErrorLevel","warning"),b=Object.assign(new bb.a,{extendedProperties:this.T7}),this.Yd.logKpiFailure({kpiName:Zi.c.dLa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):za.Health.instance.recordKpiUsage("MultipleImageInsert",
0,this.B2d,this.T7)}Rnm(){let b="";for(let h=0;h<this.uSe.length;++h)b=b+this.gyi(this.uSe[h])+",";return b}DAa(b,h){Xc.a.xV&&this.Po.mY([25]);this.wth&&(this.qGa=new gc,this.qGa.vR=b.vR);super.DAa(b,h)}lwb(b){this.ar=b;if(!this.Tob){if(this.Itd){if(tf.a(this.J)||this.ovb&&X.a.UF){b.HZc(this.x_n);return}const h=b.HZc(null),r=this.hyi(b);r&&(this.qSe=r.name,this.fxa=r.size);if(!this.qoa(h,b)||!this.dOg(r,b)){b=Object.assign(new bb.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.qoa(h,
this.ar)?"Image too large":"FileType invalid");this.wie(b);this.rie();return}}this.DAa(b,null)}}gae(){return!!Jk.psc}rie(){var b;this.T7.set("FileExtension",this.gyi(this.fileExtension));this.T7.set("Source",this.cS);this.T7.set("FileSizeInBytes",this.fileSize.toString());this.T7.set("RequestTimeInMs",this.Pni.toString());Xc.a.uq?this.Yd.logKpiUsage({kpiName:Sc.d.OKa,kpiType:0,optionalProperties:{extendedProperties:this.T7}}):(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?
this.Yd.logKpiUsage({kpiName:Zi.c.dLa,kpiType:0,optionalProperties:{extendedProperties:this.T7}}):za.Health.instance.recordKpiUsage(this.kpiName,0,this.B2d,this.T7)}gyi(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}ZJi(){return this.NZi?ei.a.jKh:sj.xcf}hyi(b){return(b=b.vR)?b.files[0]:null}dOg(b,h){return b&&b.size>this.Luh?(h&&h.cRd(),b=this.n6d(Yi.dqe),this.vq(this.Kxi(Yi.dqe),b),!1):!0}n6d(b){switch(b){case Yi.ked:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Yi.mUi:return this.NZi?
CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Yi.dqe:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.Luh/1E6));default:return""}}wie(b){var h;Xc.a.uq?(b.extendedProperties.set("ErrorLevel","info"),this.Yd.logKpiFailure({kpiName:Sc.d.OKa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:Object(rh.c)(Sc.d.Olc,b)})):(null===(h=y.AFrameworkApplication.J)||
void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Zi.c.Jmc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.Yd.logKpiFailure({kpiName:Zi.c.dLa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):za.Health.instance.recordQosError("PictureFromLocalInvalid",Ym,!0,!0,!1,!1,b)}static get VR(){return null!=
Jk.CYg?Jk.CYg:Jk.CYg=$a.a.instance.resolve(822)}}Jk.psc=0;Object(u.a)(Jk,"Box4PictureUploader",sj,[648,487]);var zo=d(838),Li=d(148);class $k{constructor(){this.Zu=this.vs=this.lHb=this.aIh=this.H4b=this.nrk=null;this.L6e=0;this.Xwa=this.P1e=this.zHb=null;this.zch=0;this.UKe=this.Xxa=this.yZe=null;this.Nnh=!1;this.dKe=this.ZJe=this.eKe=null}get assetId(){return this.H4b}get thumbnailUrl(){return this.aIh}get eio(){return this.lHb}get displayName(){return this.Xwa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.vs,this.Zu)}get f4k(){if(this.ZJe&&this.dKe&&this.eKe){const b=document.createElement("a");b.setAttribute("href",this.eKe);b.setAttribute("target","_blank");b.innerText=this.dKe;return b}return null}get HQh(){return this.ZJe}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.zch)}get Ipo(){const b=document.createElement("span");var h=0;if(this.zHb&&0<this.zHb.length){var r=this.zHb.indexOf("."),A=0>r?this.zHb:this.zHb.substring(0,r);for(A=Number.parseInvariant(A);h<
A&&5>h;h++)b.appendChild(ag.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Li.a.li("box42.png"),"","",!0,""));0<r&&(r=Number.parseInvariant(this.zHb.substr(r+1)),3>r?b.appendChild(ag.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Li.a.li("box42.png"),"","",!0,"")):8>r?b.appendChild(ag.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Li.a.li("box42.png"),"","",!0,"")):b.appendChild(ag.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Li.a.li("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(ag.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Li.a.li("box42.png"),"","",!0,""));this.P1e&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.P1e),b.appendChild(h));return b}get $Io(){return 0<this.L6e?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.L6e):""}get Kbl(){if(this.Nnh){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.UKe&&this.Xxa)return $k.pIl(this.UKe,this.Xxa);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.yZe){const h=this.yZe.split(",");b=Array(h.length);for(let r=0;r<h.length;r++)b[r]=h[r].trim()}else b=[];return b}static cfm(b){const h=new $k;for(let r=0;r<b.childNodes.length;r++){const A=b.childNodes[r];if(1===A.nodeType)try{const M=A.firstChild.nodeValue;switch(A.nodeName){case "src":h.nrk=M;break;case "assetid":h.H4b=
M;break;case "thumb":"64x64"===A.attributes.getNamedItem("size").nodeValue?h.aIh=$k.I3j(M):"192x192"===A.attributes.getNamedItem("size").nodeValue&&(h.lHb=$k.I3j(M));break;case "imagedim":if(M){const oa=M.indexOf("x");0<oa&&oa<M.length&&(h.vs=M.substr(0,oa),h.Zu=M.substr(oa+1))}break;case "resolution":h.L6e=Number.parseInvariant(M);break;case "rating":h.zHb=M;break;case "numofratings":h.P1e=M;break;case "displayname":h.Xwa=M;break;case "contentlength":h.zch=Number.parseInvariant(M)/1024;break;case "subject":h.yZe=
M;break;case "provider":h.Xxa=M;break;case "attributionlink":h.UKe=M;break;case "iscsc":h.Nnh=1===Number.parseInvariant(M);break;case "additional":const ba=A.firstChild;if(A.hasChildNodes()&&ba&&"id"===ba.nodeName&&1===Number.parseInvariant(ba.text))for(let oa=0;oa<A.childNodes.length;oa++){const Ja=A.childNodes[oa];switch(Ja.nodeName){case "caption":h.ZJe=Ja.text;break;case "value":h.eKe=Ja.text;break;case "string":h.dKe=Ja.text}}}}catch(M){}}return h}static pIl(b,h){const r=document.createElement("a");
r.setAttribute("href",b);r.setAttribute("target","_blank");r.innerText=h;return r}static I3j(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(u.a)($k,"ClipArtSearchResult",null,[]);class Kk{static get lh(){return ug.a.ry(Kk.Qn,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}Kk.Qn="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(u.a)(Kk,"InsertClipartDialogHtml",null,[]);class lq extends ug.a{constructor(b){super();this.oGa=this.wEb=0;this.oAh=null;this.V4e=!1;this.s$b=this.s4a=this.LQ=null;this.koj=h=>{const r=this.PZ.value;r&&0<r.trim().length&&(this.search(this.PZ.value),this.tva(1,!1));h.preventDefault();h.stopPropagation()};this.Y4n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.koj(h),h.preventDefault(),h.stopPropagation())};this.loj=h=>{100<=this.PZ.value.length&&(h.preventDefault(),h.stopPropagation())};
this.t3n=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.xvj(h);this.Dzg(h)};this.B0=()=>{if(this.Ps&&this.Ps.children&&!(2>this.Ps.children.length)){var h=this.Ps.children[0].children[0],r=this.Ps.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.Ps.scrollTop,A=h.clientHeight+2,M=parseInt(String(this.Ps.scrollTop/A));h=parseInt(String(r/A));var ba=parseInt(String(this.Ps.clientWidth/A));h<r/A&&h<parseInt(String(this.LQ.length/ba))&&h++;for(r=M;r<h;r++)for(A=0;A<ba;A++){var oa=
r*ba+A;M=this.LQ[oa];(oa=document.getElementById("clip"+oa))&&!oa.childNodes.length&&(M=this.ubi(M),oa.appendChild(M))}}};this.b6n=h=>{h.target.setAttribute("src",Li.a.li("phthumb.64x64x32.png"))};this.u3n=h=>{h.target.setAttribute("src",Li.a.li("phpreview.96x96x32.png"))};this.ylj=h=>{Te.a.Cn(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.x0n=h=>{(h?h.keyCode:window.event.keyCode)===
Sys.UI.Key.enter&&this.ylj(h)};this.Slj=h=>{const r=h.target.innerText;this.PZ&&(this.PZ.value=r);this.search(r);h.stopPropagation();h.preventDefault();this.tva(1,!1)};this.f1n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.Slj(h)};this.noj=h=>{this.LQ&&(this.pPo(this.LQ[this.wEb]),h.stopPropagation(),h.preventDefault(),this.PZ.value="",this.tva(1,!1))};this.Z4n=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.noj(h)};this.onKeyDown=h=>{if(h.keyCode>=Sys.UI.Key.left&&
h.keyCode<=Sys.UI.Key.down){let r=0;switch(h.keyCode){case Sys.UI.Key.up:r=-5;break;case Sys.UI.Key.down:r=5;break;case Sys.UI.Key.left:r=-1;break;case Sys.UI.Key.right:r=1}this.oGa=this.oGa+r<this.Ps.children.length-1?0>this.oGa+r?0:this.oGa+r:this.Ps.children.length-1;this.Dzg(this.oGa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.Ps.children.length&&this.nLj(h)):h.keyCode===Sys.UI.Key.tab&&(this.oGa=h.shiftKey?
Math.max(0,this.oGa-1):Math.min(this.oGa+1,this.Ps.children.length-1))};this.onError=()=>{this.Ps&&(this.Ps.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.Iwj=h=>{if(this.Ps)if(h.data.sna){var r=h.data.sna.lastChild.childNodes;this.LQ||(this.LQ=[]);for(h=0;h<r.length&&100>this.LQ.length;h++){var A=r[h];1===A.nodeType&&"image"===A.nodeName&&(A=$k.cfm(A),this.LQ.push(A))}this.Sgi();this.LQ.length||(this.Ps.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.Ee){h=C.a.nZj(h.data.Ee);
try{r=parseInt(h)}catch(M){r=14}this.Ps.innerText=26===r?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.Sgi=()=>{if(this.LQ){xd.a.ZT(this.Ps);this.s4a&&(this.s4a.dispose(),this.s4a=null);this.Ps.focus();this.Ps.classList.remove("ClipartSearchInProgress");for(let r=0;r<this.LQ.length;r++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+r;const A=document.createElement("span");A.id="clip"+r;A.classList.add("ClipartImageContainer");
h.appendChild(A);this.Ps.appendChild(h);r<parseInt(String(this.Ps.clientHeight/A.clientHeight))*parseInt(String(this.Ps.clientWidth/A.clientWidth))&&(h=this.ubi(this.LQ[r]),A.appendChild(h))}this.V4e&&(this.nLj(this.wEb),this.Dzg(this.wEb))}};this.cbn=h=>{1===h&&this.LQ&&lq.VR.hka(this.xbh.context)&&(h=this.LQ[this.wEb])&&this.xbh.xEa(h)};this.xbh=b;this.lh=Kk.lh;this.Pg="InsertClipartDialog";this.Qe(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.cbn);this.Ps=document.getElementById("clipartsearchresults");this.ULd=this.onKeyDown;uf.a.addHandler(this.Ps,"keydown",this.ULd);this.TLd=this.B0;uf.a.addHandler(this.Ps,"scroll",this.TLd);this.PZ=document.getElementById("textInput");this.tOd=this.Y4n;uf.a.addHandler(this.PZ,"keydown",this.tOd);this.uOd=this.loj;uf.a.addHandler(this.PZ,"keypress",this.uOd);this.vOd=this.loj;uf.a.addHandler(this.PZ,"paste",this.vOd);this.oEc=document.getElementById("btnSearch");this.oEc.setAttribute("src",Li.a.li("search.16x16x32.png"));
this.SLd=this.koj;uf.a.addHandler(this.oEc,"click",this.SLd);this.D6b=document.getElementById("clipartpreviewimage");this.pQe=document.getElementById("clipartattributedisplayname");this.gib=document.getElementById("clipartseesimilar");this.oQe=document.getElementById("clipartdimensions");this.QGc=document.getElementById("clipartadditionalvalue");this.qQe=document.getElementById("clipartratingvalue");this.q2a=document.getElementById("clipartattributionvalue");this.r2a=document.getElementById("clipartkeywords");
this.mQe=document.getElementById("clipartadditionalname");this.rQe=document.getElementById("clipartratingname");this.nQe=document.getElementById("clipartattributionname");this.X4e=this.t3n;this.Daf=this.b6n;this.dDd=this.ylj;this.eDd=this.x0n;this.wZe=this.Slj;this.xZe=this.f1n;this.WLd=this.noj;this.XLd=this.Z4n;this.PZ.focus();this.tva(1,!1)}dispose(){this.Ps&&this.H2h();this.Ps&&this.ULd&&(uf.a.removeHandler(this.Ps,"keydown",this.ULd),this.ULd=null);this.Ps&&this.TLd&&(uf.a.removeHandler(this.Ps,
"scroll",this.TLd),this.TLd=null);this.Ps=null;this.PZ&&this.tOd&&(uf.a.removeHandler(this.PZ,"keydown",this.tOd),this.tOd=null);this.PZ&&this.uOd&&(uf.a.removeHandler(this.PZ,"keypress",this.uOd),this.uOd=null);this.PZ&&this.vOd&&(uf.a.removeHandler(this.PZ,"paste",this.vOd),this.vOd=null);this.PZ=null;this.oEc&&this.SLd&&(uf.a.removeHandler(this.oEc,"click",this.SLd),this.oEc=this.SLd=null);this.nQe=this.rQe=this.mQe=this.r2a=this.q2a=this.qQe=this.QGc=this.oQe=this.gib=this.pQe=this.D6b=this.XLd=
this.WLd=this.xZe=this.wZe=this.eDd=this.dDd=this.s$b=this.Daf=this.X4e=null;this.s4a&&(this.s4a.dispose(),this.s4a=null);super.dispose()}$N(){super.$N();document.getElementById(this.Ej("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.H_b(b,!1,this.Iwj)}H_b(b,h,r){this.oGa=this.wEb=0;this.H2h();if(this.LQ&&b===this.oAh&&this.V4e===h)window.setTimeout(this.Sgi,500);else{this.LQ&&(Array.clear(this.LQ),this.LQ=null);this.oAh=b;this.V4e=h;var A=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');
A.append("<query>");A.append(C.a.If(b));A.append("</query>");A.append("<mediatype>Illustration</mediatype>");A.append("<mediatype>Photo</mediatype>");A.append("<filetype>jpg</filetype>");A.append("<filetype>jpeg</filetype>");A.append("<filetype>gif</filetype>");A.append("<filetype>bmp</filetype>");A.append("<filetype>tif</filetype>");A.append("<filetype>tiff</filetype>");A.append("<filetype>png</filetype>");A.append("</search>");b=y.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let M=
b.length;4>M;M++)b="0"+b;y.AFrameworkApplication.Ge.Xj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",df.a.webServiceBase,b,ui.a.Yap,h.toString()),2,A.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,r,this.onError,null)}}pPo(b){this.H_b(b.assetId,!0,this.Iwj);this.LQ||(this.LQ=[],this.LQ.push(b))}ubi(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;
h.setAttribute("title",b);h.setAttribute("alt",b);uf.a.addHandler(h,"click",this.X4e);uf.a.addHandler(h,"error",this.Daf);return h}lSl(b){1===b.childNodes.length&&(b=b.childNodes[0],uf.a.removeHandler(b,"click",this.X4e),uf.a.removeHandler(b,"error",this.Daf))}xvj(b){const h=this.LQ[b];var r=h.eio;this.F2h();this.s$b=this.u3n;var A=document.createElement("img");A.setAttribute("src",r);if(h.displayName)r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{r=new Sys.StringBuilder;
for(let M=0;M<h.keywords.length&&5>M;M++)M&&r.append(", "),r.append(h.keywords[M]);r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,r.toString())}A.setAttribute("title",r);A.setAttribute("alt",r);uf.a.addHandler(A,"error",this.s$b);this.D6b.appendChild(A);A=document.getElementById("clip"+this.wEb);A.classList.remove("ClipartSelectedImage");A=document.getElementById("clip"+b);A.classList.add("ClipartSelectedImage");this.wEb=b;h.displayName&&(this.pQe.innerText=h.displayName);b=document.createElement("a");
b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');uf.a.addHandler(b,"click",this.WLd);uf.a.addHandler(b,"keydown",this.XLd);this.gib.appendChild(b);this.oQe.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.$Io,h.fileSize);(b=h.f4k)&&h.HQh?(this.QGc.parentNode.style.display="block",this.mQe.innerText=h.HQh,this.QGc.appendChild(b)):this.QGc.parentNode.style.display="none";this.qQe.appendChild(h.Ipo);xd.a.ZT(this.q2a);if(b=h.Kbl)this.q2a.appendChild(b),"a"===
b.nodeName.toLowerCase()&&(uf.a.addHandler(b,"click",this.dDd),uf.a.addHandler(b,"keydown",this.eDd));this.r2a.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)A=h.keywords[b],r=document.createElement("a"),r.innerText=A,r.setAttribute("href",'""'),uf.a.addHandler(r,"click",this.wZe),uf.a.addHandler(r,"keydown",this.xZe),this.r2a.appendChild(r),b<h.keywords.length-1&&(A=document.createElement("span"),A.innerText=", ",this.r2a.appendChild(A));this.rQe.innerText=Box4Intl.Box4Strings.l_ClipartRating;
this.nQe.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.tva(1,!0)}F2h(){this.D6b&&1===this.D6b.childNodes.length&&(this.s$b&&(uf.a.removeHandler(this.D6b.childNodes[0],"error",this.s$b),this.s$b=null),xd.a.ZT(this.D6b));this.q2a&&0<this.q2a.childNodes.length&&"a"===this.q2a.childNodes[0].nodeName.toLowerCase()&&(this.dDd&&uf.a.removeHandler(this.q2a.childNodes[0],"click",this.dDd),this.eDd&&uf.a.removeHandler(this.q2a.childNodes[0],"keydown",this.eDd));this.gib&&0<this.gib.children.length&&
"a"===this.gib.children[0].nodeName.toLowerCase()&&(this.WLd&&uf.a.removeHandler(this.gib.children[0],"click",this.WLd),this.XLd&&uf.a.removeHandler(this.gib.children[0],"keydown",this.XLd),xd.a.ZT(this.gib));if(this.r2a){for(let b=0;b<this.r2a.childNodes.length;b++){const h=this.r2a.childNodes[b];"a"===h.nodeName.toLowerCase()&&(uf.a.removeHandler(h,"click",this.wZe),uf.a.removeHandler(h,"keydown",this.xZe))}xd.a.ZT(this.r2a)}this.pQe.innerText="";this.oQe.innerText="";xd.a.ZT(this.QGc);xd.a.ZT(this.qQe);
xd.a.ZT(this.q2a);this.r2a.innerText="";this.mQe.innerText="";this.rQe.innerText="";this.nQe.innerText=""}nLj(b){if(!(this.Ps.children.length<=b||0>b)){var h=this.Ps.children[b],r=this.Ps.children[0];r=r.clientHeight-r.children[0].clientHeight+2;this.Ps.scrollTop+this.Ps.clientHeight<h.offsetTop+h.clientHeight?this.Ps.scrollTop=h.offsetTop-3*h.clientHeight-r:this.Ps.scrollTop>h.offsetTop&&(this.Ps.scrollTop=h.offsetTop-r/2);this.xvj(b)}}validate(){return!0}H2h(){if(rd.FocusManager.BM()){var b=rd.FocusManager.instance().getRegion(this.pN);
b&&b.Tk.oA(this.PZ)}else this.PZ.focus();for(b=0;b<this.Ps.childNodes.length;b++){const h=this.Ps.childNodes[b];1===h.childNodes.length&&this.lSl(h.childNodes[0])}xd.a.ZT(this.Ps);this.F2h();this.tva(1,!1);this.s4a=new zo.a(Box4Intl.Box4Strings.l_ClipartSearching);this.s4a.v2i=!1;this.Ps.appendChild(this.s4a.element);this.Ps.classList.add("ClipartSearchInProgress")}Dzg(b){this.oGa=b;b=this.Ps.children[this.oGa];rd.FocusManager.BM()?rd.FocusManager.instance().getRegion(this.pN).Tk.oA(b):b.focus()}static get VR(){return lq.Ik=
lq.Ik||$a.a.instance.resolve(822)}}lq.Ik=null;Object(u.a)(lq,"InsertClipartDialog",ug.a,[]);class jr extends Jk{constructor(b,h,r,A,M,ba,oa){super(b,h,r,A,M,ba,oa,!1);this.a3n=Ja=>{if(this.mrn()){var jb=this.Sf.Lj(),zb=jb.xg.lr.toString(),Eb=new Sys.Net.WebRequest;Eb.set_url("ClipArtUpload.ashx");Eb=new Sys.StringBuilder(Eb.getResolvedUrl());this.ZZ(Eb,ui.a.assetId,Ja.assetId,!0);this.ZZ(Eb,uj.a.lcid,y.AFrameworkApplication.lcid.toString());this.ZZ(Eb,uj.a.nodeId,this.pJ?this.pJ.id.toString():this.Sf.id.toString());
this.ZZ(Eb,uj.a.cellId,jb.kl.toString());this.ZZ(Eb,uj.a.fileId,jb.Fq);this.ZZ(Eb,uj.a.jza,zb);this.ZZ(Eb,uj.a.s_,this.Km.toString());Ja=this.Sf.ka(Fe.a.jK,Bm.a.Mu);this.ZZ(Eb,uj.a.jK,Ja.toString());this.ZZ(Eb,uj.a.VAb,"1");jb.fH&&this.ZZ(Eb,uj.a.fH,jb.fH);this.ZZ(Eb,uj.a.classId,this.pJ?this.pJ.properties.wc.toString():this.Sf.wc.toString());this.Lf.hasProperty(Rc.a.imageType)&&this.ZZ(Eb,ui.a.imageType,this.Lf.getValue(Rc.a.imageType).toString());Wm.a.instance.q0k(Eb);y.AFrameworkApplication.Ge.Xj(Eb.toString(),
2,"",{},!1,2,this.JDp,this.z$j,null);Jk.psc++}};this.JDp=Ja=>{if(({group:jb}=Ck.a.N4(Ja.data.Ee)).returnValue){var jb=jb.Responses[0];jb.xxb=Ja.data.rH;jb.Qm=Ja.data.wi?Ja.data.wi[Ud.a.H2]:"";this.ooa(jb)}else this.z$j(null)};this.z$j=()=>{const Ja=new Xm.a;Ja.StatusCode=14;this.ooa(Ja)};new lq(this)}xEa(b){this.cce()&&this.Sf.Lj().xg.jD(this.a3n,null,b)}ZZ(b,h,r,A){b.append(A?"?":"&");b.append(C.a.ej(h));b.append("=");b.append(C.a.ej(r))}MBf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;
case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.MBf(b)}}ooa(b){super.ooa(b);Jk.psc--}}Object(u.a)(jr,"ClipartUploader",Jk,[]);var mc=d(11),wk=d(412);class Ho{constructor(b,h,r){this.dbn=(A,M,ba,oa,Ja)=>{if(!this.Ik||!this.Ik.value)return v.ULS.sendTraceTag(524109267,306,15,"ImageEditor not available"),8;A=this.Ik.value.hka(M);return 2===ba&&A?(new jr(M,me.a.instance,y.AFrameworkApplication.J,Ja,this.In,this.ga,new wk.b),32):1===ba?A&&df.a.A3h?32:8:2};this.Ik=b;this.In=
h;this.ga=r}Wb(){this.ga.fb(ub.a.CSi,mc.a.view,this.dbn,260)}}Object(u.a)(Ho,"ClipArtActor",null,[]);class Zl{constructor(){this.Z=null}get name(){return"Box4.ClipArt"}uc(b){this.Z=b;b.ia(823,()=>new Ho(b.rf(822),b.resolve(50),y.AFrameworkApplication.va)).ha()}init(){this.Z.resolve(823).Wb();const b=qa.StaticActiveAppFrame.za();b&&b.Fe()}dispose(){}}Object(u.a)(Zl,"ClipartPackage",null,[0,1]);class kr{constructor(b){this.Q4a=this.A4a=this.X4a=this.W4a=null;this.Lkh=this.lfh=this.Mkh=this.Vrh=this.vi=
this.wxa=!1;this.z6e=this.Ash=null;this.ksh=0;this.Ga=this.vsh=null;this.Hia=b;this.vQ=3;this.k8b=!0}initialize(b,h,r){this.W4a=this.NNf(b,h);this.X4a=CommonUIStrings.l_SavingStatus;this.A4a=CommonUIStrings.l_ReadOnlyStatus;this.Q4a=CommonUIStrings.l_ReviewModeStatus;this.Hia&&this.Hia.execute(A=>{A.tKb(Object(F.a)(this,this.wtd,"updateToSavingStatus"))});this.vi=!0;this.Ga=r;this.lfh=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}HAb(b,h){this.wxa=
b;this.vQ=h;this.O0a(this.k8b)}O0a(b){!this.k8b&&b&&(this.vsh=new Date);this.k8b=b;this.Lkh=!1;b=null;3===this.vQ&&(b=this.k8b?this.W4a:this.X4a);this.DWl(b)}NNf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}wtd(){this.O0a(!1)}oBm(){switch(this.vQ){case 1:return this.A4a;case 2:return this.Q4a;default:return null}}nBm(){if(3!==this.vQ)switch(this.vQ){case 1:return"ReadOnly";
case 2:return"ReviewOnly";default:return null}return this.Lkh?"FailedToSave":this.k8b?"Saved":"Saving"}Xjn(b){return this.Vrh===this.wxa&&this.ksh===this.vQ&&this.Ash===b}hyf(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.wxa,b,this.oBm(),this.vsh,this.k8b,this.lfh?h.getHeaderSaveStatusIconProps(this.nBm()):null);this.Mkh=!0;return null});this.z6e=null}DWl(b){this.vi&&zg.c()&&!this.Xjn(b)&&(!this.Mkh&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",
!1)?this.hyf(b):Te.a.Tue()?(this.z6e&&v.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.z6e=window.requestIdleCallback(()=>{this.hyf(b)})):window.requestAnimationFrame(()=>{this.hyf(b)}),this.Vrh=this.wxa,this.Ash=b,this.ksh=this.vQ)}}Object(u.a)(kr,"ReactSaveStatusUIHandler",null,[638]);class Io{constructor(b,h){this.Y_=null;this.W4a=CommonUIStrings.l_SavedStatus;this.X4a=CommonUIStrings.l_SavingStatus;this.A4a=CommonUIStrings.l_ReadOnlyStatus;
this.Q4a=CommonUIStrings.l_ReviewModeStatus;this.Xib=h;this.Hia=b;this.vQ=3;this.alb=!0}YE(){this.Hia&&this.Hia.execute(b=>{b.tKb(Object(F.a)(this,this.wtd,"updateToSavingStatus"))});this.Xib.execute(b=>{this.Y_=b})}HAb(b,h){this.vQ=h;3===h?this.O0a(this.alb):2===h?this.OKg(this.Q4a):this.OKg(this.A4a)}wtd(){this.O0a(!1)}O0a(b){this.alb=b;this.OKg(this.alb?this.W4a:this.X4a)}OKg(b){this.Y_&&this.Y_.sendMessage(K.a.Ctp,this.lAl(b))}lAl(b){const h={};h.StatusText=b;return h}}Object(u.a)(Io,"SaveStatusPostMessageHandler",
null,[638]);var Vo=d(1018),Jo=d(174);class eo{constructor(b,h,r,A){this.Q4a=this.A4a=this.X4a=this.W4a=null;this.VFb=0;this.W1=this.E7e=this.KBb=this.IKe=this.Qaf=null;this.Gg=b;this.Sib=h;this.Hia=r;this.Zm=A;this.Noh=!0;this.wxa=!1;this.vQ=3;this.alb=!0}initialize(b,h){if(!this.Gg)return!1;this.W4a=this.NNf(b,h);this.X4a=CommonUIStrings.l_SavingStatus;this.A4a=CommonUIStrings.l_ReadOnlyStatus;this.Q4a=CommonUIStrings.l_ReviewModeStatus;this.YE();return!0}NNf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}YE(){this.Sib&&this.Sib.execute(b=>{b.X2k(Object(F.a)(this,this.abi,"createStatusAndModeElements"));b.E2k(Object(F.a)(this,this.M9o,"showHideSaveStatusElement"));b.wop&&this.abi(null,null)});this.Hia&&this.Hia.execute(b=>{b.tKb(Object(F.a)(this,this.wtd,"updateToSavingStatus"))})}IY(){this.W1&&this.Gg&&this.Gg.QEa(this.W1)}M9o(b,h){this.HAb("true"===h,this.vQ)}HAb(b,h){this.wxa=
b;this.vQ=h;this.IKe&&(this.IKe.style.display=this.wxa||3===this.vQ||!this.Qaf?"none":"");this.KBb&&(this.KBb.style.display=this.wxa||3===this.vQ?"none":"",this.KBb.innerText=1===this.vQ?this.A4a:this.Q4a,this.KBb.title=1===this.vQ?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.E7e&&(this.E7e.style.display=this.wxa||1===this.vQ||!this.Qaf&&!this.KBb?"none":"");this.W1&&(this.W1.style.display=this.wxa||1===this.vQ?"none":"",this.O0a(this.alb),this.W1.title=
CommonUIStrings.l_SaveStatusTooltip)}abi(b,h){b=document.getElementById(Vo.a.I0m);h&&h.XIp||!b||""===this.W4a||""===this.X4a||""===this.A4a||""===this.Q4a||(this.Qaf=document.getElementById(Vo.a.dmf),this.IKe=Vo.a.tYd(b,"BreadcrumbAppModeDash","-"),this.KBb=Vo.a.tYd(b,"BreadcrumbAppModeStatus",1===this.vQ?this.A4a:this.Q4a),this.C7j(this.KBb),this.E7e=Vo.a.tYd(b,"BreadcrumbSaveStatusDash","-"),this.W1=Vo.a.tYd(b,"BreadcrumbSaveStatus",this.W4a),this.C7j(this.W1),this.HAb(this.wxa,this.vQ))}wtd(){this.O0a(!1)}O0a(b){this.alb=
b;this.bCp(this.alb?this.W4a:this.X4a)}bCp(b){!this.W1||3!==this.vQ&&2!==this.vQ||(this.Noh&&!this.alb?(this.VFb=this.W1.offsetWidth<this.VFb?this.VFb:this.W1.offsetWidth,this.zwp(this.X4a),this.Noh=!1):this.W1.innerText=b)}C7j(b){b.style.direction=this.Zm?"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.Zm?"right":"left";b.style.display=this.wxa?"none":"";b.setAttribute("Unselectable","on")}zwp(b){this.W1&&(this.W1.style.width="",this.W1.innerText=b,this.VFb=this.W1.offsetWidth<this.VFb?this.VFb:
this.W1.offsetWidth,b=Jo.a.bC(this.W1),this.W1.style.width=this.VFb-xd.a.OP(b.paddingLeft)-xd.a.OP(b.paddingRight)+1+"px")}}Object(u.a)(eo,"SaveStatusUIHandler",null,[638]);var uc=d(107);class hn{constructor(){this.F7e=this.J5e=this.SSa=this.Z=null;this.nz=()=>{const b=y.AFrameworkApplication.J,h=!!y.AFrameworkApplication.ta.Hb&&4===y.AFrameworkApplication.ta.Hb.Uk;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||
b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))y.AFrameworkApplication.J.$("PostMessageEmbedded")&&y.AFrameworkApplication.W_?(this.F7e=this.Z.resolve(824))&&this.F7e.YE():y.AFrameworkApplication.ta.Hb.x1f||y.AFrameworkApplication.hideHeader||(y.AFrameworkApplication.ta.Hb.KN?(this.J5e=this.Z.resolve(825))&&this.J5e.initialize(b.$("IsSkyDrive"),b.jb("HostNameToIncludeInSavedStatus"),y.AFrameworkApplication.J):(this.SSa=this.Z.resolve(826))&&this.SSa.initialize(b.$("IsSkyDrive"),
b.jb("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}uc(b){this.Z=b;y.AFrameworkApplication.J.$("PostMessageEmbedded")&&y.AFrameworkApplication.W_?this.Z.register(Io,824).as(55).ha().Sd(()=>new Io(this.Z.Ra(800),this.Z.Ra(7))):y.AFrameworkApplication.ta.Hb.x1f||(y.AFrameworkApplication.ta.Hb.KN?this.Z.register(kr,825).as(55).ha().Sd(()=>new kr(this.Z.Ra(800))):this.Z.register(eo,826).as(55).ha().Sd(()=>new eo(uc.EventHandlerManager.instance,this.Z.Ra(694),this.Z.Ra(800),
y.AFrameworkApplication.isRtl)))}init(){y.AFrameworkApplication.J.xp(this.nz)}dispose(){this.SSa&&this.SSa.IY()}}Object(u.a)(hn,"PackageManager",null,[0,1]);var Mn=d(1629);class vm{get name(){return"Common.App.EventsCachePackage"}uc(){}init(){Mn.a.instance.init()}dispose(){}static main(){E.a.instance.Mc(new vm)}}Object(u.a)(vm,"EventsCachePackage",null,[0,1]);var xl=d(124),kk=d(260),Hl=d(1386),al=d(1265),Ng=d(453),Ep=d(1442),nm=d(1408),Mf=d(1375),Cm=d(280),Yg=d(1379);class Uj{constructor(b){this.Unh=
!1;this.qwd=this.qn=null;this.HJe=!1;this.uG=b}get control(){return this.uG}get Ud(){return this.control.Ud}get root(){return this.control.root}get pK(){return this.control.pK}get R5a(){return this.control.R5a}get il(){return this.control.il}get bH(){return this.control.bH}iL(){}initialize(){}oy(b,h,r){this.control.xXl(b,h,r)}An(){Mf.c(this.control.fi.Command)||this.uv(this.control.fi.Command,null,null)}uv(b,h,r){let A=0;this.root&&(A=this.root.Nua(b,h,r));this.control.enabled=0<(A&1);return A}Yfb(){let b=
this.control.visible;this.root.i0a&&(b=this.Ud[Cm.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.Zrc=!0));return b}tMg(){const b=Yg.a.jwa(this.Ud[Cm.a.labelText],this.control.fi.LabelText);this.Kxe(b)}Kxe(b){this.control.labelText!==b&&(this.bH.forEach(h=>{h.Kxe(b)}),this.control.labelText=b,this.root.$bb=!0)}N2b(){const b=Yg.a.jwa(this.Ud[Cm.a.alt],this.control.fi.Alt);this.Fxc(b)}Fxc(b){this.control.tooltip!==b&&(this.bH.forEach(h=>{h.Fxc(b)}),this.control.tooltip=b)}moa(){const b=
Yg.a.jwa(this.Ud[al.a.Image16by16Class],this.control.fi.Image16by16Class),h=Yg.a.jwa(this.Ud[al.a.Image32by32Class],this.control.fi.Image32by32Class);var r=Yg.a.jwa(this.Ud[al.a.Image48by48Class],this.control.fi.Image48by48Class);r=Mf.b(r)?h:r;this.DTc(this.bH.small,b);this.DTc(this.bH.Fs,b);this.DTc(this.bH.VX,h);this.DTc(this.bH.ccp,b);this.DTc(this.bH.nqc,r)}DTc(b,h){!b||Mf.c(b.oU)||Mf.c(h)||b.oU.className===h||(b.oU.className=h)}nyp(b){if(!Mf.b(b)&&this.root.CGg){for(const h of this.control.Xqf){const r=
h.eX===b;r&&(this.control.cef=h);this.control.visible&&(h.BC=r)}this.control.visible&&(this.root.$bb=!0)}}x4k(){if(this.bH.nqc&&this.bH.nqc.rR&&this.bH.nqc.mpb){const b=this.bH.nqc.rR,h=Yg.a.jwa(this.Ud[Ng.a.Description],this.control.fi.Description);Mf.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.il;Object(Za.a)(Ep.a,b)?this.pK.BAb(b):this.root.xMb=this.control;return!1}onBlur(){const b=this.il;this.control.YTb()&&
Yg.a.Px(b.Rc,"cui-ctl-menu-hovered-without-focus");this.root.xMb=null;return!1}mS(b){if(this.control.YTb()){var h=this.pK.Jva;const r=h===this.root.QVb-1;h=r?null:this.root.EE[h+1];this.Kpf(!1);r||this.control===h||Yg.a.Px(h.LUb,nm.MenuLauncher.vdd);this.control.enabled&&this.control.Lv?r?this.control.O0():(Yg.a.rg(this.il.Rc,"cui-ctl-menu-hovered-without-focus"),h.Pka=this.control.Lv):r?this.pK.setFocus(b.yg):(h.Pka=this.pK.Rc,this.pK.fva())}return!1}eM(){this.control.YTb()&&Yg.a.Px(this.il.Rc,"cui-ctl-menu-hovered-without-focus");
return!1}onKeyDown(b){let h=!1;if(!Mf.c(b.Nb)&&!Mf.c(b.Nb.rawEvent)){const r=b.Nb.keyCode;b=b.Nb.rawEvent.shiftKey;r===Sys.UI.Key.enter&&(h=!0);if(Object(Za.a)(Ep.a,this.il)){const A=this.pK;if(!Mf.c(A)){const M=A.Jva,ba=0===this.root.H4,oa=!Mf.c(this.control.Kao);if(r!==Sys.UI.Key.tab&&r!==Sys.UI.Key.left&&r!==Sys.UI.Key.right&&r!==Sys.UI.Key.up&&r!==Sys.UI.Key.down&&r!==Sys.UI.Key.esc)return h;Te.a.fpf();r!==Sys.UI.Key.tab||b?r===Sys.UI.Key.tab&&b?(A.oN(1),h=!0):r===Sys.UI.Key.left&&ba||r===Sys.UI.Key.right&&
!ba?(oa?A.oN(2):0<M&&this.root.d7a(M,!0,!1),h=!0):r===Sys.UI.Key.right&&ba||r===Sys.UI.Key.left&&!ba?(oa&&A.oN(4),h=!0):r===Sys.UI.Key.up?(A.oN(5),h=!0):r===Sys.UI.Key.down?(A.oN(6),h=!0):r===Sys.UI.Key.esc&&(this.root.d7a(M,!0,!1),h=!0):(A.oN(0),h=!0)}}}return h}fA(b){let h=!1;if(!Mf.c(b.Nb)&&!Mf.c(b.Nb.rawEvent)){const r=b.Nb.keyCode;kc.KeyInputManager.HNi(b)||r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||(h=this.PRf(b),h||(this.oy(b.Ef,1,b.Nb),h=!0))}return h}LE(b){this.Jqf();if(this.R5a){let h=
!0;2===b.yg&&(h=b.wga===Sys.UI.MouseButton.leftButton);h&&this.il&&this.IQd(this.il.Rc)}(b.Nb.type.toLowerCase()!==zd.a.KS||this.R5a)&&b.Nb.preventDefault();return!1}get $Xf(){return this.Unh}N0l(){this.Unh=!0}Jqf(){this.$Xf&&this.control.root.Rnb()}XCa(b){Object(Za.a)(Ep.a,this.il)&&!this.R5a&&2===b.yg&&b.wga===Sys.UI.MouseButton.leftButton?(this.oy(b.Ef,b.yg,b.Nb),b=!0):b=this.control.dAa(b);return b}onClick(b){let h=!1;Object(Za.a)(Ep.a,this.il)&&!this.R5a&&3===b.yg&&(this.oy(b.Ef,b.yg,b.Nb),h=
!0);return X.a.Di?!1:h}kwb(b){return this.Sle(b)}YMa(b){this.dAa(b);return!1}Sle(b){return Mf.c(this.qn)?!1:(this.Ryg(Te.a.Yoc(this.rMh,b.clientPoint)),!0)}Rsc(b){let h=!1;this.dAa(b)&&(h=!0);3!==b.yg&&(b=!0,!this.root&&Uj.cdg&&(v.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.G6(),h=!0);return h}Usc(b){return this.dAa(b)}Ssc(b){return this.Sle(b)}Tsc(b){return this.dAa(b)}Psc(b){return 3===b.yg?(this.root.G6(),!0):!1}Qsc(){return!1}get rMh(){!Mf.c(this.qn)&&Mf.c(this.qwd)&&
(this.qwd=Te.a.getElementBounds(this.qn));return this.qwd}Ryg(b){this.HJe!==b&&(this.HJe=b,this.eef(this.HJe))}eef(b){Mf.c(this.qn)||Yg.a.j9(this.qn,Hl.a.LQd,b)}IQd(b){this.control.enabled&&(this.qn=b,this.root.sSc=this.control,this.Ryg(!0),this.root.bka(this.control,!1))}dAa(b){if(!Mf.c(this.qn)){this.Ryg(!1);let h=!!this.root;if(Uj.cdg){const r=kd.ActionManager.qea(parseInt(this.control.fi.Command))||"";v.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,r)}h&&this.root.gfa(this.control,
!1);Mf.c(b)||Te.a.Yoc(this.rMh,b.clientPoint)&&this.oy(this.qn,b.yg,b.Nb);h=!!this.root;Uj.cdg&&v.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.sSc=null);this.qwd=this.qn=null;return!0}return!1}oN(b){return Object(Za.a)(Ep.a,this.il)&&2!==b&&4!==b&&!Te.a.xnc(this.control.Lv)?this.O0():!1}O0(){try{if(this.control.visible){const b=this.control.Lv;if(!Mf.c(b))return b.focus(),!0}}catch(b){}return!1}Kpf(b){const h=this.pK;Mf.c(h)||this.root.d7a(h.Jva+1,b)}tua(){}PRf(){return!1}QR(b){let h=
null;b&&b.rawEvent&&(h={},h[Uj.triggerTime]=b.rawEvent.timeStamp);return h}static get cdg(){null==Uj.K1e&&(Uj.K1e=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Uj.K1e}}Uj.triggerTime="TriggerTime";Uj.K1e=null;Object(u.a)(Uj,"ControlBehavior",null,[651]);var Zm=d(182);class Tk extends Uj{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.fi}iL(b){const h=b.Rn;b=b.eX;Mf.c(h)||(Df.a.instance.nb(zd.a.focus,
h,Object(F.a)(this,this.onFocus,"onFocus")),Df.a.instance.nb(zd.a.blur,h,Object(F.a)(this,this.onBlur,"onBlur")),kk.a.instance.nb(zd.a.iM,h,Object(F.a)(this,this.mS,"onPointerOver")),kk.a.instance.nb(zd.a.zH,h,Object(F.a)(this,this.eM,"onPointerOut")),kc.KeyInputManager.instance.YI(zd.a.kj,h,Object(F.a)(this,this.onKeyDown,"onKeyDown"),b),kc.KeyInputManager.instance.YI(zd.a.rv,h,Object(F.a)(this,this.VI,"onKeyPress"),b),kc.KeyInputManager.instance.YI(zd.a.hi,h,Object(F.a)(this,this.fA,"onKeyUp"),
b),kk.a.instance.nb(zd.a.jt,h,Object(F.a)(this,this.LE,"onPointerDown")),kk.a.instance.nb(zd.a.PP,h,Object(F.a)(this,this.XCa,"onPointerUp")),Nc.a.instance.nb(zd.a.click,h,Object(F.a)(this,this.onClick,"onClick")),Zm.a.instance.nb(zd.a.JS,h,Object(F.a)(this,this.kwb,"onTouchMove")),Zm.a.instance.nb(zd.a.xM,h,Object(F.a)(this,this.YMa,"onTouchEnd")))}oy(b,h,r){this.control.enabled&&(b=null,this.il&&this.il.X9c()&&this.pK&&(b=this.root.EE[this.pK.Jva])&&!this.$Xf&&(b.w_a(this.button),b=null),this.executeCommand(this.control.fi.Command,
h,!0,r),b&&b.w_a(this.button))}executeCommand(b,h,r,A){if(!Mf.c(b)){const M=this.Ud;M.CommandValueId=this.button.GPb();M.MenuItemId=this.button.fi.MenuItemId;M.SourceControlId=this.control.id;this.root.executeCommand(b,M,this.il,h,r,null,this.QR(A))}}An(){Mf.c(this.control.fi.Command)||0<(this.uv(this.properties.Command,this.properties.QueryCommand,this.Ud)&2)&&this.Yfb()&&this.M0a()}M0a(){this.tMg();this.N2b();this.moa()}onFocus(b){super.onFocus(b);this.sFg();return!1}onBlur(b){super.onBlur(b);this.KAf();
return!1}onKeyDown(b){let h=super.onKeyDown(b);Mf.c(b.Nb)||this.cCg(b.zq,b.Nb.keyCode)&&(h=!1);return h}VI(b){let h=!1;Mf.c(b.Nb)||Mf.c(b.Nb.rawEvent)||(this.cCg(b.zq,b.Nb.rawEvent.keyCode)?(this.oy(b.Ef,b.yg,b.Nb),h=!0):b.Nb.preventDefault());return h}cCg(b,h){if(X.a.Mt&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}fA(b){let h=!1;Mf.c(b.Nb)||this.cCg(b.zq,b.Nb.keyCode)||(h=super.fA(b));return h}sFg(){this.control.enabled&&
this.executeCommand(this.properties.CommandPreview,0,!1,null)}KAf(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(u.a)(Tk,"ButtonBehavior",Uj,[]);var Wo=d(1569);class fo{}fo.Color="Color";fo.IndexColorSelected="ColorSelected";Object(u.a)(fo,"ColorPickerCommandProperties",null,[]);var Vn=d(1573);class po extends Uj{constructor(b){super(b);this.DPc=this.Ew=-1}get aMb(){return this.control}get mUa(){return this.aMb.hwl.mUa}get properties(){return this.aMb.fi}oy(b,
h,r){if(this.control.enabled){const A=this.Ud;A.Color=po.K7d(b)[Wo.ColorPicker.BWd];b=null;Yg.a.Ys(this.properties.Stateful)&&this.il&&this.il.X9c()&&this.pK&&(b=this.root.EE[this.pK.Jva]);this.root.executeCommand(this.properties.Command,A,this.il,h,!0,null,this.QR(r));b&&b.w_a(this.aMb)}}An(){var b=this.Ud;b.SourceControlId=this.properties.Id;if(0<(this.uv(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,fo.IndexColorSelected in this.Ud&&(b=this.Ud[fo.IndexColorSelected]),b!==this.DPc)){const h=
this.mUa;0<=b&&b<h.length&&this.T6j(h[b],!0);0<=this.DPc&&this.DPc<h.length&&this.T6j(h[this.DPc],!1);this.DPc=b}}T6j(b,h){h?Yg.a.rg(b,"cui-colorpicker-selected"):Yg.a.Px(b,"cui-colorpicker-selected")}iL(b){for(let h=0;h<b.Ddf.length;++h){const r=b.Ddf[h];Df.a.instance.nb(zd.a.focus,r,Object(F.a)(this,this.weg,"onCellFocus"));Df.a.instance.nb(zd.a.blur,r,Object(F.a)(this,this.jYn,"onCellBlur"));kc.KeyInputManager.instance.nb(zd.a.kj,r,Object(F.a)(this,this.onKeyDown,"onKeyDown"));kc.KeyInputManager.instance.nb(zd.a.hi,
r,Object(F.a)(this,this.fA,"onKeyUp"));Nc.a.instance.nb(zd.a.click,r,Object(F.a)(this,this.kYn,"onCellClick"));kk.a.instance.nb(zd.a.PP,r,Object(F.a)(this,this.yeg,"onCellPointerUp"));kk.a.instance.nb(zd.a.iM,r,Object(F.a)(this,this.xeg,"onCellPointerOver"));kk.a.instance.nb(zd.a.jt,r,Object(F.a)(this,this.lYn,"onCellPointerDown"))}}weg(b){b=po.K7d(b.Ef);this.pK.BAb(this.il);this.TEe(b,!0);return!0}jYn(b){this.TEe(po.K7d(b.Ef),!1);return!0}TEe(b,h){h?(this.Ew=parseInt(b.getAttribute("arrayPosition")),
Yg.a.rg(b,"cui-colorpicker-hoveredOver"),this.sFg(b)):(this.Ew=-1,this.KAf(b),Yg.a.Px(b,"cui-colorpicker-hoveredOver"))}kYn(b){3===b.yg&&this.oy(b.Ef,b.yg,b.Nb);return!0}yeg(b){3!==b.yg&&this.oy(b.Ef,b.yg,b.Nb);return!0}xeg(b){this.Kpf(!1);b=parseInt(po.K7d(b.Ef).getAttribute("arrayPosition"));this.Nnd(b);return!0}lYn(){return!1}sFg(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!Mf.b(h)){const r=this.Ud;r.Color=b[Wo.ColorPicker.BWd];this.root.executeCommand(h,r,this.il,0,!1)}}}KAf(b){if(this.control.enabled){const h=
this.properties.CommandRevert;if(!Mf.b(h)){const r=this.Ud;r.Color=b[Wo.ColorPicker.BWd];this.root.executeCommand(h,r,this.il,0,!1)}}}oN(b){b=Vn.a.MEf(this.Ew,this.aMb.width,this.mUa.length,b);if(b!==this.Ew&&this.Nnd(b))return!0;this.TEe(this.mUa[this.Ew],!1);return!1}O0(){return this.Nnd(0)}Nnd(b){return this.mUa&&this.mUa.length>b&&(b=this.mUa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}tua(){-1!==this.Ew&&this.TEe(this.mUa[this.Ew],!1)}static K7d(b){return po.$Bm(b)}static $Bm(b){var h=["td"];
const r=h.length;if(!b)return null;for(var A=0;A<r;A++)if(b.tagName.toLowerCase()===h[A].toLowerCase())return b;for(b=b.parentNode;b;){for(A=0;A<r;A++)if(b.tagName.toLowerCase()===h[A].toLowerCase())return b;b=b.parentNode}return null}}Object(u.a)(po,"ColorPickerBehavior",Uj,[]);var Rp=d(342),dq=d(375),Rl=d(1689),yl=d(694),fj=d(1848),Fp=d(1675);class Sl{constructor(b,h){this.SQk=b;this.Enh=h}sxe(b,h,r,A){if(Mf.c(b)||Mf.c(h))return null;const M=new Fp.a;const ba=A.x,oa=A.y,Ja=A.width;var jb=A.height;
let zb;Sl.Wgc(h,"flyoutWidth");A=Sl.Wgc(h,"flyoutRealHeight");const Eb=Sl.Wgc(h,"viewportWidth"),Sb=Sl.Wgc(h,"viewportHeight"),nc=Sl.Wgc(h,"viewableLeft"),Dc=Sl.Wgc(h,"viewableTop"),Zc=this.SQk;let Gd=!1,de=!1;const he=1===r,fe=4===r,Yd=this.Enh;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";zb=this.Ddj(b);M.jbk=Sb;M.xOg=Eb;if(he)Zc?h=ba+Ja:(h=ba-zb,M.yub=!0),jb=oa;else{var Td="";Ja>zb&&(zb=Ja,Td=(zb-2*fj.a.Hje).toString());Zc?h=ba:(h=ba+Ja-zb,M.yub=!0);
jb=oa+jb;""!==Td&&(b.style.minWidth=Td+"px")}Yd&&(jb+=Dc,h+=nc);b.style.top=jb+"px";b.style.left=h+"px";let wf=Td=!1;zb<=Eb?h+zb>nc+Eb?(he&&Zc&&ba-zb>nc||fe&&ba-zb>nc?(h=ba-zb,Yd&&(h+=nc),wf=M.yub=!0):(h=nc+Eb-zb,Gd=!0),Td=!0):h<nc&&(he&&!Zc&&ba+Ja+zb<nc+Eb?(h=ba+Ja,Yd&&(h+=nc),M.yub=!1,wf=!0):(h=nc,de=!0,M.yub=!0),Td=!0):Zc?(h=nc,Td=!0,M.yub=!0):(h=nc+Eb-zb,Td=!0,M.yub=!1);Td&&(b.style.left=h+"px");M.Wic=jb;if(!(jb+A<=Dc+Sb)||3===r){M.M3f=!0;const {KSn:Lf,ocm:ii,Jln:Bi,$sn:Ml}=this.kEf(r,jb,A,oa,
Dc,Sb);jb!==Lf&&(b.style.top=Lf+"px",M.Wic=Lf);-1<ii&&(b.style.maxHeight=ii+"px");Bi&&(b.style.bottom="0px",b.style.height="auto");Ml&&this.rKn(b,Zc,he,wf,de,Gd,Eb,ba,Ja)}M.r1c=h;M.IEf=zb;M.EEf=A;return M}kEf(b,h,r,A,M,ba){let oa,Ja,jb;oa=-1;jb=Ja=!1;const zb=h,Eb=M+ba-h;h=A-r;const Sb=this.Enh;let nc=!1;0>h&&(h=M);Sb||(A-=M);r<=A&&1!==b||(4===b||1===b?r<ba?(h=ba-r,Ja=!0):(h=M,nc=jb=Ja=!0):(A<Eb&&3!==b?(h=zb,Ja=!0):oa=A,jb=!0));Sb&&(Ja=!1,nc?oa=ba:h+=M);return{KSn:h,ocm:oa,Jln:Ja,$sn:jb}}rKn(b,h,
r,A,M,ba,oa,Ja,jb){b.style.overflowY="scroll";b.style.width="auto";if(h){if(ba||A)b.style.left="",b.style.right=(ba?0:oa-Ja)+"px"}else M||A||(b.style.left="",b.style.right=(r?oa-Ja:oa-Ja-jb)+"px")}$qm(b){const h={};if(Mf.c(b))return h;h.viewportWidth=xd.a.zrb();h.viewportHeight=xd.a.tX();Mf.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);Mf.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=
document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;Mf.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);Mf.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*fj.a.Hje:b.scrollHeight;const r=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.Ddj(b);b.style.overflowY=
r;return h}Ddj(b){return b.offsetWidth}static Wgc(b,h){return Mf.c(b)?0:b[h]}}Object(u.a)(Sl,"MenuPositioner",null,[]);var Gp=d(2001),th=d(1499),Vq=d(1678),tt=d(1676),fp=d(1673),Dk=d(1674),Nn=d(1681),Em=d(1432),Om=d(1565);class Il extends Uj{constructor(b){super(b);this.H0e=0;this.Qrh=null;this.a4e=-1;this.uAd=null;this.slg=this.skh=!1;this.yVk=()=>{this.Ig&&this.Ig.Rc&&(document.body.appendChild(this.LVh),this.Cfo())};this.thf=h=>{h.element&&(h.element.style.filter="",h.element.style.opacity="",
this.Ig&&this.Ig.Rc===h.element&&Object(Za.a)(fp.a,this.Ig)&&dq.a.t6k(this.Zui()))};this.CFk=new Sl(0===this.root.H4,Yg.a.Ys(this.root.properties.DivSyndicated))}get Vdj(){return this.CFk}get Tv(){return this.control}get properties(){return this.control.fi}get Ig(){return this.Tv.Ig}set Ig(b){this.Tv.Ig=b}get NN(){return this.Tv.NN}set NN(b){this.Tv.NN=b}get LVh(){Mf.c(this.uAd)&&(this.uAd=Il.Atf());return this.uAd}get JTj(){let b=!this.root.KUf;Object(Za.a)(410,this.root)&&1===this.root.QVb&&(b=
!0);return b}oy(b,h){Object(Za.a)(410,this.root)&&this.root.aBf();this.Tv.B3(h)}B3(b){if(this.Tv.enabled&&!this.NN){var h=Wg.a.instance.wq(La.a.B3);h.properties.add("Id",this.Tv.fi.Id);h.properties.add("InputMethod",Rp.a[b]);h.end();db.a.mark(10326);Te.a.Fje(this.Tv.fi.Id,"MenuOpen");this.Tv.Lv&&(this.Tv.Pka=Te.a.tqb(this.Tv.Lv.ownerDocument));this.H0e=b;this.buj(b);this.Iwe();this.Tv.Pfb(this.Tv.Lv,!0)}}Iwe(){Mf.c(this.properties.PopulateAsyncTriggerCommand)||this.skh||(this.CUn(),this.skh=!0)}CUn(){const b=
{};b[Rl.a.Callback]=Object(F.a)(this,this.EAj,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.il,0,!1)}EAj(){this.Tv.SZa()}SZa(){this.NN&&this.buj(this.H0e,!0)}buj(b,h=!1){var r=!0;if(Yg.a.Ys(this.properties.PopulateDynamically)){r=!1;const A=this.uhd(b);A!==this.Qrh&&(r=this.Ilg(A,h));r=r||!this.NN}r&&(h=y.AFrameworkApplication.ta.$r,r=null,h&&(r=h.Xf("LoadResource","Menu Initialization")),this.Vfa(b),r&&r.stop(),this.ene())}Vfa(b){if(!Mf.c(this.Ig)){if(this.Tv.Scb){var h=
this.Tv.il;if(h&&h.keytip){var r=h.keytip.key.toLocaleLowerCase();this.Ig.uZo(String.format("{0} {1}",this.Tv.Scb,h.keytip.dAf),this.Tv.sZa&&""!==this.Tv.sZa?String.format("{0}-{1}",this.Tv.sZa,r):r)}}this.Ig.isa();Yg.a.rg(this.Ig.Rc,this.Tv.ihf);Yg.a.j9(this.Ig.Rc,"cui-touch",3===b||this.root.CDe);if(this.Ig.hasItems()){this.Ig.iL();h=this.il;h.yki();h.T6c=!0;h.Wf(this.Ig);h.T6c=!1;this.Ig.Vtj();r=Object(Za.a)(Om.a,this.root);var A=null,M=!1;r&&(A=this.root,M=A.Ceb,A.Ceb=!1);var ba=this.Ig.Rc;ba.style.visibility=
"hidden";ba.style.position="absolute";ba.style.top="0px";ba.style.left="0px";X.a.Mt&&!X.a.vtb&&(ba.style.maxHeight="100px",ba.style.overflowY="scroll");document.body.appendChild(ba);this.A4k();this.Hfo(ba);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.xVk();Yg.a.rg(this.Tv.LUb,nm.MenuLauncher.vdd);var oa=this.root.QVb;this.i5o&&this.root.bka(this.control,!0);ba.style.zIndex=String(y.AFrameworkApplication.ta.Mya);this.root.GYk(this.Tv);this.Ig.Jva=oa;ba.style.visibility="visible";oa=this.Zui();
if(Object(Za.a)(Dk.a,this.Ig)){ba.style.position="fixed";const Ja=this.root.EE[0];Ja&&Ja.Ig&&Ja.Ig.Rc?100!==Te.a.i4c(this.root.EE[0].Ig.Rc)&&dq.a.HDg(ba,oa,this.thf):dq.a.HDg(ba,oa,this.thf)}else dq.a.HDg(ba,oa,this.thf);this.NN=!0;this.Ig.L3f=!0;!X.a.Di&&this.Tv.kRo&&this.Ig.setFocus(b);r&&(A.Ceb=M);r=this.properties.CommandMenuOpen;Mf.b(r)||this.root.executeCommand(r,null,h,b,!1)}}db.a.mark(10327)}ene(){}xVk(){this.a4e=Yg.a.JLb(this.a4e);this.a4e=window.setTimeout(this.yVk,50)}Cfo(){const b=this.LVh;
var h=this.Ig.Rc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let r=h.offsetWidth;h=h.offsetHeight;X.a.vtb&&(r-=4,h-=4);b.style.width=r.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get i5o(){return this.root.QVb?!1:!0}Zui(){const b=this.Ig.children,h=[];if(Object(Za.a)(fp.a,this.Ig))for(let r=0;r<b.count;r++){const A=b.K(r);Array.add(h,A.separator);
for(let M=0;M<A.children.count;M++){const ba=A.children.K(M);Array.add(h,ba.Rc)}}return h}A4k(){var b=this.Ig.children;for(let r=0;r<b.count;r++){const A=b.K(r).children;for(let M=0;M<A.count;M++){var h=A.K(M);if(Object(Za.a)(Ep.a,h)){const ba=h;if("Menu32"===ba.eX||"Menu48"===ba.eX)h=h.control,h.behavior&&(Object(Za.a)(th.a,h)||Object(Za.a)(tt.a,h))&&h.behavior.x4k()}}}0<b.count&&(b=b.K(0),Mf.c(b.separator)||(b.separator.style.display="none"),Mf.c(b.eDe)||Yg.a.rg(b.eDe,"cui-menusection-titleAtTop"))}Hfo(b){if(!Mf.c(b)){b.style.top=
"0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var h=yl.a.create();try{const r=this.Vdj.$qm(b),A=this.O3c();let M=this.root.sxe(b,r,this.Tv.Ije,A);M||(M=this.Vdj.sxe(b,r,this.Tv.Ije,A));this.root.Wdj=M}finally{h&&h.dispose()}}}O3c(){const b=Te.a.getElementBounds(this.Tv.LUb);var h=this.pK;Mf.c(h)||Mf.c(h.Rc)||(h=Te.a.getElementBounds(h.Rc),b.x=h.x+fj.a.Hje,b.width=h.width-2*fj.a.Hje);Object(Za.a)(Em.a,this.Tv.the)&&(b.height=0);return b}Bza(){if(this.Tv.NN){v.ULS.sendTraceTag(6688860,
207,50,"Menu closing {0}",{["Id"]:this.Tv.fi.Id});this.Ig.tua();this.fDj();this.NN=!1;this.Ig.L3f=!1;this.root.gfa(this.control,!0);this.JTj?y.AFrameworkApplication.ta.Sld(this.Tv.Pka,this.H0e):this.JJo();this.Tv.Pka=null;var b=this.Tv.LUb;Yg.a.Px(b,nm.MenuLauncher.vdd);this.Tv.Pfb(this.Tv.Lv,!1);Yg.a.Px(b,"cui-ctl-menu-hovered-without-focus");this.Ig.fva();Mf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.il,0,!1);this.eDj()}}JJo(){const b=
this.Tv.Pka;if(b)try{b.focus()}catch(h){}}eDj(){xd.a.Fy(this.Ig.Rc);xd.a.Fy(this.uAd);Yg.a.QEa(this.Ig.Rc)}uhd(b){if(this.slg&&Yg.a.Ys(this.properties.PopulateOnlyOnce)||Mf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Tv.fIf();return 0<(this.root.Nua(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}Ilg(b,h=!1){if(this.slg&&Yg.a.Ys(this.properties.PopulateOnlyOnce))return!0;let r=null;this.Qrh=b;Mf.c(b)||
(r=this.LIl(b));Mf.c(r)||(this.slg=!0);if(h){this.root.ctl(this.Tv);if(Mf.c(r)||!r.hasItems())return this.Bza(),!1;this.fDj();this.eDj()}this.vYo(r);return!0}Vkj(){}LIl(b){b=Gp.a.n8h(b);if(!Mf.c(b)){const h=new Nn.a;h.I3h=!0;h.parentId=this.control.id;let r;r=Object(Za.a)(Vq.a,this.control);return this.root.ZQ.F6a(b,h,r)}return null}vYo(b){Mf.c(b)||(Mf.c(this.Ig)||this.Ig.dispose(),this.Ig=b,this.Vkj())}fDj(){const b=this.Ig.parent;b?(b.T6c=!0,b.removeChild(this.Ig.id),b.T6c=!1):v.ULS.sendTraceTag(572330335,
207,10,"Parent not found for the Menu component {0}",this.Ig.id)}onKeyDown(b){let h=!1;Mf.c(b.Nb)||Mf.c(b.Nb.rawEvent)||Object(Za.a)(Ep.a,this.il)||!b.Nb.rawEvent.altKey||b.Nb.keyCode!==Sys.UI.Key.down||(this.oy(b.Ef,1,b.Nb),h=!0);h||(h=super.onKeyDown(b));return h}LE(b){this.Jqf();2===b.yg&&b.wga!==Sys.UI.MouseButton.leftButton||this.oy(b.Ef,b.yg,b.Nb);b.Nb.preventDefault();return!1}PRf(b){if(!this.pK||!this.pK.inKeytipMode||!this.Tv.bmj)return!1;this.Tv.bmj(this.il,b);return!0}static Atf(){const b=
Yg.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(u.a)(Il,"MenuLauncherBehavior",Uj,[663,651]);var Fm=d(1679);class Gn extends Il{constructor(b){super(b)}get mu(){return this.ZZc.properties}get ZZc(){return this.control}get bVa(){return this.ZZc.bVa}iL(){kk.a.instance.nb(zd.a.jt,this.bVa.Rn,Object(F.a)(this,this.LE,"onPointerDown"));kc.KeyInputManager.instance.nb(zd.a.kj,this.bVa.Rn,Object(F.a)(this,this.onKeyDown,"onKeyDown"));
kc.KeyInputManager.instance.nb(zd.a.hi,this.bVa.Rn,Object(F.a)(this,this.fA,"onKeyUp"))}An(){const b=this.Ud[Fm.a.SelectedItemId];if(0<(this.uv(this.mu.Command,this.mu.QueryCommand,this.Ud)&2)){const h=this.Ud[Fm.a.SelectedItemId];Mf.c(h)||b===h||this.ZZc.Zmd(h)||(this.Ud[Fm.a.SelectedItemId]=null)}}}Object(u.a)(Gn,"DropDownBehavior",Il,[]);var ka=d(613),Va=d(1463);class yb extends Gn{constructor(b){super(b);this.A2a=null;this.n1e=this.LEb=this.JGa=!1;this.LNc=null;this.JNc=-1;this.jgg=h=>{let r=
!1;if(2!==h.yg||h.wga===Sys.UI.MouseButton.leftButton)this.oy(h.Ef,h.yg,h.Nb),this.Xwe(),r=!0;r&&h.Nb.preventDefault();return!1};this.N0n=h=>{let r=!1;if(!Mf.c(h.Nb)&&!Mf.c(h.Nb.rawEvent)){const A=h.Nb.keyCode;h=h.Nb.rawEvent.shiftKey;Yg.a.Ys(this.LJ.AutoComplete);if(A===Sys.UI.Key.enter)this.WW(),this.pvg(),Object(Za.a)(Va.Ribbon,this.root)&&this.root.L2(),r=!0;else if(A===Sys.UI.Key.tab){if(this.WW(),this.pvg(),Object(Za.a)(Va.Ribbon,this.root)&&(r=this.root.ZGe(this.il.Rc,!h)),Object(Za.a)(410,
this.root))return!0}else A===Sys.UI.Key.backspace||A===Sys.UI.Key.del?this.control.enabled?(this.Onf(),this.LNc=null):r=!0:A===Sys.UI.Key.esc?(this.tvg(),this.pvg(),Object(Za.a)(Va.Ribbon,this.root)&&this.root.L2(),r=!0):A===Sys.UI.Key.down&&(this.B3(1),this.Xwe(),r=!0)}return r};this.O0n=h=>{if(!this.control.enabled)return!0;!Mf.c(h.Nb)&&h.Nb.charCode&&this.vQl();return!1};this.Mfg=()=>this.JGa?!1:this.JGa=!0}get H6(){return this.control}get bU(){return this.H6.bU}get LJ(){return this.H6.LJ}get gee(){return this.Ud[ka.a.IsFreeForm]}set gee(b){this.Ud[ka.a.IsFreeForm]=
b}iL(b){kk.a.instance.nb(zd.a.jt,b.Rn,Object(F.a)(this,this.LE,"onPointerDown"));const h=b.zs;Df.a.instance.nb(zd.a.focus,h,Object(F.a)(this,this.Yvb,"onInputFocus"));Df.a.instance.nb(zd.a.blur,h,Object(F.a)(this,this.TCa,"onInputBlur"));kc.KeyInputManager.instance.nb(zd.a.kj,h,this.N0n);kc.KeyInputManager.instance.nb(zd.a.rv,h,this.O0n);ee.a.instance.nb(zd.a.xga,h,this.Mfg);kk.a.instance.nb(zd.a.jt,h,Object(F.a)(this,this.Q0n,"onInputPointerDown"));kk.a.instance.nb(zd.a.jt,b.Yii,this.jgg)}An(){0<
(this.uv(this.LJ.Command,this.LJ.QueryCommand,this.Ud)&2)&&(this.LEb||this.m$j(),this.Ryp())}Vkj(){this.H6.menuItems=null;var b;var h=b=null;if(!Mf.c(this.Ig)){this.Xwe();for(const A of this.Ig.children)for(const M of A.children)if(Object(Za.a)(Ep.a,M)){var r=M;r=r.control;Object(Za.a)(652,r)&&(b=r,b=b.fi.MenuItemId);Object(Za.a)(644,r)&&(h=r,h=h.b$a());Mf.c(b)||Mf.c(h)||(this.H6.menuItems[h]=b,b=h=null)}}}Q0n(b){Object(Za.a)(410,this.root)&&2===b.yg&&(this.A2a=Te.a.tqb(this.control.Lv.ownerDocument),
this.control.Lv.focus());return!1}LE(b){this.Jqf();let h=!1;3===b.yg&&(h=super.LE(b),this.Xwe());h&&b.Nb.preventDefault();return!1}x4l(){this.JNc=-1;const b=this.bU.zs,h=b.value,r=this.Ntm(h);if(r){b.value=r.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const A=b.createTextRange();A.moveStart("character",h.length);A.moveEnd("character",b.value.length);A.select()}this.LNc=r.value}else this.LNc=null}Ntm(b){const h=this.H6.menuItems;for(const r in h){const A=
{key:r,value:h[r]};if(A.key.toLowerCase().startsWith(b.toLowerCase()))return A}return null}vQl(){Yg.a.Ys(this.LJ.AutoComplete)&&-1===this.JNc&&(this.n1e&&(this.uhd(0),this.n1e=!1),this.JNc=window.setTimeout(Object(F.a)(this,this.x4l,"executeAutoComplete"),this.H6.Tbl))}Onf(){Yg.a.Ys(this.LJ.AutoComplete)&&(this.JNc=Yg.a.JLb(this.JNc))}Yvb(b){if(this.NN)return this.Ig.setFocus(0),!0;Object(Za.a)(410,this.root)&&(rd.FocusManager.instance().aF("ribbon"),this.root.k6c=!1);this.onFocus(b);this.LEb=!0;
Yg.a.rg(this.bU.Rn,"cui-cb-focus");Yg.a.Ys(this.LJ.PopulateDynamically)&&(this.n1e=!0);Te.a.Vmd(this.bU.zs);Mf.c(this.Ig)||this.Ig.Bn();return this.JGa=!1}TCa(){this.LEb=!1;this.WW();Yg.a.Px(this.bU.Rn,"cui-cb-focus");return!1}pvg(){Object(Za.a)(410,this.root)&&(void 0!==this.A2a&&null!==this.A2a&&y.AFrameworkApplication.ta.Sld(this.A2a,2),this.A2a=null)}WW(){if(this.control.enabled){this.Onf();var b=this.bU.zs;if(void 0===this.Ud[ka.a.Value]||null===this.Ud[ka.a.Value]||b.value!==this.Ud[ka.a.Value].toString())if(this.H6.Zmd(this.LNc))this.gee=
!1,this.Ud[ka.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.H6.gnd.GPb(),["MenuItemId"]:this.H6.gnd.fi.MenuItemId},this.root.executeCommand(this.LJ.Command,b,this.il,0,!1);else{if(!Yg.a.Ys(this.LJ.AutoComplete)){var h=this.H6.menuItems[b.value];if(!Mf.b(h)&&this.H6.Zmd(h)){this.gee=!1;this.Ud[ka.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.H6.gnd.GPb(),["MenuItemId"]:h};this.root.executeCommand(this.LJ.Command,b,this.il,0,!1);return}}h=!Mf.b(b.value)&&""!==C.a.IDa(b.value);
this.H6.qRh&&h?(this.gee=!0,this.Ud[ka.a.Value]=b.value,this.root.executeCommand(this.LJ.Command,{["IsFreeForm"]:!0,["Value"]:b.value},this.il,0,!1)):this.tvg()}}else this.tvg()}tvg(){this.Onf();this.LNc=null;this.m$j()}m$j(){const b=this.Ud[ka.a.Value]||"";b!==this.bU.zs.value&&(this.bU.zs.value=b);this.H6.Zmd(this.H6.menuItems[b])}Ryp(){const b=this.Ud[ka.a.FontStyle]||"normal";b!==this.bU.zs.style.fontStyle&&(this.bU.zs.style.fontStyle=b)}Xwe(){this.control.Lv&&this.Ig&&this.control.Lv.setAttribute(Pe.a.AUh,
this.Ig.id)}}Object(u.a)(yb,"ComboBoxBehavior",Gn,[]);class Yb extends Il{constructor(b){super(b)}get IXd(){return this.control}O3c(){let b=0;this.Ig&&this.Ig.Rc&&2===this.Ig.horizontalAlignment&&(b=this.Ig.Rc.clientWidth);return new Sys.UI.Bounds(this.IXd.x-b,this.IXd.y,this.IXd.O3f,this.IXd.N3f)}}Object(u.a)(Yb,"ContextMenuLauncherBehavior",Il,[]);class oc extends Il{constructor(b){super(b)}get A_d(){return this.control}O3c(){return new Sys.UI.Bounds(this.A_d.x,this.A_d.y,this.A_d.O3f,this.A_d.N3f)}}
Object(u.a)(oc,"DialogMenuLauncherBehavior",Il,[]);var Vc=d(1257);class yd extends Il{constructor(b){super(b);this.q1e=!1;this.sOk=!Yg.a.ama(this.mu.ShouldRefreshWhenDropped)}get eKa(){return this.control}get mu(){return this.control.fi}iL(b){b=b.Rn;Mf.c(b)||(Df.a.instance.nb(zd.a.focus,b,Object(F.a)(this,this.onFocus,"onFocus")),Df.a.instance.nb(zd.a.blur,b,Object(F.a)(this,this.onBlur,"onBlur")),kk.a.instance.nb(zd.a.iM,b,Object(F.a)(this,this.mS,"onPointerOver")),kc.KeyInputManager.instance.nb(zd.a.kj,
b,Object(F.a)(this,this.onKeyDown,"onKeyDown")),kc.KeyInputManager.instance.nb(zd.a.hi,b,Object(F.a)(this,this.fA,"onKeyUp")),kk.a.instance.nb(zd.a.jt,b,Object(F.a)(this,this.LE,"onPointerDown")))}An(){Mf.c(this.control.fi.Command)||(this.eKa.NN&&!this.sOk?this.q1e=!0:(0<(this.uv(this.mu.Command,this.mu.QueryCommand,this.Ud)&2)&&this.Yfb()&&this.M0a(),Yg.a.Ys(this.mu.RefreshableMenu)&&this.NN&&this.Ig.reo()))}M0a(){this.Oyp();this.moa();this.Dzp();this.eKa.uUf=this.Ud[Vc.a.ImageIsVisible]}Oyp(){const b=
Yg.a.jwa(this.Ud[Vc.a.LabelText],this.mu.LabelText),h=this.Ud[Vc.a.LabelTextUserGeneratedPlaceholderReplacements];if(this.control.labelText!==b||this.mu.LabelTextUserGeneratedPlaceholderReplacements!==h)this.bH.Fs&&this.Pyp(this.bH.Fs.rR,b,h),this.root.$bb=!0,this.control.labelText=b,this.mu.LabelTextUserGeneratedPlaceholderReplacements=h}Pyp(b,h,r){const A=b.lastChild;Yg.a.MNj(b,h+" ",r);h=Mf.c(A);v.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",
h?"":A.nodeType.toString());h||b.appendChild(A)}Dzp(){const b=this.Ud[Vc.a.ImageBackColor];this.bH.forEach(h=>{yd.H8k(h.oU,b)})}B3(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&y.AFrameworkApplication.va.Ob(La.a.D_d,2);"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||y.AFrameworkApplication.va.Ob(La.a.D_d,2);Object(Za.a)(Ep.a,this.il)&&(this.NN||this.Kpf(!0),this.control.enabled&&this.O0());
super.B3(b)}Bza(){super.Bza();this.q1e&&(this.q1e=!1,this.An())}mS(b){return this.control.YTb()?(this.eKa.NN?(this.root.O_h(),Yg.a.rg(this.eKa.LUb,nm.MenuLauncher.vdd),this.eKa.Pka=this.control.Lv):(super.mS(b),this.oy(b.Ef,b.yg,b.Nb)),!1):super.mS(b)}onKeyDown(b){let h=!1;if(!Mf.c(b.Nb)&&!Mf.c(b.Nb.rawEvent)){if(Object(Za.a)(Ep.a,this.il)){const r=b.Nb.rawEvent,A=b.Nb.keyCode,M=0===this.root.H4;r.shiftKey||r.ctrlKey||!(A===Sys.UI.Key.right&&M||A===Sys.UI.Key.left&&!M)||(h=this.PRf(b),h||(this.oy(b.Ef,
1,b.Nb),h=!0))}h||(h=super.onKeyDown(b))}return h}static H8k(b,h){Mf.c(b)||Mf.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(u.a)(yd,"FlyoutAnchorBehavior",Il,[]);var Jd=d(1260);class Pd extends Uj{constructor(b){super(b)}get sjc(){return this.control}get properties(){return this.sjc.properties}get qka(){return this.sjc.qka}iL(b){b=b.fOb;Df.a.instance.nb(zd.a.focus,b,Object(F.a)(this,this.onFocus,"onFocus"));Df.a.instance.nb(zd.a.blur,b,Object(F.a)(this,this.onBlur,"onBlur"));
kk.a.instance.nb(zd.a.iM,b,Object(F.a)(this,this.mS,"onPointerOver"));kk.a.instance.nb(zd.a.zH,b,Object(F.a)(this,this.eM,"onPointerOut"));kc.KeyInputManager.instance.nb(zd.a.kj,b,Object(F.a)(this,this.onKeyDown,"onKeyDown"));kc.KeyInputManager.instance.nb(zd.a.hi,b,Object(F.a)(this,this.fA,"onKeyUp"));kk.a.instance.nb(zd.a.jt,b,Object(F.a)(this,this.LE,"onPointerDown"));kk.a.instance.nb(zd.a.PP,b,Object(F.a)(this,this.XCa,"onPointerUp"));Zm.a.instance.nb(zd.a.JS,b,Object(F.a)(this,this.kwb,"onTouchMove"));
Zm.a.instance.nb(zd.a.xM,b,Object(F.a)(this,this.YMa,"onTouchEnd"))}An(){const b=this.Ud[Jd.a.On],h=this.Ud[Jd.a.IsRtl];this.P9j();if(0<(this.uv(this.properties.Command,this.properties.QueryCommand,this.Ud)&2)){var r=!Mf.c(this.Ud[Jd.a.InnerHTML])||!Mf.c(this.properties.InnerHTML),A=!Mf.c(this.properties.Image);r||A||(this.control.enabled=!1);A=this.qka.fOb;if(!Mf.c(A)){if(r){r=Yg.a.jwa(this.Ud[Jd.a.InnerHTML],this.properties.InnerHTML);if(null===A.innerHTML||null===r||C.a.xh(A.innerHTML)!==C.a.xh(r))A.innerHTML=
r;""===r&&(this.control.enabled=!1)}r=A.title;const M=Yg.a.jwa(this.Ud[Jd.a.Alt],this.properties.Alt);M===r||this.control.mCg||(A.title=M)}A=this.Ud[Jd.a.IsRtl];b===this.Ud[Jd.a.On]&&h===A||this.control.iXb()}}P9j(){const b=this.Ud;b[Jd.a.CommandValueId]=this.control.GPb();b.MenuItemId=this.control.fi.MenuItemId;b.SourceControlId=this.properties.Id}oy(b,h,r){if((b=this.il)&&this.control.enabled){const A=this.root;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ExcelBorderMenuCompactionEnabled")&&
b.X9c()&&this.pK){const M=A.EE[this.pK.Jva];M?M.w_a(this.sjc):v.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.P9j();this.Ud[Jd.a.On]||(this.Ud[Jd.a.On]=!0,this.control.iXb());"Menu"===b.eX&&Yg.a.Px(this.qka.Rn,"cui-gallerybutton-focused");A.executeCommand(this.properties.Command,this.Ud,b,h,!0,null,this.QR(r))}}onFocus(b){super.onFocus(b);Yg.a.rg(this.qka.Rn,"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);
Yg.a.Px(this.qka.Rn,"cui-gallerybutton-focused");return!1}}Object(u.a)(Pd,"GalleryButtonBehavior",Uj,[]);var Qe=d(1682),Cf=d(1273),Wf=d(2107);class gg extends Uj{constructor(b){super(b);this.T3a=-1}get gnc(){return this.control}get properties(){return this.gnc.fi}get mWc(){return this.gnc.mWc}get MTf(){var b=null;if(this.il&&(b=this.il.parent,!Object(Za.a)(Wf.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get pSb(){return this.gnc.fce.pSb}get qgd(){return this.gnc.fce.qgd}oy(b,
h,r){if(this.control.enabled){b=this.PKf(this.Kjc(b));const A=this.t5d(b);this.mWc[Cf.a.Rows]=this.P8d(b)+1;this.mWc[Cf.a.Columns]=A+1;this.root.executeCommand(this.properties.Command,this.mWc,this.il,h,!0,null,this.QR(r))}}iL(b){var h=b.Rn;const r=b.D0h;b=b.cells;kk.a.instance.nb(zd.a.zH,h,Object(F.a)(this,this.jZn,"onControlPointerOut"));Zm.a.instance.nb(zd.a.JS,h,Object(F.a)(this,this.lZn,"onControlTouchMove"));Zm.a.instance.nb(zd.a.xM,h,Object(F.a)(this,this.kZn,"onControlTouchEnd"));for(h=0;h<
b.length;++h)this.pbl(r[h],b[h])}pbl(b,h){Df.a.instance.nb(zd.a.focus,b,Object(F.a)(this,this.weg,"onCellFocus"));kk.a.instance.nb(zd.a.iM,h,Object(F.a)(this,this.xeg,"onCellPointerOver"));kk.a.instance.nb(zd.a.PP,h,Object(F.a)(this,this.yeg,"onCellPointerUp"));kc.KeyInputManager.instance.nb(zd.a.kj,h,Object(F.a)(this,this.onKeyDown,"onKeyDown"));kc.KeyInputManager.instance.nb(zd.a.hi,h,Object(F.a)(this,this.fA,"onKeyUp"));Zm.a.instance.nb(zd.a.KS,h,Object(F.a)(this,this.mYn,"onCellTouchStart"))}PKf(b){return parseInt(b.id.substr(this.gnc.id.length+
1))}vMi(b){this.uMi(this.PKf(b))}P8d(b){return Math.floor(b/Qe.a.wed)}t5d(b){return b%Qe.a.wed}uMi(b){if(b!==this.T3a){var h=this.t5d(b),r=this.P8d(b),A=-1;let M=-1;-1!==this.T3a&&(A=this.P8d(this.T3a),M=this.t5d(this.T3a));for(;A!==r||M!==h;)A<r?this.XPj(++A,M,!0):A>r?(this.XPj(A,M,!1),A--):M<h?this.yNj(++M,A,!0):M>h&&(this.yNj(M,A,!1),M--);this.MTf?this.MTf.LQj(this.Hui(r+1,h+1)):(r=(h=this.control.Xqf)&&0<h.length?h[0]:null,A=this.il,v.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!r,["FirstCompPar"]:!!r&&!!r.parent,["DispComp"]:!!A,["DispCompPar"]:!!A&&!!A.parent}));this.T3a=b}}XPj(b,h,r){for(let A=0;A<=h;A++)this.pNj(b,A,r)}yNj(b,h,r){for(let A=0;A<=h;A++)this.pNj(A,b,r)}pNj(b,h,r){h=b*Qe.a.wed+h;b=this.pSb[h];h=this.qgd[h];r?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}yeg(b){this.oy(b.Ef,b.yg,b.Nb);return!0}Kjc(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return Mf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}MQj(b){const h=this.PKf(b);b.childNodes[0].childNodes[0].title=this.Hui(this.P8d(h)+1,this.t5d(h)+1)}Hui(b,h){let r=this.properties.Alt;Mf.c(r)&&(r=this.properties.MenuSectionTitle);return r=String.format(r,h.toString(),b.toString())}Rvc(){if(this.il){for(var b=0;b<Qe.a.msc;b++)this.pSb[b].className="cui-it-inactiveCell",this.qgd[b].className="cui-it-inactiveCellOuter";this.T3a=-1;b=this.properties.MenuSectionInitialTitle;
Mf.c(b)&&(b="");this.MTf.LQj(b)}}xeg(b){this.control.enabled&&(b=this.Kjc(b.Ef),this.Nnd(b),this.Eyf(b));return!1}Eyf(b){this.MQj(b);this.vMi(b)}weg(b){if(!this.control.enabled)return!1;b=this.Kjc(b.Ef);this.MQj(b);this.vMi(b);return!1}jZn(b){Te.a.g0f(this.gnc.fce.Rn,b.clientPoint)||this.Rvc();return!1}mYn(b){if(!this.control.enabled)return!1;b=this.Kjc(b.Ef);this.Eyf(b);return!0}lZn(b){if(!this.control.enabled)return!1;b=Te.a.h6d(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.Kjc(b))?this.Eyf(b):this.Rvc();return!0}kZn(b){if(!this.control.enabled)return!1;var h=Te.a.h6d(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.Rvc(),!0;(h=this.Kjc(h))?this.oy(h,3,b.Nb):this.Rvc();return!0}oN(b){b=Vn.a.MEf(this.T3a,Qe.a.wed,Qe.a.msc,b);if(b!==this.T3a)return this.pSb[b].firstChild.focus(),this.uMi(b),!0;this.Rvc();this.T3a=-1;return!1}O0(){const b=this.pSb[0];if(Mf.c(b))return!1;b.firstChild.focus();return!0}Nnd(b){if(Mf.c(b))return!1;b.firstChild.firstChild.focus();
return!0}tua(){this.Rvc()}}Object(u.a)(gg,"InsertTableBehavior",Uj,[]);class Jg extends Il{constructor(b){super(b)}An(){this.control.enabled=!!this.Ig}oy(b,h,r){y.AFrameworkApplication.va.Pb(La.a.aYa,2,h,this.QR(r))}}Object(u.a)(Jg,"JewelMenuLauncherBehavior",Il,[]);var Lh=d(1266);class Qj extends Uj{constructor(b){super(b)}get properties(){return this.control.fi}An(){0<(this.uv(this.properties.Command,this.properties.QueryCommand,this.Ud)&2)&&this.Yfb()&&this.M0a()}M0a(){this.WCp();this.moa();this.N2b()}WCp(){const b=
this.control.labelText;let h=this.Ud[Lh.a.Value];Mf.c(h)&&(h=this.properties.LabelText,Mf.c(h)&&(h=""));h!==b&&this.Kxe(h)}iL(b){b=b.Rn;Mf.c(b)||(kk.a.instance.nb(zd.a.jt,b,Object(F.a)(this,this.LE,"onPointerDown")),kk.a.instance.nb(zd.a.iM,b,Object(F.a)(this,this.mS,"onPointerOver")),kk.a.instance.nb(zd.a.zH,b,Object(F.a)(this,this.eM,"onPointerOut")))}}Object(u.a)(Qj,"LabelBehavior",Uj,[]);var Uk=d(1518),gj=d(1403),Vj=d(1677);class om extends Il{constructor(b){super(b);this.IVe=this.mNe=!1;this.W7b=
this.m4b=null;if(this.y8b=y.AFrameworkApplication.J.$("TellMeRedesignIsEnabled"))this.m4b=this.wv.vna.LightImage16by16Class,this.W7b=this.wv.vna.DarkImage16by16Class}get wv(){return this.control}sle(b,h,r,A){h&&(this.wv.Pka=r,y.AFrameworkApplication.ta.pyb());if(Object(Za.a)(gj.a,b)&&A){r=new Uk.a;r.CommandLocation=this.root.rca;r.InvocationMethod=0;const M={};(b=b.control)&&b.fi&&(M.CommandId=b.fi.Command,M.ControlId=b.fi.Id,M.CloseAllMenus=h,b.pK&&b.pK.parent&&b.pK.parent.id&&(M.ParentControlId=
b.pK.parent.id.split("-")[0]),this.root.EH&&this.root.EH.oVa(A,M,r))}}Bza(){this.wv.Pka||(this.wv.Pka=this.wv.Zz);!this.wv.nQn&&this.y8b&&(Yg.a.Px(this.wv.Zz,"cui-sb-focus"),Yg.a.Px(this.wv.M4,"cui-sb-focus"),Yg.a.Px(this.wv.ZDa,this.m4b),Yg.a.rg(this.wv.ZDa,this.W7b));this.mNe=!0;super.Bza();this.mNe=!1;this.Opg()}get JTj(){return!this.wv.BZa}ene(){this.wv.ene()}Zse(){this.IVe||this.mNe||(this.IVe=!0,this.wv.raiseEvent(Vj.a.Z$a,null))}Opg(){this.NN||this.wv.PVf||(this.IVe=!1,this.wv.raiseEvent(Vj.a.LSb,
null))}Kfg(b){Yg.a.Px(this.wv.Zz,"cui-sb-focus");Yg.a.Px(this.wv.M4,"cui-sb-focus");this.y8b&&!this.wv.NN&&(Yg.a.Px(this.wv.ZDa,this.m4b),Yg.a.rg(this.wv.ZDa,this.W7b));this.wv.raiseEvent(Vj.a.blur,b);this.Opg();this.wv.Pka=this.wv.Zz;return!1}Lfg(b){Yg.a.rg(this.wv.Zz,"cui-sb-focus");Yg.a.rg(this.wv.M4,"cui-sb-focus");this.y8b&&(Yg.a.Px(this.wv.ZDa,this.W7b),Yg.a.rg(this.wv.ZDa,this.m4b));this.wv.raiseEvent(Vj.a.focus,b);this.Zse();return!1}lhg(){this.y8b&&(Yg.a.rg(this.wv.M4,"cui-sb-hover"),Yg.a.rg(this.wv.Zz,
"cui-sb-hover"),Yg.a.Px(this.wv.ZDa,this.W7b),Yg.a.rg(this.wv.ZDa,this.m4b));return!1}khg(){this.y8b&&(Yg.a.Px(this.wv.M4,"cui-sb-hover"),Yg.a.Px(this.wv.Zz,"cui-sb-hover"),this.wv.NN||this.wv.PVf||(Yg.a.Px(this.wv.ZDa,this.m4b),Yg.a.rg(this.wv.ZDa,this.W7b)));return!1}}Object(u.a)(om,"SearchBoxBehavior",Il,[658,651]);class Hj{}Hj.Value="value";Hj.MinValue="MinValue";Hj.MaxValue="MaxValue";Hj.Text="Text";Object(u.a)(Hj,"SliderCommandProperties",null,[]);class pn extends Uj{constructor(b){super(b);
this.Dga=()=>{this.myl(this.Q8.zs.value);return!0}}get xEg(){return this.control}get Q8(){return this.xEg.Q8}get properties(){return this.control.fi}initialize(){}oy(){}iL(b){b=b.zs;Df.a.instance.nb(zd.a.focus,b,Object(F.a)(this,this.onFocus,"onFocus"));Df.a.instance.nb(zd.a.blur,b,Object(F.a)(this,this.onBlur,"onBlur"));Df.a.instance.nb(zd.a.mVc,b,this.Dga);Df.a.instance.nb(zd.a.input,b,this.Dga)}onFocus(b){this.Q8.Rn&&Sys.UI.DomElement.addCssClass(this.Q8.Rn,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.Q8.Rn&&
Sys.UI.DomElement.removeCssClass(this.Q8.Rn,"cui-sldr-onfocus");return super.onBlur(b)}myl(b){this.Ud[Hj.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Ud,this.il,0,!1)}An(){const b=this.Ud[Hj.Value],h=this.Ud[Hj.MaxValue],r=this.Ud[Hj.Text];var A=this.uv(this.properties.Command,this.properties.QueryCommand,this.Ud);this.Q8&&this.Q8.zs&&(this.Q8.zs.disabled=!this.control.enabled);if(0<(A&2)){A=this.Ud[Hj.Value];const M=this.Ud[Hj.MaxValue],ba=this.Ud[Hj.Text];(M!==h||A!==
b||r!==ba)&&this.Q8&&this.Q8.zs&&(this.Q8.zs.setAttribute(Pe.a.ZSd,String.format("{0}",M)),this.Q8.zs.setAttribute("max",String.format("{0}",M)),this.Q8.zs.value=A,this.Q8.rR.innerText=this.Ud[Hj.Text])}}}Object(u.a)(pn,"SliderBehavior",Uj,[]);var ki=d(1264);class Wq extends Uj{constructor(b){super(b);this.UHd=0;this.Plb=null;this.pFd=!1;this.lKh=null;this.D9e=!1;this.VKd=this.rJd=-1;this.JGa=!1;this.VI=()=>!this.control.enabled;this.Dga=()=>{this.WW();return!1};this.Mfg=()=>this.JGa?!1:this.JGa=
!0;this.Cjj=h=>{var r=!1;let A=!0;2===h.yg&&(A=h.wga===Sys.UI.MouseButton.leftButton);A&&(r=h.Ef,this.rYj(r===this.bJ.Phc||r===this.bJ.iji||r===this.bJ.hji,h.yg),r=!0);return r};this.Djj=h=>this.dAa(h);this.FFo=()=>{this.P_h();-1===this.VKd&&(this.GAe(),this.VKd=window.setInterval(Object(F.a)(this,this.GAe,"spin"),50))}}get g1b(){return this.control}get bJ(){return this.g1b.bJ}get properties(){return this.control.fi}initialize(){const b=this.g1b.YNg;this.lKh=this.Fup(b);this.UHd=b[0].min;this.Plb=
b[0];this.pFd=!1}oy(){}iL(b){const h=b.zs,r=b.Phc;b=b.k_c;Df.a.instance.nb(zd.a.focus,h,Object(F.a)(this,this.onFocus,"onFocus"));Df.a.instance.nb(zd.a.blur,h,Object(F.a)(this,this.onBlur,"onBlur"));kc.KeyInputManager.instance.nb(zd.a.kj,h,Object(F.a)(this,this.onKeyDown,"onKeyDown"));kc.KeyInputManager.instance.nb(zd.a.rv,h,this.VI);kc.KeyInputManager.instance.nb(zd.a.hi,h,Object(F.a)(this,this.fA,"onKeyUp"));Df.a.instance.nb(zd.a.mVc,h,this.Dga);ee.a.instance.nb(zd.a.xga,h,this.Mfg);kk.a.instance.nb(zd.a.jt,
r,this.Cjj);kk.a.instance.nb(zd.a.jt,b,this.Cjj);kk.a.instance.nb(zd.a.PP,r,this.Djj);kk.a.instance.nb(zd.a.PP,b,this.Djj);Zm.a.instance.nb(zd.a.JS,r,Object(F.a)(this,this.Fjj,"onArrowTouchMove"));Zm.a.instance.nb(zd.a.JS,b,Object(F.a)(this,this.Fjj,"onArrowTouchMove"));Zm.a.instance.nb(zd.a.xM,r,Object(F.a)(this,this.Ejj,"onArrowTouchEnd"));Zm.a.instance.nb(zd.a.xM,b,Object(F.a)(this,this.Ejj,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);Yg.a.rg(this.bJ.Rn,"cui-spn-focus");this.control.enabled&&
Te.a.Vmd(this.bJ.zs);return this.JGa=!1}onBlur(b){super.onBlur(b);Yg.a.Px(this.bJ.Rn,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!Mf.c(b.Nb)&&!Mf.c(b.Nb.rawEvent)){const r=b.Nb.keyCode,A=b.Nb.rawEvent.shiftKey;if(r===Sys.UI.Key.up||r===Sys.UI.Key.down)this.root.vYf(this.control)||this.rYj(r===Sys.UI.Key.up,b.yg),h=!0;else if(r===Sys.UI.Key.enter)this.WW(),Object(Za.a)(Va.Ribbon,this.root)&&this.root.L2(),h=!0;else if(r===Sys.UI.Key.tab)this.WW(),Object(Za.a)(Va.Ribbon,this.root)&&(h=this.root.ZGe(this.il.Rc,
!A));else if(r===Sys.UI.Key.esc)this.Tvc(),Object(Za.a)(Va.Ribbon,this.root)&&this.root.L2(),h=!0;else if(r===Sys.UI.Key.backspace||r===Sys.UI.Key.del)h=!this.control.enabled}return h}fA(){this.GOl();return!1}Fjj(b){return this.Sle(b)}Ejj(b){return this.dAa(b)}z6m(b){if(this.control.enabled){var h=!1;if(!this.pFd){var r=this.oxm(b);r=b?r+this.Plb.step:r-this.Plb.step;r=Math.min(r,this.Plb.max);r=Math.max(r,this.Plb.min);r!==this.UHd&&(this.Iqf(r,this.Plb),this.root.executeCommand(this.properties.Command,
this.Ud,this.il,0,!1),h=!0)}h||(h=this.properties.SpinCommand,r=this.Ud,r.Increment=b,Mf.c(h)||this.root.executeCommand(h,r,this.il,0,!1))}}oxm(b){const h=Math.pow(10,y.AFrameworkApplication.numberFormat.Ble),r=Math.round(this.Plb.step*h);let A=Math.round(this.UHd*h)/r;A=b?Math.floor(A):Math.ceil(A);return A*r/h}rYj(b,h){if(this.control.enabled){this.WW();const r=b?this.bJ.Phc:this.bJ.k_c;switch(h){case 2:case 3:this.D9e=b;this.IQd(r);break;case 1:this.D9e=b,this.XUk(r)}}}XYj(){this.P_h();this.qnl()}aei(){-1===
this.rJd&&(this.rJd=window.setTimeout(this.FFo,500))}P_h(){this.rJd=Yg.a.JLb(this.rJd)}qnl(){this.VKd=Yg.a.mnl(this.VKd)}GAe(){this.z6m(this.D9e)}XUk(b){this.root.bka(this.control,!1);Yg.a.rg(b,Hl.a.LQd);this.GAe();this.aei()}GOl(){this.root.gfa(this.control,!1);this.XYj();Yg.a.Px(this.bJ.Phc,Hl.a.LQd);Yg.a.Px(this.bJ.k_c,Hl.a.LQd)}qxc(b){this.bJ.zs.value!==b&&(this.bJ.zs.value=b)}Tvc(){this.qxc(this.Ud[ki.a.Text])}PNj(b){this.qxc(b);this.Ud[ki.a.Text]=b;this.pFd=!0}WUo(b,h,r){this.qxc(r);this.Ud[ki.a.Text]=
r;this.Ud[ki.a.Number]=b;this.Ud[ki.a.UnitType]=h.type;this.UHd=b;this.Plb=h;this.bJ.zs.setAttribute(Pe.a.Ejf,r);this.bJ.zs.setAttribute(Pe.a.HUh,String.format("{0}",h.min));this.bJ.zs.setAttribute(Pe.a.ZSd,String.format("{0}",h.max));this.pFd=!1}v5h(b){var h;if(({bUn:h}=this.dun(b)).returnValue)this.PNj(h);else{({number:b,Lfb:h}=C.a.msj(b,this.lKh,y.AFrameworkApplication.numberFormat));let r=this.EEe(h);0===h&&Mf.c(r)&&(r=this.EEe(this.Ud[ki.a.UnitType]));this.Iqf(b,r)}}Iqf(b,h){b=this.Dcg(b,h);
if(isNaN(b)||Mf.c(h))this.Tvc();else{const r=y.AFrameworkApplication.numberFormat;let A;A=C.a.lKa(b,h.type,r);A=A.replace(6===h.type?r.Cle:r.Hkg,"");this.WUo(b,h,A)}}dun(b){let h,r=!1;h="";b=b.trim();const A=this.g1b.vak;if(!Mf.c(A))for(let M=0;M<A.length;M++)if(A[M].toLowerCase()===b.toLowerCase()){h=A[M];r=!0;break}return{returnValue:r,bUn:h}}Dcg(b,h){return isNaN(b)||Mf.c(h)?Number.NaN:h.Dcg(b)}EEe(b){let h=null;const r=this.g1b.YNg;for(let A=0;A<r.length;A++)if(r[A].type===b){h=r[A];break}return h}Fup(b){const h=
b.length,r=Array(h);for(let A=0;A<h;A++)r[A]=b[A].type;return r}WW(){if(this.control.enabled){const b=this.Ud[ki.a.Text],h=this.bJ.zs.value;h!==b&&(this.v5h(h),this.Ud[ki.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Ud,this.il,0,!1))}else this.Tvc()}An(){var b=this.Ud[ki.a.Text],h=this.Ud[ki.a.Number];const r=this.Ud[ki.a.UnitType],A=this.Ud[ki.a.MaxValue];if(0<(this.uv(this.properties.Command,this.properties.QueryCommand,this.Ud)&2)){const M=this.Ud[ki.a.Text],ba=this.Ud[ki.a.Number],
oa=this.Ud[ki.a.UnitType],Ja=this.Ud[ki.a.MaxValue];Ja!==A&&(this.EEe(oa).max=Ja,this.bJ.zs.setAttribute(Pe.a.ZSd,String.format("{0}",Ja)));M!==b?""===M?this.PNj(M):this.v5h(M):isNaN(ba)||ba===h&&oa===r||this.Iqf(ba,this.EEe(oa));b=this.bJ.Rn.title;h=Yg.a.jwa(this.Ud[ki.a.Alt],this.properties.Alt);h!==b&&(this.bJ.zs.title=h,this.bJ.Phc.title=h,this.bJ.k_c.title=h)}}eef(b){super.eef(b);b?(this.GAe(),this.aei()):this.XYj()}}Object(u.a)(Wq,"SpinnerBehavior",Uj,[656,651]);var gp=d(418),wm=d(1165);class si extends Il{constructor(b){super(b);
this.x9b=!0;this.cCb=!1}get U8(){return this.control}get mu(){return this.U8.properties}iL(b){const h=b.Rn,r=b.lpb;b=b.m_c;Df.a.instance.nb(zd.a.focus,h,Object(F.a)(this,this.onFocus,"onFocus"));Df.a.instance.nb(zd.a.blur,h,Object(F.a)(this,this.onBlur,"onBlur"));kc.KeyInputManager.instance.nb(zd.a.kj,h,Object(F.a)(this,this.onKeyDown,"onKeyDown"));kc.KeyInputManager.instance.nb(zd.a.hi,h,Object(F.a)(this,this.fA,"onKeyUp"));X.a.hu&&16>this.Mrm()&&(kk.a.instance.nb(zd.a.jt,h,Object(F.a)(this,this.Ioj,
"onSplitbuttonPointerDownPointerUp")),kk.a.instance.nb(zd.a.PP,h,Object(F.a)(this,this.Ioj,"onSplitbuttonPointerDownPointerUp")));kk.a.instance.nb(zd.a.iM,r,Object(F.a)(this,this.XXn,"onButtonPointerOver"));kk.a.instance.nb(zd.a.zH,r,Object(F.a)(this,this.WXn,"onButtonPointerOut"));kk.a.instance.nb(zd.a.jt,r,Object(F.a)(this,this.Ujj,"onButtonPointerDown"));kk.a.instance.nb(zd.a.PP,r,Object(F.a)(this,this.Vjj,"onButtonPointerUp"));Zm.a.instance.nb(zd.a.JS,r,Object(F.a)(this,this.ZXn,"onButtonTouchMove"));
Zm.a.instance.nb(zd.a.xM,r,Object(F.a)(this,this.YXn,"onButtonTouchEnd"));kk.a.instance.nb(zd.a.jt,b,Object(F.a)(this,this.jgg,"onMenuButtonPointerDown"));kk.a.instance.nb(zd.a.iM,b,Object(F.a)(this,this.K1n,"onMenuButtonPointerOver"));kk.a.instance.nb(zd.a.zH,b,Object(F.a)(this,this.J1n,"onMenuButtonPointerOut"))}oy(b,h,r){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.cCb&&(this.U8.on=!this.U8.on,b=this.Ud,b.CommandValueId=this.control.GPb(),this.root.executeCommand(this.mu.Command,b,this.il,
h,!0,null,this.QR(r))):this.x9b&&super.oy(b,h,r)}fA(b){const h=b.Nb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Ud,b.CommandValueId=this.control.GPb(),this.root.executeCommand(this.mu.Command,b,this.il,1,!0),!0):super.fA(b)}An(){const b=this.root.Nua(this.mu.Command,this.mu.QueryCommand,this.Ud),h=0<(b&1);let r=!0;r=Mf.c(this.mu.CommandMenuOpen)?h:0<(this.root.Nua(this.mu.CommandMenuOpen,null,null)&1);if(r!==this.x9b||h!==this.cCb||(r||h)!==this.control.enabled)this.control.enabled=
r||h,h!==this.cCb&&this.g_n(h),r!==this.x9b&&this.h_n(r),this.x9b=r,this.cCb=h;if(0<(b&2)){this.moa();const A=Yg.a.jwa(this.Ud[wm.a.LabelText],this.mu.LabelText);this.Ud[wm.a.ApplyLabelTextToControlOnly]?this.U8.cjc(M=>{M.Rn.title=A;M.lpb.removeAttribute("title");M.m_c.removeAttribute("title")}):this.U8.cjc(M=>{M.lpb.title=A});this.Ud[wm.a.EnsureControlRoleIsButton]&&this.U8.cjc(M=>{Pe.a.Is(M.Rn,Pe.a.Sh,Pe.a.X$)});Mf.c(this.Ud[wm.a.Visible])||this.Yfb()&&this.M0a()}this.U8.setState(this.U8.on&&h)}M0a(){this.tMg();
this.N2b();this.moa()}h_n(b){this.U8.cjc(h=>{Yg.a.oyb(h.m_c,b)});this.Dkd();this.x9b=b}g_n(b){this.U8.cjc(h=>{Yg.a.oyb(h.lpb,b)});this.Dkd();this.cCb=b}Dkd(){const b=this.U8.Sqb();Mf.c(b)||(Yg.a.Px(b.childNodes[0],"cui-ctl-split-hovered-primary"),Yg.a.Px(b.childNodes[0],"cui-ctl-split-hovered-secondary"),Yg.a.Px(b.childNodes[1],"cui-ctl-split-hovered-primary"),Yg.a.Px(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}Ioj(b){if(0!==gp.a(b.Nb))return!1;let h=!1;b.eventName===zd.a.jt?h=this.Ujj(b):
b.eventName===zd.a.PP&&(h=this.Vjj(b));return h}Ujj(b){let h=!1;const r=b.yg;switch(r){case 3:this.b8o()?this.oy(this.il.Rc,r,b.Nb):this.IQd(this.U8.Ugi);h=!0;break;case 2:b.wga===Sys.UI.MouseButton.leftButton&&(this.IQd(this.U8.Ugi),h=!0)}h&&b.Nb.preventDefault();return!1}b8o(){const b=this.il.eX;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}Vjj(b){return this.dAa(b)}ZXn(b){return this.Sle(b)}YXn(b){return this.dAa(b)}onFocus(b){super.onFocus(b);this.wTf(!0,!0);return!1}onBlur(b){super.onFocus(b);
this.Dkd();return!1}XXn(){this.control.enabled&&this.cCb&&this.wTf(!0,this.U8.on);return!1}WXn(){this.control.enabled&&this.cCb&&this.Dkd();return!1}jgg(b){let h=!1;if(2!==b.yg||b.wga===Sys.UI.MouseButton.leftButton)this.oy(b.Ef,b.yg,b.Nb),h=!0;h&&b.Nb.preventDefault();return!1}K1n(){this.control.enabled&&this.x9b&&this.wTf(this.U8.on,!0);return!1}J1n(){this.Dkd();return!1}wTf(b,h){const r=this.control.Sqb();Mf.c(r)||(Yg.a.rg(r.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),
Yg.a.rg(r.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}Mrm(){var b=X.a.Chc;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(u.a)(si,"SplitButtonBehavior",Il,[]);var sl=d(1272);class tl extends Uj{constructor(b){super(b);this.LEb=this.JGa=!1;this.Fvk=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ExcelTableRenameEnabled");this.VI=()=>!this.control.enabled;this.Dga=()=>{this.WW();return!1};this.QYa=()=>this.Xha.isEditable?this.JGa?!1:
this.JGa=!0:(Te.a.Vmd(this.Xha.zs),!0)}get srd(){return this.control}get Xha(){return this.srd.Xha}get PHg(){return this.srd.fi}iL(b){b=b.zs;Df.a.instance.nb(zd.a.focus,b,Object(F.a)(this,this.onFocus,"onFocus"));Df.a.instance.nb(zd.a.blur,b,Object(F.a)(this,this.onBlur,"onBlur"));kc.KeyInputManager.instance.nb(zd.a.kj,b,Object(F.a)(this,this.onKeyDown,"onKeyDown"));kc.KeyInputManager.instance.nb(zd.a.rv,b,this.VI);kc.KeyInputManager.instance.nb(zd.a.hi,b,Object(F.a)(this,this.fA,"onKeyUp"));Df.a.instance.nb(zd.a.mVc,
b,this.Dga);ee.a.instance.nb(zd.a.xga,b,this.QYa)}onFocus(b){super.onFocus(b);this.LEb=!0;Yg.a.rg(this.Xha.Rn,"cui-tb-focus");this.control.enabled&&Te.a.Vmd(this.Xha.zs);return this.JGa=!1}onBlur(b){this.LEb=!1;super.onBlur(b);Yg.a.Px(this.Xha.Rn,"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!Mf.c(b.Nb)&&!Mf.c(b.Nb.rawEvent)){const r=b.Nb.keyCode,A=b.Nb.rawEvent.shiftKey;r===Sys.UI.Key.tab?(this.WW(),Object(Za.a)(Va.Ribbon,this.root)&&(h=this.root.ZGe(this.il.Rc,!A))):r===Sys.UI.Key.enter?
this.Fvk&&(this.WW(),Object(Za.a)(Va.Ribbon,this.root)&&this.root.L2(),h=!0):r===Sys.UI.Key.esc?(this.Tvc(),Object(Za.a)(Va.Ribbon,this.root)&&this.root.L2(),h=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?h=!this.control.enabled:b.Cza&&(uf.a.M_h(b.Nb),h=!1)}return h}fA(){return!1}qxc(b){this.Xha.zs.value!==b&&(this.Xha.zs.value=b)}Tvc(){this.qxc(this.Ud[sl.a.Text])}WW(){if(this.control.enabled&&this.Xha.isEditable){const b=this.Xha.zs.value;b!==this.Ud[sl.a.Text]&&(this.Ud[sl.a.Text]=b,this.root.executeCommand(this.PHg.Command,
this.Ud,this.il,0,!1))}else this.Tvc()}An(){const b=this.Ud[sl.a.Text];if(0<(this.uv(this.PHg.Command,this.PHg.QueryCommand,this.Ud)&2)&&!this.LEb){const h=this.Ud[sl.a.Text];h!==b&&this.qxc(h)}}}Object(u.a)(tl,"TextBoxBehavior",Uj,[650,651]);var Gm=d(1847);class go extends Uj{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.fi}oy(b,h,r){this.control.enabled&&(Yg.a.ama(this.properties.TogglesWhenExecuted)||this.toggle(),this.Ud.CommandValueId=this.toggleButton.GPb(),
this.Ud.MenuItemId=this.toggleButton.fi.MenuItemId,this.Ud.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Ud,this.il,h,!Yg.a.ama(this.properties.CloseMenuWhenExecuted),A=>{Yg.a.Ys(this.properties.UpdateHtmlPostToggle)&&(32===A?this.b2j():this.$1j())},this.QR(r)))}$1j(){this.Ud[Ng.a.On]=!this.Ud[Ng.a.On]}b2j(){this.toggleButton.setState(this.Ud[Ng.a.On]);(this.toggleButton.XEa&&this.toggleButton.NFe||Yg.a.Ys(this.properties.UpdateHtmlPostToggle))&&this.M0a()}toggle(){this.$1j();
Yg.a.Ys(this.properties.UpdateHtmlPostToggle)||this.b2j()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!Mf.c(b.Nb)&&this.pK){const r=b.Nb.keyCode;r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||b.Nb.preventDefault()}return h}An(){Mf.c(this.properties.MenuItemId)||(this.Ud.MenuItemId=this.properties.MenuItemId);0<(this.uv(this.properties.Command,this.properties.QueryCommand,this.Ud)&2)&&this.Yfb()&&this.M0a()}M0a(){this.toggleButton.setState(this.Ud[Ng.a.On]);this.nyp(Yg.a.jwa(this.Ud[Ng.a.DisplayMode],
""));this.tMg();this.moa();this.aAp();Ng.a.Alt in this.Ud&&this.N2b()}aAp(){const b=this.bH.nqc;if(b&&b.mpb){var h=Yg.a.jwa(this.Ud[Ng.a.Description],this.properties.Description);h!==b.mpb.innerText&&(b.mpb.innerText=h,b.rR&&!Object(Za.a)(Gm.a,this.root)&&(h=!Mf.b(h),Yg.a.j9(b.rR,"UIFontBold",h),Yg.a.j9(b.rR,"cui-ctl-mediumlabel-nodescription",!h)))}}iL(b){b=b.Rn;Df.a.instance.nb(zd.a.focus,b,Object(F.a)(this,this.onFocus,"onFocus"));Df.a.instance.nb(zd.a.blur,b,Object(F.a)(this,this.onBlur,"onBlur"));
kk.a.instance.nb(zd.a.iM,b,Object(F.a)(this,this.mS,"onPointerOver"));kk.a.instance.nb(zd.a.zH,b,Object(F.a)(this,this.eM,"onPointerOut"));kc.KeyInputManager.instance.nb(zd.a.kj,b,Object(F.a)(this,this.onKeyDown,"onKeyDown"));kc.KeyInputManager.instance.nb(zd.a.hi,b,Object(F.a)(this,this.fA,"onKeyUp"));kk.a.instance.nb(zd.a.jt,b,Object(F.a)(this,this.LE,"onPointerDown"));kk.a.instance.nb(zd.a.PP,b,Object(F.a)(this,this.XCa,"onPointerUp"));Nc.a.instance.nb(zd.a.click,b,Object(F.a)(this,this.onClick,
"onClick"));Zm.a.instance.nb(zd.a.JS,b,Object(F.a)(this,this.kwb,"onTouchMove"));Zm.a.instance.nb(zd.a.xM,b,Object(F.a)(this,this.YMa,"onTouchEnd"))}}Object(u.a)(go,"ToggleButtonBehavior",Uj,[]);class vi{constructor(b){this.Vrk=b;this.cSe={["Button"]:h=>new Tk(h),["FileMenuButton"]:h=>new Tk(h),["ColorPicker"]:h=>new po(h),["ComboBox"]:h=>new yb(h),["ContextMenuControl"]:h=>new Yb(h),["ContextMenuLauncher"]:h=>new Yb(h),["DialogMenuLauncher"]:h=>new oc(h),["DropDown"]:h=>new Gn(h),["FlyoutAnchor"]:h=>
new yd(h),["GalleryButton"]:h=>new Pd(h),["StatefulColorFlyoutAnchor"]:h=>new yd(h),["JewelMenuLauncher"]:h=>new Jg(h),["Label"]:h=>new Qj(h),["Placeholder"]:h=>new Uj(h),["SearchBox"]:h=>new om(h),["Separator"]:h=>new Uj(h),["SplitButton"]:h=>new si(h),["StatefulColorSplitButton"]:h=>new si(h),["StatefulImageSplitButton"]:h=>new si(h),["TextBox"]:h=>new tl(h),["ToggleButton"]:h=>new go(h)}}Eji(){this.cSe[Hl.a.kTi]=b=>new gg(b)}zAf(){this.cSe[Hl.a.mXj]=b=>new Wq(b)}Vjm(b){const h=this.cSe[b.controlType];
(b=h?h(b):null)&&this.Vrk&&b.N0l();return b}static get instance(){return vi._instance||(vi._instance=new vi(!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("CUICommitChangeFixIsEnabled")))}}vi._instance=null;Object(u.a)(vi,"ControlBehaviorFactory",null,[625]);var hp=d(1567),Sp=d(1392);class eq extends nm.MenuLauncher{constructor(b,h,r,A){super(b,h,r,A);this.Vsh=null;this.tTa=this.dSc=0;this.EH=null;this.YKc=this.XKc=0;this.Bh("Menu");this.enabled=!0}get x(){return this.dSc}get y(){return this.tTa}get N3f(){return this.XKc}get O3f(){return this.YKc}get controlType(){return"DialogMenuLauncher"}leb(){}Pfb(){}fIf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.mu.DialogMoveCommand;b.DialogCloseCommand=this.mu.DialogCloseCommand;return b}Pzn(b,h){this.dSc=b.x;this.tTa=b.y;this.XKc=b.height;this.YKc=b.width;this.B3(h)}gU(b){this.Vsh=Yg.a.createElement("span");return new Sp.a(b,this.Vsh)}get mu(){return this.fi}Gza(b,h,r){return new eq(b,this.id,h,r)}}Object(u.a)(eq,"DialogMenuLauncher",nm.MenuLauncher,[]);var Hr=d(1568);class yi extends hp.a{constructor(b,h){super(b,h);this.Ngb=null}get hef(){return this.Ngb}get Dfi(){return this.properties}get rca(){return 20}Bn(){super.Bn();
Mf.c(this.Rc)&&this.vE();this.Rc=Yg.a.$Za(this.Rc);this.c_(this.Rc);this.dirty=!1}tR(b){if(!Object(Za.a)(Hr.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}ktf(b,h,r,A){r=new fj.a(this,h,r,A,null);b||(b={});b.CommandMenuOpen=this.Dfi.CommandMenuOpen;b.CommandMenuClose=this.Dfi.CommandMenuClose;b=new eq(this,h,b,r);this.jgc[h]=b;h=new Hr.a(this,"dock"+h);h.Wf(b.ZW("Menu"));this.Wf(h);this.refresh()}oDg(b,h,r,A){const M=this.jgc[b];if(Mf.c(M))throw Error.create('The dialog menu "'+
b+'" does not exist');M.Pzn(new Sys.UI.Bounds(h,r,0,0),A);this.Ngb=M.Ig}Mpf(b){b=this.jgc[b];Mf.c(b)||(b.Bza(),this.Ngb=null)}fne(){this.Ngb=null}dispose(){const b=this.jgc;for(const h in b)b[h].dispose();super.dispose()}}Object(u.a)(yi,"DialogMenuRoot",hp.a,[]);class mq{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(u.a)(mq,"RootProperties",null,[]);class ip extends mq{constructor(){super()}}Object(u.a)(ip,"StandaloneRootProperties",mq,[]);class $i extends ip{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(u.a)($i,"DialogMenuRootProperties",ip,[]);class vj{constructor(){this.Alg=(h,r,A,M,ba)=>{if(1===A)return 32;h=new Sys.StringBuilder;h.append('<Menu Id="dialogMenu">');h.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');h.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',ba.DialogMoveCommand,CommonUIStrings.l_DialogMove));h.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',ba.DialogCloseCommand,
CommonUIStrings.l_DialogClose));h.append("</Controls></MenuSection>");h.append("</Menu>");ba.PopulationXML=h.toString();return 32};const b=new $i;b.ImageSideArrow=y.AFrameworkApplication.Vs;b.ImageSideArrowClass=ag.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=y.AFrameworkApplication.isRtl?"rtl":"ltr";this.Bd=new yi("DialogMenuRootId",b);this.Bd.EH=this;this.Bd.refresh();y.AFrameworkApplication.va.fb(La.a.Alg,xe.a.frame,this.Alg,96)}get f9(){return this.Bd}oVa(b,h,r,A,M=null){b=parseInt(b);
A=y.AFrameworkApplication.va;r&&(A.pE=r.CommandLocation,A.p3=r.InvocationMethod);h=A.Pb(b,2,h,M);this.Bd.refresh();return 32===h}SLa(b){return b?32===y.AFrameworkApplication.va.Ob(parseInt(b),1):!0}uv(){this.f9.root.An()}ktf(b,h,r){const A={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};A.DialogMoveCommand=h;A.DialogCloseCommand=r;this.f9.ktf(A,b,"","")}oDg(b,h,r,A){this.f9.oDg(b,h,r,A)}Mpf(b){this.f9.Mpf(b)}dispose(){this.Bd&&(this.Bd.dispose(),
this.Bd=null)}}Object(u.a)(vj,"DialogMenuRootUser",null,[365,11,604]);class Xq{constructor(b,h,r){this.NCb=this.oNd=this.fMc=this.nl=null;this.NVe=this.DMd=!1;this.juc=A=>{if(!this.LUf)return!1;A.Nb.preventDefault();this.lCf();return!0};this.kIc=b;this.oe=h;this.qx=r;this.x8b=y.AFrameworkApplication.isRtl}get LUf(){return this.NVe}G3l(b){b?(this.nl=b,this.NVe=!0,this.DMd=!1,this.oe.capture(Object(F.a)(this,this.pyn,"keyEventHandler"),null),this.qx.nb(zd.a.jt,this.kIc,this.juc),this.fMc||this.WIl(),
this.nl.appendChild(this.fMc),this.h9m()):v.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}lCf(){this.NVe=!1;this.oNd=this.NCb=null;this.yBo();this.Urg();this.nl=null}Urg(){this.oe.releaseCapture();this.qx.xc(zd.a.jt,this.kIc,this.juc)}h9m(){if(this.nl.style.left.endsWith("px")&&this.nl.style.right.endsWith("px"))this.NCb=new Sys.UI.Point(Jo.a.F0(this.x8b?this.nl.style.right:this.nl.style.left),Jo.a.F0(this.nl.style.top));else{const b=this.x8b?this.kIc.offsetWidth-(this.nl.offsetLeft+
this.nl.offsetWidth+Jo.a.F0(this.nl.style.marginRight)):this.nl.offsetLeft-Jo.a.F0(this.nl.style.marginLeft),h=this.nl.offsetTop-Jo.a.F0(this.nl.style.marginTop);this.tQj(b,h);this.NCb=new Sys.UI.Point(b,h)}this.oNd=this.NCb}WIl(){this.fMc=ag.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}yBo(){this.fMc.parentNode===this.nl&&this.nl.removeChild(this.fMc)}pyn(b){if(!this.LUf)return!1;b.Nb.preventDefault();if(b.eventName===zd.a.kj){const h=b.Nb.ctrlKey?1:10;let r;switch(b.Nb.keyCode){case rf.a.t9:this.Qrc(0,
-1*h);break;case rf.a.iia:this.Qrc(0,1*h);break;case rf.a.j3b:r=this.x8b?1:-1;this.Qrc(r*h,0);break;case rf.a.k3b:r=this.x8b?-1:1;this.Qrc(r*h,0);break;case rf.a.cgb:this.hfj(this.oNd.x,this.oNd.y);this.DMd=!0;break;case rf.a.Tu:this.DMd=!0}}b.eventName===zd.a.hi&&this.DMd&&this.lCf();return!0}Qrc(b,h){this.hfj(this.NCb.x+b,this.NCb.y+h)}hfj(b,h){b=this.B4k(b,h);this.tQj(b.x,b.y);this.NCb=b}tQj(b,h){this.x8b?this.nl.style.right=b+"px":this.nl.style.left=b+"px";this.nl.style.top=h+"px"}B4k(b,h){const r=
this.x8b?Jo.a.F0(this.nl.style.marginRight):Jo.a.F0(this.nl.style.marginLeft),A=Jo.a.F0(this.nl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-r,b),this.kIc.offsetWidth-this.nl.offsetWidth-r),Math.min(Math.max(-A,h),this.kIc.offsetHeight-this.nl.offsetHeight-A))}}Object(u.a)(Xq,"KeyMoveAdapter",null,[605]);var lk=d(1664),lr=d(1483);class Ir{get name(){return"CUI.Behavior"}uc(b){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AccessibleMovingDialogsEnabled")&&(b.register(604,79).ha().Sd(()=>
new vj),b.register(605,80).ha().Sd(()=>new Xq(y.AFrameworkApplication.ta.zsa(),kc.KeyInputManager.instance,kk.a.instance)));b.register(lr.a,"CommandUI.RootManager").as(707).ha().Sd(()=>lr.a.instance)}init(){lk.a.jsf=vi.instance;const b=lr.a.instance.Eve;for(let h=0;h<b.length;++h){const r=Object(Ma.a)(606,b[h]);r&&r.iVa()}xl.a.get_instance().vK(6)}dispose(){}static main(){E.a.instance.Mc(new Ir,5)}}Object(u.a)(Ir,"CuiBehaviorPackage",null,[0,1]);class jp{constructor(b){const h=new ip;h.ImageUpArrow=
h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=ag.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=ag.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=ag.getImageClass("RibbonUpArrow_8x8x32");h.ImageDownArrow8by8Class=ag.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=ag.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=ag.getImageClass("CheckboxChecked_16x16x32");
h.ImageUncheckMarkClass=ag.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=y.AFrameworkApplication.isRtl?"rtl":"ltr";this.wlb=hp.a.ALl(h);this.wlb.refresh()}get Cha(){return this.wlb}dispose(){this.wlb.dispose()}}Object(u.a)(jp,"StandaloneRootController",null,[1793,11]);var rp=d(1775),Nk=d(226);class mr{constructor(b){this.NOc=b}create(b,h){const r=new Sys.StringBuilder;this.gYc(r,b,h);this.Htf(r,b);return r.toString()}QMb(b,h){const r=[];this.vuf(r,b,h);this.Itf(r,b);return r}gYc(b,h,
r){switch(h.errorType){case 0:b.append(this.NOc.build());break;case 1:case 2:b.append(this.tmf(h,r))}}vuf(b,h,r){switch(h.errorType){case 0:b.push(this.NOc.dYh());break;case 1:case 2:b.push(this.Xgl(h,r))}}Htf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(Nk.a("btnIgrnoreSpellingError",(2===h.errorType?ub.a.jPa:ub.a.BBa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}Itf(b,h){const r=Object.assign(new xh.a,
{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";r.ControlList.push(Object.assign(new Pj.a,{ExternalId:h}));b.push(r)}tmf(b,h){b=this.ugm(b.suggestions,h);return 0<b.length?Nk.g("msUnknownWord",Nk.d(null,b),"Menu16"):Nk.g("msUnknownWord",Nk.d(null,[Nk.a("btnNoSuggestions",ub.a.jPa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}ugm(b,h){const r=[];if(b){const A=Math.min(h.length,b.length);for(let M=0;M<A;++M)b[M]&&r.push(Nk.a("btnCorrectWord"+M,h[M].toString(),
b[M]))}return r}Xgl(b,h){const r=Object.assign(new xh.a,{Id:"Suggestions",ControlList:[]});this.tgm(b.suggestions,h,r.ControlList);0>=r.ControlList.length&&(b=Object.assign(new Pj.a,{ExternalId:"NoSuggestions"}),r.ControlList.push(b));return r}tgm(b,h,r){if(b){const A=Math.min(h.length,b.length);for(let M=0;M<A;++M){if(!b[M])continue;const ba=Object.assign(new Pj.a,{ExternalId:"btnCorrectWord"+M,Command:h[M].toString(),LabelText:b[M]});r.push(ba)}}}}Object(u.a)(mr,"DefaultProofingContextMenuCreator",
null,[]);var vn=d(711);class Yr{constructor(b,h){this.deh=b;this.fgh=h;this.sqa=[ub.a.Pzb,ub.a.Qzb,ub.a.Rzb,ub.a.J1b,ub.a.K1b]}create(b,h){return h?Object(Za.a)(vn.a,h)?this.fgh.create(b,h,this.sqa):this.deh.create(h,this.sqa):""}cgc(b,h){return h?Object(Za.a)(vn.a,h)?this.fgh.QMb(b,h,this.sqa):this.deh.QMb(h,this.sqa):null}}Object(u.a)(Yr,"ProofingContextMenuSectionFactory",null,[760]);class jn{build(){const b=[Nk.a("btnDeleteRepeatedWord",ub.a.vJa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,
null)];return Nk.g("msRepeatedWord",Nk.d(null,b),"Menu16")}dYh(){const b=Object.assign(new xh.a,{ControlList:[]}),h=Object.assign(new Pj.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(u.a)(jn,"ProofingRepeatedWordSectionBuilder",null,[759]);class Ao{static get lh(){return ug.a.ry(Ao.Qn,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,
Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}Ao.Qn="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(u.a)(Ao,"AutoCorrectOptionsDialogHTML",null,[]);class Zn{static get lh(){return ug.a.ry(Zn.Qn,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Zn.Qn="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(u.a)(Zn,"AutoCorrectOptionsDialogHTML2",null,[]);class Tp extends ug.a{constructor(b,h){super();this.OTo=(r,A)=>{1!==r?v.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):A.ReplaceTextAsYouType!==this.UY.e_a||A.CapitalizeFirstLetterOfSentences!==this.UY.MUd||A.ReplaceOrdianalsWithSuperscript!==this.UY.Hue||A.ReplaceHyphensWithDash!==this.UY.gld||A.ReplaceFractionsWithFractionCharacter!==this.UY.Gue||this.sja&&A.ReplaceQuoteWithSmartQuote!==
this.UY.dug?(r={},r.ReplaceTextAsYouType=A.ReplaceTextAsYouType,r.CapitalizeFirstLetterOfSentences=A.CapitalizeFirstLetterOfSentences,r.ReplaceOrdianalsWithSuperscript=A.ReplaceOrdianalsWithSuperscript,r.ReplaceHyphensWithDash=A.ReplaceHyphensWithDash,r.ReplaceFractionsWithFractionCharacter=A.ReplaceFractionsWithFractionCharacter,this.sja&&(r.ReplaceQuoteWithSmartQuote=A.ReplaceQuoteWithSmartQuote),this.UY.gNo(r),v.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:A.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:A.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:A.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:A.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:A.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.sja,["ReplaceQuoteWithSmartQuote"]:this.sja&&A.ReplaceQuoteWithSmartQuote}),qa.StaticActiveAppFrame.za().Fe(!0)):v.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.UY=b;this.sja=h;this.Pg="AutoCorrectOptionsDialog"}GDg(){v.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.lh=this.sja?Zn.lh:Ao.lh;const b={};b.ReplaceTextAsYouType=this.UY.e_a;b.CapitalizeFirstLetterOfSentences=this.UY.MUd;b.ReplaceOrdianalsWithSuperscript=this.UY.Hue;b.ReplaceHyphensWithDash=this.UY.gld;b.ReplaceFractionsWithFractionCharacter=this.UY.Gue;this.sja&&(b.ReplaceQuoteWithSmartQuote=
this.UY.dug);this.gi(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.OTo,b)}}Object(u.a)(Tp,"AutoCorrectOptionsDialog",ug.a,[758]);class Js{static get lh(){return ug.a.ry(Js.Qn,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Js.Qn="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(u.a)(Js,"AltTextDialogWithDescriptionHtml",null,[]);class Di{static get lh(){return ug.a.ry(Di.Qn,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Di.Qn="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(u.a)(Di,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class ig extends ug.a{constructor(b=!1,h=!1){super(!1,!1,b);this.VOi=!1;h?(this.VOi=!0,this.lh=Di.lh):this.lh=Js.lh;this.Pg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}Rsf(b){this.gi(CommonUIStrings.l_AlternativeTextDialogTitle,Object(F.a)(this,this.f6k,"altTextDialogHandler"),this.kJf(b));b=document.getElementById(ig.Ohf)||document.getElementById(ig.lSd);b.focus();b.select()}kJf(b){const h={};this.VOi?h[ig.P1m]=!0:h[ig.Ohf]=
this.bHf(b);h[ig.lSd]=this.Jqm(b)||"";return h}hAa(b){return b.Ef.id===ig.lSd?!1:super.hAa(b)}}ig.Ohf="titleText";ig.lSd="descriptionText";ig.P1m="hideTitleField";Object(u.a)(ig,"BaseAltTextDialogWithDescription",ug.a,[]);var Hi=d(26);class Ok extends ig{constructor(b,h,r,A,M){super();this.jk=h;this.Ln=r;this.fp=A;this.Pd=M;this.Nzb=this.C2=null;this.Rsf(b)}Jqm(b){this.C2=b.node;this.Nzb=Hi.TableReader.pIi(b);return Hi.TableReader.JOf(this.Nzb)}bHf(b){this.C2=b.node;this.Nzb=Hi.TableReader.pIi(b);
return Hi.TableReader.KOf(this.Nzb)}f6k(b,h){if(1===b){b=Hi.TableReader.KOf(this.Nzb);const r=Hi.TableReader.JOf(this.Nzb),A=h[ig.Ohf];h=h[ig.lSd];this.hide();const M=this.fp.Lc(15);try{M.Ab(this.C2),this.jk.RAg(this.Nzb,A),this.jk.yQj(this.Nzb,h)}finally{M&&M.dispose()}A===b&&h===r||this.Pd.ev(16)}this.Ln.wn&&this.Ln.Fk.NG(this.C2)}}Object(u.a)(Ok,"TableAltTextDialog",ig,[]);class Hp{constructor(b,h,r){this.LG=b;this.Qc=h;this.Xd=r}create(b){return new Ok(b,this.LG,Jf.a.vd(),this.Qc,this.Xd)}}Object(u.a)(Hp,
"TableAltTextDialogFactory",null,[]);const Og=()=>{df.a.sRh=!0;return 32},$m=(b,h,r,A,M)=>{if(1===r)return 32;if(!({VE:b,fz:h}=Yq(M)).returnValue)return 16;qa.StaticActiveAppFrame.za().dyc(b,h);return 32},ai=(b,h,r,A,M)=>{if(1===r)return 32;if(!({VE:b,fz:h}=Yq(M)).returnValue)return 16;qa.StaticActiveAppFrame.za().Mna(b,h);return 32},Yq=b=>{let h=null,r=0;if(!b)return{returnValue:!1,VE:h,fz:r};b=b.split(",");if(3>b.length)return{returnValue:!1,VE:h,fz:r};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));
r=parseInt(b[2]);return{returnValue:!0,VE:h,fz:r}};var xk=d(1857);class Wj extends Sys.EventArgs{constructor(b,h,r,A,M,ba=0,oa=0,Ja=null){super();this.controlId=b;this.Rtc=r;this.commandId=A;this.time=M;this.commandSurface=ba;this.fz=oa;this.contentType=Ja}}Object(u.a)(Wj,"CommandClickEventArgs",Sys.EventArgs,[]);class wn{constructor(b,h){this.nxa=b.SIf();this.KFc=b;this.Hgb=h}oVa(b,h,r,A=null,M=null){r&&(this.Hgb.pE=r.CommandLocation,this.Hgb.p3=r.InvocationMethod,this.Hgb.pUa=r.CommandTabName);
b=parseInt(b);let ba=this.KFc.Pxi(b,h,r);ba.ybg&&(ba=this.KFc.Pxi(ba.MO,h,r));if(void 0!==ba.l8a&&null!==ba.l8a)return ba.l8a;if(ba.FRb)M=32;else{var oa=null;this.nxa&&this.nxa.Ylg&&(oa=this.nxa.Ylg(ba,M));ba.mma||ba.E$c?ba.UJa?M=16:(M=this.Hgb.Pb(ba.MO,ba.apc?2:1,ba.td,M),2===M&&(M=32)):ba.UJa?M=this.Hgb.Rua(null,ba.MO,ba.td,Ja=>{A&&A(Ja.response)},M):(M=this.Hgb.Pb(ba.MO,2,ba.td,M),A&&A(M));this.nxa&&this.nxa.Slg&&this.nxa.Slg(ba,M,oa);if(h&&r&&-1!==r.InvocationMethod&&r.InvocationMethod){r=h.LegacyId;
if(void 0===r||null===r)r="";oa=h.ParentMenuId;void 0!==oa&&null!==oa||!h.MenuId||(oa=h.MenuId);let Ja=h.SqmControlId;void 0!==Ja&&null!==Ja||!h.SourceControlId||(Ja=h.SourceControlId);(void 0!==Ja&&null!==Ja||void 0!==oa&&null!==oa)&&xk.a.uoo(new Wj(Ja,r,oa,kd.ActionManager.qea(b),Date.now()))}}ba.mma&&32===M&&this.nxa&&this.nxa.hIa&&this.nxa.hIa(ba,h);ba.E$c&&32===M&&this.nxa&&this.nxa.l6a&&this.nxa.l6a(ba,h);return 32===M||1===M}SLa(b,h=null){if(y.AFrameworkApplication.Xl||me.a.instance.iz)return!1;
null!=h&&null!=h.UILocation&&(this.Hgb.pE=h.UILocation);const r=parseInt(b);if(!b||r===kd.ActionManager.pAf)return!0;b=this.KFc.Exi(r,h);b.ybg&&(b=this.KFc.Exi(b.MO,h));if(void 0!==b.l8a&&null!==b.l8a)return b.l8a;r===La.a.Icc&&h&&(b.td=h);return 32===this.Hgb.Pb(b.MO,1,b.td)}clearCache(){this.KFc.clearCache()}}Object(u.a)(wn,"GeneralCuiUser",null,[364,365]);var nr=d(198),zi=d(57),Jl=d(51),Lk=d(712);class Ko{get CM(){return null!=this.b7g?this.b7g:this.b7g=$a.a.instance.resolve(393)}constructor(b,
h,r,A){this.vfh="DocumentProofingFailed";this.vaf=b;this.FHh=h;this.fxd=r;this.YK=A}$Km(){const b=this.YK.hIm(this.vaf);return{returnValue:this.YK.FKa(this.vaf),alo:b}}$zp(b,h){const r=zi.a.Qp();if(r){var A=new nr.ScriptSharpLegacyMap;A.add(ze.a.iK,b);A.add(Rc.a.noProof,h);b=new Qb.GraphTransaction(15);b.Ab(r);this.CM.Xbb(Jl.StyleReader.wordStyleIdNormal,A,r)?Lk.a.p3j():(v.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),Lk.a.recordQosError(this.vfh,[Lk.a.oOc],"Style could not be modified"));
b.dispose()}else v.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),Lk.a.recordQosError(this.vfh,[Lk.a.oOc],"PageContentNode not found")}rVo(b,h){this.$zp(b,h)}N_o(b,h){if(this.FHh){var r=new ji.DictionaryPropertySet;this.fxd.execute(A=>{A.G_c(b)});r.setValue(ze.a.iK,b);r.setValue(Rc.a.noProof,h);h=new Qb.GraphTransaction(15);h.set(df.a.ff.Pl);this.FHh.J8(r);h.dispose()}}qf(){return Le.a.qf(this.vaf)}}Object(u.a)(Ko,"LanguageEditor",null,[756]);var Xo=d(605),Ip=d(253),an=d(109);class rs{constructor(b=
!1,h=0){this.languages=rs.pHi(Ag.a.Apm());this.nGd=new Ip.a;this.MZa=[];this.H$b=new Xo.a;this.vzj=b;this.pBh=0>=h?7:h;this.oBh=this.S5e=0;this.Ekh=!1;b&&(this.t$m(),y.AFrameworkApplication.JH(()=>{this.MHn()}))}t$m(){for(var b of this.languages)this.nGd.W(b.LCID,b);b=[];try{const A=Qc.a.get("RecentlyUsedLcids");if(A&&""!==A){const M=decodeURIComponent(A).split(",").slice(0,this.pBh);for(const ba of M){let oa;({value:oa}=this.nGd.Ec(parseInt(ba),oa)).returnValue&&b.push(oa)}}}catch(A){v.ULS.sendTraceTag(38385057,
324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",A.message),Array.clear(b)}if(b.length)for(var h of b){var r=h.LCID;this.H$b.contains(r)||(this.MZa.push(h),this.H$b.add(r))}else h=y.AFrameworkApplication.lcid,({value:r}=this.nGd.Ec(h,r)).returnValue&&(this.MZa.push(r),this.H$b.add(h));this.QJj()}QJj(){const b=an.toArray(an.select(an.asEnumerable(this.MZa),h=>h.LCID)).join(",");Qc.a.hOa("RecentlyUsedLcids",b,180)}Eym(b){let h,r=-1,A=null;var M=rs.pHi(this.MZa);
this.vzj&&0<M.length&&(A=an.toArray(an.Si(an.asEnumerable(M),(Ja,jb)=>{b===Ja.LCID&&-1===r&&(r=jb);return{["key"]:jb,["text"]:Ja.displayName,["value"]:Ja.LCID.toString()}})));let ba=0;A&&(ba=A.length);M=ba;const oa=an.toArray(an.Si(an.asEnumerable(this.languages),(Ja,jb)=>{b===Ja.LCID&&-1===r&&(r=ba+jb);return{["key"]:ba+jb,["text"]:Ja.displayName,["value"]:Ja.LCID.toString()}}));h=r;return 0<ba?{returnValue:A.concat.apply(A,oa),selectedIndex:h,Eyc:M}:{returnValue:oa,selectedIndex:h,Eyc:M}}FXo(b,
h){if(this.vzj&&({value:r}=this.nGd.Ec(b,r)).returnValue){h=b!==h;if(this.H$b.contains(b))b=Array.indexOf(this.MZa,r),0<=b&&(Array.removeAt(this.MZa,b),this.MZa.push(r)),h&&this.S5e++;else{this.H$b.add(b);this.MZa.push(r);if(this.MZa.length>this.pBh){var r=this.MZa.shift();this.H$b.remove(r.LCID)}h&&this.oBh++}this.QJj()}}MHn(){const b=this.S5e+this.oBh;!this.Ekh&&0<b&&(v.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.S5e/b),this.Ekh=!0)}static pHi(b){b=Array.clone(b);
b.sort((h,r)=>h.displayName.localeCompare(r.displayName));return b}}Object(u.a)(rs,"LanguageListHelper",null,[755]);var Bo=d(191);class Co extends Bo.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(u.a)(Co,"NumberButtonProps",Bo.a,[]);var zl=d(166);class bk{static get S8(){return null!=bk.p4g?bk.p4g:bk.p4g=$a.a.instance.Oa(827)}static get rbb(){return null!=bk.U0g?bk.U0g:bk.U0g=$a.a.instance.Oa(385)}static get xTj(){return!!bk.S8}static Wb(){const b=y.AFrameworkApplication.va;
b.qa(ub.a.quc,mc.a.view,bk.quc);b.Pc(ub.a.quc,1124);b.qa(ub.a.quc,mc.a.paragraph,bk.hAp)}static quc(b,h,r,A,M){if(1===r||!bk.xTj)return bk.xTj?32:8;if(!bk.w_i){var ba=[];ba.push(Object.assign(new Co,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ba.push(Object.assign(new Co,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ba.push(Object.assign(new Co,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ba.push(Object.assign(new Co,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));ba.push(Object.assign(new Co,
{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ba.push(Object.assign(new Co,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));M.MenuItems=Nk.e(ba);bk.w_i=!0}v.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.lb;ba=null;h&&h.gb.currentSelection&&(ba=h.gb.currentSelection);h=Object(zl.a)().Wri(ba.Qa);y.AFrameworkApplication.va.Pf(h,b,r,!0,A,M);return 32}static hAp(b,h){let r=b=!0;h=bk.rbb.fWa(h.node);var A=h.beforeSpacing;let M=!1;1===A.unit&&(M=!0);if(M||0<A.value)b=!1;
h=h.afterSpacing;A=!1;1===h.unit&&(A=!0);if(A||0<h.value)r=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(bk.F_k,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(bk.pCo,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(bk.E_k,!r));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(bk.oCo,r));return 32}}bk.F_k="AddSpaceBeforeParagraph";bk.E_k="AddSpaceAfterParagraph";bk.pCo="RemoveSpaceBeforeParagraph";bk.oCo="RemoveSpaceAfterParagraph";
bk.w_i=!1;Object(u.a)(bk,"LineSpacingRibbonMenu",null,[]);var hm=d(197),ut=d(1694),Jr=d(1510),Ii=d(66);const ho=(b,h,r)=>{if(1===r)return 32;b=qa.StaticActiveAppFrame.za().lK.zka("Automation test",!1);b.image=3;qa.StaticActiveAppFrame.za().lK.Pz(b);return 32},Kr=(b,h,r,A,M)=>{let ba;if(!({U$j:ba}=im(M)).returnValue)return 16;hm.UISurfaces.$J().then(oa=>{let Ja=null;var jb=Object.assign(new ut.a,{label:"OK",onExecute:()=>{Ja&&oa.removeNotification(Ja)}});jb=Object.assign(new Jr.a,{target:"#"+Ii.a.fwg,
content:"Here's the text for the callout",title:"Your title",primaryButtonProps:jb,useTeachingStyles:ba});jb=oa.callout(jb);Ja=oa.addNotification(jb);return null},oa=>{v.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",oa);return null});return 32},im=b=>{let h=!1;if(!b)return{returnValue:!1,U$j:h};h=Boolean.parse(b);return{returnValue:!0,U$j:h}};class kn{constructor(){this.Alt=this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(u.a)(kn,"ColorCellProps",null,[]);let Lo,
qo,pm,bn,ro,ln;class qm{constructor(){this.B$=new qb.a;this.hqh=!1}zTa(b){const h=this.B$.indexOf(b);let r=!0;if(-1!==h){r=!1;if(!h)return r;this.B$.removeAt(h)}this.B$.insert(0,b);v.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.B$.count&&(v.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.B$.K(10)),this.B$.removeAt(10));this.IBp();return r}iBc(b){let h="#";for(let A=0;A<this.B$.count;A++){var r="#"+this.B$.K(A).substring(4,
6)+this.B$.K(A).substring(2,4)+this.B$.K(A).substring(0,2);r=Object.assign(new kn,{Color:this.B$.K(A),Alt:r,DisplayColor:r});if(r.DisplayColor.toLowerCase()===b.toLowerCase()){h=r.Color;break}}for(const A of qm.lBh)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(A,h))}IBp(){v.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let r=0;r<this.B$.count;r++){var h="#"+this.B$.K(r).substring(4,6)+this.B$.K(r).substring(2,
4)+this.B$.K(r).substring(0,2);h=Object.assign(new kn,{Color:this.B$.K(r),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const r of qm.lBh)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(r,b));this.hqh||this.FAp();this.hqh=!0}FAp(){for(const b of Object.keys(qm.Tuh)){v.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=qm.Tuh[b],r=[];for(const A of h)r.push(appChrome.api.menuSection(A,A[0]in
qm.J0e?qm.J0e[A[0]].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,r,qm.J0e[b].toString()))}}}qm.Tuh={["FontColor"]:(ln=new qb.a,ln.add(["AutomaticFontColor"]),ln.add(["ThemeFontColorPickerMCU"]),ln.add(["ThemeFontColorPicker"]),ln.add(["StandardFontColorPicker"]),ln.add(["RecentFontColorPicker"]),ln.add(["MoreFontColors"]),ln),["CellShading"]:(ro=new qb.a,ro.add(["ThemeShadingColorPickerMCU"]),ro.add(["ThemeShadingColorPicker"]),ro.add(["StandardShadingColorPicker"]),ro.add(["RecentCellShadingColorPicker"]),
ro.add(["ClearShadingColor"]),ro.add(["MoreCellShadingColors"]),ro),["PictureBorders"]:(bn=new qb.a,bn.add(["ThemePictureBorderColorPickerMCU"]),bn.add(["ThemePictureBorderColorPicker"]),bn.add(["StandardPictureBorderColorPicker"]),bn.add(["RecentPictureBorderColorPicker"]),bn.add(["MorePictureBorderColors"]),bn.add(["NoPictureBorder"]),bn.add(["PictureBorderWeightOptions"]),bn.add(["PictureBorderStyleOptions"]),bn),["PageColor"]:(pm=new qb.a,pm.add(["ThemePageColorPickerMCU"]),pm.add(["ThemePageColorPicker"]),
pm.add(["StandardPageColorPicker"]),pm.add(["RecentPageColorPicker"]),pm.add(["NoPageColor"]),pm.add(["MorePageColors"]),pm),["ParagraphShading"]:(qo=new qb.a,qo.add(["AutomaticParagraphShadingColor"]),qo.add(["ThemeParagraphShadingColorPickerMCU"]),qo.add(["ThemeParagraphShadingColorPicker"]),qo.add(["StandardParagraphShadingColorPicker"]),qo.add(["RecentParagraphShadingColorPicker"]),qo.add(["NoParagraphShadingColor","MoreParagraphShadingColors"]),qo)};qm.J0e={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,
["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardParagraphShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentParagraphShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:Box4Intl.Box4Strings.L_PictureBorderColor,["ParagraphShading"]:"Paragraph Shading",["PageColor"]:Box4Intl.Box4Strings.L_PageColor};qm.lBh=(Lo=new qb.a,Lo.add("RecentFontColorPicker"),
Lo.add("RecentCellShadingColorPicker"),Lo.add("RecentPictureBorderColorPicker"),Lo.add("RecentPageColorPicker"),Lo.add("RecentParagraphShadingColorPicker"),Lo);Object(u.a)(qm,"RecentColorsSectionHandler",null,[]);var Mo=d(1874),On=d(1508);class nq{constructor(b){this.fJk=b}j8(){}h8(b){this.fJk.yUn(b)}}Object(u.a)(nq,"DataBuddyActionListener",null,[170]);class xm{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(u.a)(xm,"DataBuddyTaskPaneProps",
null,[]);class Kl{constructor(b){this.isVisible=!1;this.g1=new qb.a;this.CJe=null;this.g6=b;this.RC=new Mo.a;this.Zb=rd.FocusManager.instance()}initialize(){this.CJe=new nq(this);this.g6.GUa();this.RC.XN(this.LZk());this.RC.XN(this.hWk())}toggle(){this.isVisible?this.hide():this.show()}yUn(b){if(2===b.behavior){const h=kd.ActionManager.qea(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.g1.add(h+": "+Kl.jhm(b.response)),this.Vm())}}hide(){hm.UISurfaces.Ov().then(b=>{b.hideTaskPane(Kl.ND,
2);return null})}show(){hm.UISurfaces.Ov().then(b=>{b.showTaskPane(Kl.ND,this.TB());return null});this.isVisible&&hm.UISurfaces.Ov().then(b=>{b.setSelectedTaskPane(Kl.ND);return null})}LZk(){return b=>{b.actions=this.g1.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}hWk(){return b=>{b.onClearClick=()=>{this.g1.clear();this.Vm()}}}Wb(){y.AFrameworkApplication.va.J0(this.CJe)}Mfb(){y.AFrameworkApplication.va.z2b(this.CJe)}TB(){const b=new xm;this.RC.Byb(b);return Object.assign(new On.a,
{title:"Data Buddy",hideHeader:!1,width:Kl.width,location:2,contentProps:b,onOpen:()=>{this.xca();this.Wb();this.isVisible=!0;y.AFrameworkApplication.ta.Fe()},onClose:()=>{this.tha();this.Mfb();this.isVisible=!1;this.Vm();y.AFrameworkApplication.ta.Fe()},isModernPane:!0})}Vm(){hm.UISurfaces.Ov().then(b=>{b.updateTaskPane(Kl.ND,this.TB());return null})}xca(){this.Zb.Eg(Kl.ND)}tha(){this.bbb()&&this.Zb.Eg(this.Zb.bX)}bbb(){return!!this.Zb.currentScope&&this.Zb.currentScope.name===Kl.ND}static jhm(b){switch(b){case 0:return"Unattempted";
case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}Kl.ND="DataBuddyTaskPane";Kl.width=300;Object(u.a)(Kl,"Box4DataBuddyTaskPane",null,[599]);class Vk{constructor(b){this.ii=b}nPa(b){this.ii&&this.ii.lJ(b)}btd(){this.ii&&this.ii.rtd(void 0)}}Object(u.a)(Vk,"RibbonButtonUpdater",null,[594]);var xn=d(338);class No{constructor(){this.I9e=this.Z=
null}get name(){return"Box4.UI"}uc(b){this.Z=b;b.ia(710,()=>new wn(b.resolve(828),y.AFrameworkApplication.va)).ha();b.ia(688,()=>new Hp(b.resolve(32),new xn.a,b.resolve(46).instance)).ha();b.ia(1092,()=>new Ko($f.a.instance.Ng,b.Oa(35),b.Ra(105),b.resolve(332)));b.ia("CommandUI.StandaloneRootController",()=>new jp(y.AFrameworkApplication.Vs)).as(48).ha();b.ia(926,()=>new Tp(b.resolve(818),y.AFrameworkApplication.J.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ia("Box4.UI.LanguageListHelper",()=>new rs(y.AFrameworkApplication.J.$("RecentlyUsedLanguagesListIsEnabled"))).as(1093).ha();
b.register(jn,"Box4.UI.ProofingRepeatedWordSectionBuilder").as(829).ha();b.ia(830,()=>new mr(b.resolve(829))).ha();b.ia("Box4.UI.ProofingContextMenuSectionFactory",()=>new Yr(b.resolve(830),b.resolve(831))).as(1080).ha();b.ia("Box4.RibbonButtonUpdater",()=>new Vk(this.Z.resolve(350))).as(1475).ha();b.ia(790,()=>new qm).ha();b.ia("Common.IDataBuddyTaskPane",()=>new Kl(rp.a.instance)).ha()}init(){var b=qa.StaticActiveAppFrame.za();const h=b.Hb;cc.i8m(Object(F.a)(h,h.DWb,"onAuthenticationLost"),Object(F.a)(h,
h.EWb,"onAuthenticationRestored"),b.bnl);b=y.AFrameworkApplication.va;b.qa(ub.a.Tho,mc.a.application,Og);b.fb(ub.a.M8o,mc.a.application,$m,96);b.fb(ub.a.u9o,mc.a.application,ai,96);b=y.AFrameworkApplication.va;b.fb(ub.a.pap,mc.a.application,ho,96);b.fb(ub.a.C8o,mc.a.application,Kr,96);bk.Wb();this.B$m();this.I9e=this.Z.resolve(48)}B$m(){this.Z.Ra(710).execute(b=>{this.Z.Ra(48).execute(h=>{h.Cha.EH=b})})}dispose(){this.I9e.dispose();this.I9e=null}static main(){E.a.instance.Mc(new No,6)}}Object(u.a)(No,
"Box4UIPackage",null,[0,1]);var Hh=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},Zr=d(1875);class Rt{get name(){return"Box4.Insights"}init(){}dispose(){}uc(b){b.ia("Box4.Insights.Box4InsightsSelection",()=>new Zr.a).as(1185).as(1061).ha()}}
Object(u.a)(Rt,"Box4InsightsPackage",null,[0,1]);const oq=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var kp=d(413),Do=d(547),pq=d(704),$r=d(1835);class sp{rvb(){return!1}reset(){}update(){}}Object(u.a)(sp,"NullTaskYieldStrategy",null,[781]);var Ks=d(1277);class vt{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=
this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(u.a)(vt,"CatchUpConfiguration",null,[]);class St{constructor(){this.recentChangesManager=this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}
Object(u.a)(St,"SharedControllerFactoryParameters",null,[]);var $l=d(618),Hc=d(18);class qn{constructor(b,h,r,A){this.k6n=(M,ba)=>{(this.fEd=!this.fEd)&&ba.Ok&&ba.Ok.contextId===mc.a.Vc&&this.L1h(ba.Ok.node,ba.Ok.Jj);return 32};this.Az=b;this.Vp=h;this.ga=r;this.Zb=A;this.LFd=this.MFd=null;this.fEd=!1;this.ga.qa(Hc.a.K1j,mc.a.view,this.k6n);this.Zb.ie(pd.AFrame.Kq).bindAction(kc.KeyInputManager.lc(rf.a.eDc,6),Hc.a.K1j)}HP(b,h){this.fEd&&this.Vp&&h&&h.Tm&&h.Tm.currentSelection&&h.Tm.currentSelection.Qa&&
h.Tm.currentSelection.Qa.node&&h.Tm.currentSelection.Qa.contextId===mc.a.Vc&&this.L1h(h.Tm.currentSelection.Qa.node,h.Tm.currentSelection.Qa.Jj)}L1h(b,h){b&&(this.yhj(b)?(this.MFd&&this.MFd.id.equals(b.id)||(this.Vp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.MFd=b),this.oKn(b,h)):this.LFd=this.MFd=null)}yhj(b){return 0<this.Az.xQb(b).count}oKn(b,h){if(b){var r=-1,A=null,M=null;for(let ba=0;ba<b.ra.length;ba++){const oa=b.ra.K(ba);if(!(null==
M||oa.changeStart&&oa.changeStart.equals(A))&&h>=r&&h<=oa.cp&&!A.equals(this.LFd))if(this.Az.zTb(A)){(b=this.Az.U1c(A,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Vp.sendNotification(b,!1),this.LFd=A);break}else this.LFd=null;oa.changeStart&&!oa.changeStart.equals(A)&&(r=oa.cp,A=oa.changeStart);M=oa.changeStart}}}}Object(u.a)(qn,"ActivityAnnouncementManager",
null,[]);var Zq=d(1511),Kj=d(538),Pm=d(769),pk=d(592);class mn{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(u.a)(mn,"Activity",null,[]);var Ll=d(404);class $q extends mn{constructor(){super();this.Iw=this.objectId=null}static IS(b){const h=new pk.a(new Ll.a);if(b.Iw)for(const r of b.Iw)h.add(r);return h}}Object(u.a)($q,"RevisionSetActivity",mn,[]);class lj{constructor(b,h,r,A=!1){this.ZNe=
null;this.dismiss=()=>{this.Xhj.then(M=>{M.removeNotification(this.ZNe);return this.ZNe=null})};this.h_=b;this.Qb=h;this.Xhj=r;this.Moc=A}Csp(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:this.Qb.Pb(La.a.fcb,2,null);break;default:this.DUn()}else v.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}DUn(){this.Xhj.then(b=>{var h=Object.assign(new Jr.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,
content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new Zq.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const r=Object.assign(new Kj.a,{expirationOptions:Object.assign(new Pm.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.ZNe=b.addNotification(h,r)})}doesContentExist(b){if(!b)return v.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:if(!b.navigationId)return v.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.Qb.Pb(La.a.p0d,2,h))return!1;break;case 1:return this.WXl(b)}return!0}WXl(b){b=$q.IS(b);return b?0<this.h_.M6d(b).count:(v.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(u.a)(lj,"ActivityContentManager",null,[632]);var Eq=d(1366),fq=d(2105),kl=d(403),as=d(707);class bs{constructor(){this.Iw=this.X_=null}compare(b){if(!b)return!1;
if(this.X_&&b.X_){if(this.X_.count!==b.X_.count)return!1;for(const h of this.X_)if(!b.X_.contains(h))return!1}else if(!b.X_&&this.X_||!this.X_&&b.X_)return!1;if(b.Iw&&this.Iw){if(b.Iw.count!==this.Iw.count)return!1;for(const h of this.Iw)if(!b.Iw.contains(h))return!1}else if(!this.Iw&&b.Iw||!b.Iw&&this.Iw)return!1;return!0}}Object(u.a)(bs,"ActivityHighlightableObject",null,[]);class ss extends Eq.a{constructor(b,h){super();this.$4e=this.v$b=null;this.uwd=b;this.Az=h;this.I5=[new fq.a(kl.a.o0h,kl.a.n0h),
new fq.a(kl.a.l0h,kl.a.k0h),new fq.a(kl.a.SUd,kl.a.TUd),new fq.a(kl.a.UUd,kl.a.Znf)]}get csb(){return 1}get z$a(){return this.I5}get Mfa(){return!0}S9a(b,h){if(b=Object(Ma.a)(bs,b))if(b.X_)for(const r of b.X_)h.add(r);else v.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}RMa(b,h){if(this.As.iJa){var r=this.uwd.beb,A=this.uwd.esb,M=!!r&&r.compare(A),ba=this.As.iJa,oa=ba.action,Ja=this.m5o(ba,b),jb=!1;2!==oa&&oa&&(jb=(jb=this.As.cbd)?1===jb.type:!!r||!!A);h=h.pNa("*");
for(let zb=0,Eb=h.length;zb<Eb;zb++){const Sb=h[zb],nc=this.asm(Sb,kl.a.fVc);if(nc&&nc.gv)if(this.ZAo(Sb),1===ba.type)switch(oa){case 0:Ja&&r.Iw.contains(nc.gv)&&this.HSd(Sb,2,nc,!1);break;case 2:Ja&&A.Iw.contains(nc.gv)&&this.HSd(Sb,M?2:1,nc,!1);break;default:this.kmc(b,Sb,nc,!1)}else jb?this.kmc(b,Sb,nc,!1):this.kmc(b,Sb,nc,!0)}this.v$b&&(this.v$b.classList.add(kl.a.UUd),this.$4e=this.v$b=null)}}asm(b,h){return Tj.a.Eb(b,h)}m5o(b,h){if(b&&b.fC){const r=b.fC,A=b.action;if(1===b.type&&(2===A||!A)&&
r.X_)return r.X_.contains(h);if(r.Iw)for(const M of r.Iw){b=this.Az.v3c(M);for(const ba of b)if(ba===h)return!0}}return!1}kmc(b,h,r,A){const M=this.uwd.beb,ba=this.uwd.esb;M&&M.Iw.contains(r.gv)&&(!M.X_||M.X_.contains(b))?this.HSd(h,2,r,A):ba&&ba.Iw.contains(r.gv)&&(!ba.X_||ba.X_.contains(b))&&this.HSd(h,1,r,A)}HSd(b,h,r,A){b&&as.a(b)&&(b.classList.add(this.owm(2===h,A)),this.SWo(b,r,A))}SWo(b,h,r){this.v$b?-1!==h.cpEnd&&this.$4e.cpEnd!==h.cpBegin&&(this.v$b.classList.add(r?kl.a.Znf:kl.a.UUd),b.classList.add(r?
kl.a.TUd:kl.a.SUd)):b.classList.add(r?kl.a.TUd:kl.a.SUd);b.classList.add(kl.a.m0h);this.v$b=b;this.$4e=h}ZAo(b){this.As.XZa(b);this.Szo(b)}Szo(b){b.classList.remove(kl.a.SUd,kl.a.TUd,kl.a.m0h,kl.a.UUd,kl.a.Znf)}owm(b,h){return h?b?kl.a.k0h:kl.a.n0h:b?kl.a.l0h:kl.a.o0h}}Object(u.a)(ss,"ActivityHighlightActor",Eq.a,[]);var Qm=d(2106),or=d(165);class Qi{constructor(b,h,r,A,M,ba,oa,Ja){this.mZ=b;this.PQ=h;this.Az=r;this.cJk=M;this.ib=ba;this.Vp=Ja;this.Zb=oa;this.PQ.vfe=!1}poj(b,h,r){b?this.Z1m(b,h,r):
this.PQ.beb&&(b=Object.assign(new Qm.a,{action:1,type:1,fC:null,jM:this.PQ.beb}),this.PQ.beb=null,this.mZ.GH(b))}Z1m(b,h,r){if(h){b=new pk.a(new Ll.a);for(M of h){var A=this.Az.w2c(M);for(let ba=0;ba<A.length;ba++){const oa=A[ba];this.Az.zTb(oa)&&b.add(oa)}}var M=this.Az.M6d(b);M=this.h9h(M,b);A=this.PQ.beb;this.PQ.beb=M;M=Object.assign(new Qm.a,{action:0,type:1,fC:this.PQ.beb,jM:A});this.mZ.GH(M);r&&!this.XOo(h.K(0),b)||this.QQo(h.K(0),b)}else v.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
b.activityId)}XOo(b,h){if(!b)return v.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return v.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.fpm(b,h);return this.cJk.y_b(b.id,h)?this.Kc(b,h)?!0:!1:(v.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}QQo(b,h){b=this.pwm(b,h);h=new Sys.StringBuilder;for(let r=0;r<
b.count;r++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,r+1,b.count,b.K(r)));this.Vp.sendNotification(h.toString(),!0)}Kc(b,h){if(!b||!Ed.ParagraphReader.Vb(b))return v.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return v.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.PQ.vfe=!0;b=vc.a.Tc(b,h);b=new or.Selection([b],!0);this.ib.Kc(b);rd.FocusManager.BM()&&this.Zb.Eg(pd.AFrame.Jo);
return!0}fpm(b,h){if(h&&0<h.count)for(let r=0;r<b.ra.length;r++){const A=b.ra.K(r);if(A.changeStart&&h.contains(A.changeStart))return A.cp}v.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}pwm(b,h){const r=new qb.a;if(h&&0<h.count&&b){let A=-1;for(let M=0;M<b.ra.length;M++){const ba=b.ra.K(M);if(-1!==A&&ba.Bs)if(ba.changeStart&&h.contains(ba.changeStart))continue;else r.add(b.characterData.substring(A,ba.cp)),A=-1;ba.changeStart&&
h.contains(ba.changeStart)&&(A=ba.cp)}}return r}knj(b,h){if(b)switch(b.type){case 1:if(h){b=new pk.a(new Ll.a);for(var r of h){h=this.Az.w2c(r);for(let A=0;A<h.length;A++){const M=h[A];this.Az.zTb(M)&&b.add(M)}}}else b=$q.IS(b);h=this.Az.M6d(b);this.PQ.esb=this.h9h(h,b);r=Object.assign(new Qm.a,{action:2,type:1,fC:this.PQ.esb,jM:null});this.mZ.GH(r)}else this.PQ.esb&&(r=Object.assign(new Qm.a,{action:3,type:1,fC:null,jM:this.PQ.esb}),this.PQ.esb=null,this.mZ.GH(r))}h9h(b,h){var r=null;if(b){r=new Pa.a;
for(const A of b)12===A.type&&r.add(A)}b=new bs;b.X_=r;b.Iw=h?h:this.hCm(r);return b}hCm(b){const h=new pk.a(new Ll.a);if(!b)return h;for(const r of b)for(const A of this.Az.xQb(r))h.add(A);return h}}Object(u.a)(Qi,"ActivityHighlightManager",null,[]);var Hm=d(859),io=d(702),gl=d(1364),rn=d(58),Yo=d(88),lp=d(55);class cp{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(u.a)(cp,"CreateIndicatorTooltipParameters",null,[]);class wt{constructor(){this.clearSticky=
!1}}Object(u.a)(wt,"DismissIndicatorTooltipParameters",null,[]);class tp{constructor(){this.target=null;this.isSticky=!1}}Object(u.a)(tp,"UpdateIndicatorTooltipParameters",null,[]);class Lr extends Sys.EventArgs{constructor(b,h,r){super();this.UOb=b;this.eRi=h;this.t6o=r}}Object(u.a)(Lr,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class cs{constructor(){this.fRi=new Map;this.gRi=new Set}rpp(b,h){this.gRi.add(b);this.fRi.set(b,h)}unn(b){return Te.a.QXi(b.htmlElement)}zSm(){const b=new Set;for(const h of this.gRi){const r=
this.fRi.get(h);r&&this.tnn(r)&&b.add(h)}return b}tnn(b){return b.parentElement&&Te.a.QXi(b.parentElement)}}Object(u.a)(cs,"IndicatorVisibilityTracker",null,[]);class Ia extends gl.a{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){super();this.sa=new Fd.a;this.IEb=this.Fda=null;this.yYm=(Eb,Sb,nc,Dc,Zc)=>{if(!Zc)return v.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Sb=$q.IS(Zc.Activity);Eb=null;if(Zc.NodeId&&(Zc=Yo.b(Zc.NodeId),!P.a.xt(Zc,P.a.nil)&&(Zc=this.Az.ezi(Zc),
this.HKg(Zc,!1))))return 32;for(const Gd of Sb)if(this.Az.zTb(Gd)){Zc=this.Az.hkc(Gd);if(this.HKg(Zc,!0))return 32;Zc&&!Eb&&(Eb=Zc)}if(this.HKg(Eb,!1))return 32;v.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.wYm=(Eb,Sb,nc,Dc,Zc)=>{v.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");Zc&&Sb&&Sb.Cl&&(Eb=Sb.node)&&((Eb=this.zDc.Y6d(Eb))?this.HQd(Eb,!1,!1):v.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.rap=Eb=>{(Eb=this.zDc.Y6d(Eb.em))&&this.HQd(Eb,!1,!1)};this.Oma=Eb=>this.omj(Eb.Uy,!0);this.Pma=Eb=>{Eb=Eb.Uy;if(Eb===this.Fda)return!0;this.CCj(Eb);return!0};this.sua=Eb=>{this.IEb=null;return this.omj(Eb.Uy,!1)};this.Q3=()=>{this.kEg();this.UVd(!0);return!1};this.sv=()=>{this.orj()};this.lpe=()=>{this.Fda&&this.i8j(this.Fda);this.IEb&&this.CCj(this.IEb);this.J0n()};this.orj=()=>{this.Fda?this.i8j(this.Fda):
this.Zof()};this.Az=b;this.NJe=h;this.Imh=r;this.pAk=A;this.qSa=M;this.W9=null;this.Gb=oa;this.zDc=Ja;this.RVe=new cs;this.Ny=jb;this.XM=zb;this.xl&&(this.xl.r6(this.lpe),this.xl.bQh(this.orj));ba&&ba.execute(Eb=>{Eb.oY(this.sv)})}get xl(){return this.qSa&&this.qSa.jj?this.qSa:(v.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}Wea(b,h,r){if(this.Fda){var A=lp.a(this.Fda);if(b===A)return this.Fda}const M=b.Jh.ownerDocument;A=Hm.a.createElement(M,io.a.div);A.className=kl.a.VUd;
A.style.left=h+"px";A.style.top=r+"px";h=Hm.a.createElement(M,io.a.div);h.className=this.Ny?kl.a.u0h:kl.a.p0h;A.style.cursor="pointer";h.style.cursor="pointer";h.style.backgroundColor=this.XM.Jlm();h.style.outlineWidth="1px";h.style.outlineStyle="solid";h.style.outlineColor=this.XM.Klm();A.appendChild(h);ee.a.instance.nb(zd.a.hS,A,this.Oma);ee.a.instance.nb(zd.a.cM,A,this.Pma);Nc.a.instance.nb(zd.a.click,A,this.sua);ee.a.instance.nb(zd.a.contextMenu,A,this.Q3);v.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");
this.zGn(b);h=this.cDm(b);this.RVe.rpp(h,A);this.RVe.unn(b)&&this.Elj(h);return A}Q_a(b){return this.h4o(b)}DUa(b){const h=this.Nkl(b),r=[];r.push(this.Wea(b.V3,h,b.IBc[0].y-b.B7[0].y));return r}Nkl(b){let h=kl.a.o7m+(0>b.tbd?-b.tbd:0);const r=Rh.a.sj(b.Cba,0)/2;1>=r&&v.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>r?r:h;h=h<kl.a.q0h?kl.a.q0h:h;return y.AFrameworkApplication.isRtl?b.B7[0].width/this.zoom+h:-h}JSj(b){if(b&&b.wc===rn.a.paragraphNode||b.wc===rn.a.Xna){const h=
this.Az.xQb(b);if(h)for(const r of h)if(b===this.Az.hkc(r))return!0}return!1}h4o(b){for(const h of Ed.ParagraphReader.Nv(b.Cb,!0,!1))if(this.JSj(h))return!0;return!1}Wb(b){b.qa(Hc.a.rUj,mc.a.Vc,this.wYm);b.qa(Hc.a.CDg,mc.a.Vc,this.yYm)}HKg(b,h){if(!b)return!1;const r=this.zDc.Y6d(b);if(r)return this.HQd(r,!1,!0),!0;if(!h){let A;this.rjd((A=new qb.a,A.add(b),A),!1,!0,!0);h=new wc.a(3,1,0,this.rap,181);h.em=b;this.Gb.Yb(h);return!0}return!1}OHl(b,h=!1){h&&this.UVd(!0);if(b&&b.parentNode){var r=this.UOf(b);
r=this.vhm(r);this.W9||(this.W9=document.createElement("Div"),document.getElementById(y.AFrameworkApplication.zTc).appendChild(this.W9));this.NJe.createActivityIndicatorTooltip(Object.assign(new cp,{target:b,container:this.W9,activityIds:r,isSticky:h,dirHint:9}));h&&(this.Fda=b)}else v.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}J1l(b){b&&b.classList.add(kl.a.WUd)}omj(b,h){return this.HQd(b,
h,!1)}HQd(b,h,r){if(h&&b===this.Fda)return!0;const A=this.UOf(b);h||this.kEg();this.OHl(b,!h);this.J1l(b.getElementsByClassName(this.Ny?kl.a.u0h:kl.a.p0h)[0]);this.rjd(A,h,!0,r);this.S$i(A,h?1:2);this.pAk.Gie();h&&(this.IEb=b);return!0}UVd(b=!1){this.NJe.dismissActivityIndicatorTooltips(Object.assign(new wt,{clearSticky:b}));this.IEb=null;b&&(this.Fda=null)}VVj(b){b&&b.classList.remove(kl.a.WUd)}kEg(){this.Fda&&this.VVj(this.Fda.getElementsByClassName(kl.a.WUd)[0])}CCj(b){const h=this.UOf(b);this.rjd(h,
!0,!1,!1);this.VVj(b.getElementsByClassName(kl.a.WUd)[0]);this.UVd(!1);this.IEb=null}UOf(b){let h=null;(b=(b=lp.a(b))?b.Cb:null)&&11===b.type&&(h=Ed.ParagraphReader.Nv(b,!0,!1));return h}Zof(){const b=!!this.IEb;if(this.Fda||b)this.kEg(),this.UVd(!0),this.rjd(null,!1,!1,!1),this.rjd(null,!0,!1,!1)}S0k(b){this.sa.addHandler(Ia.zMh,b)}T0k(b){this.sa.addHandler(Ia.AMh,b)}rjd(b,h,r,A){let M=null;if(r&&b){for(const ba of b)if(r=this.Az.w2c(ba))for(let oa=0;oa<r.length;oa++){const Ja=r[oa];if(this.Az.zTb(Ja)){M=
this.Az.U1c(Ja,ba.id);break}}if(!M){v.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(Ia.zMh,new Lr(M,b,!1)):this.sa.raiseEvent(Ia.AMh,new Lr(M,b,A))}vhm(b){const h=[];if(b)for(const A of b){var r=this.Az.xQb(A);for(const M of r)(r=this.Az.U1c(M,A.id))&&h.push(r.activityId)}!h.length&&b&&b.count&&v.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return h}i8j(b){b&&b.parentNode?(this.NJe.updateActivityIndicatorTooltip(Object.assign(new tp,{target:b,isSticky:!0})),this.Fda=b):v.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}J0n(){const b=this.RVe.zSm();for(const h of b)this.Elj(h)}Elj(b){this.Imh.R$i(b,3)}cDm(b){return(b=Ed.ParagraphReader.Nv(b.Cb,!0,!1))&&b.count?b.K(0).id:null}zGn(b){b=Ed.ParagraphReader.Nv(b.Cb,!0,!1);this.S$i(b,0)}S$i(b,
h){b&&b.count&&this.yGn(b.K(0).id,h)}yGn(b,h){this.Imh.R$i(b,h)}}Ia.zMh="ActivityIndicatorPreviewed";Ia.AMh="ActivityIndicatorSelected";Object(u.a)(Ia,"ActivityIndicatorActor",gl.a,[]);var Ab=d(30);class hc{constructor(b,h,r){this.Az=b;this.LOd=h;this.qSa=r}get xl(){return this.qSa&&this.qSa.jj?this.qSa:(v.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}Y6d(b){v.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const h=this.iAi(b);if(!h){v.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.Az.xQb(b);for(const r of b)if(b=this.Az.hkc(r),b=this.iAi(b))return b}return h}iAi(b){if(!b||12!==b.type)return v.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return v.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var h=this.LOd.dRb(b);if(!h||11!==h.type)return v.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.Ce(this.xl.sc);if(!h||!h.htmlElement)return v.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var r=xd.a.x2c(h.htmlElement,hc.yMh);if(r)return r;h=h.k3d();if(!h)return v.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;h=xd.a.Amm(h,hc.yMh);if(!h)return v.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(r=0;r<h.length;r++){const A=lp.a(h[r]),M=Ab.OutlineElementNavigator.Cm(b);if(A&&A.Cb&&M&&A.Cb.id.equals(M.id))return h[r]}v.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}zxm(b){b=this.Az.ezi(b);if(!b||12!==b.type)return v.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
P.a.nil;b=this.Y6d(b);if(!b)return v.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),P.a.nil;b=lp.a(b);return b?b.Cb.id:(v.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),P.a.nil)}}hc.yMh="CatchUpActivityIndicatorContainer";Object(u.a)(hc,"ActivityIndicatorHelper",null,[]);class Kc{constructor(b,h,r,A,M,ba){this.HBa=b;this.Vh=h;this.mef=
r;this.Qb=A;this.h_=M;this.pf=ba;this.x4i=!1;this.nLn=(oa,Ja,jb)=>{if(1===jb)return this.JSf?32:8;2===jb&&(this.JSf&&(this.mef.Zof(),this.osl()),v.ULS.sendTraceTag(38138719,377,50,G.c({["MarkAsRead invoked"]:!0})));qa.StaticActiveAppFrame.za().Fe();return 8};this.HBa.yNa(this.mef)}initialize(){this.Qb.qa(Hc.a.Dcj,xe.a.frame,this.nLn)}get JSf(){return!!this.h_.aV&&0<this.h_.aV.count||!!this.h_.asc&&0<this.h_.asc.count}get jxn(){return this.x4i}aig(b){const h=b&&b.wywaActivities?b.wywaActivities.length:
0;if(0<h||!b){const r=new Map;r.set("activityCount",h.toString());this.pf.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:r})}b?(this.DWn(b.wywaActivities),this.x4i=!0):(v.ULS.shipAssertTag(36538305,377,!1),this.pf.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}DWn(b){b?(v.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),this.x2o(b),b=this.h_.j0k(b),this.y2o(b)):
v.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}x2o(b){if(b){var h=new qb.a;for(const r of b)switch(r.type){case 2:case 3:case 4:case 10:b=4===r.type?r.csj:r.contentId,h.add(b),this.h_.asc.add(b)}0<h.count&&(v.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.Qb.Pb(La.a.Sgj,2,h.toArray()))}}y2o(b){const h=new pk.a(new Ll.a),r=new Qb.GraphTransaction(3);try{r.Ab(this.Vh);for(const A of b){const M=this.h_.hkc(A);M&&this.mef.JSj(M)&&(h.add(M.id),this.HBa.NSb(M,!0))}}finally{r&&
r.dispose()}0<b.count&&qa.StaticActiveAppFrame.za().Fe();b={};b.highlightedNodeCount=h.count;v.ULS.sendTraceTag(36509257,377,50,"{0}",G.c(b))}osl(){v.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.h_.asc.count&&(this.Qb.Pb(La.a.Egi,2,this.h_.asc.toArray()),this.h_.asc.clear());const b=this.sul(this.h_.aV);this.Kzo(b)}Kzo(b){v.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");const h=new Qb.GraphTransaction(3);
try{h.Ab(this.Vh);for(const r of b){this.h_.aV.remove(r);for(const A of this.h_.v3c(r))this.HBa.NSb(A,!0)}this.h_.y2h()}finally{h&&h.dispose()}}sul(b){const h=new pk.a(new Ll.a);for(const r of b)h.add(r);return h}}Object(u.a)(Kc,"ActivityIndicatorManager",null,[]);class wd{constructor(){this.esb=this.beb=null;this.isFirstDocumentOpen=this.vfe=!1}}Object(u.a)(wd,"ActivityStateManager",null,[627]);class ye{constructor(b,h){this.Oxd={};this.h5b=b;this.YM=h;this.asc=new qb.a}get aV(){return this.h5b.aV}xQb(b){const h=
new pk.a(new Ll.a);if(!b)return h;b=this.h5b.k5d(b);for(let r=0;r<b.length;r++){const A=b[r];this.zTb(A)&&h.add(A)}return h}v3c(b){return this.h5b.v3c(b)}M6d(b){const h=new qb.a;if(b)for(const r of b)h.addRange(this.v3c(r));return h}j0k(b){const h=new pk.a(new Ll.a);if(b)for(const r of b)if(1===r.type&&(b=r))for(const A of b.Iw){h.add(A);this.aV.add(A);const M=A.toString();this.Oxd[M]||(this.Oxd[M]=new qb.a);this.Oxd[M].add(b)}this.y2h();return h}zTb(b){return this.aV&&b?this.aV.contains(b):!1}U1c(b,
h){if(b&&(b=this.Oxd[b.toString()])&&0<b.count){for(const r of b)if(r.objectId.equals(h))return r;return b.K(0)}return null}hkc(b){return this.h5b.hkc(b)}y2h(){this.h5b.$rl()}w2c(b){return this.h5b.w2c(b)}ezi(b){if(!this.YM)return null;const h=this.YM.Ic;return h?h.Eb(b):null}}Object(u.a)(ye,"ChangeIdCache",null,[]);var gf=d(517),Ce=d(234);class Zf extends gf.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new Ce.a,{T_:Zf.getTypeName(),
B_:Zf.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(u.a)(Zf,"ChangeSummariesResponse",gf.a,[]);var Kg=d(1416);class T extends Kg.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Ce.a,{T_:T.getTypeName(),B_:T.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(u.a)(T,"ChangeSummariesRequest",Kg.a,[]);var ia=d(1384),nb=d(864),Tb=d(360),na=d(863);class Da{constructor(){this.wvc=this.Kld=null}}Object(u.a)(Da,"ActionPair",null,[]);class Ya{constructor(b,h,r,A){this.B1l=M=>{M=M.em;const ba=this.bCj(M);ba&&(v.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.ULf(M)),ba.wvc("Request timeout"))};this.XC=b;this.RY=h;this.Re=r;this.Gb=A;this.TVe=null;this.j5e=
new fb.a;this.gCh=new fb.a}ohp(b){const h=Object.assign(new ia.a,{parentPath:["Signal",T.getTypeName()],items:[Object.assign(new nb.a,{body:b})]});return this.initialize().then(()=>{const r=new Promise((A,M)=>{this.j5e.W(b.requestId,Object.assign(new Da,{Kld:A,wvc:M}))});this.gCh.W(b.requestId,new Date);v.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Ya.requestTimeoutMs);this.RY.getAugLoopRuntimeManager().submitOperation(Object.assign(new na.a,
{operation:h}));this.h_o(b.requestId);return r})}initialize(){this.TVe||(this.TVe=this.XC.Bm().then(()=>{this.Re.nb(this,Zf.getTypeName())}));return this.TVe}oH(b,h){if(b&&Tb.a.getTypeNameFor(b.content)===Zf.getTypeName())if(b=b.content){var r=this.bCj(b.correspondingRequest);r?h!==ia.a.getTypeName()?r.wvc("Invalid operation type"):(v.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.ULf(b.correspondingRequest)),
r.Kld(b)):v.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.ULf(b.correspondingRequest))}else v.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else v.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}h_o(b){const h=new wc.a(3,1,Ya.requestTimeoutMs,
this.B1l,176);h.uQd=0;h.em=b;this.Gb.Yb(h)}bCj(b){if(!b)return null;let h;if(!({value:h}=this.j5e.Ec(b,h)).returnValue)return null;this.j5e.remove(b);return h}ULf(b){if(!b)return-1;let h;return({value:h}=this.gCh.Ec(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return y.AFrameworkApplication.J.fc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(u.a)(Ya,"ChangeSummariesAugloopProvider",null,[155]);class Pb{constructor(){this.activityGroups=null}}Object(u.a)(Pb,"FeaturedActivityGroupPayload",
null,[]);class pc{constructor(b,h,r,A,M){this.QLk=b;this.mpk=h;this.Zqk=r;this.Luk=A;this.xBb=M}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.Luk.qHb.then(()=>this.btm(b)):pc.qAf}SVm(b,h,r){if(!h)return v.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;oq("TranslateFeaturedActivityGroups");r=this.Zqk.bqp(b,h,r.wywaActivities);v.ULS.sendTraceTag(542942800,377,50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",
0<b.activityChanges.length,0<h.inferences.length,0<r.length);this.xBb.set(h.correspondingRequest,r);return Object.assign(new Pb,{activityGroups:r})}btm(b){oq("BuildFeaturedActivityGroupRequest");const h=this.QLk.Mgl();if(!h||!h.documentContent||!h.activityChanges)return v.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),pc.qAf;if(!h.documentContent.length||!h.activityChanges.length)return pc.qAf;v.ULS.sendTraceTag(578954499,
377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);oq("SubmitFeaturedActivityGroupRequest");return this.mpk.ohp(h).then(r=>this.SVm(h,r,b))}}pc.qAf=Promise.resolve(Object.assign(new Pb,{activityGroups:[]}));Object(u.a)(pc,"ChangeSummariesDataProvider",null,[626]);class Pc{constructor(b,h){this.Az=b;this.EQk=h}Mgl(){const b=new qb.a,h=new qb.a,r=new pk.a(new Ll.a);var A=this.Az.aV;if(!A||!A.count)return Pc.tAf;A=this.Az.M6d(A);if(!A||!A.count)return v.ULS.sendTraceTag(592056450,
377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),Pc.tAf;for(const M of A)r.contains(M.id)||(r.add(M.id),this.Rjo(M,b,h));return h.count&&b.count?Object.assign(new T,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:Yo.a(P.a.create())}):Pc.tAf}Rjo(b,h,r){if(Ed.ParagraphReader.Vb(b)){var A=Ed.ParagraphReader.d4(b);if(A&&A.length){h.add(A);A=this.Az.xQb(b);A=this.$Um(A);for(const M of A){A=new qb.a;const ba=this.getTextRanges(b,
M);for(const oa of ba)A.add({changeEnd:oa.endIndex,changeSpanId:oa.SSo,changeStart:oa.startIndex,contentIndex:h.count-1,locationId:Yo.a(b.id)});(A=this.tEl(M,A.toArray()))&&r.add(A)}}else v.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else v.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}$Um(b){const h=new fb.a;for(const r of b)(b=this.wEi(r))?(h.mb(b)||h.W(b,new pk.a(new Ll.a)),
h.K(b).add(r)):v.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}tEl(b,h){const r=[];let A=null;for(const M of b)if(b=this.Az.U1c(M,P.a.nil)){if(!A){const ba=this.wEi(M);if(!ba||!ba.length){v.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}A=ba}r.push(b)}else v.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");
return r.length?A?h.length?{activityId:r[0].activityId,changes:h,personId:A,timestamp:r[0].displayTimestamp.toISOString()}:(v.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(v.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),null):(v.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),
null)}wEi(b){b=this.Az.U1c(b,P.a.nil);if(!b)return v.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return v.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const r=new qb.a;
if(!h||!h.count||!b)return r;let A=-1,M=new pk.a(new Ll.a);for(let ba=0;ba<b.ra.length;ba++){const oa=b.ra.K(ba);if(-1!==A&&oa.Bs){if(oa.changeStart&&h.contains(oa.changeStart)){M.add(oa.changeStart);continue}r.add({startIndex:A,endIndex:oa.cp,SSo:this.EQk.AMj(M)});A=-1;M=new pk.a(new Ll.a)}oa.changeStart&&h.contains(oa.changeStart)&&(A=oa.cp,M.add(oa.changeStart))}return r}}Pc.tAf=Object.assign(new T,{activityChanges:[],documentContent:[],requestId:Yo.a(P.a.nil)});Object(u.a)(Pc,"ChangeSummariesRequestBuilder",
null,[]);class hd{constructor(){this.changes=this.content=null}}Object(u.a)(hd,"ContentChange",null,[]);class Hd{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(u.a)(Hd,"FeaturedActivityGroup",null,[]);class Sd{constructor(){this.end=this.start=0}}Object(u.a)(Sd,"TextRange",null,[]);class Ae{constructor(b){this.zDc=b}bqp(b,h,r){if(!h)return v.ULS.sendTraceTag(588379906,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),
Ae.U0d;if(!h.inferences)return v.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),Ae.U0d;if(!h.activityClassifications)return v.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),Ae.U0d;if(!h.inferences.length||!h.activityClassifications.length)return v.ULS.sendTraceTag(561111455,377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),
Ae.U0d;const A=[],M=new Ha.a(new Ll.a);for(const ba of h.inferences){const oa=this.aqp(ba,b,h,r);if(!oa)continue;const Ja=this.zDc.zxm(Yo.b(oa.locationId));Ja.equals(P.a.nil)?A.push(oa):M.mb(Ja)?M.K(Ja).ranking>oa.ranking&&M.W(Ja,oa):M.add(Ja,oa)}b=[...Array.from(M.values),...A];b.sort((ba,oa)=>ba.ranking-oa.ranking);return b.slice(0,Ae.GMn)}aqp(b,h,r,A){if(!b||Ye.a.Uf(b.activitiesInGroup))return v.ULS.sendTraceTag(588379909,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),
null;const M=new qb.a,ba=new fb.a;let oa=null;for(const jb of b.activitiesInGroup){if(!jb){v.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>jb.activityIndex||jb.activityIndex>=r.activityClassifications.length){v.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");continue}const zb=r.activityClassifications[jb.activityIndex];if(!zb||
Ye.a.Uf(zb.contents))v.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Ja=this.j9l(A,zb.activityId);if(Ja){M.add(Ja);for(const Eb of jb.changes){if(!Eb){v.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Ja=Eb.value;if(0>Ja||Ja>=zb.contents.length){v.ULS.sendTraceTag(576251592,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");
continue}Ja=zb.contents[Ja];if(!Ja){v.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const Sb=h.documentContent[Ja.contentIndex],nc=Object.assign(new Sd,{start:Ja.changeStart,end:Ja.changeEnd});if(ba.mb(Sb))ba.K(Sb).add(nc);else{let Dc;ba.W(Sb,(Dc=new qb.a,Dc.add(nc),Dc))}oa||(oa=Ja.locationId)}}else v.ULS.sendTraceTag(588379913,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!M.count)return v.ULS.sendTraceTag(588379914,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.MQm(ba);return h.count?Object.assign(new Hd,{ranking:b.ranking.value,reasons:[1],activities:M.toArray(),contentChanges:h.toArray(),locationId:oa}):(v.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),null)}j9l(b,h){for(const r of b)if(r&&r.activityId&&r.activityId===h)return r;return null}MQm(b){const h=
new qb.a;for(const A of b){b=A.key;const M=A.value;M.Sc((ba,oa)=>ba.start-oa.start);var r=M.K(0).start;if(r>Ae.jdj){r-=Ae.jdj;b=b.substring(r,b.length);for(const ba of M)ba.start-=r,ba.end-=r}h.add(Object.assign(new hd,{content:b,changes:M.toArray()}))}return h}}Ae.U0d=[];Ae.jdj=10;Ae.GMn=4;Object(u.a)(Ae,"ChangeSummariesResponseTranslator",null,[]);class og{constructor(){this.xBb=new fb.a;this.y6e=new fb.a}set(b,h){if(h.length&&b){this.xBb.W(b,h);for(const r of h)if(r.activities)for(const A of r.activities)A&&
A.activityId?this.y6e.W(A.activityId,b):v.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else v.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.xBb.mb(b)?this.xBb.K(b):null}qJn(b){return b&&this.y6e.mb(b)?this.y6e.K(b):null}}Object(u.a)(og,"FeaturedActivityGroupCache",null,[]);class qf{constructor(b){this.die=(h,r,A,M,ba)=>{if(!ba)return v.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),
8;h=ba.Activity;if(!h)return v.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;r=this.xBb.qJn(h.activityId);if(!r)return v.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),8;A=$q.IS(h);v.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",r,h.activityId,
this.AMj(A));return 32};this.xBb=b;this.Mah=new Map}Wb(b){b.qa(Hc.a.die,xe.a.frame,this.die)}AMj(b){let h=0;const r=Array(b.count);for(const A of b)b=this.gEm(A),r[h]=Yo.a(b),h++;return r.join(",")}gEm(b){let h=this.Mah.get(b);if(h&&h!=P.a.nil)return h;h=P.a.create();this.Mah.set(b,h);return h}}Object(u.a)(qf,"FeaturedActivityGroupTelemetryActor",null,[]);var Be=d(83);class kf extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(u.a)(kf,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Nh{constructor(b,
h,r){this.uT=null;this.eqp=A=>{this.N5a.reset();A=this.DQm(A.em);let M=null;for(;A.moveNext();){const ba=A.currentNode;if(ba&&(Ed.ParagraphReader.Vb(ba)&&this.sa.raiseEvent("OPV",new kf(ba)),this.N5a.update(),this.N5a.rvb())){M=ba;break}}M?this.bPh(M):this.uT(!0)};this.Gb=b;this.N5a=h;this.YM=r;this.sa=new Fd.a;this.qHb=new Promise(A=>{this.uT=A})}v2k(b){this.sa.addHandler("OPV",b)}xdl(){this.bPh(null)}bPh(b){const h=new wc.a(3,1,0,this.eqp,182);h.em=b;this.Gb.Yb(h)}DQm(b){if(!b)return Be.a.Zo(this.YM);
b=zc.a.Za(b);b.vb(7);return Be.a.Bt(b,this.YM)}}Object(u.a)(Nh,"DocumentTraverser",null,[]);class yh{constructor(b){this.Qb=b}shouldShowEmptyExperienceButton(){return y.AFrameworkApplication.Ige()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.Qb.Pb(La.a.aAe,2,null)}onInviteOthersButtonClick(){this.Qb.Pb(La.a.Maa,2,null)}}Object(u.a)(yh,"EmptyCatchUpBehaviorManager",null,[622]);class of{constructor(b,h){this.Acm=()=>{const r=
document.getElementById("flyoutItem0");r&&(v.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),r.focus())};this.kq=b;this.Zb=h}initialize(){const b=this.Zb.ie(pd.AFrame.Kec);b.YL=!0;b.parent=pd.AFrame.Kq;b.Pja(this.Acm);this.kq.IW(pd.AFrame.Kec)}enableF6Focus(){this.kq.eL(pd.AFrame.Kec)}disableF6Focus(){this.kq.Cx(pd.AFrame.Kec)}}Object(u.a)(of,"FlyoutFocus",null,[621]);class Ne{constructor(b,h,r){this.P$g=this.ukh=this.VJc=this.GEd=!1;this.MSe=this.vxd=null;this.z3n=
(A,M,ba,oa,Ja)=>{Ja[Ng.a.Visible]=!0;Ja[Ng.a.On]=this.VJc&&this.GEd;return 32};this.l6n=(A,M,ba)=>{if(1===ba)return this.GEd?(this.ukh||(this.ukh=!0,v.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.vxd)return v.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),8;this.P$g=!0;this.vxd();return 32};this.ga=b;this.xih=h;this.Zb=r}get GEf(){return this.MSe?this.MSe:(v.ULS.sendTraceTag(578401728,
3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set GEf(b){this.MSe=b}initialize(){this.Wb()}registerButtonClickedEvent(b){this.vxd&&v.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.vxd=b.buttonClickedCallback}onFlyoutInitialized(){this.GEd&&v.ULS.sendTraceTag(588129367,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const b=(new Date).getTime()-this.GEf.getTime();
v.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",b);this.GEd=!0;$b.c(La.a.Rnl,!0,void 0,void 0,void 0,b)}onFlyoutVisibilityChanged(b){this.VJc!==b.flyoutIsVisible&&(this.VJc=b.flyoutIsVisible,qa.StaticActiveAppFrame.za()&&qa.StaticActiveAppFrame.za().Fe(!0),this.VJc&&this.P$g&&this.Zb.Eg(pd.AFrame.Kec),this.VJc||this.xih&&this.xih.OEn())}logFlightTriggers(b){b.hasFlyoutData&&y.AFrameworkApplication.nd("WoCha187;WoCha187cf")}Wb(){this.ga.qa(La.a.O1j,xe.a.frame,
this.l6n);this.ga.fb(La.a.Sxj,xe.a.frame,this.z3n,96)}}Object(u.a)(Ne,"FlyoutRibbonButton",null,[620]);var yf=d(154);class Bg{constructor(b,h){this.aV=null;this.Tce=this.J0i=!1;this.h_=b;this.pf=h;this.Osb=new yf.a;this.uce=new Map;this.Osb.W(1,new pk.a(new Ll.a));this.Osb.W(0,new pk.a(new Ll.a));this.Osb.W(2,new pk.a(new Ll.a));this.Osb.W(3,new pk.a(new Ll.a));this.uce.set(3,"CatchUpIndicatorVisible");this.uce.set(1,"CatchUpIndicatorPreviewed");this.uce.set(2,"CatchUpIndicatorSelected");this.Aue=
0}R$i(b,h){if(this.Osb.K(h).add(b)){this.AGn(h);switch(h){case 0:v.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:v.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:v.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:v.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.F1h()}}O2n(b){this.P2l();b=this.h_.xQb(b);for(const h of b)if(this.aV.remove(h)){this.Aue++;
break}}P2l(){if(!this.aV){this.aV=new pk.a(new Ll.a);for(const b of this.h_.aV)this.aV.add(b)}}K5k(){v.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.Aue);this.F1h()}F1h(){this.Aue&&(this.gql(),this.Ppl())}gql(){!this.J0i&&.5<=this.Osb.K(0).count/this.Aue&&(this.J0i=!0,$b.c(La.a.Tnl),v.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}Ppl(){if(!this.Tce){var b="";1<=this.Osb.K(1).count&&(this.Tce=!0,b="previews");1<=this.Osb.K(2).count&&
(this.Tce=!0,b="selections");this.Tce&&($b.c(La.a.Knl),v.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}AGn(b){(b=this.uce.get(b))&&this.pf.logKpiUsage(b,0)}}Object(u.a)(Bg,"IndicatorTelemetryActor",null,[]);var Dg=d(709);d(1057);class ll{constructor(b,h){this.Uod=b;this.gVc=h}CSm(){return this.gVc.promise.then(b=>b.getWywaActivitiesResponse)}OGf(b,h){return Dg.b(this.Uod.requestActivities(b,h))}uNf(b,h){return this.gVc.promise.then(r=>r.getWywaActivitiesResponse.WywaWaterline===
b?Promise.resolve(r.getRelevantActivitiesResponse):Dg.b(this.Uod.requestRelevantActivities(b,h)))}updateActivityState(b){return Dg.b(this.Uod.updateActivityState(b))}PGf(){return this.gVc.promise.then(b=>void 0!==b.activityFeed?Promise.resolve(b.activityFeed):Dg.b(this.Uod.requestActivityFeed()))}ztd(){return Dg.b(this.Uod.CHo())}}Object(u.a)(ll,"ActivityRepository",null,[]);var hj=d(1058);class Ek{constructor(b){this.Rj=b}get xl(){return this.Rj&&this.Rj.jj?this.Rj:null}y_b(b,h){return this.xl?this.xl.Cnf(b,
!0)?this.xl.y_b(b,h,!0,!0,!1,!1):(v.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(u.a)(Ek,"PageViewWrapper",null,[]);class Xl{constructor(b,h,r,A,M,ba=!1){this.activityContentManager=b;this.Qb=h;this.NYl=r;this.pf=A;this.p7m=M;this.Moc=ba}h7f(b){const h=new Map;h.set("activityType",b.type.toString());this.pf.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}v6f(b){this.pf.logKpiFailure("CatchUpNavigateToActivity",
b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}aSn(b){try{const h=b.activity;this.h7f(b.activity);1==h.type&&this.p7m.Gie();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.Csp(h),this.v6f("Content does not exist"),Promise.resolve(2);const r={};let A=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 11:r.ActivityId=h.activityId;r.NavigationId=atob(h.navigationId);A=this.Qb.Pb(La.a.qqf,2,r);break;
case 1:r.Activity=h,r.NodeId=b.locationId,A=this.Qb.Pb(Hc.a.CDg,2,r),r.NodeId&&this.Qb.Pb(Hc.a.die,2,r)}8==A&&this.v6f("Action failed")}catch(h){return v.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.v6f("Exception was thrown"),Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.NYl.qHb.then(()=>this.aSn(b))}}Object(u.a)(Xl,"WordActivityNavigationManager",null,[619]);var Vh;(function(b){b[b.default=0]="default";b[b.VOp=
1]="D48X48";b[b.YOp=2]="D64X64";b[b.ZOp=3]="D96X96";b[b.ROp=4]="D120X120";b[b.SOp=5]="D240X240";b[b.TOp=6]="D360X360";b[b.UOp=7]="D432X432";b[b.WOp=8]="D504X504";b[b.XOp=9]="D648X648"})(Vh||(Vh={}));Object(u.b)("ProfilePhotoDimension",Vh);var ar=d(782),Ix=d(1365);class ds{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(u.a)(ds,"ActivityFeedEntry",null,[]);const es=(b,h)=>h.Bad?an.toArray(an.select(an.asEnumerable(b),
r=>{if(!r||!r.activityFeedItemPayload)return r;const A=JSON.parse(r.activityFeedItemPayload);var M=A.actor;if(!M||M.pictureUrl)return r;const ba=M.userPrincipalName||M.email;if(!ba)return r;M=h.$Mb(ba,M.provider,y.AFrameworkApplication.xm,0);if(!M)return r;A.actor.pictureUrl=M;return Object.assign(new ds,{id:r.id,type:r.type,collectionId:r.collectionId,activityState:r.activityState,activityFeedItemPayload:JSON.stringify(A),timestamp:r.timestamp})})):b,ts=(b,h)=>{const r=new Map,A=new Map;for(const M of b){if(!M||
!M.activityFeedItemPayload)continue;b=JSON.parse(M.activityFeedItemPayload).actor;if(!b)continue;const ba=b.email||b.userPrincipalName;ba&&!A.has(ba)&&A.set(ba,new ar.a(ba,null,b.name))}A.forEach(M=>{const ba=h.Dlc(M,6);r.set(M.UserId,ba)});return r};var xt=d(452);class $s{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(u.a)($s,"ActivityRequestPayload",null,[]);class yt{constructor(){this.color=
this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(u.a)(yt,"Person",null,[]);class Jp extends mn{constructor(){super();this.relationship=0}}Object(u.a)(Jp,"TaskActivity",mn,[]);class Tt extends mn{constructor(){super();this.contentId=null}}Object(u.a)(Tt,"CommentActivity",mn,[]);class up extends Tt{constructor(){super()}}Object(u.a)(up,"CommentReplyActivity",Tt,[]);class fs extends Tt{constructor(){super();this.csj=null}}Object(u.a)(fs,"MentionActivity",Tt,[]);class am{constructor(b,
h,r,A){this.yBb=b;this.vSa=h;this.lOc=r;this.PQ=A;this.PQ.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.yBb.CSm().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.Wtf("GetWYWAActivities",b);155===b.StatusCode&&(v.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.PQ.isFirstDocumentOpen=!0);const h=this.cKg(b.People);return Object.assign(new $s,{activities:this.HDe(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,
lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.yBb.OGf(b,h).then(r=>{if(!r||r.StatusCode)throw this.Wtf("GetActivities",r);const A=this.cKg(r.People);return Object.assign(new $s,{activities:this.HDe(r.Activities,A),actors:A,hasMore:!r.RequestedRetrieved,highWaterline:r.HighWaterline,lowWaterline:r.LowWaterline})})}requestRelevantActivities(b){return this.yBb.uNf(b,this.PQ.isFirstDocumentOpen).then(h=>{if(!h||
h.StatusCode)throw this.Wtf("GetRelevantActivities",h);const r=this.cKg(h.People),A=this.HDe(h.NewActivities,r,2);h=this.HDe(h.OutstandingActivities,r,3);for(const M of h)A.push(M);return Object.assign(new $s,{activities:A,actors:r})})}updateActivityState(b){return this.yBb.updateActivityState(b)}requestActivityFeed(){return this.yBb.PGf().then(b=>({activityFeedItems:this.han(b),personaColorMap:this.bil(b)}))}HDe(b,h,r=1){const A=[];if(!b)return A;for(const oa of b){var M=null;b=[];b.push(h[oa.CreatorIndex]);
switch(oa.ActivityType){case 1:M=oa;var ba=new $q;ba.Iw=new qb.a;for(const Ja of M.ChangeIds)ba.Iw.add(Yo.b(Ja));ba.objectId=Yo.b(M.ObjectId);M=ba;break;case 2:M=oa;ba=new Tt;ba.contentId=M.ContentId;ba.navigationId=M.NavigationId;M=ba;break;case 4:M=oa;ba=new fs;b.push(h[M.MentioneeIndex]);ba.csj=M.ParentContentId;ba.navigationId=M.NavigationId;M=ba;break;case 3:case 10:M=oa;ba=new up;b.push(h[M.RepliedIndex]);ba.contentId=M.ContentId;ba.navigationId=M.NavigationId;M=ba;break;case 6:case 7:case 8:case 9:M=
oa,ba=new Jp,b.push(h[M.MentioneeIndex]),ba.navigationId=M.NavigationId,ba.relationship=M.Relationship,M=ba}M&&(M.actors=b,M.displayTimestamp=new Date(oa.DisplayTimestamp),M.activityId=Yo.b(oa.ActivityId).toString(),M.type=oa.ActivityType,1!==r&&(M.relevancy=r),A.push(M))}return A}iKo(b,h,r){return this.lOc&&this.lOc.Bad?this.lOc.$Mb(h,r,y.AFrameworkApplication.xm,Vh.default):b}cKg(b){if(!b)return null;const h=Array(b.length);for(let r=0;r<b.length;r++){if(!b[r])continue;const A=new yt;A.id=b[r].Id;
A.provider=b[r].Provider;A.displayName=b[r].DisplayName;A.email=b[r].Email;A.imageUrl=this.iKo(b[r].PictureUrl,b[r].Email,b[r].Provider);this.vSa&&(A.color=this.vSa.Dlc(new ar.a(A.email,void 0,A.displayName),Ix.a.Qnl));h[r]=A}return h}Wtf(b,h){let r="null";h&&(r=xt.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,r))}han(b){return this.lOc?es(b,this.lOc):b}bil(b){return this.vSa?ts(b,this.vSa):new Map}}Object(u.a)(am,"WordActivityRequestManager",null,[616]);
class $n{constructor(b,h,r){this.AHd=0;this.vOc=!1;this.Wrh=null;this.ztd=()=>{if(df.a.YU)v.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.vOc||3>=this.AHd){this.vOc?this.vOc=!1:this.AHd++;const A=Math.max(this.Ga.fc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.Wrh),0);v.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",A);di.Task.delay(A).continueWith(()=>{this.yBb.ztd().then(()=>{this.dwe();
return null}).catch(()=>{this.dwe();this.vOc=!0;this.AHd=0})})}else this.dwe()};this.Ga=b;this.yBb=r;h.KRd(()=>{this.vOc=!0;this.Wrh=new Date;this.AHd=0})}start(){this.dwe()}dwe(){window.setTimeout(this.ztd,6E4)}}Object(u.a)($n,"WordEditorActivityScheduler",null,[]);class gq{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}iUo(b){this.resolve(b)}}Object(u.a)(gq,"CatchUpNetworkRequestWorkerCache",null,[]);class Fq{constructor(b,h,r){this.ONl=b;this.J=h;this.pf=r}aig(b){b&&
b.authors&&this.uGn(b.authors)}uGn(b){for(const h of b)h&&h.displayName===this.ONl&&(this.pf.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),v.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.J.jb("PresenceUserId"),h.email===this.J.jb("UserPrincipalName")))}}Object(u.a)(Fq,"WywaAuthorComparator",null,[]);class zt{constructor(b){this.BY=
b}Gie(){this.BY&&this.BY.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(u.a)(zt,"IndicatorSurveyActor",null,[]);var at=d(1031),ao=d(1024);class zy{constructor(){}shouldShowDisplayChangesCheckbox(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayRecentChangesEnabled",!1)}shouldDisplayChangesBeInitiallyChecked(){return Promise.resolve(!0)}toggleShowingChanges(){return Promise.resolve(!0)}}Object(u.a)(zy,"WordRecentChangesManager",
null,[615]);class rm{constructor(){this.Unl={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get Nnl(){return y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")}get EXi(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get XWi(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",
!1)}get Uce(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get $vn(){return y.AFrameworkApplication.J.$("IsUserFromDifferentTenant")}get Moc(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}uc(b){oq("Configure");this.container=b;b.ia(835,()=>new gq).ha()}init(){oq("Init");this.Nnl&&(E.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve(219).sendMessage(2,
4,y.AFrameworkApplication.rootQuerySignature,df.a.webServiceBase+"OneNote.ashx",pq.a.word,this.Uce)}),oq("HotStore"),df.a.Rca.M$a.execute(()=>{oq("ChromeReady");xl.a.get_instance().$k(7,()=>{oq("ScriptDownload");(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve(78).$D.loadScript("catchUpActivity")).catch(b=>{v.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>
this.iYn()).catch(b=>{v.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}iYn(){oq("CreateObjectsAndInitializeState");this.JFn();this.HEl();return this.s9m()}JFn(){v.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");v.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");v.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.EXi&&v.ULS.sendTraceTag(553911650,
3012,50,"DynamicEntryPoint is enabled");this.XWi&&v.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");v.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.$vn);this.Uce&&v.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}s9m(){this.$9m();this.container.resolve(832).GEf=new Date;oq("InitializeCatchUpApp");return this.Jec.initialize(Object.assign(new vt,{featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.EXi,
customDynamicEntryPointEnabled:this.XWi,activityFeedDataEnabled:this.Uce})).then(()=>{this.container.resolve(833).start()})}HEl(){this.container.ia(834,()=>new ye(this.container.resolve(504),$l.a.Pm.kb.Jc.qd)).ha();this.container.ia(840,()=>new at.a(za.Health.instance,new ao.a,this.Unl)).ha();this.container.ia(837,()=>new wd).ha();this.container.ia(838,()=>new lj(this.container.resolve(834),y.AFrameworkApplication.va,hm.UISurfaces.$J(),this.Moc)).as(846).ha();this.container.ia(836,()=>new ll(new hj.a(Nf.a.J1j(this.container.Ra(124)),
()=>y.AFrameworkApplication.rootQuerySignature,df.a.webServiceBase+"OneNote.ashx",pq.a.word,Nf.a.J1j(this.container.Ra(125))),this.container.resolve(835))).ha();this.container.ia(848,()=>new am(this.container.resolve(836),this.container.resolve(151),this.container.resolve(150),this.container.resolve(837),this.Moc)).ha();this.container.ia(857,()=>new Qi(this.container.resolve(373),this.container.resolve(837),this.container.resolve(834),$l.a.Pm.kb.Jc,new Ek($l.a.Pm.kb.Jc),$f.a.instance,rd.FocusManager.instance(),
this.container.resolve(25))).ha();this.container.ia(839,()=>{let b;b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new $r.a(50,Te.a.Le):new sp;return new Nh(y.AFrameworkApplication.oc,b,$l.a.Pm.kb.Jc.qd)}).ha();this.container.ia(841,()=>new zt(this.container.Ra(2))).ha();this.container.ia(847,()=>new Xl(this.container.resolve(838),y.AFrameworkApplication.va,this.container.resolve(839),this.container.resolve(840),
this.container.resolve(841),this.Moc)).ha();this.container.ia(832,()=>new Ne(y.AFrameworkApplication.va,this.container.resolve(842),rd.FocusManager.instance())).as(851).ha();this.container.ia(860,()=>new of(kp.a.instance,rd.FocusManager.instance())).as(852).ha();this.container.ia(843,()=>new og).ha();this.container.ia(845,()=>new hc(this.container.resolve(834),this.container.resolve(597),$l.a.Pm.kb.Jc)).ha();this.container.ia(844,()=>new qf(this.container.resolve(843))).ha();this.container.ia(849,
()=>new pc(new Pc(this.container.resolve(834),this.container.resolve(844)),new Ya(this.container.resolve(659),this.container.resolve(660),this.container.resolve(454),y.AFrameworkApplication.oc),new Ae(this.container.resolve(845)),this.container.resolve(839),this.container.resolve(843),this.Moc)).ha();this.container.ia("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new yh(y.AFrameworkApplication.va)).as(850).ha();this.container.ia("WordEditor.CatchUpActivity.RecentChangesManager",()=>
new zy).as(853).ha();this.Jec=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new St,{activityContentManager:this.container.resolve(846),activityNavigationManager:this.container.resolve(847),activityRequestManager:this.container.resolve(848),appColorUpdateIsEnabled:y.AFrameworkApplication.J.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve(849),dataCulture:y.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.Uce?this.container.resolve(850):
null,flyoutRibbonButton:this.container.resolve(851),flyoutFocus:this.container.resolve(852),uiCulture:y.AFrameworkApplication.uiCulture,ulsLogger:new Do.a,recentChangesManager:this.container.resolve(853)}));this.Jec.setWebpackPublicPath(y.AFrameworkApplication.W8);this.container.ia(856,()=>new ss(this.container.resolve(837),this.container.resolve(834))).ha();this.container.ia(833,()=>new $n(y.AFrameworkApplication.J,Ks.a.instance,this.container.resolve(836))).ha();this.container.ia(854,()=>new Bg(this.container.resolve(834),
this.container.resolve(840))).ha();this.container.ia(855,()=>new Ia(this.container.resolve(834),this.Jec.getActivityIndicatorTooltipManager(),this.container.resolve(854),this.container.resolve(841),$l.a.Pm.kb.Jc,this.container.Ra(6),y.AFrameworkApplication.oc,this.container.resolve(845),!!df.a.instance&&df.a.instance.Bta,this.container.resolve(319))).ha();this.container.ia(112,()=>new Kc(this.container.resolve(363).instance,$l.a.Pm.kb.Jc.qd,this.container.resolve(855),y.AFrameworkApplication.va,this.container.resolve(834),
this.container.resolve(840))).ha();this.container.ia(858,()=>new qn(this.container.resolve(834),this.container.resolve(25),y.AFrameworkApplication.va,rd.FocusManager.instance())).ha();this.container.ia(859,()=>new Fq(y.AFrameworkApplication.userName,y.AFrameworkApplication.J,this.container.resolve(840))).ha()}$9m(){var b=this.container.resolve(373),h=this.container.resolve(856);b.vdb(h);const r=this.container.resolve(857);b=this.container.resolve(112);const A=this.container.resolve(855);h=this.container.resolve(858);
const M=this.container.resolve(837),ba=$f.a.instance,oa=this.container.resolve(839);ba.BA(()=>{M.vfe?M.vfe=!1:(M.beb&&r.poj(null,null,!1),M.esb&&r.knj(null,null),A.Zof())});ba.BA(Object(F.a)(h,h.HP,"onSelectionChanged"));this.Jec.getWywaEvent().addListener(Object(F.a)(b,b.aig,"onWywaActivityReady"));b=this.container.resolve(859);this.Jec.getWywaEvent().addListener(Object(F.a)(b,b.aig,"onWywaActivityReady"));const Ja=this.container.resolve(854);oa.v2k((jb,zb)=>{zb&&Ja.O2n(zb.node)});oa.qHb.then(()=>
{Ja.K5k()});this.Jec.getWywaEvent().addListener(()=>{oa.xdl()});A.S0k((jb,zb)=>{zb&&r.knj(zb.UOb,zb.eRi)});A.T0k((jb,zb)=>{zb&&r.poj(zb.UOb,zb.eRi,zb.t6o)});A.Wb(y.AFrameworkApplication.va);this.container.resolve(832).initialize();this.container.resolve(860).initialize();this.container.resolve(112).initialize();this.P$o()}P$o(){zg.c()&&(v.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",
!1)]))}dispose(){}}Object(u.a)(rm,"WordEditorCatchUpActivityPackageManager",null,[0,1]);var Kp=d(183),bt=d(865),Sv=d(1404),gs=d(1488),Mr=d(1577),us=d(1415),Kw=d(1690),Up=d(1691),Jx=d(630),gi=d(1692),Ay=d(868),Fk=d(141),Lp=d(1423);class By{constructor(){this.operationType=this.annotation=null}}Object(u.a)(By,"AnnotationChangedData",null,[]);class yn{constructor(b,h,r,A,M,ba,oa,Ja=!1,jb){this.annotationType=b;this.Hv=h;this.Sp=r;this.r1b=A;this.Utd=M;this.oFp=ba;this.kb=oa;this.GSj=Ja;this.J=jb;this.rz=
null;this.O0i=!1;this.hd=new Fd.a;this.Aed=0}ZH(b){this.hd.addHandler("AnnotationChangedEvent",b)}rK(b){this.hd.removeHandler("AnnotationChangedEvent",b)}register(){return this.Utd().then(()=>{0===this.Aed&&(this.GSj&&(this.rz=this.Sp.Xf("WebServiceCall",this.annotationType)),this.Hv.nb(this,this.annotationType));this.Aed++})}unregister(){return this.Utd().then(()=>(new Promise(b=>setTimeout(b,this.J.fc(Fk.a.sTl,3E3)))).then(()=>{0<this.Aed&&(this.Aed--,0===this.Aed&&this.Hv.xc(this,this.annotationType))}))}getAnnotations(){return this.Utd().then(()=>
this.Hv.getAnnotationsByType(this.annotationType))}sti(b){b=bt.a.lH(b);return(b=this.Hv.V4d(b))&&0<b.count?b.toArray().filter(h=>Tb.a.matchesTypesFor(h.content,[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.oFp(this.kb.ed.ud,b.parentPath):null:(v.ULS.shipAssertTag(575930380,3016,!1),null)}qAa(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new Ay.a,{parentPath:["Signal",Tb.a.getTypeNameFor(b)],items:[Object.assign(new nb.a,{body:b})]});this.r1b.submitOperation(b)}w0l(b,
h){b=Object.assign(new ia.a,{parentPath:["Signal",h],items:b});this.r1b.submitOperation(b)}oH(b,h){b?h?(this.GSj&&!this.O0i&&(this.rz.stop(),this.O0i=!0),this.hd.Jfa&&(b=new Lp.a(Object.assign(new By,{annotation:b,operationType:h})),this.hd.raiseEvent("AnnotationChangedEvent",b))):v.ULS.shipAssertTag(575930382,3016,!1):v.ULS.shipAssertTag(575930381,3016,!1)}}Object(u.a)(yn,"AnnotationManager",null,[637,155]);class br{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){this.wL=b;this.Dve=h;this.lPb=r;this.Y8a=
A;this.Faa=M;this.Y0j=ba;this.K4=oa;this.T1b=Ja;this.phc=jb;this.vYb=zb;this.Wjp=Eb}}Object(u.a)(br,"AnnotationManagerHolder",null,[636]);class Ut{constructor(b,h){this.g6a=b;this.Utd=h}submitOperation(b){return this.Utd().then(()=>{this.g6a.getAugLoopRuntimeManager().submitOperation(Object.assign(new na.a,{operation:b}))})}}Object(u.a)(Ut,"SubmitOperationHelper",null,[]);var Vt=d(1054),ml=d(1693),sm=d(1578),mf=d(40),Pn=d(103),bm=d(74),Q=d(1076);class Ca{constructor(b,h,r){this.Faa=b;this.hn=h;this.xXb=
r;this.GJa={};this.zhi=!1;this.Pvb=(A,M)=>{var ba;M.data.operationType!==ia.a.getTypeName()&&M.data.operationType!==Q.n.getTypeName()||!M.data.annotation||M.data.annotation.annotationType!==ml.a.getTypeName()||(A=M.data.annotation.content)&&null!==(ba=A.documentTypeConfidences)&&void 0!==ba&&ba.length&&(this.yhi=A.documentTypeConfidences[0].documentTypeLabel,v.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.yhi))};this.Faa.ZH(this.Pvb);this.Faa.register();this.GJa={["docType"]:null,
["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}Z6d(){this.zhi||(this.Faa.qAa(new sm.a),v.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.zhi=!0);this.Jyf();this.GJa.docType=this.yhi;this.GJa.characterCount=this.characterCount;this.GJa.paragraphCount=this.mV;this.GJa.imageCount=this.OL;this.GJa.tableCount=this.Oca;this.GJa.listElementsCount=
this.p7i;this.GJa.blobsCount=this.iUc;this.GJa.pageCount=this.xXb.getTotalPageCount();this.GJa.currentPage=this.xXb.KDi();return this.GJa}Jyf(){this.mV=this.iUc=this.p7i=this.Oca=this.OL=this.characterCount=0;var b=this.hn.Dsa($l.a.Pm.kb.Jc.qd,7,7).currentNode,h=zc.a.Za(b);for(b=Be.a.Bt(h,b);b.moveNext();)if(h=b.currentNode)if(je.a.Lt(h))this.OL++;else if(Hi.TableReader.OU(h))this.Oca++;else if(mf.ListItemReader.Dg(h))this.p7i++;else if(Ed.ParagraphReader.Vb(h)){var r=bm.e(h);for(let A=0;A<r.length;A++)5===
r[A].$h?this.OL++:this.iUc++;r=Pn.AParagraphNode.tV(h.characterData);r=r.trim();this.characterCount+=r.length;0<r.length&&!Ed.ParagraphReader.OX(h)&&!Ed.ParagraphReader.NX(h)&&this.mV++}}}Object(u.a)(Ca,"LoggingDocumentInfo",null,[633]);class sb{constructor(){this.sa=new Fd.a}T2k(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}FDo(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",b)}N1k(b){this.sa.addHandler("BlueDotClickedEvent",b)}kDo(b){this.sa.removeHandler("BlueDotClickedEvent",
b)}a2k(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}c2k(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}$1k(b){this.sa.addHandler("OnFormattingAccept",b)}b2k(b){this.sa.addHandler("OnFormattingReject",b)}H2k(b){this.sa.addHandler("OnReviewInvalidated",b)}iQh(b){this.sa.addHandler("OnTraigeAction",b)}xgf(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}yDo(b){this.sa.removeHandler("OnReviewVisibilityChanged",b)}K1k(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}D2k(b){this.sa.addHandler("OnRegisterEnhancement",
b)}W2k(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}GDo(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}ujd(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new Lp.a(b)):v.ULS.shipAssertTag(575930374,3016,!1)}Too(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new Lp.a(b)):v.ULS.shipAssertTag(575930375,3016,!1)}Woo(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",new Lp.a(b)):v.ULS.shipAssertTag(575930376,3016,!1)}tyj(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",
new Lp.a(b)):v.ULS.shipAssertTag(573850377,3016,!1)}Voo(b){b?this.sa.raiseEvent("OnFormattingAccept",new Lp.a(b)):v.ULS.shipAssertTag(575930377,3016,!1)}Xoo(b){b?this.sa.raiseEvent("OnFormattingReject",new Lp.a(b)):v.ULS.shipAssertTag(575930378,3016,!1)}Yoo(b){b?this.sa.raiseEvent("OnReviewInvalidated",new Lp.a(b)):v.ULS.shipAssertTag(575930379,3016,!1)}Spg(b){b?this.sa.raiseEvent("OnTraigeAction",new Lp.a(b)):v.ULS.shipAssertTag(573850378,3016,!1)}uyj(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",
new Lp.a(b)):v.ULS.shipAssertTag(573850379,3016,!1)}Soo(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new Lp.a(b)):v.ULS.shipAssertTag(573687395,3016,!1)}ivc(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new Lp.a(b)):v.ULS.shipAssertTag(555055117,3016,!1)}Jyj(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new Lp.a(b)):v.ULS.shipAssertTag(540587343,3016,!1)}}Object(u.a)(sb,"ReviewEvents",null,[614]);class Xb{constructor(b){this.Sy=b;if(!b)throw Kp.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}uc(b){this.Z=
b;b.ia(862,()=>new Ut(this.Z.resolve(660),bt.a.Bm)).ha();b.ia(866,()=>new Vt.a(b.resolve(23),b.resolve(71),y.AFrameworkApplication.uiCulture)).ha();b.ia(863,()=>new sb).ha();b.ia(861,()=>new br(this.ZIa(us.DocumentRoleDetectionAnnotation.getTypeName()),this.ZIa(us.RoleDetectionAnnotation.getTypeName()),this.ZIa(Sv.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.ZIa(Sv.FormattingSuggestionsAnnotation.getTypeName()),this.ZIa(gs.DocumentTypeClassifierAnnotation.getTypeName()),this.ZIa(Up.ThemeExtractorAnnotation.getTypeName()),
this.ZIa(Jx.ThemeGeneratorAnnotation.getTypeName()),this.ZIa(Kw.TextToImageAnnotation.getTypeName()),this.ZIa(Mr.DocumentPullQuoteAnnotation.getTypeName()),this.ZIa(Mr.PullQuoteAnnotation.getTypeName()),this.ZIa(gi.TableTypeAnnotation.getTypeName()))).ha();b.ia(1331,()=>new Ca(b.resolve(861).Faa,b.resolve(293),b.resolve(487))).ha()}dispose(){}ZIa(b,h=!1){return new yn(b,this.Z.resolve(454),this.Z.resolve(38),this.Z.resolve(862),bt.a.Bm,bt.a.crb,this.Sy,h,this.Z.resolve(71))}}Object(u.a)(Xb,"PackageManager",
null,[0,1]);var Cc=d(1421),jd=d(1400),dd=d(1695);class oe extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.gcg=h}}Object(u.a)(oe,"RoleChangeArgs",Sys.EventArgs,[]);class Me{constructor(b){this.ji=!1;this.D$=b;this.D$.dEd++}dispose(){this.ji||(this.ji=!0,this.D$.dEd--)}}Object(u.a)(Me,"InvalidationSuspension",null,[11]);class zf{constructor(){this.Yqd=null;this.role=this.dke=0;this.KKb=this.Dfe=this.fma=this.Ipc=!1;this.ije=this.Qcd=this.AVa=null;this.sxb=this.placeholder=!1;this.DSd=
this.Muf=null;this.CSd=0}get qab(){return!this.role||!this.AVa||!this.AVa.length}yen(){this.KKb=this.Dfe=!0}nwn(){return!!this.role||!!this.AVa||!!this.Yqd}}Object(u.a)(zf,"RoleState",null,[664]);class uh{constructor(b,h,r,A,M){this.vi=!1;this.Ece=null;this.i8f=new dh.a;this.nlh=0;this.BLo=(ba,oa)=>{oa.data.operationType===ia.a.getTypeName()&&(oa=oa.data.annotation,(ba=oa.content)?(oa=this.$$b.getParent(oa))&&this.aod(oa,jd.f(ba.roleType),!1,void 0,null!=ba.listID?ba.listID:0,ba.listItemlevel,ba.listItemPrefix):
v.ULS.shipAssertTag(575813856,3016,!1))};this.zYl=(ba,oa)=>{if(oa.data.operationType===ia.a.getTypeName())if(ba=oa.data.annotation.content)for(v.ULS.sendTraceTag(556074199,3016,50,ba.confidence.toString()),this.i8f=new dh.a,oa=0;ba.listInfos&&oa<ba.listInfos.length;oa++){const Ja=ba.listInfos[oa];this.i8f.W(Ja.listID,Ja)}else v.ULS.shipAssertTag(556323522,3016,!1)};this.s_i=(ba,oa)=>{ba=ba.qQ;if(!ba||ba.ka(Rc.a.cD,!1))return!1;ba=ba.getValue(Rc.a.ma);if(!ba)return!1;ba=jd.g(ba);return 1!=ba&&ba!=
oa.role};this.rem=(ba,oa)=>{ba=oa.data.annotation;const Ja=this.VBd.getParent(ba);if(Ja)if(oa.data.operationType===ia.a.getTypeName()){const jb=oa.data.annotation.content;jb?this.vha(Ja,zb=>{this.Ece&&zb.Muf&&this.Ece>zb.Muf&&!zb.KKb||zb.role!==zb.dke||this.s_i(Ja,zb)?(v.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.Ece,zb.KKb,zb.role===zb.dke),zb.Yqd=jb.suggestions):(zb.AVa=jb.suggestions,zb.KKb=!1)}):v.ULS.shipAssertTag(575813859,
3016,!1)}else oa.data.operationType===Cc.a.getTypeName()&&this.vha(Ja,jb=>{jb.AVa=null;jb.Yqd=null});else v.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ba.id} parentPath: ${ba.parentPath}`)};this.M_n=(ba,oa)=>{(ba=oa.data.paragraphNode)?this.vha(ba,Ja=>{oa.data.hak?(Ja.DSd=Ja.AVa,Ja.CSd=Ja.role):(Ja.DSd=null,Ja.CSd=0);Ja.fma=!0}):v.ULS.shipAssertTag(575930368,3016,!1)};this.O_n=(ba,oa)=>{(ba=oa.data.paragraphNode)?this.vha(ba,Ja=>{Ja.fma=!1;Ja.DSd=null;Ja.CSd=0;5!==
oa.data.state&&(Ja.AVa=null)}):v.ULS.shipAssertTag(573850380,3016,!1)};this.K_n=(ba,oa)=>{(ba=oa.data.paragraphNode)?this.vha(ba,Ja=>{Ja.fma=!0}):v.ULS.shipAssertTag(575930369,3016,!1)};this.N_n=(ba,oa)=>{(ba=oa.data.paragraphNode)?this.aod(ba,1,!0,!0):v.ULS.shipAssertTag(575930370,3016,!1)};this.Lhg=(ba,oa)=>{(ba=oa.data.paragraphNode)?this.aod(ba,oa.data.gcg,!0,!0):v.ULS.shipAssertTag(575484484,3016,!1)};this.zUm=(ba,oa)=>{if(oa.node){var Ja=oa.node;ba=this.dC(Ja);27==ba.role&&v.ULS.sendTraceTag(541435078,
3016,50,"Pull Quote node deleted.");ba.fma&&27!==ba.role&&28!==ba.role&&this.CRj(this.i_b-1);ba.qab||27===ba.role||28===ba.role||this.vRj(this.inconsistenciesCount-1);this.vha(Ja,jb=>{jb.sxb=!0});setTimeout(()=>this.removeNode(Ja),1E4)}else v.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ba=>{let oa;({value:oa}=this.aw.Ec(ba.id));(null===oa||void 0===oa?0:oa.sxb)&&this.aw.remove(ba.id)};this.yUm=(ba,oa)=>{oa.node?(ba=oa.node,this.a0f(ba)?this.vha(ba,Ja=>{Ja.sxb=!1}):this.vha(ba,Ja=>{Ja.KKb=
!1})):v.ULS.shipAssertTag(540672206,3016,!1)};this.AUm=(ba,oa)=>{oa.node?this.Tyb(oa.property,oa.node)&&(ba=oa.node,this.dEd||ba.Nqe?this.vha(ba,Ja=>{Ja.KKb=!1}):this.vha(ba,Ja=>{Ja.yen();Ja.Yqd&&(Ja.AVa=Ja.Yqd,Ja.role=Ja.dke)}).fma&&this.P4a.Yoo(new dd.a(oa.node))):v.ULS.shipAssertTag(575930372,3016,!1)};this.R3n=(ba,oa)=>{switch(oa.data.role){case 27:const Ja=oa.data;this.vha(oa.data.paragraphNode,zb=>{zb.role=27;zb.Ipc=!0;zb.placeholder=Ja.placeholder});break;case 28:const jb=oa.data;this.vha(oa.data.paragraphNode,
zb=>{zb.role=28;zb.Ipc=!0;zb.placeholder=jb.placeholder;zb.Y6c=jb.Y6c});break;case 2:this.vha(oa.data.paragraphNode,zb=>{zb.role=2})}};this.VBd=b;this.$$b=h;this.zQe=r;this.Pq=A;this.P4a=M;this.aw=new dh.a;this.sa=new Fd.a;this.dEd=this.vLd=this.HDd=0}get Uen(){return this.dEd}e2k(b){this.sa.addHandler(uh.Dlj,b)}L2k(b){this.sa.addHandler(uh.Xnj,b)}K2k(b){this.sa.addHandler(uh.Wnj,b)}get inconsistenciesCount(){return this.HDd}vRj(b){this.HDd!==b&&(this.HDd=b,this.sa.raiseEvent(uh.Dlj,new Lp.a(this.HDd)))}get i_b(){return this.vLd}CRj(b){this.vLd!==
b&&(this.vLd=b,this.sa.raiseEvent(uh.Xnj,new Lp.a(this.vLd)))}get uTf(){return this.nlh}a0f(b){return this.aw.mb(b.id)}EAm(b){var h,r;return null===(r=null===(h=this.i8f)||void 0===h?void 0:h.Ec(b))||void 0===r?void 0:r.value}eEi(b,h){var r,A,M;const ba=new Map;for(const oa of h)if(h=oa){const Ja=null!==(M=null===(A=null===(r=this.aw.Ec(h.id))||void 0===r?void 0:r.value)||void 0===A?void 0:A.role)&&void 0!==M?M:1;b.has(Ja)&&(ba.has(Ja)?ba.get(Ja).add(h):ba.set(Ja,new qb.a([h])))}return ba}dC(b){if(!b)return v.ULS.shipAssertTag(575813855,
3016,!1),null;let h;return({value:h}=this.aw.Ec(b.id)).returnValue?h:Object.assign(new zf,{role:1,Ipc:!1})}lHo(){this.Ece=new Date;return new Me(this)}register(){this.VBd.register();this.$$b.register();this.zQe.register()}unregister(){this.VBd.unregister();this.$$b.unregister();this.zQe.unregister()}initialize(){if(!this.vi){const b=this.Pq.jf(12);b.ly(this.zUm);b.wt(this.yUm);b.ro(this.AUm);this.VBd.ZH(this.rem);this.$$b.ZH(this.BLo);this.zQe.ZH(this.zYl);this.P4a.b2k(this.N_n);this.P4a.$1k(this.K_n);
this.P4a.a2k(this.M_n);this.P4a.c2k(this.O_n);this.P4a.iQh(this.Lhg);this.P4a.D2k(this.R3n);this.vi=!0}}Vd(){}aod(b,h,r,A=!1,M=0,ba=0,oa){let Ja=0,jb=!1;this.vha(b,zb=>{const Eb=zb.Dfe||!zb.role||1==zb.role;r||(zb.dke=h);if(A||Eb)jb=zb.role!==h,Ja=zb.role,zb.role=h,zb.Ipc=r,zb.Dfe=!1,zb.Qcd=M,zb.ije=ba,zb.listItemPrefix=oa,zb.Muf=new Date});if(jb){const zb=h-4;zb>this.uTf&&8>zb&&(this.nlh=zb);1===h&&this.vha(b,Eb=>{Eb.AVa=null});this.sa.raiseEvent(uh.Wnj,new Lp.a(new oe(b,h,Ja)))}}vha(b,h){let r;
if(({value:r}=this.aw.Ec(b.id)).returnValue){b=r.qab;const A=r.fma;h(r);if(27!==r.role&&28!==r.role){if(r.sxb)return r;b!==r.qab&&this.vRj(this.inconsistenciesCount+(b?1:-1));A!==r.fma&&this.CRj(this.i_b+(A?-1:1))}}else h(r=new zf),r.nwn()&&this.aw.add(b.id,r);return r}Tyb(b,h){({value:h}=this.aw.Ec(h.id));return 28===(null===h||void 0===h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===ze.a.Yn:!(null===h||void 0===h?0:h.placeholder)&&(b===ze.a.Yn||b===ze.a.Zn||Array.contains(Pn.AParagraphNode.Hfa(),
b))}}uh.Dlj="OnInconsistenciesChanged";uh.Xnj="OnRoleReviewCount";uh.Wnj="OnRoleChanged";Object(u.a)(uh,"RoleLifecycleManager",null,[660,661,662]);class wj{constructor(b,h,r,A,M){this.P4a=b;this.$$b=h;this.Re=r;this.Pq=A;this.D$=M;this.vi=!1;this.Lhg=(ba,oa)=>{(ba=oa.data.paragraphNode)?this.s7j(ba,()=>!0,Ja=>Ja.userSetRole=jd.e(oa.data.gcg)):v.ULS.shipAssertTag(557057378,3016,!1)};this.J2n=(ba,oa)=>{0<this.D$.Uen||this.Tyb(oa.property)&&this.s7j(oa.node,Ja=>!(Ja&&Ja.isInvalidated),Ja=>Ja.isInvalidated=
!0)}}initialize(){this.vi||(this.P4a.iQh(this.Lhg),this.Pq.jf(12).ro(this.J2n),this.vi=!0)}Vd(){}s7j(b,h,r){if(b=(b=this.$$b.sti(b))&&1===b.length&&b[0]){var A=b.content;A=A&&A.M_&&A.M_.customMetadata;h(A)&&(h=new us.RoleDetectionCustomMetadata,h.isInvalidated=A&&A.isInvalidated,h.userSetRole=A&&A.userSetRole,r(h),this.Re.Cwp(b,h))}}Tyb(b){return b===ze.a.Yn||b===ze.a.Zn||Array.contains(Pn.AParagraphNode.Hfa(),b)}}Object(u.a)(wj,"RoleDetectionMetadataUpdater",null,[659]);class Sh{constructor(b,h){this.r1b=
b;this.TNb=h;this.bfd=(r,A)=>{r=A.data;if(r.operationType==Q.a.getTypeName()||r.operationType==Q.n.getTypeName())if(r=r.annotation&&r.annotation.content)this.runId=r.runId};this.revisionId=0}initialize(){this.TNb.ZH(this.bfd)}Vd(){this.TNb.rK(this.bfd)}tXn(){if(void 0===this.runId)Promise.resolve();else{var b=new us.RoleDetectionSettings({acceptedRunId:this.runId});b=new Q.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.r1b.submitOperation(b)}}}
Object(u.a)(Sh,"RoleDetectionSettingsUpdater",null,[]);class qi{constructor(b,h,r){this.Bdn=b;this.Hv=h;this.ge=r;this.vTi=this.initialized=!1;this.yjj=()=>{this.iTj()&&(this.TRi(),this.Hv.cDo(this.yjj))}}initialize(){this.initialized||(this.CVf(),this.initialized=!0)}Vd(){}CVf(){this.iTj()?this.TRi():this.Hv.y1k(this.yjj)}iTj(){return!this.vTi&&(this.ge.mXi()||this.Hv.Cnc(us.DocumentRoleDetectionAnnotation.getTypeName())||this.Hv.Cnc(us.RoleDetectionAnnotation.getTypeName()))}TRi(){for(const b of this.Bdn)b.initialize();
this.vTi=!0}}Object(u.a)(qi,"RLMInitializer",null,[]);class yk{constructor(b,h,r){this.h1=b;this.Sy=h;this.Vwd=r;this.Z=null;this.V8=()=>{this.p8c();this.Sy.Bdb(this.V8)};if(!b)throw Kp.a.argument("AppLifecycleManager is null");if(!h)throw Kp.a.argument("Workspace is null");if(!r)throw Kp.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.Z.resolve(23).Qr.continueWith(()=>this.No())}uc(b){this.Z=b;b.ia(867,()=>new Sh(this.Z.resolve(862),
b.resolve(861).wL)).ha();b.ia(865,()=>new wj(b.resolve(863),b.resolve(861).Dve,b.resolve(454),b.resolve(459),b.resolve(864))).ha();b.ia(864,()=>new uh(b.resolve(861).Y8a,b.resolve(861).Dve,b.resolve(861).wL,b.resolve(459),b.resolve(863))).ha();b.ia(1085,()=>b.resolve(864)).ha();b.ia(868,()=>new qi([this.Z.resolve(864),this.Z.resolve(865)],b.resolve(454),b.resolve(866))).ha()}dispose(){}No(){this.Vwd.KN?this.h1.$k(16,()=>this.G7c()):this.G7c()}G7c(){this.Sy.QBa?this.p8c():this.Sy.Sja(this.V8)}p8c(){this.Z.resolve(867).initialize();
this.Z.resolve(868).initialize()}}Object(u.a)(yk,"PackageManager",null,[0,1]);class Zo{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,h){const r=new Zo;r.ContractVersion=b;r.FileName=h;r.Paragraphs=[];return r}}Object(u.a)(Zo,"DocumentSwayPreviewContent",null,[]);class Hn{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static dCl(b,h,r,A){const M=new Hn;M.RawText=b;M.ParagraphFormatting=h;M.TextRuns=
r;M.IsRTL=A;M.ParagraphIndex=0;return M}}Object(u.a)(Hn,"ParagraphContent",null,[]);var zn=d(101),At=d(1134);class Ba{constructor(){this.Name=null;this.Size=0}static construct(b,h){const r=new Ba;r.Name=b;r.Size=h;return r}}Object(u.a)(Ba,"FontData",null,[]);class Ra{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,r,A,M,ba){const oa=new Ra;oa.IsBold=b;oa.IsUnderline=h;oa.IsUppercase=r;oa.Font=A;oa.Alignment=M;oa.LeftIndent=
ba;return oa}}Object(u.a)(Ra,"TextFormatting",null,[]);class Ga{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const r=new Ga;r.RawText=b;r.RunFormatting=h;return r}}Object(u.a)(Ga,"TextRunContent",null,[]);var xa=d(105),Ua=d(90);class Kb{constructor(b,h){this.Lhb=null;this.gEk=b;this.GQ=h||""}get t$n(){return this.gEk.value}p6l(){var b=Date.now();const h=Zo.construct(2,this.GQ);h.Paragraphs=this.qim();b=Date.now()-b;const r={};r.ExtractionDurationInMs=b.toString();v.ULS.sendTraceTag(25268374,
382,50,"{0}",r);return h}qim(){const b=new qb.a;var h=0;let r=0,A=!1;var M=new zc.a;M.set(this.t$n);M=Be.a.Zo(M.currentNode);const ba=new dh.a(0);for(;M.moveNext()&&2100>r&&25>h;){var oa=M.currentNode;if(Ed.ParagraphReader.Vb(oa)&&!Ed.ParagraphReader.OX(oa)){!A&&Ed.ParagraphReader.NX(oa)&&(A=!0);let Ja=Pn.AParagraphNode.tV(oa.characterData);Ja=Ja.trim();if(0<Ja.length){const jb=this.yN(oa);jb.ParagraphIndex=h;h++;r+=Ja.length;b.add(jb);this.Zzp(ba,Ed.ParagraphReader.language(oa))}}}this.Lhb=this.zpm(ba);
h={};h.documentHasList=A;v.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}zpm(b){let h=-1,r=1033;for(const A of b.keys.toArray())A&&b.K(A)>h&&(h=b.K(A),r=A);return Ag.a.Hg(r)}Zzp(b,h){b.mb(h)?b.W(h,b.K(h)+1):b.W(h,1)}yN(b){const h=Pn.AParagraphNode.tV(b.characterData),r=this.CFm(b),A=this.zPm(b);b=this.Mqn(b);return Hn.dCl(h,r,A,b)}CFm(b){const h=Ed.ParagraphReader.Yg(b,ze.a.bold,!1),r=Ed.ParagraphReader.Yg(b,ze.a.underline,!1);var A=Ed.ParagraphReader.Yg(b,ze.a.fontSize,zn.a.lR);const M=
Ed.ParagraphReader.Yg(b,ze.a.font,zn.a.tL);var ba=Ed.ParagraphReader.Zy(b);ba=this.TGf(ba);const oa=!!Ed.ParagraphReader.Yg(b,Yf.a.capitalization,0);b=(new At.a).qX(b).value/20;A=Ba.construct(M,A);return Ra.construct(h,r,oa,A,ba,b)}zPm(b){const h=new qb.a;for(let M=0;M<b.ra.length-1;M++){var r=b.ra.K(M),A=b.ra.K(M+1);r.formatting&&(A=Pn.AParagraphNode.tV(b.characterData.substr(r.cp,A.cp-r.cp)),r=this.APm(r.formatting),r=Ga.construct(A,r),h.add(r))}return h.toArray()}APm(b){const h=xa.FormattingReader.O4c(b,
ze.a.bold,!1),r=xa.FormattingReader.O4c(b,ze.a.underline,!1);var A=xa.FormattingReader.O4c(b,ze.a.fontSize,zn.a.lR);const M=xa.FormattingReader.O4c(b,ze.a.font,zn.a.tL);A=Ba.construct(M,A);b=!!xa.FormattingReader.O4c(b,Yf.a.capitalization,0);return Ra.construct(h,r,b,A,5,0)}TGf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}Mqn(b){const h=new zc.a;h.set(b);h.vb(11);return(b=h.fd(11))?Ua.a.zo(b):!1}}Object(u.a)(Kb,"DocumentContentExtractor",
null,[593]);class Zb{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}uc(b){b.ia("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new Kb(new Pf.a(()=>$l.a.Pm.kb.Jc.qd),y.AFrameworkApplication.Ht.HA)).as(1100).ha()}static main(){E.a.instance.Mc(new Zb)}}Object(u.a)(Zb,"DocumentContentExtractorPackage",null,[0,1]);class qc{}qc.lh="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";
Object(u.a)(qc,"EmbedDialogHtml",null,[]);class Bc{constructor(b,h,r,A){this.stc=b;this.D$a=h;this.Ooe=r;this.value=A}}Object(u.a)(Bc,"OptionInfo",null,[]);class Mc{constructor(b,h,r){this.txg=b;this.Imc=h;this.D$a=r}}Object(u.a)(Mc,"SectionInfo",null,[]);var md=d(300);class gd extends ug.a{constructor(b,h=!1){super(!1,!1,h);this.GAd=476;this.U6b=288;this.RPe=798;this.fKk=476;this.eKk=288;this.Pgd={};this.Zxb=[];this.iZ=this.n4a=this.FGb=this.gDb=this.DId=this.t$b=null;this.Ual=r=>{this.O0h(r);return!0};
this.Val=r=>this.Oad(r,this.O0h);this.O0h=r=>{r=r.zq;"visible"===r.txg.style.visibility?(r.txg.style.visibility="hidden",r.D$a.className=ag.getImageClass(gd.Efh),r.D$a.title=CommonUIStrings.l_Expand,r.Imc.title=CommonUIStrings.l_Expand):(r.txg.style.visibility="visible",r.D$a.className=ag.getImageClass(gd.lSk),r.D$a.title=CommonUIStrings.l_Collapse,r.Imc.title=CommonUIStrings.l_Collapse)};this.y8n=r=>{this.mqj(r);return!0};this.z8n=r=>this.Oad(r,this.mqj);this.mqj=r=>{const A=this.Pgd[r.zq.toString()];
A.value?(A.value=0,A.D$a.className=ag.getImageClass(gd.Jbf),A.Ooe.setAttribute(Pe.a.jIa,Pe.a.WO)):(A.value=1,A.D$a.className=ag.getImageClass(gd.MMe),A.Ooe.setAttribute(Pe.a.jIa,Pe.a.qq));this.aFe(r.zq.toString(),A.value.toString())};this.olp=()=>{this.iZ.select()};this.jHc=y.AFrameworkApplication.E6c;this.lHb=b;this.T2e=this.y8n;this.iNc=this.z8n;this.QKe=this.Ual;this.G4b=this.Val;this.sOd=this.olp;this.FCk=h;this.lh=qc.lh;this.Ed=0;this.Pg="EmbedDialog"}get Zu(){return this.U6b}set Zu(b){this.U6b=
b}yVj(b){const h={["id"]:this.Pg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Fa.a.pq(this.lHb,"wdPreview","1"),["initialEmbedUrl"]:this.jHc,["getEmbedCode"]:gd.Cxi,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const r of Object.keys(b))h[r]=b[r];this.Ed=1;this.Qe(1,CommonUIStrings.l_CopyAction);
this.Qe(0,CommonUIStrings.l_Close);this.gi(CommonUIStrings.l_Embed,null,h)}gyc(){if(this.FCk)this.yVj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.t$b=document.getElementById("embedpreviewpane");this.DId=document.getElementById("embedoptionpane");this.t$b.style.width=String.format("{0}px",this.fKk);this.n4a=document.createElement("iframe");this.n4a.className=gd.dKk;this.n4a.frameBorder="0";this.n4a.style.height=String.format("{0}px",this.eKk);this.n4a.tabIndex=-1;this.t$b.appendChild(this.VYd(CommonUIStrings.l_Preview,
this.n4a,gd.rAh,gd.qAh,gd.rAh,!0));this.iZ=document.createElement("textarea");this.iZ.className=gd.evk;Sys.UI.DomElement.addCssClass(this.iZ,md.a.Lhf);this.iZ.id=gd.pgh;X.a.Di||(this.iZ.readOnly=!0);this.iZ.rows=4;this.iZ.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.iZ.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.iZ.setAttribute(Pe.a.Zja,String.format("{0} {1}",gd.ogh,gd.ngh));this.t$b.appendChild(this.VYd(CommonUIStrings.l_EmbedCode,this.iZ,gd.ogh));uf.a.addHandler(this.iZ,
"focus",this.sOd);var b=document.createElement("span");b.className=gd.Ywk;b.innerText=CommonUIStrings.l_CopyText;b.id=gd.ngh;this.t$b.appendChild(b);this.gDb=document.createElement("div");this.gDb.className=gd.luk;this.DId.appendChild(this.VYd(CommonUIStrings.l_Dimensions,this.gDb));this.FGb=document.createElement("div");this.DId.appendChild(this.yFl(gd.byh,this.FGb));this.Ed=0;this.Qe(1,CommonUIStrings.l_Close);this.YLg();this.n9j();X.a.Di||this.iZ.focus()}}dispose(){if(this.Pgd){var b=this.Pgd;
for(const h in b){const r=b[h];this.ur.xc(zd.a.click,r.stc,this.T2e);this.oe.xc(zd.a.kj,r.stc,this.iNc);this.oe.xc(zd.a.hi,r.stc,this.iNc)}this.iNc=this.T2e=this.Pgd=null}if(this.Zxb){for(b=0;b<this.Zxb.length;++b)this.ur.xc(zd.a.click,this.Zxb[b].Imc,this.QKe),this.oe.xc(zd.a.kj,this.Zxb[b].Imc,this.G4b),this.oe.xc(zd.a.rv,this.Zxb[b].Imc,this.G4b),this.oe.xc(zd.a.hi,this.Zxb[b].Imc,this.G4b);this.oe=this.QKe=this.Zxb=null}this.sOd&&this.iZ&&(uf.a.removeHandler(this.iZ,"focus",this.sOd),this.sOd=
null);this.iZ=this.n4a=this.FGb=this.gDb=this.DId=this.t$b=null;super.dispose()}Yga(){super.Yga();this.Oc.style.width=String.format("{0}px",this.RPe);this.vIa()}wyp(b,h){const r=Fa.a.pq(this.jHc,b,h);return this.jHc!==r?(this.jHc=r,this.lHb=Fa.a.pq(this.lHb,b,h),!0):!1}YLg(){this.iZ&&(this.iZ.innerText=gd.Cxi(this.jHc,this.GAd,this.U6b))}n9j(){this.n4a&&this.n4a.contentWindow.location.replace(Fa.a.pq(this.lHb,"wdPreview","1"))}aFe(b,h){this.wyp(b,h)&&(this.YLg(),this.n9j())}VYd(b,h,r=null,A=null,
M=null,ba=!1){const oa=document.createElement("div");oa.className=gd.TMk;A&&(oa.id=A);M&&oa.setAttribute(Pe.a.Zja,M);ba&&(oa.tabIndex=0);A=document.createElement("span");A.className=gd.UMk;A.innerText=b;r&&(A.id=r);oa.appendChild(A);oa.appendChild(h);return oa}yFl(b,h){const r=this.VYd(CommonUIStrings.l_Interaction,h),A=this.Pj.createElement("div");A.className=gd.Rok;A.id=gd.A9g+b;A.setAttribute(Pe.a.Sh,Pe.a.X$);A.tabIndex=0;r.insertBefore(A,h);b=ag.createClusteredImage(16,16,gd.Sok,gd.Tok,!0,"");
A.appendChild(b);b=b.childNodes[0];b.className=ag.getImageClass(gd.Efh);b.title=CommonUIStrings.l_Expand;A.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new Mc(h,A,b);Array.add(this.Zxb,h);this.ur.YI(zd.a.click,A,this.QKe,h);this.oe.YI(zd.a.kj,A,this.G4b,h);this.oe.YI(zd.a.rv,A,this.G4b,h);this.oe.YI(zd.a.hi,A,this.G4b,h);return r}D9h(b,h){const r=document.createElement("div");r.className=gd.Zxh;r.id=b+gd.$xh;var A=this.Pj.createElement("div");A.tabIndex=0;A.className=gd.Rah;A.id=b+
gd.QEc;A.setAttribute(Pe.a.Sh,Pe.a.ujf);A.setAttribute(Pe.a.jIa,Pe.a.qq);A.setAttribute(Pe.a.Zja,b+gd.s6b);r.appendChild(A);r.setAttribute(Pe.a.Sh,Pe.a.FA);var M=ag.createClusteredImage(16,16,gd.Zah,gd.Yah,!0,"");A.appendChild(M);M=M.childNodes[0];M.id=b+gd.ayh;M.className=ag.getImageClass(gd.MMe);A=new Bc(r,M,A,1);this.Pgd[b]=A;this.ur.YI(zd.a.click,r,this.T2e,b);A=document.createElement("span");A.className=gd.s6b;A.innerText=h;A.id=b+gd.s6b;r.appendChild(A);this.oe.YI(zd.a.kj,r,this.iNc,b);this.oe.YI(zd.a.hi,
r,this.iNc,b);return r}static Cxi(b,h,r){if(!gd.A1e){const A=String.format('<a target="_blank" href="{0}">{1}</a>',C.a.ymc("https://office.com"),CommonUIStrings.l_Office),M=String.format('<a target="_blank" href="{0}">{1}</a>',C.a.ymc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);gd.A1e=String.format(CommonUIStrings.l_NoFrames,A,M)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',C.a.ymc(b),h,r,gd.A1e)}}gd.A1e=null;gd.MMe="CheckboxChecked_16x16x32";
gd.Jbf="CheckboxUnchecked_16x16x32";gd.lSk="OutlookSearchChevronUp_16x16x32";gd.Efh="OutlookSearchChevronDown_16x16x32";gd.Zah="CommentChecked";gd.Sok="UpArrowServer";gd.s6b="EmbedDescription";gd.TMk="EmbedSectionHeader";gd.UMk="EmbedSectionName UIFontBold";gd.Ywk="EmbedCodeFooter";gd.Yah="EmbedOptionImage";gd.dKk="EmbedPreviewFrame";gd.evk="EmbedCodeTextArea";gd.Zxh="EmbedOption";gd.luk="EmbedDimensionSection";gd.Tok="EmbedArrowIcon";gd.Rok="WACGlyph EmbedArrowHolder";gd.Rah="EmbedCheckBoxHolder";
gd.$xh="Option";gd.ayh="OptionImage";gd.pgh="EmbedCode";gd.ogh="EmbedCodeHeader";gd.rAh="Preview";gd.qAh="PreviewHeader";gd.byh="Options";gd.A9g="Arrow";gd.QEc="Check";gd.ngh="EmbedCodeFooter";Object(u.a)(gd,"EmbedDialog",ug.a,[]);class ud extends Bc{constructor(b,h,r,A,M){super(b,h,r,A);this.N$a=M}}Object(u.a)(ud,"OptionInputInfo",Bc,[]);class Id extends gd{constructor(b,h){super(b,Id.dO);this.fea=null;this.IGc=[];this.nNd=Object(F.a)(this,this.Wep,"startOnOptionClickHandler");this.Uac=Object(F.a)(this,
this.Xep,"startOnOptionKeyHandler");this.VId=Object(F.a)(this,this.z2n,"onPageNumberChanged");this.cQe=Object(F.a)(this,this.OZn,"onDimensionChanged");this.vJ=h}gyc(){if(Id.dO){var b=Id.oqo,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.vJ.Fvj,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.vJ.qAj,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.vJ.gYj,
["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.vJ.iYj}});this.yVj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.GAd,["defaultHeight"]:this.U6b,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.vJ.Zbk,["heightLabel"]:this.vJ.EOi},["interactionOptions"]:h})}else super.gyc(),this.iNh(this.vJ.Zbk,"EmbedWidthInput",this.GAd),this.iNh(this.vJ.EOi,"EmbedHeightInput",this.U6b),this.FGb.appendChild(this.D9h("wdPrint",this.vJ.Fvj)),this.FGb.appendChild(this.D9h("wdEmbedCode",
this.vJ.qAj)),this.cWk(this.vJ.gYj),this.vIa(),rd.FocusManager.BM()&&(b=rd.FocusManager.instance(),h=[document.getElementById(gd.pgh),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(gd.A9g+gd.byh),document.getElementById("wdPrint"+gd.QEc),document.getElementById("wdEmbedCode"+gd.QEc),document.getElementById("wdStartOn"+gd.QEc),document.getElementById("wdStartOnText"),document.getElementById(nf.a.owd),document.getElementById(gd.qAh)],h=
new Oe(h),b.gu().Tk=h,X.a.Di?this.q4(document.getElementById(nf.a.owd)):this.iZ.select())}dispose(){if(!Id.dO){if(this.IGc){for(let b=0;b<this.IGc.length;++b)uf.a.removeHandler(this.IGc[b],"change",this.cQe);this.IGc=this.cQe=null}this.VId&&(uf.a.removeHandler(this.fea.N$a,"change",this.VId),this.VId=null);this.nNd&&(this.ur.xc(zd.a.click,this.fea.stc,this.nNd),this.nNd=null);this.Uac&&(this.oe.xc(zd.a.kj,this.fea.stc,this.Uac),this.oe.xc(zd.a.hi,this.fea.stc,this.Uac),this.Uac=null);this.fea=null}super.dispose()}iNh(b,
h,r){const A=document.createElement("label");A.className="EmbedInputPrefix";A.innerText=b;this.gDb.appendChild(A);b=document.createElement("input");b.className=h;b.id=h;b.value=r.toString();b.type="text";b.setAttribute("data-lpignore","true");A.setAttribute("for",h);this.gDb.appendChild(b);this.IGc.push(b);uf.a.addHandler(b,"change",this.cQe);this.gDb.appendChild(document.createElement("br"))}OZn(b){"EmbedWidthInput"===b.target.id?this.GAd=this.v1d(b.target,375):this.U6b=this.v1d(b.target,250);this.YLg()}v1d(b,
h){let r=parseInt(b.value);if(isNaN(r)||r<h)r=h;b.value=r.toString();return r}z2n(b){b=this.v1d(b.target,1);1===this.fea.value&&this.aFe("wdStartOn",b.toString())}cWk(b){const h=document.createElement("div");h.className=gd.Zxh+" EmbedInlineOption";h.id="wdStartOn"+gd.$xh;const r=this.Pj.createElement("div");r.tabIndex=0;r.className=gd.Rah;r.id="wdStartOn"+gd.QEc;r.setAttribute(Pe.a.Sh,Pe.a.ujf);r.setAttribute(Pe.a.jIa,Pe.a.WO);r.setAttribute(Pe.a.Zja,"wdStartOn"+gd.s6b);h.appendChild(r);h.setAttribute(Pe.a.Sh,
Pe.a.FA);var A=ag.createClusteredImage(16,16,gd.Zah,gd.Yah,!0,"");r.appendChild(A);A=A.childNodes[0];A.id="wdStartOn"+gd.ayh;A.className=ag.getImageClass(gd.Jbf);const M=document.createElement("span");M.className=gd.s6b;M.innerText=b;M.id="wdStartOn"+gd.s6b;h.appendChild(M);this.FGb.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.vJ.iYj;b.setAttribute("data-lpignore","true");this.FGb.appendChild(b);uf.a.addHandler(b,
"change",this.VId);this.fea=new ud(h,A,r,0,b);this.aFe("wdStartOn","1");this.ur.nb(zd.a.click,h,this.nNd);this.oe.nb(zd.a.kj,h,this.Uac);this.oe.nb(zd.a.hi,h,this.Uac)}Wep(b){this.eYj(b);return!0}Xep(b){return this.Oad(b,Object(F.a)(this,this.eYj,"startOnOptionHandler"))}eYj(){let b=1;this.fea.value?(this.fea.value=0,this.fea.D$a.className=ag.getImageClass(gd.Jbf),this.fea.Ooe.setAttribute(Pe.a.jIa,Pe.a.WO)):(this.fea.value=1,this.fea.D$a.className=ag.getImageClass(gd.MMe),b=this.v1d(this.fea.N$a,
1),this.fea.Ooe.setAttribute(Pe.a.jIa,Pe.a.qq));this.aFe("wdStartOn",b.toString())}static get dO(){return y.AFrameworkApplication.ta.Hb.sH}static oqo(b,h,r,A=null){if("wdPrint"===h||"wdEmbedCode"===h)return Fa.a.pq(b,h,r?"1":"0");if("wdStartOn"===h){let M="1";r&&A&&(A=parseInt(A),!isNaN(A)&&1<=A&&(M=A.toString()));return Fa.a.pq(b,h,r?M:"1")}return b}}Object(u.a)(Id,"WordEmbedDialog",gd,[]);class Je{constructor(b,h,r,A,M){this.Uia=null;this.ga=b;this.Xib=h;this.XS=r;this.vJ=A;this.qia=M}Wb(){this.ga.qa(this.XS,
xe.a.frame,Object(F.a)(this,this.d9o,"showEmbedCode"));this.Xib.execute(Object(F.a)(this,this.Efg,"onHostPostmessengerCreated"))}Efg(b){v.ULS.shipAssertTag(4994850,332,!!b);this.Uia=b;y.AFrameworkApplication.cga||(this.Uia.Gv(K.a.u_h),this.Uia.XE(K.a.u_h,Object(F.a)(this,this.gyc,"showEmbedDialog")))}gyc(b){b=b.Values.HostEmbeddedViewUrl.toString();y.AFrameworkApplication.E6c=b;this.qia.lAf=b;(new Id(b,this.vJ)).gyc()}d9o(b,h,r){if(2===r)if(y.AFrameworkApplication.E6c)(new Id(this.qia.lAf,this.vJ)).gyc();
else return y.AFrameworkApplication.En.H$a(Je.Pfk),y.AFrameworkApplication.xNg&&this.Uia.sendMessage(K.a.l8l,null)?32:y.AFrameworkApplication.ta.ZX(!0,y.AFrameworkApplication.iDf);return 32}}Je.Pfk=10381;Object(u.a)(Je,"EmbedActor",null,[]);class re{}Object(u.a)(re,"WordEmbedDialogStrings",null,[]);var Od=d(230);class Se extends Je{constructor(b,h){super(b,h,Hc.a.uDg,Object.assign(new re,{Zbk:WordEditorIntl.WordEditorStrings.l_Width,EOi:WordEditorIntl.WordEditorStrings.l_Height,Fvj:WordEditorIntl.WordEditorStrings.l_PrintOption,
qAj:WordEditorIntl.WordEditorStrings.l_ReembedOption,gYj:WordEditorIntl.WordEditorStrings.l_StartOnOption,iYj:WordEditorIntl.WordEditorStrings.l_StartPage}),Od.WoncaApp.instance)}}Object(u.a)(Se,"EmbedActor",Je,[]);class pf{constructor(){this.Z=null}get name(){return"WordEditor.Embed"}uc(b){this.Z=b;b.ia(869,()=>new Se(y.AFrameworkApplication.va,b.Ra(7))).ha()}init(){this.Z.resolve(869).Wb()}dispose(){}}Object(u.a)(pf,"EmbedPackage",null,[0,1]);class Af{constructor(b,h,r){this.px=this.QQa=this.$Sa=
null;this.GQa=0;this.B8b=this.u8b=this.h8b=this.J8b=this.M2a=this.L2a=!1;this.Ik=b;this.io=r}$R(b){return qa.StaticActiveAppFrame.za().kb.isEditingAllowed?""!==this.y3c(b.Ef):!1}SN(b){if(!this.$R(b))return!1;this.QUo(b);this.RUo();this.SUo();this.$Sa=b.tK;this.px=new Sys.UI.Point(0,0);v.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}$X(b){this.QQa=b.tK;this.ukl();this.Ik.f8j(this.px.x,this.px.y,this.J8b,this.h8b,this.u8b,this.B8b,!1);return!0}$F(){this.Ik.f8j(this.px.x,this.px.y,
this.J8b,this.h8b,this.u8b,this.B8b,!0);v.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}A0(){this.Ik.rnl();v.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}RUo(){this.B8b=this.u8b=this.h8b=this.J8b=!1;switch(this.GQa){case 1:this.J8b=!0;break;case 5:this.h8b=!0;break;case 3:this.B8b=!0;break;case 7:this.u8b=!0;break;case 0:this.u8b=this.J8b=!0;break;case 2:this.B8b=this.J8b=!0;break;case 6:this.u8b=this.h8b=!0;break;case 4:this.B8b=this.h8b=!0}}SUo(){this.M2a=this.L2a=
!1;switch(this.GQa){case 0:this.M2a=this.L2a=!0;break;case 1:case 2:this.M2a=!0;break;case 7:case 6:this.L2a=!0}}y3c(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==r)return r}return""}QUo(b){switch(this.y3c(b.Ef)){case "WACImageCropHandleNW":this.GQa=0;break;case "WACImageCropHandleN":this.GQa=1;break;case "WACImageCropHandleNE":this.GQa=
2;break;case "WACImageCropHandleE":this.GQa=3;break;case "WACImageCropHandleSE":this.GQa=4;break;case "WACImageCropHandleS":this.GQa=5;break;case "WACImageCropHandleSW":this.GQa=6;break;case "WACImageCropHandleW":this.GQa=7}}ukl(){var b=1;this.io.instance&&(b=this.io.instance.Cj);const h=(this.QQa.x-this.$Sa.x)/b;b=(this.QQa.y-this.$Sa.y)/b;this.px.x=this.L2a?-h:h;this.px.y=this.M2a?-b:b}}Object(u.a)(Af,"ImageCropDragAdapter",null,[96]);class cg{constructor(b,h){this.ga=b;this.io=h}Vwm(b){return new Af(b,
this.ga,this.io)}}Object(u.a)(cg,"ImageCropDragAdapterFactory",null,[592]);var ph=d(305),Lg=d(236),le=d(32),Th=d(409),eg=d(703),Uf=d(81),Ff=d(61),Zg=d(184),hl=d(477),ym=d(886),Al=d(525),Xj=d(907),cm=d(138),so=d(363),Bl=d(750),aj=d(644),to=d(203),Lj=d(78),bi=d(15),qq=d(255),ov=d(779),Mp=d(376),sn=d(118);class Im{constructor(b,h,r,A,M,ba,oa,Ja){this.i8c=null;this.sT=b;this.Rh=h;this.Qc=r;this.Dv=A;this.Qd=M;this.ib=ba;this.ao=oa;this.JG=Ja}get i_(){return null!=this.VTg?this.VTg:this.VTg=$a.a.instance.resolve(394)}get Xb(){return null!=
this.x7g?this.x7g:this.x7g=$a.a.instance.resolve(8)}get rj(){return cm.PageReader.instance}gXo(b,h,r){const A=this.Qc.Lc(15);A.Ab(h.node);this.D_a(b,r);A.dispose()}fXo(b,h,r){const A=this.Qc.Lc(15);A.Ab(h.node);this.U_b(b,r);A.dispose()}D_a(b,h){b.setValue(ze.a.imageAltText,h)}U_b(b,h){b.setValue(Rc.a.a0,h)}nXo(b,h){b.setValue(ze.a.hsb,h)}KOj(b,h){if(Object(Zg.d)(b)){const r=b.ka(le.a.Jle,null);h=ov.a.DJl(h,r);b.setValue(le.a.Jle,h)}else b.setValue(Rc.a.b0,h)}jXo(b,h,r,A,M){let ba=0;var oa=0;({width:ba,
height:oa}=je.a.C9a(b));oa-=(h+r)/1E5*oa;this.cOa(b,ba-(A+M)/1E5*ba);this.bOa(b,oa);this.$Oj(b);b.setValue(Rc.a.Yae,h);b.setValue(Rc.a.Vae,r);b.setValue(Rc.a.Wae,A);b.setValue(Rc.a.Xae,M)}k0o(b,h,r,A){const M=this.Qc.Lc(15);M.Ab(h.node);this.mxe(b,r,A);M.dispose()}mxe(b,h,r){this.cOa(b,h);this.bOa(b,r);this.$Oj(b);b.removeProperty(Bd.a.kqe);b.removeProperty(Bd.a.jqe)}cOa(b,h){b.setValue(ze.a.Tta,h);b.setValue(Bd.a.cLa,-1)}bOa(b,h){b.setValue(ze.a.Sta,h);b.setValue(Bd.a.bLa,-1)}HH(b,h){b.setValue(Rc.a.pmc,
h);b.setValue(ze.a.si,h);b.setValue(ze.a.Ds,h)}Z0o(b,h){b.setValue(Rc.a.Xzb,h)}STo(b,h){b.setValue(Rc.a.zTd,h)}d1o(b){if(!je.a.K7(b)&&b.Cl){var h=b.node;if(je.a.kba(h)){const M=this.Qc.Lc(15);M.Ab(b.node);b=zc.a.Za(h);b.vb(12);b=b.parentNode;var r=b.properties.wf(Rc.a.Mq),A=h.properties.getValue(Rc.a.runId);h.ka(Rc.a.Zc,Bm.a.MV);const ba=b.ra;if(!y.AFrameworkApplication.J||!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveAnchoredProperties",!1)){const oa=[Rc.a.pmc,
ze.a.si,ze.a.Ds,Rc.a.zTd,Rc.a.Xzb,Rc.a.JTa];Object(Zg.d)(h)&&oa.push(le.a.o$d,le.a.n$d);h.Vf.apply(h,oa)}r=this.KIf(A,r,ba);A=vc.a.Tc(b,r);this.Dv.N7h(h,A);(h=this.JG.rL(b,r,r+1))&&this.ib.Kc(h);this.i_.uva(b,r,r+1);M.dispose()}}}Wyg(b,h){if(b.properties.hasProperty(Rc.a.t6)){const r=b.properties.wf(Rc.a.t6);r.push(h);b.properties.setValue(Rc.a.t6,Array.clone(r))}else b.properties.setValue(Rc.a.t6,[h])}yye(b,h,r=0,A=!1){if(b.Cl){var M=this.Qc.Lc(15),ba=b.node;M.Ab(ba);if(je.a.K7(b)){const zb=Object(Zg.c)()?
new Xj.a:new Al.a;zb.At(je.a.Tn(b));var oa=ba.ra,Ja=this.c$l(b.cpBegin,oa);this.eal(b.cpEnd,oa,Ja)&&v.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");oa=oa.K(Ja).blob;Ja=oa.te;var jb=ba.properties.wf(Rc.a.Mq);jb=this.Opo(jb);Ja=jb[Ja];jb=ba.ka(Rc.a.Zc,Bm.a.MV);if(oa=Object(Ma.a)(ym.a,oa))oa.C0b=!1;this.Qd.Ue(b,"");oa&&(oa.C0b=!0);zb.properties.setValue(Rc.a.runId,Ja);zb.properties.setValue(Rc.a.Zc,jb);b=zc.a.Za(ba);b.vb(12);b.Wf(zb,6);this.Wyg(b.currentNode,zb.anchor.node.id);
ba=zb}r&&this.HH(ba.properties,r);this.STo(ba.properties,A);this.Z0o(ba.properties,h);this.i_.hxc(ba);(h=this.JG.Ir(ba))&&this.ib.Kc(h);M.dispose()}}Ywg(b,h){if(!(0>=h)){var r=Rh.a.zn(h,0),A=je.a.cC(b),M=je.a.nD(b);A>r&&(M*=r/A,this.cOa(b,r),this.bOa(b,M),v.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",h))}}eal(b,h,r){const A=h.length;if(r>=A||!h.K(r).mf)return!1;const M=new Xo.a;for(;r<A;r++){const ba=h.K(r);if(ba.cp>b||!ba.mf)break;for(let oa=0;oa<
ba.mf.length;oa++){if(M.contains(ba.mf.K(oa).pk))return!0;M.add(ba.mf.K(oa).pk)}}return!1}Opo(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var r=0;r<b.length;)b[r]=r+1,r++;else{var A=b[h];r=h-1;for(var M=A-1;0<=r;)b[r]=M,r--,M--;M=0;for(r=h+1;r<b.length;)(h=b[r])?h<A?(A=h+M,b[r]=A):A=h:(M+=2,A++,b[r]=A),r++}return b}TDf(b,h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}KIf(b,h,r){let A=0;const M=this.TDf(b,h);let ba=0;if(M===h.length)ba=r.length-1;else for(;ba<r.length;){h=r.K(ba);
if(h.formatting&&h.formatting.te===M)break;ba++}ba<r.length?A=r.K(ba).cp:v.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ba,["RunId"]:b,["CharacterPropertiesArrayLength"]:r.length});return A}c$l(b,h){let r=0;for(;r<h.length&&h.K(r).cp!==b;)r++;r===h.length&&v.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{["Index"]:r,["CharacterPropertiesArrayLength"]:h.length});return r}$Oj(b){b.setValue(ze.a.bCa,!0)}Kqe(b,
h,r,A=!1){h&&r?(h=Math.max(h,eg.a.zej),r=Math.max(r,eg.a.zej)):r=h=eg.a.rdi;b.setValue(ze.a.Tta,Rh.a.zn(h,0));b.setValue(ze.a.Sta,Rh.a.zn(r,1));b.setValue(ze.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(Yf.a.c0,wb.a.vPa);b.setValue(Rc.a.ema,A)}bce(){return null}jhi(b,h,r){let A=null;h=({mWb:A}=this.khi(b,h,r)).returnValue;A&&b.view.lb.Kc(A);return h}khi(b,h,r){var A=null;if(!this.hka(b))return{returnValue:null,mWb:A};var M=b.view;const ba=this.Qc.Lc(15,ub.a.BSb);ba.Ab(M.qd);
h||(h=new ji.DictionaryPropertySet);h.setValue(Bd.a.jZl,!0);let oa=M.lb.Ng;var Ja=new aj.a;if(!Le.a.qf(oa)){if(2===y.AFrameworkApplication.va.Ob(ub.a.Qra,2))return ba.dispose(),{returnValue:null,mWb:A};oa=M.lb.Ng}else if(oa.Cl&&Ed.ParagraphReader.Vb(oa.node)){Jf.a.vd().wn&&Jf.a.vd().Fk.NG(oa.node);M=xa.FormattingReader.Us(oa);if(!M)return ba.dispose(),{returnValue:null,mWb:A};M.cache.DE&&(M=M.Mf(null),Im.xj.z8(M));Ja.formatting=M.Lk;Ja.languageId=xa.FormattingReader.language(M);Ja.uoa=this.Xb.Hq(oa.node)}if(!oa.Cl)return ba.dispose(),
{returnValue:null,mWb:A};if(!this.nWf(b.Ok,h))return ba.dispose(),this.i8c=null,{returnValue:null,mWb:A};b=this.i8c;this.i8c=null;1===b.location?(A=b.node,h=Mp.a.instance.CPf(A),Ab.OutlineElementNavigator.at(h,!1,!1)||(to.OutlineNavigator.tve(h),this.sT.Vja(h,!0,Ja)),Ab.OutlineElementNavigator.Me(h),Hi.TableReader.isTable(h)&&(Object(Za.a)(sn.a,h)||Object(Za.a)(so.a,h)?(Ja=new zc.a,Ja.set(h.currentNode),bi.moveToCellContent(Ja,0,0),h.set(Ja.currentNode)):bi.moveToCellContent(h,0,0),Ua.a.Qh(h)?Ab.OutlineElementNavigator.Me(h):
h=Mp.a.instance.CPf(A)),A=Ed.ParagraphReader.Au(h.currentNode)?this.JG.ve(h.currentNode,0):this.JG.Ir(h.currentNode)):b.location||(Ja=b.blob.Jb.cp+1,A=this.JG.rL(b.node,Ja-1,Ja));ba.iMa(r,1);ba.Ei=ub.a.BSb;ba.dispose();return{returnValue:b,mWb:A}}nWf(){return!1}hka(b){b.contextId===mc.a.view&&b.view.ue&&b.view.lb&&(b=b.view.lb.Ng);if(!b)return Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.Wn}),!1;if(Im.sg.F2(b))return Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.$G}),!1;if(Im.sg.gma(b))return Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.QSi}),
!1;if(this.ao&&this.ao.instance&&this.ao.instance.KX(b))return Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.C8a}),!1;if(this.rj.E7)return Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.compatMode}),!1;if(b.Cl)return Lj.OutlineReader.cfe(b)?(Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.Irf}),!1):je.a.aee(b)?(Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.Arf}),!1):qq.c(b)?(Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.Brf}),!1):Bl.a.lZf(b)?(Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.zrf}),!1):Ed.ParagraphReader.IX(b)||je.a.ogn(b)?(Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.cR}),
!1):!0;if(hl.a.B_f(b)){let h=!0;for(let r=0;r<b.length;++r){const A=b.getContext(r);if(!A.Cl)return!1;h&&!Ed.ParagraphReader.IX(A)&&(h=!1)}return h?(Im.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.cR}),!1):!0}return!1}oDj(b,h){const r=this.Qc.Lc(7);r.Ab(b);if(12===b.type){h=h.Jb.cp;var A=Ed.ParagraphReader.textLength(b);A=vc.a.hU(h,h+1,h+1===A?!0:!1,b);this.Qd.Ue(A,"");b=vc.a.Tc(b,h);this.ib.Kc(sc.SelectionFactory.Yo(b))}else this.Rh.JDa(b);r.dispose()}static get xj(){return null!=Im.FXg?Im.FXg:Im.FXg=$a.a.instance.resolve(101)}static get sg(){return ve.a.instance}static get Bc(){return Wg.a.instance}}
Object(u.a)(Im,"ImageEditor",null,[591]);class Iu{constructor(b,h,r,A=0){this.node=b;this.blob=h;this.location=r;this.BX=A}}Object(u.a)(Iu,"InsertPictureResult",null,[]);var mj=d(829),Ls=d(283),uo=d(562),An=d(110),pr=d(516),qk;(function(b){b[b.other=0]="other";b[b.Dtj=1]="picture"})(qk||(qk={}));Object(u.b)("ImageType",qk);var Wt=d(1131);class Rk extends Im{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){var Dc,Zc;super(b,h,r,A,M,ba,oa,Ja);this.ltk="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");
this.Khb="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");this.KM=this.xRa=this.VFa=null;this.Uoa=Array(8);this.uDd=this.sGa=null;this.yRa=!1;this.tDd=this.AVe=null;this.$yd=this.kAd=!1;this.oW=this.nW=this.mW=this.pW=this.dZ=this.cZ=this.bZ=this.eZ=this.yZ=this.zZ=0;this.HP=()=>{this.yRa&&
this.IAf()};this.PCa=Gd=>{this.yRa&&Gd.Nb.keyCode!==rf.a.Tu&&this.IAf(!0);return!1};this.jmh=nc;ba.BA(this.HP);this.oe=Sb;this.z5=ph.a.instance;this.ga=y.AFrameworkApplication.va;this.Xd=zb;this.oq=jb;this.wXf=null!==(Zc=null===(Dc=y.AFrameworkApplication.J)||void 0===Dc?void 0:Dc.getBooleanFeatureGate("Microsoft.Office.WordOnline.AppendSpacersToDataUrlForSafari",!1))&&void 0!==Zc?Zc:!1}Exe(b,h,r,A,M){b.hasProperty(Bd.a.gYa)&&b.removeProperty(Bd.a.gYa);const ba=Array(4);ba[An.a.left]=h;ba[An.a.right]=
r;ba[An.a.top]=A;ba[An.a.bottom]=M;b.setValue(Rc.a.Uga,ba)}HAo(b){b.setValue(Rc.a.eLa,pr.a.Gcg);b.setValue(Rc.a.PXb,"");this.Exe(b,0,0,0,0)}Qzg(b,h,r,A,M){b.setValue(Rc.a.Yae,h);b.setValue(Rc.a.Vae,r);b.setValue(Rc.a.Wae,A);b.setValue(Rc.a.Xae,M)}Gxe(b,h,r,A){b.setValue(Rc.a.CX,h);b.setValue(Rc.a.ASf,r);b.setValue(Rc.a.XSf,A);b.setValue(Bd.a.CX,-1)}$be(b,h){b=b.node;const r=zc.a.Za(b);if(Ed.ParagraphReader.Vb(b)&&Ed.ParagraphReader.isEmpty(r)){var A=b.properties.wf(Rc.a.Zc);h.setValue(Rc.a.Zc,A);
h.setValue(Rc.a.runId,1);A=new Wt.a;h&&A.At(h);r.Wf(A,6);this.Wyg(b,A.anchor.node.id);this.i_.hxc(A);return new Iu(A,null,3)}return null}bce(b,h){var r=mj.a.instance.zvd;h&&r.At(h);r.setValue(Rc.a.imageType,qk.Dtj);let A=0;A=Lg.a.gG();r.setValue(Rc.a.BX,A);const M=b.node.Ic.nu(r,r.id);r=this.Qd.Tla(b,ba=>new ym.a(ba,M));Ls.a.instance.mfg(b.node);if(this.Xd.Ag){const ba=new Qb.GraphTransaction(15);ba.Ab(b.node);this.oq.Hna(b.node,b.cpBegin,b.cpBegin+1,1,null);ba.dispose()}this.i_.bUa&&!h.ka(Rc.a.ema,
!1)&&this.i_.uva(b.node,b.cpBegin,b.cpBegin+1);return new Iu(b.node,r,0,A)}nWf(b,h){if(!this.hka(b))return!1;const r=this.Qc.Lc(7);r.Ab(b.node);y.AFrameworkApplication.J.$("ContentAppIsEnabled")&&h.ka(Rc.a.fVi,!1)?this.i8c=this.$be(b,h):this.i8c=this.bce(b,h);r.dispose();return!0}Avc(b,h,r,A){if(!r.Vb(b))return!1;r=this.Qc.Lc(7,ub.a.QUm);r.Ab(b);var M=b.properties.ka(ze.a.Dn,[]);M.push(0);for(const ba of M)if((M=A.vHf(b,ba))&&5===M.$h&&M.id.equals(h))return this.Qd.Ue(vc.a.createTextRange(b,ba,ba+
1),""),r.dispose(),!0;r.dispose();v.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}Vzo(b,h,r,A){if(!je.a.kba(b))return!1;h.set(b);h.vb(12);const M=h.Fp(12);if(!M)return v.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(r.p$c(M))return v.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),
!1;A(b);r=this.Qc.Lc(7);r.Ab(b);h.Tg();r.dispose();return!0}XFo(b,h,r,A){return je.a.bab(b)?this.KFo(b,r):je.a.K7(b)?this.aGo(b,h,r,A):null}aGo(b,h,r,A){const M=mj.a.instance.zvd;r&&M.At(r);r=0;r=Lg.a.gG();M.setValue(Rc.a.BX,r);r=b.node.Ic;b=b.node;A=A.j2c(b,5);for(const ba of A)if(ba.id.equals(h)){this.Qd.Ue(vc.a.createTextRange(b,ba.Jb.cp,ba.Jb.cp+1),"");const oa=r.nu(M,M.id);h=vc.a.Tc(b,ba.Jb.cp);this.Qd.Tla(h,Ja=>new ym.a(Ja,oa));return M}return null}KFo(b,h){if(!je.a.bab(b))return null;h.setValue(Rc.a.BX,
Lg.a.gG());b=b.node;var r=b.anchor.node.id;b=zc.a.Za(b);b.vb(12);const A=b.parentNode;let M;A.properties.hasProperty(Rc.a.t6)?(M=A.properties.wf(Rc.a.t6),r=P.a.indexOf(M,r),-1!==r&&Array.removeAt(M,r)):M=[];A.properties.setValue(Rc.a.t6,Array.clone(M));b.Tg();r=Object(Zg.c)()?new Xj.a:new Al.a;r.At(h);b.Wf(r,6);this.Wyg(A,r.anchor.node.id);return r}Rrd(b,h){this.yRa?this.IAf():this.zep(b,h)}pXo(b,h){b.setValue(Bd.a.CX,h)}Zwm(b){let h=null,r=null;if(!b)return v.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),
{returnValue:null,view:h,Gj:r};if(!Object(Jb.a)().Ad)return v.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,Gj:r};const A=b.node;if(!A)return v.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:h,Gj:r};r=A.Ic;var M=Object(Jb.a)().Ad.sc;M=A.Ce(M);if(!M)return v.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),
{returnValue:null,view:h,Gj:r};h=M.Jh;if(b.Cl&&je.a.K7(b)){b=je.a.AKa(b);if(!b)return v.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,Gj:r};b=b.aBa(h,M);if(!b)return v.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,Gj:r};b=b.element}else if(je.a.Lt(A))b=M.htmlElement;else return v.ULS.sendTraceTag(22381059,
322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,Gj:r};return{returnValue:b,view:h,Gj:r}}C2o(b){for(let A=0;A<this.Uoa.length;A++){this.Uoa[A]=b.wl(io.a.span);this.Uoa[A].className="WACImageCropHandles "+this.ltk[A];if(2>=A){var h=b.wl(io.a.span);h.className=this.Khb[0];var r=b.wl(io.a.span);r.className=this.Khb[1];this.Uoa[A].appendChild(h);this.Uoa[A].appendChild(r)}else 4<A&&(h=b.wl(io.a.span),h.className=this.Khb[2],
r=b.wl(io.a.span),r.className=this.Khb[3],this.Uoa[A].appendChild(h),this.Uoa[A].appendChild(r));if(!A||3===A||5===A)h=b.wl(io.a.span),h.className=this.Khb[4],r=b.wl(io.a.span),r.className=this.Khb[5],this.Uoa[A].appendChild(h),this.Uoa[A].appendChild(r);else if(2===A||4===A||7===A)h=b.wl(io.a.span),h.className=this.Khb[6],r=b.wl(io.a.span),r.className=this.Khb[7],this.Uoa[A].appendChild(h),this.Uoa[A].appendChild(r)}}zep(b,h){v.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.yRa)v.ULS.sendTraceTag(22381061,
322,100,"Attempted to start Crop Mode when it was already On.");else{var r=null,A=null;if((this.sGa=({view:r,Gj:A}=this.Zwm(h)).returnValue)&&r){this.sGa.classList.add("ImageCropMode");this.VFa=r.wl(io.a.div);this.VFa.className="WACImageCropMode";this.xRa=r.wl(io.a.rsb);this.xRa.className="WACImageCropBase";this.KM=r.wl(io.a.span);this.KM.className="WACImageCropSrcRect";this.C2o(r);this.VFa.appendChild(this.KM);for(r=0;r<this.Uoa.length;r++)this.KM.appendChild(this.Uoa[r]);this.VFa.appendChild(this.xRa);
this.xRa.style.visibility="";this.xRa.style.display="";this.sGa.appendChild(this.VFa);this.Gfo(b);A=je.a.$Aa(b,A);r=je.a.m9(b,Bd.a.o8,null);this.xRa.src=r?this.wXf&&X.a.Fta?Object(uo.a)(r):r:je.a.E9a(A);this.jmh&&this.jmh.execute(M=>{this.uDd||(this.uDd=M.Vwm(this))});this.kAd||(this.z5.uS(this.sGa,this.uDd),this.kAd=!0);this.oe&&this.oe.nb(zd.a.jL,Object(Jb.a)().Ke.editingElement,this.PCa);this.yRa=!0;this.AVe=b;this.tDd=h;this.$yd=!1;b=new Qb.GraphTransaction(4);b.Ab(this.tDd.node);this.AVe.setValue(Bd.a.WBa,
this.yRa);b.dispose()}else v.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}Gfo(b){const h=Rh.a.xf(je.a.cC(b),0),r=Rh.a.xf(je.a.nD(b),1);var A=je.a.yfa(b);const M=Math.max(A.top,0),ba=Math.max(A.bottom,0),oa=Math.max(A.left,0);A=Math.max(A.right,0);this.zZ=1E5*h/(1E5-(oa+A));this.yZ=1E5*r/(1E5-(M+ba));this.eZ=Math.floor(M*this.yZ/1E5);this.bZ=Math.floor(ba*this.yZ/1E5);this.cZ=Math.floor(oa*this.zZ/1E5);this.dZ=Math.floor(A*
this.zZ/1E5);this.KM.style.top=this.eZ+"px";this.KM.style.bottom=this.bZ+"px";this.KM.style.left=this.cZ+"px";this.KM.style.right=this.dZ+"px";this.xRa.style.width=this.zZ+"px";this.xRa.style.height=this.yZ+"px";je.a.aA(b)&&(this.VFa.style.width=this.zZ+"px",this.VFa.style.height=this.yZ+"px");this.pW=this.eZ;this.mW=this.bZ;this.nW=this.cZ;this.oW=this.dZ}IAf(b=!1){v.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.yRa?(b||this.hyl(),this.xRa?xd.a.yF(this.xRa):v.ULS.sendTraceTag(23961793,
322,15,"Unable to clear imageCropBase dom element because it was already null."),this.sGa?(this.VFa?this.VFa.parentNode===this.sGa?this.sGa.removeChild(this.VFa):v.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):v.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.sGa.classList.remove("ImageCropMode"),this.yRa=!1,b=new Qb.GraphTransaction(4),b.Ab(this.tDd.node),
this.AVe.setValue(Bd.a.WBa,this.yRa),b.dispose(),this.kAd&&(this.z5.NS(this.sGa,this.uDd),this.kAd=!1),this.oe&&this.oe.xc(zd.a.jL,Object(Jb.a)().Ke.editingElement,this.PCa),this.sGa=this.VFa=null):v.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):v.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}f8j(b,h,r,A,M,ba,oa){if(r){r=Math.max(this.eZ-h,0);const Ja=Math.floor(this.yZ)-
this.bZ-r;5<=Ja?(this.pW=r,this.mW=this.bZ):5>Ja&&0<=Ja||0>Ja&&!this.bZ?(this.pW=r-(5-Ja),this.mW=this.bZ):0>Ja&&5>=Math.abs(Ja)?(this.pW=Math.floor(this.yZ)-this.bZ,this.mW=Math.max(this.bZ-(r-(this.yZ-this.bZ))-(5-Math.abs(Ja)),0)):(this.pW=Math.floor(this.yZ)-this.bZ,this.mW=Math.max(this.bZ-(r-(this.yZ-this.bZ)),0));this.KM.style.top=this.pW+"px";this.KM.style.bottom=this.mW+"px";oa&&(this.eZ=this.pW,this.bZ=this.mW)}A&&(h=Math.max(this.bZ-h,0),A=Math.floor(this.yZ)-this.eZ-h,5<=A?(this.mW=h,
this.pW=this.eZ):5>A&&0<=A||0>A&&!this.eZ?(this.mW=h-(5-A),this.pW=this.eZ):0>A&&5>=Math.abs(A)?(this.mW=Math.floor(this.yZ)-this.eZ,this.pW=Math.max(this.eZ-(h-(this.yZ-this.eZ))-(5-Math.abs(A)),0)):(this.mW=Math.floor(this.yZ)-this.eZ,this.pW=Math.max(this.eZ-(h-(this.yZ-this.eZ)),0)),this.KM.style.top=this.pW+"px",this.KM.style.bottom=this.mW+"px",oa&&(this.eZ=this.pW,this.bZ=this.mW));M&&(M=Math.max(this.cZ-b,0),h=Math.floor(this.zZ)-this.dZ-M,5<=h?(this.nW=M,this.oW=this.dZ):5>h&&0<=h||0>h&&
!this.dZ?(this.nW=M-(5-h),this.oW=this.dZ):0>h&&5>=Math.abs(h)?(this.nW=Math.floor(this.zZ)-this.dZ,this.oW=Math.max(this.dZ-(M-(this.zZ-this.dZ))-(5-Math.abs(h)),0)):(this.nW=Math.floor(this.zZ)-this.dZ,this.oW=Math.max(this.dZ-(M-(this.zZ-this.dZ)),0)),this.KM.style.left=this.nW+"px",this.KM.style.right=this.oW+"px",oa&&(this.cZ=this.nW,this.dZ=this.oW));ba&&(b=Math.max(this.dZ-b,0),ba=Math.floor(this.zZ)-this.cZ-b,5<=ba?(this.oW=b,this.nW=this.cZ):5>ba&&0<=ba||0>ba&&!this.cZ?(this.oW=b-(5-ba),
this.nW=this.cZ):0>ba&&5>=Math.abs(ba)?(this.oW=Math.floor(this.zZ)-this.cZ,this.nW=Math.max(this.cZ-(b-(this.zZ-this.cZ))-(5-Math.abs(ba)),0)):(this.oW=Math.floor(this.zZ)-this.cZ,this.nW=Math.max(this.cZ-(b-(this.zZ-this.cZ)),0)),this.KM.style.left=this.nW+"px",this.KM.style.right=this.oW+"px",oa&&(this.cZ=this.nW,this.dZ=this.oW));oa&&(this.$yd=!0,qa.StaticActiveAppFrame.za().Fe())}rnl(){this.pW=this.eZ;this.mW=this.bZ;this.nW=this.cZ;this.oW=this.dZ;this.KM.style.top=this.pW+"px";this.KM.style.bottom=
this.mW+"px";this.KM.style.left=this.nW+"px";this.KM.style.right=this.oW+"px"}hyl(){if(this.$yd){v.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.eZ/this.yZ),h=Math.floor(1E5*this.bZ/this.yZ),r=Math.floor(1E5*this.cZ/this.zZ),A=Math.floor(1E5*this.dZ/this.zZ),M=new ji.DictionaryPropertySet;M.setValue(Bd.a.qsb,b);M.setValue(Bd.a.nsb,h);M.setValue(Bd.a.osb,r);M.setValue(Bd.a.psb,A);this.ga.Pf(this.tDd,Hc.a.iQi,2,!1,null,M)}else v.ULS.sendTraceTag(23070481,
322,50,"No New Cropping Properties To Commit.")}WBa(){return this.yRa}Fpm(){return{top:this.pW,bottom:this.mW,left:this.nW,right:this.oW}}Fzp(b,h){if(0>b)v.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.eZ=this.pW=Math.min(Math.floor(this.yZ)-this.mW-5,b);this.KM.style.top=this.pW+"px";break;case 1:this.bZ=this.mW=Math.min(Math.floor(this.yZ)-this.pW-5,b);this.KM.style.bottom=this.mW+"px";break;case 2:this.cZ=this.nW=Math.min(Math.floor(this.zZ)-
this.oW-5,b);this.KM.style.left=this.nW+"px";break;case 3:this.dZ=this.oW=Math.min(Math.floor(this.zZ)-this.nW-5,b),this.KM.style.right=this.oW+"px"}this.$yd=!0}}}Object(u.a)(Rk,"ImageEditor",Im,[590,591]);class hs{constructor(){this.Z=null}get name(){return"WordEditor.ImageEditors"}uc(b){this.Z=b;this.Z.ia("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new cg(y.AFrameworkApplication.va,$a.a.instance.Ra(6))).as(871).ha();this.Z.ia("WordEditor.ImageEditors.ImageEditor",()=>new Rk(b.resolve(110),
b.resolve(16),b.resolve(42),b.resolve(349),b.resolve(323),b.resolve(327),b.Ra(51),b.resolve(870),b.resolve(39).instance,b.resolve(46).instance,b.resolve(394),kc.KeyInputManager.instance,b.Ra(871))).as(1022).as(822).ha()}init(){this.Z.resolve(871)}dispose(){}static main(){E.a.instance.Mc(new hs)}}Object(u.a)(hs,"WordEditorImageEditorsPackage",null,[0,1]);class pv{}Object(u.a)(pv,"FolderContentEditor",null,[1452]);class rq{}Object(u.a)(rq,"PageEditor",null,[1599]);class vo extends rq{constructor(){super()}}
Object(u.a)(vo,"PageEditor",rq,[]);class Tv{get name(){return"WordEditor.NotebookLevelEditors"}uc(b){b.ia("Box4.NotebookLevelEditors.FolderContentEditor",()=>new pv).as("Box4.Folder.IFolderContentEditor").ha();b.ia("WordEditor.NotebookLevelEditors.PageEditor",()=>new vo).as(395).ha()}init(){}dispose(){}static main(){E.a.instance.Mc(new Tv)}}Object(u.a)(Tv,"WordEditorNotebookLevelEditorsPackage",null,[0,1]);class Bt{get mYb(){return y.AFrameworkApplication.privacyUrl}wza(){v.ULS.sendTraceTag(37034014,
342,50,"User clicked on the Privacy statement.");Te.a.Cn(this.mYb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(u.a)(Bt,"PrivacyLinkHandler",null,[107]);class Gq{constructor(b,h){this.m2e=null;this.lNk=b;this.kNk=h}showDialog(b){this.m2e=b;this.kNk.create().gi(Object(F.a)(this,this.sWm,"handleDialog"))}sWm(b){1===b&&this.lNk.oMj();this.m2e();this.m2e.prototype}}Object(u.a)(Gq,"SendUsYourFileController",null,[86]);class qr extends kh.StandardDialog{constructor(b,h,r){super();
this.y$b=null;this.Fg=b;this.hOc=h;this.vJ=r}gi(b){this.Ed=1;this.Qe(1,this.vJ.send);this.Qe(0,this.vJ.tTn);v.ULS.shipAssertTag(37034013,342,!this.y$b,"privacy anchor should be null before initializing it.");const h=this.dialogContent();this.evb(this.vJ.E7k,null,"CancelRequest_32x32x32",null,b,h);this.H8(this.Ej(qr.wMj))}dialogContent(){const b=document.createElement("span");b.innerText=this.vJ.Lio;const h=document.createElement("span");h.innerText=this.vJ.Xkp;h.style.fontWeight=this.vJ.gFp;const r=
document.createElement("span");r.innerText=this.vJ.xSo;const A=this.mAl(),M=document.createElement("span");M.id=this.Ej(qr.wMj);M.appendChild(b);M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));M.appendChild(h);M.appendChild(document.createElement("br"));M.appendChild(r);M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));M.appendChild(document.createElement("br"));M.appendChild(A);return M}mAl(){const b=document.createElement("span"),
h=document.createElement("a");h.innerText=this.vJ.tio;h.href=this.hOc.mYb||"";b.appendChild(h);this.y$b=h;this.Fg.nb(zd.a.click,this.y$b,Object(F.a)(this.hOc,this.hOc.wza,"clickHandler"));return b}dispose(){this.y$b&&(this.Fg.xc(zd.a.click,this.y$b,Object(F.a)(this.hOc,this.hOc.wza,"clickHandler")),this.y$b=null);super.dispose()}}qr.wMj="sendUsYourFileId";Object(u.a)(qr,"SendUsYourFileDialog",kh.StandardDialog,[106]);class nl{create(){return $a.a.instance.resolve(872)}}Object(u.a)(nl,"Factory",null,
[105]);var mh=d(512);class nu extends mh.a{constructor(){super();this.FileId=null}en(){return 38}static construct(b){const h=new nu;h.FileId=b;return h}}Object(u.a)(nu,"CreateSendUsYourFileRequest",mh.a,[]);var pj=d(839);class cn{constructor(b,h,r){this.k1=b;this.jT=h;this.SEk=r}oMj(b=!1){if(this.jT){const h=nu.construct(this.jT()),r=new pj.a;r.Zq=h;r.status=1;r.RE="BootErrorReport";b=b?this.k1(null):this.k1(A=>{this.Pld(r,A)});b.TG(r);b.t_();this.SEk()}}Pld(b){5===b.statusCode&&this.oMj(!0)}}Object(u.a)(cn,
"SendUsYourFileManager",null,[85]);class sq{constructor(b,h){this.Z=null;this.vJ=b;this.jT=h}uc(b){this.Z=b;this.Z.ia(873,()=>this.vJ).ha();this.Z.ia(872,()=>new qr(Nc.a.instance,new Bt,this.Z.resolve(873)));this.Z.ia(874,()=>new cn(h=>this.Qaa(0,h),this.jT,()=>{v.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.Z.ia(444,()=>{const h=new nl;return new Gq(this.Z.resolve(874),h)}).ha()}init(){this.Z.resolve(444)}dispose(){}}Object(u.a)(sq,"SendUsYourFilePackageManager",
null,[]);var rr=d(523),is=d(1015);class Cy{get E7k(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get tTn(){return CommonUIStrings.l_NoThanks}get Lio(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get Xkp(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get gFp(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get xSo(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get tio(){return CommonUIStrings.l_PrivacyStatement}}
Object(u.a)(Cy,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class Ni extends sq{constructor(){super(new Cy,()=>y.AFrameworkApplication.rootQuerySignature)}Qaa(b,h){return new is.a(b,h,"SendUsYourFile.ashx",pq.a.word,df.a.webServiceBase,rr.a.Eq,rr.a.Rld,rr.a.Ald)}get name(){return"WordEditor.SendUsYourFile"}static main(){E.a.instance.Mc(new Ni)}}Object(u.a)(Ni,"PackageManager",sq,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var zk=d(549),Bn=d(635),cr=d(1876),zm=d(121),Xh=d(22),Ai=d(160),Yl=d(79),Pk=d(1029),hi=d(170);class ct{constructor(){this.color=0;this.weight=hi.a.mlf;this.style=hi.a.kLb}}Object(u.a)(ct,"BorderPropertyValue",null,[]);class Qn{constructor(b,h,r,A,M,ba){this.D4d=b;this.gallerySectionId=h;this.ICf=r;this.Ghf=A;this.commandId=M;this.queryCommandId=ba}}Object(u.a)(Qn,"BorderStyleMenuPropsArguments",null,[]);class Rn{constructor(b,h,r,A,M,ba,oa){this.y6a=b;this.Eqd=h;this.width=r;this.zed=A;this.height=
M;this.Gbd=ba;this.altText=oa}}Object(u.a)(Rn,"TableBorderStyleProperties",null,[]);class Vg{constructor(){this.LTd=[new Rn(Vg.e1b,"","2",1,8,0,"Solid Line"),new Rn(Vg.vNb,"5,3","1",1,8,0,"Dashed Line"),new Rn(Vg.WNb,"1,1","1",1,8,0,"Dotted Line"),new Rn(Vg.YNb,"","1",2,8,3,"Double Line")];this.MTd=[new Rn(Vg.dLb,"","1",1,8,0,"0.25pt"),new Rn(Vg.bLb,"","1",1,8,0,"0.5pt"),new Rn(Vg.gLb,"","2",1,8,0,"0.75pt"),new Rn(Vg.cLb,"","2",1,8,0,"1pt"),new Rn(Vg.aLb,"","3",1,8,0,"1.5pt"),new Rn(Vg.hLb,"","4",
1,8,0,"2.25pt"),new Rn(Vg.fLb,"","4",1,8,0,"3pt"),new Rn(Vg.$Kb,"","5",1,8,0,"4.5pt"),new Rn(Vg.eLb,"","6",1,8,0,"6pt")]}initialize(){this.gkd()}oGf(){const b=new Qn("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.LTd,ub.a.xeb,ub.a.vpg);return this.wjc(b)}pGf(){const b=new Qn("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.MTd,ub.a.yeb,ub.a.wpg);return this.wjc(b)}fui(b){switch(b){case Vg.e1b:return hi.a.kLb;case Vg.vNb:return hi.a.cnb;
case Vg.WNb:return hi.a.uUc;case Vg.YNb:return hi.a.A6;default:return hi.a.nza}}gui(b){switch(b){case Vg.dLb:return hi.a.sUc;case Vg.bLb:return hi.a.mlf;case Vg.gLb:return hi.a.w6a;case Vg.cLb:return hi.a.mza;case Vg.aLb:return hi.a.faa;case Vg.hLb:return hi.a.dka;case Vg.fLb:return hi.a.z6;case Vg.$Kb:return hi.a.lza;case Vg.eLb:return hi.a.cka;default:return hi.a.eI}}wjc(b){const h=new Xe.a,r=new xh.a,A=Object.assign(new Bn.a,{Id:b.D4d,ExternalId:b.gallerySectionId,ExternalGalleryId:b.ICf,Type:4,
Width:1,GalleryItems:[]});for(const ba of b.Ghf){var M={};const oa={};oa.width=Vg.EBn;oa.height=Vg.DBn;M.root=oa;M=Object.assign(new cr.a,{Id:ba.y6a,ExternalId:String.format("{0}_GalleryButton",ba.y6a),Icon:ba.y6a,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ba.y6a,FullIconStyle:M,ShouldSetTitle:"true",Alt:ba.altText});A.GalleryItems.push(M)}r.ControlList=[];h.MenuSectionList=[];r.ControlList.push(A);h.MenuSectionList.push(r);h.UpdateDynamically=!0;return h}gkd(){const b=
{};for(const h of this.LTd)b[h.y6a]=appChrome.buildBorderStyleIcon(h.Eqd,h.width,h.zed,h.height,h.Gbd);for(const h of this.MTd)b[h.y6a]=appChrome.buildBorderStyleIcon(h.Eqd,h.width,h.zed,h.height,h.Gbd);appChrome.api.registerIconProvider(()=>b)}cUo(b,h,r){if(!b)return v.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==mc.a.D4)return v.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),
!1;switch(b.border){case 2:this.u4(zm.a.pX(b),b.node,5,r,h);break;case 0:this.u4(zm.a.pX(b),b.node,3,r,h);break;case 1:this.u4(zm.a.pX(b),b.node,4,r,h);break;case 3:this.u4(zm.a.pX(b),b.node,0,r,h);break;case 7:this.u4(zm.a.pX(b),b.node,1,r,h);break;case 8:this.u4(zm.a.pX(b),b.node,2,r,h);break;case 6:this.u4(zm.a.pX(b),b.node,1,r,h);this.u4(zm.a.pX(b),b.node,2,r,h);break;case 5:this.u4(zm.a.pX(b),b.node,3,r,h);this.u4(zm.a.pX(b),b.node,5,r,h);this.u4(zm.a.pX(b),b.node,4,r,h);this.u4(zm.a.pX(b),b.node,
0,r,h);break;case 4:this.u4(zm.a.pX(b),b.node,3,r,h),this.u4(zm.a.pX(b),b.node,5,r,h),this.u4(zm.a.pX(b),b.node,4,r,h),this.u4(zm.a.pX(b),b.node,0,r,h),this.u4(zm.a.pX(b),b.node,1,r,h),this.u4(zm.a.pX(b),b.node,2,r,h)}return!0}ezg(b,h,r,A){if(!h)return v.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==mc.a.T0)return v.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var M=h.node;
const ba=new zc.a;ba.set(M);ba.vb(14);M=Xh.TableCellReader.IVa(ba);switch(h.border){case 2:this.z_a(b,h.node,5,A,r,M);this.Wxe(h.node,5,r);this.Wwe(b,h.c9a(),3,r,A,M);break;case 0:this.z_a(b,h.node,3,A,r,M);this.Wxe(h.node,3,r);this.Wwe(b,h.c9a(),1,r,A,M);break;case 1:this.z_a(b,h.node,4,A,r,M);this.Wxe(h.node,4,r);this.Wwe(b,h.c9a(),0,r,A,M);break;case 3:this.z_a(b,h.node,0,A,r,M),this.Wxe(h.node,0,r),this.Wwe(b,h.c9a(),2,r,A,M)}return!0}Cno(b,h){if(Le.a.iad(b)&&h)switch(b=Object(Ma.a)(Ai.TableNodeBorderContext,
b),b.border){case 2:this.MR(b.node,Vg.Mp.oP(5),h);break;case 0:this.MR(b.node,Vg.Mp.oP(3),h);break;case 3:this.MR(b.node,Vg.Mp.oP(0),h);break;case 1:this.MR(b.node,Vg.Mp.oP(4),h);break;case 7:this.MR(b.node,Vg.Mp.oP(1),h);break;case 8:this.MR(b.node,Vg.Mp.oP(2),h);break;case 5:h=this.MR(b.node,Vg.Mp.oP(5),h);h=this.MR(b.node,Vg.Mp.oP(3),h);h=this.MR(b.node,Vg.Mp.oP(0),h);this.MR(b.node,Vg.Mp.oP(4),h);break;case 6:h=this.MR(b.node,Vg.Mp.oP(1),h);this.MR(b.node,Vg.Mp.oP(2),h);break;case 4:h=this.MR(b.node,
Vg.Mp.oP(5),h),h=this.MR(b.node,Vg.Mp.oP(3),h),h=this.MR(b.node,Vg.Mp.oP(0),h),h=this.MR(b.node,Vg.Mp.oP(4),h),h=this.MR(b.node,Vg.Mp.oP(1),h),this.MR(b.node,Vg.Mp.oP(2),h)}}$lo(b,h){if(Le.a.jad(b)&&h)switch(b=Object(Ma.a)(Ai.TableNodeBorderContext,b),b.border){case 2:this.MR(b.node,Vg.Mp.IR(5),h);break;case 0:this.MR(b.node,Vg.Mp.IR(3),h);break;case 3:this.MR(b.node,Vg.Mp.IR(0),h);break;case 1:this.MR(b.node,Vg.Mp.IR(4),h)}}m2c(b,h,r){r=null;if(!b)return v.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),
r;b.properties.hasProperty(h.size)&&(r=new ct,r.weight=b.properties.ka(h.size,hi.a.eI),r.style=b.properties.ka(h.style,hi.a.nza),r.color=b.properties.ka(h.color,0));return r}dzg(b,h,r){b?r?(b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style),b.properties.setValue(h.color,r.color)):v.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):v.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}AZb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),
b.properties.removeProperty(h.color)):v.ULS.sendTraceTag(575980879,306,15,"Node should not be null")}u4(b,h,r,A,M){M=this.LCp(b,h,r,A,M);this.cxc(h,Vg.Mp.oP(r),M);switch(r){case 5:this.mxb(h,2,A,M);break;case 4:this.mxb(h,1,A,M);break;case 0:this.mxb(h,3,A,M);break;case 3:this.mxb(h,0,A,M);break;case 1:this.mxb(h,7,A,M);break;case 2:this.mxb(h,8,A,M)}}LCp(b,h,r,A,M){if(3!==A){var ba=Vg.Xg.f6d(b,h,r,3);void 0!==ba&&null!==ba&&ba!==hi.a.s2&&(ba=Yl.a.lwc(ba),M.color=Vg.Zva.mka(h,ba))}1!==A&&(ba=Vg.Xg.f6d(b,
h,r,1),void 0!==ba&&null!==ba&&ba!==hi.a.dI&&(M.weight=parseFloat(ba)*hi.a.tUc));2!==A&&(b=Vg.Xg.f6d(b,h,r,2),void 0!==b&&null!==b&&b!==hi.a.dI&&(M.style=b));return M}z_a(b,h,r,A,M,ba){A&&(M=this.lxp(b,h,ba,r,A,M));this.cxc(h,Vg.Mp.IR(r),M)}lxp(b,h,r,A,M,ba){if(3!==M){var oa="",Ja=Vg.Xg.UPb(b,h,A,!1,!0,r,3);Ja&&(oa=Ja.jLb);void 0!==oa&&null!==oa&&oa!==hi.a.s2&&(oa=Yl.a.lwc(oa),ba.color=Vg.Zva.mka(h,oa))}if(1!==M){oa="";if(Ja=Vg.Xg.UPb(b,h,A,!1,!0,r,1))oa=Ja.jLb;void 0!==oa&&null!==oa&&oa!==hi.a.dI&&
(ba.weight=parseFloat(oa)*hi.a.tUc)}if(2!==M){M="";if(b=Vg.Xg.UPb(b,h,A,!1,!0,r,2))M=b.jLb;void 0!==M&&null!==M&&M!==hi.a.dI&&(ba.style=M)}return ba}fQn(b){let h=0,r=0;({EPn:h,fNn:r}=this.jBm(b.style,h,r));b.weight<h&&(b.weight=h);b.weight>r&&(b.weight=r);return b}jBm(b,h,r){switch(b){case hi.a.kLb:case hi.a.cnb:case hi.a.uUc:h=2;r=48;break;case hi.a.A6:h=2;r=24;break;default:h=2,r=48}return{EPn:h,fNn:r}}Wwe(b,h,r,A,M,ba){if(h)if(A)for(let oa=0;oa<h.length;oa++)switch(r){case 2:this.z_a(b,h[oa],5,
M,A,ba);break;case 0:this.z_a(b,h[oa],3,M,A,ba);break;case 1:this.z_a(b,h[oa],4,M,A,ba);break;case 3:this.z_a(b,h[oa],0,M,A,ba)}else v.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else v.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}Wxe(b,h,r){const A=new zc.a;A.set(b);A.vb(14);const M=Xh.TableCellReader.Dfa(b);b=Xh.TableCellReader.XJ(b);bi.forEachCell(A,M,b,(ba,oa,Ja)=>{ba=ba.currentNode;Xh.TableCellReader.jr(ba)&&0==Ja&&0<oa&&this.cxc(ba,
Vg.Mp.IR(h),r)})}cxc(b,h,r){b?(r=this.fQn(r),b.properties.setValue(h.color,r.color),b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style)):v.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}mxb(b,h,r,A){if(b){var M=Hi.TableReader.ug(b),ba=Hi.TableReader.Dh(b),oa=new zc.a,Ja=[];for(let jb=0;jb<M;jb++)for(let zb=0;zb<ba;zb++)if(oa.set(b),bi.moveToCell(oa,jb,zb),oa&&oa.currentNode&&!Xh.TableCellReader.Lg(oa))switch(h){case 2:Xh.TableCellReader.bma(oa)&&Ja.push(Ai.TableNodeBorderContext.xaa(oa.currentNode,
2));break;case 0:Xh.TableCellReader.cma(oa)&&Ja.push(Ai.TableNodeBorderContext.xaa(oa.currentNode,0));break;case 3:Xh.TableCellReader.d_f(b,oa.currentNode)&&Ja.push(Ai.TableNodeBorderContext.xaa(oa.currentNode,3));break;case 1:Xh.TableCellReader.e_f(b,oa.currentNode)&&Ja.push(Ai.TableNodeBorderContext.xaa(oa.currentNode,1));break;case 7:Xh.TableCellReader.e_f(b,oa.currentNode)||Ja.push(Ai.TableNodeBorderContext.xaa(oa.currentNode,1));break;case 8:Xh.TableCellReader.d_f(b,oa.currentNode)||Ja.push(Ai.TableNodeBorderContext.xaa(oa.currentNode,
3))}for(b=0;b<Ja.length;b++)switch(h=Ja[b],h.border){case 2:this.zkd(h.node,Vg.Mp.IR(5),r,A);this.Rte(h.c9a(),Vg.Mp.IR(0),r,A);break;case 0:this.zkd(h.node,Vg.Mp.IR(3),r,A);this.Rte(h.c9a(),Vg.Mp.IR(4),r,A);break;case 1:this.zkd(h.node,Vg.Mp.IR(4),r,A);this.Rte(h.c9a(),Vg.Mp.IR(3),r,A);break;case 3:this.zkd(h.node,Vg.Mp.IR(0),r,A),this.Rte(h.c9a(),Vg.Mp.IR(5),r,A)}}else v.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}Rte(b,h,r,A){if(b)for(let M=0;M<b.length;M++)this.zkd(b[M],
h,r,A);else v.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}zkd(b,h,r,A){if(b){var M=b.ka(h.color,Vg.LYc),ba=b.ka(h.size,Vg.Fgc),oa=b.ka(h.style,Vg.Egc),Ja=new ct;Ja.weight=A.weight;Ja.style=A.style;Ja.color=A.color;2!==r||M===Vg.LYc&&ba===Vg.Fgc?3!==r||oa===Vg.Egc&&ba===Vg.Fgc?1!==r||M===Vg.LYc&&oa===Vg.Egc?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Ja.color=M,Ja.style=oa,this.cxc(b,h,Ja)):(Ja.style=
oa,Ja.weight=ba,this.cxc(b,h,Ja)):(Ja.color=M,Ja.weight=ba,this.cxc(b,h,Ja))}else v.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}MR(b,h,r){var A=b.properties.ka(h.style,hi.a.dI);A!==hi.a.dI&&(r.lineStyle!==hi.a.dI?r.lineStyle!==A&&(r.lineStyle=hi.a.yfl):r.lineStyle=A);A=b.properties.ka(h.size,hi.a.eI);A!==hi.a.eI&&(r.Iqc!==hi.a.eI?r.Iqc!==A&&(r.Iqc=hi.a.mfl):r.Iqc=A);b=b.properties.ka(h.color,0);b=Yl.a.QB(b);b!==hi.a.s2&&(r.borderColor!==hi.a.s2?r.borderColor!==b&&(r.borderColor=
hi.a.efl):r.borderColor=b);return r}static get Mp(){return null!=Vg.OTg?Vg.OTg:Vg.OTg=hi.a.instance}static get Xg(){return null!=Vg.R7g?Vg.R7g:Vg.R7g=$a.a.instance.Oa(461)}static get Zva(){return null!=Vg.I5g?Vg.I5g:Vg.I5g=Pk.a.instance}}Vg.EBn="110px";Vg.DBn="20px";Vg.e1b="SolidLineStyle";Vg.vNb="DashedLineStyle";Vg.WNb="DottedLineStyle";Vg.YNb="DoubleLineStyle";Vg.dLb="BorderPointSizeOneQuarter";Vg.bLb="BorderPointSizeOneHalf";Vg.gLb="BorderPointSizeThreeQuarters";Vg.cLb="BorderPointSizeOne";Vg.aLb=
"BorderPointSizeOneAndHalf";Vg.hLb="BorderPointSizeTwoAndQuarter";Vg.fLb="BorderPointSizeThree";Vg.$Kb="BorderPointSizeFourAndHalf";Vg.eLb="BorderPointSizeSix";Vg.Egc="single";Vg.Fgc=4;Vg.LYc=0;Object(u.a)(Vg,"TableBorderManager",null,[588]);var jo=d(1014),Cn=d(52),Hq=d(209);class Lw{constructor(b,h){this.vBh=this.kwh=null;this.cUa=b;this.yyh=h}get Cqj(){return this.yyh}get pua(){return this.kwh}get Vqg(){return this.vBh}PPj(b,h){this.vBh=b;this.kwh=h}fZo(b){this.yyh=b}}Object(u.a)(Lw,"CellNodeAndOutlineElementInfoForInsertion",
null,[]);var fk=d(56),Uv=d(187),Iq=d(365),bf=d(145),sr=d(228),Eo=d(471),Kx=d(73),Mw=d(487),tr=d(1042);class jm extends jo.a{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb=null,Sb=null){super(b,h,r,Sb,Eb);this.xhb=tr.a.instance;this.sa=new Fd.a;this.E0h=[Rc.a.rzc,Rc.a.Lzb,Rc.a.G1b,Rc.a.pzc,Rc.a.Jzb,Rc.a.E1b,Rc.a.ozc,Rc.a.Izb,Rc.a.D1b,Rc.a.qzc,Rc.a.Kzb,Rc.a.F1b];this.Xqk=[Rc.a.ya,Rc.a.xa,ze.a.si,ze.a.Ds];this.Fi=A;this.SIb=M;this.$c=ba;this.ib=oa;this.V9=Ja;this.Xm=jb;this.pIc=zb;this.GIh=Eb;this.ERk=Sb;this.Sko=
this.Vng.bind(this)}get Gj(){return this.Fi.value}get fu(){return this.V9?this.V9.instance:null}wgf(b){this.sa.addHandler("OnParagraphDelete",b)}get Ph(){return!!this.pIc.instance&&this.pIc.instance.Ph}e8c(b,h,r,A,M){h.setValue(Rc.a.Zc,Lg.a.gG());h.setValue(Rc.a.nin,M);Eo.c(A,h,[Rc.a.E4]);super.e8c(b,h,r,A,M)}Qbe(b,h,r,A,M){const ba=this.J5c(h,r,A,M);this.YXd(ba,h,!1);return super.Qbe(b,h,r,A,M)}UQd(b,h,r,A,M){const ba=this.J5c(h,r,A,M);this.YXd(ba,h,!0);super.UQd(b,h,r,A,M);return ba}xsf(b,h,r,A){h=
this.J5c(b,h,r,A);this.YXd(h,b,!0);return h}insertRows(b,h,r,A){const M=Cn.a.It(b),ba=new zc.a;ba.kd(b);const oa=ba.currentNode;ba.Ub(1);let Ja;Ja=h?b.qP(1):b.currentNode;const jb=b.rc();if(!jb)throw Error.create("table row insertion cannot be performed on a null tableNode");const zb=Hi.TableReader.ug(jb),Eb=jb.B2.Xg;let Sb=!1;try{jb.SDa=1;const nc=this.xhb.Jqb(jb,Eb.mH(jb));this.L_a(b.currentNode);this.gwa(b);this.UYk(r,b,Ja,ba,oa,h,A);const Dc=this.xhb.Jqb(jb,Eb.mH(jb));this.veb(jb,Hi.TableReader.ug(jb)+
r);Sb=!0;this.Cce(jb,nc,Dc)}finally{jb.SDa=0,Sb||this.veb(jb,Hi.TableReader.ug(jb)+r)}M+1!==zb||h?!M&&h&&jm.UWf(jb,r):jm.UWf(jb,M);h=M+r+(h?0:1);h<zb+r&&this.BUi(jb,h);return b.currentNode}UYk(b,h,r,A,M,ba,oa){let Ja=null,jb=null;for(var zb=0;zb<b;++zb){var Eb=Hq.a.instance.createInstance(rn.a.Xna);jb||(jb=Eb);Ja=Eb;this.e8c(h,Eb,r,M,ba)}b=Hi.TableReader.Dh(h.currentNode);r=!0;do{r?(h.Yj(Ja),r=!1):h.Nf(1);M=Array(b);for(zb=0;zb<b;++zb){Eb=this.IUa();const Sb=this.xsf(Eb,A.currentNode,ba,!0);let nc=
null;Sb.Lg||(nc=oa(Sb));M[zb]=new Lw(Eb,nc);M[zb].PPj(Sb,null);A.Nf(1)}for(zb=0;zb<b;++zb)Eb=M[zb].cUa,h.o6(Eb,1,jo.a.mRa?jo.a.mRa():null),Xh.TableCellReader.jr(Eb)||(this.BKb(h,Eb,M[zb].Cqj),this.x8h(M[zb].Vqg,Eb,!0));A.Gla(1)}while(h.currentNode!==jb)}insertColumns(b,h,r,A,M){let ba=b.currentNode,oa=!1,Ja=Hi.TableReader.Dh(b.currentNode);const jb=Ja;try{this.L_a(b.currentNode);this.gwa(b);const zb=ba.B2.Xg;ba.SDa=1;const Eb=this.xhb.Jqb(ba,zb.mH(ba));Ja=Hi.TableReader.Dh(b.currentNode);-1===h&&
(h=Ja);this.SYk(b,A,r,h,M);ba=b.currentNode;Ja+=A;this.zqg(b,Ja,A,h);oa=!0;const Sb=this.xhb.Jqb(ba,zb.mH(ba));this.Cce(ba,Eb,Sb)}finally{ba.SDa=0,oa||this.zqg(b,Ja,A,h)}h!==jb||r?!h&&r&&jm.TWf(ba,A):jm.TWf(ba,h-1)}SYk(b,h,r,A,M){var ba=b.currentNode;A=r?A:A-1;b.Ub(1);var oa=new qb.a;do{var Ja=b.Lo(A,1);b.rc();var jb=Array(h);for(let Eb=0;Eb<h;++Eb){var zb=this.IUa();const Sb=this.eDm(b,Ja,r),nc=this.xsf(zb,Ja,r,!1);zb=new Lw(zb,null);zb.PPj(nc,Sb);jb[Eb]=zb}oa.add(jb)}while(b.Mi(1));r=oa.toArray();
for(A=0;A<r.length;A++)for(oa=0;oa<h;oa++)Ja=r[A][oa],jb=Ja.Vqg,jb.Lg||Ja.fZo(M(jb));b.set(ba);b.Ub(1);M=0;do{for(ba=0;ba<h;++ba)A=r[M][ba],oa=A.cUa,b.vSb(oa,A.pua,1,jo.a.mRa?jo.a.mRa():null),Xh.TableCellReader.jr(oa)||(this.BKb(b,oa,A.Cqj),this.x8h(A.Vqg,oa,!1));M++}while(b.Mi(1))}Cce(b,h,r){if(h){var A=2===b.SDa,M=[],ba=new zc.a;ba.set(b);for(var oa=ba.Ub(1);oa;){for(oa=ba.Ub(1);oa;){const Ja=oa.id.toString();Ja in h&&h[Ja]===r[Ja]&&(!A||!Xh.TableCellReader.cma(ba)&&!Xh.TableCellReader.bma(ba))||
M.push(oa);oa=ba.Mi(1)}oa=ba.Mi(1)}if(0<M.length){h=new Qb.GraphTransaction(3);try{h.set(b.qk);for(const Ja of M)Ja.WWf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const r=Cn.a.It(b),A=r+h;let M=b.rc();const ba=M.B2.Xg;let oa=!1;v.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",M.id.toString(),M.type,r,h);const Ja=Hi.TableReader.ug(M);try{M.SDa=2;const jb=this.xhb.Jqb(M,ba.mH(M));this.L_a(b.currentNode);
this.gwa(b);for(let Eb=A-1;Eb>=r;--Eb){b.Lo(Eb,1);let Sb=b.Ub(1);for(;Sb;)this.Yed(Sb,!0),Sb=b.Mi(1);this.sWa(b);v.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.nf);b.Tg()}M=b.currentNode;const zb=this.xhb.Jqb(M,ba.mH(M));this.veb(M,Hi.TableReader.ug(M)-h);this.rme(b);oa=!0;this.Cce(M,jb,zb)}finally{M.SDa=0,oa||(this.veb(b.currentNode,Hi.TableReader.ug(b.currentNode)-h),this.rme(b))}Ja===A&&0<=r-1&&jm.UWf(M,r-1);r<Ja-h&&this.BUi(M,r)}deleteColumns(b,
h,r){b=Object(Ma.a)(zc.a,b);let A=Object(Ma.a)(Mw.a,b.currentNode),M=Hi.TableReader.Dh(b.currentNode);const ba=A.B2.Xg;let oa=!1;v.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",A.id.toString(),A.type,h,r);const Ja=M;try{A.SDa=2;const jb=this.xhb.Jqb(A,ba.mH(A));this.L_a(b.currentNode);this.gwa(b);-1===h&&(h=M-r);b.Ub(1);do for(let Eb=h+r-1;Eb>=h;--Eb)b.Lo(Eb,1),this.Yed(b.currentNode,!1),this.sWa(b),
b.Tg();while(b.Mi(1));M-=r;this.yqg(b,M,h,r);oa=!0;A=Object(Ma.a)(Mw.a,b.currentNode);const zb=this.xhb.Jqb(A,ba.mH(A));this.Cce(A,jb,zb);this.qme(b)}finally{A&&(A.SDa=0),oa||(this.yqg(b,M,h,r),this.qme(b))}Ja===h+r&&0<=h-1&&jm.TWf(A,h-1)}mergeCells(b,h,r){if(b&&(1!==h||1!==r)){var A=new zc.a;A.kd(b);A.vb(14);this.Vtf(A,h,r);this.Swp(A,h,r);A.rc();A.rc();this.cmj(A)}}yXj(b,h,r){if(b&&(1!==h||1!==r)){var A=new zc.a;A.kd(b);A.vb(14);this.yLl(A,h,r);A.rc();A.rc();this.Hoj(A)}}Yed(b,h){v.ULS.sendTraceTag(579479250,
341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.kWm(b,h,this.Sko)}Vng(b,h){const r=b.currentNode;r.Lg=!1;this.YXd(h.currentNode,b.currentNode,!0);r.removeProperty(Rc.a.skippedCell);r.removeProperty(Rc.a.renderCell);1===r.colSpan&&1===r.rowSpan&&r.IVc();jo.a.sT.Vja(b,!0,jo.a.wDi(h.currentNode));bi.returnToCell(b);this.yDl(h,b)}RRf(b,h,r){super.RRf(b,h,r);1===h.dP.colSpan&&1===h.dP.rowSpan?h.dP.IVc():!r&&h.Hve&&(b.vWa?1<b.colSpan&&(h=new zc.a,h.set(b),h.vb(15),bi.moveToNextColumn(h),
h.currentNode.colSpan=b.colSpan-1):(r=new zc.a,r.set(h.dP),r.vb(15),h=Kx.a(r),r=new zc.a,r.set(b),r.vb(15),bi.moveToColumnByIndex(r,h),--r.currentNode.colSpan))}J5c(b,h,r,A){const M=super.J5c(b,h,r,A);if(b.Lg&&!A){var ba=h.ECa;ba.Hve&&(A=jo.a.Ljc(ba.dP,A),!ba.tWd&&r||ba.tWd===A-1&&!r?b.colSpan=1:(r=new zc.a,r.set(ba.dP),r.vb(15),ba=Kx.a(r),r=new zc.a,r.set(h),r.vb(15),bi.moveToColumnByIndex(r,ba),r.currentNode.colSpan+=1))}M.ka(Rc.a.skippedCell,!1)&&(b.Lg=!0,b.P7=!0,b.Vyb=!0);return M}rme(b){this.G2b(b,
Rc.a.complexTable)}qme(b){this.G2b(b,Rc.a.complexTable)}cmj(b){this.G2b(b,Rc.a.complexTable)}Hoj(b){this.G2b(b,Rc.a.complexTable)}yDl(b,h){if(b&&h){let r;b=zc.a.Za(b.currentNode);to.OutlineNavigator.Mba(b)&&(b.Ub(2),b=b.currentNode,12==b.type&&(r=b.wf(ze.a.si)));r&&(b=new zc.a,b.kd(h),to.OutlineNavigator.Mba(b)&&b.Ub(2)&&(h=b.currentNode,12==h.type&&h.Zg(ze.a.si,r)))}}YXd(b,h,r){b&&(Eo.c(b,h,this.E0h),Eo.c(b,h,[ze.a.YG]),r&&Eo.c(b,h,[Rc.a.CS,Rc.a.AV,Rc.a.FOa,Rc.a.DOa,Rc.a.GOa,Rc.a.skippedCell,Rc.a.renderCell]))}x8h(b,
h,r){b&&(b=zc.a.Za(b),b.Ld(),b.$d(),h=zc.a.Za(h),h.Ld(),h.$d(),Ua.a.Qh(b)&&Ab.OutlineElementNavigator.Me(b)&&Ua.a.Qh(h)&&Ab.OutlineElementNavigator.Me(h)&&Eo.c(b.currentNode,h.currentNode,this.Xqk),r&&(Ab.OutlineElementNavigator.ke(b),Ab.OutlineElementNavigator.ke(h),mf.ListItemReader.Dg(b)&&(r=jm.qCn.Tw(b),r.JD=fk.a.Pk,{Rla:r}=jm.Ll.Qqa(r.ef,h,r))))}sWa(b){this.Ph&&this.Xm.tzo(b.currentNode);for(b=Uv.a.rq(b);b.moveNext();)if(Ed.ParagraphReader.Vb(b.currentNode)){const h=bm.e(b.currentNode);for(const r of h)r.Fga();
this.sa.raiseEvent("OnParagraphDelete",b.currentNode)}else mf.ListItemReader.Dg(b.iterator)&&this.fu&&this.fu.dha(b.iterator)}HH(b,h){let r=null;if(this.GIh.Ag){const A=Object(Ma.a)(Mw.a,b);A&&(r=A.jY())}Hi.TableReader.zo(b)&&(1===h?h=3:3===h&&(h=1));super.HH(b,h);this.GIh.Ag&&this.ERk.M_a(b,r);Object(Za.a)(Mw.a,b)&&jo.a.Rh.CQj(Object(Ma.a)(Mw.a,b),(new Iq.a(1,0)).Uu)}kAg(b,h){const r=Array(h),A=this.vIi(b)/h;for(let M=0;M<h;M++)r[M]=Math.max(Rh.a.zn(bf.a.Rha,0),A);b.setValue(ze.a.oB,r)}rPj(b){b.setValue(Rc.a.tableLayout,
0)}PQh(b,h,r,A,M){const ba=Array(r);for(var oa=0,Ja=0;oa<A;++oa)ba[oa]=h[oa],Ja+=ba[oa];for(;oa<r;++oa)ba[oa]=0>oa-M?h[0]:h[oa-M],Ja+=ba[oa];oa=this.vIi(b.currentNode);if(Ja>oa)for(Ja=oa/Ja,oa=0;oa<r;++oa)ba[oa]=Math.max(Rh.a.zn(bf.a.Rha,0),ba[oa]*Ja);return ba}vIi(b){var h=zc.a.Za(b);b=Rh.a.zn(Rh.a.sj(Hi.TableReader.jIi(h),0),0);if(h.vb(16))return bi.returnToCell(h),h=bf.a.qAc(h.currentNode),Rh.a.zn(Rh.a.sj(h,0),0)-b;h=sr.a.Zrd(h);return Rh.a.zn(Rh.a.sj(h,0),0)-b}XJ(b,h,r){const A=new zc.a;A.set(b);
bi.moveToCell(A,h,r);return A.currentNode.ka(Rc.a.colSpan,1)}jxc(b){var h=qa.StaticActiveAppFrame.za().kb.Fw;if(h.ue&&(h=b.Ce(h.sc))){var r=!1,A=Hi.TableReader.Dh(b),M=b.ka(ze.a.oB,Array(A));for(var ba of M)if(!ba){r=!0;break}if(r){M=Ye.a.clone(M);ba=b.ka(Rc.a.complexTable,!1);v.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",A,M,ba);r=1;var oa=0;for(let jb=0;jb<A;)if(ba&&(r=this.XJ(b,0,jb)),1<r){for(var Ja=0;Ja<r;Ja++)M[jb]||
(M[jb]=this.$Bi(0)),jb++;oa+=r-1}else(Ja=h.Epm(jb-oa))||v.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",jb,oa),M[jb]||(M[jb]=this.$Bi(Ja)),jb++;b.setValue(ze.a.oB,M)}}}$Bi(b){return Rh.a.zn(Math.max(b,bf.a.Rha),0)}L_a(b){b=zc.a.Za(b);this.jxc(b.currentNode);b.vb(14)&&(bi.returnToContainingTable(b),this.jxc(b.currentNode))}yQj(b,h){h&&b.setValue(Rc.a.Pca,h)}RAg(b,h){h&&b.setValue(Rc.a.nzc,h)}U2h(b,h){const r=Hi.TableReader.Dh(b);jo.a.Fsl(b,h,r)}cVo(b,h,r){let A;
if(!({Ep:A}=this.Apc(b)).returnValue)return!1;if(h&&r&&h.length===r.length){if(!this.rXl(A,h))return!1;for(let M=0;M<h.length;++M){const ba=this.SIb.Knd(b,h[M],r[M]);if(ba)return v.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",ba),!1}this.oke(A);return!0}return!1}d8k(b,h){let r;if(!({Ep:r}=this.Apc(b)).returnValue||Hi.TableReader.yD(r))return!1;var A=Object(Ma.a)(zc.a,this.$c.lg(r));bi.moveToLastRow(A);var M=Hi.TableReader.ug(r);
if(h&&0<h.length){this.insertRows(A,!1,h.length,()=>null);A=Hi.TableReader.ug(r);var ba=this.$c.lg(r);M=this.fIi(ba,M,A-1);for(A=0;A<M.length;++A){ba=M[A];const oa=h[A];for(let Ja=0;Ja<ba.length;++Ja){let jb;if(jb=oa&&oa[Ja]?this.SIb.Knd(b,ba[Ja],oa[Ja].toString()):this.SIb.Knd(b,ba[Ja],""))return v.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",jb),!1}}}this.oke(r);return!0}M7k(b,h){let r;if(!({Ep:r}=this.Apc(b)).returnValue||
Hi.TableReader.yD(r))return!1;var A=this.$c.lg(r),M=Hi.TableReader.Dh(r);if(h&&0<h.length){this.insertColumns(Object(Ma.a)(zc.a,A),M,!1,h[1].length,()=>null);var ba=Hi.TableReader.Dh(r);A=this.nOm(A,M,ba-1);for(M=0;M<A.length;++M){ba=h[M];const oa=A[M];for(let Ja=0;Ja<oa.length;++Ja){let jb;if(jb=ba&&ba[Ja]?this.SIb.Knd(b,oa[Ja],ba[Ja].toString()):this.SIb.Knd(b,oa[Ja],""))return v.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
jb),!1}}}this.oke(r);return!0}VQl(b){let h;if(!({Ep:h}=this.Apc(b)).returnValue)return!1;let r=this.A9a(h);const A=Hi.TableReader.ug(h);var M=this.$c.lg(h);M=this.fIi(M,r,A-1);for(let ba=0;ba<M.length;++ba){const oa=M[ba];for(let Ja=0;Ja<oa.length;++Ja){const jb=this.SIb.QBj(b,oa[Ja]);if(jb)return v.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",jb),!1}}r=r?r:1;b=this.$c.lg(h);b.eC(r)&&15===b.nf&&this.deleteRows(Object(Ma.a)(zc.a,
b),A-r);this.oke(h);return!0}A9a(b){let h=0;const r=this.$c.lg(b);let A=r.$d();for(;A&&A.ka(Rc.a.$tb,!1);)h++,A=r.Fu();return!h&&jo.a.Ry.d3(b)&32?1:h}Swp(b,h,r){var A,M;const ba=b.currentNode,oa=new zc.a;oa.kd(b);let Ja=null,jb=null,zb=null;const Eb=hi.a.instance.IR(3),Sb=hi.a.instance.IR(4),nc=hi.a.instance.IR(5),Dc=hi.a.instance.IR(0);bi.forEachCell(oa,h,r,(Zc,Gd,de)=>{Zc=Zc.currentNode;Gd||de||(Ja=jm.nB.m2c(Zc,Eb,Ja));Gd||de!==r-1||(jb=jm.nB.m2c(Zc,Sb,jb));0<Gd&&!de&&(Ja?jm.nB.dzg(Zc,Eb,Ja):jm.nB.AZb(Zc,
Eb),jb?jm.nB.dzg(Zc,Sb,jb):jm.nB.AZb(Zc,Sb),jm.nB.AZb(Zc,nc),Gd!==h-1&&jm.nB.AZb(Zc,Dc));de||Gd!==h-1||(zb=jm.nB.m2c(Zc,Dc,zb))});b=null===(M=null===(A=qa.StaticActiveAppFrame.za())||void 0===A?void 0:A.kb)||void 0===M?void 0:M.Fw;jb?(A=Ai.TableNodeBorderContext.xaa(ba,1),jm.nB.ezg(zm.a.Uq(b),A,jb,0)):jm.nB.AZb(ba,Sb);A=Ai.TableNodeBorderContext.xaa(ba,0);if(Ja)jm.nB.ezg(zm.a.Uq(b),A,Ja,0);else for(A=Object(Ma.a)(Ai.TableNodeBorderContext,A).c9a(),M=0;M<A.length;M++)jm.nB.AZb(A[M],Sb);zb?jm.nB.dzg(ba,
Dc,zb):jm.nB.AZb(ba,Dc)}rXl(b,h){for(let A=0;A<h.length;++A){var r=this.$c.lg(h[A]);if(r.vb(14)&&(r=r.fd(14),b.id===r.id))continue;return!1}return!0}Apc(b){let h=null;if(b&&b.xv.toString()!==b.OA.toString())return{returnValue:!1,Ep:h};h=this.Gj.Eb(b.xv);return 14===h.type&&this.SIb.Apc(b)?{returnValue:!0,Ep:h}:{returnValue:!1,Ep:h}}fIi(b,h,r){const A=[];bi.forEachCellInTable(Object(Ma.a)(zc.a,b),(M,ba,oa)=>{if(ba>=h&&ba<=r)oa||A.push([]),Xh.TableCellReader.Lg(M)||Array.add(A[ba-h],M.currentNode);
else if(ba>r)return!1;return!0});return A}nOm(b,h,r){const A=[];bi.forEachCellInTable(Object(Ma.a)(zc.a,b),(M,ba,oa)=>{oa>=h&&oa<=r&&(oa===h&&A.push([]),Xh.TableCellReader.Lg(M)||Array.add(A[ba],M.currentNode));return!0});return A}oke(b){if(b&&14===b.type){b=Object(Ma.a)(zc.a,this.$c.lg(b));const h=new qb.a;Ed.ParagraphReader.LQb(b,!0,!1,h);b=sc.SelectionFactory.ve(h.K(h.count-1),0);this.ib.Kc(b)}}static get nB(){jm.vya||(jm.vya=$a.a.instance.Oa(875));return jm.vya}static get qCn(){return null!=jm.h1g?
jm.h1g:jm.h1g=$a.a.instance.resolve(10)}static get Ll(){return null!=jm.a1g?jm.a1g:jm.a1g=$a.a.instance.resolve(31)}BUi(b,h){const r=new zc.a;r.set(b);bi.moveToFirstRow(r);bi.moveToRowByIndex(r,h);do r.currentNode.fm(4,!0);while(bi.moveToNextRow(r))}static UWf(b,h){if(b){var r=Hi.TableReader.ug(b),A=Hi.TableReader.Dh(b);if(!(!qa.StaticActiveAppFrame.za().kb.Fw.ue||0>h||h>=r))for(r=new zc.a,r.set(b),b=0;b<A;b++){b?bi.moveToNextColumn(r):bi.moveToCell(r,h,b);if(!r||!r.currentNode||16!==r.currentNode.type)continue;
let M=r.currentNode;Xh.TableCellReader.jr(M)&&(M=Xh.TableCellReader.f7(M));M&&M.fm(4,!0)}}else v.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static TWf(b,h){if(b){var r=Hi.TableReader.ug(b),A=Hi.TableReader.Dh(b),M=new zc.a;if(!(!qa.StaticActiveAppFrame.za().kb.Fw.ue||0>h||h>=A))for(A=0;A<r;A++){M.set(b);bi.moveToCell(M,A,h);if(!M||!M.currentNode)continue;let ba=M.currentNode;Xh.TableCellReader.jr(ba)&&(ba=Xh.TableCellReader.f7(ba));ba&&ba.fm(4,!0)}}else v.ULS.sendTraceTag(577868248,
306,15,"Can not invalidate column when there is no table node")}}jm.vya=null;Object(u.a)(jm,"TableEditor",jo.a,[584,585]);class Ju{get name(){return"WordEditor.TableEditors"}uc(b){y.AFrameworkApplication.J.$("TableEditorsDelayInitializationEnabled")&&(b.ia("WordEditor.TableEditors.TableEditor",()=>new jm(b.resolve(110),b.resolve(16),b.resolve(461),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed.ud),b.resolve(876),new zk.a,$f.a.instance,b.Ra(620),b.resolve(19),b.Ra(11),b.resolve(46).instance,b.resolve(39).instance)).as(785).as(32).ha(),
b.ia("WordEditor.TableEditors.TableBorderManager",()=>new Vg).as(875).ha())}init(){}dispose(){}static main(){E.a.instance.Mc(new Ju)}}Object(u.a)(Ju,"WordEditorTableEditorsPackage",null,[0,1]);class Lx{get name(){return"WordEditor.TextLevelEditors"}uc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new Lx)}}Object(u.a)(Lx,"WordEditorTextLevelEditorsPackage",null,[0,1]);var NA=d(2003),Mx=d(378),Nr=d(767),Nw=d(213),Ku=d(227);class dt{constructor(b){this.IIk=b}JJl(){const b=Hq.a.instance.createInstance(rn.a.cG);
b.setValue(ze.a.gM,Nw.a.first);b.setValue(ze.a.xWh,0);b.setValue(ze.a.Tta,Lj.OutlineReader.OPl);(new Nr.OutlineIndentInfo(!0)).ZJj(b);return b}Vja(b,h,r=null){const A=b.currentNode;if(!b.ML(1))return this.ASb(b,null,h,r);Ua.a.JN(b)&&Ab.OutlineElementNavigator.m$f(b,!0);return Ua.a.Qh(b)?dt.Of.gz(b,!1,h,r):(b.Vld(A),null)}Aml(b){return Lj.OutlineReader.X_f(b.currentNode)||Ua.a.Qh(b)||Ua.a.JN(b)||Xh.TableCellReader.isTableCell(b)}ASb(b,h=null,r=!1,A=null){if(!this.Aml(b))return null;const M=dt.Of.tob();
this.E_o(M,b);b.vSb(M,h,1,null);b.Yj(M);r&&(dt.Of.qL(b,A),Ab.OutlineElementNavigator.ke(b));return M}E_o(b,h){if(h=this.qKm(h))switch(h.type){case 11:dt.Of.zzf(h,b,!0);break;case 8:h=dt.rj.isRtl(h),dt.Of.k0b(b,h)}}qKm(b){return this.IIk.rKm(b)}j0b(b,h){b.setValue(ze.a.Ds,h?11:9)}kVo(b,h){const r=Ku.WordSectionNavigator.instance.jS(b);return r?Lj.OutlineReader.E_(b)!==h?(r.setValue(Rc.a.kwf,h),!0):!1:null}static get rj(){return cm.PageReader.instance}static get Of(){return dt.Rh||(dt.Rh=$a.a.instance.resolve(16))}static set Of(b){dt.Rh=
b}}dt.Rh=null;dt.Je=null;Object(u.a)(dt,"OutlineEditor",null,[609]);const gE=b=>{b.ia("Box4.OutlineLevelEditors.OutlineEditor",()=>new dt(b.resolve(877))).as(110).ha();b.ia("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new NA.a(b.rf(110),b.rf(31),b.rf(10),b.resolve(878),b.resolve(879),b.resolve(86),b.resolve(493),b.resolve(393),b.resolve(8))).as(16).ha()};class Vv{rTj(){return{qTj:!0,ack:!1}}}Object(u.a)(Vv,"CursorMovementValidator",null,[582]);class ou{get name(){return"Box4.OutlineLevelEditors"}uc(b){b.ia("Box4.ListEditors.CursorMovementValidator",
()=>new Vv).as(1094).ha();gE(b)}init(){}dispose(){}static main(){E.a.instance.Mc(new ou)}}Object(u.a)(ou,"Box4OutlineLevelEditorsPackage",null,[0,1]);class js{constructor(b){this.wZd=null;this.Qij=b.jb("OfficeOnlineChromeExtensionId");this.ajj=b.jb("ChromeClipboardAccessExtensionId");this.phn=b.$("OfficeOnlineChromeExtensionIsEnabled");this.REh=!this.Ypn();this.wZd=this.E0b?this.ajj:this.Qij}bIo(){this.wZd===this.Qij&&this.f_i&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));
this.wZd=this.ajj;this.REh=!0}get E0b(){return this.REh}Ypn(){if(this.phn&&this.f_i){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get f_i(){let b=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){v.ULS.sendTraceTag(19452045,
307,50,h.toString())}return b}}Object(u.a)(js,"ChromeExtensionHelper",null,[1939]);var dn=d(1326),qv=d(677),nC=d(1279);class Nx{create(b){return new nC.a(b)}}Object(u.a)(Nx,"Factory",null,[698]);var en=d(598),rv=d(1020),hE=d(398),mk=d(361),ol=d(923);class Vp extends ol.a{constructor(b,h,r,A,M,ba,oa=null,Ja=null){super(b,ba,oa,Ja);this._formatting=null;this.fRa=!1;this.UDb=y.AFrameworkApplication.J.$("FollowDestinationFormattingPasteIsEnabled");this.jGb=0;this.SQc=new qb.a;Tc.a(8128527,307,Ua.a.Qh(b));
this.IO=h;this.IO.Xdc(this);this.ir=r;this.Ll=A;this.Nd=M;this.Xlf=Ja;this.Y3e=mf.ListItemReader.Dg(this.yc)}get sl(){return null!=this.N2g?this.N2g:this.N2g=$a.a.instance.resolve(349)}get mZd(){return null}get Mfc(){return this.Y3e&&!this.IO.oJa}get oNb(){return 0<this.jGb}Jga(b,h){if(!this.l1.AKg(this.yc,h,!0)){Tc.a(8701077,307,Ed.ParagraphReader.Eh(this.yc));var r=this.yc.currentNode,A=vc.a.Bx(r);this.UDb&&this._formatting.tU&&(r=r.ra.last,this.fRa&&(r.formatting=this._formatting.tU.Mf(r),this.fRa=
!1),b=this.l1.$Rf(b,h),this.l1.Bca(this.yc.currentNode,this._formatting.Qga,h));this.Bg.Ue(A,b)}}Qba(){Tc.a(8701078,307,Ed.ParagraphReader.Eh(this.yc));const b=vc.a.Bx(this.yc.currentNode);this.Bg.Tla(b,h=>new mk.a(h))}hwb(){this.l1.fSf(this.yc)}MMa(){this.UDb&&(this.fRa=!0)}LYa(){Tc.a(8701079,307,Ed.ParagraphReader.Eh(this.yc))}KYa(){Tc.a(8701080,307,Ed.ParagraphReader.Eh(this.yc))}aG(b){this.IO.oJa||(this.UDb?(this.tif(b),this._formatting.vsd(this.yc.currentNode),b&&"P"===b.Zba.Eae&&this.Xlf.wha(this.yc.currentNode,
this._formatting.LP),this.l1.Bca(this.yc.currentNode,this._formatting.Qga,b)):this.zdl(b))}uH(){this.IO.oJa||this.wAa()}PYa(){}vcb(){}WCa(){Tc.a(8701081,307,Ua.a.Qh(this.yc)||Lj.OutlineReader.zy(this.yc)||Ed.ParagraphReader.Eh(this.yc)&&this.IO.oJa);let b=!1;this.oNb||(b=this.Mfc||!0);b||(this.iY+=1);this.jGb++}UCa(){this.jGb--;let b=!1;this.oNb||(b=this.Mfc||!0,this.Ll.cDj(this.SQc));b||--this.iY}PMa(b){Tc.a(8701082,307,Ua.a.Qh(this.yc)||Lj.OutlineReader.zy(this.yc)||Ed.ParagraphReader.Eh(this.yc)&&
this.IO.oJa);Tc.a(8701083,307,!!b.listStyleType)}VCa(){Tc.a(8701084,307,Ua.a.Qh(this.yc)||Ed.ParagraphReader.Eh(this.yc)&&this.IO.oJa);this.IO.oJa||Tc.a(8701085,307,this.yc.pv(2))}Wba(b){this.IO.Wba(b)}Uba(){this.IO.Uba()}isd(b){this.SQc.add(b)}n8(b){this.IO.n8(b)}Vba(){this.IO.Vba()}Tba(b){this.IO.Tba(b)}Sba(){this.IO.Sba()}zdl(b){this.Wrc(!1);(new zc.a).kd(this.yc);b=ol.a.Of.qL(this.yc,this.Z3c(b));Tc.a(8128534,307,b===this.yc.currentNode);Tc.a(8128535,307,Ed.ParagraphReader.Vb(b))}wAa(){Tc.a(8128536,
307,Ed.ParagraphReader.Eh(this.yc));Ab.OutlineElementNavigator.ke(this.yc)}reset(){this.UDb&&(super.reset(),this._formatting=this.eJf(!0))}tif(b){this.Wrc(!1);(new zc.a).kd(this.yc);b=ol.a.Of.qL(this.yc,this.Z3c(b));Tc.a(36577367,307,b===this.yc.currentNode);Tc.a(36577368,307,Ed.ParagraphReader.Vb(b));-1!==this._formatting.Ix&&this.sl.HH(b,this._formatting.Ix);this._formatting.lineSpacing&&this.Xlf.bF(b,this._formatting.lineSpacing);this._formatting.T8&&this.Xlf.pye(b,this._formatting.T8);this.fRa=
!0;this._formatting.paragraph=b}static usf(b,h){let r=0;switch(h){case 3:r=Cg.a.uD(b);break;case 7:r=Rh.a.gA(b,0);break;case 1:r=Cg.a.hof(b);break;case 5:r=Cg.a.uD(Cg.a.llg(b));break;default:v.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return r}}Object(u.a)(Vp,"TextOnlyBox4PasteSteward",ol.a,[]);class ko extends Vp{constructor(b,h,r,A,M,ba,oa,Ja=null,jb=null){super(h,r,A,M,ba,oa,Ja,jb);this.$Jc=!1;this.PEb=[];this.JHh=
b;h={};h.textOnlyPasteFlags=b;v.ULS.sendTraceTag(509088282,307,50,G.c(h))}reset(){super.reset();this.$Jc=!1;this.PEb.length=0;this.gEd=!1}aG(b){this.$Jc||(super.aG(b),this.$Jc=!0)}uH(){this.gEd?this.gEd=!1:this.Qba(null)}Qba(b){this.JHh&2||super.Qba(b)}WCa(){}UCa(){}PMa(){}VCa(){}Wba(){}Uba(){}n8(b){this.$Jc||(super.n8(b),this.$Jc=!0);this.PEb.push(!1)}Vba(){this.JHh&1&&this.Qba(null);0<this.PEb.length?this.PEb.pop():Tc.a(509088281,307,!1)}Tba(){var b=this.PEb.length-1;0<=b?this.PEb[b]?(b=vc.a.Bx(this.yc.currentNode),
this.Bg.Ue(b,", ")):this.PEb[b]=!0:Tc.a(509088280,307,!1);this.gEd=!0}Sba(){this.gEd=!1}isd(){}}Object(u.a)(ko,"StrictTextOnlyBox4PasteSteward",Vp,[]);class Ms{constructor(b,h,r,A){this.f3e=b;this.VM=h;this.kg=r;this.l1=A}create(b,h,r,A,M=null,ba=null,oa=null,Ja=null){return 1===b?null!==Ja&&0!==Ja?new ko(Ja,h,A,this.f3e,this.VM,this.kg,M,ba,this.l1):new Vp(h,A,this.f3e,this.VM,this.kg,M,ba,this.l1):new hE.Box4PasteSteward(h,r,A,this.f3e,this.VM,this.kg,M,new wk.b,ba,this.l1,oa)}}Object(u.a)(Ms,"Box4PasteStewardFactory",
null,[697]);var Lu=d(176),Xt=d(372),ur=d(1045);class pu{constructor(b,h,r){this.qA=null;this.kGb=0;this.yc=b;this.jk=r}Xdc(b){this.qA=b}get oJa(){return 0<this.kGb}Wba(b){Tc.a(7869459,307,!!this.qA);Tc.a(7869460,307,Ua.a.Qh(this.yc)||Lj.OutlineReader.zy(this.yc));Tc.b(38563978,307,50,"Table pasting started");this.qA.Wrc(!0);const h=new zc.a;h.kd(this.yc);var r=ur.a.n4m[b.styleId];r||(y.AFrameworkApplication.nd("gdea6103;0df65435"),b.MXf?(v.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),
r=ur.a.NTn):r=ur.a.Ndi);r=this.jk.$to(this.yc,b.rowCount,b.Lnb,r,b.tableLook,this.qA.Z3c(b),b.MXf);b.eHg&&(Tc.b(573691298,3022,100,"Applying table border properties"),ur.a.USh(b.eHg,this.yc,!1,!0));b.xbe&&(Tc.b(573691299,3022,100,"Applying indentation properties"),ur.a.$8k(this.yc,b.xbe.spaceBefore,b.xbe.spaceAfter));b.uWd&&(Tc.b(573691328,3022,100,"Applying column widths"),ur.a.I8k(b.uWd,this.yc,Object(Ma.a)(Xt.TableNode,r),b.Oab));this.qA.KSd(h,!1);this.kGb++;mf.ListItemReader.Dg(h)&&this.qA.isd(h.currentNode);
Tc.a(7869461,307,Hi.TableReader.isTable(this.yc))}Uba(){Tc.a(7869462,307,!!this.qA);Tc.a(7869463,307,Cn.a.isTableRow(this.yc));Tc.b(38563979,307,50,"Table pasting finished");this.yc.mt(14)&&ur.a.dKj(this.yc.so);Ab.OutlineElementNavigator.ke(this.yc);this.kGb--}n8(b){Tc.a(7869464,307,!!this.qA);Tc.b(573691329,3022,100,"Table row pasting started");Hi.TableReader.isTable(this.yc)?bi.moveToFirstRow(this.yc):Cn.a.isTableRow(this.yc)&&bi.moveToNextRow(this.yc);b.height&&(Tc.b(573691330,3022,100,"Applying table row height"),
ur.a.V9k(this.yc,b.height));Tc.a(7869465,307,Cn.a.isTableRow(this.yc))}Vba(){Tc.a(7869466,307,!!this.qA);Tc.a(7869467,307,Xh.TableCellReader.isTableCell(this.yc));bi.returnToContainingRow(this.yc)}Tba(b){Tc.a(7869468,307,!!this.qA);Tc.a(7869469,307,!this.qA.iY);Cn.a.isTableRow(this.yc)?bi.moveToFirstColumn(this.yc):Xh.TableCellReader.isTableCell(this.yc)?bi.moveToNextColumn(this.yc):Tc.a(7869471,307,!1);if(this.yc.currentNode){Tc.b(573691331,3022,100,"Table cell pasting started");var h=Object(Ma.a)(Lu.TableCellNode,
this.yc.currentNode);Tc.a(50689760,307,!h&&16!==this.yc.currentNode.type||!!h&&16===this.yc.currentNode.type);if(h){var r=new zc.a;r.kd(this.yc);if(b.upc)Tc.b(573691332,3022,100,"Processing skipped cell"),ur.a.rko(r,b);else{if(1<b.colSpan||1<b.rowSpan){const A=bi.returnToContainingTable(r);if(!A)return;A.setValue(Rc.a.complexTable,!0);r.kd(this.yc);Tc.b(573691333,3022,100,"Processing merged cell");ur.a.Hjo(r,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}ur.a.$9k(this.yc,b.shadingColor);ur.a.R$k(this.yc,
b.verticalAlignment);ur.a.w8k(this.yc,b.YBe);ur.a.USh(b.Una,this.yc,!b.colSpan&&!b.rowSpan,!1);(new zc.a).kd(this.yc);bi.forEachCell(r,b.rowSpan,b.colSpan,(A,M,ba)=>{Tc.b(573691334,3022,100,"Setting ghost cell borders");ur.a.yOj(A,b.Una,M,ba,b.rowSpan,b.colSpan)});ur.a.T$k(this.yc,b.width,b.Oab);Tc.a(7869472,307,Lj.OutlineReader.zy(this.yc))}}}}Sba(){Tc.a(7869473,307,!!this.qA);Tc.a(7869474,307,Ua.a.Qh(this.yc)||Xh.TableCellReader.isTableCell(this.yc));bi.returnToCell(this.yc);Tc.a(7869475,307,0>=
this.qA.iY);this.qA.dpf()}}Object(u.a)(pu,"Box4TableSteward",null,[724,314]);class ks{constructor(b,h,r){this.qA=null;this.kGb=0;this.yc=b;this.jk=r}Xdc(b){this.qA=b}get oJa(){return 0<this.kGb}Wba(){this.oJa&&(Tc.a(8787101,307,Ed.ParagraphReader.Eh(this.yc)),Ab.OutlineElementNavigator.ke(this.yc));Tc.a(8701086,307,!!this.qA);Tc.a(8701087,307,Ua.a.Qh(this.yc)||Lj.OutlineReader.zy(this.yc));this.kGb++}Uba(){Tc.a(8701088,307,!!this.qA);Ab.OutlineElementNavigator.ke(this.yc);this.kGb--;if(this.oJa){this.qA.Wrc(!0);
const b=ks.Of.qL(this.yc);Tc.a(8787102,307,b===this.yc.currentNode);Tc.a(8787103,307,Ed.ParagraphReader.Eh(this.yc))}}n8(b){Tc.a(8701089,307,!!this.qA);this.qA.Wrc(!0);const h=new zc.a;h.kd(this.yc);this.qA.KSd(h,!1);mf.ListItemReader.Dg(h)&&this.qA.isd(h.currentNode);b=ks.Of.qL(this.yc,this.qA.Z3c(b));Tc.a(8701090,307,b===this.yc.currentNode);Tc.a(8701091,307,Ed.ParagraphReader.Eh(this.yc))}Vba(){Tc.a(8701120,307,!!this.qA);Tc.a(8701121,307,Ed.ParagraphReader.Eh(this.yc));Ab.OutlineElementNavigator.ke(this.yc)}Tba(){Tc.a(8701122,
307,!!this.qA);Tc.a(8701123,307,Ed.ParagraphReader.Eh(this.yc));Tc.a(8701124,307,!this.qA.iY);var b=this.yc.currentNode;Ed.ParagraphReader.textLength(b)&&(b=vc.a.Bx(b),this.qA.Bg.Ue(b,", "))}Sba(){Tc.a(8701125,307,!!this.qA);Tc.a(8701126,307,Ed.ParagraphReader.Eh(this.yc));Tc.a(8701127,307,0>=this.qA.iY);this.qA.dpf()}static get Of(){return null!=ks.a2g?ks.a2g:ks.a2g=$a.a.instance.resolve(16)}}Object(u.a)(ks,"TextOnlyBox4TableSteward",null,[724,314]);class iE{constructor(b,h,r=!1,A=!1){this.VM=b;
this.LG=h;this.nJk=r;this.uJk=A}create(b,h){return 1===b?new ks(h,this.VM,this.LG):new pu(h,this.VM,this.LG,this.nJk,this.uJk)}}Object(u.a)(iE,"Box4TableStewardFactory",null,[696]);class In{create(){return new sn.a}}Object(u.a)(In,"Factory",null,[693]);class PI{constructor(){this.llh=!1}get wae(){return this.llh}set wae(b){this.llh=b}}Object(u.a)(PI,"HighContrastColorPickerState",null,[695]);class sh{constructor(b){this.ga=b}get Qb(){return this.ga}ijl(b,h,r=null){const A=new ji.DictionaryPropertySet;
A.setValue(Bd.a.iC,b);A.setValue(Bd.a.dYa,h);r&&A.At(r);A.CommandSource="autobulleting";this.Qb.Pb(ub.a.fF,2,A)}KVn(b,h,r,A,M){const ba=new ji.DictionaryPropertySet;ba.setValue(Bd.a.iC,b);ba.setValue(Bd.a.dYa,h);ba.setValue(Bd.a.cMa,r);M&&ba.setValue(Fe.a.RT,M);A&&ba.setValue(Rc.a.Yw,A);ba.setValue(Fe.a.Wta,"autocorrect");M&&ba.setValue(Fe.a.xma,M);ba.CommandSource="autonumbering";return 32===this.Qb.Pb(ub.a.aO,2,ba)}}Object(u.a)(sh,"ListCommands",null,[694]);var Qp=d(114);class Fx{constructor(b,
h,r,A,M){this.Ll=b;this.XVn=h;this.Oj=r;this.Pd=A;this.Bg=M}get Hij(){return this.XVn.value}execute(b,h,r,A){const M=Wg.a.instance.wq(ub.a.cYo);Ua.a.isEmpty(b,!1)?this.b5l(b):this.c5l(b,h,r,A);M.end()}b5l(b){this.Hij.znf(b,-1)?this.Hij.CZa(b,-1,0):this.Ll.nca(b,{UCj:!0})}c5l(b,h,r,A){h=A(b,h,r);b=Ed.ParagraphReader.fn(b.currentNode);!this.Ll.czb&&this.Hvn(b)&&this.t0k(h);this.Ll.Z0();(null===b||void 0===b?0:b.ra)&&!b.ra.last.formatting&&this.Bg.u8a(b)}Hvn(b){return b.nj&&!b.Nx.hasProperty(Rc.a.listID)}t0k(b){Ab.OutlineElementNavigator.Me(b);
b=b.currentNode;const h=new Qp.a;b.Ic.nu(h);this.Oj.fQ(b,h,this.Pd.Ag)}}Object(u.a)(Fx,"ListNewLineStrategy",null,[]);var tn=d(521);class jE{constructor(b){this.ga=b}wQn(b){if(4===b)b=ub.a.xCa;else if(2===b)b=ub.a.mha;else if(1===b)b=ub.a.yAb;else if(3===b)b=ub.a.aVa;else return;this.ga.Ob(b,2)}B8a(){this.ga.Ob(ub.a.B8a,2)}}Object(u.a)(jE,"SelectionCommands",null,[692]);var Ox=d(229),oC=d(1079),ls=d(142),QI=d(489);class pC{constructor(){this.Gad=!1;this.zHp=y.AFrameworkApplication.J.jb("WordEditorVisiFontFileUri");
this.BHp=y.AFrameworkApplication.J.jb("WordEditorVisiRtlFontFileUri");this.AHp=y.AFrameworkApplication.J.jb("WordEditorVisiPilcrowFontFileUri");this.wHp=y.AFrameworkApplication.J.jb("WordEditorVisiCarriageReturnFontFileUri");this.yHp=y.AFrameworkApplication.J.jb("WordEditorVisiCarriageReturnRtlFontFileUri")}Tnp(){this.Gad=!this.Gad}Snp(b){this.Tnp();let h=b.getElementsByClassName("VisiFontStyle")[0],r=b.getElementsByClassName("VisiFontRtlStyle")[0],A=b.getElementsByClassName("VisiFontPilcrowStyle")[0],
M=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],ba=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",xd.a.Rx(h,""),b.appendChild(h));r||(r=document.createElement("Style"),r.className="VisiFontRtlStyle",xd.a.Rx(r,""),b.appendChild(r));A||(A=document.createElement("Style"),A.className="VisiFontPilcrowStyle",xd.a.Rx(A,""),b.appendChild(A));M||(M=document.createElement("Style"),M.className="VisiFontCarriageReturnStyle",
xd.a.Rx(M,""),b.appendChild(M));ba||(ba=document.createElement("Style"),ba.className="VisiFontCarriageReturnRtlStyle",xd.a.Rx(ba,""),b.appendChild(ba));if(this.Gad)return v.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.HTc(h)&&this.HTc(r)&&this.HTc(A)&&this.HTc(M)&&this.HTc(ba);v.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");return this.Rkd(h)&&this.Rkd(r)&&this.Rkd(A)&&this.Rkd(M)&&this.Rkd(ba)}HTc(b){return""===xd.a.Vz(b)?("VisiFontStyle"===b.className?
xd.a.Rx(b,this.l3c("WordVisi_MSFontService",this.zHp)):"VisiFontRtlStyle"===b.className?xd.a.Rx(b,this.l3c("WordVisiRtl_MSFontService",this.BHp)):"VisiFontPilcrowStyle"===b.className?xd.a.Rx(b,this.l3c("WordVisiPilcrow_MSFontService",this.AHp)):"VisiFontCarriageReturnStyle"===b.className?xd.a.Rx(b,this.l3c("WordVisiCarriageReturn_MSFontService",this.wHp)):"VisiFontCarriageReturnRtlStyle"===b.className&&xd.a.Rx(b,this.l3c("WordVisiCarriageReturnRtl_MSFontService",this.yHp)),!0):!1}Rkd(b){return""!==
xd.a.Vz(b)?(xd.a.Rx(b,""),!0):!1}l3c(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(u.a)(pC,"VisiMarkersOperation",null,[690]);var Wv=d(1468),vr=d(936);class Dy extends Wv.a{constructor(b,h){super(b,h);this.WVe=-1;this.SDb=0;this.KSe=null;this.xmh=!1;this.TTe=[];this.XEd=!1;this.Mvh=!0;this.r2e=this.QCd=null;this.preventDismissOnScroll=this.Pqe=this.Cuc=!1;this.uaa=null;this.YOd=!1;this.k6c=!0;this.Xt=!1;
this.Qoh=y.AFrameworkApplication.J.$("FloatieLightDismissIsEnabled");Dy.BBh||(y.AFrameworkApplication.va.qa(La.a.showFloatie,xe.a.frame,kd.ActionManager.$f),Dy.BBh=!0)}get Fpi(){return this.ZQ}set Fpi(b){this.ZQ=b}get x2j(){return this.YOd}get n7c(){return this.xmh}set n7c(b){this.xmh=b;this.SDb=0}get BC(){return!0}get cssClass(){return y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.wba?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Xt}B_a(){for(const b of this.children)if(b.B_a())return!0;
return!1}get rca(){return 9}Wf(b){this.TTe[this.TTe.length]=b;super.Wf(b)}Bn(){super.Bn();Mf.c(this.Rc)&&this.vE();this.Rc=Yg.a.$Za(this.Rc);this.c_(this.Rc);this.dirty=!1}Rsc(b){3===b.yg||this.Pqe||this.dismissFloatie(b);return!1}Usc(){return!1}Ssc(b){3!==b.yg&&this.k6c&&!this.Cuc&&this.ZAp(b);return!1}Tsc(){return!1}Psc(b){3===b.yg&&this.dismissFloatie(b);return!1}Qsc(b){void 0!==this.uaa&&null!==this.uaa||this.preventDismissOnScroll||this.dismissFloatie(b);return!1}LE(){this.aBf();return!1}fne(){this.n7c=
!0}ZAp(b){if(b=Lg.a.hhc(b.clientPoint,this.KSe)){if(this.n7c){if(!this.SDb||b<this.SDb)this.SDb=b;b-=this.SDb}b-=this.WVe;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.dismissFloatie():X.a.setOpacity(this.Rc,Math.max(h/255,0))}else this.n7c=!1,this.SDb=0,X.a.setOpacity(this.Rc,1)}ozp(b){let h=null;void 0!==this.QCd&&null!==this.QCd&&(h=this.QCd(b));b=null;for(const r of this.TTe){let A=!this.x2j&&r.H3i;if(!A&&void 0!==h&&null!==h)for(let M=0;M<h.length;M++)if(r.id===h[M]){A=!0;break}r.Rc.style.display=
A?"none":"";r.ehc=!A;A||(b=r)}b&&(b.ehc=!1)}Eyi(){const b=this.Rc.style.top,h=this.Rc.style.left;this.Rc.style.top="0px";this.Rc.style.left="0px";const r=this.YPb();this.Rc.style.top=b;this.Rc.style.left=h;return r}YPb(){const b=this.Rc.style.visibility,h=this.Rc.style.display;this.Rc.style.visibility="hidden";this.Rc.style.display="";const r=Te.a.getElementBounds(this.Rc);this.Rc.style.display=h;this.Rc.style.visibility=b;return r}zAj(b){3===b||this.CDe?(Sys.UI.DomElement.addCssClass(this.Rc,vr.a.h2b),
this.YOd=!0):(Sys.UI.DomElement.removeCssClass(this.Rc,vr.a.h2b),this.YOd=!1);this.ozp(b)}Ieb(b,h,r,A=!1){this.isVisible||(this.uaa||!this.Mvh&&this.preventDismissOnScroll||(this.Mvh=!1,Te.a.Fje("ShowLegacyFloatie",""),y.AFrameworkApplication.va.Ob(La.a.showFloatie,2)),this.zAj(r),this.k6c=!0,this.SDb=0,this.n7c=!1,!this.Qoh||void 0!==this.uaa&&null!==this.uaa?(this.XEd=!1,this.bka(this,!1)):(this.XEd=!0,this.ydl(this)),h=A?b:this.Dfo(b,h),this.Rc.style.top=h.y.toString()+"px",this.Rc.style.left=
h.x.toString()+"px",this.uv(),this.KSe=this.YPb(),this.WVe=Lg.a.hhc(b,this.KSe),X.a.setOpacity(this.Rc,1),this.Rc.style.zIndex=String(y.AFrameworkApplication.ta.Mya),this.Rc.style.display="",this.Xt=!0)}Dfo(b,h){const r=this.x2j?30:17,A=this.Eyi(),M=xd.a.zrb(),ba=xd.a.tX();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=A.height:3===h?(b.y-=A.height,b.x-=A.width):2===h&&(b.x-=A.width);b.x+A.width>M&&(b.x=Math.floor(M-A.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-r:b.y+r;0>b.y&&(b.y=0);b.y+A.height>ba&&(b.y=
ba-A.height);return b}Efo(b,h){const r=b.Wdj;if(r){this.zAj(h);var A=this.Eyi();this.uaa=b;b=r.xOg-r.r1c>A.width;var M=r.r1c+r.IEf>A.width,ba=r.Wic>A.height+17,oa=r.jbk-(r.Wic+r.EEf)>A.height+17;A=new Sys.UI.Point(r.r1c,r.Wic);M||b||(M=!0,A.x=r.xOg);b=r.yub?r.M3f?oa?M?2:0:M?3:1:ba?M?3:1:M?2:0:r.M3f?oa?b?0:2:b?1:3:ba?b?1:3:b?0:2;if(3===b||2===b)A.x=r.r1c+r.IEf;if(2===b||0===b)A.y=r.Wic+r.EEf;this.Ieb(A,b,h);this.k6c=!1;h=this.uaa.hef.Rc;void 0!==h&&null!==h&&(h.style.zIndex=String(y.AFrameworkApplication.ta.Mya))}}T6(){let b=
super.T6();this.dismissFloatie()&&(b=!0);return b}dismissFloatie(b=null){if(!this.isVisible)return!1;void 0!==this.sSc&&null!==this.sSc&&this.sSc.dAa(null);void 0!==this.uaa&&null!==this.uaa&&this.uaa.G6();this.G6();this.Qoh&&this.XEd?this.t1l(this):this.gfa(this,!1);this.XEd=!1;this.WVe=-1;this.uaa=null;this.Rc.style.display="none";this.Xt=!1;this.r2e&&this.r2e(b);return!0}aBf(){void 0!==this.uaa&&null!==this.uaa&&(this.uaa.S5a=null,this.uaa.G6(),this.uaa=null,this.bke.style.zIndex=String(y.AFrameworkApplication.ta.OHa),
this.Rc.style.zIndex=String(y.AFrameworkApplication.ta.Mya))}Gwo(b){this.QCd=b}xxo(b){this.r2e=b}set BC(b){super.BC=b}}Dy.BBh=!1;Object(u.a)(Dy,"Floatie",Wv.a,[642,410,411]);class Ey{constructor(b,h){this.Dw=this.cRa=null;this.gbj=b;this.aJj=h}get Hpi(){return this.cRa}c2o(b){this.cRa=b}YPb(){return this.Dw.YPb()}t3(){return this.Dw?this.Dw.isVisible:!1}gWh(b){this.c2o(b)}showFloatie(b,h){this.Ieb(h.location,h.fz,h.isRtl)}Ieb(b,h,r){r=r?this.aJj:this.gbj;this.u1d();this.Dw&&this.Dw.Ieb(b,r,h)}dismissFloatie(){this.Dw&&
this.Dw.dismissFloatie()}u1d(){this.cRa&&!this.Dw&&(this.Dw=Object(Ma.a)(Dy,this.cRa()))}f2d(){}}Object(u.a)(Ey,"AFloatieManager",null,[723]);class Fy extends Ey{constructor(){super(1,3);this.E0j=!1;this.ifi=""}Ieb(b,h,r){r=r?this.aJj:this.gbj;this.u1d();this.Dw&&(this.Dw.isVisible&&this.Dw.dismissFloatie(),this.E0j||this.Dw.An(),this.Dw.Ieb(b,r,h,!0))}u1d(){this.Hpi&&!this.Dw&&(this.Dw=this.cRa())}f2d(){if(this.Dw&&this.Dw.isVisible){const b=Object(Ma.a)(Hl.a,this.Dw.controls["PasteFloatie.FlyoutAnchor"]);
b.behavior.oy(b.Sqb(),1,null)}}KAg(b){this.ifi=b}qEo(b){b=b.aJf("Menu16",null);zg.a("renderIcon")&&b&&appChrome.api.renderIcon(Fy.auk,b.firstElementChild)}kBc(b,h,r){if(this.Dw){const A=this.Dw.controls[this.ifi];A&&(Fy.moh||(this.qEo(A),Fy.moh=!0),A.Ud[Cm.a.labelText]=b,A.Ud[Cm.a.alt]=h,r&&A.behavior.An())}}}Fy.moh=!1;Fy.auk="Designer_20";Object(u.a)(Fy,"PasteFloatieManager",Ey,[]);var Ow=d(1032);class Gy{constructor(){this.Od=null}get Jv(){return null}getTitle(){return null}dxi(){return null}reset(b){this.Od=
b.node}MEa(b){b=bm.d(this.Od,b);let h=null;if(!b||b.$h!==this.$h)return{returnValue:!1,OG:h};h=Object.assign(new Ow.a,{fG:this.key,contentObject:b,title:this.getTitle(b),description:this.dxi(b)});return{returnValue:!0,OG:h}}}Object(u.a)(Gy,"BlobDetailsProvider",null,[144,136]);class Xv extends Gy{constructor(){super()}get key(){return"EQUATION"}get $h(){return 11}get Jv(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(u.a)(Xv,"EquationDetailsProvider",Gy,[]);class qC{constructor(){this.Ylh=
null}get key(){return"LINK"}get Jv(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.Ylh=Oc.a.qkc(b.node)}MEa(b){let h=null;for(const r of this.Ylh)if(r.cpBegin<=b&&b<r.cpEnd)return h=Object.assign(new Ow.a,{fG:this.key,contentObject:r.hyperlink}),{returnValue:!0,OG:h};return{returnValue:!1,OG:h}}}Object(u.a)(qC,"HyperlinkDetailsProvider",null,[144,136]);var OA=d(1258),vz=d(909);class RI{constructor(){this.frh=!1}get key(){return"IFRAMENODE"}get Jv(){return this.frh?Box4Intl.Box4Strings.l_IFrameVideoTitle:
Box4Intl.Box4Strings.l_IFrameWebContentTitle}s2b(b){let h=null;b=b?Ed.ParagraphReader.zKa(b.currentNode):null;if(!b)return{returnValue:!1,Sea:h};h=Object.assign(new OA.a,{fG:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,Sea:h}}Oqb(b,h){b=b?Object(Ma.a)(vz.a,b.contentObject):null;h=h?Object(Ma.a)(vz.a,h.contentObject):null;let r="";h&&b.id===h.id||(this.frh=b.dbb,r=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.Jv,this.Jv));return r}}Object(u.a)(RI,"IFrameDetailsProvider",
null,[135,136]);class SI extends Gy{constructor(){super()}get key(){return"IMAGE"}get $h(){return 5}reset(b,h){super.reset(b,h);this.ECk=!Le.a.Fm(h)}get Jv(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return je.a.I_(b.properties)}dxi(b){b=je.a.$Va(b.properties);return this.ECk&&(y.AFrameworkApplication.nd("51a6c128;f7eb8687"),y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImageSelectionAnnouncement",!1))?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,
b):b}}Object(u.a)(SI,"ImageDetailsProvider",Gy,[]);class et{get key(){return"IMAGENODE"}get Jv(){return Box4Intl.Box4Strings.l_ImageContentTitle}s2b(b){let h=null;if(!b||!je.a.Lt(b.currentNode))return{returnValue:!1,Sea:h};h=Object.assign(new OA.a,{fG:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,Sea:h}}Oqb(b,h){b=b.contentObject;const r=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let A="";h&&b.id===h.contentObject.id||(A=String.format(r,je.a.I_(b.properties),
Box4Intl.Box4Strings.l_ImageContentTitle));return A}}Object(u.a)(et,"ImageNodeDetailsProvider",null,[135,136]);var pG=d(756);let Pw,sv;class Qw{constructor(b,h){this.Qgh=null;this.qo=h;this.p5e=b;this.key=Qw.keys.K(b);this.Jv=Qw.$rf.K(b)}reset(b){this.Qgh=this.qo.p7(b.node);pG.a.B1e++}MEa(b){var h=Qw.gEf(this.Qgh||[],r=>this.Win(b,r));h=this.QFl(h);return{returnValue:!!h,OG:h}}Win(b,h){return h.Dc<=b&&b<h.end&&(!h.errorDetails||this.p5e===h.errorDetails.proofingType)}QFl(b){return b?Object.assign(new Ow.a,
{fG:this.key,contentObject:b.errorDetails,description:this.MVa()}):null}MVa(){return Lk.a.MLa?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static gEf(b,h){for(const r of b)if(h(r))return r;return null}}Qw.keys=(sv=new yf.a,sv.add(1,"SPELLINGERROR"),sv.add(2,"GRAMMATICALERROR"),sv.add(3,"ADVANCEDERROR"),sv);Qw.$rf=(Pw=new yf.a,Pw.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Pw.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Pw.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),
Pw);Object(u.a)(Qw,"ProofingDetailsProvider",null,[144,136]);class Yv{constructor(){this.Ep=null;this.sWd=this.Fve=this.columns=this.rows=0}}Object(u.a)(Yv,"TableInfo",null,[]);class qG{get key(){return"TABLE"}get Jv(){return Box4Intl.Box4Strings.l_TableContentTitle}s2b(b){var h=null;if(!Xh.TableCellReader.isTableCell(b))return{returnValue:!1,Sea:h};h=new zc.a;h.kd(b);b=new Yv;b.Fve=Cn.a.It(h)+1;b.sWd=Kx.a(h)+1;bi.returnToContainingTable(h);b.Ep=h.currentNode;b.columns=Hi.TableReader.Dh(b.Ep);b.rows=
Hi.TableReader.ug(b.Ep);h=Object.assign(new OA.a,{fG:this.key,contentId:b.Ep.id,contentObject:b});return{returnValue:!0,Sea:h}}Oqb(b,h){b=b.contentObject;const r=new dc.a;h||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.sWd===b.sWd||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.sWd));h&&h.contentObject.Fve===b.Fve||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.Fve));return r.toArray().join(" ")}}
Object(u.a)(qG,"TableDetailsProvider",null,[135,136]);class wz{constructor(b,h){this.hRa=b;this.qo=h}get R2b(){return null!=this.N6g?this.N6g:this.N6g=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}jrg(){this.hRa.execute(b=>{b.nY(new qC);Lk.a.zXf()||(this.R2b||(b.nY(new Qw(1,this.qo)),b.nY(new Qw(2,this.qo))),b.nY(new Qw(3,this.qo)));b.nY(new Xv);b.nY(new SI);b.uZb(new qG);b.uZb(new et);b.uZb(new RI)})}}Object(u.a)(wz,"AccessibilityActor",
null,[]);class TI{constructor(b,h,r){this.x7n=(A,M,ba)=>{if(1===ba)return 32;this.vpk().GDg();return 32};this.v5a=b;this.vpk=r}Wb(){this.v5a.fb(ub.a.Lpj,mc.a.view,this.x7n,1028)}}Object(u.a)(TI,"AutoCorrectActor",null,[]);class rC{constructor(){this.Aje=!0}SCa(){}ycb(){}Xdc(){}Igg(){}Fxe(){}get euc(){return!1}get Fvb(){return 0}get mdj(){return!1}get s_(){return hb.a.nil}}Object(u.a)(rC,"TextOnlyBox4ImageSteward",null,[514]);class kE{constructor(b,h,r,A,M,ba,oa=!1){this.VR=b;this.$i=h;this.rh=r;this.b6m=
A;this.lK=M;this.qc=ba;this.pEn=oa}create(b,h,r,A){return 1===b?new rC:new Go.a(h,this.VR,this.$i,this.rh,this.qc,this.b6m,this.lK,this.pEn,r,A)}}Object(u.a)(kE,"Box4ImageStewardFactory",null,[689]);var Np=d(31);class sC{constructor(b){this.ofe=b}xqn(b){if(!b||!b.tD||1>b.tD.count)return!1;const h=[Np.a.Rbi,Np.a.Qbi];return!!this.s5d(b.tD,1,r=>this.sXd(r,h))}FXi(b){return!b||!b.tD||1>b.tD.count?!1:!!this.s5d(b.tD,1,h=>this.sXd(h,[Np.a.uI]))}mnn(b){return!b||!b.tD||1>b.tD.count?!1:!!this.s5d(b.tD,2,
h=>this.sXd(h,[Np.a.Dbd]))}Eh(b){return!b||!b.tD||1>b.tD.count?!1:!!this.s5d(b.tD,1,h=>this.sXd(h,[Np.a.Zma]))}fee(b){if(!b||!b.tD)return!1;b=b.tD;for(let h=0;h<b.count;++h)if(!b.K(h)||0<b.K(h).Jbl)return!1;return!0}c4l(b,h){return this.FXi(h)||this.mnn(h)?"":b}s5d(b,h,r){if(b&&0<b.count)for(let A=b.count-1;0<=A;--A){if(r(b.K(A)))return b.K(A);if(b.count-A>=h)break}return null}sXd(b,h){b=b&&b.CPi?b.CPi.split(" "):null;if(!b)return!1;for(const r of h)if(0<=Array.indexOf(b,r))return!0;return!1}}Object(u.a)(sC,
"Box4PasteStewardUtils",null,[688]);var ft=d(731);class PA{constructor(){this.YAc=0;this.Pqc=Array(9)}}Object(u.a)(PA,"FullListMetadata",null,[]);class QA{constructor(b,h,r){this.YAc=this.level=0;this.Zmi=null;this.Utc=!1;this.level=b;this.TGe=h;this.F8n=r}}Object(u.a)(QA,"ListItemMetadata",null,[]);var Px=d(1259);class Zv{constructor(){this.level=0;this.tagName="UL";this.hvb=null;this.mUf=!1;this.yVn=0;this.listStyle="BulletListStyle1";this.Nub=new Px.a;this.font=this.levelText=""}}Object(u.a)(Zv,
"ListLevelMetadata",null,[]);class Qx{constructor(){}}Object(u.a)(Qx,"LevelLists",null,[]);class tC{constructor(b){this.nodes=b;this.JUa=0;this.lists={};this.Nub=[];this.Q5i=null;this.FNl=[];this.FNl[0]=new Qx}}Object(u.a)(tC,"WordConverterArguments",null,[]);var vp=d(374),Rw=d(701);class Am{}Am.yOl="data-ccp-timestamp";Am.GZd="data-clipservice-ccpid";Am.BOl="data-shapeids";Am.mUm="docs-internal-guid-";Am.i7n="SCXO";Am.cgo="SCXP";Am.SJp="SCXW";Am.rRn="MsoListParagraphCxSpFirst";Am.sRn="MsoListParagraphCxSpLast";
Am.Uvf="data-pkey";Am.Vvf="data-clipservice-type";Am.Svf="data-clipservice-count";Am.Tvf="data-clipservice-dc";Am.CYc="data-clipservice-client";Am.Wvf="data-clipservice-version";Object(u.a)(Am,"HtmlContentMetadataConstants",null,[]);class RA{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(u.a)(RA,"AbsolutePosition",null,[]);var Mu=d(867);class xz{constructor(b,h,r="",A=0){this.Oy=!1;this.Llh=this.Mlh=null;let M=!1;xz.vmn(b)&&(M=!0,this.Mlh=b);xz.Omn(h)&&(this.Llh=h);this.yzk=r;this.cpk=
A;this.Oy=M&&this.Eae?!0:!1}get isValid(){return this.Oy}get FPi(){return this.Mlh}get Eae(){return this.Llh}get CPi(){return this.yzk}get Jbl(){return this.cpk}static vmn(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static Omn(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(u.a)(xz,"HtmlElementInfo",null,[]);class Rx{constructor(b){this.next=null;this.data=b}}Object(u.a)(Rx,"StackNode",null,[]);class Sw{constructor(){this.zr=null;this.Qk=0}get count(){return this.Qk}get isEmpty(){return!this.count||
!this.zr}push(b){b=new Rx(b);b.next=this.zr;this.zr=b;this.Qk=this.count+1}nV(){return this.count&&this.zr?this.zr.data:null}pop(){if(!this.count||!this.zr)return null;const b=this.zr;this.zr=b.next;this.Qk=this.count-1;return b.data}clear(){this.zr=null;this.Qk=0}toArray(){const b=Array(this.count);let h=this.zr;for(let r=this.count-1;0<=r&&h;r--)b[r]=h.data,h=h.next;return b}}Object(u.a)(Sw,"Stack",null,[]);class Qk{constructor(b){this.Fj=b;this.iIc=this.dId=null;this.tAd=!1}get mZd(){return this.iIc.nV()}reset(){this.Fj.reset();
this.dId=new Sw;this.iIc=new Sw;this.iIc.push(this.Fj.PYc);this.tAd=!1}Xle(){this.tAd=!1}oM(b){this.tAd||(this.dId.push(null),this.tAd=!0);this.dId.push(b)}onClose(){for(;;){const b=this.dId.pop();if(!b)break;b()}}wOj(){return!1}RUn(){this.qw(()=>!0)}qw(b){const h=this.mZd.clone();return b(h)?(this.iIc.push(h),this.Fj.MMa(h),this.oM(Object(F.a)(this,this.L_n,"onFormattingEnd")),!0):!1}NRf(b){if(en.a.Itb){let h=2;vp.a.instance.ee(()=>{h=this.fMi(b)},"AHT:HCA");return h}return this.fMi(b)}fMi(b){return b.style?
this.qw(h=>this.wOj(h,b))?1:2:2}L_n(){this.iIc.pop();this.Fj.MMa(this.mZd)}Jga(){}Qle(){return 2}Edg(){return 2}Fdg(){return 2}Jdg(){return 2}Ydg(){return 3}$dg(){}Wle(){return 2}aeg(){}beg(){}ceg(){return 2}Zle(){return 2}$le(){return 2}reg(){return 2}ame(){}ueg(){return 2}cme(){return 2}dme(){return 2}gme(){return 2}hme(){return 2}Geg(){}Heg(){return 2}ome(){return 2}pme(){return 2}sme(){return 2}tme(){return 2}vme(){return 2}wme(){return 2}xme(){return 2}zme(){return 2}kfg(){return 2}Hme(){return 2}rfg(){return 2}tfg(){}ufg(){return 2}Kme(){return 2}Lme(){return 2}Mme(){return 2}Nme(){return 2}Ome(){return 2}Pme(){return 2}Afg(){return 3}Qme(){}Gfg(){return 2}Rme(){return 2}Ifg(){return 3}Ume(){}Nfg(){}Vme(){return 2}Tfg(){return 3}Xme(){return 2}Zme(){return 2}ane(){return 2}bne(){return 2}dgg(){}hgg(){return 3}dne(){return 2}onMenuOpen(){return 2}ngg(){}vgg(){return 2}wgg(){return 2}ygg(){return 3}one(){return 2}Agg(){return 2}qne(){return 2}une(){return 2}Hgg(){}Cne(){return 2}Tgg(){return 2}Kne(){return 2}Lne(){return 2}ihg(){return 3}ohg(){return 2}Wne(){return 2}Xne(){return 2}$ne(){return 2}aoe(){return 2}shg(){return 3}boe(){return 2}doe(){return 2}foe(){return 2}xhg(){return 2}Tfd(){return 2}Bhg(){return 2}Chg(){return 2}ioe(){return 2}Dhg(){return 2}Ghg(){return 3}noe(){return 2}ooe(){return 2}poe(){return 2}qoe(){return 2}voe(){return 2}soe(){return 2}static xla(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(C.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static fNf(b){if(!b||""===b)return-1;const h=C.a.xh(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(C.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(C.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static YBi(b){const h=Qk.fNf(b);return-1===h?(v.ULS.sendTraceTag(508678240,307,50,`Unhandled unit or blank string , is blankstring => ${!b}`),-1):0>h?(v.ULS.sendTraceTag(508925786,
307,50,"Negative margin in px or pt"),-1):h}static ZBi(b){b=Qk.fNf(b);return Cg.a.qK(b)}static vMm(b){return Qk.fNf(b)}static PEi(b){return b&&""!==b?Qk.xla(b):null}static eG(b){let h=null,r=null,A=null,M=null;b&&b.Df&&(h=Qk.xU(b.Df,"id"),r=Qk.xU(b.Df,"lang"),A=b.Df.tagName,b.t8k&&(M=Object.assign(new RA,{x:Qk.xla(b.Df.style.left),y:Qk.xla(b.Df.style.top),left:Qk.PEi(b.Df.style.left),top:Qk.PEi(b.Df.style.top)})),void 0===h&&(h=""),void 0===r&&(r=""));return new Mu.a(new xz(h,A),b.tD,null,r,M)}static xU(b,
h){return b[h]}}Object(u.a)(Qk,"AHtmlTranslator",null,[319]);class rG extends Mu.a{constructor(b,h,r,A=0,M=0,ba=null){super(ba?ba.Zba:null,ba?ba.tD:null,ba?ba.eDa:null,ba?ba.cultureName:null,ba?ba.MHa:null);this.width=A;this.height=M}}Object(u.a)(rG,"AugmentationSemanticArgs",Mu.a,[]);var vs=d(1270);class Tw{constructor(){this.stop=this.color=null}}Object(u.a)(Tw,"ColorStopPair",null,[]);var Jq=d(2011);class $v{constructor(){this.direction=null;this.iWc=new Px.a}xNi(){return!!this.direction&&0<this.direction.length}}
Object(u.a)($v,"LinearGradient",null,[]);class Hy{constructor(){this.Xnc=!1}}Object(u.a)(Hy,"HtmlTranslatorContext",null,[]);var UI=d(1879);class VI{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(u.a)(VI,"IndentationProperties",null,[]);var tm=d(1267);class Iy extends Mu.a{constructor(b,h,r,A,M=null,ba=0,oa=null,Ja=null,jb=!1,zb=!1,Eb=69905,Sb=null){super(Sb?Sb.Zba:null,Sb?Sb.tD:null,Sb?Sb.eDa:null,Sb?Sb.cultureName:null,Sb?Sb.MHa:null);this.colSpan=b;this.rowSpan=h;this.width=r;this.upc=
zb;this.height=A;this.Oab=jb;this.shadingColor=M;this.verticalAlignment=ba;this.Una=oa;this.YBe=Ja;this.haa=Eb}}Object(u.a)(Iy,"TableCellSemanticArgs",Mu.a,[]);class ms extends Mu.a{constructor(b,h=null){super(h?h.Zba:null,h?h.tD:null,h?h.eDa:null,h?h.cultureName:null,h?h.MHa:null);this.height=b}}Object(u.a)(ms,"TableRowSemanticArgs",Mu.a,[]);class Nu extends Mu.a{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb=null,Eb=-1,Sb=null){super(Sb?Sb.Zba:null,Sb?Sb.tD:null,Sb?Sb.eDa:null,Sb?Sb.cultureName:null,Sb?Sb.MHa:
null);this.uWd=null;this.rowCount=b;this.Lnb=h;this.width=r;if(M)for(this.uWd=Array(M.length),b=0;b<M.length;++b)this.uWd[b]=M[b];this.MXf=ba;this.eHg=Ja;this.hhn=oa;this.Oab=A;this.xbe=jb;this.styleId=zb;this.tableLook=Eb}}Object(u.a)(Nu,"TableSemanticArgs",Mu.a,[]);var Ns=d(1280);let qu;class Jn extends Qk{constructor(b,h,r=new Hy,A=null,M=null){super(b);this.settings=h;this.context=r;this.Ubd=A;this.NRb=M;this.KFb=null;this.EEk=tb.a.h9("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,
"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.sPj=new Set(["DIV","P"]);this.SYo=new Set("DIV P H1 H2 H3 H4 H5 H6".split(" "))}get F7i(){return this.EEk}FBi(b,h){var r;if((r=b.style?b.style.listStyleType:"")&&""!==r&&(r=this.F7i[C.a.xh(r)])||(r=Qk.xU(b,"type"))&&""!==r&&(r=this.F7i[r]))return r;if((r=b.tagName.toLowerCase())&&("ol"===r||"ul"===r)&&(b=
b.className))if("ul"===r)switch(b=Jn.L9d(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===r)switch(b=Jn.L9d(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}wBi(b){let h=-1,r=b.tagName.toLowerCase();if("ol"===r||"ul"===r){b=xd.a.myi(b,"li");if(!b)return h;r="li"}if("li"===
r){h=(h=this.a5d(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=xd.a.myi(b,"p"))return Jn.Jzm(b)-1}return h}a5d(b,h,r){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?r:b}t1n(){this.KFb.pop();this.Fj.UCa()}M5c(b,h){this.qw(M=>M.wha(0,0));const r=this.FBi(b.Df,h?6:2);let A=1;h&&(A=this.a5d(b.Df,"start",1));h=!1;h=b.Df.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.Df.removeAttribute("data-pasteFromRc");(X.a.L7||X.a.yj)&&Jn.XVd(b.Df);b=new tm.a(r,A,Qk.eG(b),0,-1,h);this.KFb.push(b);
this.Fj.WCa(b);this.oM(Object(F.a)(this,this.t1n,"onListElementClose"));return 1}FLl(b,h,r){return(h=h.getAttribute(r))?b.xuf(h):!1}reset(){super.reset();this.KFb=new Sw}wOj(b,h){if(en.a.Itb){let r=!1;vp.a.instance.ee(()=>{r=this.xOj(b,h)},"DHT:SFFA");return r}return this.xOj(b,h)}xOj(b,h){var r,A,M,ba,oa,Ja,jb,zb;let Eb=!1;try{var Sb=h.getAttribute("xml:lang")||Qk.xU(h,"lang")}catch(Zc){Sb=null}Sb&&""!==Sb&&(Eb=b.Yzg(Sb)||Eb);(Sb=Qk.xU(h,"dir"))&&(Eb=b.Exc(Sb)||Eb);if(this.settings.b5o(this.context)&&
h.getAttribute)for(Sb=0;Sb<Jn.pZj.length;Sb++)Eb=this.FLl(b,h,Jn.pZj[Sb])||Eb;Sb=h.style;const nc=window.performance.now();var Dc;en.a.rta?Dc=null===(r=this.NRb)||void 0===r?void 0:r.E7l(h):en.a.Xoc&&(Dc=getComputedStyle(h));Ns.a.zDe+=window.performance.now()-nc;Ns.a.ile+=1;en.a.fhk&&(Sb=getComputedStyle(h));if(Sb){if(Sb.fontWeight||h instanceof HTMLHeadingElement&&en.a.see&&en.a.rta)r=C.a.zC(null!==(A=null===Dc||void 0===Dc?void 0:Dc.fontWeight)&&void 0!==A?A:Sb.fontWeight),A=parseInt(r),isNaN(A)?
"BOLD"===r?Eb=b.YN(!0)||Eb:"NORMAL"===r&&(Eb=b.YN(!1)||Eb):Eb=600<=A?b.YN(!0)||Eb:b.YN(!1)||Eb;if(this.settings.XSj&&Sb.fontSize||h instanceof HTMLHeadingElement&&en.a.see&&en.a.rta)A=null!==(M=null===Dc||void 0===Dc?void 0:Dc.fontSize)&&void 0!==M?M:Sb.fontSize,M=Qk.vMm(A),0<M&&(Eb=b.vxe(Math.floor(2*M))||Eb);if((null===(ba=y.AFrameworkApplication.J)||void 0===ba?0:ba.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&this.sPj.has(h.tagName)||h instanceof
HTMLHeadingElement&&en.a.see&&en.a.rta)if(ba=Qk.YBi(null!==(oa=null===Dc||void 0===Dc?void 0:Dc.marginTop)&&void 0!==oa?oa:Sb.marginTop),oa=Qk.YBi(null!==(Ja=null===Dc||void 0===Dc?void 0:Dc.marginBottom)&&void 0!==Ja?Ja:Sb.marginBottom),-1!==ba||-1!==oa)Eb=b.wha(ba,oa)||Eb;en.a.A0i&&this.SYo.has(h.tagName)&&(Ja=Qk.ZBi(null!==(jb=null===Dc||void 0===Dc?void 0:Dc.marginLeft)&&void 0!==jb?jb:Sb.marginLeft),jb=Qk.ZBi(null!==(zb=null===Dc||void 0===Dc?void 0:Dc.marginRight)&&void 0!==zb?zb:Sb.marginRight),
Ja||jb)&&(Eb=b.sAg(Ja,jb)||Eb);this.settings.f5o(this.context)&&(this.settings.aTj&&h.getAttribute?(zb=h.getAttribute("data-indent"))&&0<zb.length&&(zb=Rh.a.sj(parseInt(zb),0)+"px",Eb=b.wye(zb)||Eb):Sb.textIndent&&(Eb=b.wye(Sb.textIndent)||Eb));this.settings.a5o(this.context)&&Sb.marginLeft&&(this.settings.aTj&&h.getAttribute?(zb=h.getAttribute("data-margin"))&&0<zb.length&&(Eb=b.Ena(Sb.marginLeft)||Eb):"TABLE"!==h.tagName&&(Eb=b.Ena(Sb.marginLeft)||Eb));if(this.settings.d5o(this.context)&&(zb=h.getAttribute("style"))&&
""!==zb)for(zb=zb.split(";"),jb=0;jb<zb.length;jb++)Dc=zb[jb].trim(),Dc.startsWith("tab-stops")&&(Eb=b.QAg(Dc.replace("tab-stops:",""))||Eb);this.settings.$4o(this.context)&&Sb.lineHeight&&(Eb=b.bF(Sb.lineHeight)||Eb);this.settings.X4o&&(zb=Sb.textTransform?C.a.xh(Sb.textTransform):null,jb=Sb,jb=jb.fontVariantCaps?C.a.xh(jb.fontVariantCaps):null,Dc=Sb.fontVariant?C.a.xh(Sb.fontVariant):null,"uppercase"===zb?Eb=b.Dod("uppercase")||Eb:"small-caps"===jb||Dc&&0<=Dc.indexOf("small-caps")?Eb=b.Dod("small-caps")||
Eb:this.settings.Anl&&"none"===zb&&(Eb=b.Dod("none")||Eb));this.settings.e5o(this.context)&&Sb.textAlign&&(Eb=b.r0b(C.a.xh(Sb.textAlign))||Eb);Sb.fontStyle&&(zb=C.a.zC(Sb.fontStyle),"ITALIC"===zb||"OBLIQUE"===zb?Eb=b.uyb(!0)||Eb:"NORMAL"===zb&&(Eb=b.uyb(!1)||Eb));zb=Jn.tPm(h);if(Sb.textDecoration||zb)jb=C.a.xh(Sb.textDecoration||""),zb=C.a.xh(zb||""),h.parentNode&&h.parentNode.tagName&&"a"===C.a.xh(h.parentNode.tagName)?(Dc=(h.querySelector(".TextRun")||h).className)&&-1<Dc.indexOf("Underlined")&&
(Eb=b.M8(!0)||Eb):Sb.qqq||Jn.isUnderline(jb)||Jn.isUnderline(zb)?Eb=b.M8(!0)||Eb:this.settings.gUj&&(Eb=b.M8(!1)||Eb),Sb.pqq||Jn.YZi(jb)||Jn.YZi(zb)?Eb=b.Gna(!0)||Eb:this.settings.gUj&&(Eb=b.Gna(!1)||Eb);if(Sb.verticalAlign){zb=C.a.zC(Sb.verticalAlign);jb=this.Eqo(zb);if("SUB"===zb||this.settings.$Sj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>jb&&this.settings.GTj)Eb=b.gOa(!0)||Eb;else if("SUPER"===zb||this.settings.$Sj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||
0<jb&&this.settings.GTj)Eb=b.Bva(!0)||Eb;this.settings.XSj&&("SUB"===zb||"SUPER"===zb)&&h.getAttribute&&(zb=parseFloat(h.getAttribute("data-fontsize")),isNaN(zb)||(Eb=b.vxe(Math.floor(2*zb))||Eb))}zb=!1;y.AFrameworkApplication.J&&(zb=y.AFrameworkApplication.J.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.Z4o&&Sb.fontFamily&&(this.settings.h5o&&h.getAttribute?(jb=h.getAttribute("data-usefontface"))&&"true"===jb&&(zb&&v.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),Eb=this.uOj(b,
Sb.fontFamily,Eb)):Eb=this.uOj(b,Sb.fontFamily,Eb));jb=null;this.settings.Y4o&&Sb.color&&(jb=Jq.a.Bra(Sb.color));Dc=!!jb;this.settings.g5o(this.context)&&h.getAttribute&&(jb=h.getAttribute("data-scheme-color"),jb=null!==jb?jb:"",Dc=""!==jb||!this.context.Xnc||Jn.tvn(h));Dc&&(Eb=b.gx(jb)||Eb);!this.settings.V4o||!Sb.backgroundColor||h.tagName&&Jn.Vjp.contains(C.a.zC(h.tagName))||(jb=Sb.backgroundColor,Eb=en.a.uhn&&this.sPj.has(h.tagName)?b.s4(Jq.a.Bra(jb))||Eb:b.gEa(Jq.a.Bra(jb))||Eb);if(this.settings.W4o&&
Sb.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(Sb=Jn.dSm(Sb.backgroundImage))&&0<Sb.iWc.count){jb=Sb.iWc.K(0).color;Dc=!0;for(Ja=0;Ja<Sb.iWc.count&&(Dc=Dc&&jb===Sb.iWc.K(Ja).color,Dc);Ja++);Dc&&(zb&&v.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),Eb=b.gEa(Jq.a.Bra(jb))||Eb)}}this.settings.ZSj(this.context)&&h.getAttribute&&(Sb=h.getAttribute("data-ccp-props"))&&(Eb=b.Bca(Sb)||Eb);h.getAttribute&&((Sb=h.getAttribute("data-ccp-charstyle"))&&this.settings.Syb&&
(Eb=b.cxe(Sb)||Eb),(h=h.getAttribute("data-ccp-parastyle"))&&this.settings.Syb&&(Eb=b.eye(h)||Eb));return Eb}g7o(b){if(this.settings.h7o)for(b=b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<C.a.zC(b.className).indexOf("MSOCOM"))return!0;if("DIV"===C.a.zC(b.tagName))break;b=b.parentNode}return!1}uOj(b,h,r){h=Jn.fim(h);let A=!1,M=0;if(!h)return r;for(const ba of h){if(A=b.keb(ba,this.settings.Ehp))break;M++}1<h.length&&(A?v.ULS.sendTraceTag(508889217,307,50,"Secondary font matched from font-family at : {0} out of {1}",
M+1,h.length):v.ULS.sendTraceTag(508889216,307,50,"Secondary fonts {0} available in font-family but no match found",h.length));return A||r}Eqo(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}Jga(b,h){"\u200b"===b&&(b="\u00a0");h&&h.Df&&this.g7o(h.Df)&&(b="");this.Fj.Jga(b,Qk.eG(h))}Qle(b){const h=Qk.xU(b.Df,"href");return h&&""!==h?(this.Fj.LYa(h,Qk.eG(b)),this.oM(Object(F.a)(this.Fj,this.Fj.KYa,"onAnchorEnd")),1):2}Wle(){return this.qw(b=>b.YN(!0))?1:2}Zle(){return this.qw(b=>b.GRf())?
1:2}$le(b){this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}ame(b){this.Fj.Qba(Qk.eG(b))}cme(b){this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}gme(){return this.qw(b=>b.uyb(!0))?1:2}dme(b){this.qw(h=>h.r0b("center"));this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}hme(){return this.qw(b=>b.keb("consolas"))?1:2}pme(){return this.qw(b=>b.Gna(!0))?1:2}ome(b){return this.M5c(b,!1)}sme(){return this.qw(b=>
b.uyb(!0))?1:2}tme(b){return this.M5c(b,!1)}vme(b){var h=b.Df.getAttribute("data-render-src");const r=b.Df.getAttribute("data-render-method");if(h&&""!==h&&r&&""!==r){const oa=b.Df.getAttribute("data-render-fallback");let Ja=0,jb=0;if(b.Df.currentStyle){var A=b.Df.currentStyle.width,M=b.Df.currentStyle.height;A&&-1!==A.indexOf("px")&&(A=parseInt(C.a.substring(A,0,A.indexOf("px"))),isNaN(A)||(Ja=A));M&&-1!==M.indexOf("px")&&(M=parseInt(C.a.substring(M,0,M.indexOf("px"))),isNaN(M)||(jb=M))}b=new rG(h,
r,oa,Ja,jb,Qk.eG(b));this.Fj.ycb(b);return 2}(X.a.L7||X.a.yj)&&(h=b.Df.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&Jn.XVd(b.Df);const ba=b.Df.getAttribute("align");this.qw(oa=>oa.r0b(ba));this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}wme(b){this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}xme(b){this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}zme(){return this.qw(b=>
b.uyb(!0))?1:2}Hme(b){return this.qw(h=>{var r=Jn.xum(b.Df.getAttribute("face"));r=h.keb(r);h=h.gx(Jq.a.Bra(b.Df.getAttribute("color")));return r||h})?1:2}Kme(b){this.qw(h=>this.settings.Syb?h.xyb(1):h.zyb(1));this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}Lme(b){this.qw(h=>this.settings.Syb?h.xyb(2):h.zyb(2));this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}Mme(b){this.qw(h=>this.settings.Syb?h.xyb(3):h.zyb(3));this.Fj.aG(Qk.eG(b));
this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}Nme(b){this.qw(h=>this.settings.Syb?h.xyb(4):h.zyb(4));this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}Ome(b){this.qw(h=>this.settings.Syb?h.xyb(5):h.zyb(5));this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}Pme(b){this.qw(h=>this.settings.Syb?h.xyb(6):h.zyb(6));this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}Qme(b){this.Fj.Qba(Qk.eG(b))}Ume(b){var h=
b.Df;const r=h.src,A=h.alt,M=h.R9p,ba=h.getAttribute("data-external-content-url");let oa=0,Ja=0;h.style&&(oa=Qk.xla(h.style.width),Ja=Qk.xla(h.style.height));oa&&Ja||(oa=h.width,Ja=h.height);let jb=0,zb=0;b.Df.currentStyle&&(oa||Ja||(oa=Qk.xla(b.Df.currentStyle.width),Ja=Qk.xla(b.Df.currentStyle.height)),jb=Qk.xla(b.Df.currentStyle.maxWidth),zb=Qk.xla(b.Df.currentStyle.maxHeight));!en.a.Xmn||oa&&Ja||(Ja=oa=0);let Eb=null;const Sb=h.getAttribute(Am.GZd);if(Sb&&(v.ULS.sendTraceTag(524038492,307,50,
"Chart paste from xlo"),y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ChartsPasteFromXLOIsEnabled"))){const nc=h.getAttribute(Am.Uvf),Dc=h.getAttribute(Am.Vvf),Zc=h.getAttribute(Am.Svf),Gd=h.getAttribute(Am.Tvf),de=h.getAttribute(Am.CYc);h=h.getAttribute(Am.Wvf);nc&&Gd&&(Eb=new vs.a(Sb,nc,Dc,Zc,Gd,de,h))}b=new UI.a(r,A,oa,Ja,Qk.eG(b),jb,zb,M,null,ba,Eb);this.Fj.SCa(b)}Rme(){return this.qw(b=>b.uyb(!0))?1:2}Vme(){return this.qw(b=>b.M8(!0))?1:2}Xme(){return this.qw(b=>b.keb("consolas"))?
1:2}Zme(b){this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}ane(b){this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}bne(b){let h;const r=this.FBi(b.Df,0);let A=this.a5d(b.Df,"value",0);0<this.KFb.count?h=this.KFb.nV():(h=new tm.a(2,1,Qk.eG(b)),A||(A=1));var M=Jn.Tzm(b.Df,tm.a.o5j);3!==M&&(h.$s=M);M=h.listLevel;let ba=h.listId;this.settings.YSj?(M=this.wBi(b.Df),M=0>M&&0>h.listLevel&&0<this.KFb.count?h.listLevel=this.KFb.count-
1:h.listLevel=0<=M?M:h.listLevel,this.Ubd&&this.Ubd.b<M&&(this.Ubd.b=M)):0>M&&(M=h.listLevel=this.wBi(b.Df));1>ba&&(ba=h.listId=this.a5d(b.Df,tm.a.Obd,0));b.Df.getAttribute(tm.a.Mhe)&&(h.levelText=b.Df.getAttribute(tm.a.Mhe));var oa=b.Df.getAttribute(tm.a.y4f);oa&&(h.font=oa);oa=!1;y.AFrameworkApplication.J&&(oa=y.AFrameworkApplication.J.$("FollowDestinationThemePasteIsEnabled"));if(oa){var Ja=b.Df.getAttribute("data-charcodes");oa=[];if(Ja&&""!==Ja)if(-1<Ja.indexOf(",")){Ja=Ja.split(",");for(var jb=
0;jb<Ja.length;jb++)oa.push(parseInt(Ja[jb]))}else oa.push(parseInt(Ja));if(oa&&0<oa.length){Ja=Array(oa.length);for(jb=0;jb<oa.length;jb++)Ja[jb]=oa[jb];h.uof=Ja}(oa=b.Df.getAttribute("data-buAutoNum"))&&0<oa.length&&(h.buAutoNum=parseInt(oa))}(M=0<=M&&0<ba)&&Jn.XVd(b.Df);h.u9k(r,A,M);h.w4f=this.yzm(b.Df);this.Fj.PMa(h.clone());this.oM(Object(F.a)(this.Fj,this.Fj.VCa,"onListItemEnd"));return 1}yzm(b){var h=b.getAttribute(tm.a.q7i);if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{v.ULS.sendTraceTag(524038493,
307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;h=new ji.DictionaryPropertySet;for(const r in b)h.jBg(+r,b[r]);return h}onMenuOpen(b){return this.M5c(b,!1)}dne(b){if(this.qw(h=>h.txc(!0))){const h=b.Df.getAttribute("OuterHtml");this.Fj.PYa(h,Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.vcb,"onMathEnd"))}return 1}one(b){return this.M5c(b,!0)}qne(b){this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));
return 1}une(b){const h=b.Df.getAttribute("align");this.qw(A=>A.r0b(h));const r=b.Df.parentNode;r&&r.tagName.toLowerCase().startsWith("li")&&Jn.XVd(b.Df,X.a.L7||X.a.yj);this.Fj.aG(Qk.eG(b));this.oM(Object(F.a)(this.Fj,this.Fj.uH,"onParagraphEnd"));return 1}Cne(){this.qw(b=>b.keb("consolas"));this.Fj.dwb();this.oM(Object(F.a)(this.Fj,this.Fj.cwb,"onPreFormattedTextEnd"));return 1}Kne(){return this.qw(b=>b.Gna(!0))?1:2}Lne(){return this.qw(b=>b.keb("consolas"))?1:2}Wne(){return this.qw(b=>b.iEg())?
1:2}Xne(b){var h=b.Df.attributes.getNamedItem("style"),r="";h&&h.value&&(r=h.value);h=Jq.a.rbo(r);if(0<h&&this.settings.Dan){for(r=0;r<h;r++)this.Fj.hwb(Qk.eG(b));return 3}return 2}$ne(){return this.qw(b=>b.Gna(!0))?1:2}aoe(){return this.qw(b=>b.YN(!0))?1:2}boe(){return this.qw(b=>b.gOa(!0))?1:2}doe(){return this.qw(b=>b.Bva(!0))?1:2}foe(b){this.qw(Eb=>Eb.oE()&&Eb.Xug());Jq.a.v$d(b.Df,this);const h=Jq.a.pKi(b.Df),r=Jq.a.Dui(b.Df),A=Jq.a.vN(b.Df),M=Jq.a.wN(b.Df),ba=!parseInt(Qk.xU(b.Df,"border")),
oa=Jq.a.Tun(b.Df);let Ja=-1,jb="";var zb=-1;b.Df.attributes.hasOwnProperty("style")&&-1!==(zb=b.Df.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Ja=parseInt(b.Df.attributes.getNamedItem("style").value.substr(zb+17)):b.Df.attributes.hasOwnProperty(Rw.a.HZd.toString())&&(Ja=parseInt(b.Df.attributes.getNamedItem(Rw.a.HZd.toString()).value));zb=-1;b.Df.attributes.hasOwnProperty("class")&&-1!==(zb=b.Df.attributes.getNamedItem("class").value.indexOf("Mso"))?jb=b.Df.attributes.getNamedItem("class").value.substr(zb).split(" ")[0]:
b.Df.attributes.hasOwnProperty(Rw.a.DYc.toString())&&(jb=b.Df.attributes.getNamedItem(Rw.a.DYc.toString()).value);this.Fj.Wba(new Nu(0,0,h.value,h.C1i,null,ba,oa,r,new VI(A.value,M.value),jb,Ja,Qk.eG(b)));this.oM(Object(F.a)(this.Fj,this.Fj.Uba,"onTableEnd"));return 1}Tfd(b){const h=Jq.a.xzi(b.Df),r=Jq.a.pKi(b.Df);if(!r.value&&r.iee&&this.settings.wsj)return 3;let A=parseInt(Qk.xU(b.Df,"colSpan"));if(void 0===A||null===A||""===A+"")A=r.value?1:0;let M=parseInt(Qk.xU(b.Df,"rowSpan"));if(void 0===M||
null===M||""===M+"")M=h.value?1:0;let ba=!1;b.Df.attributes.hasOwnProperty("style")&&(ba=-1!==b.Df.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==b.Df.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!ba&&b.Df.attributes.hasOwnProperty("class")&&(ba=-1!==b.Df.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let oa=69905;if(b.Df.attributes.hasOwnProperty(Rw.a.Rvf.toString())){var Ja=parseInt(b.Df.attributes.getNamedItem(Rw.a.Rvf.toString()).value);
isNaN(Ja)||(oa=Ja)}Ja=Jq.a.Bra(b.Df.style.backgroundColor);const jb=Jq.a.iSm(b.Df);this.qw(Sb=>Sb.wha(0,0));Jq.a.v$d(b.Df,this);const zb=Jq.a.Dui(b.Df),Eb=this.settings.bco?Jq.a.Plm(b.Df):null;b=new Iy(A,M,r.value,h.value,Ja,jb,zb,Eb,r.C1i,ba,oa,Qk.eG(b));this.Fj.Tba(b);this.oM(Object(F.a)(this.Fj,this.Fj.Sba,"onTableCellEnd"));this.RUn();return 1}ioe(b){const h=this.Tfd(b);if(3===h)return h;this.qw(r=>{const A=r.YN(!0);r=r.r0b("center");return A||r});Jq.a.v$d(b.Df,this);return 1}noe(b){Jq.a.v$d(b.Df,
this);const h=Jq.a.xzi(b.Df);if(h.iee&&!h.value&&this.settings.wsj)return 3;this.Fj.n8(new ms(h.value,Qk.eG(b)));this.oM(Object(F.a)(this.Fj,this.Fj.Vba,"onTableRowEnd"));return 1}ooe(){return this.qw(b=>b.keb("consolas"))?1:2}poe(){return this.qw(b=>b.M8(!0))?1:2}qoe(b){return this.M5c(b,!1)}soe(){return 2}voe(){return this.qw(b=>b.M8(!0))?1:2}static Srm(b){if(!b)return null;b=b.split(",");1<b.length&&v.ULS.sendTraceTag(508889187,307,50,"Secondary fonts available in font-family");return b[0]}static dim(b){return b?
b.split(","):null}static F3j(b){if(!b)return null;b=C.a.Qsg(b.trim(),'"');return b=C.a.Qsg(b,"'")}static xum(b){if(!b)return null;b=Jn.Srm(b);return b=Jn.F3j(b)}static fim(b){var h;if(!b)return null;b=null===(h=Jn.dim(b))||void 0===h?void 0:h.map(r=>Jn.F3j(r));h=null===b||void 0===b?void 0:b.filter(r=>!!r);return null!==h&&void 0!==h?h:null}static LOh(b,h){h=h.trim();var r=h.match(RegExp("^-?[0-9]+deg$"));if(r&&0<r.length){if(b.xNi())return!1;b.direction=h;return!0}if((r=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&
0<r.length){if(b.xNi())return!1;b.direction=h;return!0}var A=(r=h.match(RegExp("^rgb\\(.*\\)")))&&0<r.length?h.indexOf(")")+1:h.indexOf(" ");r=-1===A?h:Jq.a.Bra(h.substr(0,A).trim());if(!r||""===r)return!1;h=-1===A?"":h.substr(A).trim();A=new Tw;A.color=r;A.stop=h;b.iWc.add(A);return!0}static dSm(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const r=new $v;for(;0<h.trim().length;){let A=h.indexOf(",");
const M=h.indexOf("(");if(0<M&&M<A){const ba=h.indexOf(")");if(ba<M)return null;A=h.indexOf(",",ba)}if(-1===A){if(!Jn.LOh(r,h))return null;h=""}else{const ba=h.substr(0,A);h=h.substr(A+1);if(!Jn.LOh(r,ba))return null}}return r}catch(h){return null}}static L9d(b,h){b=b.split(" ");if(0<b.length)for(let r=0;r<b.length;r++)if(0<=b[r].indexOf(h))return b[r];return""}static XVd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&Jn.T2h(b,h))}static T2h(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&
(b.style.margin=""),h&&Jn.T2h(b,h)),b=b.nextSibling}static Jzm(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let r=0;r<b.length;r++){var h=b[r].split(":");if(2===h.length&&"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static Tzm(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;
default:return 3}}static tvn(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static tPm(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static YZi(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}Jn.Vjp=(qu=new qb.a,qu.add("TABLE"),qu.add("THEAD"),qu.add("TBODY"),qu.add("TFOOT"),qu.add("TR"),qu.add("TH"),qu.add("TD"),qu);Jn.pZj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn",
"data-ccp-parastyle-linked-defn"];Object(u.a)(Jn,"DefaultHtmlTranslator",Qk,[]);var nn=d(1025);class Dn{constructor(b=null){this.j6=b||nn.a.tKi("");this.bwh=Number.parseInvariant((new Date).format("HHmmss"))}get Nc(){return this.j6}process(b,h){if(b&&b.querySelectorAll){const ba=b.querySelectorAll("p");if(ba&&0<ba.length){for(var r=0,A=!1,M=ba[0].parentNode;5>r&&M&&M!==b;){r++;const oa=M.id.toLowerCase();if(oa&&oa.length&&-1!==oa.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(M,"WACEditing")&&
Sys.UI.DomElement.containsCssClass(M,"EditingSurfaceBody")){A=!0;break}M=M.parentNode}if(A&&M!==b){r=b.firstChild;for(A=!1;0<M.children.length&&M.children[0]!==r;)b.insertBefore(M.children[0],r),A=!0;if(A)for(;r;)M=r.nextSibling,b.removeChild(r),r=M}b=new ft.a(h,Object(F.a)(this,this.Kjo,"processNodesDiscovery"),new tC(ba));b.sm("Word Converter Operation");b.ni=!h||h.ni;b.run()}}}Kjo(b,h){const r=h.nodes[h.JUa];var A=Dn.Ezm(r);if(A){let ba=A.TGe.replace(RegExp("level[0-9]"),"").trim();ba=ba&&ba.length?
ba:A.TGe;let oa=h.lists[ba];oa||(oa=new PA,oa.YAc=this.bwh++);let Ja=oa.Pqc[A.level-1];Ja||(Ja=new Zv,Ja.level=A.level);var M=r.parentNode;if(M&&"li"===M.tagName.toLowerCase()){if(M=M.parentNode)!(M=M.tagName.toUpperCase())||"OL"!==M&&"UL"!==M||(Ja.tagName=M)}else Ja.hvb=Dn.Yxi(r,5),Ja.hvb&&Ja.hvb.length||(Ja.hvb=Dn.DOf(r,5)),Ja.mUf=!Ja.hvb||!Ja.hvb.length,Ja.tagName=Dn.Xxi(Ja.hvb),"UL"===Ja.tagName&&(Ja.font=this.Kyi(r,5));A.YAc=oa.YAc;Ja.yVn++;Ja.mUf||"li"===r.parentNode.tagName.toLowerCase()||
(M=(M=Dn.DOf(r,5))?M:Ja.hvb)&&M.length&&(A.Zmi=M,(M=Dn.lYo(r,M,Ja.listStyle,A.level-1))&&M.length&&(Ja.listStyle=M));h.Nub[h.Nub.length]=A;Ja.Nub.contains(A)||Ja.Nub.add(A);if(void 0===oa.Pqc[A.level-1]||null===oa.Pqc[A.level-1]||oa.Pqc[A.level-1]!==Ja)oa.Pqc[A.level-1]=Ja;h.lists[ba]&&h.lists[ba]===oa||(h.lists[ba]=oa);h.Q5i=r}else if((A=h.Q5i)&&Dn.WIm(r)===A&&r.tagName===A.tagName&&r.className===A.className){A.appendChild(A.ownerDocument.createElement("BR"));for(A.appendChild(A.ownerDocument.createElement("BR"));r.firstChild;)A.appendChild(r.firstChild);
r.parentNode.removeChild(r)}h.JUa++;if(h.nodes.length<=h.JUa){if(!h.Nub.length)return!1;h.JUa=0;b.Ri(Object(F.a)(this,this.Jjo,"processNodeConvert"))}return!0}Jjo(b,h){b=h.Nub[h.JUa];var r=b.F8n,A=b.TGe.replace(RegExp("level[0-9]"),"").trim();A=A&&A.length?A:b.TGe;A=h.lists[A];var M=A.Pqc[b.level-1],ba=r.parentNode.tagName.toLowerCase();if(!M.mUf&&r.parentNode&&"li"!==ba){if(ba=Dn.sIl(r,M)){Dn.E2h(r,5);const oa=r.ownerDocument.createElement("LI");oa.setAttribute("data-aria-level",String.format("{0}",
b.level));oa.setAttribute(tm.a.Obd,String.format("{0}",A.YAc));"UL"===M.tagName&&(oa.setAttribute(tm.a.Mhe,String.format("{0}",b.Zmi)),oa.setAttribute(tm.a.y4f,String.format("{0}",M.font)));for(;r.firstChild;)oa.appendChild(r.firstChild);ba.appendChild(oa);r.parentNode.removeChild(r);"UL"===M.tagName?this.Nc.b++:this.Nc.c++}}else"li"===ba&&(M=M.tagName,r=r.parentNode,b.Utc&&(b=r.parentNode)&&b.tagName.toUpperCase()===M&&b.setAttribute("data-pasteFromRc","true"),r.setAttribute(tm.a.Obd,String.format("{0}",
A.YAc)),"UL"===M?this.Nc.b++:this.Nc.c++);h.JUa++;return h.JUa<h.Nub.length}Kyi(b,h){let r=null;for(let A=0;!r&&A<b.childNodes.length;A++){const M=b.childNodes[A];r=Dn.yum(M);!r&&1===M.nodeType&&1<h&&(r=this.Kyi(M,h-1))}return r}static sIl(b,h){b=Dn.rIl(b,h.tagName);return Dn.ICl(b,h)}static ICl(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static rIl(b,
h){h=b.ownerDocument.createElement(h?h:"UL");var r=b.getAttribute("start");r&&0<r.length&&(h.setAttribute("start",r),b.removeAttribute("start"));en.a.thn&&(r=b.getAttribute("align")||b.style.textAlign)&&(h.style.textAlign=r);(r=b.className)&&0<r.length&&(r="OL"===h.tagName?Jn.L9d(r,"NumberListStyle"):Jn.L9d(r,"BulletListStyle"),0<r.length&&(Sys.UI.DomElement.addCssClass(h,r),Sys.UI.DomElement.removeCssClass(b,r)));b.parentNode.insertBefore(h,b);return h}static E2h(b,h){for(let r=0;r<b.childNodes.length;r++){const A=
b.childNodes[r];1===A.nodeType&&1<h&&Dn.E2h(A,h-1);if(Dn.Gkn(A)||Dn.iZi(A))b.removeChild(A),r--}}static Ezm(b){if(1===b.nodeType){var h=Dn.xOf(b,"mso-list");if(h&&0<h.length)try{var r=h.split(" ");if(3===r.length){const A=Number.parseInvariant(r[1].substr(5)),M=new QA(A,h,b);M.Utc=!0;return M}}catch(A){}else if((r=b.parentNode)&&"li"===r.tagName.toLocaleLowerCase()&&(h=r.getAttribute("data-"+Pe.a.zjf),r=r.getAttribute(tm.a.Obd),h&&r&&0<h.length&&0<r.length))return b=new QA(Number.parseInvariant(h),
r+" level"+h,b),b.Utc=!1,b}return null}static lYo(b,h,r,A){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===Dn.Xxi(h))return r=Dn.elm(h),Sys.UI.DomElement.addCssClass(b,r),r;var M=h.match(RegExp("^[0-9]+"));return M&&M.length?(r="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,r),b.setAttribute("start",M[0]),r):(M=h.match(RegExp("^[a-zA-Z]+")))&&M.length&&(M=M[0],A=(h=M.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?Dn.aKm(r,A):1,1!==A&&((r=Dn.OXd(b,M,RegExp("^[ivxlcdm]+"),C.a.W7h,"NumberListStyle3"))||
(r=Dn.OXd(b,M,RegExp("^[IVXLCDM]+"),C.a.W7h,"NumberListStyle5")))||A&&((r=Dn.OXd(b,M,RegExp("^[a-z]+"),C.a.U7h,"NumberListStyle2"))||(r=Dn.OXd(b,M,RegExp("^[A-Z]+"),C.a.U7h,"NumberListStyle4"))))?r:"NumberListStyle1"}return null}static elm(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static aKm(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=
0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static OXd(b,h,r,A,M){return(h=h.match(r))&&h.length?(A=A(h[0]),A=1>A?1:A,Sys.UI.DomElement.addCssClass(b,M),b.setAttribute("start",A+""),M):null}static Xxi(b){return Dn.qhn(b)?"UL":"OL"}static qhn(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static DOf(b,h){let r=null;var A;let M,ba;for(let oa=-1;!r&&oa<b.childNodes.length;oa++){const Ja=
-1===oa?b:b.childNodes[oa];if(Ja)if((A=Ja.innerHTML)&&0<A.length){if(M=A.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=M&&(ba=A.indexOf("\x3c!--[endif]--\x3e"),0<=ba)){A=A.substring(M,ba+14);Ja.innerHTML=Ja.innerHTML.replace(A,"");if(A.length){b=b.ownerDocument.createElement("span");b.innerHTML=A;r=b.innerText.trim();break}r&&r.length||(r="o")}}else 0<=oa&&1===Ja.nodeType&&1<h&&(r=Dn.DOf(Ja,h-1))}return r}static yum(b){let h=null;1===b.nodeType&&((h=Dn.Jyi(b,"font-family"))||(h=Dn.Jyi(b,"mso-ascii-font-family")));
return h}static Jyi(b,h){return(b=Dn.xOf(b,h))&&0<b.length?b.trim():null}static Yxi(b,h){let r=null;for(let A=0;!r&&A<b.childNodes.length;A++){const M=b.childNodes[A];Dn.iZi(M)?(r="string"===typeof M.innerText?M.innerText.trim():M.textContent.trim(),r.length||(r="o"),M.parentNode.removeChild(M)):1===M.nodeType&&1<h&&(r=Dn.Yxi(M,h-1))}return r}static iZi(b){return 1===b.nodeType&&(b=Dn.xOf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static Gkn(b){return 1===b.nodeType&&!b.firstChild&&
"SPAN"===b.tagName.toUpperCase()}static xOf(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let r=0;r<b.length;r++){const A=b[r].split(":");if(2===A.length&&A[0].trim()===h)return A[1].trim()}}return null}static WIm(b){do b=b.previousSibling;while(b&&Dn.UXi(b));return b}static UXi(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(Dn.xEk,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:Dn.UXi(b.firstChild):
!0}}Dn.xEk=RegExp("[\n|\r]","gi");Object(u.a)(Dn,"WacAndRichClientWordConverter",null,[315]);class sG{constructor(){}create(b=null){return new Dn(b)}}Object(u.a)(sG,"Box4WordConverterFactory",null,[687]);var yz=d(1877),Kq=d(45),ws=d(265),mp=d(1268),Yt=d(534),xj=d(303),zz=d(1324),WI=d(1072);class aw{constructor(b,h,r,A,M,ba=null,oa="",Ja=!0,jb=!1){this.YJa=this.SAe=this.Nxb=this.Ywj=this.Kue=null;this.G9c=!1;this.hLa=null;this.kdg=0;this.GCe=null;this.context=b;this.ne=b.view;this.xx=h;this.td=M;this.iV=
r;this.oca=A;this.$Da=this.ZB=!1;this.Qoe=null;this.nab=this.Roc=!1;this.ybp=aw.dsf(b);this.browserName=oa;this.T$j=Ja;this.pad=jb;this.S0a=!1;this.Pfc=0;if(b=Object(Za.a)(234,M)?M:null){this.Ywj=new ji.DictionaryPropertySet;this.Ywj.At(b);r=b.ka(Bd.a.Ygd,P.a.nil);this.YVc=r!=P.a.nil?r.toString():P.a.create().toString();if(b.ka(Bd.a.Rsj,!1)){this.Roc=!0;this.nab=b.ka(Bd.a.nab,!1);this.Qoe=ba;for(ba=this.ne.lb.Ng;ba.Uw;)ba=ba.getContext(0);if(M=Object(Ma.a)(Pn.AParagraphNode,ba.node)){r=0;A=Ed.ParagraphReader.textLength(M);
switch(ba.contextId){case mc.a.Fd:r=ba.cpBegin;A=ba.cpEnd;break;case mc.a.Yc:r=A}this.Kue=xa.FormattingReader.A6d(ba.node,r,ba.Fb);v.ULS.shipAssertTag(6305503,307,!!this.Kue);M=Oc.a.qkc(M);for(const zb of M)zb.cpEnd<=r||zb.cpBegin>=A||aw.Rp.rV(ba.node,zb.hyperlink)}}this.$Da=b.ka(Bd.a.$Da,!1);this.S0a=b.ka(Bd.a.S0a,!1);this.Nxb=b.ka(Bd.a.Nxb,null)}else this.YVc=P.a.create().toString();h&64&&(this.$Da=!0)}static get Rp(){return null!=aw.mYg?aw.mYg:aw.mYg=$a.a.instance.resolve(82)}static dsf(b){if(b){if(b.Uw){for(let h=
0;h<b.length;h++)if(aw.dsf(b.getContext(h)))return!0;return!1}if(Object(Za.a)(Yt.a,b))return aw.dsf(b.Ok);if(Ed.ParagraphReader.Vb(b.node)&&b.node.dR)return!0}return!1}}Object(u.a)(aw,"ClipboardActionArguments",null,[]);var ns;(function(b){b[b.paste=1]="paste";b[b.tqq=2]="textOnly";b[b.Mqj=4]="overtype";b[b.rE=16]="copy";b[b.q_p=32]="deleteSelection";b[b.move=64]="move";b[b.qsq=256]="useSystemClipboard";b[b.F3p=512]="forceInternalClipboard";b[b.QZa=4096]="reformatPastedContent";b[b.Fiq=8192]="pasteAsPlainText";
b[b.Hpd=65536]="showPlaceholderGlossary";b[b.kkq=131072]="reformatPastedContentWithDesignerPaste";b[b.Ufq=262144]="noSpacesAdjustment";b[b.A$p=524288]="mergeAfterPasteForInsertHtmlAPI"})(ns||(ns={}));Object(u.b)("ClipboardActionFlags",ns);var Wn=d(377);class ru extends xj.a{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he,fe,Yd,Td,wf,Lf,ii,Bi,Ml,hk,Tn=!0){super();this.Moa=this.wx=null;this.GM=this.uA=0;this.Ilb=this.d8e=this.Lda=this.zh=null;this.j$=!1;this.wW=!0;this.Ikh=!1;this.init(b);
this.sm("ClipboardOperation");this.Asb(jb,h,M,ba,oa);this.yd=zb;this.Pe=Eb;this.gf=Sb;this.Qc=nc;this.Abh=Dc;this.Cbh=Zc;this.Bbh=Gd;this.hNe=de;this.u5b=he;this.iNe=fe;this.SEc=Ja;this.GEc=Yd;this.YSa=Td;this.LSk=Tn;this.WC=wf;this.Xd=Lf;this.In=ii;this.T1=Bi;this._context=A;this.Eja=Ml;this.plb=hk;this.Yd=Ik.a.getInstance(Wn.a.O6a);oa&&Object(Za.a)(234,oa)&&(this.Lda=Object(Ma.a)(725,oa.ka(Bd.a.zza,null)));this.Lda||(this.Lda=this.Eja.sqd());this.vBb=void 0===r||null===r?"NotAvailable":Object(zz.a)(ns,
r);this.Lda.Y7k(this.vBb.split(", "));b=this._context;if(this.plb){if(!ru.t_h(b,this.hNe,this.yd,this.Lda,Tn)){this.us=8;this.finish();return}this.zh=b.view;this.j$=3===this.zh.zUb;this.uA=0;this.GM=r;this.Ilb=de.tZa}else{if(!b.view.ue){this.yd.$b(Uf.a.Oe,{["Reason"]:Ff.a.qWb});this.Lda.fail("Not in interactive view",!0);this.us=8;this.finish();return}this.zh=b.view;if(!this.zh.lb){this.yd.$b(Uf.a.Oe,{["Reason"]:Ff.a.Wn});this.Lda.fail("No selection manager",!0);this.us=8;this.finish();return}this.j$=
3===this.zh.zUb;this.uA=0;this.GM=r;this.Ilb=de.tZa;if(Tn&&!(this.Ilb&&this.Ilb.currentSelection&&this.Ilb.length)){this.yd.$b(Uf.a.Oe,{["Reason"]:Ff.a.Wn});this.Lda.fail("No selection when one required",!0);this.us=8;this.finish();return}}de=Le.a.Fm(this.Ilb.currentSelection);de=!(this.GM&16&&de);de=fe.Qhn(r,this.Ng)&&de;1!==this.behavior&&de||(de||this.Lda.fail("Clipboard operation disabled for selection",!0),this.us=de?32:8,this.zva());!this.Ikh&&this.gf.Di&&($b.b("IPadCCP"),this.Ikh=!0)}get Ng(){this.d8e||
(this.d8e=$f.a.pec(this.Ilb));return this.d8e}aha(){super.aha();this.Ilb=null}run(){this.uA||this.setup();1===this.uA&&this.process();2===this.uA&&this.Jkp();3===this.uA&&this.Gkp();4===this.uA&&this.finish()}setup(){if(this.GM&256&&this.SEc){this.aD||this.u5b.krl(this,this.GM,this.vBb);this.aD.run();if(this.aD.Pfa)return;this.wW=this.aD.xua;this.OVd();if(!this.wW){this.Lda.fail("No access to system clipboard",!0);this.us=8;this.uA=4;this.oie();return}}else v.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",
this.GM,this.vBb,this.gf.lE,this.actionId);this.GM&32&&!this.Pe.Ide(this.zh.lb.Ng)?(v.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.yd.$b(Uf.a.Oe,{["Reason"]:Ff.a.Lvf}),this.Lda.fail("Cut not allowed",!0),this.GEc.show(),this.us=8,this.uA=4):(this.GM&16||this.GM&32)&&this.WC.Mfe(this.zh.lb.gb.currentSelection)?(this.Lda.fail("Selected content deleted in coauthoring",!0),this.Xd.W0b(),this.us=8,this.uA=4):(this.GM&4096&&(this.T1.jvc(Object.assign(new WI.a,{p9c:!0,gY:this.vBb})),this.In.undo()),
this.iNe.bho(this.GM),this.zh.qd?(this.wx=this.Qc.Lc(15),this.wx.Ei=this.actionId,this.wx.Ab(this.zh.qd),this.uA=1):(this.Lda.fail("Interactive view has null target node",!0),this.us=8,this.uA=4))}process(){if(!this.aD){v.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.GM,this.vBb,this.gf.lE);v.ULS.shipAssertTag(6305507,307,!this.Moa);this.Moa=new aw(this._context,this.GM,this.Lda,this.oca,this.mO,void 0,this.gf.lE,this.LSk,this.j$);let b;this.GM&65536?b=
Object(F.a)(this.Abh,this.Abh.process,"process"):this.GM&64?b=Object(F.a)(this.Cbh,this.Cbh.process,"process"):this.GM&1?(this.Yd.logKpiUsage({kpiName:Wn.a.rza}),b=Object(F.a)(this.hNe,this.hNe.process,"process")):b=Object(F.a)(this.Bbh,this.Bbh.process,"process");this.GM&16&&this.zh.lb.GEa.Rqi();this.YSa.create(this,b,this.Moa).sm("ClipboardAction")}v.ULS.shipAssertTag(6305536,307,!!this.aD);this.aD.run();this.aD.Pfa||(this.OVd(),this.uA=this.ni?2:3)}Jkp(){this.Moa.Roc&&(this.wx.Ei=ub.a.X0);this.Moa.G9c&&
this.wx.iMa(this.Moa.hLa,this.Moa.kdg);this.wx.dispose();this.us=this.Moa.ZB?8:32;this.uA=4}Gkp(){if(this.aD){if(this.aD.run(),this.aD.Pfa)return}else if(this.Moa.Roc&&(this.wx.Ei=ub.a.X0),this.wx.ZNa(this),this.Moa.G9c&&this.wx.iMa(this.Moa.hLa,this.Moa.kdg),this.wx.dispose(),this.bef)return;this.us=this.Moa.ZB?8:32;this.uA=4}finish(){this.T1.jvc(Object.assign(new WI.a,{p9c:!1}));this.zva();32===this.response?(v.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",
+this.endTime-+this.startTime,this.GM,this.vBb,this.gf.lE),this.GM&1&&this.Yd.logKpiSuccess({kpiName:Wn.a.rza})):v.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.GM,this.vBb,this.gf.lE);this.Eja.Vka(this.Lda);ru.pro&&this.gFn()}oie(){const b=!!(this.GM&1),h=this._context.view;h&&Wn.a.oie(b,h.lb,this.gf.lE)}gFn(){if(!(this.GM&4||this.GM&64)){var b=new Map;b.set("isCopy",String.format("{0}",!!(this.GM&16)));b.set("isIPad",
String.format("{0}",this.gf.Di));b.set("SkipAria","false");b.set("ErrorLevel","info");this.Yd.logKpiUsage({kpiName:Wn.a.B0h,kpiType:0,optionalProperties:{extendedProperties:b},blockFutureEmissionDurationInMs:0});this.wW||(b.set("SkipAria","false"),b.set("ErrorLevel","info"),this.Yd.logKpiFailure({kpiName:Wn.a.B0h,errorName:Wn.a.aol,optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:{extendedProperties:b}},blockFutureEmissionDurationInMs:0}))}}static get pro(){null==ru.V5e&&(ru.V5e=
!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("RecordCcpErrorDialogKpiIsEnabled"));return ru.V5e}static Cqg(b,h,r,A){b&&b.$b(Uf.a.Oe,{["Reason"]:r});h&&h.fail(A,!0)}static t_h(b,h,r=null,A=null,M=!0){return b.view.ue?b.view.lb?!M||h.tZa&&h.tZa.currentSelection&&h.tZa.length?!0:(ru.Cqg(r,A,Ff.a.Wn,"Paste target is invalid"),!1):(ru.Cqg(r,A,Ff.a.Wn,"No selection manager"),!1):(ru.Cqg(r,A,Ff.a.qWb,"Not in interactive view"),!1)}}ru.V5e=null;Object(u.a)(ru,"ClipboardOperation",xj.a,[]);class uC{constructor(b,
h,r,A,M,ba,oa){this.pC=oa;this.S3e=null;this.fAh=0;this.yd=A;this.gf=h;this.p1=M;this.XUe=r;this.SEc=y.AFrameworkApplication.YCg();this.WMe=b.appSettings.ChromeClipboardAccessOperationTimeout;this.NK=0;this.prk=ba;this.Tvk=b.$("EnableExternalPasteSupportOnMobileIsEnabled");this.Yd=Ik.a.getInstance(Wn.a.O6a)}get tZa(){return this.p1.tZa}process(b,h){if(!this.NK)return this.Ybo(h);if(1===this.NK)return this.gYb(b,h);if(2===this.NK)return this.NK=3,this.S3e(b,h);3===this.NK&&this.p1.GAg(b,h);return!1}Ybo(b){let h=
!0;this.Tvk&&(h=!(b.xx&1));this.gf.M7&&h||b.xx&512?(this.S3e=b.xx&2?Object(F.a)(this.p1,this.p1.paste,"paste"):Object(F.a)(this.p1,this.p1.Csj,"pasteInternal"),this.NK=2):(this.SEc?(this.NK=1,this.fAh=Date.now()):this.NK=2,this.S3e=Object(F.a)(this.p1,this.p1.paste,"paste"));Wn.a.rHn(b);return!0}gYb(b,h){var r;b=!0;if(this.XUe.value.Xuj())this.NK=2;else{const A=Date.now()-this.fAh;A>this.WMe&&(v.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",A),this.yd.$b(Uf.a.osa,{["Reason"]:Ff.a.iqj}),h.iV&&
(h.iV.fail("Prepare for paste timed out",!1),null===(r=this.pC)||void 0===r?void 0:r.LNb(),this.Yd.logKpiFailure({kpiName:Wn.a.rza,errorName:"PreparePasteTimedOut",optionalVeto:{name:Wn.a.Spe,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}})),h.ZB=!0,b=!1,this.prk.IIo())}return b}}Object(u.a)(uC,"ClipboardOperationPasteProcessor",null,[720]);class tG extends xj.a{constructor(b,h,r,A,M,ba){super();this.init(b);this.sm("DummyClipboardOperation");this.Asb(y.AFrameworkApplication.va,
h,A,M,ba);this._context=r;this.us=8;this.zva()}run(){this.njb=!0;this.Ind(this._context);this.edb();this.us=32}}Object(u.a)(tG,"DummyClipboardOperation",xj.a,[]);var Uw=d(1519);class lE extends Uw.a{constructor(b,h,r,A,M){super(b,h,M);this.Yk=r;this.K8e=A}QAc(b){let h;if(this.DT&&!b)return v.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Nka:null};h=null;if(this.K8e&&!this.DT){const r=this.properties.ka(Bd.a.Jsj,"");r&&(h=this.Yk.Awb(r))}h||(h=
this.Yk.Awb(b));return{returnValue:!0,Nka:h}}}Object(u.a)(lE,"HtmlStringImportStrategy",Uw.a,[]);var uG=d(1878);class vG extends uG.a{constructor(b,h,r,A,M){super(b,h,r,A,M)}rEi(){return this.properties.ka(Bd.a.IXb,"")}QAc(b){if(this.qFh){if(this.Yk)return b=this.Yk.akg(b,!0),{returnValue:!0,Nka:b};v.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.QAc(b)}Ibd(b){b=super.Ibd(b);return b.length&&" "!==b?b:"\u00a0"}}Object(u.a)(vG,"MultiLinePlainTextImportStrategy",
uG.a,[]);class Sx extends Uw.a{constructor(b,h,r){super(b,h,r)}QAc(b){if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorPlainTextImportStrategy",!1))return this.Hsp(b);let h;if(this.DT&&!b)return v.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Nka:null};h=ws.a.H4c("Box4PasteScratchPad");h.innerText=b;return{returnValue:!0,Nka:h}}Hsp(b){let h;if(this.DT&&!b)return v.ULS.sendTraceTag(508379359,307,10,"No htmlDomContent"),{returnValue:!1,
Nka:null};h=Ct.Zbo;h.innerText=b;return{returnValue:!0,Nka:h}}}Object(u.a)(Sx,"PlainTextImportStrategy",Uw.a,[]);class bw{constructor(b){this.isReady=this.l0f=!1;this.Bja=b}Xuj(){this.l0f||(this.l0f=!0,this.isReady=!1,this.Bja.gYb(()=>{this.isReady=!0}));return this.isReady}j4j(){this.l0f=!1;const b=this.Bja.paste();return b?b.hasChildNodes()?{returnValue:!0,CXd:b}:(v.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),bw.Bc.$b(Uf.a.Q4,{["Reason"]:Ff.a.sCf}),{returnValue:!1,CXd:b}):(v.ULS.sendTraceTag(6305676,
307,50,"SystemClipboard didn't paste"),bw.Bc.$b(Uf.a.FOb,{["Reason"]:Ff.a.aHg}),{returnValue:!1,CXd:b})}static get Bc(){return Wg.a.instance}}Object(u.a)(bw,"SystemClipboardImportStrategy",null,[722]);class Ct{get O5i(){return this.PRa}set O5i(b){this.PRa=b}constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he,fe,Yd=null){this.pC=fe;this.l2d=Yd;this.xxd=null;this.PRa=0;this.yCd=this.IRc=!1;this.aCb=Ng.a.On;this.Gpd=()=>{const Td=Array(1);Td.push("PasteRecoveryFloatie");var wf=this.pJk.XVa();
wf=Object.assign(new yz.a,{x:wf.x,y:wf.y});this.pO.showFloatie(wf,Td,1);return 32};this.PRb=()=>{this.pO.t3&&this.pO.dismissFloatie();return 32};this.Nxj=(Td,wf,Lf,ii,Bi)=>{if(1===Lf)return 32;Bi[Jd.a.On]=!1;return 32};this.JZl=(Td,wf,Lf,ii,Bi,Ml)=>{v.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var hk=Ml.DataTransfer;Ml=hk.getData("text/html");hk=hk.getData("text/plain");let Tn=!1;const rx=new ji.DictionaryPropertySet;0<Ml.length?(v.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),
rx.setValue(Bd.a.hY,Ml),Tn=!0):0<hk.length&&(v.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),rx.setValue(Bd.a.IXb,hk),Tn=!0);if(Tn){const sx=this.Dz.K(wf);return this.hWd.create(Td,wf,sx,new Pf.a(()=>this.gZc(sx,rx)),Lf,ii,Bi,rx)}return null};this.lpg=(Td,wf,Lf,ii,Bi)=>{if(wf="object"===typeof Bi?Bi:null)this.qlb?this.gUo(Td,this.PRa,wf):Td===ub.a.gse?(Td=this.PRa!==ub.a.QZa&&this.PRa!==ub.a.RZa&&this.PRa!==ub.a.BDa,wf[this.aCb]=this.PRa===ub.a.QZa||Td):Td===ub.a.hse?
wf[this.aCb]=this.PRa===ub.a.RZa:Td===ub.a.gpg&&(wf[this.aCb]=this.PRa===ub.a.BDa);return 32};this.l_=(Td,wf,Lf,ii,Bi,Ml)=>{if((y.AFrameworkApplication.I0||y.AFrameworkApplication.BH)&&!y.AFrameworkApplication.lOb||Bl.a.dma(Lf)&&Bl.a.loc())return new tG(Td,wf,Lf,ii,Bi,Ml);let hk=this.Dz.K(wf);1!==ii&&hk&1&&(this.PRa=wf);if(1!==ii){var Tn=Object(Za.a)(234,Ml)?Ml:null;Ml?(hk&1&&(this.xxd=Tn),Tn=Tn?Tn.ka(Bd.a.gY,0):0,wf===ub.a.paste&&Tn===ub.a.rIa?hk=this.Dz.K(ub.a.C6):wf===ub.a.b4&&Tn===ub.a.K6a&&(hk=
this.Dz.K(ub.a.Tpe))):!Ml&&hk&4096&&(Ml=this.xxd,Tn=Object(Za.a)(234,Ml)?Ml:null)&&(Tn=Tn.ka(Bd.a.Ygd,P.a.nil),v.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",Tn))}return this.hWd.create(Td,wf,hk,new Pf.a(()=>this.gZc(hk,Ml)),Lf,ii,Bi,Ml)};this.Zio=(Td,wf,Lf,ii,Bi)=>this.onf(Td,wf,Lf,Bi);this.Yio=(Td,wf,Lf,ii,Bi)=>this.onf(Td,wf,Lf,Bi);this.Xio=(Td,wf,Lf,ii,Bi)=>this.onf(Td,wf,Lf,Bi);this.uke=(Td,wf,Lf,ii,Bi,Ml)=>{Ml=vc.a.Tc($f.a.instance.gb.currentSelection.Qa.node,
Ml);return this.l_(Td,wf,Lf,ii,Bi,Ml)};this.trk=b;this.Bja=h;this.yd=r;this.Yk=A;this.ga=ba;this.Yxd=zb;this.u5b=Eb;this.Ie=Sb;this.vg=nc;this.Zb=jb;this.plb=Dc;this.qlb=Zc;this.pJk=Gd;this.pO=de;this.dYe=he;this.Yd=Ik.a.getInstance(Wn.a.O6a);Ja&&(this.IRc=Ja.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.yCd=this.qlb&&Ja.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.Dz=new eb.a;this.Dz.W(ub.a.paste,257);this.Dz.W(ub.a.b4,8449);this.Dz.W(ub.a.C6,1);this.Dz.W(ub.a.P$a,1);this.Dz.W(ub.a.CKb,
1);this.Dz.W(ub.a.eIa,1);this.Dz.W(ub.a.wce,513);this.Dz.W(ub.a.QZa,4097);this.Dz.W(ub.a.RZa,12289);this.Dz.W(ub.a.BDa,131073);this.Dz.W(ub.a.jkg,7);this.Dz.W(ub.a.ikg,1);this.Dz.W(ub.a.Tpe,8193);this.Dz.W(ub.a.rE,272);this.Dz.W(ub.a.yUc,16);this.Dz.W(ub.a.cut,304);this.Dz.W(ub.a.gmf,48);this.Dz.W(ub.a.tke,64);this.Dz.W(ub.a.uke,64);this.Dz.W(ub.a.Hpd,327680);this.Dz.W(ub.a.pzf,1);this.yCd&&this.Dz.W(ub.a.Dwb,this.Dz.K(ub.a.Tpe))}get l0a(){return null!=this.a5g?this.a5g:this.a5g=$a.a.instance.Oa(880)}get UHg(){return null!=
this.t5g?this.t5g:this.t5g=$a.a.instance.Oa(259)}get hWd(){return this.trk.value}get Mip(){return this.Bja}Wb(){if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisablePasteQueryAtBoot",!1)){this.l2d.addCommandToMaps(new Kq.a(mp.a.Zgd,this.plb?ub.a.rIa.toString():ub.a.paste.toString()));let b;this.l2d.addCommandToMaps((b=new Kq.a(mp.a.gkg,this.qlb?ub.a.K6a.toString():ub.a.b4.toString()),b.legacyControlId="fseaNewPaste",b));this.l2d.addCommandToMaps(new Kq.a(mp.a.Xgd,
this.qlb?ub.a.K6a.toString():ub.a.b4.toString()));let h;this.l2d.addCommandToMaps((h=new Kq.a("PasteStandalone",this.plb?ub.a.rIa.toString():ub.a.paste.toString()),h.legacyControlId="fseaPaste",h))}this.ga.fb(ub.a.Gmo,mc.a.application,this.Nxj,97);this.ga.fb(ub.a.Hmo,mc.a.application,this.Nxj,97);this.ga.fb(ub.a.gse,mc.a.application,this.lpg,97);this.ga.fb(ub.a.hse,mc.a.application,this.lpg,97);this.ga.fb(ub.a.gpg,mc.a.application,this.lpg,97);this.ga.HW(ub.a.gmf,mc.a.view,this.l_,1028);this.ga.lmb(ub.a.yUc,
mc.a.view,this.l_);this.ga.HW(ub.a.pzf,mc.a.view,this.JZl,1028);this.ga.HW(ub.a.C6,mc.a.view,this.l_,1028);this.ga.HW(ub.a.P$a,mc.a.view,this.l_,1028);this.ga.HW(ub.a.CKb,mc.a.view,this.l_,1028);this.ga.HW(ub.a.eIa,mc.a.view,this.l_,1028);this.plb&&this.ga.fb(ub.a.rIa,mc.a.view,this.Xio,1028);this.qlb&&this.ga.fb(ub.a.K6a,mc.a.view,this.Yio,1028);this.ga.HW(ub.a.paste,mc.a.view,this.l_,1028);this.ga.HW(ub.a.b4,mc.a.view,this.l_,1028);this.ga.HW(ub.a.Tpe,mc.a.view,this.l_,1028);this.ga.HW(ub.a.ikg,
mc.a.view,this.l_,1028);this.ga.HW(ub.a.jkg,mc.a.view,this.l_,1028);this.ga.HW(ub.a.QZa,mc.a.view,this.l_,1028);this.ga.HW(ub.a.RZa,mc.a.view,this.l_,1028);this.ga.qa(ub.a.QZb,mc.a.view,kd.ActionManager.$f);this.ga.qa(ub.a.Qsj,mc.a.view,kd.ActionManager.$f);this.ga.qa(ub.a.Nsj,mc.a.view,kd.ActionManager.$f);this.ga.qa(ub.a.Osj,mc.a.view,kd.ActionManager.$f);this.ga.qa(ub.a.Psj,mc.a.view,kd.ActionManager.$f);this.ga.qa(ub.a.Msj,mc.a.view,kd.ActionManager.$f);this.ga.lmb(ub.a.tke,mc.a.view,this.l_);
this.ga.lmb(ub.a.uke,mc.a.view,this.uke);this.ga.lmb(ub.a.wce,mc.a.view,this.l_);this.ga.lmb(ub.a.Hpd,mc.a.view,this.l_);this.yCd&&(this.ga.fb(ub.a.WUc,mc.a.view,this.Zio,1028),this.ga.HW(ub.a.Dwb,mc.a.view,this.l_,1028));this.ga.qa(ub.a.Zbi,mc.a.view,kd.ActionManager.$f);this.ga.qa(ub.a.Bci,mc.a.view,kd.ActionManager.$f);this.dYe&&(this.ga.fb(ub.a.Gpd,mc.a.view,this.Gpd,96),this.ga.fb(ub.a.PRb,mc.a.view,this.PRb,96))}y8(){if(this.Zb){const b=this.Zb.ie(Ii.a.GF);this.yCd&&b.bindAction(kc.KeyInputManager.lc(rf.a.qBb,
kc.KeyInputManager.mi|4),ub.a.WUc)}else v.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}gUo(b,h,r){switch(h){case ub.a.RZa:case ub.a.b4:case ub.a.Dwb:h=ub.a.hse;break;case ub.a.BDa:h=ub.a.gpg;break;default:h=ub.a.gse}r[this.aCb]=b===h}xGm(){const b=Object(Za.a)(234,this.xxd)?this.xxd:null;return b?b.ka(Bd.a.Ygd,P.a.nil):P.a.nil}onf(b,h,r,A){if(1===r){if(!Object(Za.a)(Yt.a,h)||!this.Yxd||Bl.a.dma(h)&&Bl.a.loc())return 8;r=new Pf.a(()=>this.gZc(this.Dz.K(ub.a.C6),
A));const M=this.Yxd.create(r,Object(Ma.a)(234,A));r=new uC(y.AFrameworkApplication.J,dn.a.instance,r,Wg.a.instance,M,this.u5b,this.pC);return ru.t_h(h,r)?32:8}if(2===r){if(this.J4o(df.a.Q5a))return this.rIa(b);df.a.tvc(()=>{this.rIa(b)});return 32}return 2}rIa(b){var h;if(!this.Ie)return v.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var r=this.Ie.Tqb();if(!r)return v.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;r=r.Ko;if(!r)return v.ULS.sendTraceTag(592454659,307,10,"No document"),
8;v.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",b);this.Yd.logKpiUsage({kpiName:Wn.a.rza});this.vg.L0l(b);b=Te.a.AOb(r,"paste");r=this.vg.nVl();v.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",r);if(b)return v.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.Yd.logKpiSuccess({kpiName:Wn.a.rza}),32;this.HWm();v.ULS.sendTraceTag(592454662,307,10,"execCommand failed");null===(h=this.pC)||void 0===h?void 0:h.LNb();this.Yd.logKpiFailure({kpiName:Wn.a.rza,
errorName:"ExecCommandFailed"});return 8}HWm(){this.l0a&&(this.l0a.X0b(),Wn.a.oie(!0,$f.a.instance,X.a.lE));if(this.UHg){const b=this.UHg.sqd();b.Adc("CallExecCommandPasteOperation");b.fail("call to execCommand('paste') failed",!0);this.UHg.Vka(b)}}J4o(b){let h=!1;this.Zb?this.Zb.currentScope?h=!this.Zb.NYf(this.Zb.currentScope.name):v.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):v.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(h){v.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",
this.Zb.currentScope.name);if(1>b)return v.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Zb.KEf();return!1}return!0}gZc(b,h){return b&256?new bw(this.Mip):b&2?b&4096?new lE(h,this.yd,this.Yk,df.a.instance.C9c,df.a.instance.R_a):new Sx(h,this.yd,df.a.instance.R_a):h.hasProperty(Bd.a.IXb)?new vG(h,this.yd,this.Yk,this.IRc,df.a.instance.R_a):new lE(h,this.yd,this.Yk,df.a.instance.C9c,df.a.instance.R_a)}static get Zbo(){return ws.a.H4c("Box4PasteScratchPad")}s_h(b,h,r,
A){return!y.AFrameworkApplication.I0&&!y.AFrameworkApplication.BH||y.AFrameworkApplication.lOb?(b=this.l_(null,b?ub.a.cut:ub.a.rE,h,1,r,A))?b.response:8:8}}Object(u.a)(Ct,"ClipboardActor",null,[]);class Tx{constructor(b,h,r,A,M){this.Jgh=0;this.dIp=ba=>{let oa=!0;const Ja=this.Bja.T2l;null!=Ja?(ba.xua=Ja,oa=!1):Date.now()-this.Jgh>this.WMe&&(v.ULS.sendTraceTag(18354843,307,50,null),this.yd.$b(Uf.a.osa,{["Reason"]:Ff.a.iqj}),oa=ba.xua=!1);return oa};this.yd=b;this.gf=h;this.WMe=M;this.Bja=r;this.YSa=
A}krl(b,h,r){v.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,r,this.gf.lE);b.ni&&this.gf.Ur&&window.chrome&&v.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.Bja.P_c(!!(h&16));this.YSa.create(b,this.dIp,null).sm("ClipboardPreProcess");this.Jgh=Date.now()}IIo(){this.Bja.reset()}}Object(u.a)(Tx,"ClipboardOperationClipboardAccessHelper",null,[684]);class Az{constructor(b,h,r,
A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd){this.h3a=null;this.ga=b;this.yd=h;this.yB=r;this.Rh=A;this.ib=M;this.Bja=ba;this.hb=oa;this.Pe=Ja;this.Eo=jb;this.$c=zb;this.kkb=Eb;this.i6e=Sb;this.JG=nc;this.Yk=Zc;this.V7b=Dc?Dc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.bFd=Dc?Dc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.Cd=Gd;this.Yd=Ik.a.getInstance(Wn.a.O6a)}get Of(){return this.Rh}get Bc(){return this.yd}get Z8c(){if(null==this.h3a)if(this.Cd)if(this.Cd.Qr.isCompleted)this.h3a=this.Cd.isFeatureEnabled(2);
else return!1;else this.h3a=!1;return this.h3a}XHp(b){b.oJ();return!0}A8h(b,h){b=h.xx;v.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let A=!1,M;this.Z8c&&h.ne&&h.ne.Oh&&(A=this.Yk.KNh(h.ne.Oh.editingElement));M=this.Yk.iSf(h.ne.Oh.editingElement,!1);var r=h.ne.Oh.editingElement;this.Yk.iXf(r,!1,1);this.V7b&&X.a.Fta?(r=h.ne.Oh.editingElement,this.Yk.bug(r,"data-src","data-srcurl"),b=this.Bja.rE(),this.Yk.bug(r,"data-srcurl","data-src")):this.bFd&&h.ne&&h.ne.Oh?(r=this.Yk.lof(h.ne.Oh.editingElement,
h.ne.eD,!0),b=this.Bja.rE(),r&&this.Yk.lof(h.ne.Oh.editingElement,h.ne.eD,!1)):(this.Yk.VDj(h.ne.Oh.editingElement),b=this.Bja.rE());this.Z8c&&A&&this.Yk.rCo(h.ne.Oh.editingElement);M&&this.Yk.iSf(h.ne.Oh.editingElement,!0);r=h.ne.Oh.editingElement;this.Yk.iXf(r,!1,0);if(!b)return v.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.Yd.logKpiFailure({kpiName:Wn.a.aVd,errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),
this.Bc.$b(Uf.a.FOb,{["Reason"]:Ff.a.aHg}),h.iV&&h.iV.fail("SystemClipboard did not copy",!1),h.ZB=!0,!1}return!0}zsf(b,h){const r=h.ne;v.ULS.shipAssertTag(18130961,307,!!(h.xx&16));h.ybp?this.yB.$2h():this.yB.eYd(r,b);return!0}vei(b,h){var r=h.context,A=h.td;const M=h.oca;var ba=!1;b=this.ib.gb.currentSelection.Wc;if(this.hb.kn(b)||this.Pe.rl(b)){const oa=this.$c.lg(b.node),Ja=oa.Ld();v.ULS.shipAssertTag(18130962,307,Ja);this.Eo.ke(oa);this.kkb.wtb(oa)&&(ba=!0)}A=h.xx&64?new ji.DictionaryPropertySet:
A||new ji.DictionaryPropertySet;A.setValue(Bd.a.KZc,!1);this.Yd.logKpiUsage({kpiName:Wn.a.bVd});r=this.ga.Pf(r,ub.a.RJ,2,!0,M,A);8===r&&(v.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Bc.$b(Uf.a.osa,{["Reason"]:Ff.a.uei}),h.iV&&h.iV.fail("DeleteKey failed",!1),this.Yd.logKpiFailure({kpiName:Wn.a.bVd,errorName:"DeleteForCutFailed"}),h.ZB=!0);32===r&&this.Yd.logKpiSuccess({kpiName:Wn.a.bVd});32===r&&ba&&(h=this.ib.gb.currentSelection,this.Pe.Fm(h)&&h.Qa.node===b.node&&!this.hb.textLength(h.Qa.node)&&
(h=this.$c.lg(h.Qa.node),b=this.Pe.yv(h),v.ULS.shipAssertTag(18130964,307,b),this.Eo.ke(h),this.kkb.Xde(h)||(b=this.i6e.create(),b.kd(h),this.Eo.N3(b,!1,!1),ba=this.Eo.Me(b),this.hb.Vb(ba)&&(this.Eo.ke(b),this.Of.merge(b,h,!1,!1),this.ib.Kc(this.JG.ve(ba,this.hb.textLength(ba)))))));return!0}}Object(u.a)(Az,"ClipboardOperationCutCopy",null,[721]);class wG{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd){this.ga=b;this.yd=h;this.yB=r;this.Bja=ba;this.ib=M;this.Rh=A;this.hb=oa;this.Pe=Ja;this.Eo=
jb;this.$c=zb;this.kkb=Eb;this.i6e=Sb;this.JG=nc;this.Ga=Dc;this.Yk=Zc;this.Cd=Gd}create(){return new Az(this.ga,this.yd,this.yB,this.Rh,this.ib,this.Bja,this.hb,this.Pe,this.Eo,this.$c,this.kkb,this.i6e,this.JG,this.Ga,this.Yk,this.Cd)}}Object(u.a)(wG,"Factory",null,[686]);var os=d(486);class xG{constructor(b,h){this.zFc=null;this.sDl=(r,A)=>{let M;if(os.a.kga){if(!A.td)return!1;M=A.td.n5c;if(!M)return!1}else{if(!Object(Za.a)(234,A.td))return!1;const Ja=Object(Ma.a)(234,A.td);if(!Ja.hasProperty(Bd.a.n5c))return!1;
M=Ja.getValue(Bd.a.n5c)}const ba=A.ne,oa=ba.lb;this.yB.W$j();oa.p_b(()=>{oa.Kc(M,void 0,!0);this.yB.eYd(ba,r)},!0);return!0};this.yB=b;this.p1=h;this.NK=0}process(b,h){this.NK||(this.zFc=[this.sDl,Object(F.a)(this.p1,this.p1.Wbo,"pasteGlossaryPlaceholder")],os.a.kga&&this.zFc.push(Object(F.a)(this.p1,this.p1.GAg,"setSelectionAfterPaste")));let r=!0;this.NK<this.zFc.length&&(r=this.zFc[this.NK++](b,h));return r?this.NK<this.zFc.length:!1}}Object(u.a)(xG,"ClipboardOperationContentControlShowPlaceholderProcessor",
null,[740]);class Vw{constructor(b){this.TCb=null;this.n5=b;this.NK=-1}process(b,h){-1===this.NK&&(this.iOl(b,h),this.NK=0);let r=!1;this.NK<this.TCb.length&&(r=this.TCb[this.NK++](b,h));return r?this.NK<this.TCb.length:!1}iOl(b,h){X.a.M7||h.xx&512?(this.TCb=[Object(F.a)(this.n5,this.n5.zsf,"copyInternal")],v.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.ni&&h.xx&256?(this.TCb=[Object(F.a)(this.n5,this.n5.XHp,"waitBeforeCopy"),Object(F.a)(this.n5,
this.n5.A8h,"copyExternal"),Object(F.a)(this.n5,this.n5.zsf,"copyInternal")],v.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.TCb=[Object(F.a)(this.n5,this.n5.A8h,"copyExternal"),Object(F.a)(this.n5,this.n5.zsf,"copyInternal")],v.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));h.xx&32&&(b=Object(F.a)(this.n5,this.n5.vei,"deleteForCut"),
this.TCb.push(b),v.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));Wn.a.fFn(h)}}Object(u.a)(Vw,"ClipboardOperationCutCopyProcessor",null,[739]);class Ww{constructor(b,h,r,A){this.tHd=null;this.vDl=(M,ba)=>{ba=ba.ne;this.yB.DEp();this.yB.eYd(ba,M);return!0};this.Odd=(M,ba)=>{ba=new or.Selection([ba.td],!0);this.ib.Kc(ba,M);return!0};this.yB=b;this.ib=h;this.n5=r;this.p1=A;this.NK=0}process(b,h){this.NK||(this.tHd=[this.vDl,Object(F.a)(this.n5,
this.n5.vei,"deleteForCut"),this.Odd,Object(F.a)(this.p1,this.p1.Csj,"pasteInternal"),Object(F.a)(this.p1,this.p1.GAg,"setSelectionAfterPaste")]);let r=!0;this.NK<this.tHd.length&&(r=this.tHd[this.NK++](b,h));return r?this.NK<this.tHd.length:!1}}Object(u.a)(Ww,"ClipboardOperationMoveProcessor",null,[734]);class mE{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he,fe){this.pC=fe;this.yB=b;this.ga=h;this.SEc=r;this.yd=A;this.Pe=M;this.gf=ba;this.Qc=oa;this.Yxd=Ja;this.srk=jb;this.u5b=zb;
this.iNe=Eb;this.GEc=Sb;this.YSa=nc;this.WC=Dc;this.Xd=Zc;this.In=Gd;this.T1=de;this.Eja=he}create(b,h,r,A,M,ba,oa,Ja,jb=!0){const zb=this.Yxd.create(A,Object(Ma.a)(234,Ja));var Eb=this.srk.create();const Sb=new xG(this.yB,zb),nc=new Ww(this.yB,$f.a.instance,Eb,zb);Eb=new Vw(Eb);A=new uC(y.AFrameworkApplication.J,dn.a.instance,A,Wg.a.instance,zb,this.u5b,this.pC);return new ru(b,h,r,M,ba,oa,Ja,this.SEc,this.ga,this.yd,this.Pe,this.gf,this.Qc,Sb,nc,Eb,A,this.u5b,this.iNe,this.GEc,this.YSa,this.WC,
this.Xd,this.In,this.T1,this.Eja,y.AFrameworkApplication.bDg(),jb)}}Object(u.a)(mE,"Factory",null,[685]);var Os=d(241);class SA{constructor(b,h){this.oRb=b.tKf(h);this.Lsf=b.hpm(h);this.TLb=b.XHf(h);this.Wmb=b.wHf(h)}static jH(b){return SA.Ts(b)}static Ts(b){return new SA(QI.a.instance,b)}}Object(u.a)(SA,"CpUsageHelper",null,[]);class lL{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){this.pC=nc;this.yd=b;this.yB=h;this.HNc=r;this.Eya=A;this.ib=M;this.ga=ba;this.XUe=oa;this.Kbf=jb;this.V3e=Ja;this.CQe=
zb;this.gNe=Eb;this.Xd=Sb;this.Yd=Ik.a.getInstance(Wn.a.O6a)}get rh(){return this.Kbf.value}get hwa(){return this.Eya}get Bc(){return this.yd}get tZa(){return this.V3e.tZa}paste(b,h){let r=!1;return en.a.Itb?(vp.a.instance.ee(()=>{r=this.zsj(b,h)},"COP:P"),r):this.zsj(b,h)}zsj(b,h){var r,A;const M=this.Xd.v6a();try{const ba=h.ne,oa=h.xx;this.ib&&this.ib.gb&&this.ib.gb.currentSelection&&Os.TableBorderSelectionCache.f2o(this.ib.gb.currentSelection.Ww||this.ib.gb.currentSelection.abb);ur.a.Y_o(this.ib);
v.ULS.shipAssertTag(18131010,307,!!(oa&1));Object(Za.a)(234,h.td)&&h.td.setValue(Fe.a.Oka,ba.Oh.editingElement.clientWidth);this.gNe.atp(b,h);let Ja;if(!({CXd:Ja}=this.XUe.value.j4j()).returnValue)return this.ocd(h,"HTML import strategy failed",!1),null===(r=this.pC)||void 0===r?void 0:r.LNb(),this.Yd.logKpiFailure({kpiName:Wn.a.rza,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:Wn.a.Spe,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}),!1;this.rh.BI();let jb=!0,
zb=null;const Eb=this.CQe.create(Ja),Sb=h.T$j;if(!ba||!ba.lb)return this.ocd(h,"Fail to set selection.",!1),null===(A=this.pC)||void 0===A?void 0:A.LNb(),this.Yd.logKpiFailure({kpiName:Wn.a.rza,errorName:"SetSelectionFailed",optionalVeto:{name:Wn.a.Spe,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}),!1;ba.lb.p_b(()=>{Sb&&2===this.ga.Ob(ub.a.Qra,2)?jb=!1:(zb=Sb?this.ib&&this.ib.gb&&this.ib.gb.currentSelection?this.ib.gb.currentSelection.Qa:null:h.td)?(v.ULS.shipAssertTag(18158338,
307,Le.a.qf(zb)),this.daj(zb,"paste")):v.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Sb)},this.V3e.M0i);if(!jb)return this.ocd(h,"fail to deleteForReplace.",!0),!1;if(!zb)return this.ocd(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!zb.node||!zb.node.isConnected)return this.ocd(h,"node is null or not connected in ip context.",!0),!1;ba.Ke.disable(!0,25);Eb.restore();this.HNc.Rbo(Ja,zb,b);return!0}finally{M&&M.dispose()}}ocd(b,h,r){b.ZB=!0;b.iV&&
b.iV.fail(h,r)}Wbo(b,h){var r,A;let M;if(os.a.kga){M=h.td;var ba=M.a$d}else ba=Object(Ma.a)(234,h.td).getValue(Bd.a.a$d);v.ULS.shipAssertTag(20492440,307,Le.a.qf(ba));if(!this.c2h(ba,h))return!1;this.rh.BI();const oa=(new xn.a).Lc(15);oa.Ab(this.yB.boa);const Ja=os.a.kga?this.ib.gb.currentSelection:null;this.HNc.cUi(ba,b);os.a.kga&&(b=null!==(A=null===(r=M.placeholderText)||void 0===r?void 0:r.length)&&void 0!==A?A:0,r=h.YJa,ba=Ja&&Le.a.qf(Ja.Qa)&&r&&Le.a.qf(r.Qa)&&Ja.Qa.node===r.Qa.node&&Ja.Qa.cpBegin>
ba.cpBegin?sc.SelectionFactory.ve(Ja.Qa.node,Ja.Qa.cpBegin+b):Ja,h.YJa=ba);this.yB.$2h();oa.dispose();return!0}Csj(b,h){const r=this.ib.gb.currentSelection.Qa;if(!this.c2h(r,h))return!1;this.rh.BI();this.ga.Ob(ub.a.Qra,2);this.daj(r,"intPaste");this.HNc.cUi(r,b);return!0}c2h(b,h){var r,A;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.isValid)return v.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.pad),
h.iV&&(h.iV.fail("Invalid ipContext before InternalPasteAtIp",!0),h.ZB=!0),h=new Map,h.set("ErrorLevel","warning"),null===(r=this.pC)||void 0===r?void 0:r.LNb(),this.Yd.logKpiFailure({kpiName:Wn.a.rza,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!Le.a.qf(b))return v.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",!!h&&h.pad,
b.contextId,!!b.node,!!b.node&&!!b.node.anchor),r=new Map,r.set("ErrorLevel","warning"),null===(A=this.pC)||void 0===A?void 0:A.LNb(),this.Yd.logKpiFailure({kpiName:Wn.a.rza,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:r}}}),h.iV&&(h.iV.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.ZB=!0),!1}return!0}daj(b,h){h=SA.jH(h);this.hwa.Fro(h,b.node,b.cpBegin);this.hwa.hFn(h.Lsf);this.hwa.C6f(h.oRb);this.hwa.p6f(h.TLb);
this.hwa.n6f(h.Wmb)}GAg(b,h){if(!h.T$j)return!1;h.xx&64&&this.yB.V$j();if(!h.YJa)return v.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Bc.$b(Uf.a.Q4,{["Reason"]:Ff.a.Rsb}),h.iV&&h.iV.fail("No selection after paste",!1),h.ZB=!0,!1;this.V3e.FDp(h);this.rh.BI();return!1}}Object(u.a)(lL,"ClipboardOperationPaste",null,[719]);class XI{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb){this.pC=Sb;this.yd=b;this.yB=h;this.HNc=r;this.Eya=A;this.ib=M;this.ga=ba;this.Kbf=Ja;this.sJk=oa;this.CQe=
jb;this.gNe=zb;this.Xd=Eb}create(b,h){h=this.sJk.create(this.ib,h);return new lL(this.yd,this.yB,this.HNc,this.Eya,this.ib,this.ga,b,h,this.Kbf,this.CQe,this.gNe,this.Xd,this.pC)}}Object(u.a)(XI,"Factory",null,[683]);class lo{constructor(b,h){this.Ugp=b;this.Nao=h}}Object(u.a)(lo,"ParagraphFormatStore",null,[]);class Ou{constructor(b,h,r){this.ib=b;this.hb=h;this.xe=r}atp(b,h){if(h.Roc){h=b.xua;var r=this.ib.gb.currentSelection.Qa.node,A=null;this.hb.Vb(r)&&(A=this.xe.Hq(r),r=this.hb.R9a(r),A=new lo(A,
r));h=new aw(h.context,h.xx,h.iV,h.oca,h.td,A);b.xua=h}}}Object(u.a)(Ou,"ClipboardOperationPasteOvertypeStrategy",null,[682]);class su{constructor(b){this.P_e=null;this.ib=b;b.p_b(h=>{this.P_e=h},!1)}get M0i(){return!1}FDp(b){b=this.qhf(b);this.Kc(this.ib,b)}qhf(b){let h=b.YJa;(b.S0a||b.$Da)&&b.SAe&&(h=sc.SelectionFactory.Yy(b.SAe,h.Qa));return h}Kc(b,h){b.Kc(h)}}Object(u.a)(su,"AClipboardOperationPasteStrategy",null,[730]);class yG extends su{constructor(b){super(b)}get tZa(){return this.P_e}}Object(u.a)(yG,
"ClipboardOperationPasteToLiveSelectionStrategy",su,[]);class zG extends su{constructor(b,h){super(b);this.Ocf=null;this.GFk=h;b.p_b(r=>{this.Ocf=r},!0)}get M0i(){return!0}get tZa(){return this.Ocf}qhf(b){let h=super.qhf(b);b.td.setValue(Bd.a.Hsj,h);return h=this.GFk.lCi(this.P_e.currentSelection,this.Ocf.currentSelection,h)}}Object(u.a)(zG,"ClipboardOperationPasteToVirtualSelectionStrategy",su,[]);class ti{constructor(b){this.Ncf=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&
h.ka(Bd.a.S0a,!1)&&this.Ncf?new zG(b,this.uHp):new yG(b)}get uHp(){return null!=this.a7g?this.a7g:this.a7g=$a.a.instance.Oa(881)}}Object(u.a)(ti,"ClipboardOperationPasteStrategyFactory",null,[681]);class nE{constructor(b,h,r,A){this.Bc=b;this.lb=h;this.Ln=r;this.sg=A}bho(b){(b&1||b&32)&&this.Ln.wn&&this.lb.pcc()}Qhn(b,h){return b&1&&this.sg.F2(h,!0)?(this.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.$G}),!1):!0}}Object(u.a)(nE,"ClipboardOperationWordStrategy",null,[]);class vh{constructor(){}RCl(b,h){if(h)if(h=
h.sheet)if(h=h.cssRules){var r=Array.clone(h);r.reverse();var A=h=0,M=0,ba=0;for(const Ja of r){r=Ja.style;var oa=Ja.selectorText;r=r?r.cssText:null;oa=oa?oa.split(","):null;if(r&&oa&&Ja.type===Ja.STYLE_RULE){ba+=oa.length;for(const jb of oa){0<=jb.indexOf("#")&&h++;0<=jb.indexOf(".")&&A++;0>jb.indexOf("#")&&0>jb.indexOf(".")&&M++;oa=null;try{oa=b.querySelectorAll(jb)}catch(zb){v.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",jb,zb.message)}if(oa)for(let zb=
0;zb<oa.length;zb++)oa[zb].setAttribute("style",r+(oa[zb].getAttribute("style")||""))}}}v.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ba,h,A,M)}else this.Baj();else this.Baj()}Baj(){v.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",X.a.lE)}}Object(u.a)(vh,"ExternalPasteCssConverter",null,[680]);class vC{constructor(b){this.JUa=
0;this.z3h=null;this.node=b}}Object(u.a)(vC,"ChartConverterArguments",null,[]);class oE{constructor(b=null){this._imgNodesConverted=0;this.j6=b||nn.a.Tui("")}get Nc(){return this.j6}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new ft.a(h,this.l6l.bind(this),new vC(b[0])),b.sm("Chart Converter Operation"),b.ni=!h||h.ni,b.run())))}l6l(b,h){var r=h.node;if(1<h.JUa)return!1;if(1===r.nodeType&&"DIV"===r.tagName){const A=r.getAttribute(Am.GZd);
if(A){const M=r.getAttribute(Am.Uvf),ba=r.getAttribute(Am.Vvf),oa=r.getAttribute(Am.Svf),Ja=r.getAttribute(Am.Tvf),jb=r.getAttribute(Am.CYc);r=r.getAttribute(Am.Wvf);M&&Ja&&ba&&"chart"===ba&&jb&&"XLO"===jb&&(h.z3h=new vs.a(A,M,ba,oa,Ja,jb,r))}}b.Ri(this.ZPn.bind(this));return!0}ZPn(b,h){var r=h.node;if(b=h.z3h)1===r.childElementCount&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName?(r=r.firstChild,r.setAttribute(Am.GZd,b.ccpId),r.setAttribute(Am.Uvf,b.pKey),r.setAttribute(Am.Vvf,b.type),r.setAttribute(Am.Tvf,
b.dc),r.setAttribute(Am.CYc,b.client),b.version&&r.setAttribute(Am.Wvf,b.version),b.count&&r.setAttribute(Am.Svf,b.count),this._imgNodesConverted++):v.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.j6._imgNodesConverted=this._imgNodesConverted;h.JUa++;return!1}}Object(u.a)(oE,"ChartConverter",null,[]);class YI{constructor(b,h=null,r=null){this.zf=b;this.j6=h||nn.a.RGi("");this.qQk=r||nn.a.SGi("")}get Nc(){return this.j6}get BHg(){return this.qQk}Wba(b){this.BHg.b++;this.zf.Wba(b)}Uba(){this.zf.Uba()}n8(b){this.BHg.c++;
this.zf.n8(b)}Vba(){this.zf.Vba()}Tba(b){this.BHg.d++;this.zf.Tba(b)}Sba(){this.zf.Sba()}reset(){this.zf.reset()}get PYc(){return this.zf.PYc}Jga(b,h){this.Nc.b++;this.zf.Jga(b,h)}Qba(b){this.Nc.c++;this.zf.Qba(b)}hwb(b){this.Nc.b++;this.zf.hwb(b)}SCa(b){this.Nc.d++;this.zf.SCa(b)}MMa(b){this.Nc.f++;this.zf.MMa(b)}LYa(b,h){this.Nc.g++;this.zf.LYa(b,h)}KYa(){this.zf.KYa()}aG(b){this.Nc.h++;this.zf.aG(b)}uH(){this.zf.uH()}dwb(){this.zf.dwb()}cwb(){this.zf.cwb()}PYa(b,h){this.Nc.i++;this.zf.PYa(b,h)}vcb(){this.zf.vcb()}WCa(b){this.Nc.j++;
this.zf.WCa(b)}UCa(){this.zf.UCa()}PMa(b){this.Nc.k++;this.zf.PMa(b)}VCa(){this.zf.VCa()}ycb(b){this.Nc.l++;this.zf.ycb(b)}}Object(u.a)(YI,"SemanticEventUsageCollector",null,[313,314]);class AG{constructor(b=null){this.zm=b}Xvl(b,h){var r;if(this.zm&&(h=h.match(/[0-9]+[a-zA-Z%]+/g)))for(const A of h){h=A.replace(/[0-9]+/,"");this.zm.pBe.has(b)||this.zm.pBe.set(b,new Map);const M=this.zm.pBe.get(b);null===M||void 0===M?void 0:M.set(h,(null!==(r=M.get(h))&&void 0!==r?r:0)+1)}}Ni(b){const h=b.Df;if(h&&
this.zm&&("font"===h.tagName.toLowerCase()&&this.Fbo(b),b=h.style)){0===b.length&&this.zm.t7c(h.tagName,"no style present");for(let r=0;r<b.length;r++){const A=b[r];A&&0<A.length&&(this.zm.t7c(h.tagName,A),this.Xvl(A,b.getPropertyValue(A)))}}}Fbo(b){if((b=b.Df)&&"font"===b.tagName.toLowerCase()&&this.zm){var h=b.getAttribute("face");h&&0<h.length&&this.zm.t7c(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.zm.t7c(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<
h.length&&this.zm.t7c(b.tagName,"font-attr-size")}}}Object(u.a)(AG,"HtmlEventUsageCollectorHelper",null,[]);class pE{constructor(b,h,r=null,A=null){this.Ji=h;this.$rk="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.zf=b;this.j6=r||nn.a.Izi(X.a.mLb,"");this.Cw=A;this.ask=new pk.a(Wa.a.vh());for(const M of this.$rk)this.ask.add(M)}get Nc(){return this.j6}get zm(){return this.Cw}Uh(b){return b?b+1:1}reset(){this.zf.reset()}Xle(){this.zf.Xle()}NRf(b){if(b&&
this.zm&&(b.getAttribute&&(b.getAttribute(Am.yOl)&&(this.zm.ori=!0),b.getAttribute(Am.GZd)&&(this.zm.tem=!0),b.getAttribute(Am.CYc)&&(this.zm.Apf=b.getAttribute(Am.CYc)),b.getAttribute(Am.BOl)&&(this.zm.qri=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Am.mUm)&&(this.zm.rri=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(Am.i7n)&&(this.zm.wri=!0);h.startsWith(Am.cgo)&&(this.zm.xri=!0);h.startsWith(Am.SJp)&&(this.zm.yri=!0);if(h.startsWith(X.a.fmf)&&h.length===
X.a.fmf.length+1){const r=parseInt(C.a.substring(h,h.length-1,h.length));isNaN(r)||(this.zm.oXc=r)}if(h===Am.rRn||h===Am.sRn)this.zm.B1c=!0}return this.zf.NRf(b)}onClose(){this.zf.onClose()}Lpn(b){for(const h of b)if("\n"!==h)return!0;return!1}Jga(b,h){this.zm&&(this.zm.vem=!0);this.zm&&!this.zm.JFf&&b&&(this.zm.JFf=this.Lpn(b));this.Nc.d=this.Uh(this.Nc.d);this.zf.Jga(b,h)}Qle(b){this.zm&&(this.zm.tri=!0);this.Nc.e=this.Uh(this.Nc.e);this.Ji.Ni(b);return this.zf.Qle(b)}Edg(b){this.Nc.f=this.Uh(this.Nc.f);
this.Ji.Ni(b);return this.zf.Edg(b)}Fdg(b){this.Nc.g=this.Uh(this.Nc.g);this.Ji.Ni(b);return this.zf.Fdg(b)}Jdg(b){this.Nc.h=this.Uh(this.Nc.h);this.Ji.Ni(b);return this.zf.Jdg(b)}Ydg(b){this.Nc.i=this.Uh(this.Nc.i);this.Ji.Ni(b);return this.zf.Ydg(b)}$dg(b){this.Nc.j=this.Uh(this.Nc.j);this.Ji.Ni(b);this.zf.$dg(b)}Wle(b){this.Nc.k=this.Uh(this.Nc.k);this.Ji.Ni(b);return this.zf.Wle(b)}aeg(b){this.Nc.l=this.Uh(this.Nc.l);this.Ji.Ni(b);this.zf.aeg(b)}beg(b){this.Nc.m=this.Uh(this.Nc.m);this.Ji.Ni(b);
this.zf.beg(b)}ceg(b){this.Nc.n=this.Uh(this.Nc.n);this.Ji.Ni(b);return this.zf.ceg(b)}Zle(b){this.Nc.o=this.Uh(this.Nc.o);this.Ji.Ni(b);return this.zf.Zle(b)}$le(b){this.Nc.p=this.Uh(this.Nc.p);this.Ji.Ni(b);return this.zf.$le(b)}reg(b){this.Nc.q=this.Uh(this.Nc.q);this.Ji.Ni(b);return this.zf.reg(b)}ame(b){this.Nc.r=this.Uh(this.Nc.r);this.Ji.Ni(b);this.zf.ame(b)}ueg(b){this.Nc.s=this.Uh(this.Nc.s);this.Ji.Ni(b);return this.zf.ueg(b)}cme(b){this.Nc.t=this.Uh(this.Nc.t);this.Ji.Ni(b);return this.zf.cme(b)}dme(b){this.Nc.u=
this.Uh(this.Nc.u);this.Ji.Ni(b);return this.zf.dme(b)}gme(b){this.Nc.v=this.Uh(this.Nc.v);this.Ji.Ni(b);return this.zf.gme(b)}hme(b){this.Nc.w=this.Uh(this.Nc.w);this.Ji.Ni(b);return this.zf.hme(b)}Geg(b){this.Nc.x=this.Uh(this.Nc.x);this.Ji.Ni(b);this.zf.Geg(b)}Heg(b){this.Nc.y=this.Uh(this.Nc.y);this.Ji.Ni(b);return this.zf.Heg(b)}ome(b){this.Nc.z=this.Uh(this.Nc.z);this.Ji.Ni(b);return this.zf.ome(b)}pme(b){this.Nc.ba=this.Uh(this.Nc.ba);this.Ji.Ni(b);return this.zf.pme(b)}sme(b){this.Nc.bb=this.Uh(this.Nc.bb);
this.Ji.Ni(b);return this.zf.sme(b)}tme(b){this.Nc.bc=this.Uh(this.Nc.bc);this.Ji.Ni(b);return this.zf.tme(b)}vme(b){this.Nc.bd=this.Uh(this.Nc.bd);this.Ji.Ni(b);return this.zf.vme(b)}wme(b){this.Nc.be=this.Uh(this.Nc.be);this.Ji.Ni(b);return this.zf.wme(b)}xme(b){this.Nc.bf=this.Uh(this.Nc.bf);this.Ji.Ni(b);return this.zf.xme(b)}zme(b){this.Nc.bg=this.Uh(this.Nc.bg);this.Ji.Ni(b);return this.zf.zme(b)}kfg(b){this.Nc.bh=this.Uh(this.Nc.bh);this.Ji.Ni(b);return this.zf.kfg(b)}Hme(b){this.Nc.bi=this.Uh(this.Nc.bi);
this.Ji.Ni(b);return this.zf.Hme(b)}rfg(b){this.Nc.bj=this.Uh(this.Nc.bj);this.Ji.Ni(b);return this.zf.rfg(b)}tfg(b){this.Nc.bk=this.Uh(this.Nc.bk);this.Ji.Ni(b);this.zf.tfg(b)}ufg(b){this.Nc.bl=this.Uh(this.Nc.bl);this.Ji.Ni(b);return this.zf.ufg(b)}Kme(b){this.Nc.bm=this.Uh(this.Nc.bm);this.Ji.Ni(b);return this.zf.Kme(b)}Lme(b){this.Nc.bm=this.Uh(this.Nc.bm);this.Ji.Ni(b);return this.zf.Lme(b)}Mme(b){this.Nc.bm=this.Uh(this.Nc.bm);this.Ji.Ni(b);return this.zf.Mme(b)}Nme(b){this.Nc.bm=this.Uh(this.Nc.bm);
this.Ji.Ni(b);return this.zf.Nme(b)}Ome(b){this.Nc.bm=this.Uh(this.Nc.bm);this.Ji.Ni(b);return this.zf.Ome(b)}Pme(b){this.Nc.bm=this.Uh(this.Nc.bm);this.Ji.Ni(b);return this.zf.Pme(b)}Afg(b){this.Nc.bn=this.Uh(this.Nc.bn);return this.zf.Afg(b)}Qme(b){this.Nc.bo=this.Uh(this.Nc.bo);this.Ji.Ni(b);this.zf.Qme(b)}Gfg(b){this.Nc.bp=this.Uh(this.Nc.bp);return this.zf.Gfg(b)}Rme(b){this.Nc.bq=this.Uh(this.Nc.bq);this.Ji.Ni(b);return this.zf.Rme(b)}Ifg(b){this.Nc.br=this.Uh(this.Nc.br);this.Ji.Ni(b);return this.zf.Ifg(b)}Ume(b){this.zm&&
(this.zm.sri=!0);this.Ji.Ni(b);this.Nc.bs=this.Uh(this.Nc.bs);this.zf.Ume(b)}Nfg(b){this.Nc.bt=this.Uh(this.Nc.bt);this.Ji.Ni(b);this.zf.Nfg(b)}Vme(b){this.Nc.bu=this.Uh(this.Nc.bu);this.Ji.Ni(b);return this.zf.Vme(b)}Tfg(b){this.Nc.bv=this.Uh(this.Nc.bv);this.Ji.Ni(b);return this.zf.Tfg(b)}Xme(b){this.Nc.bw=this.Uh(this.Nc.bw);this.Ji.Ni(b);return this.zf.Xme(b)}Zme(b){this.Nc.bx=this.Uh(this.Nc.bx);this.Ji.Ni(b);return this.zf.Zme(b)}ane(b){this.Nc.by=this.Uh(this.Nc.by);this.Ji.Ni(b);return this.zf.ane(b)}bne(b){this.zm&&
(this.zm.B1c=!0);this.Nc.bz=this.Uh(this.Nc.bz);this.Ji.Ni(b);return this.zf.bne(b)}dgg(b){this.Nc.ca=this.Uh(this.Nc.ca);this.Ji.Ni(b);this.zf.dgg(b)}hgg(b){this.Nc.cb=this.Uh(this.Nc.cb);this.Ji.Ni(b);return this.zf.hgg(b)}dne(b){this.zm&&(this.zm.uem=!0);this.Nc.cc=this.Uh(this.Nc.cc);this.Ji.Ni(b);return this.zf.dne(b)}onMenuOpen(b){this.Nc.cd=this.Uh(this.Nc.cd);this.Ji.Ni(b);return this.zf.onMenuOpen(b)}ngg(b){this.Nc.ce=this.Uh(this.Nc.ce);this.zf.ngg(b)}vgg(b){this.Nc.cf=this.Uh(this.Nc.cf);
this.Ji.Ni(b);return this.zf.vgg(b)}wgg(b){this.Nc.cg=this.Uh(this.Nc.cg);this.Ji.Ni(b);return this.zf.wgg(b)}ygg(b){this.Nc.ch=this.Uh(this.Nc.ch);this.Ji.Ni(b);return this.zf.ygg(b)}one(b){this.zm&&(this.zm.B1c=!0);this.Nc.ci=this.Uh(this.Nc.ci);this.Ji.Ni(b);return this.zf.one(b)}Agg(b){this.Nc.cj=this.Uh(this.Nc.cj);this.Ji.Ni(b);return this.zf.Agg(b)}qne(b){this.Nc.ck=this.Uh(this.Nc.ck);this.Ji.Ni(b);return this.zf.qne(b)}une(b){this.Nc.cl=this.Uh(this.Nc.cl);this.Ji.Ni(b);return this.zf.une(b)}Hgg(b){this.Nc.cm=
this.Uh(this.Nc.cm);this.Ji.Ni(b);this.zf.Hgg(b)}Cne(b){this.Nc.cn=this.Uh(this.Nc.cn);this.Ji.Ni(b);return this.zf.Cne(b)}Tgg(b){this.Nc.co=this.Uh(this.Nc.co);this.Ji.Ni(b);return this.zf.Tgg(b)}Kne(b){this.Nc.cp=this.Uh(this.Nc.cp);this.Ji.Ni(b);return this.zf.Kne(b)}Lne(b){this.Nc.cq=this.Uh(this.Nc.cq);this.Ji.Ni(b);return this.zf.Lne(b)}ihg(b){this.Nc.cr=this.Uh(this.Nc.cr);return this.zf.ihg(b)}ohg(b){this.Nc.cs=this.Uh(this.Nc.cs);this.Ji.Ni(b);return this.zf.ohg(b)}Wne(b){this.Nc.ct=this.Uh(this.Nc.ct);
this.Ji.Ni(b);return this.zf.Wne(b)}Xne(b){this.Nc.cu=this.Uh(this.Nc.cu);this.Ji.Ni(b);return this.zf.Xne(b)}$ne(b){this.Nc.cv=this.Uh(this.Nc.cv);this.Ji.Ni(b);return this.zf.$ne(b)}aoe(b){this.Nc.cw=this.Uh(this.Nc.cw);this.Ji.Ni(b);return this.zf.aoe(b)}shg(b){this.Nc.cx=this.Uh(this.Nc.cx);return this.zf.shg(b)}boe(b){this.Nc.cy=this.Uh(this.Nc.cy);this.Ji.Ni(b);return this.zf.boe(b)}doe(b){this.Nc.cz=this.Uh(this.Nc.cz);this.Ji.Ni(b);return this.zf.doe(b)}foe(b){this.zm&&(this.zm.vsa=!0);this.Nc.da=
this.Uh(this.Nc.da);this.Ji.Ni(b);return this.zf.foe(b)}xhg(b){this.zm&&(this.zm.vsa=!0);this.Nc.db=this.Uh(this.Nc.db);this.Ji.Ni(b);return this.zf.xhg(b)}Tfd(b){this.zm&&(this.zm.vsa=!0);this.Nc.dc=this.Uh(this.Nc.dc);this.Ji.Ni(b);return this.zf.Tfd(b)}Bhg(b){this.Nc.dd=this.Uh(this.Nc.dd);this.Ji.Ni(b);return this.zf.Bhg(b)}Chg(b){this.Nc.de=this.Uh(this.Nc.de);this.Ji.Ni(b);return this.zf.Chg(b)}ioe(b){this.zm&&(this.zm.vsa=!0);this.Nc.df=this.Uh(this.Nc.df);this.Ji.Ni(b);return this.zf.ioe(b)}Dhg(b){this.zm&&
(this.zm.vsa=!0);this.Nc.dg=this.Uh(this.Nc.dg);this.Ji.Ni(b);return this.zf.Dhg(b)}Ghg(b){this.Nc.dh=this.Uh(this.Nc.dh);this.Ji.Ni(b);return this.zf.Ghg(b)}noe(b){this.zm&&(this.zm.vsa=!0);this.Nc.di=this.Uh(this.Nc.di);this.Ji.Ni(b);return this.zf.noe(b)}ooe(b){this.Nc.dj=this.Uh(this.Nc.dj);this.Ji.Ni(b);return this.zf.ooe(b)}poe(b){this.Nc.dk=this.Uh(this.Nc.dk);this.Ji.Ni(b);return this.zf.poe(b)}qoe(b){this.zm&&(this.zm.B1c=!0);this.Nc.dl=this.Uh(this.Nc.dl);this.Ji.Ni(b);return this.zf.qoe(b)}voe(b){this.Nc.dm=
this.Uh(this.Nc.dm);this.Ji.Ni(b);return this.zf.voe(b)}soe(b){this.Nc.dn=this.Uh(this.Nc.dn);this.Ji.Ni(b);return this.zf.soe(b)}}Object(u.a)(pE,"HtmlEventUsageCollector",null,[319]);class TA{constructor(b,h,r=!1){this.Df=b;this.tD=h;this.t8k=r}}Object(u.a)(TA,"TagEventParam",null,[]);class Ux{constructor(b,h=null){this.fAd=this._prunedElements=this.ybf=this._voidElements=null;this.zd=b;this.j6=h||nn.a.Jzi("");this.x1o()}get Nc(){return this.j6}fVn(b,h,r){this.ybf[h]?this.jij():(this.Nc.e++,(h=this.fAd[h])&&
h(new TA(b,r,!1)),this.Nc.b++)}jij(){this.Nc.d++}ZUn(){this.Nc.c++}LUn(b,h,r){if(this.ybf[h])this.jij();else{if(h=this.fAd[h])return this.Nc.b++,h(new TA(b,r,!1));this.Nc.f++;return this.zd.soe(new TA(b,null))}return 2}x1o(){this._voidElements=tb.a.h9("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.ybf=tb.a.h9("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",
!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=tb.a.h9("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.zd,h=this.zd,r=this.zd,A=this.zd,M=this.zd,ba=this.zd,oa=this.zd,Ja=this.zd,jb=this.zd,zb=this.zd,Eb=this.zd,Sb=this.zd,nc=this.zd,Dc=this.zd,Zc=this.zd,Gd=this.zd,de=this.zd,he=this.zd,fe=this.zd,
Yd=this.zd;this.fAd=tb.a.h9("A",Object(F.a)(this.zd,this.zd.Qle,"onAOpen"),"ABBR",Object(F.a)(this.zd,this.zd.Edg,"onAbbrOpen"),"ACRONYM",Object(F.a)(this.zd,this.zd.Fdg,"onAcronymOpen"),"ADDRESS",Object(F.a)(this.zd,this.zd.Jdg,"onAddressOpen"),"APPLET",Object(F.a)(this.zd,this.zd.Ydg,"onAppletOpen"),"AREA",Object(F.a)(this.zd,this.zd.$dg,"onAreaTag"),"B",Object(F.a)(this.zd,this.zd.Wle,"onBOpen"),"BASE",Object(F.a)(this.zd,this.zd.aeg,"onBaseTag"),"BASEFONT",Object(F.a)(this.zd,this.zd.beg,"onBasefontTag"),
"BDO",Object(F.a)(this.zd,this.zd.ceg,"onBdoOpen"),"BIG",Object(F.a)(this.zd,this.zd.Zle,"onBigOpen"),"BLOCKQUOTE",Object(F.a)(this.zd,this.zd.$le,"onBlockquoteOpen"),"BODY",Object(F.a)(this.zd,this.zd.reg,"onBodyOpen"),"BR",Object(F.a)(this.zd,this.zd.ame,"onBrTag"),"BUTTON",Object(F.a)(this.zd,this.zd.ueg,"onButtonOpen"),"CAPTION",Object(F.a)(this.zd,this.zd.cme,"onCaptionOpen"),"CENTER",Object(F.a)(this.zd,this.zd.dme,"onCenterOpen"),"CITE",Object(F.a)(this.zd,this.zd.gme,"onCiteOpen"),"CODE",
Object(F.a)(this.zd,this.zd.hme,"onCodeOpen"),"COL",Object(F.a)(this.zd,this.zd.Geg,"onColTag"),"COLGROUP",Object(F.a)(this.zd,this.zd.Heg,"onColgroupOpen"),"DD",Object(F.a)(this.zd,this.zd.ome,"onDdOpen"),"DEL",Object(F.a)(this.zd,this.zd.pme,"onDelOpen"),"DFN",Object(F.a)(this.zd,this.zd.sme,"onDfnOpen"),"DIR",Object(F.a)(this.zd,this.zd.tme,"onDirOpen"),"DIV",Object(F.a)(this.zd,this.zd.vme,"onDivOpen"),"DL",Object(F.a)(this.zd,this.zd.wme,"onDlOpen"),"DT",Object(F.a)(this.zd,this.zd.xme,"onDtOpen"),
"EM",Object(F.a)(this.zd,this.zd.zme,"onEmOpen"),"FIELDSET",Object(F.a)(this.zd,this.zd.kfg,"onFieldsetOpen"),"FONT",Object(F.a)(this.zd,this.zd.Hme,"onFontOpen"),"FORM",Object(F.a)(this.zd,this.zd.rfg,"onFormOpen"),"FRAME",Object(F.a)(this.zd,this.zd.tfg,"onFrameTag"),"FRAMESET",Object(F.a)(this.zd,this.zd.ufg,"onFramesetOpen"),"H1",Object(F.a)(this.zd,this.zd.Kme,"onH1Open"),"H2",Object(F.a)(this.zd,this.zd.Lme,"onH2Open"),"H3",Object(F.a)(this.zd,this.zd.Mme,"onH3Open"),"H4",Object(F.a)(this.zd,
this.zd.Nme,"onH4Open"),"H5",Object(F.a)(this.zd,this.zd.Ome,"onH5Open"),"H6",Object(F.a)(this.zd,this.zd.Pme,"onH6Open"),"HEAD",Object(F.a)(this.zd,this.zd.Afg,"onHeadOpen"),"HR",Object(F.a)(this.zd,this.zd.Qme,"onHrTag"),"HTML",Object(F.a)(this.zd,this.zd.Gfg,"onHtmlOpen"),"I",Object(F.a)(this.zd,this.zd.Rme,"onIOpen"),"IFRAME",Object(F.a)(this.zd,this.zd.Ifg,"onIframeOpen"),"IMG",Object(F.a)(this.zd,this.zd.Ume,"onImgTag"),"INPUT",Object(F.a)(this.zd,this.zd.Nfg,"onInputTag"),"INS",Object(F.a)(this.zd,
this.zd.Vme,"onInsOpen"),"ISINDEX",Object(F.a)(this.zd,this.zd.Tfg,"onIsindexOpen"),"KBD",Object(F.a)(this.zd,this.zd.Xme,"onKbdOpen"),"LABEL",Object(F.a)(this.zd,this.zd.Zme,"onLabelOpen"),"LEGEND",Object(F.a)(this.zd,this.zd.ane,"onLegendOpen"),"LI",Object(F.a)(this.zd,this.zd.bne,"onLiOpen"),"LINK",Object(F.a)(this.zd,this.zd.dgg,"onLinkTag"),"MAP",Object(F.a)(this.zd,this.zd.hgg,"onMapOpen"),"MATH",Object(F.a)(this.zd,this.zd.dne,"onMathOpen"),"MENU",Object(F.a)(this.zd,this.zd.onMenuOpen,"onMenuOpen"),
"META",Object(F.a)(this.zd,this.zd.ngg,"onMetaTag"),"NOFRAMES",Object(F.a)(this.zd,this.zd.vgg,"onNoframesOpen"),"NOSCRIPT",Object(F.a)(this.zd,this.zd.wgg,"onNoscriptOpen"),"OBJECT",Object(F.a)(this.zd,this.zd.ygg,"onObjectOpen"),"OL",Object(F.a)(this.zd,this.zd.one,"onOlOpen"),"OPTGROUP",Object(F.a)(this.zd,this.zd.Agg,"onOptgroupOpen"),"OPTION",Object(F.a)(this.zd,this.zd.qne,"onOptionOpen"),"P",Object(F.a)(this.zd,this.zd.une,"onPOpen"),"PARAM",Object(F.a)(this.zd,this.zd.Hgg,"onParamTag"),"PRE",
Object(F.a)(this.zd,this.zd.Cne,"onPreOpen"),"Q",Object(F.a)(this.zd,this.zd.Tgg,"onQOpen"),"S",Object(F.a)(this.zd,this.zd.Kne,"onSOpen"),"SAMP",Object(F.a)(this.zd,this.zd.Lne,"onSampOpen"),"SCRIPT",Object(F.a)(this.zd,this.zd.ihg,"onScriptOpen"),"SELECT",Object(F.a)(this.zd,this.zd.ohg,"onSelectOpen"),"SMALL",Object(F.a)(b,b.Wne,"onSmallOpen"),"SPAN",Object(F.a)(h,h.Xne,"onSpanOpen"),"STRIKE",Object(F.a)(r,r.$ne,"onStrikeOpen"),"STRONG",Object(F.a)(A,A.aoe,"onStrongOpen"),"STYLE",Object(F.a)(M,
M.shg,"onStyleOpen"),"SUB",Object(F.a)(ba,ba.boe,"onSubOpen"),"SUP",Object(F.a)(oa,oa.doe,"onSupOpen"),"TABLE",Object(F.a)(Ja,Ja.foe,"onTableOpen"),"TBODY",Object(F.a)(jb,jb.xhg,"onTbodyOpen"),"TD",Object(F.a)(zb,zb.Tfd,"onTdOpen"),"TEXTAREA",Object(F.a)(Eb,Eb.Bhg,"onTextareaOpen"),"TFOOT",Object(F.a)(Sb,Sb.Chg,"onTfootOpen"),"TH",Object(F.a)(nc,nc.ioe,"onThOpen"),"THEAD",Object(F.a)(Dc,Dc.Dhg,"onTheadOpen"),"TITLE",Object(F.a)(Zc,Zc.Ghg,"onTitleOpen"),"TR",Object(F.a)(Gd,Gd.noe,"onTrOpen"),"TT",
Object(F.a)(de,de.ooe,"onTtOpen"),"U",Object(F.a)(he,he.poe,"onUOpen"),"UL",Object(F.a)(fe,fe.qoe,"onUlOpen"),"VAR",Object(F.a)(Yd,Yd.voe,"onVarOpen"))}}Object(u.a)(Ux,"AHtmlProcessor",null,[]);class qE{constructor(b,h){this.childNodes=b.childNodes;this.tD=h;this.gvf=0;this.Fde=!1}}Object(u.a)(qE,"HtmlProcessorArguments",null,[]);class tu extends Ux{constructor(b,h,r=null){super(b,r);this.pC=h;this.WXe=null}get Xqn(){null==this.WXe&&(this.WXe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):
!1);return this.WXe}process(b,h=null){b&&(this.zd.reset(),this.$vj(new qE(b,new Px.a),h))}$vj(b,h){b.childNodes.length&&(b=new ft.a(h,Object(F.a)(this,this.bjo,"processChild"),b),b.sm("HTML Processing Operation"),h||(b.ni=!0),b.run())}bjo(b,h){var r;const A=h.childNodes[h.gvf];if(3===A.nodeType)return this.zd.Xle(),this.zd.Jga(A.nodeValue,new TA(A,h.tD.owi())),tu.SAc(h);if(1!==A.nodeType)return tu.SAc(h);if(!h.Fde){const ba=C.a.zC(A.tagName);if(!tu.EZm(A))if(this._prunedElements[ba])this.ZUn();else{tu.kLn(A);
null===(r=this.pC)||void 0===r?void 0:r.S6m();this.zd.Xle();var M=A.id;const oa=A.tagName;r=h.tD.owi();const Ja=A.getAttribute?A.getAttribute("class"):null;M=new xz(M,oa,Ja?Ja:"",A.attributes?A.attributes.length:0);M.isValid&&r.add(M);if(this._voidElements[ba])return this.fVn(A,ba,r),tu.SAc(h);M=!1;switch(this.LUn(A,ba,r)){case 1:M=!0;break;case 3:return tu.SAc(h)}switch(this.zd.NRf(A)){case 1:M=!0}h.Fde=M;this.$vj(new qE(A,r),b);if(!b.ni)return!0}}if(h.Fde){if(this.Xqn&&!this.fAd[C.a.zC(A.tagName)])return tu.SAc(h);
this.zd.onClose()}return tu.SAc(h)}static kLn(b){3!==b.nodeType&&Tj.a.Im(b,"alreadyPasted",!0)}static EZm(b){return 3!==b.nodeType&&Tj.a.Eb(b,"alreadyPasted")}static SAc(b){b.gvf++;b.Fde=!1;return b.gvf<b.childNodes.length}}Object(u.a)(tu,"HtmlProcessor",Ux,[]);var Pu=d(545);const cw={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,
["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,
["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,
["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,
["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,
["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,
["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,
["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,
["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,
["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,
["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,
["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,
["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,
["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,
["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,
["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["no style present"]:313,["OTHERS"]:314,["animation"]:315,["background"]:316,["background-blur"]:317,["background-position"]:318,
["background-repeat"]:319,["border-bottom"]:320,["border-color"]:321,["border-image"]:322,["border-left"]:323,["border-radius"]:324,["border-right"]:325,["border-spacing"]:326,["border-style"]:327,["border-top"]:328,["border-width"]:329,["column-rule"]:330,["column-span"]:331,["columns"]:332,["flex"]:333,["flex-flow"]:334,["font"]:335,["font-size-adjust"]:336,["gap"]:337,["grid"]:338,["grid-area"]:339,["grid-auto-columns"]:340,["grid-auto-rows"]:341,["grid-column"]:342,["grid-column-gap"]:343,["grid-gap"]:344,
["grid-row"]:345,["grid-row-gap"]:346,["grid-template"]:347,["isolation"]:348,["list-style"]:349,["outline"]:350,["overflow"]:351,["page-break-after"]:352,["page-break-before"]:353,["page-break-inside"]:354,["place-content"]:355,["place-items"]:356,["place-self"]:357,["scroll-snap-align"]:358,["scroll-snap-stop"]:359,["scroll-snap-type"]:360,["shape-image-threshold"]:361,["shape-margin"]:362,["shape-outside"]:363,["text-combine-upright"]:364,["text-justify"]:365,["text-orientation"]:366,["text-underline-position"]:367,
["transition"]:368,["perspective-origin-x"]:369,["perspective-origin-y"]:370,["scrollbar-width"]:371,["scroll-snap-coordinate"]:372,["scroll-snap-destination"]:373,["scroll-snap-points-x"]:374,["scroll-snap-points-y"]:375,["scroll-snap-type-x"]:376,["scroll-snap-type-y"]:377,["text-emphasis"]:378,["text-underline-offset"]:379,["transform-box"]:380},tv={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,
["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,
["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89,["article"]:90,["aside"]:91,["audio"]:92,["bb"]:93,["canvas"]:94,["command"]:95,
["datagrid"]:96,["datalist"]:97,["details"]:98,["dialog"]:99,["embed"]:100,["eventsource"]:101,["figcaption"]:102,["figure"]:103,["footer"]:104,["h1"]:105,["h2"]:106,["h3"]:107,["h4"]:108,["h5"]:109,["h6"]:110,["header"]:111,["hgroup"]:112,["keygen"]:113,["mark"]:114,["meter"]:115,["nav"]:116,["output"]:117,["progress"]:118,["rp"]:119,["rt"]:120,["ruby"]:121,["section"]:122,["source"]:123,["table"]:124,["time"]:125,["track"]:126,["video"]:127,["wbr"]:128};class Xw{constructor(){this.xx=0;this.oXc=
6;this.tem=this.ori=!1;this.Apf=null;this.yri=this.xri=this.wri=this.rri=this.qri=!1;this.progId=null;this.JFf=this.tri=this.sri=this.vsa=this.B1c=this.uem=this.vem=!1;this.Ksj=this.Ttc=0;this.gqj=this.platform=null;this.LVi=this.Cge=!1;this.pBe=new Map;this.iPk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,["Other"]:10};this.Cyf=[1,3,4,2,5];this.uEb={}}get zEg(){if(null!==this.Apf)switch(this.Apf){case "XLO":return"Excel Online"}if(this.yri)return"Word Online";
if(this.xri||this.qri)return"PowerPoint Online";if(this.ori)return"Excel Online";if(this.rri)return"Google Docs";if(this.wri)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}iU(b,h){const r=new fa.a;r.name=b;"number"===typeof h?r.int64=h:"boolean"===typeof h?r.bool=h:"string"===typeof h&&(r.string=h);return r}mnd(b,h,r){const A=new Pu.a;A.name=b;
A.dataFields=h;A.dnmInterval=r;A.dnmAllowedPartA=this.Cyf;ca.a.sendDirectNumericEvent(A)}kIn(){for(const [b,h]of this.pBe)for(const [r,A]of h){const M=[this.iU("style",b),this.iU("unit",r),this.iU("frequency",A)];Object($b.a)("StylesAndUnitsFrequency",!0,0,M)}}mGn(){const b=this.zhl(),h=[],r=[this.iU("isUserConsumer",this.Cge),this.iU("isDocumentBlank",this.LVi),this.iU("FoundText",this.JFf),this.iU("FoundTable",this.vsa),this.iU("FoundImage",this.sri),this.iU("FoundList",this.B1c),this.iU("FoundLink",
this.tri),this.iU("Browser",this.Ttc),this.iU("SourceApp",this.iPk[this.zEg])];for(const A of r)h.push(A);this.mnd("Office.DNM.Word.Online.ExternalPasteEvent2",h,2);v.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}WFl(b,h){var r,A;const M=[];b=this.iU("tag",null!==(r=tv[b])&&void 0!==r?r:tv.OTHERS);h=this.iU("style",null!==(A=cw[h])&&void 0!==A?A:cw.OTHERS);A=this.iU("IsUserConsumer",this.Cge);M.push(b);M.push(h);M.push(A);this.mnd("Office.DNM.Word.Online.ExternalPasteEvent1",M,2)}XFl(b){var h;
const r=[];b=this.iU("tag",null!==(h=tv[b])&&void 0!==h?h:tv.OTHERS);h=this.iU("IsUserConsumer",this.Cge);r.push(b);r.push(h);this.mnd("Office.DNM.Word.Online.ExternalPasteEvent3",r,2)}nGn(){const b=this.uEb;for(const A in b){var h=A,r=b[A];this.XFl(h);for(const M of Object.keys(r))this.WFl(h,M)}}t7c(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.uEb||(this.uEb[b]={}),this.uEb[b][h]=this.rNm(b,h)+1)}rNm(b,h){if(!(b&&b.length&&h&&h.length&&this.uEb&&b in this.uEb))return 0;
b=b.toLowerCase();h=h.toLowerCase();return(b=this.uEb[b])&&h in b?b[h]:0}zhl(){const b={};b.ActionIdFlags=this.xx;b.SourceApp=this.zEg;b.CopySourceBrowser=this.oXc;b.PasteBrowser=this.Ttc;b.IsSameBrowserPaste=this.Tsn(this.oXc,this.Ttc);b.IsCrossBrowserPaste=this.djn(this.oXc,this.Ttc);b.IsUncategorizedBrowserPaste=this.Nvn(this.oXc,this.Ttc);b.Platform=this.platform;b.OperationId=this.gqj;return b}Tsn(b,h){return 5===b||6===b?!1:b===h}djn(b,h){return 6===b?!1:b!==h}Nvn(b,h){return 5===b&&5===h}}
Object(u.a)(Xw,"HtmlContentMetadata",null,[]);var wC=d(231),xC=d(1049),Qu=d(343),ch=d(47),wr=d(84),Jy;(function(b){b[b.igk=0]="EmptyPara";b[b.$jk=1]="StartingOfPara";b[b.uik=2]="MiddleOfPara";b[b.kgk=3]="EndOfPara"})(Jy||(Jy={}));Object(u.b)("PasteContext",Jy);class Oo{constructor(b,h,r,A,M,ba,oa){this.Fic=oa;this.IYe=!1;this.k2j=this.dXe=null;this.Ubo=Ja=>{let jb=!1;return en.a.Itb?(vp.a.instance.ee(()=>{jb=this.xsj(Ja)},"APEM:PE"),jb):this.xsj(Ja)};this.xsj=Ja=>{db.a.mark(5568);this.bmi(Ja);let jb=
this.GNn;if(this.x_i){const zb=this.XTj();zb&&(jb=this.Cwb);v.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",zb)}Ja.Ri(jb);return!0};this.GNn=Ja=>{db.a.mark(5569);var jb=new zc.a;this.Zcb.restore(jb);var zb=new zc.a;this.SEf.restore(zb);this.SEf=null;v.ULS.shipAssertTag(6305489,307,Ua.a.Qh(jb));v.ULS.shipAssertTag(6305490,307,Ua.a.Qh(zb));Ab.OutlineElementNavigator.Me(jb);const Eb=Ed.ParagraphReader.Eh(jb)?Ed.ParagraphReader.textLength(jb.currentNode):0;Ab.OutlineElementNavigator.ke(jb);
Ab.OutlineElementNavigator.Me(zb);v.ULS.shipAssertTag(6305491,307,Ed.ParagraphReader.Eh(zb));const Sb=Ed.ParagraphReader.textLength(zb.currentNode);Ab.OutlineElementNavigator.ke(zb);var nc=y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.WordOnline.ChangeGate.OfficeVSO_8111697_MergeParagraphsAfterCCPlaceholderPaste")&&this.PYi();let Dc=this.hpd||nc;var Zc=new sn.a;Zc.kd(jb);Ab.OutlineElementNavigator.at(Zc,!1,!1);var Gd=Zc.currentNode===zb.currentNode,de=!!this.Ui&&!!(this.Ui.xx&8192);
let he=!1;!de&&this.Ui.td&&Object(Za.a)(ji.DictionaryPropertySet,this.Ui.td)&&(de=(nc=this.Ui.td.wf(Bd.a.IXb))&&""!==nc?!0:!1);nc=!1;this.Ui.td instanceof wC.APropertySet&&(nc=this.Ui.td.ka(Bd.a.ega,!1));if(Gd){Zc=zc.a.Za(jb.currentNode);Ed.ParagraphReader.Au(Ab.OutlineElementNavigator.Me(Zc))||(jb=zb);jb.currentNode.id!==zb.currentNode.id&&(v.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",mf.ListItemReader.Dg(jb),mf.ListItemReader.Dg(zb)),
de=Oo.Of.merge(jb,zb,!0,de),v.ULS.shipAssertTag(6305492,307,de));zb=jb;var fe=!0}else{Gd=!!(this.Ui.xx&4);fe=this.Pd.Ag&&Gd&&this.Ui.nab;var Yd=!!(this.Ui.xx&262144);this.qkg&&this.Ui&&!Gd&&!Yd&&(this.qkg.QMi(jb,!1),this.qkg.QMi(zb,!0));Ab.OutlineElementNavigator.Me(Zc);Gd=Ed.ParagraphReader.Eh(Zc)?Ed.ParagraphReader.textLength(Zc.currentNode):0;Ab.OutlineElementNavigator.ke(Zc);this.PYi()||this.L$k(Zc,jb,zb);Yd=new sn.a;Yd.kd(Zc);Ab.OutlineElementNavigator.at(Yd,!1,!1);Yd.currentNode.id===zb.currentNode.id&&
(this.IYe=!0);if(this.i_.bUa||this.c5o)if(Yd.so.id!==zb.so.id){for(;Zc.currentNode.id!==zb.currentNode.id;)Ab.OutlineElementNavigator.Me(Zc,!1),this.i_.$Na(vc.a.create(Zc.currentNode)),Zc.rc(),Ab.OutlineElementNavigator.at(Zc,!1,!1);Zc.kd(jb);Ab.OutlineElementNavigator.at(Zc,!1,!1)}else he=!0;this.pda&&({hpd:Dc,FAa:Zc}=this.pda.xng(jb,zb,Dc,Zc));wr.a.BL&&this.Fic&&(Zc=this.Fic.xng(jb,zb,Zc));if(this.Ui.Kue&&(v.ULS.shipAssertTag(6305493,307,this.Ui.Roc),Yd=new zc.a,Yd.kd(Zc),Yd=Ab.OutlineElementNavigator.Me(Yd))){var Td=
this.Ui.Kue.Mf(Yd.ra.K(0));Yd.ra.K(0).formatting=Td}Yd=0;de&&this.W3e&&(Yd=1);Td=this.F5o(jb,Zc,Yd);this.Ui.SAe=null;if(this.Ui.$Da||this.Ui.S0a)this.Ui.SAe=this.YMm(Td?jb.currentNode:Zc.currentNode,Td);var wf=!1;Td&&(wf=mf.ListItemReader.Dg(jb),v.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",wf,mf.ListItemReader.Dg(zb)),this.dXe=wf=Oo.Of.merge(jb,Zc,!0,de,zb,void 0,he,fe,this.W3e),this.G5o(jb,Yd)&&this.dOn(jb,zb,Yd,de));Yd=Oo.hco.j$m(jb,
Zc,zb,Eb,wf,this.fTb);var Lf=!1;if(Dc){const ii=new sn.a;ii.kd(zb);Ab.OutlineElementNavigator.N3(ii,!1,!1);Lf=mf.ListItemReader.Dg(ii);const Bi=mf.ListItemReader.Dg(zb),Ml=nc;v.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",Ml);const hk=!!(this.Ui.xx&524288);fe=Oo.Of.merge(ii,zb,!0,de,void 0,!0,void 0,fe,this.W3e,Ml,!hk,!hk);v.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Lf,Bi,fe?
"True":"False, will cause IP to reset to zero.");zb=(Lf=fe)?ii:zb}else fe=!1,v.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.i_.bUa&&he&&(Td&&!this.Gln(Yd,wf)?(Zc=new zc.a,Zc.kd(jb),jb=Ab.OutlineElementNavigator.Me(Zc),this.i_.uva(jb,Eb,Eb+Gd)):Dc&&!this.mon(Yd,Lf)?(jb=new zc.a,jb.kd(Zc),jb=Ab.OutlineElementNavigator.Me(jb),this.i_.uva(jb,0,Gd)):(jb=new zc.a,jb.kd(Zc),jb=Ab.OutlineElementNavigator.Me(jb),this.i_.$Na(vc.a.create(jb))));this.Tfo(Yd);de||this.iD.Zjo(Yd)}v.ULS.shipAssertTag(6305494,
307,zb.isValid);de=Ab.OutlineElementNavigator.Me(zb);jb=fe?Ed.ParagraphReader.textLength(de)-Sb:0;this.Ui.YJa=nc?sc.SelectionFactory.rL(de,jb-1,jb):sc.SelectionFactory.ve(de,jb);this.Ui&&this.Ui.Roc&&Ed.ParagraphReader.Vb(de)&&this.Ui.Qoe&&((nc=this.Ui.Qoe.Ugp)&&this.CM.gQ(nc,de,!0),(nc=this.Ui.Qoe.Nao)&&this.sl.xTh(de,nc));en.a.ehk&&this.GWk(this.wGm(Eb,Sb));Ja.Ri(this.Cwb);return!0};this.W_o=Ja=>{const jb=zc.a.Za(this.k2j);jb.ML(1);this.Ui.YJa=sc.SelectionFactory.vp(jb.currentNode,!1);Ja.Ri(this.Cwb);
return!0};this.Cwb=()=>{var Ja=void 0===this.Ui.xx||null===this.Ui.xx?"not available":Object(zz.a)(ns,this.Ui.xx);v.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Ui.xx,Ja);v.ULS.shipAssertTag(6305497,307,!!this.Ui.YJa);this.fTb?Object($b.a)("ExternalPasteAction",!0):Object($b.a)("InternalPasteAction",!0);this.Zcb&&(Ja=new zc.a,this.Zcb.restore(Ja),this.Zcb=null,this.QYm(Ja));this.transaction.dispose();this.fTb&&Ns.a.sHn();Ja=this.Sy.Fw;if(!Ja.ue||!Ja.Ke.uk)return!1;Ja.Ke.Fkp();
return!1};this.zLa=b;this.SEf=this.Zcb=null;this.Ui=h;this.transaction=r;this.pda=A;this.Sy=M;this.Z9=ba}get J(){return y.AFrameworkApplication.J}get W3e(){return!!this.J&&this.J.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get iD(){return null!=this.kXg?this.kXg:this.kXg=$a.a.instance.resolve(29)}get CM(){return null!=this.e7g?this.e7g:this.e7g=$a.a.instance.resolve(393)}get Xb(){return null!=this.C7g?this.C7g:this.C7g=$a.a.instance.resolve(8)}get sl(){return null!=this.U2g?this.U2g:this.U2g=
$a.a.instance.resolve(349)}get Nd(){return null!=this.u1g?this.u1g:this.u1g=$a.a.instance.resolve(10)}get Ll(){return null!=this.f1g?this.f1g:this.f1g=$a.a.instance.resolve(31)}get OF(){return null!=this.dYg?this.dYg:this.dYg=$a.a.instance.resolve(86)}get Upd(){return null!=this.k4g?this.k4g:this.k4g=$a.a.instance.Oa(882)}get Oj(){return null!=this.$5g?this.$5g:this.$5g=$a.a.instance.resolve(39).instance}get ti(){return null!=this.E6g?this.E6g:this.E6g=$a.a.instance.resolve(180).instance}get Pd(){return null!=
this.j6g?this.j6g:this.j6g=$a.a.instance.resolve(46).instance}get i_(){return null!=this.WTg?this.WTg:this.WTg=$a.a.instance.resolve(394)}get qkg(){return null!=this.h3g?this.h3g:this.h3g=$a.a.instance.Oa(883)}get Ssj(){return!1}dmi(){}get fTb(){return!1}Fsj(b){let h=!1;return en.a.Itb?(vp.a.instance.ee(()=>{h=this.Gsj(b)},"APEM:PS"),h):this.Gsj(b)}Gsj(b){var h=void 0===this.Ui.xx||null===this.Ui.xx?"not available":Object(zz.a)(ns,this.Ui.xx);v.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",
this.Ui.xx,h);v.ULS.shipAssertTag(6305487,307,Le.a.qf(this.zLa));if(this.rle)return v.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Ui.YJa=sc.SelectionFactory.Yo(this.zLa),b.Ri(this.Cwb),!0;if(!this.zLa.node)return v.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new zc.a;h.set(this.zLa.node);Le.a.yv(h);Ab.OutlineElementNavigator.ke(h);this.k2j=h.origin;if(this.Ssj)return h.mt(10),this.dmi(h,b),b.Ri(this.W_o),!0;this.pda&&this.pda.LXn(this.zLa);
if(!this.Udp(this.zLa))return this.Ui.iV&&(this.Ui.iV.fail("SplitLine Failed",!0),this.Ui.ZB=!0),this.Ui.YJa=sc.SelectionFactory.Yo(this.zLa),b.Ri(this.Cwb),!0;const r=new sn.a;r.kd(h);Ab.OutlineElementNavigator.at(r,!1,!1);this.Zcb=new xC.a(h);this.SEf=new xC.a(r);b.Ri(this.Ubo);return!0}XTj(){return!1}get x_i(){return this.J.$("PptCcpFix2IsEnabled")}get c5o(){return this.J.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}wGm(b,h){if(0==b&&0==h)return Jy.igk;if(0==b&&0!=h)return Jy.$jk;if(0!=
b&&0!=h)return Jy.uik;if(0==h&&0!=b)return Jy.kgk}GWk(b){b=[Object.assign(new fa.a,{name:"isExternalPaste",bool:this.fTb}),Object.assign(new fa.a,{name:"Single OE",bool:this.IYe}),Object.assign(new fa.a,{name:"Context",string:b})];Object($b.a)("ContextualTelemetryForPaste",!0,void 0,b)}Gln(b,h){return!h&&!!b&&Ua.a.Qh(b.FAa)&&Ua.a.Xnb(b.FAa)}mon(b,h){return!h&&!!b&&Ua.a.Qh(b.rub)&&Ua.a.Xnb(b.rub)}Tfo(b){Oo.Euj&&b&&Oo.Euj.Vjo(b)}F5o(b,h,r){var A;mf.ListItemReader.Dg(b)?(null===(A=this.Upd)||void 0===
A?void 0:A.bVf(b),h=mf.ListItemReader.Dg(h)?this.pTj:!0):Ua.a.isEmpty(b,!0)&&!r?(Oo.Of.d8a(b),h=!1):h=!0;this.pda&&(h=this.pda.brl(b,h));return h}G5o(b,h){return mf.ListItemReader.Dg(b)||1===h?!0:!1}dOn(b,h,r,A){const M=mf.ListItemReader.Dg(b);if(M){if(A=new sn.a,A.kd(b),Ab.OutlineElementNavigator.at(A,!1,!1),A.so.id!==h.so.id){r=this.Nd.Tw(b);if(mf.ListItemReader.De)({listId:ba}=mf.ListItemReader.sla(b,{Ora:0}));else{this.Nd.y0(b);var ba=b.currentNode.ka(Rc.a.listID,0);b.rc()}var oa=this.Nd.zWj,
Ja=!0;for(r.JD=fk.a.Pk;A.currentNode.id!==h.currentNode.id;){if(!oa||!Ua.a.n7o(A))if(!mf.ListItemReader.Dg(A))ch.a.getInstance().Ku?(Ua.a.bmc(A)||({Rla:r}=this.Ll.Qqa(r.ef,A,r)),this.Ll.Z0()):{Rla:r}=this.Ll.Qqa(r.ef,A,r),Ja=!1;else if(M){Ja=mf.ListItemReader.De?mf.ListItemReader.sla(A,{NUa:-1}).listLevel:this.Nd.vLf(A);var jb=this.Nd.$y(b.currentNode,ba,Ja);jb=jb?Qu.a.yaa(jb,null):r;Ja=Qu.a.$W(jb.listType,r.listStyle,null,0,Ja,"","");Ja.Ivb=b.currentNode;this.Ll.zZo(Ja);this.Ll.Pxe(A,!0);Ja=!1}Ab.OutlineElementNavigator.at(A,
!1,!1)}oa&&Ja&&this.Ll.$bl()}}else if(1===r)for(r=new sn.a,r.kd(b),Ab.OutlineElementNavigator.Me(r),b=Ed.ParagraphReader.Eh(r)?r.currentNode:null,ba=this.Xb.tOf(r),Ab.OutlineElementNavigator.ke(r),Ab.OutlineElementNavigator.at(r,!1,!1);r.currentNode.id!==h.currentNode.id;)Ab.OutlineElementNavigator.Me(r),oa=Ed.ParagraphReader.Eh(r)?r.currentNode:null,Ab.OutlineElementNavigator.ke(r),oa&&b&&A&&(ba&&this.CM.gQ(ba,oa,!0),this.Z9.hej(b,oa,M),this.Z9.kua(b,oa,1,!0)),Ab.OutlineElementNavigator.at(r,!1,
!1)}L$k(b,h,r){if(this.Pd.Ag){for(;b.currentNode!==r.currentNode;){Ab.OutlineElementNavigator.Me(b,!1);const A=this.ti.gqd(vc.a.create(b.currentNode));let M;({type:M}=A.N9d()).returnValue&&this.Pd.ev(M);for(let ba=0;ba<A.length;ba++){let oa;const Ja=({vge:oa}=A.getContext(ba)).returnValue;oa&&(Oo.Rp.Bvb(Ja,1),this.Oj.Iyb(Ja,1,null,!0))}b.rc();Ab.OutlineElementNavigator.at(b,!1,!1)}b.kd(h);Ab.OutlineElementNavigator.at(b,!1,!1)}}YMm(b,h){b=zc.a.Za(b);Ab.OutlineElementNavigator.Me(b);return Ed.ParagraphReader.Vb(b.currentNode)?
(h=h?Ed.ParagraphReader.textLength(b.currentNode):0,sc.SelectionFactory.ve(b.currentNode,h)):Hi.TableReader.OU(b.currentNode)?sc.SelectionFactory.Ir(b.currentNode):null}QYm(b){if(b){if(this.fTb&&Hi.TableReader.yy(b)&&this.IYe){if(null!=this.dXe&&0==this.dXe){var h=new sn.a;h.kd(b);Ab.OutlineElementNavigator.at(h,!1,!1);b.kd(h)}h=ur.a.hGo(b);const r=Ed.ParagraphReader.fn(h);h&&r&&(this.Ui.YJa=sc.SelectionFactory.ve(r,0),b=zc.a.Za(h))}else ur.a.aco(b);b&&Hi.TableReader.yy(b)&&bi.returnToContainingCell(b)&&
ur.a.r4k(b.currentNode)}else v.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}c4o(b,h){const r=new zc.a;r.kd(b);b=Ab.OutlineElementNavigator.Me(r);h=Ed.ParagraphReader.Vb(b)&&h===Ed.ParagraphReader.textLength(b);v.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}Udp(b){var h;v.ULS.shipAssertTag(6305498,307,Le.a.qf(b));if(null===(h=this.OF)||void 0===h?0:h.tEa)return!!this.OF.tEa(b.node,b.cpBegin,{$em:!0,Fb:b.Fb,Tb:b.Tb});h=zc.a.Za(b.node);var r=
h.Ld();Ab.OutlineElementNavigator.ke(h);r&&b.isValid||v.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:r,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!Ua.a.Qh(h)&&(v.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.J.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;r=Oo.Of.eta(h,!0);const A=this.c4o(h,b.cpBegin);Oo.Of.Jca(h,r,b,!1,!1,!0,A);return!0}PYi(){return!!(this.Ui.xx&
65536)}static get Rp(){return null!=Oo.nYg?Oo.nYg:Oo.nYg=$a.a.instance.resolve(82)}static get rj(){return cm.PageReader.instance}static get Of(){return null!=Oo.e2g?Oo.e2g:Oo.e2g=$a.a.instance.resolve(16)}static get Es(){return ch.a.getInstance()}static get qc(){return null!=Oo.vWg?Oo.vWg:Oo.vWg=$a.a.instance.Oa(23)}static get Euj(){return null!=Oo.m3g?Oo.m3g:Oo.m3g=$a.a.instance.resolve(885)}static get hco(){return null!=Oo.g3g?Oo.g3g:Oo.g3g=$a.a.instance.resolve(886)}}Object(u.a)(Oo,"APasteExecutionManager",
null,[]);class Dt{constructor(b){this.vk=b}reset(){this.vk.reset()}get PYc(){return this.vk.PYc}Jga(b,h){this.vk.Jga(b,h)}Qba(b){this.vk.Qba(b)}hwb(b){this.vk.hwb(b)}SCa(b){this.vk.SCa(b)}MMa(b){this.vk.MMa(b)}LYa(b,h){this.vk.LYa(b,h)}KYa(){this.vk.KYa()}aG(b){this.vk.aG(b)}uH(){this.vk.uH()}dwb(){this.vk.dwb()}cwb(){this.vk.cwb()}WCa(b){this.vk.WCa(b)}UCa(){this.vk.UCa()}PMa(b){this.vk.PMa(b)}VCa(){this.vk.VCa()}ycb(b){this.vk.ycb(b)}Wba(b){this.vk.Wba(b)}Uba(){this.vk.Uba()}n8(b){this.vk.n8(b)}Vba(){this.vk.Vba()}Tba(b){this.vk.Tba(b)}Sba(){this.vk.Sba()}PYa(b,
h){this.vk.PYa(b,h)}vcb(){this.vk.vcb()}}Object(u.a)(Dt,"AHtmlNormalizer",null,[313,314]);class Yw extends Dt{constructor(b){super(b);this.kM=!1}Jga(b,h){this.kM?this.UP.mP(()=>{this.Kng(b,h)}):this.Kng(b,h)}Kng(b,h){this.vk.Jga(b,h)}Qba(b){this.kM?this.UP.mP(()=>{this.nng(b)}):this.nng(b)}nng(b){this.vk.Qba(b)}SCa(b){this.kM?this.UP.mP(()=>{this.did(b)}):this.did(b)}did(b){this.vk.SCa(b)}MMa(b){this.kM?this.UP.mP(()=>{this.lng(b)}):this.lng(b)}lng(b){this.vk.MMa(b)}LYa(b,h){this.kM?this.UP.mP(()=>
{this.eng(b,h)}):this.eng(b,h)}eng(b,h){this.vk.LYa(b,h)}KYa(){this.kM?this.UP.mP(Object(F.a)(this,this.dng,"processAnchorEnd")):this.dng()}dng(){this.vk.KYa()}aG(b){this.kM?this.UP.mP(()=>{this.wng(b)}):this.wng(b)}wng(b){this.vk.aG(b)}uH(){this.kM?this.UP.mP(Object(F.a)(this,this.vng,"processParagraphEnd")):this.vng()}vng(){this.vk.uH()}dwb(){this.kM?this.UP.mP(Object(F.a)(this,this.zng,"processPreFormattedTextStart")):this.zng()}zng(){this.vk.dwb()}cwb(){this.kM?this.UP.mP(Object(F.a)(this,this.yng,
"processPreFormattedTextEnd")):this.yng()}yng(){this.vk.cwb()}WCa(b){this.kM?this.UP.mP(()=>{this.rng(b)}):this.rng(b)}rng(b){this.vk.WCa(b)}UCa(){this.kM?this.UP.mP(Object(F.a)(this,this.ong,"processListEnd")):this.ong()}ong(){this.vk.UCa()}PMa(b){this.kM?this.UP.mP(()=>{this.qng(b)}):this.qng(b)}qng(b){this.vk.PMa(b)}VCa(){this.kM?this.UP.mP(Object(F.a)(this,this.png,"processListItemEnd")):this.png()}png(){this.vk.VCa()}Wba(b){this.kM?this.UP.mP(()=>{this.Jng(b)}):this.Jng(b)}Jng(b){this.vk.Wba(b)}Uba(){this.kM?
this.UP.mP(Object(F.a)(this,this.Gng,"processTableEnd")):this.Gng()}Gng(){this.vk.Uba()}n8(b){this.kM?this.UP.mP(()=>{this.Ing(b)}):this.Ing(b)}Ing(b){this.vk.n8(b)}Vba(){this.kM?this.UP.mP(Object(F.a)(this,this.Hng,"processTableRowEnd")):this.Hng()}Hng(){this.vk.Vba()}Tba(b){this.kM?this.UP.mP(()=>{this.Fng(b)}):this.Fng(b)}Fng(b){this.vk.Tba(b)}Sba(){this.kM?this.UP.mP(Object(F.a)(this,this.Eng,"processTableCellEnd")):this.Eng()}Eng(){this.vk.Sba()}PYa(b,h){this.kM?this.UP.mP(()=>{this.tng(b,h)}):
this.tng(b,h)}tng(b,h){this.vk.PYa(b,h)}vcb(){this.kM?this.UP.mP(Object(F.a)(this,this.vwj,"processMathEnd")):this.vwj()}vwj(){this.vk.vcb()}}Object(u.a)(Yw,"AQueuingHtmlNormalizer",Dt,[]);var ZI=d(2018);class UA{constructor(){this.B5e=new ZI.a}mP(b){this.B5e.enqueue(b)}flush(b=!1){for(b&&this.ixe();!this.B5e.isEmpty;)this.B5e.dequeue()();b&&this.Zue()}ixe(){}Zue(){}}Object(u.a)(UA,"QueuedEventManager",null,[]);class rE extends UA{constructor(b){super();this.id=void 0;this.svf=null;this.I9c=!1;this.aca=
"";this.zee=this.tfe=!1;this.jvf=this.qgc=null;this.eed=0;this.S9c=this.tad=this.W1f=!1;this.table=null;this.Pbg=0;this.R1=b}get kTc(){return!!this.table}ixe(){this.R1.wtc.push(this.R1.currentState);this.R1.currentState=this}Zue(){this.R1.currentState=this.R1.wtc.pop()}}rE.nextId=void 0;Object(u.a)(rE,"ContentState",UA,[]);class BG{constructor(b,h,r){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.Oab=b.Oab;this.shadingColor=b.shadingColor;this.verticalAlignment=
b.verticalAlignment;this.Una=b.Una;this.YBe=b.YBe;this.upc=b.upc;this.haa=b.haa;this.contents=r;this.cUm=h}}Object(u.a)(BG,"TableCell",null,[]);var sE=d(1696),tE=d(1697);class Ky extends UA{constructor(b,h){super();this.R1=b;this.sHh=new Px.a;this.Qoa=new Px.a;this.K0e=[];this.CLd=[];this.zQa=-1;this.Z1a=0;this.rBk=h.MXf;this.qBk=h.hhn;this.gQk=h.eHg;this.vs=h.width;this.jqh=h.Oab;this.zyk=new Mu.a(new xz(h.Zba.FPi,h.Zba.Eae),h.tD,h.eDa,h.cultureName,h.MHa);this.lAk=h.xbe;this.fOd=h.styleId;this.lQk=
h.tableLook}get vk(){return this.R1.vk}rho(b){this.zQa++;this.sHh.add(b);this.CLd[this.zQa]=b.height;this.Z1a=0}get wNl(){for(;this.Z1a>=this.Qoa.count;)this.Qoa.add(Array(this.zQa+1));return this.Qoa.K(this.Z1a)}ZVk(b,h,r,A,M,ba,oa){if(0>this.zQa)return!1;for(;this.K0e[this.Z1a]>=this.zQa;)this.Z1a++;b=new BG(b,new Mu.a(h,r,A,M,ba),oa);this.wNl[this.zQa]=b;if(1<b.rowSpan)for(h=this.zQa+b.rowSpan-1,A=this.Z1a,r=this.Z1a+b.colSpan-1;A<=r;A++)this.K0e[A]>=h||(this.K0e[A]=h);this.Z1a+=b.colSpan;this.CLd[this.zQa]<
b.height&&(this.CLd[this.zQa]=b.height);return!0}ixe(){this.R1.currentState.table=this}Zue(){this.R1.currentState.table=null}Tpi(){y.AFrameworkApplication.nd("fd8b6402;j6e17681");this.flush(!0);const b=this.zQa+1;var h=Array(b);for(var r=0;r<b;r++)h[r]=Array(this.Qoa.count);r=!0;var A=0;for(var M=0;M<this.Qoa.count;M++){var ba=this.Qoa.K(M),oa=!0;for(var Ja=0;Ja<b;Ja++){var jb=ba[Ja];jb&&(oa=!1,h[Ja][M+A]=new Iy(jb.colSpan,jb.rowSpan,jb.width,jb.height,void 0,void 0,void 0,void 0,jb.Oab,jb.upc))}oa?
(this.Qoa.removeAt(M),M--,++A):r=!1}if(!r){(h=this.jqh?this.R1.ZZh(h,this.vs/100):this.R1.ZZh(h,1,this.vs))&&h.length!==this.Qoa.count&&(h=null);this.R1.xpb(!0);this.R1.mWd();this.vk.Wba(new Nu(b,this.Qoa.count,this.vs,this.jqh,h,this.rBk,this.qBk,this.gQk,this.lAk,this.fOd,this.lQk,this.zyk));for(h=0;h<b;h++){r=this.sHh.K(h);this.vk.n8(new ms(this.CLd[h],new Mu.a(r.Zba,r.tD,r.eDa,r.cultureName,r.MHa)));for(r=0;r<this.Qoa.count;r++){A=this.Qoa.K(r)[h];var zb=!!this.fOd&&""!==this.fOd&&"Custom"!==
this.fOd;M=A?A.colSpan:0;ba=A?A.rowSpan:0;A&&(M=Math.min(A.colSpan,this.Qoa.count-r),ba=Math.min(A.rowSpan,b-h));oa=A?A.width:0;Ja=A?A.height:0;jb=A?A.haa:0;const Eb=A?A.Oab:!1,Sb=A&&(65536&jb||!zb)?A.shadingColor:"",nc=A?A.verticalAlignment:0,Dc=A?A.upc:!1;zb=A?this.R1.nDm(A.Una,r,h,this.Qoa,zb,A.haa):new sE.a;const Zc=A?A.YBe:new tE.a,Gd=A?A.cUm:null;this.vk.Tba(new Iy(M,ba,oa,Ja,Sb,nc,zb,Zc,Eb,Dc,jb,new Mu.a(Gd?Gd.Zba:null,Gd?Gd.tD:null,Gd?Gd.eDa:null,Gd?Gd.cultureName:null,Gd?Gd.MHa:null)));A&&
!A.upc&&(A.contents.ixe(),A.contents.flush(),this.R1.xpb(!1),this.R1.mWd(),A.contents.Zue());this.vk.Sba()}this.vk.Vba()}this.vk.Uba();this.R1.currentState.S9c=!1;this.R1.Rki(!1)}}}Object(u.a)(Ky,"NormalizedTable",UA,[]);class li{constructor(b=!1,h=!1){this.fCk=b;this.nqa=h}get ynn(){return this.fCk}get Veb(){return this.nqa}}Object(u.a)(li,"HtmlNormalizerSettings",null,[318]);class np extends Yw{constructor(b,h=null){super(b);this.wtc=new Sw;this.S7b=h||new li}reset(){super.reset();this.currentState=
new rE(this);this.wtc.clear();this.kM=!1}get UP(){return this.currentState&&this.currentState.kTc?this.currentState.table:this.currentState}O_c(b=!1){this.currentState.I9c||(this.mWd(),this.vk.aG(this.currentState.svf),this.currentState.I9c=!0,this.currentState.S9c=!1);b||!this.currentState.qgc||this.currentState.zee||(this.vk.LYa(this.currentState.qgc,this.currentState.jvf),this.currentState.zee=!0)}N_c(){this.currentState.zee&&(this.vk.KYa(),this.currentState.zee=!1)}Ski(){this.currentState.I9c&&
(this.vk.uH(),this.currentState.I9c=!1,this.currentState.aca="")}Rki(b){this.currentState.tad&&(this.currentState.S9c?b||(this.vk.aG(null),this.vk.uH(),this.vk.VCa(),this.currentState.tad=!1):(this.vk.VCa(),this.currentState.tad=!1,this.currentState.S9c=!0))}xpb(b){this.N_c();this.Ski();this.Rki(b)}e8n(b){this.vk.WCa(new tm.a(2,1,b));this.currentState.eed++;this.currentState.W1f=!0}mWd(){!this.currentState.tad&&this.currentState.W1f&&(this.vk.UCa(),this.currentState.eed--,this.currentState.W1f=!1)}Kng(b,
h){b=this.$Tn(b);if(""!==b)if(this.O_c(),this.currentState.tfe)this.Lng(b,h);else{b=b.split(np.Ljl);for(let r=0;r<b.length-1;r++)this.Lng(b[r],h),this.vk.hwb(h);this.Lng(b[b.length-1],h)}}tng(b,h){""!==b&&(this.O_c(),this.vk.PYa(b,h))}nng(b){this.S7b.Veb||this.N_c();if(en.a.zpn){const h=this.currentState.I9c;this.O_c(!0);h?this.vk.Qba(b):this.Ski()}else this.O_c(!0),this.vk.Qba(b)}lng(b){this.currentState.kTc||this.vk.MMa(b)}did(b){this.currentState.qgc&&(b.href=this.currentState.qgc);super.did(b)}eng(b,
h){this.N_c();this.currentState.qgc=b;this.currentState.jvf=h}dng(){this.N_c();this.currentState.qgc=null;this.currentState.jvf=null}wng(b){this.currentState.svf=b;this.xpb(!0)}vng(){this.currentState.svf=null;this.xpb(!0)}zng(){this.currentState.tfe=!0}yng(){this.currentState.tfe=!1}rng(b){this.xpb(!1);this.mWd();this.vk.WCa(b);this.currentState.eed++}ong(){this.xpb(!1);this.vk.UCa();this.currentState.eed--}qng(b){this.xpb(!1);this.currentState.eed||this.e8n(b);this.vk.PMa(b);this.currentState.tad=
!0;this.currentState.S9c=!0}png(){this.xpb(!1)}Wba(b){this.currentState.kTc||(this.kM=!0,this.currentState.table=new Ky(this,b))}Jng(){}Uba(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=null;this.wtc.isEmpty?(this.kM=!1,b.Tpi()):this.UP.mP(Object(F.a)(b,b.Tpi,"flushTable"))}}Gng(){}n8(b){this.currentState.kTc&&this.currentState.table.rho(b)}Ing(){}Vba(){}Hng(){}Tba(b){let h=!1;if(this.currentState.kTc){const r=new rE(this);this.currentState.table.ZVk(b,new xz(b.Zba.FPi,
b.Zba.Eae),b.tD,b.eDa,b.cultureName,b.MHa,r)?(this.wtc.push(this.currentState),this.currentState=r):h=!0}else h=!0;h&&this.currentState.Pbg++}Fng(){}Sba(){0<this.currentState.Pbg?this.currentState.Pbg--:this.currentState=this.wtc.pop()}Eng(){}ZZh(b,h=1,r=0){if(!b)return null;const A=b.length;if(!A)return null;const M=b[0].length;for(var ba=1;ba<A;ba++)if(b[ba].length!==M)return null;ba=Array(M+1);ba[0]=0;const oa=Array(M+1);for(var Ja=0;Ja<oa.length;Ja++)oa[Ja]=!1;Ja=new qb.a;for(let zb=0;zb<M;zb++){for(var jb=
0;jb<A;jb++){const Eb=b[jb][zb];if(Eb&&0<Eb.width){const Sb=Math.min(zb+Eb.colSpan,M);ba[Sb]=ba[zb]+Eb.width*(Eb.Oab?h:1);oa[Sb]=!0}}if(oa[zb+1]){jb=ba[zb+1]-ba[zb];if(0>=jb)return null;Ja.add(jb)}else ba[zb+1]=ba[zb]}return en.a.C1f&&ba[M]<r?null:Ja.toArray()}VLn(b,h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}nDm(b,h,r,A,M,ba){if(!b)return null;M&&(b=this.VLn(b,ba));if(0>r||0>h||h>A.count-1)return b;0<=h-1&&r<=
A.K(h-1).length-1&&1===b.borderLeftStyle&&(M=A.K(h-1)[r])&&1!==M.Una.borderRightStyle&&(b.borderLeftStyle=M.Una.borderRightStyle,b.borderLeftColor=M.Una.borderRightColor,b.borderLeftWidth=M.Una.borderRightWidth);0<=r-1&&r<=A.K(h).length-1&&1===b.borderTopStyle&&(h=A.K(h)[r-1])&&1!==h.Una.borderBottomStyle&&(b.borderTopStyle=h.Una.borderBottomStyle,b.borderTopColor=h.Una.borderBottomColor,b.borderTopWidth=h.Una.borderBottomWidth);return b}$Tn(b){this.currentState.tfe||(b=this.S7b.ynn?b.replace(np.z4m,
" "):b.replace(np.y4m," "));b.startsWith(" ")&&(this.currentState.aca.endsWith(" ")||""===this.currentState.aca)&&(b=C.a.substring(b,1,b.length));return b}Lng(b,h){""!==b&&(this.vk.Jga(b,h),this.currentState.aca+=b)}}np.y4m=RegExp("[ \t\f\u200b\r\n]+","g");np.z4m=RegExp("[ \f\u200b\r\n]+","g");np.Ljl="\t";Object(u.a)(np,"DefaultHtmlNormalizer",Yw,[]);class Uh extends np{constructor(b,h,r){super(b,r);this.Xkh=!1;this.zEb=h}static Hjn(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",
!1)&&b?(b=Uh.ZSl.exec(b))&&0<b.length:!1}did(b){this.zEb.euc&&(y.AFrameworkApplication.Vta?this.Xkh||(b=new kh.StandardDialog,b.Ed=0,b.Qe(1,CommonUIStrings.l_DialogClose),b.Mx(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.Xkh=!0):this.zEb.mdj?this.zEb.Aje=!0:b.src&&""!==b.src?Fa.a.getOrigin(b.src)!==Fa.a.getOrigin(window.location.href)||Uh.Hjn(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?y.AFrameworkApplication.va.Ob(ub.a.Nsj,2):b.src.startsWith("webkit-fake-url")?
y.AFrameworkApplication.va.Ob(ub.a.Msj,2):(this.N_c(),this.O_c(!0),this.vk.SCa(b)):y.AFrameworkApplication.va.Ob(ub.a.Psj,2):y.AFrameworkApplication.va.Ob(ub.a.Osj,2))}}Uh.ZSl=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");Object(u.a)(Uh,"Box4HtmlNormalizer",np,[]);class Zw{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){this.GPi=b;this.BUf=h;this.kpl=r;this.qck=A;this.qem=M;this.IQo=ba;this.JQo=oa;this.I6c=Ja;this.q4m=jb;this.t4m=zb;this.Ubd=Eb}}Object(u.a)(Zw,"ExecutePasteArguments",null,
[]);class gt extends Oo{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he,fe=null){super(h,r,A,zb,Sb,Zc,de);this.pC=he;this.NRb=fe;this.M5=null;this.TTn=Yd=>{this.tOk&&this.YUe.Rqp(this.w$);Yd.Ri(this.vho);return!0};this.vho=Yd=>{if(this.INk){const Td=this.w$.getElementsByTagName("style");if(Td&&0<Td.length){v.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let wf=0;wf<Td.length;wf++)this.XRe.RCl(this.w$,Td[wf]),Td[wf]&&
(Td[wf].parentNode.removeChild(Td[wf]),wf--)}}Yd.Ri(this.dDl);return!0};this.dDl=(Yd,Td)=>{this.jdf.value.create(Td.qck).process(this.w$,Yd);(Td=$a.a.instance.Oa(23))&&Td.isFeatureEnabled(8)?Yd.Ri(this.kCl):Yd.Ri(this.nwj);return!0};this.kCl=(Yd,Td)=>{(new oE(Td.kpl)).process(this.w$,Yd);Yd.Ri(this.nwj);return!0};this.nwj=(Yd,Td)=>{var wf;y.AFrameworkApplication.nd("j6cj2207;gfehe251");if(en.a.rta){var Lf=window.performance.now();this.w$=this.NRb.$7k(this.w$);Ns.a.Eue=window.performance.now()-Lf}else if(en.a.Xoc&&
!document.getElementById("FrameContainingPastedDOM")){Lf=window.performance.now();var ii=document.createElement("iframe");ii.style.visibility="hidden";ii.style.zIndex="-100";ii.style.position="absolute";ii.style.width=window.screen.width+"px";ii.style.height=window.screen.height+"px";ii.style.contain="strict";ii.setAttribute("sandbox","allow-same-origin");ii.id="FrameContainingPastedDOM";document.body.appendChild(ii);(ii=ii.contentDocument)&&en.a.Ktn&&(ii.documentElement.style.fontSize="62.5%",ii.body.style.fontSize=
"1.6rem");Ns.a.aZd=window.performance.now()-Lf}ii=null;!en.a.rta&&en.a.Xoc&&(ii=document.getElementById("FrameContainingPastedDOM"));!en.a.rta&&en.a.Xoc&&ii instanceof HTMLIFrameElement?(Lf=window.performance.now(),ii=null===(wf=ii.contentDocument)||void 0===wf?void 0:wf.querySelector("body"),null===ii||void 0===ii?void 0:ii.appendChild(this.w$),Ns.a.Eue=window.performance.now()-Lf,wf=null===ii||void 0===ii?void 0:ii.children,1!==(null===wf||void 0===wf?void 0:wf.length)&&v.ULS.sendTraceTag(508913473,
307,15,"Found Multiple Pasted Container in iframe element"),Td.GPi.process(1===(null===wf||void 0===wf?void 0:wf.length)?wf[0]:this.w$,Yd)):Td.GPi.process(this.w$,Yd);Yd.Ri(Td.BUf&&Td.BUf.euc?this.QZb:this.$ji);return!0};this.QZb=(Yd,Td)=>{if(Td=Td.BUf){let Lf=!1,ii=!1,Bi=!1,Ml=!1;var wf=-1;const hk=new ji.DictionaryPropertySet,Tn=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(Za.a)(234,this.Ui.td)?(Lf=this.Ui.td.ka(Rc.a.ema,!1),wf=this.Ui.td.ka(Bd.a.hY,""),Bi=this.Ui.td.ka(Bd.a.ega,
!1),Ml=this.Ui.td.ka(ze.a.bCa,!1),Tn.test(wf)&&(ii=!0),wf=this.Ui.td.ka(Fe.a.Oka,-1)):this.Ui.xx&256&&this.w$&&(Lf=!0,Tn.test(this.w$.innerHTML)&&(ii=!0));hk.setValue(Rc.a.ema,Lf);hk.setValue(Bd.a.yad,ii);hk.setValue(Bd.a.ega,Bi);hk.setValue(Fe.a.Oka,wf);hk.setValue(ze.a.bCa,Ml);Td.Fxe(hk);Td.Igg();Td.Fvb&&(this.Ui.G9c=!0,this.Ui.hLa=Td.s_,this.Ui.kdg=Td.Fvb,Lf&&!Bi&&$b.c(ub.a.f6l),y.AFrameworkApplication.va.Ob(ub.a.QZb,2))}Yd.Ri(this.$ji);return!0};this.$ji=(Yd,Td)=>{var wf;Yd=window.performance.now();
if(en.a.rta)this.NRb.SBo();else if(en.a.Xoc){var Lf=document.getElementById("FrameContainingPastedDOM");Lf instanceof HTMLIFrameElement&&(Lf=null===(wf=Lf.contentDocument)||void 0===wf?void 0:wf.querySelector("body"),(null===Lf||void 0===Lf?0:Lf.firstElementChild)?(v.ULS.sendTraceTag(508858444,307,50,"iframe body first element child was not null"),null===Lf||void 0===Lf?void 0:Lf.removeChild(null===Lf||void 0===Lf?void 0:Lf.firstElementChild)):v.ULS.sendTraceTag(508858443,307,15,"iframe body first element child was null"))}Ns.a.ztg=
window.performance.now()-Yd;nn.a.aJn(Td.qck);nn.a.pGn(Td.t4m);nn.a.XHn(Td.IQo);nn.a.YHn(Td.JQo);nn.a.NGn(Td.Ubd);wf="Others";Td.I6c&&(Td.I6c.mGn(),Td.I6c.nGn(),Td.I6c.kIn(),wf=Td.I6c.zEg);nn.a.oGn(Td.q4m,wf);nn.a.YFn(Td.qem,wf);return!1};this.w$=b;this.JLe=M;this.FVe=ba;this.X$e=oa;this.jdf=Ja;this.YIc=jb;this.S7b=Dc;this.Ga=Eb;this.Plh=Object.assign(new Hy,{Xnc:2===this.Ui.Pfc||3===this.Ui.Pfc});this.XRe=nc;this.YUe=Gd;this.Fac=Eb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.INk=
Eb.$("ParseStyleFromRawHtmlHeadIsEnabled");this.tOk=Eb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get rle(){return!1}get fTb(){return!0}bmi(b){en.a.Itb?vp.a.instance.ee(()=>{this.cmi(b)},"EPEM:EP"):this.cmi(b)}cmi(b){this.M5=new zc.a;this.Zcb.restore(this.M5);v.ULS.shipAssertTag(6305550,307,Ua.a.Qh(this.M5));this.Ui.iV&&this.Ui.iV.Adc("external");var h=this.Ui.xx&8192?1:0,r=this.FVe.value.create(h,this.M5,this.Ui.YVc,this.Ui.Nxb),A=this.X$e.value.create(h,this.M5);const M=nn.a.Tui(y.AFrameworkApplication.userSessionId),
ba=nn.a.tKi(y.AFrameworkApplication.userSessionId),oa=nn.a.nKf(X.a.mLb,this.Ui.YVc),Ja=nn.a.RGi(y.AFrameworkApplication.userSessionId),jb=nn.a.SGi(y.AFrameworkApplication.userSessionId),zb=this.Fac?this.O9m():null,Eb=nn.a.Izi(X.a.mLb,this.Ui.YVc),Sb=nn.a.Jzi(y.AFrameworkApplication.userSessionId),nc=this.YIc.YSj?nn.a.dAm(y.AFrameworkApplication.userSessionId):null;h=this.JLe.value.create(h,this.M5,r,A,null,oa,this.q6k,this.Ui.GCe);h=new YI(h,Ja,jb);h=new Uh(h,r,this.S7b);h=new Jn(h,this.YIc,this.Plh,
nc,en.a.rta?this.NRb:null);A=new AG(zb);h=new pE(h,A,Eb,zb,this.Ga);h=new tu(h,this.pC,Sb);r=new Zw(h,r,M,ba,oa,Ja,jb,zb,Eb,Sb,nc);r=new ft.a(b,this.TTn,r);r.sm("paste and request pictures");r.ni=!b||b.ni;r.run()}get q6k(){return this.w$.getElementsByTagName("a").length}O9m(){const b=new Xw;b.Ttc=X.a.mLb;this.Ui&&(b.xx=this.Ui.xx,b.gqj=this.Ui.YVc,this.Ui.td&&(b.progId=this.Ui.td.ka(Bd.a.Lsj,"")));this.w$&&this.w$.innerHTML&&(b.Ksj=this.w$.innerHTML.length,Ns.a.nkg=b.Ksj);y.AFrameworkApplication.sessionStartInfoSettings&&
(b.platform=y.AFrameworkApplication.sessionStartInfoSettings.Platform,b.Cge=y.AFrameworkApplication.J.$("IsO365ConsumerHost"),b.LVi=Ed.ParagraphReader.Xja(qa.StaticActiveAppFrame.za().kb.Jc.qd));return b}get pTj(){return!0}get hpd(){v.ULS.shipAssertTag(6305551,307,!!this.M5);if(this.YIc.ZSj(this.Plh)){var b=!1;Ua.a.Qh(this.M5)&&(this.M5.O_(),b=!0);var h=Ed.ParagraphReader.Eh(this.M5)&&!this.M5.currentNode.ka(Bd.a.YXi,!1);b&&this.M5.rc();return h}return this.Ui.xx&524288?(b=!1,Ua.a.Qh(this.M5)&&(this.M5.O_(),
b=!0),h=Ed.ParagraphReader.Eh(this.M5),b&&this.M5.rc(),h):Ed.ParagraphReader.Eh(this.M5)}}Object(u.a)(gt,"ExternalPasteExecutionManager",Oo,[]);class VA{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc=null){this.Fic=Sb;this.pC=nc;this.NRb=Dc;this.JLe=b;this.FVe=h;this.X$e=r;this.jdf=A;this.YIc=M;this.pda=ba;this.Ga=oa;this.XRe=Ja;this.S7b=jb;this.Z9=zb;this.YUe=Eb}create(b,h,r,A){return new gt(b,h,r,A,this.JLe,this.FVe,this.X$e,this.jdf,this.YIc.value,this.pda,this.Ga,qa.StaticActiveAppFrame.za().kb,
this.XRe,this.S7b,this.Z9,this.YUe,this.Fic,this.pC,en.a.rta?this.NRb.value:null)}}Object(u.a)(VA,"Factory",null,[679]);class xs{constructor(b=null){var h;this.jG=b;b=window.performance.now();en.a.TVi&&(null===(h=this.jG)||void 0===h?void 0:h.execute(r=>{r.logActivity("CCPUsage","CCPFloodgateSurvey")}));this.Atf();Ns.a.aZd=window.performance.now()-b}$7k(b){if(this.Lfa.contentDocument){const h=this.Lfa.contentDocument.body;b=h.appendChild(b);1!==h.children.length&&v.ULS.sendTraceTag(508624975,307,
15,`Found Non-One Pasted Containers ${h.children.length}`);return b}v.ULS.sendTraceTag(508624974,307,15,"iframe not loaded when append method was called");return b}SBo(){if(this.Lfa.contentDocument){var b=this.Lfa.contentDocument.body;b.lastElementChild?(v.ULS.sendTraceTag(508624930,307,50,"iframe body first element child was not null"),b.removeChild(b.lastElementChild)):v.ULS.sendTraceTag(508624929,307,15,"iframe body first element child was null")}}E7l(b){var h;const r=null===(h=this.Lfa.contentDocument)||
void 0===h?void 0:h.body;return(null===r||void 0===r?0:r.contains(b))?getComputedStyle(b):b.style}Atf(){var b=document.getElementById(Ii.a.KBc);this.Lfa=document.createElement("iframe");this.Lfa.style.visibility="hidden";this.Lfa.style.zIndex="-100";this.Lfa.style.position="absolute";this.Lfa.style.contain="strict";en.a.Jtn&&(this.Lfa.style.width=window.screen.width+"px",this.Lfa.style.height=window.screen.height+"px");this.Lfa.setAttribute("sandbox","allow-same-origin");this.Lfa.id="FrameContainingPastedDOM";
b?(b.appendChild(this.Lfa),b=this.Lfa.contentDocument,en.a.n2i&&b?(b.documentElement.style.fontSize="62.5%",b.body.style.fontSize="1.6rem"):en.a.n2i&&v.ULS.sendTraceTag(508441186,307,15,"Iframe not loaded when setting root fontSize")):v.ULS.sendTraceTag(508624973,307,15,"View Panel not found")}}Object(u.a)(xs,"HiddenExternalPasteView",null,[678]);class CG{fzn(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.Pkn(b.childNodes[h-2])&&this.Uwn(b.childNodes[h-1])}Rqp(b){this.fzn(b)&&
(b.removeChild(b.lastChild),v.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}gin(b){return!!b&&8===b.nodeType}pvn(b){return!!b&&3===b.nodeType}Pkn(b){return this.gin(b)&&"EndFragment"===b.nodeValue}Uwn(b){if(!this.pvn(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(u.a)(CG,"HtmlNormalizerHelper",null,[677]);var $w=d(984),mv=d(629);class uE extends Oo{constructor(b,h,r,A,M,ba,oa,Ja,jb){super(b,h,r,M,ba,Ja,jb);this.yB=A;this.$K=oa}get Hl(){return this.$K.value}get rle(){return this.yB.rle()}get Ssj(){const b=
this.yB;return b.Jrf&&!b.WTi()}dmi(b,h){v.ULS.shipAssertTag(6305616,307,Lj.OutlineReader.zy(b));const r=mv.a(b.currentNode);if(Lj.OutlineReader.isEmpty(b)){var A=vc.a.create(b.currentNode);b.mt(8);y.AFrameworkApplication.va.Pf(A,ub.a.RJ,2,!0,null,null)}else b.mt(8);(A=b.ML(1))&&b.rc();this.yB.Asj(this.Ui.ne,b.currentNode,A,-1,r,h)}bmi(b){const h=new zc.a;this.Zcb.restore(h);v.ULS.shipAssertTag(6305618,307,Ua.a.Qh(h));this.Ui.iV&&this.Ui.iV.Adc("internal");let r=-1;if(Object(Za.a)(234,this.Ui.td))r=
this.Ui.td.ka(Fe.a.Oka,-1);else{const A=this.dqm(h.currentNode);r=A?A.clientWidth:r}this.yB.Asj(this.Ui.ne,h.parentNode,h.currentNode,r,null,b);this.x_i&&(this.Zcb.restore(h),Ua.a.Qh(h)&&this.yB.Z2i(h)&&(b=Ab.OutlineElementNavigator.Me(h)))&&(this.Ui.YJa=sc.SelectionFactory.ve(b,0))}dqm(b){return b?(b=b?b.Ce(this.Hl.sc):null)?b.htmlElement:null:null}XTj(){const b=new zc.a;this.Zcb.restore(b);return this.yB.Z2i(b)}get pTj(){return!0}get hpd(){return!this.yB.xAa&&!this.yB.Jrf}}Object(u.a)(uE,"InternalPasteExecutionManager",
Oo,[]);class vE{constructor(b,h,r,A,M){this.Fic=M;this.yB=b;this.pda=h;this.$K=r;this.Z9=A}create(b,h,r){return new uE(b,h,r,this.yB,this.pda,qa.StaticActiveAppFrame.za().kb,this.$K,this.Z9,this.Fic)}}Object(u.a)(vE,"Factory",null,[676]);var WA;(function(b){b[b.unknown=0]="unknown";b[b.G_p=1]="differentBox4App";b[b.Zlq=2]="sameBox4AppDifferentSession";b[b.$lq=3]="sameBox4AppSameSession"})(WA||(WA={}));Object(u.b)("CopySource",WA);class XA{constructor(b,h,r,A,M){this.pC=M;this.yB=b;this.mnh=h;this.Svk=
r;this.Al=A}Rbo(b,h,r){v.ULS.shipAssertTag(6305620,307,!!b);v.ULS.shipAssertTag(6305621,307,Le.a.qf(h));v.ULS.shipAssertTag(6305622,307,!!r);v.ULS.shipAssertTag(6305623,307,Object(Za.a)(aw,r.xua));const A=r.xua;A.Pfc=this.yB.qwi(b);this.BGn(b,A);let M=!1;this.Al.gma(h,Ja=>M=Ja)&&(A.xx|=8192,A.GCe=1,M||(A.GCe|=2));const ba=this.Nnn(A);var oa=new Qb.GraphTransaction(7,ub.a.paste);oa.Ab(h.node);h.node.GL().nH.eaa(8);ba?(v.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",A.xx,
A.browserName),this.pC?this.pC.yxc("isExternal",!1):this.Kaj(),b=this.mnh.create(h,A,oa)):(v.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",A.xx,A.Pfc,A.browserName),this.pC?this.pC.yxc("isExternal",!0):this.Kaj(),XA.sGn(b),b=this.Svk.create(b,h,A,oa));r=new ft.a(r,Object(F.a)(b,b.Fsj,"pasteSetup"),null);r.sm("Paste");r.run()}Nnn(b){return!this.Yqn(b)&&3===b.Pfc}Kaj(){v.ULS.sendTraceTag(508143509,307,15,"PastePerformanceE2ETracker instance is nullish")}Yqn(b){return 1===
(b.xx&8192?1:0)}cUi(b,h){v.ULS.shipAssertTag(6305624,307,Le.a.qf(b));v.ULS.shipAssertTag(6305625,307,!!h);v.ULS.shipAssertTag(6305626,307,Object(Za.a)(aw,h.xua));const r=new Qb.GraphTransaction(7,ub.a.wce);r.Ab(b.node);b=this.mnh.create(b,h.xua,r);h=new ft.a(h,Object(F.a)(b,b.Fsj,"pasteSetup"),null);h.sm("InternalPasteAtIp");h.run()}BGn(b,h){if(b){let r=!1,A=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?A=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(r=!0);(r||A)&&v.ULS.sendTraceTag(42471960,
307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",WA[h.Pfc],r,A)}}static sGn(b){b&&XA.vTk.test(b.innerText)&&v.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}XA.vTk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(u.a)(XA,"PasteCoordinator",null,[]);var yC=d(796),dw=d(1070),Ly=d(1069);class Bz{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc=null){this.Fua=
b;this.bca=h;this.fq=r;this.rvj=A;this.ta=M;this.Tcb=ba;this.J=oa;this.Vbo=Ja;this.Pga=jb;this.m$a=zb;this.Jza=Eb;this.lb=Sb;this.nma=nc;this.Pci=100;this.Gpc=!1;this.NOe=null;this.EXe=!1;this.mJd=null;this.zFd=this.IRa=!1;this.Obm=(Dc,Zc)=>{this.dismissFloatie(Zc.f9l)};this.v9o=(Dc,Zc)=>{this.WGl(Dc,Zc)};this.UN=(Dc,Zc)=>{Zc.property===ze.a.lastModifiedTime?(v.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.m$a.pvf.contains(ub.a.KMg)||this.Kpg(Zc)):v.ULS.sendTraceTag(520734532,
307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};this.RYa=(Dc,Zc)=>{this.Kpg(Zc)};this.Rma=(Dc,Zc)=>{Zc.Jde||this.Kpg(Zc)};this.ymj=()=>{yC.a.instance.keyCode===rf.a.aFa&&this.bca.oyj()};this.Hep()}Hep(){this.bca.gQh(this.v9o);this.bca.QPh(this.Obm)}WGl(b,h){var r,A,M;(null===(A=null===(r=this.lb.gb)||void 0===r?void 0:r.currentSelection)||void 0===A?0:A.q9c)?v.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):
(this.Tcb.RWf(),1===this.Vbo.mHl(h.$gd)?v.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):this.showFloatie(b,h)?(this.IRa?this.IRa=!1:this.Vyo(),this.dkd(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",ub.a.AU(h.gY)||"Unknown",h.correlationId),v.ULS.sendTraceTag(40379588,307,50,b),$b.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new fa.a,{name:"PasteCommand",int64:ub.a.AU(h.gY)||"Unknown"}),Object.assign(new fa.a,
{name:"CorrelationId",string:null===(M=h.correlationId)||void 0===M?void 0:M.toString()})]),this.D2b()):v.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}dismissFloatie(b){var h;!this.EXe&&(this.IRa||(this.nma?null===(h=this.Jza)||void 0===h?0:h.t3:this.Fua.t3()))&&(b&&(this.Tcb.RWf(),this.X5j(),v.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.mJd)),this.IRa=!b,this.IEe(),this.nma?
y.AFrameworkApplication.va.Ob(ub.a.PRb,2):this.Fua.dismissFloatie())}Vyo(){this.zFd||(this.NOe=this.fq.Ad,uf.a.addHandler(this.NOe.container,"scroll",Object(F.a)(this,this.x_b,"scrollHandler")),this.ta.o2(Object(F.a)(this,this.rna,"resizeHandler")),this.zFd=!0)}X5j(){this.zFd&&(uf.a.removeHandler(this.NOe.container,"scroll",Object(F.a)(this,this.x_b,"scrollHandler")),this.ta.gha(Object(F.a)(this,this.rna,"resizeHandler")),this.zFd=!1)}D2b(){if(this.nma)this.Jza.t3&&y.AFrameworkApplication.va.Ob(ub.a.PRb,
2),y.AFrameworkApplication.va.Ob(ub.a.Gpd,2),this.Gpc=!1;else{const b=new Ly.a(0,y.AFrameworkApplication.isRtl);b.location=this.Tcb.XVa();this.Tcb.Kln(b.location)?this.showFloatie(null,b):this.bca.tNa(new dw.a(!1))}}rna(){this.nma?(y.AFrameworkApplication.va.Ob(ub.a.PRb,2),this.GYc()):this.D2b()}x_b(){this.nma?(y.AFrameworkApplication.va.Ob(ub.a.PRb,2),this.GYc()):this.D2b()}dkd(){this.rvj.g2k(this.ymj);this.bca.VPh(Object(F.a)(this.Fua,this.Fua.f2d,"expandFloatie"));this.bca.dQh(Object(F.a)(this,
this.Isj,"pastedFloatieStatusChange"));this.Pga.wt(this.Rma);this.Pga.ly(this.RYa);this.Pga.ro(this.UN)}IEe(){this.rvj.sDo(this.ymj);this.bca.qEj(Object(F.a)(this.Fua,this.Fua.f2d,"expandFloatie"));this.bca.yEj(Object(F.a)(this,this.Isj,"pastedFloatieStatusChange"));this.Pga.vS(this.Rma);this.Pga.bva(this.RYa);this.Pga.XP(this.UN)}Isj(b,h){this.EXe=h.p9c;h.gY&&(this.mJd=h.gY);h.VCg&&this.Fua.t3()&&this.D2b()}Kpg(b){b.node.yP||this.bca.tNa(new dw.a(!0))}showFloatie(b,h){h||(h=new Ly.a(0,y.AFrameworkApplication.isRtl));
h.location||(h.location=this.Tcb.XVa());if(!h.location)return!1;this.IRa&&(this.IRa=!1,this.dkd());this.nma?y.AFrameworkApplication.va.Ob(ub.a.Gpd,2):this.Fua.showFloatie(b,h);return!0}GYc(){if(!this.Gpc){const b=new wc.a(3,1,this.Pci,()=>{this.D2b()},215);me.a.instance.Yb(b);this.Gpc=!0}}}Object(u.a)(Bz,"PasteFloatieEventManager",null,[]);class uv{constructor(b,h){this.Yk=b;this.IK=h}mHl(b){return an.any(an.where(an.asEnumerable(uv.Ghp),h=>this.IK.P$c(h)))?(b=this.Yk.Awb(b))&&(b=b.innerText)&&0<
b.trim().length?0:1:1}}uv.Ghp=[ub.a.QZa.toString(),ub.a.RZa.toString(),ub.a.BDa.toString()];Object(u.a)(uv,"PasteFloatieFeatureSetBuilder",null,[]);class ax{constructor(){this.lDa=null;this.Xtc=0}}Object(u.a)(ax,"PasteFloatieAnchorData",null,[]);class Vx{constructor(b,h,r,A,M,ba=!1){this.XGb=null;this.ib=b;this.yya=h;this.od=r;this.Dxk=A;this.T3e=M;this.dYe=ba}RWf(){this.XGb=null}XVa(){const b=this.cKf(this.XGb)||this.JZh();if(!b){let h="null",r="null";if(this.XGb&&this.XGb.lDa){if(!this.od.Ad)return v.ULS.sendTraceTag(51143187,
307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.XGb.lDa).getName();const A=this.od.Ad.Wl(this.XGb.lDa);A&&(r=Object.getType(A).getName())}v.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,r)}return b}Kln(b){if(!b)return!1;const h=this.T3e.YPb(),r=this.Dxk(this.od.Ad.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=r.y&&b.y+b.height<=r.y+r.height}JZh(){if(!this.ib||
!this.ib.gb||!this.ib.gb.currentSelection)return v.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.ib.gb.currentSelection.Qa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h){do r=this.ZEi(r);while(r&&Object(Za.a)(Pn.AParagraphNode,r)&&!r.characterData.trim().length)}let A="";const M=Object(Ma.a)(Pn.AParagraphNode,r);M&&(A=M.characterData.length===b.cpBegin||h?M.characterData.trimEnd():M.characterData.substring(0,b.cpBegin).trimEnd());h=M?
A.length:b.cpBegin;b=Object.assign(new ax,{lDa:Object(Ma.a)(221,(M?Object(Ma.a)(221,M):Object(Ma.a)(221,r))||b.node),Xtc:h});return this.cKf(b)}ZEi(b){const h=new zc.a;if(!b.anchor)return null;h.set(b);if(!h.Ld())return null;h.fd(11);return h.bK()?h.Ub(2):null}cKf(b){if(!b||!b.lDa)return null;this.XGb=b;const h=this.od.Ad;if(!h)return v.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.Kzi(b,h);if(!b)return null;y.AFrameworkApplication.isRtl&&
this.T3e.t3()&&(b.x-=this.T3e.YPb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}Kzi(b,h){h=h.Ce(b.lDa);if(!h)return null;let r=null;if(Object(Za.a)(Pn.AParagraphNode,b.lDa)){const A=Object(Ma.a)(163,h);if(!A)return null;try{r=this.yya.t2(b.Xtc,A,0<b.Xtc,!1,!1,!1),r.height+=this.dYe?Vx.$po:Vx.Rbm}catch(M){v.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",M),r=null}}else Object(Za.a)(Xt.TableNode,b.lDa)&&(r=Object(Ma.a)(253,h).POf());
r||(r=h.getBounds());return r}}Vx.Rbm=2;Vx.$po=60;Object(u.a)(Vx,"PasteFloatiePositionProvider",null,[]);class $I{constructor(b,h,r,A,M){this.FAa=b;this.rub=h;this.gco=r;this.fco=A;this.fTb=M}}Object(u.a)($I,"PastedContentsPostProcessorParams",null,[]);class YA{j$m(b,h,r,A,M,ba){b=this.Ztm(b,h,M);r=this.Rym(r);if(!b||!r)return null;A=this.CGm(b,A,M);M=this.BGm(r);return new $I(b,r,A,M,ba)}Ztm(b,h,r){b=r?b:h;if(!Ua.a.Qh(b))return null;h=new sn.a;h.kd(b);return h}Rym(b){if(!Ua.a.Qh(b))return null;const h=
new sn.a;h.kd(b);Ab.OutlineElementNavigator.N3(h,!1,!1);return h}CGm(b,h,r){Ab.OutlineElementNavigator.Me(b);let A=-1;Ed.ParagraphReader.Eh(b)&&(A=r?h:0);Ab.OutlineElementNavigator.ke(b);return A}BGm(b){Ab.OutlineElementNavigator.Me(b);const h=Ed.ParagraphReader.Eh(b)?Ed.ParagraphReader.textLength(b.currentNode):-1;Ab.OutlineElementNavigator.ke(b);return h}}Object(u.a)(YA,"PastedContentsPostProcessorHelper",null,[]);class Et{constructor(b,h){this.EGc=b;this.ork=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get mri(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get Mvf(){return CommonUIStrings.l_ClipboardCut}get b8f(){return CommonUIStrings.l_ClipboardCut_Mac}get Bsf(){return CommonUIStrings.l_ClipboardCopy}get a8f(){return CommonUIStrings.l_ClipboardCopy_Mac}get Wtc(){return CommonUIStrings.l_ClipboardPaste}get c8f(){return CommonUIStrings.l_ClipboardPaste_Mac}get b4(){return CommonUIStrings.l_ClipboardPasteText}get d8f(){return CommonUIStrings.l_ClipboardPasteText_Mac}get Bpf(){return this.ork}get B3h(){return CommonUIStrings.l_ClipboardExtensionLink}get Inb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}xmi(){v.ULS.sendTraceTag(8716421,
307,50,null);Te.a.Cn(this.Bpf,"_blank",void 0,"ClipboardAccessExtensionLink")}jha(b,h){let r=X.a.om;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(r=X.a.Di||r);return r?String.format(h,"\u2318"):b}dispose(){this.EGc=null}hqg(b){this.H8h(b)}$An(b){this.H8h(b)}H8h(b){this.EGc&&this.EGc(b)}}Et.id="CopyPasteShortcutDialog";Et.H0j="CopyPasteText";Object(u.a)(Et,"ACopyPasteShortcutDialog",null,[11]);class zC extends Et{constructor(b,h,r){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=Et.H0j;var A=document.createElement("span");A.innerText=this.mri;var M=document.createElement("span");M.className="UIFontBold";M.innerText=this.jha(this.Mvf,this.b8f);const ba=document.createElement("span");ba.className="UIFontBold";ba.innerText=this.jha(this.Bsf,this.a8f);const oa=document.createElement("span");oa.className="UIFontBold";oa.innerText=this.jha(this.Wtc,this.c8f);h.appendChild(A);h.appendChild(document.createElement("br"));
h.appendChild(M);h.appendChild(ba);h.appendChild(oa);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(X.a.Ur||X.a.yj)&&(r=document.createElement("span"),r.className="UIFontBold",r.innerText=this.jha(this.b4,this.d8f),h.appendChild(r));b.appendChild(h);this.Bpf?(v.ULS.sendTraceTag(8716420,307,50,null),r=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.B3h,uf.a.addHandler(h,"click",Object(F.a)(this,this.xmi,"extensionLinkHandler")),r.appendChild(h),M=this.Inb.indexOf("{0}"),
-1!==M&&(A=this.Inb.substring(0,M),M=this.Inb.substring(M+3,this.Inb.length),A=document.createTextNode(A),M=document.createTextNode(M),r.insertBefore(A,h),r.appendChild(M)),b.appendChild(document.createElement("br")),b.appendChild(r)):v.ULS.sendTraceTag(8716422,307,50,null);r=new kh.StandardDialog;r.Ed=0;r.Pg=Et.id;r.Mx(this.titleText,null,0,Object(F.a)(this,this.$An,"legacyCopyPasteShortcutDialogHandler"),b);r.H8(Et.H0j)}}Object(u.a)(zC,"CopyPasteShortcutDialog",Et,[]);class ZA extends Et{constructor(b,
h){super(b,h);h={};b=this.zdn;h.extensionStartText=this.T5l;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.L3o;h.cutText=this.jha(this.Mvf,this.b8f);h.copyText=this.jha(this.Bsf,this.a8f);h.pasteText=this.jha(this.Wtc,this.c8f);4!==y.AFrameworkApplication.ta.Hb.Uk&&(h.pasteTextOnly=this.jha(this.b4,this.d8f));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const r=new ug.a(!1,!1,!0);r.Pg="CopyPasteInstallDialog";r.Ed=0;r.Qe(1,this.ydn);r.xY(1);r.gi(b,Object(F.a)(this,
this.hqg,"reactCopyPasteShortcutDialogHandler"),h)}get L3o(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get ydn(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get zdn(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get T5l(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static c8o(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(u.a)(ZA,"ReactCopyPasteInstallDialog",Et,[]);class mL extends Et{constructor(b){super(b,null);this.Q6i="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.iTn;var r="";let A="";this.messageText&&(r=this.messageText.split(" {")[0],A=this.messageText.split("} ")[1]);h.startText=r;h.endText=A;h.cutText=this.jOl;h.copyText=this.uDl;h.pasteText=this.Xbo;
h.cutShortcutText=this.jha(this.kOl,this.dKn);h.copyShortcutText=this.jha(this.EDl,this.cKn);h.pasteShortcutText=this.jha(this.$bo,this.fKn);h.imageSrc=Ie.a.Mea("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.jio;this.Q6i&&(v.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.Cub,["onExecute"]:()=>{this.RAn()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
r=new ug.a(!1,!1,!0);r.Ed=0;r.Pg="CopyPasteNoClipboardAccessDialog";r.gi(b,Object(F.a)(this,this.hqg,"reactCopyPasteShortcutDialogHandler"),h)}get iTn(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get Cub(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get jio(){return CommonUIStrings.l_DialogOk}get jOl(){return CommonUIStrings.l_CutString}get kOl(){return CommonUIStrings.l_CutShortcut}get dKn(){return CommonUIStrings.l_CutShortcut_Mac}get uDl(){return CommonUIStrings.l_CopyString}get EDl(){return CommonUIStrings.l_CopyShortcut}get cKn(){return CommonUIStrings.l_CopyShortcut_Mac}get Xbo(){return CommonUIStrings.l_PasteString}get $bo(){return CommonUIStrings.l_PasteShortcut}get fKn(){return CommonUIStrings.l_PasteShortcut_Mac}RAn(){v.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Te.a.Cn(this.Q6i,"_blank",void 0,"learnMoreLink")}}Object(u.a)(mL,"ReactCopyPasteNoClipboardAccessDialog",Et,[]);class My extends Et{constructor(b,h,r){super(b,h);b={};b.forwardElementText=this.mri;b.cutText=this.jha(this.Mvf,this.b8f);b.copyText=this.jha(this.Bsf,this.a8f);b.pasteText=this.jha(this.Wtc,this.c8f);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(X.a.Ur||X.a.yj)&&(b.pasteTextOnly=this.jha(this.b4,this.d8f));this.Bpf?(v.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.B3h,["onExecute"]:A=>{this.xmi(A)}},r=this.Inb.indexOf("{0}"),-1!==r&&(b.suggestionPrefixElement=this.Inb.substring(0,r),b.suggestionSuffixElement=this.Inb.substring(r+3,this.Inb.length))):v.ULS.sendTraceTag(40726915,307,50,null);r={["id"]:Et.id,["bodyControls"]:b};b=new ug.a(!1,!1,!0);b.Ed=0;b.Pg=Et.id;b.gi(this.titleText,Object(F.a)(this,this.hqg,"reactCopyPasteShortcutDialogHandler"),r)}}Object(u.a)(My,"ReactCopyPasteShortcutDialog",
Et,[]);class vv{constructor(){this.KRa=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.sH}gtf(b,h,r=!1){v.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.KRa,r));this.KRa?r?new ZA(b,h):new My(b,h,y.AFrameworkApplication.J):new zC(b,h,y.AFrameworkApplication.J)}static get instance(){return vv._instance||(vv._instance=new vv)}}vv._instance=null;Object(u.a)(vv,"CopyPasteShortcutDialogFactory",null,[39]);class $A{constructor(b,h,r,A,M,
ba,oa,Ja){this.$Eh=this.iph=this.b$e=!1;this.$Pk=b;this.od=h;this.Sy=r;this.Zb=A;this.Ie=M;this.vg=ba;this.gf=oa;Ja&&(this.$Eh=Ja.$("ShouldLogExecCommandCopySuccess"))}get l0a(){return this.$Pk}get Eab(){return this.iph}set Eab(b){this.iph=b;this.vg.nUf=b}P_c(b){this.l0a.P_c(b);b||this.qrd(!0)}get T2l(){return this.l0a.vvg}gYb(b){this.Eab=!0;this.l0a.gYb(b,this.GHg)}reset(){this.Eab=!1}paste(){var b=null;let h=null;if(!this.l0a.z3b){(b=this.od.Ad)&&this.Zb.Eg(b.CL);var r=this.Sy.Fw;if(!r.ue||!r.Ke.uk)return null;
h=r.Ke;b=this.Ie.Ex();this.Eab=!0;r.egb()}r=null;try{h&&h.Zgo(),r=b=this.l0a.f0c(this.GHg,b)}catch(A){v.ULS.shipAssertTag(6305672,307,!1),this.dMi()}this.Eab=!1;return r}rE(){var b=this.od.Ad;b&&this.Zb.Eg(b.CL);b=this.Sy.Fw;if(!b.ue||1!==b.Ke.mode)return!1;this.Eab=!0;let h;try{const r=new Map;r.set("View","ContentEditableView");za.Health.instance.recordKpiUsage(Wn.a.$Ud,0,Wn.a.C0h,r);const A=this.l0a.dCf(this.GHg);h=!0;this.$Eh&&v.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",
A,this.gf.lE);if(!A){const M=Object.assign(new bb.a,{extendedProperties:r});za.Health.instance.recordKpiFailure(Wn.a.$Ud,Wn.a.A0h,!0,!0,M)}}catch(r){v.ULS.shipAssertTag(6305673,307,X.a.yj),v.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",X.a.lE),h=!1}this.Eab=!1;return h?!0:!1}qrd(){if(this.b$e)return!0;var b=this.Sy.Fw;if(!b.ue||!b.Ke.uk)return!1;const h=b.Ke;b=this.Ie.Ex();this.Eab=!0;const r=new nC.a(b);let A=!1;try{A=this.l0a.qrd(b,()=>{h.ZVd()},
()=>{h.TNa()})}catch(M){}r.restore();this.Eab=!1;A?this.b$e=!0:(v.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",X.a.lE),this.dMi());return A}dMi(){this.b$e=!1;if(y.AFrameworkApplication.MHp)vv.instance.gtf(null,null);else{const b=new kh.StandardDialog;b.Ed=0;b.AY(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get GHg(){const b=this.Ie.Tqb();return b?b.Ko:null}}Object(u.a)($A,"SystemClipboard",null,
[671]);class Ft{constructor(b,h,r){this.JPd=!1;this.hQd=this.wW=this.jsh=this.fNe=this.Xxd=null;this.xfo=A=>{1===A?(v.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.VMe)),this.Wbc&&(v.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.Wbc)),Te.a.Cn(this.MTe+this.Y1e,"_blank",void 0,"ChromeCCPInstallDialog"))):A||v.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.VMe))};this.VMe=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");
this.MTe=b.jb("ChromeClipboardAccessExtensionLink");this.uib=h;this.Yk=r;this.Y1e=b.jb("ChromeClipboardAccessExtensionId");this.GSk=b.$("UseGetClipboardDataIsEnabled");this.sBh=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.Wbc=!1;b.$("CcpInstallDialogIsEnabled")&&y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.sH&&(this.Wbc=ZA.c8o()||b.$("IgnoreDomainCheckCcpInstallDialog"),v.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.Wbc));this.AHc=null}P_c(b){b?this.wW=!0:(this.wW=
null,chrome.runtime&&chrome.runtime.sendMessage?(this.AHc=this.uib.wZd,this.uib.E0b?(this.JPd=this.GSk,this.C1h()):(this.JPd=!0,this.C1h(),v.ULS.sendTraceTag(19256732,307,50,P.a.create().toString()))):(this.X0b(),this.wW=!1))}get vvg(){return this.wW}get z3b(){return this.hQd}qrd(){return!0}dCf(b){v.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=Te.a.AOb(b,"copy"))||v.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,
2)));return b}ZHf(b){if(!b)return null;var h=b.img;const r=b.text;b=b.html;const A=this.Yk.gLj(!!h,!!r,b);let M=null;if(3===A){if(!b)return null;h=this.Yk.Hmi(b);(h=this.Yk.Omi(h))&&(b+=h);M=this.Yk.Awb(b)}else 2===A?M=this.Yk.akg(r,!0):1===A&&(M=this.Yk.Awb(h));return M}f0c(b,h){if(this.z3b)h=this.ZHf(this.fNe),this.fNe=null;else{if(!this.Xxd)return h;b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.Xxd;h=b.body;this.Xxd=null}return h}gYb(b){const h=P.a.create();this.jsh=
h;this.uib.E0b?v.ULS.sendTraceTag(7377737,307,50,h.toString()):v.ULS.sendTraceTag(19256735,307,50,h.toString());const r={};r.command=this.z3b?"getClipboardData":"paste";chrome.runtime.sendMessage(this.AHc,r,A=>{h.equals(this.jsh)?this.z3b?this.fNe=A:this.Xxd=A:v.ULS.sendTraceTag(7385868,307,50,null);v.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.LZl(),this.uib.E0b?v.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):v.ULS.sendTraceTag(19256737,307,10,
chrome.runtime.lastError.message));b()})}X0b(){v.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.Wbc?b=this.MTe+this.Y1e:this.VMe&&(b=this.MTe+this.AHc);vv.instance.gtf(this.xfo,b,this.Wbc)}LZl(){this.uib.bIo();this.X0b()}uMj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}ypl(){const b=P.a.create();this.uib.E0b?v.ULS.sendTraceTag(592491466,307,50,b.toString()):v.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.AHc,{command:"getAvailableCommands"},
h=>{v.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(Za.a)(Array,h)?(v.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.hQd=-1!==Array.indexOf(h,"getClipboardData")):(v.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.hQd=!1):(v.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.hQd=!1)})}C1h(){const b=P.a.create();this.uib.E0b?v.ULS.sendTraceTag(7726105,
307,50,b.toString()):v.ULS.sendTraceTag(591984032,307,50,b.toString());this.JPd&&this.ypl();this.uMj(this.AHc,h=>{v.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.wW=!0:(h?"ping"!==h&&v.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):v.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),
this.X0b(),this.wW=!1);this.JPd&&!this.z3b&&v.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}W$i(b,h){const r={};r.OfficeOnlineExtensionInstallationStatus=b;r.OfficeClipboardExtensionInstallationStatus=h;v.ULS.sendTraceTag(51144839,307,50,JSON.stringify(r));this.sBh&&(b&&za.Health.instance.recordKpiSuccess(Ft.Jwh,null),h&&za.Health.instance.recordKpiSuccess(Ft.Gwh,null))}EFn(){this.sBh&&(za.Health.instance.recordKpiUsage(Ft.Jwh,1,Ft.fhh,null),za.Health.instance.recordKpiUsage(Ft.Gwh,
1,Ft.fhh,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.uib.E0b;this.uMj(this.Y1e,h=>{this.W$i(b,!!h)})}else this.W$i(!1,!1)}}Ft.Jwh="OfficeOnlineExtensionInstallationStatus";Ft.Gwh="OfficeClipboardExtensionInstallationStatus";Ft.fhh="wwccp";Object(u.a)(Ft,"ChromeSystemClipboardAccessManager",null,[709]);class aB{constructor(b,h){this.wW=null;this.gf=b;this.Ga=h;this.Npk=!this.Ga.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Ga.$("BlockCopyCutOnFirefoxIsEnabled");this.yNk=
h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}P_c(b){this.Npk&&b&&this.gf.yj?(this.X0b(),this.wW=!1):this.wW=!0}get vvg(){return this.wW}get z3b(){return!1}dCf(b){return Te.a.AOb(b,"copy")}f0c(b,h){Te.a.AOb(b,"paste");return h}gYb(b){b()}qrd(b,h,r){if(this.gf.I7)return this.yNk&&(this.wW=!1),!1;h();r();b=this.f0c(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=hb.a.create().toString();r();b=this.f0c(b.ownerDocument,b);return this.wW=b=h===b.innerHTML}X0b(){vv.instance.gtf(null,null)}}
Object(u.a)(aB,"DefaultSystemClipboardAccessManager",null,[709]);class wE{constructor(b,h,r){this.wW=this.Dda=this.j$b=this.Vpa=this.h4a=this.Txd=null;this.Yk=h;this.r4a=r;this.mFk=b.fc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.eOk=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}P_c(b){this.eOk&&b&&(this.wW=!0)}get vvg(){return this.wW}get z3b(){return!1}dCf(b){return b?Te.a.AOb(b,zd.a.rE):!1}f0c(b,h){this.h4a&&(h=this.h4a,this.h4a=
null);return h}gYb(b,h=null){if(b&&h){this.Txd=b;this.j$b=h;$addHandler(this.j$b,zd.a.paste,Object(F.a)(this,this.Tmj,"onPasteEvent"));this.Dda=this.Vpa=null;if(this.O4j(this.j$b)){if(this.Dda&&0<this.Dda.length&&(!this.Vpa||this.Yk.LFe(this.Vpa))){this.r4a.X7h(this.Dda,Object(F.a)(this,this.z0n,"onImageConverted"));this.h4a&&!this.h4a.hasChildNodes()&&v.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.Vpa&&this.Vpa.innerHTML&&((this.h4a=this.HPi(this.Vpa.innerHTML))&&
!this.h4a.hasChildNodes()&&v.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),xd.a.yF(this.Vpa))}this.$oi()}else b&&b()}qrd(b){return this.wW=b=this.O4j(b.ownerDocument)}Tmj(b){try{b&&b.rawEvent&&((this.Vpa=b.rawEvent.target)&&this.Vpa.id&&-1<this.Vpa.id.indexOf("Paste")?(v.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.Vpa.id),this.Vpa=null):this.Dda=this.Swm(b.rawEvent))}catch(h){v.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+
h.toString())}}z0n(b){b&&(this.r4a.wTj&&(b=String.format('<img src="{0}">',b)),this.h4a=this.HPi(b));this.$oi()}$oi(){this.j$b&&($removeHandler(this.j$b,zd.a.paste,Object(F.a)(this,this.Tmj,"onPasteEvent")),this.j$b=null);this.Txd&&(this.Txd(),this.Txd=null)}Swm(b){let h=null;(b=this.Yk.jvi(b))&&({rUf:h}=this.Yk.q4j(b,this.mFk,this.r4a.gdj));return h}O4j(b){return Te.a.AOb(b,zd.a.paste)}HPi(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}X0b(){}}Object(u.a)(wE,
"EdgeSystemClipboardAccessManager",null,[709]);class mo{constructor(b,h,r,A){this.Ga=b;this.crk=h;this.Yk=r;this.gf=A}create(){let b=null;y.AFrameworkApplication.YCg()&&this.gf.Ur&&window.chrome?(v.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new Ft(this.Ga,this.crk,this.Yk),this.Ga.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.EFn()):this.Ga.$("EdgeContextMenuPasteFixIsEnabled")&&this.gf.hu?(v.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),
b=new wE(this.Ga,$a.a.instance.resolve(173),$a.a.instance.resolve(257),$a.a.instance.resolve(887))):(v.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new aB(this.gf,this.Ga));return b}}Object(u.a)(mo,"SystemClipboardAccessManagerFactory",null,[672]);var Wx=d(774),Ah;(function(b){b[b.automatic=1]="automatic";b[b.clear=2]="clear";b[b.ofb=3]="themeColors";b[b.qpq=4]="standardColors";b[b.VP=5]="recentColors";b[b.U$p=6]="moreColors";b[b.DWa=7]="highContrastColors"})(Ah||(Ah={}));
Object(u.b)("ColorMenuControls",Ah);var tz=d(1030);class Ps{constructor(b){this.OLc=null;this.gyd={};this.PSb=()=>{this.OLc=null};this.AO=b;this.$7e=""}get sca(){return this.$7e}set sca(b){b=b||"";this.$7e!==b&&(this.$7e=b,this.PSb())}mqb(b,h){if(this.OLc)return this.OLc;if(!b)return null;const r=Object.assign(new Xe.a,{Id:String.format("menu{0}Color",this.AO),ExternalId:String.format("{0}Color",this.AO)});r.MenuSectionList=[];Object(tz.a)()&&r.MenuSectionList.push(this.NXk());r.MenuSectionList.push(this.FVk());
r.MenuSectionList.push(this.gWk());r.MenuSectionList.push(this.a0k(b,h));r.MenuSectionList.push(this.H_k());return this.OLc=r}SG(b,h){Ah[b]in this.gyd||(this.gyd[Ah[b]]=h)}b6a(b,h){b.yef(this.PSb,h)}NXk(){if(!({actionId:h}=this.zsd(7)).returnValue)return null;const b=Object.assign(new xh.a,{Id:String.format("{0}Color",this.AO),ControlsId:String.format("{0}.Color.Menu.Controls",this.AO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new Pj.a,{Command:h.toString(),LabelText:C.a.If(Box4Intl.Box4Strings.L_HighContrastColorPicker),
Image16by16:y.AFrameworkApplication.Vs,Image16by16Class:ag.getImageClass("Automatic_16x16x32"),Id:String.format("HighContrast{0}ColorPicker",this.AO),ExternalId:String.format("HighContrast{0}ColorPicker",this.AO),KeyTip:CommonUIStrings.l_HighContrastColorPickerKeytip,QueryCommand:ub.a.Mid.toString()});b.ControlList.push(h);return b}FVk(){if(!({actionId:h}=this.zsd(1)).returnValue)return null;const b=Object.assign(new xh.a,{Id:String.format("{0}Color",this.AO),ControlsId:String.format("{0}.Color.Menu.Controls",
this.AO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new Pj.a,{Command:h.toString(),LabelText:C.a.If(Box4Intl.Box4Strings.L_Automatic),Image16by16:y.AFrameworkApplication.Vs,Image16by16Class:ag.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});b.ControlList.push(h);return b}gWk(){if(!({actionId:h}=this.zsd(2)).returnValue)return null;const b=Object.assign(new xh.a,{Id:String.format("{0}Color",this.AO),ControlsId:String.format("{0}.Color.Menu.Controls",
this.AO),DisplayMode:"Menu16",ControlList:[]});var h=Object.assign(new Pj.a,{Command:h.toString(),LabelText:C.a.If(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:y.AFrameworkApplication.Vs,Image16by16Class:ag.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});b.ControlList.push(h);return b}a0k(b,h){if(!({actionId:A}=this.zsd(3)).returnValue)return null;const r=Object.assign(new xh.a,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this.AO),
ControlList:[]});var A=Object.assign(new Wx.a,{Id:String.format("Theme{0}ColorPicker",this.AO),ExternalId:String.format("Theme{0}ColorPicker",this.AO),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.AO),McuLayout:!0,Command:A.toString(),Width:10});const {bwl:M,Wlp:ba}=Ps.FPm(b,h);A.Colors=M;this.fQj(A,ba);r.ControlList.push(A);return r}H_k(){if(!({actionId:h}=this.zsd(4)).returnValue)return null;const b=Object.assign(new xh.a,{Id:String.format("{0}Colors",this.AO),ControlsId:String.format("{0}.Color.Menu.Controls",
this.AO),Title:C.a.If(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var h=Object.assign(new Wx.a,{Id:String.format("Standard{0}ColorPicker",this.AO),ExternalId:String.format("Standard{0}ColorPicker",this.AO),Command:h.toString(),Width:10,Colors:[]});h.Colors=Ps.UMm();this.fQj(h);b.ControlList.push(h);return b}fQj(b,h){if(b){var r="";"object"===typeof this.sca?void 0!==h&&(r=this.pLm(h,this.sca)):r=this.ZKm(b.Colors,this.sca);b.Stateful=!0;b.SelectedColorId=""!==r?r:"NoColor"}}pLm(b,
h){var r,A;let M="";for(const ba of b)if(ba.PCe===h.Auc&&ba.Ixc===(null===(r=h.HIa)||void 0===r?void 0:r.Ixc)&&ba.sfb===(null===(A=h.HIa)||void 0===A?void 0:A.sfb)){M=ba.cwl;break}return M}ZKm(b,h){let r="";if(!b)return r;for(let A=0;A<b.length;A++)if(b[A].DisplayColor.toLowerCase()===h.toLowerCase()){r=b[A].Color;break}return r}zsd(b){b=Ah[b];return b in this.gyd?{returnValue:!0,actionId:this.gyd[b]}:{returnValue:!1,actionId:0}}static UMm(){const b=[];b.push(Object.assign(new kn,{Color:"0000C0",
Alt:C.a.If(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));b.push(Object.assign(new kn,{Color:"0000FF",Alt:C.a.If(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));b.push(Object.assign(new kn,{Color:"00C0FF",Alt:C.a.If(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));b.push(Object.assign(new kn,{Color:"00FFFF",Alt:C.a.If(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));b.push(Object.assign(new kn,{Color:"50D092",Alt:C.a.If(Box4Intl.Box4Strings.L_FontColorLightGreen),
DisplayColor:"#92D050"}));b.push(Object.assign(new kn,{Color:"50B000",Alt:C.a.If(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));b.push(Object.assign(new kn,{Color:"F0B000",Alt:C.a.If(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));b.push(Object.assign(new kn,{Color:"C07000",Alt:C.a.If(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));b.push(Object.assign(new kn,{Color:"602000",Alt:C.a.If(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));
b.push(Object.assign(new kn,{Color:"A03070",Alt:C.a.If(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return b}static FPm(b,h){const r=b.properties.ka(Rc.a.ofb,null);b=b.properties.getValue(Rc.a.SCe).split(" ");const A=[],M=[];for(let jb=0;6>jb;jb++)for(let zb=0;10>zb;zb++){var ba=10*jb+zb,oa=r[ba];oa=oa&4278190080|(oa&255)<<16|oa&65280|(oa&16711680)>>>16;ba=C.a.QJ(ba+1<<24,8);var Ja=h[b[zb]];const Eb=this.zsi(jb,zb,r[zb]);Eb.cwl=ba;M.push(Eb);Ja=Ps.eop(Ja,Eb);A.push(Object.assign(new kn,
{Color:ba,DisplayColor:"#"+C.a.QJ(oa,6),Alt:C.a.If(Ja)}))}return{bwl:A,Wlp:M}}static eop(b,h){if(void 0===h.Ixc&&void 0===h.sfb)return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,b,h.GIg);const r=void 0!==h.sfb;return String.format(r?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,b,h.GIg,r?h.sfb:h.Ixc)}static zsi(b,h,r){if(b){var A=r&255,M=(r&65280)>>>8;r=(r&16711680)>>>16;M=Math.floor((Math.min(Math.min(A,M),r)+Math.max(Math.max(A,M),
r))/2);A=b-1;M?255===M?(b=!1,A=[242,217,191,166,128][A]):204<M?(b=!1,A=[230,191,128,64,26][A]):51>M?(b=!0,A=[26,64,128,191,230][A]):(M=[51,102,153],r=[191,128],A=(b=A<M.length)?M[A]:r[A-M.length]):(b=!0,A=[128,166,191,217,242][A]);A=255-A;h={PCe:Ps.OCe[h].name,GIg:Ps.OCe[h].label};b?h.sfb=Math.round(100*A/255):h.Ixc=Math.round(100*A/255);return h}return{PCe:Ps.OCe[h].name,GIg:Ps.OCe[h].label}}static $rp(b,h){if((h=h.properties.ka(Rc.a.ofb,null))&&0<=b&&b<h.length){const r=b%10;return Ps.zsi(Math.floor(b/
10),r,h[r])}}}Ps.OCe={0:{name:"background1",label:Box4Intl.Box4Strings.l_ThemeLabel1},1:{name:"text1",label:Box4Intl.Box4Strings.l_ThemeLabel2},2:{name:"background2",label:Box4Intl.Box4Strings.l_ThemeLabel3},3:{name:"text2",label:Box4Intl.Box4Strings.l_ThemeLabel4},4:{name:"accent1",label:Box4Intl.Box4Strings.l_ThemeLabel5},5:{name:"accent2",label:Box4Intl.Box4Strings.l_ThemeLabel6},6:{name:"accent3",label:Box4Intl.Box4Strings.l_ThemeLabel7},7:{name:"accent4",label:Box4Intl.Box4Strings.l_ThemeLabel8},
8:{name:"accent5",label:Box4Intl.Box4Strings.l_ThemeLabel9},9:{name:"accent6",label:Box4Intl.Box4Strings.l_ThemeLabel10}};Object(u.a)(Ps,"ColorMenu",null,[610]);class bx{u4l(b){return b}}Object(u.a)(bx,"DeleteTableSegmentStrategy",null,[670]);var wy=d(451),Dq=d(1019);class Xx{get ir(){return rv.a.DQb}get sl(){return null!=this.M2g?this.M2g:this.M2g=$a.a.instance.resolve(349)}get Z3(){return this.sl.ir}get Bc(){return Wg.a.instance}get oC(){return null!=this.X2g?this.X2g:this.X2g=$a.a.instance.resolve(34)}FTc(b,
h,r,A,M,ba,oa){let Ja=2;if(!b.ue)return 2;const jb=b.lb;if(!jb)return this.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.Aga}),8;if(y.AFrameworkApplication.J.$("Box4PartialPromoteDemoteIsEnabled")){b=this.B_h(h===ub.a.XI,r,!0);if(1===A)return b?32:8;b&&(Ja=Dq.a.buc(h,r,A,M,ba,oa))}else Ja=Dq.a.buc(h,r,1,M,ba,oa),1!==A&&32===Ja?(b.lb.Pne(),b=new Qb.GraphTransaction(15),b.Ab(r.view.qd),Ja=this.B_h(h===ub.a.XI,r,!1)?Dq.a.buc(h,r,A,M,ba,oa):8,b.dispose()):1!==A&&8===Ja&&(b.lb.Pne(),this.Nyl(h,r,jb));return Ja}B_h(b,
h,r){h=h.view.lb;if(!h||!h.gb.currentSelection)return this.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.qWb}),!1;if(h.gb.WL)return this.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.Irf}),!1;h=wy.OutlineElementGeneralizer.gla(h.gb,!1);if(!h)return this.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.s2d}),!1;let A=!1;for(let M=0;M<h.length;M++){const ba=h.getContext(M),oa=new zc.a;oa.set(ba.node);Le.a.yv(oa);if(!Ua.a.Qh(oa))if(r)continue;else return this.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.UNb}),!1;if(b?!this.ir.GLb(oa):!this.ir.Bec(oa))if(r)continue;
else return this.Bc.$b(Uf.a.khc,{["Reason"]:Ff.a.Snf}),!1;A=!0}return r?A:!0}Nyl(b,h,r){const A=new Qb.GraphTransaction(15);try{A.Ab(h.view.qd);h=!0;const M=wy.OutlineElementGeneralizer.gla(r.gb,!1);for(let ba=0;ba<M.length;ba++){const oa=M.getContext(ba),Ja=new zc.a;Ja.set(oa.node);Le.a.yv(Ja);if(!Ua.a.Qh(Ja))h=!1;else if(b===ub.a.XI?this.ir.GLb(Ja):this.ir.Bec(Ja))switch(h=!1,b){case ub.a.XI:this.ir.CZa(Ja,-1,0);break;case ub.a.mR:this.ir.bZc(Ja,1)}}if(h){const ba=r.gb.currentSelection;for(r=0;r<
ba.length;r++){const oa=ba.K(r);if(oa.Cl){const Ja=this.oC.Zqb(oa.node),jb=Ja.Gha;if(b===ub.a.XI?Ja.$A>jb:Ja.$A<18*jb){const zb=new zc.a;zb.set(oa.node);this.Z3.iEa(zb,1,b===ub.a.XI?Ja.$A>=2.5*jb?Ja.$A-2*jb:jb:Ja.$A<16*jb?Ja.$A+2*jb:18*jb)}}}}}finally{A&&A.dispose()}}}Object(u.a)(Xx,"IndentationActorExtension",null,[669]);var Ny=d(749),AC=d(1171);class DG{constructor(b,h){this.So=new ji.DictionaryPropertySet;this.aKd=new ji.DictionaryPropertySet;this.UEb=!1;this.YGa=this.yhb=null;this.X9=b;this.Hih=
h}get Vzb(){return null!=this.w5g?this.w5g:this.w5g=$a.a.instance.Oa(35)}get xj(){return null!=this.CXg?this.CXg:this.CXg=$a.a.instance.resolve(101)}get Xb(){return null!=this.A7g?this.A7g:this.A7g=$a.a.instance.resolve(8)}Cxb(){this.UEb||(0<this.dXa.oL()&&(this.aKd=this.So.clone()),this.So.Ute(),this.yhb=null,this.kBo())}DDl(b){var h;const r=null!==(h=xa.FormattingReader.Us(b))&&void 0!==h?h:xa.FormattingReader.A6d(b.node,b.cpBegin,-1);!r.cache.DE&&(b=r.uo)&&(h=new ji.DictionaryPropertySet,h.At(b),
h.At(this.So),h.hasProperty(Yf.a.Jw)&&(this.yhb=r.paragraph.Ic),this.So=h)}hasProperty(b){return this.So.hasProperty(b)}h6c(){return 0<this.So.oL()}get dXa(){return this.So}freeze(){this.UEb=!0}MOa(){this.UEb=!1}yI(b,h){return this.dXa.ka(b,h)}uC(b){this.So.setValue(ze.a.fontSize,this.xj.yfc(b));this.r4();zn.a.Hqg(this.aKd,this.So)}fontSize(){return this.So.ka(ze.a.fontSize,zn.a.lR)}uxe(b){this.So.setValue(ze.a.font,b);this.Hih&&this.Hih.execute(h=>{null==h?v.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):
h.uxe(this.So)});this.X9&&this.X9.enabled&&(Tc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.X9.xWo(this.So,b));this.r4();zn.a.Hqg(this.aKd,this.So)}XAg(b){this.So.setValue(Rc.a.Se,b);this.X9&&this.X9.enabled&&(Tc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.X9.a1o(this.So,b));this.r4()}gx(b){b=Pk.a.instance.mka($f.a.instance.gb.currentSelection.Qa.node,b);this.So.setValue(ze.a.fontColor,b);this.r4();zn.a.Hqg(this.aKd,this.So)}kka(){this.So.setValue(ze.a.fontColor,
Yl.a.auto);this.r4()}fontColor(){return this.So.ka(ze.a.fontColor,Yl.a.nil)}gEa(b){this.So.setValue(ze.a.highlight,parseInt(b,16));this.r4()}SVd(){this.So.setValue(ze.a.highlight,Yl.a.auto);this.r4()}isBold(){return this.So.ka(ze.a.bold,!1)}YN(b){this.So.setValue(ze.a.bold,b);this.r4()}isItalic(){return this.So.ka(ze.a.italic,!1)}lA(b){this.So.setValue(ze.a.italic,b);this.r4()}isUnderline(){return this.So.ka(ze.a.underline,!1)}M8(b){this.So.setValue(ze.a.underline,b);this.So.setValue(ze.a.underlineType,
b?zn.a.tAb:zn.a.KV);this.r4()}underlineType(){return this.So.ka(ze.a.underlineType,zn.a.KV)}Aha(b){b<zn.a.tAb||b>zn.a.KV||(this.So.setValue(ze.a.underline,b!==zn.a.KV),this.So.setValue(ze.a.underlineType,b),this.r4())}isSuperscript(){return this.So.ka(ze.a.superscript,!1)}Bva(b){this.So.setValue(ze.a.superscript,b);b&&this.isSuperscript()&&this.So.setValue(ze.a.subscript,!1);this.r4()}isSubscript(){return this.So.ka(ze.a.subscript,!1)}gOa(b){this.So.setValue(ze.a.subscript,b);b&&this.isSubscript()&&
this.So.setValue(ze.a.superscript,!1);this.r4()}isStrikethrough(){return this.So.ka(ze.a.strikethrough,!1)}Gna(b){this.So.setValue(ze.a.strikethrough,b);this.r4()}isDoubleStrikethrough(){return this.So.ka(Yf.a.Eu,!1)}pxe(b){this.So.setValue(Yf.a.Eu,b);this.r4()}Sui(){return this.So.ka(Yf.a.Jw,null)}Aeb(b,h){this.So.Ute();this.So.setValue(Yf.a.Jw,b.id);this.yhb=h.Ic;this.r4()}J8(b){let h=ze.a.iK;const r=Ny.a.yhe(b);switch(r){case 1:h=Rc.a.kqc;break;case 2:h=Rc.a.lqc}this.So.setValue(Rc.a.kbb,r);this.So.setValue(h,
b);this.r4()}language(){let b=ze.a.iK;switch(this.So.ka(Rc.a.kbb,0)){case 1:b=Rc.a.kqc;break;case 2:b=Rc.a.lqc}return this.So.ka(b,0)}NYo(b){this.So.setValue(Rc.a.noProof,b);this.r4()}BTb(){return this.So.ka(Rc.a.noProof,!1)}Gpn(){return this.So.hasProperty(Rc.a.noProof)}hon(){return this.So.hasProperty(ze.a.iK)||this.So.hasProperty(Rc.a.kqc)||this.So.hasProperty(Rc.a.lqc)}r4(){if(X.a.hzc){Object(Jb.a)();var b=$f.a.instance.gb.currentSelection.Qa,h=b.node;if(h===this.YGa)this.YGa.fm(16,!0);else{this.YGa=
h;h=this.YGa.S0();try{this.YGa.A_(b.cpBegin).YBa=!0}finally{h&&h.dispose()}}}}kBo(){if(X.a.hzc&&this.YGa){var b=0,h=this.YGa.S0();try{for(let r=this.YGa.ra.length-1;0<=r;r--){const A=this.YGa.ra.K(r);A.YBa&&(A.YBa=!1,b++,A.isEmpty&&this.YGa.ra.removeAt(r))}}finally{h&&h.dispose()}this.YGa=null}}CBl(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.ra.Ch(b.cpBegin);return!!b&&b.YBa}Lif(b){if(this.Vzb){this.freeze();var h=new Qb.GraphTransaction(7);h.Ab(b.node);this.Vzb.wxe(b);this.MOa();this.Cxb();h.dispose()}}ZNf(b){const h=
Ed.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!C.a.Xw(h.charCodeAt(b.cpBegin))&&AC.a.instance.y9a(h,b.cpBegin-1)!==b.cpBegin&&Le.a.Ttb(b)?(b=Le.a.c7(b,!1))?1<b.length||Le.a.gm(b.Qa)?b:null:null:null}}Object(u.a)(DG,"InsertionPointFormatting",null,[668]);class Gs extends ug.a{constructor(b,h){super(!1,!1,!0);this.iwl=(r,A)=>{1===r?(r=A.selectedColorText,6!==r.length?v.ULS.sendTraceTag(595345436,340,10,"Color picker dialog did not return the color in expected format RRGGBB. Color returned: {0}, Menu: {1}",
r,this.AO):(r=r.substring(4,6)+r.substring(2,4)+r.substring(0,2),y.AFrameworkApplication.va.Pb(this.vNe,2,r),v.ULS.sendTraceTag(595345435,340,50,"Color selected from color picker dialog. Menu: {0}",this.AO))):v.ULS.sendTraceTag(595345434,340,50,"Color picker dialog closed without selecting any color. Menu: {0}",this.AO)};this.AO=b;this.vNe=h}Wyb(b=0){const h={};h.initColor=Yl.a.QB(b);h.redLabel=Box4Intl.Box4Strings.L_FontColorRed;h.blueLabel=Box4Intl.Box4Strings.L_FontColorBlue;h.greenLabel=Box4Intl.Box4Strings.L_FontColorGreen;
h.hexLabel=Box4Intl.Box4Strings.L_FontColorHex;this.gi(Box4Intl.Box4Strings.L_MenuCustomColors,this.iwl,{["id"]:"ColorPickerDialog",["bodyControls"]:h});v.ULS.sendTraceTag(595345437,340,50,"Color picker dialog is opened. Menu: {0}",this.AO)}}Object(u.a)(Gs,"ColorPickerDialog",ug.a,[]);class Ru{constructor(b,h,r,A,M,ba){this.tNn=b;this.zua=h;this.Zva=r;this.fp=A;this.VP=M;this.Vig=ba;this.q0i=!1;this.ggd=(oa,Ja,jb)=>{if(1===jb)return 32;oa=this.Vh.ka(ze.a.pS,Yl.a.qB);(new Gs(Ru.Mnb,ub.a.xxc)).Wyb(oa);
return 32};this.uuc=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;oa=this.Vh.ka(ze.a.pS,Yl.a.qB);oa=Yl.a.QB(oa);this.Vfa(this.Vig);this.Vig.sca=oa;this.VP.iBc(oa);oa=this.Vig.mqb(this.Vh,df.a.nUa);if(!oa)return 8;Eb.MenuItems=oa;v.ULS.sendTraceTag(509109712,340,50,"Page color dropdown menu is opened.");return 32};this.Sif=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;Ja=this.fp.Lc(15);Ja.Ab(this.Vh);switch(oa){case ub.a.YVd:this.Vh.hasProperty(ze.a.pS)&&this.Vh.setValue(ze.a.pS,Yl.a.qB);break;case ub.a.E_a:Eb=
this.Zva.mka(this.Vh,Eb);this.Vh.setValue(ze.a.pS,Eb);break;case ub.a.xxc:oa=this.Zva.mka(this.Vh,Eb),this.Vh.setValue(ze.a.pS,oa),this.VP.zTa(Eb)}Ja.dispose();return 32}}Vfa(b){this.q0i||(b.SG(2,ub.a.YVd),b.SG(3,ub.a.E_a),b.SG(4,ub.a.E_a),b.SG(5,ub.a.xxc),b.SG(6,ub.a.ggd),b.b6a(this.tNn,1),this.q0i=!0)}Wb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.ggd,mc.a.view,this.ggd);b.qa(ub.a.uuc,mc.a.view,this.uuc);b.qa(ub.a.E_a,mc.a.view,this.Sif);b.qa(ub.a.YVd,mc.a.view,this.Sif);b.qa(ub.a.xxc,mc.a.view,
this.Sif);b.Pc(ub.a.uuc,1127)}get Vh(){return this.zua.value}}Ru.Mnb="Page";Object(u.a)(Ru,"PageColorActor",null,[]);var Cz=d(544),tq=d(468);class bB extends xj.a{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){super();this.B$b=this.an=this.xQa=null;this.hjo=(Sb,nc)=>{nc=this.Wxa.are(this.xQa,nc);Sb.Ri(this.Xem);return nc};this.Xem=(Sb,nc)=>{if(this.an.moveNext())return Sb=this.an.currentNode,12!==Sb.type||Sb===this.xQa.node?!0:this.Wxa.eid(Sb,nc);this.Ail();Sb.Ri(this.bfm);return!0};this.bfm=(Sb,nc)=>{if(this.an.moveNext()){const Dc=
this.an.currentNode;return 12!==Dc.type?!0:Dc===this.xQa.node?(Sb.Ri(this.ijo),!0):this.Wxa.eid(Dc,nc)}return!1};this.ijo=(Sb,nc)=>{this.Wxa.bre(this.xQa,nc);return!1};this.init(b);this.sm(Eb);this.Asb(Ja,h,A,M,ba);this.mO=ba;this._context=r;this.ib=jb;this.Pe=zb;this.Wxa=oa;this.uA=0}run(){this.Cof();this.uA||this.T2o();1===this.uA&&this.sko();2===this.uA&&this.Ikp();3===this.uA&&this.uam()}Cof(){this.ib.gb&&this.ib.gb.currentSelection?1===this.behavior&&(this.Wxa.Cof(this._context)?this.us=32:this.us=
2,this.uA=3):(v.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.us=2,this.uA=3)}T2o(){this.dil();this.Wxa.zBg(this.xQa)?(this.xhl(),this.uA=1):(this.us=8,this.uA=3)}sko(){this.aD||new ft.a(this,this.hjo,this.mO);do if(this.aD.run(),this.aD.Pfa&&!this.ni)return;while(this.aD.Pfa);this.OVd();this.uA=2}Ikp(){this.Wxa.SHg(this)?this.us=32:this.us=8;this.uA=3}uam(){this.zva()}dil(){let b=this.ib.gb.currentSelection;if(b=this.Pe.yk(b,!0,!1))this.xQa=b.Qa;this.xQa&&this.xQa.node&&(this.B$b=
this.Wxa.oFi(this.xQa.node))}xhl(){if(!this.B$b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new sn.a;b.set(this.xQa.node);b.vb(this.B$b.type);this.an=Uv.a.Bt(b,this.B$b);this.an.Dp(Object(F.a)(this.Wxa,this.Wxa.Cyc,"spellErrorFilter"),null)}Ail(){if(!this.B$b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new sn.a;b.set(this.B$b);this.an=Uv.a.rq(b);this.an.Dp(Object(F.a)(this.Wxa,this.Wxa.Cyc,"spellErrorFilter"),null)}}Object(u.a)(bB,"ProofingWholeDocumentOperation",
xj.a,[]);var cB=d(274);class nL extends ip{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(u.a)(nL,"ContextMenuRootProperties",ip,[]);var xE=d(2010);class yE{constructor(b){const h=new nL;h.ImageSideArrow=y.AFrameworkApplication.Vs;h.ImageSideArrowClass=ag.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=ub.a.yqe.toString();this.RHh=new xE.ContextMenuRoot("ContextMenuRootName",h);b.execute(r=>
{this.f9.EH=r});this.f9.refresh();y.AFrameworkApplication.va.qa(La.a.showContextMenu,xe.a.frame,kd.ActionManager.$f);y.AFrameworkApplication.va.qa(La.a.eyc,xe.a.frame,kd.ActionManager.$f)}get f9(){return this.RHh}dispose(){this.f9&&(this.f9.dispose(),this.RHh=null)}showContextMenu(b,h){this.V0b(b,h.clientPoint,h.yg)}Geb(b,h,r){Te.a.Fje(this.f9.S5a?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu","");qa.StaticActiveAppFrame.za().Rdm();this.uv();this.f9.Geb(b,h,r);this.f9.S5a?y.AFrameworkApplication.va.Ob(La.a.eyc,
2):y.AFrameworkApplication.va.Ob(La.a.showContextMenu,2)}V0b(b,h,r){this.Geb(b,new Sys.UI.Bounds(h.x,h.y,0,0),r)}uv(){this.f9.root.An()}T6(){return this.f9.T6()}eyc(b,h,r,A){const M=this.f9;let ba=!1;r=Object(Ma.a)(Dy,r);M.S5a=r;A.pEa(b,h);M.hef?r&&(r.Efo(M,h),ba=!0):(v.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",A.KNl()),M.S5a=null);return ba}}Object(u.a)(yE,"AContextMenuController",null,[665,11]);class BC{constructor(){this.Priority=0;this.Context=null;
this.Length=this.StartInContext=this.Start=0;this.Metadata=BC.E0l;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}BC.E0l=[];Object(u.a)(BC,"Critique",null,[]);class aJ{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(u.a)(aJ,
"Suggestion",null,[]);var bJ=d(604);class cJ extends Sys.EventArgs{constructor(b,h,r,A,M,ba){super();this.Fyk=b;this.IAk=h;this.JAk=r;this.BJe=A;this.rB=M;this.Igb=ba}}Object(u.a)(cJ,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var oL=d(371);class Su{constructor(b,h,r){this.ERe=b;this.eo=h;this.sa=r}Y7h(b){const [h,r,A]=this.$Ji(b);return this.Lxi(h,r,A)}$in(b){return Tb.a.getTypeNameFor(b.content)===oL.a.getTypeName()}Lxi(b,h,r){if(r&&this.$in(r)){if(this.odc(r.content))return null;const M=
r.content;var A=new BC;A.ExplanationTitle=M.explanationTitle;A.Suggestions=this.NNm(r);A.CategoryTitle=M.categoryName;A.TypeId=M.typeId;A.CritiqueActions=M.critiqueActions;A.Priority=M.priority;r=this.ERe.create(A);A=M.context;r.token=A.substring(M.range.start,M.range.start+M.range.length);r.lcid=Ag.a.Hg(M.language).LCID;r.originalText=A;return new bJ.a(b,h,r)}return null}NNm(b){var h=b.content.suggestions;b=[];for(const r of h)h=new aJ,h.Action=r.suggestionActions,h.Text=r.text,h.Description=r.description,
b.push(h);return b}odc(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}$Ji(b){const h=this.eo.K3c(b,0),r=b.cpBegin,A=b.cpEnd,M=Le.a.qf(b);b=Ed.ParagraphReader.text(b.node,0);for(const ba of h)if(M){if(ba.Dc<=r&&ba.end>=A)return[ba.Dc,ba.end,ba.intent]}else if(ba.Dc<=r&&ba.end>=r&&C.a.V6h(b,ba.end,A))return[ba.Dc,ba.end,ba.intent];return[null,null,null]}static xD(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}ORf(b,h,r){const [A,M,ba]=this.$Ji(b);ba&&this.sa.raiseEvent(Su.rVh,new cJ(b,A,M,h,ba,r))}C1k(b){this.sa.addHandler(Su.rVh,b)}L7l(b,h,r){b=this.eo.vkc(b,0,0,b.characterData.length);for(let A=0;A<b.count;A++){const M=b.K(A);if(M.intent){const ba=M.intent;if(ba.content&&(0==ba.content.priority||1==ba.content.priority)&&M.Dc>=h&&(!r||r(M.intent)))return this.Lxi(M.Dc,M.end,M.intent)}}return null}}Su.rVh="augloopProofingContextMenuActionEventKey";Object(u.a)(Su,"AugLoopProofingErrorDetailHelper",
null,[]);class ew{}ew.Iuc="faProofing";ew.Lii="EditorMenuSection";Object(u.a)(ew,"ContextMenuControlId",null,[]);class Dz{constructor(b){this.Pe=b}Cof(b){b=Object(Ma.a)(Yt.a,b);return!!b&&!!b.view&&b.view.ue}zBg(){return!0}are(){return!0}eid(){return!0}bre(){}SHg(){return!0}Cyc(b){if(b.Sr)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}oFi(b){if(!b||!this.Pe)return b;const h=new sn.a;h.set(b);if(this.Pe.yv(h)){for(;!h.Sr;)h.rc();return h.currentNode}return b}}Object(u.a)(Dz,"SimpleProofingWholeDocumentCallBacks",
null,[624]);class EG{constructor(b){this.value=b}}Object(u.a)(EG,"RefBool",null,[]);class zE{constructor(){this.Y_c=this.oWb=null;this.B5j=new EG(!1)}}Object(u.a)(zE,"FindNextErrorOperationParam",null,[]);class Ez extends Dz{constructor(b,h,r,A){super(h);this.qo=b;this.YPc=r;this.kpk=A}are(b,h){return!this.e6f(b.node,b.cpBegin,h)}eid(b,h){return!this.e6f(b,0,h)}bre(b,h){this.e6f(b.node,0,h);Object(Ma.a)(zE,h)}e6f(b,h,r){r=Object(Ma.a)(zE,r);if(Ed.ParagraphReader.Vb(b)&&!b.RL)if(xa.FormattingReader.Us(vc.a.Tc(b,
h)).cache.BTb)r.B5j.value=!0;else{if(Su.xD())return h=this.kpk.L7l(b,h,this.YPc),null!=h?(r.oWb=h,r.Y_c=b,!0):!1;const A=this.qo.p7(b);for(let M=0;M<A.length;M++){const ba=A[M];if(ba.Dc>=h&&!ba.errorDetails.Aab()&&(!this.YPc||this.YPc(ba.errorDetails)))return r.oWb=ba,r.Y_c=b,!0}return!1}}}Object(u.a)(Ez,"FindNextErrorCallbackSteps",Dz,[]);class Zt{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd){this.Dvl=(de,he,fe,Yd,Td)=>{he=this.ib.gb.currentSelection;if(!he)return this.yd.$b(Uf.a.Oe,{["Reason"]:Ff.a.Wn}),
2;he=this.Pe.yk(he,!0,!1);return this.ga.Pf(he.Qa,de,fe,!1,Yd,Td)};this.Z7n=(de,he,fe)=>{if(1===fe)return this.ga.Ob(ub.a.J8,1);this.JDk().GDg();return 32};this.vJa=(de,he,fe)=>{if(1===fe)return 32;db.a.mark(4670);fe=this.qo.Bsa(he);if(this.aEe(fe))return 8;he=he.node;const Yd=this.Qc.Lc(15);let Td=fe.Dc;" "===Ed.ParagraphReader.text(he).charAt(Td-1)&&Td--;Yd.Ab(he);const wf=this.Qd.Ue(vc.a.createTextRange(he,0<fe.Dc?fe.Dc-1:0,fe.end),"",!0,!1);this.ib.Kc(sc.SelectionFactory.ve(he,wf+Td));Yd.dispose();
fe.errorDetails.iAb(de);db.a.mark(4671);return 32};this.BBa=(de,he,fe)=>{if(1===fe)return 32;v.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(Su.xD())return this.Ygb.ORf(he,null,tq.b.IgnoreOnce),32;db.a.mark(4670);fe=this.qo.Bsa(he);if(this.aEe(fe))return 8;he=he.node;const Yd=this.Qc.Lc(15);Yd.Ab(he);this.qo.oxb(he,[fe],!0);he.setValue(ze.a.Frf,!0);Yd.dispose();fe.errorDetails.iAb(de);db.a.mark(4671);v.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");
this.OHn(fe);this.w4a.dQi(fe,he,!0);return 32};this.SDl=(de,he,fe)=>{var Yd,Td=!this.Al.qba(he);this.ao&&this.ao.instance&&this.ao.instance.KX(he)&&(Td=!1);if(1===fe||!Td)return Td?32:8;this.ga.Ob(ub.a.Vva,2);db.a.mark(4670);Td=this.Yom(de);if(0>Td)return 8;if(Su.xD())return this.Ygb.ORf(he,Td,tq.b.Apply),32;fe=this.qo.Bsa(he);if(this.aEe(fe))return 8;he=he.node;var wf=fe.errorDetails.suggestions;if(!wf)return this.yd.$b(Uf.a.FOb,{["Reason"]:"NoSuggestionsFound"}),db.a.mark(4671),8;Td=Td<wf.length?
wf[Td]:null;if(!Td)return this.yd.$b(Uf.a.FOb,{["Reason"]:"RequestedSuggestionIsNull"}),db.a.mark(4671),8;(null===(Yd=Jf.a.vd())||void 0===Yd?0:Yd.wn)&&Jf.a.vd().Fk.NG(he);Td=Td.replace("  "," \u00a0");Yd=this.Qc.Lc(15);Yd.Ab(he);wf=this.Qd.Ue(vc.a.createTextRange(he,fe.Dc,fe.end),Td,!0,!1,ub.a.Vva);this.ib.Kc(sc.SelectionFactory.ve(he,fe.Dc+Td.length+wf));Yd.dispose();fe.errorDetails.iAb(de);db.a.mark(4671);this.mEn(fe);return 32};this.TQo=(de,he)=>{he=this.qo.Bsa(he);if(this.aEe(he))return 8;he.errorDetails.iAb(de);
return 32};this.x$l=(de,he,fe,Yd,Td)=>{if(!he.view.ue)return 2;const wf=he.view;if(!this.ib.gb.currentSelection)return this.yd.$b(Uf.a.Oe,{["Reason"]:Ff.a.Wn}),2;if(1===fe)return 32;const Lf=new zE,ii=new Ez(this.qo,this.Pe,this.YPc,this.Ygb);he=new bB(null,de,he,fe,Yd,Lf,ii,this.ga,this.ib,this.Pe,null);he.ni=!0;he.run();if(he.isCompleted&&Lf.oWb){if(he=sc.SelectionFactory.ve(Lf.Y_c,Lf.oWb.Dc),he=sc.SelectionFactory.Yy(he,vc.a.Tc(Lf.Y_c,Lf.oWb.end)),!this.MAh.instance||!this.MAh.instance.Eho(Lf.oWb,
he,wf)){this.ib.Kc(he);let Bi=0;Td&&(Bi=Td.fz);wf.ize=!1;me.a.instance.Yb(new wc.a(1,1,1,()=>{this.TOo(wf,Bi,Lf.Y_c,Lf.oWb)}))}}else{const Bi=new kh.StandardDialog;Bi.Ed=0;df.a.lQ.aad?Bi.Nna(CommonUIStrings.l_DefaultDialogTitle,Lf.B5j.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(Bi.Nna(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),df.a.lQ.pRd(()=>{Bi.qma&&(Bi.hide(),this.ga.Ob(de,
2))}))}return 32};this.yqe=(de,he,fe)=>{if(1===fe)return 32;this.Cia&&this.Cia.f9&&(de=this.Cia.f9.PPf(ew.Iuc))&&!de.NN&&(de.B3(0),de.Ig.oN(0));return 32};this.ga=h;this.qo=b;this.JDk=r;this.Qd=A;this.Qc=M;this.ib=ba;this.ao=oa;this.Pe=Ja;this.cNk=jb;this.Al=zb;this.yd=Eb;this.Ygb=Gd;this.Cia=Object(Ma.a)(yE,Sb);this.w8b=nc.C$c;this.MAh=Dc;this.w4a=Zc;this.jDc=new Map;this.jDc.set(1,ub.a.UEg);this.jDc.set(2,ub.a.tQf);this.jDc.set(3,ub.a.ZFg);this.HOc=new Map;this.HOc.set(1,ub.a.VEg);this.HOc.set(2,
ub.a.uQf);this.HOc.set(3,ub.a.$Fg)}Wb(){const b=this.ga,h=this.SDl,r=this.Dvl;b.fb(ub.a.Foe,mc.a.view,this.Z7n,1028);b.qa(ub.a.vJa,mc.a.Vc,this.vJa);b.qa(ub.a.BBa,mc.a.Vc,this.BBa);b.qa(ub.a.Pzb,mc.a.Vc,h);b.qa(ub.a.Qzb,mc.a.Vc,h);b.qa(ub.a.Rzb,mc.a.Vc,h);b.qa(ub.a.J1b,mc.a.Vc,h);b.qa(ub.a.K1b,mc.a.Vc,h);b.qa(ub.a.vJa,mc.a.view,r);b.qa(ub.a.BBa,mc.a.view,r);b.qa(ub.a.Pzb,mc.a.view,r);b.qa(ub.a.Qzb,mc.a.view,r);b.qa(ub.a.Rzb,mc.a.view,r);b.qa(ub.a.J1b,mc.a.view,r);b.qa(ub.a.K1b,mc.a.view,r);b.Pc(ub.a.vJa,
1028);b.Pc(ub.a.BBa,1028);b.Pc(ub.a.Pzb,1028);b.Pc(ub.a.Qzb,1028);b.Pc(ub.a.Rzb,1028);b.Pc(ub.a.J1b,1028);b.Pc(ub.a.K1b,1028);b.qa(ub.a.Vva,xe.a.frame,kd.ActionManager.$f);this.w8b&&b.fb(ub.a.yqe,mc.a.view,this.yqe,1124);b.fb(ub.a.hed,mc.a.view,this.x$l,1028);b.fb(ub.a.Xng,mc.a.Fd,this.TQo,1124);this.hxo([ub.a.FAe,ub.a.UEg,ub.a.VEg,ub.a.g$d,ub.a.tQf,ub.a.uQf,ub.a.lBe,ub.a.ZFg,ub.a.$Fg,ub.a.Twj,ub.a.RRn,ub.a.kXj])}hxo(b){for(let h=0;h<b.length;h++)this.ga.fb(b[h],mc.a.view,kd.ActionManager.nU,1028)}wyo(b){this.YPc=
b}aEe(b){return b?b.errorDetails?!1:(v.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.yd.$b(Uf.a.FOb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),db.a.mark(4671),!0):(v.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.yd.$b(Uf.a.FOb,{["Reason"]:"RequestedErrorRangeNotFound"}),db.a.mark(4671),!0)}OHn(b){b=b.errorDetails.proofingType;if(this.HOc.has(b)){const h=this.HOc.get(b);this.ga.Ob(h,2);v.ULS.sendTraceTag(527799886,
375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}Yom(b){switch(b){case ub.a.Pzb:return 0;case ub.a.Qzb:return 1;case ub.a.Rzb:return 2;case ub.a.J1b:return 3;case ub.a.K1b:return 4;default:return-1}}mEn(b){b=b.errorDetails.proofingType;if(this.jDc.has(b)){const h=this.jDc.get(b);this.ga.Ob(h,2);v.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}TOo(b,h,r,A){b.n4();(b=r.Ce(b.sc))?(A=cB.a.Cr(b,y.AFrameworkApplication.isRtl?A.Dc:
A.end),this.cNk.pEa(new Sys.UI.Point(A.x,A.y+A.height),h)):v.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(u.a)(Zt,"ProofingActor",null,[]);var dB=d(315),Lq=d(1490),dJ=d(1880);class CC{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){this.Yyc=null;this.Ybm="StyleUsageActivity";this.Zbm="StylesFloodgateSurveyIsEnabled";this.OTa=(Sb,nc,Dc,Zc)=>{Sb=this.qNm(Sb);return 0>Sb||Sb>this.Yyc.length?2:(Sb=this.Yyc[Sb])?y.AFrameworkApplication.va.Pf(nc,ub.a.PT,Dc,!0,Zc,Sb):2};this.YXb=
(Sb,nc,Dc,Zc,Gd)=>{Sb=!0;nc.contextId!==mc.a.paragraph&&nc.contextId!==mc.a.Fd&&nc.contextId!==mc.a.Vc&&(Sb=!1);if(1===Dc||!Sb)return Sb?32:8;if(2===Dc&&!Gd)return 8;nc=this.Xb.MF(nc.node);Gd.MenuItems=dB.a.IBm(nc);return 32};this.xno=(Sb,nc,Dc,Zc,Gd)=>{Sb=!0;nc.contextId!==mc.a.paragraph&&(Sb=!1);if(1===Dc&&!Sb)return 8;nc=nc.node;Dc=this.Xb.Hq(nc);if(!Dc||!Gd)return v.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Gd,nc,Dc),8;zi.a.Jg.xn?Gd.Ova.Yi().At(Dc.Yi()):
Gd.Ova.At(Dc.Yi());return 32};this.k$k=(Sb,nc,Dc,Zc,Gd)=>{if(nc.contextId!==mc.a.paragraph)return 8;if(this.sg.Kab(nc,!1))return this.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.$G}),8;if(1===Dc)return 32;const de=nc.node;if(Ed.ParagraphReader.Hza(de)||!Gd)return 8;const he=this.wOf(Gd,de);if(!he)return this.Bc.$b(Uf.a.Q4,{["Reason"]:Ff.a.GOb}),8;if(2!==this.Xb.NF(he))return 2;Dc=new Qb.GraphTransaction(15);this.iD.oyc(Gd);Dc.Ab(de);this.tk.Cxb();const fe=[];Sb!=ub.a.oE&&fe.push(le.a.fgb);this.Mha.gQ(he,de,!1,
void 0,void 0,void 0,new dJ.a(fe,!1,!0));(Sb=this.Xb.MF(de))&&this.Xb.me(he,Sb)&&Tc.b(593078098,3017,50,"Custom linked style applied by user");de.Jq&&(Sb=[Object.assign(new fa.a,{name:"Source",string:"ApplyStyle"})],$b.a("TOCFormatting",!0,void 0,Sb));Dc.dispose();Gd=C.a.XT(Gd);Zc.Ft=Gd>>>16^Gd&65535;Zc&&Lq.a.Tzb&&(Zc.tE|=Lq.a.Nqb(nc.node));return 32};this.yno=(Sb,nc,Dc,Zc,Gd)=>{Sb=!0;nc.contextId!==mc.a.Fd&&(Sb=!1);if(1===Dc&&!Sb)return 2;nc=xa.FormattingReader.Us(nc);nc=xa.FormattingReader.kBa(nc);
if(!nc)return 2;if(!Gd)return 8;zi.a.Jg.xn?Gd.Ova.Yi().At(nc.Yi()):Gd.Ova.At(nc.Yi());return 32};this.l$k=(Sb,nc,Dc,Zc,Gd)=>{if(nc.contextId!==mc.a.Fd)return 8;this.sg.Kab(nc);if(1===Dc)return 32;Sb=nc;(nc=this.Ip.q8d(Sb))&&(Sb=nc);nc=Sb.node;if(!Gd)return 8;const de=this.wOf(Gd,Sb.node);if(!de)return this.Bc.$b(Uf.a.Q4,{["Reason"]:Ff.a.GOb}),8;if(1!==this.Xb.NF(de))return 2;Dc=this.Xb.MF(nc);if(!Dc)return this.Bc.$b(Uf.a.Q4,{["Reason"]:Ff.a.Vmi}),8;if(!Dc.mh(this.Xb.Be(de)))return this.Bc.$b(Uf.a.Q4,
{["Reason"]:Ff.a.GOb}),8;const he=new Qb.GraphTransaction(7);try{if(this.iD.oyc(Gd),he.Ab(nc),this.Mha.ZMg(nc,Dc),this.OD.LW(Sb,fe=>{this.xj.lra(fe);this.xj.Aeb(fe,de)}),nc.Jq){const fe=[Object.assign(new fa.a,{name:"Source",string:"ApplyStyle"})];$b.a("TOCFormatting",!0,void 0,fe)}}finally{he&&he.dispose()}Dc&&this.Xb.me(de,Dc)&&Tc.b(593078097,3017,50,"Custom linked style applied by user");Gd=C.a.XT(Gd);Zc.Ft=Gd>>>16^Gd&65535;Zc&&Lq.a.Tzb&&(Zc.tE|=Lq.a.Nqb(Sb.node));return 32};this.wno=(Sb,nc,Dc,
Zc,Gd)=>{Sb=!0;nc.contextId!==mc.a.Vc&&(Sb=!1);if(1===Dc&&!Sb)return 2;nc=this.Mha.wNm(nc);if(!nc)return 2;if(!Gd)return 8;zi.a.Jg.xn?Gd.Ova.Yi().At(nc.Yi()):Gd.Ova.At(nc.Yi());return 32};this.j$k=(Sb,nc,Dc,Zc,Gd)=>{if(nc.contextId!==mc.a.Vc)return 8;if(this.sg.Kab(nc,!1))return this.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.$G}),8;if(1===Dc)return 32;var de=nc.node;if(!Gd)return 8;Dc=this.wOf(Gd,nc.node);if(!Dc)return this.Bc.$b(Uf.a.Q4,{["Reason"]:Ff.a.GOb}),8;const he=this.Xb.NF(Dc);if(1!==he&&2!==he)return 2;
(nc=this.tk.ZNf(nc))?(nc=$f.a.RMb(nc),Sb=y.AFrameworkApplication.va.Pf(nc,Sb,2,!1,Zc,Gd)):(Sb=new Qb.GraphTransaction(7),this.iD.oyc(Gd),Sb.Ab(de),this.Mha.A0o(Dc,de),Sb.dispose(),Sb=32);de.Jq&&(nc=[Object.assign(new fa.a,{name:"Source",string:"ApplyStyle"})],$b.a("TOCFormatting",!0,void 0,nc));(de=this.Xb.MF(de))&&this.Xb.me(Dc,de)&&Tc.b(593078096,3017,50,"Custom linked style applied by user");Gd=C.a.XT(Gd);Zc.Ft=Gd>>>16^Gd&65535;return Sb};this.zno=(Sb,nc,Dc,Zc,Gd)=>{const de=this.fud.Iua(Sb,nc,
Dc,Zc,Gd,null,0);return 2!==de?de:this.fud.Iua(Sb,nc,Dc,Zc,Gd,null,12)};this.m$k=(Sb,nc,Dc,Zc,Gd)=>{const de={};de[this.fud.CPa]=6168;de[this.fud.BPa]=6169;let he=12;if(!nc.view.ue)return 2;var fe=nc.view.lb,Yd=fe?fe.Ng:null;if(!Yd)return this.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.Wn}),8;if(this.Nw.VIa(je.a.bab,Yd))return this.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.MWc}),8;if(this.Nw.bFa(Ed.ParagraphReader.IX,Yd))return this.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.cR}),8;if(this.sg.Wnc(Yd,!1))return this.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.$G}),
8;Yd=this.Xb.xo();if(Gd&&Yd){const Td=Yd.mh(Gd);if(Td){const wf=this.Xb.$qb(Td,Yd);let Lf=this.Xb.NF(Td);wf&&(fe=fe.gb.K(0),fe.Lw&&fe.Qa.contextId===mc.a.Fd||2===fe.length&&fe.Qa.contextId===mc.a.Fd&&fe.Wc.contextId===mc.a.Yc)&&(Lf=1,Gd=wf.getValue(Yf.a.la));1===Lf?he=0:3===Lf&&(he=14);!this.Xb.me(Td,Yd)&&this.Xb.Gd(Td)&&(fe=this.Xb.Be(Td),Tc.b(562317522,3017,50,String.format("{0}: style applied by user",fe)));this.cia(this.Ybm,this.Zbm)}}return this.fud.Iua(Sb,nc,Dc,Zc,Gd,de,he)};this.hw=h;this.Je=
r;this.AQ=A;this.wB=M;this.Al=ba;this.yd=oa;this.OZ=Ja;this.jTk=jb;this.xe=zb;this.Ip=Eb}get Mha(){return this.hw}get Nw(){return this.AQ}get tk(){return this.wB}get xj(){return this.Je}get sg(){return this.Al}get Bc(){return this.yd}get OD(){return this.OZ}get fud(){return this.jTk}get Xb(){return this.xe}Wb(){const b=y.AFrameworkApplication.va,h=df.a.r0a.R9h(12);b.qa(ub.a.PT,mc.a.Fd,this.l$k);b.qa(ub.a.qNa,mc.a.Fd,this.yno);b.qa(ub.a.PT,mc.a.Vc,this.j$k);b.qa(ub.a.qNa,mc.a.Vc,this.wno);b.qa(ub.a.PT,
mc.a.paragraph,this.k$k);b.qa(ub.a.PT,mc.a.view,this.m$k);b.Pc(ub.a.PT,1036);b.qa(ub.a.qNa,mc.a.view,this.zno);b.qa(ub.a.qNa,mc.a.paragraph,this.xno);b.Pc(ub.a.qNa,99);b.qa(ub.a.YXb,mc.a.view,h);b.qa(ub.a.YXb,mc.a.paragraph,this.YXb);b.Pc(ub.a.YXb,1127);b.fb(ub.a.Wif,mc.a.view,this.OTa,4);b.fb(ub.a.Xif,mc.a.view,this.OTa,4);b.fb(ub.a.Yif,mc.a.view,this.OTa,4);b.fb(ub.a.Zif,mc.a.view,this.OTa,4);b.fb(ub.a.$if,mc.a.view,this.OTa,4);b.fb(ub.a.ajf,mc.a.view,this.OTa,4);b.fb(ub.a.bjf,mc.a.view,this.OTa,
4);b.fb(ub.a.HTh,mc.a.view,this.OTa,4);b.fb(ub.a.ITh,mc.a.view,this.OTa,4);b.fb(ub.a.JTh,mc.a.view,this.OTa,4);this.Yyc=Array(10);this.Xb.y0o(this.Yyc)}qNm(b){switch(b){case ub.a.Wif:return 0;case ub.a.Xif:return 1;case ub.a.Yif:return 2;case ub.a.Zif:return 3;case ub.a.$if:return 4;case ub.a.ajf:return 5;case ub.a.bjf:return 6;case ub.a.HTh:return 7;case ub.a.ITh:return 8;case ub.a.JTh:return 9;default:return-1}}cia(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>
{const r=$a.a.instance.Ra(2);r&&r.execute(A=>{A.logActivity(b,h)})},CC.eAa)}wOf(b,h){if(b&&h&&Ed.ParagraphReader.Vb(h))h=this.Xb.MF(h);else return null;return h.mh(b)}get iD(){return null!=this.mXg?this.mXg:this.mXg=$a.a.instance.resolve(29)}}CC.eAa=5E3;Object(u.a)(CC,"StyleActor",null,[]);var Or=d(131);class FG{constructor(b,h,r){this.wSk=b;this.xe=h;this.v5a=r}Wb(){this.v5a.fb(ub.a.Aqe,mc.a.application,this.Aqe.bind(this),96);this.v5a.qa(ub.a.lBc,mc.a.view,this.CCp.bind(this));this.v5a.fb(ub.a.Wxj,
mc.a.view,this.ECp.bind(this),96)}Aqe(b,h,r,A,M){if(1===r)return 32;b=Object.assign(new Xe.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];r=Object.assign(new xh.a,{ControlList:[]});r.ControlList.push(Object.assign(new Pj.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));h.push(r);Array.addRange(b.MenuSectionList,h);M.MenuItems=b;return 32}ECp(b,h,r,A,M){if(1===r)return 32;b=zi.a.tZj();null==b&&8;b=this.xe.LL(b);M[al.a.LabelText]=String.format(C.a.If(Box4Intl.Box4Strings.l_UpdateStyleCommand),
b);return 32}CCp(b,h,r){b=zi.a.$Tb(h);if(1===r||b)return b?8:32;r=new Map;r.set("Source","StyleContextMenuActor");r.set("Action","UpdateStyle");za.Health.instance.recordKpiUsage(Or.a.gFa,0,Or.a.$B,r);this.wSk.$Mg(h)?Tc.b(539842578,3018,50,"User Successfully Updated styles from UI"):(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new bb.a,{extendedProperties:h}),za.Health.instance.recordKpiFailure(Or.a.gFa,"UpdateStyleFailed",!1,!0,h),Tc.b(539842780,
3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(u.a)(FG,"StyleContextMenuActor",null,[]);var GG=d(2014);class HG{constructor(b){this.ga=b}get Qb(){return this.ga}wxe(b,h=!1){this.Qb.Pf(b,ub.a.dXa,2,!0,null,h)}J8(b){this.Qb.Pb(ub.a.J8,2,b)}}Object(u.a)(HG,"TextFormattingCommands",null,[613]);class Mq{constructor(b,h,r,A){this.lbf=this.CIh=!1;this.Jop=(M,ba,oa)=>{if(2!==oa)return 2;this.CIh||(this.CIh=!0);return 32};this.xjo=(M,ba,oa,Ja,jb)=>{if(2!==
oa)return 2;this.owj(jb,!0);return 32};this.wjo=(M,ba,oa,Ja,jb)=>{if(2!==oa)return 2;this.owj(jb,!1);return 32};this.tko=(M,ba,oa)=>{if(2!==oa)return 2;if(!this.Qib)return 8;this.Qib.A1m();return 32};this.pjo=(M,ba,oa)=>{if(2!==oa)return 2;if(!this.Qib)return 8;this.Qib.KJo();return 32};this.uua=(M,ba)=>{3===ba.fz&&Le.a.Fm(ba.Tm.currentSelection)&&($b.c(ub.a.Eop),this.lbf=!0)};this.ga=b;this.Ga=h;this.Qib=r;this.ib=A}get Iop(){return this.lbf}Wb(){var b;this.ga.fb(La.a.KS,mc.a.view,this.Jop,4);this.ga&&
this.Ga&&(this.Ga.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.fb(ub.a.JJg,mc.a.view,this.xjo,4),this.ga.fb(ub.a.LJg,mc.a.view,this.wjo,4)),this.ga.fb(La.a.lYj,mc.a.application,this.tko,4),this.ga.fb(La.a.NAf,mc.a.application,this.pjo,4),uc.EventHandlerManager.instance.Dxo(()=>{this.r6n()}));(null===(b=qa.StaticActiveAppFrame.za().kb.Jc)||void 0===b?0:b.ue)&&qa.StaticActiveAppFrame.za().kb.Jc.r6(()=>{this.aPo()});this.ib&&this.ib.BA(this.uua)}Fpo(){$b.c(ub.a.Hop);this.lbf=!0}aPo(){const b=window.performance.now();
Mq.k_e&&250>b-Mq.k_e&&1E3<b-Mq.wsh&&($b.c(ub.a.Gop),Mq.wsh=b);this.Qib&&Mq.qc&&Mq.qc.zE(107)&&this.Qib.showFloatie()}Afn(b,h){if(h){var r=null;X.a.tM&&b&&(r=b.getSelection());b=null;r&&"Caret"===r.type&&(b=r.getRangeAt(0))&&this.Qib&&this.Qib.mzp(b.getBoundingClientRect(),h)}}r6n(){Mq.k_e=window.performance.now()}owj(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(Mq.Y5m)){for(b=b.firstChild;b;)this.w4k(b,h),b=b.nextSibling;break}b=b.nextSibling}}w4k(b,h){if(b.classList.contains(Mq.nQi)){const r=
"WACImageResizeHandleTouch"+this.Gvm(b);h?b.classList.add(Mq.oQi,r):b.classList.remove(Mq.oQi,r)}}Gvm(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==Mq.nQi)return C.a.substring(h,20,h.length);return""}static get qc(){return null!=Mq.iWg?Mq.iWg:Mq.iWg=$a.a.instance.Oa(23)}}Mq.nQi="WACImageResizeHandles";Mq.oQi="WACImageResizeHandlesTouch";Mq.Y5m="WACImgSelection";Mq.k_e=0;Mq.wsh=0;Object(u.a)(Mq,"TouchInputActor",null,[612]);class Fz{get CPa(){return Dq.a.CPa}get BPa(){return Dq.a.BPa}get HBc(){return Dq.a.HBc}Iua(b,
h,r,A,M,ba,oa){return Dq.a.Iua(b,h,r,A,M,ba,oa)}buc(b,h,r,A,M,ba){return Dq.a.buc(b,h,r,A,M,ba)}static get instance(){Fz._instance||(Fz._instance=new Fz);return Fz._instance}}Fz._instance=null;Object(u.a)(Fz,"ViewActionHandlerProxy",null,[611]);class Jh{constructor(b,h,r){this.Ydo=r;this.kpiName="VisiMarkersUsage";this.Kaa="wwaengidc";this.nub=new Map;this.Hap=(A,M,ba,oa,Ja)=>{var jb;if(1===ba)return 32;if(!Ja)return 2;this.nub.set("Source",Rp.a[this.ga.p3]);this.Pcf.Gad?this.nub.set("Action","Removed"):
this.nub.set("Action","Applied");za.Health.instance.recordKpiUsage(this.kpiName,1,this.Kaa,this.nub);A=document.getElementsByTagName("head")[0];if(!this.Pcf.Snp(A))return v.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;y.AFrameworkApplication.nd("PlaceholderTextBugFix;PlaceholderTextBugFixCf");(null===(jb=y.AFrameworkApplication.J)||void 0===jb?0:jb.getBooleanFeatureGate("Microsoft.Office.WordOnline.PlaceholderTextBugFixIsEnabled",!1))&&this.Ydo.YBo();qa.StaticActiveAppFrame.za().lJ({ShowVisiMarkers:"ToggleButtonModel"});
return 32};this.Pmo=(A,M,ba,oa,Ja)=>{if(1===ba)return 32;Ja[Ng.a.On]=this.Pcf.Gad;return 32};this.ga=b;this.Pcf=h}Wb(){this.ga.fb(ub.a.bAe,mc.a.application,this.Hap,1);this.ga.fb(ub.a.Oxj,mc.a.application,this.Pmo,96)}}Object(u.a)(Jh,"VisiMarkersActor",null,[]);class DC{uc(b){b.ia("Box4.Actors.Box4PasteStewardFactory",()=>new Ms(rv.a.DQb,b.resolve(31),b.resolve(10),b.resolve(888))).as(905).ha();b.ia("Box4.Actors.Box4PasteStewardUtils",()=>new sC(y.AFrameworkApplication.J.$("WacPasteBrAsNewParagraphIsEnabled"))).as(1147).ha();
b.ia(189,()=>new Ct(b.rf(889),b.resolve(890),Wg.a.instance,b.resolve(173),$f.a.instance,y.AFrameworkApplication.va,b.resolve(50),y.AFrameworkApplication.J,rd.FocusManager.instance(),b.resolve(891),b.resolve(892),b.resolve(215),b.resolve(235),y.AFrameworkApplication.bDg(),y.AFrameworkApplication.kUj(),b.resolve(893),$a.a.instance.resolve(731),!!df.a.instance&&df.a.instance.nma,b.Oa(260),b.resolve(665))).ha();b.ia(894,()=>new js(y.AFrameworkApplication.J)).ha();b.ia(895,()=>new mo(y.AFrameworkApplication.J,
b.resolve(894),b.resolve(173),dn.a.instance)).ha();b.ia(880,()=>b.resolve(895).create()).ha();b.ia(890,()=>new $A(b.resolve(880),Object(Jb.a)(),qa.StaticActiveAppFrame.za().kb,rd.FocusManager.instance(),b.resolve(215),b.resolve(235),dn.a.instance,y.AFrameworkApplication.J)).ha();b.ia(689,()=>new bx).ha();b.ia(870,()=>new oC.a).ha();b.ia(884,()=>new In).ha();b.ia(901,()=>new Nx).ha();b.ia(902,()=>new Ou($f.a.instance,b.resolve(164),b.resolve(8))).ha();b.ia(886,()=>new YA).ha();b.ia(893,()=>new Vx($f.a.instance,
b.resolve(18),Object(Jb.a)(),Te.a.getElementBounds,b.resolve(896),!!df.a.instance&&df.a.instance.nma)).ha();b.ia(897,()=>new uv(b.resolve(173),df.a.NB.MJ)).ha();b.ia(940,()=>new Bz(b.resolve(896),b.resolve(258),Object(Jb.a)(),qv.a.instance(),y.AFrameworkApplication.ta,b.resolve(893),b.resolve(71),b.resolve(897),df.a.ff.Pl.jf(12),b.resolve(201),b.resolve(731),b.resolve(26),!!df.a.instance&&df.a.instance.nma)).ha();b.ia(891,()=>new XI(Wg.a.instance,b.resolve(898),b.resolve(899),QI.a.instance,$f.a.instance,
y.AFrameworkApplication.va,b.resolve(900),b.rf(50),b.resolve(901),b.resolve(902),b.resolve(46).instance,b.Oa(260))).ha();b.ia(903,()=>new wG(y.AFrameworkApplication.va,Wg.a.instance,b.resolve(898),b.resolve(16),$f.a.instance,b.resolve(890),b.resolve(164),Ox.a.instance,b.resolve(197),b.resolve(293),b.resolve(202),b.resolve(884),b.resolve(870),b.resolve(71),b.resolve(173),b.Oa(23))).ha();b.ia(892,()=>new Tx(Wg.a.instance,dn.a.instance,b.resolve(890),b.resolve(256),y.AFrameworkApplication.J.appSettings.ChromeClipboardAccessOperationTimeout)).ha();
b.ia(900,()=>new ti(y.AFrameworkApplication.J)).ha();b.ia(889,()=>new mE(b.resolve(898),y.AFrameworkApplication.va,y.AFrameworkApplication.YCg(),Wg.a.instance,Ox.a.instance,dn.a.instance,b.resolve(42),b.resolve(891),b.resolve(903),b.resolve(892),b.resolve(904),b.resolve(172),b.resolve(256),b.resolve(180).instance,b.resolve(46).instance,b.resolve(50),b.resolve(258),b.resolve(259),b.Oa(260))).ha();en.a.rta&&b.ia(915,()=>new xs(en.a.TVi?b.Ra(2):null)).ha();b.ia(917,()=>new VA(b.rf(905),b.rf(906),b.rf(907),
b.rf(908),b.rf(909),b.Oa(910),b.resolve(71),b.resolve(911),b.resolve(912),b.resolve(493),b.resolve(913),b.resolve(914),b.Oa(260),en.a.rta?b.rf(915):null)).ha();b.ia(898,()=>new $w.a(b.resolve(822),b.rf(32),b.resolve(110),b.resolve(16),b.resolve(31),df.a.ff,b.resolve(34),y.AFrameworkApplication.J,b.resolve(449),b.resolve(42),b.Oa(910),b.resolve(623),b.resolve(46).instance,b.resolve(237).zMj,b.resolve(493))).ha();b.ia(916,()=>new vE(b.resolve(898),b.Oa(910),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc),
b.resolve(493),b.resolve(914))).ha();b.ia(1191,()=>new sh(y.AFrameworkApplication.va)).ha();b.ia(1095,()=>new Fx(b.resolve(31),b.rf(661),b.resolve(39).instance,b.resolve(46).instance,b.resolve(323))).ha();b.ia(899,()=>new XA(b.resolve(898),b.resolve(916),b.resolve(917),ve.a.instance,b.Oa(260))).ha();b.ia("Box4.Actors.Box4ImageStewardFactory",()=>new kE(b.resolve(822),y.AFrameworkApplication.oc,b.resolve(50),b.Oa(918),qa.StaticActiveAppFrame.za().lK,b.Oa(23),b.resolve(71).$("LogActionForFailedLocalImagePasteIsEnabled"))).as(906).ha();
b.ia("Box4.Actors.Box4TableStewardFactory",()=>new iE($a.a.instance.resolve(31),$a.a.instance.resolve(32),b.resolve(71).$("PasteComplexTablesIsEnabled"),b.resolve(71).$("PasteTableCellMarginImprovementsIsEnabled"))).as(907).ha();b.ia(904,()=>new nE(Wg.a.instance,$f.a.instance,Jf.a.vd(),ve.a.instance)).ha();b.ia("Box4.Actors.Box4WordConverterFactory",()=>new sG(y.AFrameworkApplication.J)).as(908).ha();b.ia(911,()=>new vh(y.AFrameworkApplication.J)).ha();b.ia(913,()=>new CG).ha();b.ia(210,()=>new jE(y.AFrameworkApplication.va)).ha();
b.ia(35,()=>new HG(y.AFrameworkApplication.va)).ha();b.ia(939,()=>new wz(b.Ra(325),b.resolve(43))).ha();b.ia("Box4.Actors.InsertionPointFormatting",()=>new DG(b.Oa(118),b.Ra(919))).as(106).ha();b.ia(896,()=>new Fy).as("Box4.UI.IFloatieManager").ha();b.ia(937,()=>new Zt($a.a.instance.resolve(43),y.AFrameworkApplication.va,()=>$a.a.instance.resolve(920),$a.a.instance.resolve(323),$a.a.instance.resolve(42),$f.a.instance,$a.a.instance.Ra(51),Ox.a.instance,$a.a.instance.resolve(123),ve.a.instance,Wg.a.instance,
$a.a.instance.resolve(30),$a.a.instance.resolve(41),$a.a.instance.Ra(921),$a.a.instance.resolve(344),$a.a.instance.resolve(922))).ha();b.ia(942,()=>new CC($a.a.instance.resolve(323),$a.a.instance.resolve(393),$a.a.instance.resolve(101),Object(zl.a)(),$a.a.instance.resolve(106),ve.a.instance,Wg.a.instance,$a.a.instance.resolve(377),Fz.instance,$a.a.instance.resolve(8),$a.a.instance.resolve(20))).ha();b.ia(941,()=>new FG($a.a.instance.resolve(923),$a.a.instance.resolve(8),y.AFrameworkApplication.va)).ha();
b.ia(938,()=>new GG.a(b.resolve(924),b.resolve(86),b.Oa(118),b.Oa(20),$a.a.instance.resolve(101),$a.a.instance.resolve(323),$a.a.instance.resolve(349),$a.a.instance.resolve(385),$a.a.instance.resolve(8),$a.a.instance.resolve(393),$a.a.instance.resolve(16),$a.a.instance.resolve(925),$a.a.instance.resolve(34))).ha();b.ia(1136,()=>new TI(y.AFrameworkApplication.va,Wg.a.instance,()=>$a.a.instance.resolve(926))).ha();b.ia(935,()=>new Mq(y.AFrameworkApplication.va,y.AFrameworkApplication.J,ls.GrippersManager.instance,
$f.a.instance)).as(73).ha();b.register(pC,"Box4.VisiMarkersOperation").as(927).ha();b.ia(1139,()=>new Jh(y.AFrameworkApplication.va,b.resolve(927),b.resolve(928))).ha();b.ia("Box4.Actors.IndentationActorExtension",()=>new Xx).as(932).ha();Object(tz.a)()&&b.register(PI,934).as("Box4.IHighContrastColorPickerState").ha();Object(Cz.a)()&&b.ia(933,()=>new Ru(tn.a.instance,new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc.qd),Pk.a.instance,xn.a.instance,$a.a.instance.Oa(790),new Ps(Ru.Mnb))).ha()}}Object(u.a)(DC,
"Box4ActorsComponentConfiguration",null,[1]);var Nq=d(210),AE=d(1071);const BE=()=>{const b=Gz;y.AFrameworkApplication.va.qa(ub.a.lzf,mc.a.qpb,b);y.AFrameworkApplication.va.qa(ub.a.lzf,mc.a.Vic,b);y.AFrameworkApplication.va.qa(ub.a.kzf,mc.a.qpb,fw);y.AFrameworkApplication.va.qa(ub.a.kzf,mc.a.Vic,fw)},Gz=(b,h,r)=>df.a.H_d?8:2===r?(b=new kh.StandardDialog,b.Ed=4,b.xY(1),b.Qe(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.Qe(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.SDg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,
Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,EC),32):2,EC=b=>{1===b&&y.AFrameworkApplication.va.Ob(ub.a.kzf,2)},fw=(b,h,r)=>{if(df.a.H_d)return 8;if(1===r)return h.node.hasProperty(ze.a.jOb)?32:2;if(2===r&&(h.contextId===mc.a.view&&h.view.lb&&(h=h.view.lb.Ng),Nq.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=AE.a.ptm(h.node);Qc.a.R1o();try{CE(b)}catch(A){v.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",A)}}return 32},CE=b=>{Te.a.Cn(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};
var eB=d(786);class $t{constructor(b){this.tJ=null;this.CTc=(h,r,A,M,ba)=>{if(1===A)return 32;if(2===A&&!ba)return 8;this.JUe.wae=!this.JUe.wae;h=$t.rj.IQb(r);r=new eB.a;A=null;32===y.AFrameworkApplication.va.Pb(ub.a.HZa,2,r)&&r&&(A=r.fontColor);M="";A&&!r.fPb&&(M=Yl.a.QB(A)||"");this.W3d.sca=M;this.VP.iBc(M);h=this.W3d.mqb(h,df.a.nUa);if(!h)return 8;ba.MenuItems=h;v.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.Mid=(h,r,A,M,ba)=>{if(1===A)return 32;if(!ba)return 8;
ba[Ng.a.On]=this.JUe.wae;return 32};this.S3=(h,r,A,M,ba)=>{if(1===A)return 32;y.AFrameworkApplication.va.Pb(ub.a.HZa,2,ba);h=ba&&0<=ba.fontColor&&16777215>=ba.fontColor?ba.fontColor:0;qa.StaticActiveAppFrame.za().dismissFloatie();(new Gs($t.Mnb,ub.a.yva)).Wyb(h);return 32};this.XXb=(h,r,A,M,ba)=>{if(1===A)return 32;if(2===A&&!ba)return 8;h=$t.rj.IQb(r);r=new eB.a;A=null;32===y.AFrameworkApplication.va.Pb(ub.a.HZa,2,r)&&r&&(A=r.fontColor);M="";A&&!r.fPb&&(M=Yl.a.QB(A)||"");this.W3d.sca=M;this.VP.iBc(M);
h=this.W3d.mqb(h,df.a.nUa);if(!h)return 8;ba.MenuItems=h;v.ULS.sendTraceTag(508421139,340,50,"Font color dropdown menu is opened.");return 32};this.F0e=b}get W3d(){this.tJ||(this.tJ=new Ps($t.Mnb),this.Vfa(this.tJ));return this.tJ}Vfa(b){Object(tz.a)()&&b.SG(7,ub.a.CTc);b.SG(1,ub.a.kka);b.SG(3,ub.a.gx);b.SG(4,ub.a.gx);b.SG(5,ub.a.yva);b.SG(6,ub.a.S3);b.b6a(this.F0e,1)}Wb(b){const h=y.AFrameworkApplication.va;Object(tz.a)()&&(this.JUe=b,h.qa(ub.a.CTc,mc.a.view,this.CTc),h.fb(ub.a.Mid,mc.a.view,this.Mid,
96));h.qa(ub.a.S3,mc.a.view,this.S3);h.qa(ub.a.XXb,mc.a.view,this.XXb);h.Pc(ub.a.XXb,1127)}static uum(){return new $t(tn.a.instance)}static get instance(){return null!=$t.rZg?$t.rZg:$t.rZg=$t.uum()}get VP(){return null!=this.w3g?this.w3g:this.w3g=$a.a.instance.Oa(790)}static get rj(){return cm.PageReader.instance}}$t.Mnb="Font";Object(u.a)($t,"FontColorActor",null,[]);class wv{constructor(b){this.S3=(h,r,A,M,ba)=>{if(1===A)return 32;y.AFrameworkApplication.va.Pb(ub.a.HZa,2,ba);h=ba&&0<=ba.highlight&&
16777215>=ba.highlight?ba.highlight:0;qa.StaticActiveAppFrame.za().dismissFloatie();(new Gs("Highlighter",ub.a.yca)).Wyb(h);return 32};this.ga=b}Wb(){this.ga.qa(ub.a.cqj,mc.a.view,this.S3)}static qwm(){return new wv(y.AFrameworkApplication.va)}static get instance(){return null!=wv.c_g?wv.c_g:wv.c_g=wv.qwm()}}Object(u.a)(wv,"HighlighterColorActor",null,[]);var au;(function(b){b.bQp="Heading";b.Bookmark="Bookmark";b.Url="Url";b.cSp="RecentLinks"})(au||(au={}));Object(u.b)("InsertLinkUserActivitySource",
au);class DE{constructor(b,h,r,A,M){this.linkurl=b;this.isHeading=h;this.startCp=r;this.endCp=A;this.paragraphNode=M}}Object(u.a)(DE,"HeadingDataForLinkDialog",null,[]);class fB{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(u.a)(fB,"BookmarkDataForLinkDialog",null,[]);class EE{constructor(b,h,r,A,M,ba){this.key=b;this.name=h;this.startIndex=r;this.count=A;this.level=M;this.isCollapsed=ba}}Object(u.a)(EE,"GroupHeaderDataForLinkDialog",null,[]);class Tu{constructor(b,h){this.selectedIndex=
b;this.selectedGroupId=h}}Object(u.a)(Tu,"SelectedItemFromLinkDialogGroupedList",null,[]);class gB{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){this.Zr=b;this.td=h;this.oYl=r;this.bookmarkManager=A;this.l3=M;this.Rp=ba;this.Bg=oa;this.Pd=Ja;this.Oj=jb;this.hl=zb;this.NBa=Eb;this.nPb=null;this.uXi=!1;this.dWf=(Dc,Zc)=>{var Gd;if(this.ne.sw){var de=Oc.a.J4c(this.Zr),he=this.ne.lb.gb.currentSelection;if(he){he=he.Qa;Ed.ParagraphReader.kn(he)&&(he=vc.a.createTextRange(he.node,0,Ed.ParagraphReader.textLength(he.node)));
var fe=Le.a.p2b(he);Le.a.gm(fe)&&(he=fe);if(0!==Dc&&32===y.AFrameworkApplication.va.Pf(he,ub.a.XR,1,!0,null,null)&&this.Zr.equals(he)){db.a.mark(5562);(null===(Gd=Jf.a.vd())||void 0===Gd?0:Gd.wn)&&this.ne.lb.pcc();Dc=new Qb.GraphTransaction(15);Dc.Ab(this.Zr.node);this.Zr.node.GL().nH.eaa(4);Gd=Zc.txtDisplay;he=!1;if(null!=Zc.linkurl)if(he=!0,Zc.isHeading){m(this.td,"Heading");fe=Zc.paragraphNode;const Yd=Zc.startCp,Td=Zc.endCp;Zc=this.bookmarkManager.pkm(fe);this.bookmarkManager.xSc(Zc,Yd,Td,fe,
fe,!1)}else m(this.td,"Bookmark"),Zc=Zc.linkurl;else m(this.td,"Url"),Zc=Zc.txtLink.trim();this.zSb(Gd,Zc,de,he);Dc.Ei=ub.a.XR;Dc.dispose();db.a.mark(5563);this.Zr.node.zpb()}else this.ne.Z8()}else v.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};this.ne=Object(Jb.a)().Ad;this.Zr=b;r=Le.a.p2b(this.Zr);Le.a.gm(r)&&(this.Zr=r);const Sb=new ug.a(!1,!1,!0);r=this.zvm();A={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,
["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:r};M=this.nPb="";M=Ed.ParagraphReader.text(this.Zr.node);oa=this.Zr.cpBegin;Ja=this.Zr.cpEnd;({Fxg:M,mCf:oa,nCf:Ja,bUf:ba}=this.Nqm(M));if((h="object"===typeof h?h:null)&&(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.zSb(h.DisplayText,h.Url,ba);else{ba[0]&&this.x5l(oa,Ja,ba[0].paragraph);h=""===M.trim()?
Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;Sb.Qe(1,h);(null===M||void 0===M?0:M.startsWith(C.a.Ymb))?(h=this.fLm(M,r))?r.selectedItem=h:A.txtLink=M:A.txtLink=M;A.txtDisplay=this.nPb;1>=ba.length&&this.l3.EAl(b,ba[0],1===ba.length)&&(this.uXi=!0,A.textDisplayDisabled=!0);var nc={["id"]:"InsertLinkDialog",["bodyControls"]:A};this.hl.ee(()=>{Sb.gi(Box4Intl.Box4Strings.l_InsertLinkTitle,this.dWf,nc)},"RILD:IAS")}}Nqm(b){const h=Oc.a.J4c(this.Zr);let r=this.Zr.cpBegin,A=this.Zr.cpEnd,
M="";if(!h.length)return this.nPb=b.substring(this.Zr.cpBegin,this.Zr.cpEnd),{returnValue:!0,Fxg:M,mCf:r,nCf:A,bUf:h};if(h[0].hyperlink){let ba,oa=0,Ja=Math.max(0,b.length-1),jb=0;for(let zb=0;zb<h.length;zb++)h[zb].cpBegin>=oa&&({cpBegin:ba,cpEnd:oa}=this.l3.rla(this.Zr,h[zb]),Ja=Math.min(ba,Ja),jb=Math.max(oa,jb));r=Math.min(Ja,r);A=Math.max(jb,A);this.nPb=b.substring(r,A);r===Ja&&(M=h[0].hyperlink.url);return{returnValue:!0,Fxg:M,mCf:r,nCf:A,bUf:h}}return{returnValue:!1,Fxg:M,mCf:r,nCf:A,bUf:h}}x5l(b,
h,r){if(h!==this.Zr.cpEnd||b!==this.Zr.cpBegin)b=sc.SelectionFactory.rL(r,b,h),this.ne.lb.Kc(b),this.Zr=Le.a.p2b(b.Qa.clone())}npp(b,h,r,A,M,ba=!1){A?(A=vc.a.createTextRange(this.Zr.node,this.Zr.cpBegin,this.Zr.cpBegin+b.length),this.Rp.l_l(A,r,h),b=sc.SelectionFactory.ve(this.Zr.node,this.Zr.cpBegin+b.length)):(this.Rp.Bvb(this.Zr,2),this.Oj.Iyb(this.Zr,2),r=vc.a.Tc(this.Zr.node,this.Zr.cpEnd),this.Bg.Ue(r,b,!0),A=vc.a.createTextRange(this.Zr.node,this.Zr.cpEnd,this.Zr.cpEnd+b.length),this.Rp.CF(A,
h,M,!1,!0,ba),b=sc.SelectionFactory.ve(this.Zr.node,this.Zr.cpEnd+b.length));b&&this.ne.lb.Kc(b)}zSb(b,h,r,A=!1){var M=null;b||(b=h,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!r.length||h!==r[0].hyperlink.url)&&!A){h=Oc.a.KKa(h);var ba="";this.NBa&&({Srg:ba}=this.NBa.sKg(h)).returnValue&&(h=ba)}this.uXi||(b=this.Rp.mGo(b));ba=!1;if(h){M=0<r.length;const oa=Ed.ParagraphReader.text(this.Zr.node).substring(this.Zr.cpBegin,
this.Zr.cpEnd)!==b,Ja=this.Pd.Ag;if(Ja&&1===r.length&&!r[0].hyperlink.DI&&!(r[0].cpBegin>this.Zr.cpBegin&&r[0].cpEnd<=this.Zr.cpEnd)){this.npp(b,h,r[0].hyperlink,!oa,M,A);return}if(M)for(let jb=0;jb<r.length;jb++)r[jb].hyperlink.DI&&(ba=!0),this.Rp.rV(this.Zr.node,r[jb].hyperlink,!1);oa?this.Bg.Ue(this.Zr,b,!ba):Ja&&!ba&&this.Oj.Iyb(this.Zr,1);r=vc.a.createTextRange(this.Zr.node,this.Zr.cpBegin,this.Zr.cpBegin+b.length);this.Rp.CF(r,h,M,ba,!0,A);M=sc.SelectionFactory.ve(this.Zr.node,this.Zr.cpBegin+
b.length)}else 0<r.length&&(b=r[0],b.hyperlink.DI&&(ba=!0),this.Rp.rV(b.paragraph,b.hyperlink));ba&&this.Pd.ev(ba?2:7);M&&this.ne.lb.Kc(M);df.a.Hqp()}fLm(b,h){h=h.items;const r=b.substring(C.a.Ymb.length),A=this.bookmarkManager.QDi(r);b=-1;let M=0;for(let ba=0;ba<h.length;ba++)if(h[ba].isHeading&&0!=A.count&&h[ba].paragraphNode.id==A.K(0).id){b=ba;break}else if(!h[ba].isHeading&&h[ba].linkurl==r){b=ba;M=1;break}h=new Tu(b,M);return-1!=b?h:null}zvm(){const b={};let h=[],r=0,A=0;var M=this.oYl.cwm();
M&&(r=M.count,h=h.concat(this.hwm(M)));if(M=this.bookmarkManager.Q4d(!1))A=M.count,h=h.concat(this.tkm(M));b.groups=this.Xvm(r,A);b.items=h;return b}Xvm(b,h){const r=[],A=new EE("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);r.push(A);b=new EE("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,h,0,!0);r.push(b);return r}hwm(b){const h=[],r=/\uFFFC/;for(const A of b)b=A.characterData.replace(r," "),b=new DE(b,!0,A.Dc,A.end,A.paragraphNode),h.push(b);
return h}tkm(b){const h=[];for(const r of b)b=r.wf(Rc.a.zu).toString(),b=new fB(b,!1),h.push(b);return h}}Object(u.a)(gB,"ReactInsertLinkDialog",null,[]);class Gt{static get lh(){return ug.a.ry(Gt.Qn,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Gt.Qn="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(u.a)(Gt,"InsertLinkDialogHtml",null,[]);class Po extends ug.a{constructor(b){super();this.cne=()=>{const h=document.getElementById("txtLink");this.tva(1,!h||!h.value.length||Oc.a.PXa(h.value))};this.dWf=(h,r)=>{if(this.zh.sw){var A=this.zh.lb.gb.currentSelection;if(A)if(A.equals(this.Qy)&&0!==h){h=new Qb.GraphTransaction(15);h.Ab(this.zW[0].node);for(A=0;A<this.zW.length;A++)this.zW[A].node.GL().nH.eaa(4);A=r.txtLink.trim();r=this.WQl();A=this.Lbn(A);(r||A)&&Po.Pd.ev(7);this.hide();h.dispose()}else this.zh.Z8()}};
this.zW=b;this.zh=Object(Jb.a)().Ad;this.Qy=this.zh.lb.gb.currentSelection;this.bEf=b[0].cpBegin;this.h3f=b[b.length-1].cpEnd;this.Pg="InsertMultiParagraphLinkDialog";b=this.Fyp();this.showDialog("",b)}showDialog(b,h){v.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.lh=Gt.lh;""===h.trim()&&this.Qe(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.gi(Box4Intl.Box4Strings.l_InsertLinkTitle,this.dWf,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();
document.getElementById("txtDisplay").disabled=!0;Po.JZf&&(b=document.getElementById("txtLink"),uf.a.addHandler(b,zd.a.input,this.cne),uf.a.addHandler(b,zd.a.mVc,this.cne))}hide(){if(Po.JZf){const b=document.getElementById("txtLink");b&&(uf.a.removeHandler(b,zd.a.mVc,this.cne),uf.a.removeHandler(b,zd.a.input,this.cne))}super.hide()}hAa(b){return Po.JZf?this.hlm(this.iGc)?super.hAa(b):!1:super.hAa(b)}Fyp(){let b;var h="";const r=this.zW.length,A=Oc.a.VA(this.zW[0],!1);0<A.length&&({cpBegin:M,cpEnd:b}=
Po.l3.rla(this.zW[0],A[0]),M<=this.zW[0].cpBegin&&(h=A[0].hyperlink.url),this.bEf=Math.min(this.bEf,M));var M=Oc.a.VA(this.zW[r-1],!1);0<M.length&&({cpBegin:M,cpEnd:b}=Po.l3.rla(this.zW[r-1],M[M.length-1]),this.h3f=Math.max(this.h3f,b));this.trp(this.bEf,this.h3f);return h}trp(b,h){const r=this.zW.length;if(b!==this.zW[0].cpBegin||h!==this.zW[r-1].cpEnd){b=vc.a.Tc(this.zW[0].node,b);b=sc.SelectionFactory.Yo(b);h=vc.a.Tc(this.zW[r-1].node,h);h=sc.SelectionFactory.Yy(b,h);b=this.VIi(h.Qa.clone());const A=
this.VIi(h.Wc.clone());b&&A&&(this.zW[0]=b,this.zW[r-1]=A,this.zh.lb.Kc(h),this.Qy=h)}}Lbn(b){if(!b)return!1;b=Oc.a.KKa(b);for(let r=0;r<this.zW.length;r++){var h=this.zW[r];if(Po.Sya&&Le.a.gm(h)&&(h=Le.a.nKg(h),!Le.a.gm(h)))continue;h=vc.a.createTextRange(this.zW[r].node,h.cpBegin,h.cpEnd);this.Uqp(h);Po.Rp.CF(h,b,!1)}return!0}Uqp(b){Po.Pd.L3j(b)}VIi(b){return Ed.ParagraphReader.kn(b)&&!Le.a.nba(b)&&Ed.ParagraphReader.textLength(b.node)?vc.a.createTextRange(b.node,0,Ed.ParagraphReader.textLength(b.node)):
Le.a.gm(b)?b:null}WQl(){let b=!1;for(const h of this.zW){const r=Oc.a.VA(h,!1);r&&(b=Po.l3.RCj(h,r)||b)}return b}static get l3(){return null!=Po.zYg?Po.zYg:Po.zYg=$a.a.instance.resolve(242)}static get Pd(){return null!=Po.l6g?Po.l6g:Po.l6g=$a.a.instance.resolve(46).instance}static get Rp(){return null!=Po.qYg?Po.qYg:Po.qYg=$a.a.instance.resolve(82)}static get Sya(){null==Po.ada&&(Po.ada=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Po.ada}static get JZf(){null==
Po.qXe&&(Po.qXe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("HyperlinkUrlValidationIsEnabled"):!1);return Po.qXe}}Po.ada=null;Po.qXe=null;Object(u.a)(Po,"InsertMultiParagraphLinkDialog",ug.a,[]);class Hf{static get sg(){return ve.a.instance}static get L6(){return null!=Hf.wUg?Hf.wUg:Hf.wUg=$a.a.instance.Oa(20)}static get l3(){return null!=Hf.AYg?Hf.AYg:Hf.AYg=$a.a.instance.resolve(242)}static wy(){return Hf.ao||(Hf.ao=$a.a.instance.Ra(51))}static get Pd(){return null!=Hf.w6g?Hf.w6g:Hf.w6g=
$a.a.instance.resolve(46).instance}static get ti(){return null!=Hf.C6g?Hf.C6g:Hf.C6g=$a.a.instance.resolve(180).instance}static get Bc(){return Wg.a.instance}static get Udd(){null==Hf.rBb&&(Hf.rBb=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("MultiParagraphHyperlinkEditEnabled"):!1);return Hf.rBb}static get Sya(){null==Hf.ada&&(Hf.ada=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Hf.ada}static get Rp(){return null!=Hf.wYg?Hf.wYg:
Hf.wYg=$a.a.instance.resolve(82)}static get Bg(){return null!=Hf.kUg?Hf.kUg:Hf.kUg=$a.a.instance.resolve(323)}static get Jab(){Hf.QXe||(Hf.QXe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost"):!1);return Hf.QXe}static get ymp(){Hf.dIh||(Hf.dIh=y.AFrameworkApplication.J?y.AFrameworkApplication.J.fc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return Hf.dIh}static Wb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.XR,
mc.a.view,Hf.YRb);b.qa(ub.a.XR,mc.a.Vc,Hf.zSb);b.qa(ub.a.XR,mc.a.Fd,Hf.zSb);b.Pc(ub.a.XR,1028);b.qa(ub.a.Fhc,mc.a.view,Hf.YRb);b.qa(ub.a.Fhc,mc.a.Vc,Hf.zSb);b.qa(ub.a.Fhc,mc.a.Fd,Hf.zSb);b.Pc(ub.a.Fhc,1028);b.qa(ub.a.rV,mc.a.view,Hf.YRb);b.qa(ub.a.rV,mc.a.Vc,Hf.aDj);b.qa(ub.a.rV,mc.a.Fd,Hf.aDj);b.Pc(ub.a.rV,1028);b.qa(ub.a.swe,mc.a.view,Hf.YRb);b.qa(ub.a.swe,mc.a.Vc,Hf.jLj);b.qa(ub.a.swe,mc.a.Fd,Hf.jLj);b.qa(ub.a.Bcb,mc.a.view,Hf.YRb);b.qa(ub.a.Bcb,mc.a.Vc,Hf.eqj);b.qa(ub.a.Bcb,mc.a.Fd,Hf.eqj);b.qa(ub.a.Bcb,
mc.a.image,Hf.lig);b.qa(ub.a.Bcb,mc.a.$Ob,Hf.lig);b.qa(ub.a.Bcb,mc.a.V$,Hf.lig);b.qa(ub.a.QVc,mc.a.application,Hf.QVc);b.qa(ub.a.cYd,mc.a.view,Hf.YRb);Hf.Jab&&(b.fb(La.a.qdb,mc.a.view,this.YRb.bind(this),1028),b.qa(La.a.qdb,mc.a.Vc,this.qdb.bind(this)),b.qa(La.a.qdb,mc.a.Fd,this.qdb.bind(this)),b.Pc(La.a.qdb,1028),b.qa(La.a.eWf,mc.a.Vc,this.qdb.bind(this)),b.qa(La.a.eWf,mc.a.Fd,this.qdb.bind(this)),b.Pc(La.a.eWf,1028),b.qa(La.a.Llg,mc.a.view,this.Llg.bind(this)),b.qa(La.a.Elg,mc.a.view,this.Elg.bind(this)),
b.fb(La.a.Fsb,mc.a.Vc,this.Fsb.bind(this),1028),b.fb(La.a.Fsb,mc.a.Fd,this.Fsb.bind(this),1028))}static QVc(){return 32}static qdb(b,h,r){if(!Hf.Jab)return 2;b=Hf.Dak(h);if(32!=b)return b;if(!Hf.OXa(h,!0).returnValue||Hf.Bfc(h))return 8;1!==r||Hf.mpi||(Hf.rFe(!0),Hf.mpi=!0);return 32}static Llg(b,h,r,A,M){if(!Hf.Jab)return 2;if(1===r)return 32;Hf.vte(Hf.RJk,Hf.SJk,Hf.nBh);vp.a.instance.ee(()=>{Hf.rFe();M.MenuItems=Object.assign(new Xe.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});
const ba=this.Hai();ba?(v.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),M.MenuItems.MenuSectionList.push(ba)):Hf.guj(M,Hf.nBh)},"HA:PRLF");return 32}static Elg(b,h,r,A,M){if(!Hf.Jab)return 2;if(1===r)return 32;Hf.vte(Hf.PJk,Hf.QJk,Hf.mBh);vp.a.instance.ee(()=>{Hf.rFe();M.MenuItems=Object.assign(new Xe.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});M.MenuItems.MenuSectionList.push(this.THl());const ba=this.Hai(!0);ba?(v.ULS.sendTraceTag(526242132,
324,50,"Recent Links data load success in context menu"),M.MenuItems.MenuSectionList.push(ba)):Hf.guj(M,Hf.mBh)},"HA:PILF");return 32}static guj(b,h){v.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+h);Hf.vte(Hf.uGk,Hf.vGk,h);b.MenuItems.MenuSectionList.push(this.wKl());Hf.rFe(!0)}static wKl(){const b=this.muf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new Pj.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));
return b}static THl(){const b=this.muf("InsertLinkSection");b.ControlList.push(Object.assign(new Pj.a,{ExternalId:"InsertLink"}));return b}static Hai(b=!1){if(Ti.instance.EKd){var h=this.muf("RecentLinksSection",b);b=JSON.parse(Ti.instance.EKd);this.DKd.clear();b.forEach((r,A)=>{this.DKd.set(A,[r.FileName,r.DocumentUrl]);const M=Hf.XIm(r.FileName);var ba=Hf.Wum(r.TimeStamp),oa=h.ControlList,Ja=oa.push,jb=Object,zb=jb.assign,Eb=new Pj.a,Sb=La.a.Fsb,nc=La.a.Fsb;ba=M!==r.FileName?r.FileName+"\n"+ba:
ba;var Dc=r.FileName;let Zc="SaveAsWordDocx_32";switch(r.App){case "Word":Zc="SaveAsWordDocx_32";break;case "PowerPoint":Zc="SaveAsPowerPointPptx_32";break;case "Excel":Zc="SaveAsExcelXlsx_32"}Ja.call(oa,zb.call(jb,Eb,{ExternalId:A,Command:Sb,CommandValueId:nc,LabelText:M,Alt:ba,AriaDescription:Dc,ExternalImageId:Zc,KeyTip:r.FileName}))});return h}}static muf(b,h=!1){return Object.assign(new xh.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+
b,ControlList:[]})}static Fsb(b,h,r,A,M){if(!Hf.Jab)return 2;if(!M||M.CommandValueId!=La.a.Fsb)return 32;Hf.vte(Hf.BAk,Hf.CAk,Hf.dLk);r=h;h=new Qb.GraphTransaction(15);h.Ei=b;h.Ab(r.node);A=Hf.OXa(r,!0).hyperlink;r=Le.a.p2b(r);if(A)Hf.Ksg(r),b=sc.SelectionFactory.rL(r.node,Math.min(r.cpBegin,A.cpBegin),Math.max(r.cpEnd,A.cpEnd)),$f.a.instance.Kc(b),r=b.Qa;else if(Le.a.qf(r)){var ba;Le.a.Ttb(r)&&(ba=Le.a.c7(r,!1));ba||(ba=this.DKd.get(M.SourceControlId)[0],Hf.Bg.Ue(r,ba,!0,void 0,b),ba=sc.SelectionFactory.rL(r.node,
r.cpBegin,r.cpBegin+ba.length));if(ba&&($f.a.instance.Kc(ba),r=ba.Qa,Hf.Bfc(r)))return Hf.Pd.W0b(!1),8}try{Hf.Rp.CF(r,this.DKd.get(M.SourceControlId)[1],0<Oc.a.J4c(r).length);const oa=sc.SelectionFactory.ve(r.node,r.cpEnd);oa&&$f.a.instance.Kc(oa);m(M,"RecentLinks")}finally{h&&h.dispose()}v.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static YRb(b,h,r,A,M){if(Hf.Udd)return Hf.J4m(b,h,r,A,M);if(!h.view.ue)return 2;var ba=h.view.lb;if(!ba||!ba.gb||!ba.gb.length)return 8;var oa=
ba.gb.currentSelection;let Ja=oa.Qa.clone();if(2===oa.length){if(oa=oa.K(1),!Le.a.gm(Ja)||!Le.a.rl(oa)||Ja.node!==oa.node)return 8}else if(2<oa.length)return 8;if(ba.gb.WL)return 8;if(Object(zl.a)().bFa(Ed.ParagraphReader.IX,ba.Ng))return Hf.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.cR}),8;Ed.ParagraphReader.kn(Ja)&&!Le.a.nba(Ja)&&(ba=Ja.node,Ja=vc.a.createTextRange(ba,0,Ed.ParagraphReader.textLength(ba)));return b===ub.a.cYd?Hf.G8h(h,Ja,r,A):y.AFrameworkApplication.va.Pf(Ja,b,r,!0,A,M)}static J4m(b,h,r,A,M){if(!h.view.ue)return 2;
var ba=h.view.lb;if(!ba||!ba.gb||!ba.gb.length||ba.gb.WL)return 8;var oa=ba.gb.currentSelection;if(ba=Hf.h1f(oa))oa=Hf.aPf(oa.Qa.clone(),!0);else{let Ja=oa.K(0).clone(),jb=1;for(;jb<oa.length&&(!Ed.ParagraphReader.textLength(Ja.node)||Le.a.rl(Ja)||Hf.Sya&&bm.l(Ja));)Ja=oa.K(jb).clone(),jb++;oa=Hf.aPf(Ja,!1)}return Hf.Sya&&Le.a.gm(oa)&&bm.l(oa)||!Le.a.gm(oa)&&!ba?8:b===ub.a.cYd?Hf.G8h(h,oa,r,A):y.AFrameworkApplication.va.Pf(oa,b,r,!0,A,M)}static h1f(b){if(1===b.length)return!0;if(2===b.length){const h=
b.Qa.clone();b=b.K(1);return Le.a.gm(h)&&Le.a.rl(b)&&h.node===b.node?!0:!1}return!1}static O5h(b){let h=null;const r=[];for(let A=0;A<b.length;A++){const M=Hf.aPf(b.K(A).clone(),!1);if(Le.a.gm(M))Hf.Sya&&bm.l(M)||r.push(M);else if(!Le.a.rl(M)&&!Ed.ParagraphReader.kn(M))return{returnValue:!1,eob:h}}h=r;return{returnValue:!Hf.Sya||0<h.length?!0:!1,eob:h}}static zSb(b,h,r,A,M){if(Hf.Udd)return Hf.Wbn(h,r,M);A=Hf.Dak(h);if(32!==A)return A;let ba;if(!({hyperlink:ba}=Hf.OXa(h,!0)).returnValue||Hf.Bfc(h)||
!ba&&b==ub.a.Fhc)return 8;if(1===r)return 32;if(!ba&&Le.a.qf(h)&&Le.a.Ttb(h)&&(b=Le.a.c7(h,!1))&&($f.a.instance.Kc(b),h=b.Qa,Hf.Bfc(h)))return Hf.Pd.W0b(!1),8;ba&&v.ULS.sendTraceTag(593875799,324,50,"Edit link");a(h,M);return 32}static Dak(b){return!Hf.CUd(b)||b.node.Jq||$f.a.instance.gb.WL?8:Le.a.K7(b)||Bl.a.nZf(b)?2:32}static Wbn(b,h,r){var A=$f.a.instance.gb.currentSelection;const M=Hf.h1f(A);if(M)b=[b];else if(!({eob:b}=Hf.O5h(A)).returnValue)return 8;for(A=0;A<b.length;A++)if(!Hf.CUd(b[A]))return 8;
if($f.a.instance.gb.WL)return 8;A=Array(b.length);let ba=null;for(let oa=0;oa<b.length;oa++)if(A[oa]=b[oa],!({hyperlink:ba}=Hf.OXa(A[oa],!0)).returnValue||Hf.Bfc(A[oa]))return 8;if(1===h)return 32;if(!ba&&1===A.length&&M&&Le.a.qf(A[0])&&Le.a.Ttb(A[0])&&(h=Le.a.c7(A[0],!1))&&($f.a.instance.Kc(h),A[0]=h.Qa,Hf.Bfc(A[0])))return Hf.Pd.W0b(!1),8;M?a(A[0],r):new Po(A,r);return 32}static aDj(b,h,r){if(Hf.Udd)return Hf.lBo(b,h,r);if(!Hf.CUd(h)||Le.a.K7(h))return 2;let A;if(!({hyperlink:A}=Hf.OXa(h,!1)).returnValue)return 2;
if(2===r){r=new Qb.GraphTransaction(15);try{r.Ei=b,r.Ab(A.paragraph),Hf.Ksg(h)}finally{r&&r.dispose()}A.hyperlink.DI&&Hf.Pd.ev(2)}return 32}static lBo(b,h,r){var A=$f.a.instance.gb.currentSelection;if(Hf.h1f(A))h=[h];else if(!({eob:h}=Hf.O5h(A)).returnValue)return 8;for(A=0;A<h.length;A++)if(!Hf.CUd(h[A]))return 8;if(1===r&&!Hf.OXa(h[0],!1).returnValue)return 2;if(2===r){for(r=0;r<h.length;r++)if(!Hf.OXa(h[r],!0).returnValue)return 2;r=new Qb.GraphTransaction(15);try{const M=h[0];r.Ei=b;r.Ab(M.node);
for(b=0;b<h.length;b++)Hf.Ksg(h[b])}finally{r&&r.dispose()}Hf.Pd.ev(7)}return 32}static Ksg(b){const h=Oc.a.J4c(b);let r=0;for(let A=0;A<h.length;A++)if(h[A].cpBegin>=r){const M=({cpEnd:r}=Hf.l3.rla(b,h[A])).returnValue;Hf.l3.RCj(b,M)}}static jLj(b,h,r){if(je.a.cab(h)||!({hyperlink:b}=Hf.OXa(h,!1)).returnValue)return 2;if(2===r){const {cpBegin:A,cpEnd:M}=Hf.l3.rla(h,b);$f.a.instance.Kc(sc.SelectionFactory.rL(b.paragraph,A,M))}return 32}static eqj(b,h,r){if(({hyperlink:b}=Hf.qwn(h)).returnValue)v.ULS.sendTraceTag(50934737,
324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=Hf.OXa(h,!1)).returnValue)return 2;2===r&&df.a.Yic(b.hyperlink.url);return 32}static lig(b,h,r){b=je.a.rla(h.node);if(!b)return 2;2===r&&df.a.Yic(b);return 32}static G8h(b,h,r,A){if(je.a.cab(h)||!Object(Jb.a)().Ke.uk)return 2;let M;if(!({hyperlink:M}=Hf.OXa(h,!1)).returnValue)return 2;if(1===r)return 32;const {cpBegin:ba,cpEnd:oa}=Hf.l3.rla(h,M);$f.a.instance.Kc(sc.SelectionFactory.rL(M.paragraph,ba,oa));h=Object(Jb.a)().GIa.ownerDocument.createElement("span");
h.innerText=M.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return y.AFrameworkApplication.va.Pf(b,ub.a.bYd,2,!0,A,h)}static OXa(b,h){if(Le.a.gm(b)){const r=bm.g(b),A=Ye.a.all(r,M=>6===M.$h);if(0<r.length&&(!Hf.Sya||!A)||Hf.sg.Ph&&Hf.L6&&0<Hf.L6.I5d(b).count)return{returnValue:!1,hyperlink:null}}return Hf.fwn(b,h)}static qwn(b){let h=null;return je.a.cab(b)&&(h=Oc.a.rkc(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static fwn(b,h){let r=null;const A=Oc.a.J4c(b);return A.length?
A[0].hyperlink?(r=A[0],b.cpBegin<A[0].cpBegin?{returnValue:h,hyperlink:r}:{returnValue:!0,hyperlink:r}):{returnValue:!1,hyperlink:r}:{returnValue:h,hyperlink:r}}static Bfc(b){b=Hf.ti.jBa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.K(h).Hd.changeType)return!0;return!1}static CUd(b){return Hf.sg.F2(b)||Hf.sg.gma(b)||Hf.wy()&&Hf.wy().instance&&Hf.wy().instance.KX(b)?!1:!0}static aPf(b,h){return Ed.ParagraphReader.kn(b)&&!Le.a.nba(b)&&(Ed.ParagraphReader.textLength(b.node)||h)?vc.a.createTextRange(b.node,
0,Ed.ParagraphReader.textLength(b.node)):b}static XIm(b){return b&&b.length<=Hf.uzj?b:b.substring(0,Hf.uzj)+"..."}static Wum(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static rFe(b=!1){const h=Date.now();if(b||h-Hf.M5i>Hf.ymp)Ti.instance.tKn(),Hf.M5i=h}static vte(b,h,r){const A=new Map;A.set("Source",r);A.set("Action",h);za.Health.instance.recordKpiUsage(b,
0,this.I2a,A)}}Hf.ao=null;Hf.rBb=null;Hf.ada=null;Hf.DKd=new Map;Hf.QXe=null;Hf.uzj=35;Hf.M5i=Date.now();Hf.mpi=!1;Hf.I2a="wwaengidc";Hf.dLk="RecentLinks";Hf.nBh="RecentLinksRibbonOptions";Hf.mBh="RecentLinksContextMenuOptions";Hf.RJk="PopulateRecentLinksRibbon";Hf.SJk="PopulateRecentLinksRibbonAction";Hf.PJk="PopulateRecentLinksContextMenu";Hf.QJk="PopulateRecentLinksContextMenuAction";Hf.uGk="PopulateRecentLinksContextMenu";Hf.vGk="PopulateRecentLinksContextMenuAction";Hf.BAk="InsertRecentLinks";
Hf.CAk="InsertRecentLinksAction";Object(u.a)(Hf,"HyperlinkActor",null,[]);class ht{}ht.ibb=Object.freeze({$6m:"WordIndentationShortcutUsage"});ht.$B="wwaengidc";Object(u.a)(ht,"IndentationConstants",null,[]);class Qs{static get zzn(){return Qs.hGd}static OEl(b,h,r){try{Qs.hGd=Qs.YIl(b,h,r)}catch(A){Qs.hGd=null,v.ULS.jA(539787540,393,10,A,"Error in creating autoTriggerTextContext: {0}",A instanceof Error?A.message:"Unknown Error")}}static SGj(){Qs.hGd=null}static YIl(b,h,r){if(!mf.ListItemReader.Dg(h))throw v.ULS.sendTraceTag(539787541,
393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const A=mf.ListItemReader.s7(h);if(null===A||void 0===A||!A.id)throw v.ULS.sendTraceTag(539787542,393,10,"No list item node with id found under outline element"),Error("No list item node with id found under outline element");h=r.Tw(h);if(!h)throw v.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new Qs(b,
A.id,h)}constructor(b,h,r){this.A3j=b;this.mCn=h;this.Xrg={listType:r.listType,listStyle:r.listStyle,Qhe:r.Jx}}esn(b,h){return h&&b&&this.mCn===b.id&&h.listType===this.Xrg.listType&&h.listStyle===this.Xrg.listStyle&&h.Jx===this.Xrg.Qhe}}Qs.hGd=null;Object(u.a)(Qs,"AutoTriggerTextContext",null,[]);var it;(function(b){b[b.none=0]="none";b[b.Pgp=1]="style1";b[b.Qgp=2]="style2";b[b.Rgp=3]="style3";b[b.Sgp=4]="style4";b[b.Tgp=5]="style5";b[b.rec=6]="bullet";b[b.invalid=42]="invalid"})(it||(it={}));Object(u.b)("ListStyle",
it);const FC={[it.Pgp]:{[1]:"disc",[0]:"decimal"},[it.Qgp]:{[1]:"circle",[0]:"lower-alpha"},[it.Rgp]:{[1]:"square",[0]:"lower-roman"},[it.Sgp]:{[0]:"upper-alpha"},[it.Tgp]:{[0]:"upper-roman"},[it.rec]:{[1]:"bullet"}};var gw;(function(b){b[b.number=0]="number";b[b.rec=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.Ofq=16]="noList";b[b.invalid=42]="invalid"})(gw||(gw={}));Object(u.b)("ListType",gw);class Oq{constructor(b,h){this.eB=this.Abd=null;this.levelText=b;this.font=h}get Qqe(){return this.levelText}get listStyle(){return 6}get Ix(){return"left"}}
Object(u.a)(Oq,"ListMarkerBullet",null,[601]);class Mh{static get Ll(){return null!=Mh.Y0g?Mh.Y0g:Mh.Y0g=$a.a.instance.resolve(31)}static get Nd(){return Mh.kg||(Mh.kg=$a.a.instance.resolve(10))}static set Nd(b){Mh.kg=b}static get tk(){return null!=Mh.MYg?Mh.MYg:Mh.MYg=$a.a.instance.resolve(106)}static wy(){return Mh.ao||(Mh.ao=$a.a.instance.Ra(51))}static get sg(){return ve.a.instance}static get Bc(){return Wg.a.instance}static get Es(){return ch.a.getInstance()}static get Upd(){return null!=Mh.j4g?
Mh.j4g:Mh.j4g=$a.a.instance.Oa(882)}static Wb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.fF,mc.a.view,Mh.ATc);b.qa(ub.a.fF,mc.a.oS,Mh.Qqa);b.Pc(ub.a.fF,1036);b.qa(ub.a.aO,mc.a.view,Mh.ATc);b.qa(ub.a.aO,mc.a.oS,Mh.Qqa);b.Pc(ub.a.aO,1036);b.qa(ub.a.yga,mc.a.view,Mh.ATc);b.qa(ub.a.yga,mc.a.oS,Mh.Qqa);b.Pc(ub.a.yga,1036);b.qa(ub.a.Pif,mc.a.view,kd.ActionManager.$f);b.qa(ub.a.b3h,mc.a.view,kd.ActionManager.$f);b.qa(ub.a.A2f,mc.a.view,Mh.SHo);b.qa(ub.a.Aif,mc.a.view,kd.ActionManager.$f);b.qa(ub.a.Rif,
mc.a.view,kd.ActionManager.$f);b.qa(ub.a.VGg,mc.a.view,kd.ActionManager.$f);b.qa(ub.a.j_j,mc.a.view,kd.ActionManager.$f);b.qa(ub.a.tEe,mc.a.view,kd.ActionManager.$f)}static SHo(){Qs.SGj();return 32}static ATc(b,h,r,A,M){var ba,oa,Ja;if(!h.view.ue)return 2;const jb=Mh.Bc.wq(ub.a.ATc);A.Ft=42;A.tE=42;const zb={[Dq.a.CPa]:5796,[Dq.a.BPa]:5797};var Eb=h.view;if(Object(zl.a)().VIa(Mh.y5m,Eb.lb.Ng))return Mh.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.Grf}),jb.end(),8;if(Object(zl.a)().VIa(Mh.Thf,Eb.lb.Ng))return Mh.Bc.$b(Uf.a.Oe,
{["Reason"]:Ff.a.MWc}),jb.end(),8;if(Object(zl.a)().bFa(Ed.ParagraphReader.IX,Eb.lb.Ng))return Mh.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.cR}),jb.end(),8;if(Mh.sg.Wnc(Eb.lb.Ng))return Mh.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.$G}),jb.end(),8;if(null===(oa=null===(ba=Mh.wy())||void 0===ba?void 0:ba.instance)||void 0===oa?0:oa.KX(h))return Mh.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.C8a}),jb.end(),8;if(1===r)return jb.end(),32;M||(M=new ji.DictionaryPropertySet);if(ch.a.Sgn&&2===r){h=new Qb.GraphTransaction(15);h.Ab(Eb.qd);const {Rla:Sb,
gqb:nc}=Mh.Yuj(b,M);Mh.Ll.Mnp(Eb.lb.gb.currentSelection,Sb,nc);h.dispose();jb.end();return 32}ba=null;if(2===r){ba=new Qb.GraphTransaction(15);ba.Ab(h.view.qd);Mh.gad=!1;oa=wy.OutlineElementGeneralizer.gla(Eb.lb.gb,!1);if(!oa)return ba.dispose(),Mh.Bc.$b(Uf.a.osa,{["Reason"]:Ff.a.s2d}),jb.end(),8;1<oa.length&&M.setValue(Bd.a.vgj,null);const Sb=M.ka(Bd.a.ZL,-1),nc=M.ka(Bd.a.iC,-1);null===(Ja=Mh.Upd)||void 0===Ja?void 0:Ja.mrl(oa);if(Ja=Mh.Z3o(Sb,nc,oa))M.setValue(Bd.a.iC,16),M.setValue(Bd.a.dYa,0);
if(!Le.a.qf(Eb.lb.Ng)&&!Ja&&0<oa.length&&Sb){Eb=new zc.a;Ja=Array(oa.length);for(let Dc=0;Dc<oa.length;Dc++)Eb.set(oa.getContext(Dc).node),Ja[Dc]=Mh.Nd.Tw(Eb);Mh.Y3o(Ja,M)&&(Eb=new ji.DictionaryPropertySet,Eb.setValue(Bd.a.iC,16),Eb.setValue(Bd.a.dYa,0),Eb.setValue(Fe.a.Wta,"clean-list-before-apply-new-list-style"),Eb.setValue(Fe.a.xma,M.ka(Fe.a.Wta,"unknown")+"@"+M.ka(Fe.a.xma,"undefined")),Dq.a.Iua(b,h,r,A,Eb,zb,11),y.AFrameworkApplication.va.Ob(ub.a.j_j,2),v.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),
Mh.gad=!0)}Eb=new zc.a;Eb.set(oa.getContext(0).node);Eb=Mh.Nd.Tw(Eb);Mh.MGn(Sb,nc,Eb,oa.length)}b=Dq.a.Iua(b,h,r,A,M,zb,11);32===b&&M.ka(Bd.a.CVh,!1)&&(b=Dq.a.Iua(ub.a.mR,h,r,A,M,zb,11));ba&&ba.dispose();jb.end();return b}static Y3o(b,h){let r=null;var A=!1;for(let M=b.length-1;0<=M&&(r?(A=b[M],A=-1!==h.ka(Bd.a.ZL,-3)?A?r.listType!==A.listType||r.listStyle!==A.listStyle:!0:A?r.listType!==A.listType:!0):r=b[M],!A);M--);return r&&(b=!1,A||(b=h.ka(Bd.a.iC,42),h=h.ka(Bd.a.ZL,-3),b=b!==r.listType||0<h),
A||b)?!0:!1}static MGn(b,h,r,A){0>=A||Mh.gad||(b?r?(r=r.listType,-1===b&&h===r?(y.AFrameworkApplication.va.Ob(ub.a.tEe,2),v.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!h||1===h)&&(y.AFrameworkApplication.va.Ob(h?ub.a.Aif:ub.a.Rif,2),v.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(y.AFrameworkApplication.va.Ob(h?ub.a.Aif:ub.a.Rif,2),Mh.Iqp(),v.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",
h?"Bullet":"Numbering")):(y.AFrameworkApplication.va.Ob(ub.a.tEe,2),v.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static Z3o(b,h,r){if(-1!==b&&b||!r.length)return!1;b=new zc.a;let A=null;for(let M=r.length-1;0<=M&&!(b.set(r.getContext(M).node),A=Mh.Nd.Tw(b));M--);return A&&h===A.listType?!0:!1}static Qqa(b,h,r,A,M){var ba;if(h.contextId!==mc.a.oS)return 2;var oa=h.clone().QEg();if(Mh.sg.Kab(oa))return Mh.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.$G}),2;oa=new zc.a;
oa.set(h.node);Le.a.yv(oa);Mh.F5f&&Xh.TableCellReader.lga(oa)&&(h=new Map,h.set(fk.a.T9c,(!0).toString()),Mh.Qzj(h));if(!Ua.a.Qh(oa))return 2;if(1===r)switch(b){case ub.a.fF:return 32;case ub.a.aO:return 32;case ub.a.yga:return 32;default:return 2}if(Ua.a.eU(oa))return Mh.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.cR}),2;h=Mh.Nd.Tw(oa);const Ja=Object.freeze(null===h||void 0===h?void 0:h.clone());if(!M)return 8;const {ef:jb,Rla:zb,gqb:Eb}=Mh.Yuj(b,M);Mh.YZo(jb,oa);var Sb=Mh.Ll.Qqa(jb,oa,zb,Eb);if(!Sb.returnValue)return Mh.Bc.$b(Uf.a.Vn,
{["Reason"]:Ff.a.C4f}),2;Sb=Sb.Rla;Mh.Fso(oa,M,Ja,Sb);2===r&&(r=M.ka(Bd.a.iC,-1),Sb&&-1!==r&&((oa=M.ka(Rc.a.$s,"Invalid MultiLevel Type"),b===ub.a.aO&&v.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===M||void 0===M?void 0:M.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:it[null==(null===h||void 0===h?void 0:h.listStyle)?null===Sb||void 0===Sb?void 0:Sb.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:gw[null==
(null===h||void 0===h?void 0:h.listType)?null===Sb||void 0===Sb?void 0:Sb.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===Sb||void 0===Sb?void 0:Sb.listType)})),h)?Sb.listType&&1!==Sb.listType||Mh.gad||(y.AFrameworkApplication.va.Ob(ub.a.VGg,2),v.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",r?"Bullet":"Numbering",oa)):16===Sb.listType?(y.AFrameworkApplication.va.Ob(ub.a.b3h,2),v.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",
r?"Bullet":"Numbering",oa)):Sb.listType&&1!==Sb.listType||Mh.gad||(y.AFrameworkApplication.va.Ob(ub.a.Pif,2),v.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",r?"Bullet":"Numbering",oa))),b=rd.FocusManager.instance(),(null===(ba=null===b||void 0===b?void 0:b.currentScope)||void 0===ba?void 0:ba.name)===Ii.a.kva&&b.aF(pd.AFrame.Jo));A.Ft=Sb.listType;A.tE=Sb.listStyle;return 32}static get F5f(){if(null!=Mh.z1g)var b=Mh.z1g;else{var h;y.AFrameworkApplication.nd("534af766;70gef585");
b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.listWithinTablesLoggingEnabled",!1);b=Mh.z1g=b}return b}static Qzj(b){const h=b.has(fk.a.T9c)?b.get(fk.a.T9c):"false";b=b.has(fk.a.wbe)?b.get(fk.a.wbe):"unknown";const r=new Map;r.set(fk.a.T9c,h);r.set(fk.a.wbe,b);za.Health.instance.recordKpiUsage(fk.a.ibb.uCn,0,fk.a.$B,r)}static Yuj(b,h){let r;b===ub.a.aO||b===ub.a.fF||b===ub.a.yga?(h=Mh.Ll.Q_c(b,h),r=Qu.a.$W(h.getValue(Bd.a.iC),h.getValue(Bd.a.dYa))):
r=null;Mh.E3(b,h);let A=!1;if(!r)return v.ULS.sendTraceTag(508155328,393,50,"Returning null list info from prepareArgsForApplyBulletsNumbering"),{ef:h,Rla:r,gqb:A};Mh.iYo(r,h);b===ub.a.fF&&h&&(h.hasProperty(Rc.a.Yw)&&(r.levelText=h.getValue(Rc.a.Yw)),h.hasProperty(ze.a.font)&&(r.font=h.getValue(ze.a.font)),h.hasProperty(Bd.a.mFf)&&(A=h.getValue(Bd.a.mFf)));return{ef:h,Rla:r,gqb:A}}static Fso(b,h,r,A){var M,ba,oa,Ja,jb,zb,Eb,Sb;const nc=new Map;nc.set("actionCallSource",h.ka(Fe.a.Wta,"unknown"));nc.set("actionCallSourceTrigger",
h.ka(Fe.a.xma,"undefined"));nc.set("fromListType",gw[null!==(M=null===r||void 0===r?void 0:r.listType)&&void 0!==M?M:16]);nc.set("fromListStyle",it[null!==(ba=null===r||void 0===r?void 0:r.listStyle)&&void 0!==ba?ba:0]);nc.set("fromListMarkerType",null!==(jb=l(null!==(oa=null===r||void 0===r?void 0:r.listStyle)&&void 0!==oa?oa:0,null!==(Ja=null===r||void 0===r?void 0:r.listType)&&void 0!==Ja?Ja:16))&&void 0!==jb?jb:"undefined");nc.set("fromLevelText",(null===r||void 0===r?0:r.wBa)?r.levelText:"undefined");
nc.set("toListType",null!==(zb=gw[null===A||void 0===A?void 0:A.listType])&&void 0!==zb?zb:"undefined");nc.set("toListStyle",null!==(Eb=it[null===A||void 0===A?void 0:A.listStyle])&&void 0!==Eb?Eb:"undefined");nc.set("toListMarkerType",null!==(Sb=l(null===A||void 0===A?void 0:A.listStyle,null===A||void 0===A?void 0:A.listType))&&void 0!==Sb?Sb:"undefined");nc.set("toLevelText",(null===A||void 0===A?0:A.wBa)?A.levelText:"undefined");ch.a.csn&&nc.set("underHeaderFooterKind",this.Nd.rzi(b.currentNode));
za.Health.instance.recordKpiUsage(fk.a.ibb.xCn,0,fk.a.$B,nc)}static YZo(b,h){var r=new zc.a;r.kd(h);(h=r.Ub(2))&&Ed.ParagraphReader.Vb(h)&&(r=$f.a.instance.gb.currentSelection)&&r.Qa&&r.Qa.node===h&&Le.a.Ofe(r)&&(Mh.wWo(b),Mh.uWo(b))}static iYo(b,h){h.hasProperty(Rc.a.$s)&&b.Rxe(h.getValue(Rc.a.$s));h.hasProperty(Fe.a.RT)&&(b.RT=h.getValue(Fe.a.RT));h.hasProperty(Rc.a.Yw)&&(b.levelText=h.getValue(Rc.a.Yw));b.ZL=h.ka(Bd.a.ZL,-1);let r=null;b.Ita&&(r=Mh.Lzm(b,h));b.Ita&&r?Mh.SZo(b,r):(b.Ita?v.ULS.sendTraceTag(589091597,
393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.ZL,b.$s,b.$z):v.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),Mh.iVo(b))}static iVo(b){if(b.$z)b.V$d&&-1===b.ZL||(b.levelText="%1.",b.ef.hasProperty(ze.a.e8)||b.zca(0,1));else if(1===b.listType)b.V$d&&-1===b.ZL||(b.font=fk.a.MYc,b.levelText=fk.a.MZd,b.ef.hasProperty(ze.a.e8)||b.zca(1,6));else return;b.Ix="left"}static SZo(b,
h){1===b.$s?Mh.EYo(b,h):Mh.YWo(b,h)}static EYo(b,h){(b.eB=h.eB)?b.n9=h.eB.n9:h.eB||v.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.ZL,b.$s,b.$z)}static YWo(b,h){b.levelText=h.levelText;b.$z?b.zca(0,h.listStyle):(b.font=h.font,b.zca(1,1));b.Ix=h.Ix}static Lzm(b,h){let r=null;2===b.$s?r=b.$z?$a.a.instance.Oa(718):$a.a.instance.Oa(717):1===b.$s&&(r=$a.a.instance.Oa(931));let A=r.ZUb.value;const M=b.ZL+"";
M in A||(A=r.Dba,v.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",M,b.$s,b.$z));if(!(M in A)){v.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",M,b.$s,b.$z);if(h.hasProperty(ze.a.font))return v.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",
M,b.$s,b.$z),b=h.getValue(ze.a.font),new Oq(C.a.fromCharCode(parseInt(M)),b);v.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",M,b.$s,b.$z)}return A[M]}static uWo(b){Mh.tk.hasProperty(ze.a.fontColor)&&b.setValue(ze.a.fontColor,Mh.tk.fontColor())}static wWo(b){Mh.tk.hasProperty(ze.a.fontSize)&&b.setValue(ze.a.fontSize,Mh.tk.fontSize())}static E3(b,h){b=b===ub.a.fF?0:b===ub.a.aO?1:b===ub.a.yga?2:-1;h=h.ka(Bd.a.ZL,-1);
v.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static Iqp(){const b=$a.a.instance.Ra(2);if(b){var h=y.AFrameworkApplication.J.fc("WordDefaultToEditFloodgateDelayInMilliseconds",6E4);b.execute(r=>{window.setTimeout(()=>{r.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else v.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}Mh.y5m=je.a.F9c;Mh.Thf=je.a.bab;Mh.kg=null;Mh.ao=null;Mh.gad=!1;
Object(u.a)(Mh,"ListActor",null,[]);class Wi{static get ir(){return rv.a.DQb}static get sg(){return ve.a.instance}static get Bc(){return Wg.a.instance}static get fq(){return Object(Jb.a)()}static wy(){return Wi.ao||(Wi.ao=$a.a.instance.Ra(51))}static get Z6m(){return null!=Wi.GYg?Wi.GYg:Wi.GYg=$a.a.instance.resolve(932)}static Wb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.XI,mc.a.view,Wi.FTc);b.qa(ub.a.XI,mc.a.oS,Wi.DTh);b.Pc(ub.a.XI,1036);b.qa(ub.a.mR,mc.a.view,Wi.FTc);b.qa(ub.a.mR,mc.a.oS,Wi.DTh);
b.Pc(ub.a.mR,1036)}static yso(b){const h=new Map;b=b?b.ka(Fe.a.ybe,"Unknown"):"tab";h.set("actionCallSource",b);za.Health.instance.recordKpiUsage(ht.ibb.$6m,1,ht.$B,h)}static FTc(b,h,r,A,M){const ba=h.view;if(!ba.ue)return 2;var oa=ba.lb;if(!oa)return Wi.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.Aga}),8;oa=oa.Ng;if(!oa)return Wi.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.Wn}),8;if(Bl.a.dma(h))return 8;if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Wi.sg.Wnc(oa))return Wi.Bc.$b(Uf.a.Oe,
{["Reason"]:Ff.a.$G}),8;if(1===r)return 32;if(Object(zl.a)().VIa(Wi.Thf,oa))return Wi.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.MWc}),8;if(Object(zl.a)().bFa(Ed.ParagraphReader.IX,oa))return Wi.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.cR}),8;if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Wi.sg.Wnc(oa))return Wi.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.$G}),8;if(Wi.wy()&&Wi.wy().instance&&Wi.wy().instance.KX(oa))return Wi.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.C8a}),8;oa={};oa[Dq.a.CPa]=
5794;oa[Dq.a.BPa]=5795;return Wi.Z6m.FTc(ba,b,h,r,A,M,oa)}static DTh(b,h,r,A,M){var ba,oa;if(h.contextId!==mc.a.oS)return 2;var Ja=h.clone().QEg();if(Hi.TableReader.b3i(Ja)){if(Wi.sg.c3i(Ja))return Wi.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.$G}),8}else if(Wi.sg.Kab(Ja))return Wi.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.$G}),2;Ja=new zc.a;Ja.set(h.node);Le.a.yv(Ja);if(!Ua.a.Qh(Ja))return 2;Mh.F5f&&Wi.Sto(M,Ja);let jb;switch(b){case ub.a.XI:jb=Wi.ir.GLb(Ja);break;case ub.a.mR:jb=Wi.ir.Bec(Ja);break;default:return 2}if(1===
r||!jb)return jb?32:8;r=0;b===ub.a.mR&&M&&M.ka(Bd.a.CVh,!1)&&(r|=2);if(Ua.a.eU(Ja))return Wi.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.cR}),2;(null===(oa=null===(ba=Wi.fq)||void 0===ba?void 0:ba.Ad)||void 0===oa?0:oa.LX)&&Wi.fq.Ke&&(Wi.fq.Ke.wK=!0);switch(b){case ub.a.XI:Wi.ir.CZa(Ja,-1,r);break;case ub.a.mR:Wi.ir.bZc(Ja,1)}A&&Lq.a.Tzb&&(A.Ft|=Lq.a.Nqb(h.node,!0));Wi.yso(M);return 32}static Sto(b,h){Xh.TableCellReader.lga(h)&&mf.ListItemReader.Dg(h)&&(b=b?b.ka(Fe.a.ybe,"Unknown"):"Ribbon",h=new Map,h.set(fk.a.wbe,
b),h.set(fk.a.T9c,"true"),Mh.Qzj(h))}}Wi.ao=null;Wi.Thf=je.a.bab;Object(u.a)(Wi,"IndentationActor",null,[]);var Sn=d(1520);class bl{static get sl(){return null!=bl.K2g?bl.K2g:bl.K2g=$a.a.instance.resolve(349)}static get jk(){return null!=bl.p5g?bl.p5g:bl.p5g=$a.a.instance.resolve(32)}static get sg(){return ve.a.instance}static get Bc(){return Wg.a.instance}static wy(){return bl.ao||(bl.ao=$a.a.instance.Ra(51))}static Wb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.nIg,mc.a.view,(h,r)=>Bl.a.dma(r)?
8:32);b.qa(ub.a.V7,mc.a.view,Sn.a.yx);b.qa(ub.a.V7,mc.a.paragraph,bl.gIa);b.qa(ub.a.V7,mc.a.table,bl.cjf);b.Pc(ub.a.V7,1036);b.qa(ub.a.iaa,mc.a.view,Sn.a.yx);b.qa(ub.a.iaa,mc.a.paragraph,bl.gIa);b.qa(ub.a.iaa,mc.a.table,bl.cjf);b.Pc(ub.a.iaa,1036);b.qa(ub.a.D8,mc.a.view,Sn.a.yx);b.qa(ub.a.D8,mc.a.paragraph,bl.gIa);b.qa(ub.a.D8,mc.a.table,bl.cjf);b.Pc(ub.a.D8,1036);b.qa(ub.a.nKa,mc.a.view,Sn.a.yx);b.qa(ub.a.nKa,mc.a.paragraph,bl.gIa);b.Pc(ub.a.nKa,1036);b.qa(ub.a.FZc,mc.a.view,Sn.a.yx);b.qa(ub.a.FZc,
mc.a.paragraph,bl.gIa);b.Pc(ub.a.FZc,1036);b.qa(ub.a.sUb,mc.a.view,Sn.a.yx);b.qa(ub.a.sUb,mc.a.paragraph,bl.gIa);b.Pc(ub.a.sUb,1036);b.qa(ub.a.Eod,mc.a.view,Sn.a.yx);b.qa(ub.a.Eod,mc.a.paragraph,bl.gIa);b.Pc(ub.a.Eod,1036);b.qa(ub.a.Gqc,mc.a.view,Sn.a.yx);b.qa(ub.a.Gqc,mc.a.paragraph,bl.gIa);b.Pc(ub.a.Gqc,1036);b.qa(ub.a.Rec,mc.a.view,Sn.a.yx);b.qa(ub.a.Rec,mc.a.paragraph,bl.gIa);b.Pc(ub.a.Rec,1036);b.qa(ub.a.nwc,mc.a.view,Sn.a.yx);b.qa(ub.a.nwc,mc.a.paragraph,bl.gIa);b.Pc(ub.a.nwc,1036);b.qa(ub.a.rjc,
mc.a.view,Sn.a.yx);b.qa(ub.a.rjc,mc.a.paragraph,bl.gIa);b.Pc(ub.a.rjc,1036)}static cjf(b,h,r,A){let M=!0;if(!h)return 8;Hi.TableReader.b3i(h)?bl.sg.c3i(h)?(bl.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.$G}),M=!1):bl.wy()&&bl.wy().instance&&bl.wy().instance.KX(h)&&(bl.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.C8a}),M=!1):(bl.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.ezf}),M=!1);if(1===r||!M)return M?32:8;h=h.node;switch(b){case ub.a.V7:bl.jk.HH(h,1);break;case ub.a.iaa:bl.jk.HH(h,2);break;case ub.a.D8:bl.jk.HH(h,3)}A&&Lq.a.Tzb&&(A.Ft|=
2);return 32}static gIa(b,h,r,A,M){let ba=!0;h.contextId!==mc.a.paragraph?ba=!1:bl.sg.Kab(h)?(bl.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.$G}),ba=!1):bl.wy()&&bl.wy().instance&&bl.wy().instance.KX(h)&&(bl.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.C8a}),ba=!1);if(1===r||!ba)return ba?32:8;h=h.node;r=Ed.ParagraphReader.Zy(h);switch(b){case ub.a.V7:case ub.a.Gqc:bl.sl.HH(h,1===r&&bl.rge(M)?6:1);break;case ub.a.iaa:case ub.a.Rec:bl.sl.HH(h,2===r&&bl.rge(M)?1:2);break;case ub.a.D8:case ub.a.nwc:bl.sl.HH(h,3===r&&bl.rge(M)?
1:3);break;case ub.a.nKa:case ub.a.rjc:bl.sl.HH(h,6===r&&bl.rge(M)?1:6);break;case ub.a.sUb:bl.sl.HH(h,11);break;case ub.a.FZc:bl.sl.HH(h,7);break;case ub.a.Eod:bl.sl.HH(h,13)}A&&Lq.a.Tzb&&(A.Ft|=Lq.a.Nqb(h));return 32}static rge(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}bl.ao=null;Object(u.a)(bl,"JustificationActor",null,[]);const FE=()=>{const b=y.AFrameworkApplication.va;b.qa(ub.a.save,xe.a.frame,pL);b.qa(ub.a.sync,xe.a.frame,
eJ)},eJ=(b,h,r)=>{if(1===r)return 32;y.AFrameworkApplication.va.Ob(ub.a.Gec,2);df.a.ff.RBe();return 32},pL=(b,h,r)=>{if(1===r)return 2===qa.StaticActiveAppFrame.za().mode?32:8;y.AFrameworkApplication.va.Ob(ub.a.Gec,2);if(2!==qa.StaticActiveAppFrame.za().mode)return 32;df.a.ff.NJj(null,null);return 32};class Hz{constructor(){this.activateRibbonTab=(b,h,r,A,M)=>{df.a.NB.MJ.dmd(M.toString());return 32};this.fAn=(b,h,r,A,M)=>{df.a.NB.MJ.Z4i(1,M.toString());return 32};this.p6n=(b,h)=>{if(h.contextId!==
xe.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Wb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.activateRibbonTab,mc.a.view,this.activateRibbonTab);b.Pc(ub.a.activateRibbonTab,5);b.qa(ub.a.$4i,mc.a.view,this.fAn);b.qa(ub.a.mJg,xe.a.frame,this.p6n)}static get instance(){return null!=Hz.iZg?Hz.iZg:Hz.iZg=Hz.Sm()}static Sm(){return new Hz}}Object(u.a)(Hz,"RibbonActor",null,[]);var dr=d(874);class cx{constructor(b,h){this.In=null;this.kup=(r,A,M,ba,oa)=>{let Ja;ba=A.view;if(!ba.ue)return cx.Bc.$b(Uf.a.Oe,
{["Reason"]:Ff.a.qWb}),8;Ja=r===ub.a.undo?this.rh.j3:this.rh.xWa;if(1===M)return Bl.a.dma(A)&&Bl.a.loc()?8:Ja?32:8;if(!Ja)return v.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",r===ub.a.undo?"undo":"redo"),this.jQa.value.E5j(),cx.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.eup}),2;A=new Qb.GraphTransaction(3);A.Ab(ba.qd);A.Ywe();r=r===ub.a.undo?this.rh.undo():this.rh.kna();A.dispose();oa&&ls.GrippersManager.instance.O2b(oa.fz);if(r)return 32;cx.Bc.$b(Uf.a.khc,{["Reason"]:Ff.a.rhj});
return 8};this.Dqa=b;this.jQa=h}get rh(){return this.In||(this.In=this.Dqa())}Wb(){const b=y.AFrameworkApplication.va,h=this.kup;b.fb(ub.a.undo,mc.a.view,h,1028);b.fb(ub.a.kna,mc.a.view,h,1028)}static get instance(){return null!=cx.RYg?cx.RYg:cx.RYg=cx.Sm()}static Sm(){const b=$a.a.instance;return new cx(()=>b.resolve(50),b.rf(427))}static get Bc(){return Wg.a.instance}}Object(u.a)(cx,"UndoActor",null,[]);const GC={track:!0,b0h:!1,NUd:!1},GE={["InsertTable"]:{NUd:!0},["InsertColumnAfter"]:{NUd:!0},
["InsertRowBelow"]:{NUd:!0}};let Oy;var fJ=d(312);class HC{constructor(){this.Z=null}get name(){return"Box4.Actors"}uc(b){this.Z=b;(new DC).uc(b)}init(){var b=this.Z.resolve(189);Object(Cz.a)()&&this.Z.resolve(933).Wb();b.Wb();b.y8();BE();$t.instance.Wb(Object(tz.a)()?this.Z.resolve(934):null);Hf.Wb();Wi.Wb();bl.Wb();this.Z.resolve(935).Wb();wv.instance.Wb();this.Z.resolve(936).Wb();FE();this.Z.resolve(937).Wb();Hz.instance.Wb();(b=this.Z.Oa(23))?b.Qr.continueWith(()=>{this.ABj()}):this.ABj();dr.a.Wb(df.a.r0a);
this.Z.resolve(938).Wb();cx.instance.Wb();this.Z.resolve(939).jrg();this.Z.resolve(171);this.Z.resolve(940);qa.StaticActiveAppFrame.za().Fe()}ABj(){this.Z.resolve(941).Wb();this.Z.resolve(942).Wb()}dispose(){}static main(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerIsEnabled",!1)&&(ca.a.UTi=b=>{if(b&&window.event){var h=GE[b]||{};if(!Oy){var r=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerWithSelectionContext",
"");Oy=new Set(r.trim().split(/\s+/))}Oy.has(b)&&(h.b0h=!0);h={...GC,...h};if(h.track){b=Object(fJ.b)(window.event,`OtelUserAction - ${b}`);r=$a.a.instance.Oa(943);var A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OtelActionsInteractivityTrackerWithTableContext",!1);h.b0h&&r&&r.GOh(b);A&&h.NUd&&r&&r.Q_k(b)}}});E.a.instance.Mc(new HC)}}Object(u.a)(HC,"Box4ActorsPackage",null,[0,1]);class IG extends Dz{constructor(b,h,r,A){super(b);this.ksa=r;this.Pdb=A;this.APg=0;this.rz=
h.rYa("UserAction","WordOnlineAddToDictionary")}zBg(b){this.J1d=this.ksa.Bsa(b);if(!this.Lpl())return!1;const h=this.J1d.errorDetails.token;this.Pdb.hPh(h);if(!this.Pdb.rrd(h))return v.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;v.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.rz.start();this.transaction=new Qb.GraphTransaction(15);this.transaction.Ab(b.node);return!0}are(b){this.qYb(b.node);
return!0}eid(b){this.qYb(b);return!0}bre(b){this.qYb(b.node)}SHg(b){this.transaction.dispose();this.J1d.errorDetails.iAb(b.actionId);this.Pdb.Wwg("unused corelation id.");this.rz.stop();v.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.APg,this.rz.Hi,this.J1d.errorDetails.proofingType));return!0}Cyc(b,h){const r=b.role;return super.Cyc(b,h)||9===r||10===r||13===r||7===r||8===r}qYb(b){if(b){var h=this.ksa.p7(b,
r=>this.Pdb.rrd(r.errorDetails.token));this.ksa.oxb(b,h,!0);this.APg+=h.length}}Lpl(){var b,h;return null!==(h=null===(b=this.J1d)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(v.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(u.a)(IG,"AddToDictionaryCallbackSteps",Dz,[]);class JG{constructor(b,h,r,A,M,ba,oa){this.Qb=b;this.lb=h;this.Ana=r;this.ksa=A;this.Sp=M;this.Pdb=ba;this.Wko=oa;this.vVm=(Ja,jb,zb,Eb,Sb,nc)=>
{const Dc=new IG(this.Ana,this.Sp,this.ksa,this.Pdb);return new bB(Ja,jb,zb,Eb,Sb,nc,Dc,this.Qb,this.lb,this.Ana,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Wb(){this.Qb.HW(ub.a.ROh,mc.a.view,this.vVm,1124);this.Wko.oyo(this.Pdb)}}Object(u.a)(JG,"PersonalDictionaryOrchestrator",null,[]);class Uu{get name(){return"Box4.PersonalDictionary"}uc(b){this.container=b;b.register(JG,945).ha().Sd(()=>new JG(y.AFrameworkApplication.va,$f.a.instance,Ox.a.instance,b.resolve(43),b.resolve(38),b.resolve(726),
b.resolve(944)))}init(){this.container.resolve(945).Wb()}dispose(){}static main(){xl.a.get_instance().$k(7,()=>{E.a.instance.Mc(new Uu)})}}Object(u.a)(Uu,"PersonalDictionaryPackage",null,[0,1]);var fn=d(104);class Py{constructor(b,h,r,A,M,ba){this.FFa=this.tJ=null;this.jVc=(oa,Ja,jb,zb,Eb)=>this.o2i(Ja,jb,Eb,!1)?32:8;this.YG=(oa,Ja,jb,zb,Eb)=>{if(!({Oz:oa}=this.SSj(Ja,jb,Eb,!0)).returnValue)return oa;v.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");
Eb=this.cRk.mka(Ja.node,Eb);this.Pco(Ja.node,Eb);this.EM();return 32};this.X6a=(oa,Ja,jb,zb,Eb)=>{if(!({Oz:oa}=this.SSj(Ja,jb,Eb,!1)).returnValue)return oa;this.Lco(Ja.node);return 32};this.amo=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;if(!Ja||!Ja.view.ue)return 2;oa=Ja.view.lb;if(!oa)return 2;oa=oa.Ng;if(!oa)return 2;oa=Object(zl.a)().wU(oa,16);if(!oa||!oa.length)return 2;Ja=null;for(jb=0;jb<oa.length;jb++){zb=oa.getContext(jb);if(!zb||zb.contextId!==mc.a.hx)return 2;const Sb={};this.KMi(zb,Sb);if(Sb.CellShading)if(Ja&&
Ja!==Sb.CellShading){Ja=null;break}else Ja=Sb.CellShading;else{Ja=null;break}}Eb.CellShading=Ja;return 32};this.Xwb=(oa,Ja,jb,zb,Eb)=>1===jb?32:this.KMi(Ja,Eb);this.VXb=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;oa=Ja.contextId===mc.a.view?this.okb.IQb(Ja):this.CMf(Ja);jb={};Ja=null;32===y.AFrameworkApplication.va.Pb(ub.a.Xwb,2,jb)&&jb&&(Ja=jb.CellShading);jb="";Ja&&(jb=Yl.a.QB(Ja)||"");this.PRj.sca=jb;this.VP.iBc(jb);oa=this.PRj.mqb(oa,df.a.nUa);if(!oa)return 8;Eb.MenuItems=oa;v.ULS.sendTraceTag(592996034,
340,50,"Cell Shading dropdown menu is opened.");return 32};this.S3=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;qa.StaticActiveAppFrame.za().dismissFloatie();y.AFrameworkApplication.va.Pb(ub.a.Xwb,2,Eb);this.FFa=new Gs("Shading",ub.a.gxc);this.FFa.Wyb(Eb&&Eb.CellShading?Eb.CellShading:0);return 32};this.mol=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;y.AFrameworkApplication.va.Pb(ub.a.G8,2,Eb);this.VP.zTa(Eb)||v.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");
return 32};this.ga=b;this.cRk=h;this.F0e=r;this.okb=A;this.Xd=M;this.oq=ba}get VP(){return null!=this.v3g?this.v3g:this.v3g=$a.a.instance.Oa(790)}get PRj(){this.tJ||(this.tJ=new Ps("Shading"),this.Vfa(this.tJ));return this.tJ}Vfa(b){b.SG(2,ub.a.X6a);b.SG(3,ub.a.G8);b.SG(4,ub.a.G8);b.b6a(this.F0e,1)}Wb(){this.ga.qa(ub.a.VXb,mc.a.view,this.VXb);this.ga.qa(ub.a.VXb,mc.a.hx,this.VXb);this.ga.Pc(ub.a.VXb,1126);this.ga.qa(ub.a.jVc,mc.a.view,dr.a.P1c);this.ga.qa(ub.a.jVc,mc.a.hx,this.jVc);this.ga.Pc(ub.a.jVc,
1028);this.ga.qa(ub.a.G8,mc.a.view,dr.a.P1c);this.ga.qa(ub.a.G8,mc.a.hx,this.YG);this.ga.Pc(ub.a.G8,1028);this.ga.qa(ub.a.X6a,mc.a.view,dr.a.P1c);this.ga.qa(ub.a.X6a,mc.a.hx,this.X6a);this.ga.Pc(ub.a.X6a,1028);this.ga.qa(ub.a.Xwb,mc.a.view,this.amo);this.ga.qa(ub.a.Xwb,mc.a.hx,this.Xwb);this.ga.Pc(ub.a.Xwb,1124);this.ga.qa(ub.a.gxc,mc.a.view,dr.a.P1c);this.ga.qa(ub.a.gxc,mc.a.hx,this.mol);this.ga.Pc(ub.a.gxc,1028);this.ga.qa(ub.a.nig,mc.a.view,this.S3);this.ga.Pc(ub.a.nig,1028)}EM(){y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=$a.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}SSj(b,h,r,A){return this.o2i(b,h,r,A)?{returnValue:2===h,Oz:32}:(2==h&&dr.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],Ff.a.Q6l),{returnValue:!1,Oz:8})}o2i(b,h,r,A){return b.contextId!==mc.a.hx||2===h&&(A&&!r||!b.node)?!1:!0}Pco(b,
h){const r=new Qb.GraphTransaction(15);r.Ab(b);this.AQj(b);b.properties.setValue(ze.a.YG,h);r.dispose()}Lco(b){const h=new Qb.GraphTransaction(15);h.Ab(b);this.AQj(b);b.properties.removeProperty(ze.a.YG);h.dispose()}CMf(b){return b.contextId!==mc.a.hx?null:(b=Object(fn.a)().Nu(b.node))?b:null}AQj(b){if(this.Xd&&this.Xd.Ag&&(b=Object(Ma.a)(Lu.TableCellNode,b))){const h=b.jY();this.oq.Aod(b,h)}}KMi(b,h){if(b.contextId!==mc.a.hx)return 8;(b=b.node)&&b.hasProperty(ze.a.YG)&&(h.CellShading=b.getValue(ze.a.YG));
return 32}static Vlm(){return new Py(y.AFrameworkApplication.va,Pk.a.instance,tn.a.instance,cm.PageReader.instance,$a.a.instance.resolve(46).instance,$a.a.instance.resolve(39).instance)}static get instance(){return null!=Py.k_g?Py.k_g:Py.k_g=Py.Vlm()}}Object(u.a)(Py,"CellShadingActor",null,[]);class hB{constructor(){this.Z=null}get name(){return"Box4.CellShading"}uc(b){this.Z=b}init(){const b=this.Z.Oa(23);b?b.Qr.continueWith(()=>{this.No()}):this.No()}No(){Py.instance.Wb();qa.StaticActiveAppFrame.za().Fe()}dispose(){}}
Object(u.a)(hB,"CellShadingPackage",null,[0,1]);class Iz{constructor(){this.ZUb=new Pf.a(()=>this.Ptf());this.Dba={}}Asi(b){return b}}Object(u.a)(Iz,"AListMarkerGalleryLoader",null,[708]);var Yx=d(1262),Jz=d(339);class hq extends Iz{constructor(){super();this.LFb=new pk.a(Wa.a.vh())}Asi(b){hq.WT||this.fUo();b in hq.WT&&(b=hq.WT[b]);return b}Ptf(){const b={};b["0"]=new Oq(Box4Intl.Box4Strings.L_ListStyleNone,Yx.a.nUi);b["1"]=new Oq(String.fromCharCode(61623),"Symbol");b["2"]=new Oq(String.fromCharCode(111),
"Courier New");b["3"]=new Oq(String.fromCharCode(61607),"Wingdings");b["4"]=new Oq(String.fromCharCode(9643),"Courier New");b["5"]=new Oq(String.fromCharCode(61611),"Wingdings");b["6"]=new Oq(String.fromCharCode(61614),"Symbol");b["7"]=new Oq(String.fromCharCode(61483),"Symbol");b["8"]=new Oq(String.fromCharCode(61485),"Symbol");b["9"]=new Oq(String.fromCharCode(9830),"Courier New");b["10"]=new Oq(String.fromCharCode(61664),"Symbol");b["11"]=new Oq(String.fromCharCode(61558),"Wingdings");b["12"]=
new Oq(String.fromCharCode(61656),"Wingdings");b["13"]=new Oq(String.fromCharCode(61514),"Wingdings");b["14"]=new Oq(String.fromCharCode(61516),"Wingdings");b["15"]=new Oq(String.fromCharCode(61692),"Wingdings");b["16"]=new Oq(String.fromCharCode(61691),"Wingdings");b["17"]=new Oq(String.fromCharCode(61553),"Wingdings");return b}iFe(b){b&&b.length&&this.xmf(b)}nmg(){if(this.Dba){var b=Jz.a(this.Dba),h=b.length;for(let r=0;r<h;r++){const A=this.Dba[b[r]];this.LFb.add(A.levelText+"_"+A.font)}}}xmf(b){this.nmg();
for(const h of b)if(h&&!h.$z&&h.wBa&&h.a6c&&(b=h.levelText+"_"+h.font,!this.LFb.contains(b))){const r=Jz.a(this.Dba).length+Jz.a(this.ZUb.value).length+"";this.Dba[r]=new Oq(h.levelText,h.font);this.LFb.add(b)}}fUo(){hq.WT={};hq.WT["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;hq.WT["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;hq.WT["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;hq.WT["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;hq.WT["Wingdings 0x00ab"]=
Box4Intl.Box4Strings.L_Star;hq.WT["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;hq.WT["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;hq.WT["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;hq.WT["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;hq.WT["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;hq.WT["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;hq.WT["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;hq.WT["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;
hq.WT["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;hq.WT["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;hq.WT["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;hq.WT["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}hq.WT=null;Object(u.a)(hq,"ListMarkerBulletLoader",Iz,[]);class uq{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(u.a)(uq,"InfoAtLevel",null,[]);class Kz{constructor(b){this.eB=b}get font(){return"Calibri"}get listStyle(){return 42}get Ix(){return"left"}get Qqe(){return this.eB?
this.Zho():this.aio()}get Abd(){return this.eB?this.$ho():null}get levelText(){return""}Qtm(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}Zho(){let b="";for(let h=0;3>h;h++)b+=this.x4c(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Kz.PIf(),b)}$ho(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new uq,{textAtLevel:this.YEi(h),styleAtLevel:this.tNm(h)}));return b}aio(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
Kz.QIf(),Box4Intl.Box4Strings.L_ListStyleNone)}YEi(b){b=this.eB.Bbd[b];for(let h=0;9>h;h++)b=C.a.replaceAll(b,"%"+(h+1),this.Qtm(this.eB.bVb[h]));return b}tNm(b){const h={};h.fontFamily=6===this.eB.bVb[b]?this.eB.hKa[b]:this.font;return h}x4c(b){const h=this.YEi(b),r=new Sys.StringBuilder;6===this.eB.bVb[b]&&r.append(String.format("font-family:{0};",this.eB.hKa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,r.toString(),h)}static PIf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static QIf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(u.a)(Kz,"ListMarkerMultilevel",null,[601]);var HE=d(1278);class IC extends Iz{constructor(){super()}Ptf(){const b=new HE.a,h={};h["0"]=new Kz(null);h["1"]=new Kz(b.itf());h["2"]=new Kz(b.cuf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new Kz(b.w9h([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}iFe(){}}Object(u.a)(IC,"ListMarkerMultilevelLoader",Iz,[]);var Jm=d(157);class Pr{constructor(b,h){this.eB=null;this.levelText=b;this.tGd=h}get font(){return"Calibri"}get listStyle(){return this.tGd}get Ix(){switch(this.tGd){case 3:case 5:return"right";default:return"left"}}get Qqe(){switch(this.tGd){case 1:return this.Duc("1",
"2","3");case 2:return this.Duc("a","b","c");case 3:return this.Duc("i","ii","iii");case 4:return this.Duc("A","B","C");case 5:return this.Duc("I","II","III");case 0:return this.bio();default:return this.Duc("1","2","3")}}get Abd(){const b=[],h={};h.fontFamily=Jm.FontUtils.Kza(this.font);switch(this.tGd){case 1:return b.push(Object.assign(new uq,{textAtLevel:this.N_("1"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("2"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new uq,{textAtLevel:this.N_("a"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("b"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new uq,{textAtLevel:this.N_("i"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("ii"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new uq,
{textAtLevel:this.N_("A"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("B"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new uq,{textAtLevel:this.N_("I"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("II"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new uq,{textAtLevel:this.N_("1"),
styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("2"),styleAtLevel:h})),b.push(Object.assign(new uq,{textAtLevel:this.N_("3"),styleAtLevel:h})),b}}Duc(b,h,r){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Pr.PIf(),this.x4c(b),this.x4c(h),this.x4c(r))}bio(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Pr.QIf(),Box4Intl.Box4Strings.L_ListStyleNone)}x4c(b){b=this.N_(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}N_(b){return C.a.replaceAll(this.levelText,"%1",b)}static PIf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static QIf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(u.a)(Pr,"ListMarkerNumbering",null,[601]);class Lz extends Iz{constructor(){super();this.LFb=new pk.a(Wa.a.vh())}Vtn(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}Ptf(){const b=
{};b["0"]=new Pr(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Pr("%1.",5);b["2"]=new Pr("%1.",4);b["3"]=new Pr("%1.",1);b["4"]=new Pr("%1.",2);b["5"]=new Pr("%1.",3);b["6"]=new Pr("%1)",5);b["7"]=new Pr("%1)",4);b["8"]=new Pr("%1)",1);b["9"]=new Pr("%1)",2);b["10"]=new Pr("%1)",3);b["11"]=new Pr("(%1)",5);b["12"]=new Pr("(%1)",4);b["13"]=new Pr("(%1)",1);b["14"]=new Pr("(%1)",2);b["15"]=new Pr("(%1)",3);return b}iFe(b){b&&b.length&&this.xmf(b)}nmg(){if(this.Dba){var b=Jz.a(this.Dba),h=b.length;
for(let r=0;r<h;r++){const A=this.Dba[b[r]];this.LFb.add(A.levelText+"_"+A.listStyle)}}}xmf(b){this.nmg();for(const h of b)if(h&&h.$z&&h.wBa&&this.Vtn(h.levelText)&&h.listStyle&&(b=Yx.a.dGf(h.levelText))){const r=b+"_"+h.listStyle;if(!this.LFb.contains(r)){const A=Jz.a(this.Dba).length+Jz.a(this.ZUb.value).length+"";this.Dba[A]=new Pr(b,h.listStyle)}this.LFb.add(r)}}}Object(u.a)(Lz,"ListMarkerNumberingLoader",Iz,[]);class JC{constructor(){this.Z=null}get name(){return"Box4.ListMarker"}init(){Mh.Wb()}dispose(){}uc(b){this.Z=
b;this.Z.ia(717,()=>new hq).ha();this.Z.ia(718,()=>new Lz).ha();this.Z.ia(931,()=>new IC).ha()}static main(){E.a.instance.Mc(new JC)}}Object(u.a)(JC,"Box4ListMarkerPackage",null,[0,1]);class KC{static get lh(){return ug.a.ry(KC.Qn,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}KC.Qn="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(u.a)(KC,"DefineNewBulletDialogHtml",null,[]);class Ht extends ug.a{constructor(b,h,r,A){super();this.dLc=this.N_e=this.c9b=this.U8b=null;this.uGb=0;this.UTc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.BRi=!0;this.pQl=M=>{if(this.U8b&&M.target!==this.U8b){const ba=this.focusManager.gu();ba&&ba.Tk&&(ba.Tk.oA(M.target),this.U8b=M.target)}this.b5n(M.target.id)};this.iCn=M=>{M=M.Ef;if(!this.j4i(M))return!1;this.focusManager.gu().Tk.oA(M);M.focus();return!0};this.jCn=M=>{var ba=
M.Ef;if(!this.j4i(ba))return!1;var oa=ba.id;oa=parseInt(oa.substr(oa.lastIndexOf("_")+1))-this.uGb;if(M.Nb.ctrlKey||M.Nb.altKey||M.Nb.keyCode>=rf.a.$3b&&M.Nb.keyCode<=rf.a.a4b)return!1;const Ja=M.Nb.keyCode;if(M.eventName===zd.a.kj){M=-1;if(Ja===Sys.UI.Key.enter)return this.focusManager.gu().Tk.oA(ba),ba.focus(),this.Ilj(ba.id),this.hide(),!0;Ja===Sys.UI.Key.up?M=oa-17:Ja===Sys.UI.Key.down?M=oa+17:Ja===Sys.UI.Key.left?M=y.AFrameworkApplication.isRtl?oa+1:oa-1:Ja===Sys.UI.Key.right&&(M=y.AFrameworkApplication.isRtl?
oa-1:oa+1);0<=M&&(ba=this.zBi(Ht.Lgc+"_"+(M+this.uGb)))&&ba.focus()}return!0};this.oQl=M=>{1===M&&this.Ilj(this.c9b);this.hide()};this.Fv=b;this.focusManager=h;this.ga=r;this.cW=!1;A&&(b=A.indexOf(","),-1!==b&&(A=A.substring(0,b)));this.fontName=A;this.Pg="DefineNewBulletDialog";this.lh=KC.lh;this.Qe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Qe(0,CommonUIStrings.l_DialogClose);this.gi(Box4Intl.Box4Strings.L_SymbolSingle,this.oQl,null);this.zda=!1;this.vNa();document.getElementById(Ht.a4d).focus()}vNa(){this.focusManager.gu().scope.qt(rd.FocusManager.instance().LZ);
this.focusManager.gu().scope.qt(rd.FocusManager.instance().MZ);this.focusManager.gu().scope.bindAction(rd.FocusManager.instance().LZ,ub.a.ZZd);this.focusManager.gu().scope.bindAction(rd.FocusManager.instance().MZ,ub.a.YZd)}Pba(){this.ZTd(Ht.a4d,"DefineNewBulletFontPlaceholder",ub.a.XZd.toString(),ub.a.DYb.toString(),ub.a.yhd.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.Zgl()}$N(){super.$N();document.getElementById(this.Ej("WACDialogPanel")).style.width="auto"}ZTd(b,h,r,A,M,ba,oa){r=Nk.c(b,
r,!0,!0,A,M,C.a.If(ba),!0,oa);this.yYd(b,h,r,"Medium")}Zgl(){const b=document.getElementById(Ht.Lgc);b&&(b.innerHTML=this.Ywi(),this.jBj(b))}jBj(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)uf.a.addHandler(b[h],zd.a.focus,this.pQl)}Qyp(){var b=document.getElementById(Ht.Lgc);if(b){let h=this.fontName;const r=Yx.a.FXf(this.fontName);r&&61472!==this.uGb||!r&&32!==this.uGb?(b.innerHTML=this.Ywi(),this.jBj(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.lOh(h),b[0].style.fontFamily=h)}}b5n(b){this.jPj(this.c9b,!1);this.c9b=b;this.jPj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.c9b){let h=parseInt(this.c9b.substr(this.c9b.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.uGb?61440:0,b.innerText=C.a.QJ(h,4))}}jPj(b,h){(b=this.zBi(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}zBi(b){const h=document.getElementById(Ht.Lgc);return h?h.querySelector("#"+b):null}$qa(){const b=document.getElementById(Ht.Lgc);
b&&(this.N_e||(this.N_e=this.iCn,this.ur.nb(zd.a.click,b,this.N_e)),this.dLc||(this.dLc=this.jCn,this.oe.nb(zd.a.kj,b,this.dLc),this.oe.nb(zd.a.rv,b,this.dLc),this.oe.nb(zd.a.hi,b,this.dLc)));super.$qa()}j4i(b){return b.classList.contains("DefineNewBulletTableCell")}Ilj(b){if(b){b=b.split("_");const h=new ji.DictionaryPropertySet;h.setValue(Bd.a.ZL,parseInt(b[1]));h.setValue(ze.a.font,this.fontName);h.setValue(Bd.a.iC,1);h.setValue(Fe.a.Wta,"command-ui");h.setValue(Fe.a.xma,"define-new-bullet-dialog");
this.ga.Pb(ub.a.fF,2,h)}this.focusManager.WN(this.pN,!0)}Ywi(){const b=new Sys.StringBuilder,h=Yx.a.FXf(this.fontName);let r=this.fontName;r=this.lOh(r);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',r));h?(this.uGb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.uGb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}lOh(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}yYd(b,h,r,A){h=document.getElementById(h);this.Fv.V5a(b,r);r=this.Fv.RPb(b,A);h.appendChild(r);this.Fv.Oua(b)}dispose(){this.cW||(this.Fv.K0(Ht.a4d),this.cW=!0);super.dispose()}}Ht.a4d="DefineNewBulletFontStyleComboBox";Ht.Lgc="DefineNewBulletTableContainer";Object(u.a)(Ht,"DefineNewBulletDialog",ug.a,[]);class Vu{S3c(){return ub.a.dCn}w4c(){return ub.a.Flg}}Object(u.a)(Vu,"ListMarkerGalleryBulletCommands",
null,[444]);class LC{S3c(){return ub.a.fCn}w4c(){return ub.a.dfo}}Object(u.a)(LC,"ListMarkerGalleryMultilevelCommands",null,[444]);class KG{S3c(){return ub.a.gCn}w4c(){return ub.a.Glg}}Object(u.a)(KG,"ListMarkerGalleryNumberingCommands",null,[444]);class ih{constructor(b,h,r,A,M){this.TFa=this.SRa=null;this.Udi=ba=>{if(!this.TFa)return 2;if(this.TFa.focusManager.gu().Tk.Hra.id.startsWith(Ht.Lgc)){let oa=null;ba===ub.a.ZZd?oa=this.TFa.D6a:ba===ub.a.YZd&&(oa=document.getElementById(Ht.a4d));if(!oa)return 2;
this.TFa.focusManager.gu().Tk.oA(oa);oa.focus()}else if(ba===ub.a.ZZd)this.TFa.focusManager.gu().Rrc();else if(ba===ub.a.YZd)this.TFa.focusManager.gu().Prc();else return 2;return 32};this.A7i=(ba,oa)=>{ba=null;oa.view.ue&&(ba=oa.view);return ba&&ba.lb?32:(Tc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",oa.toString()),8)};this.Nzn=(ba,oa,Ja)=>1===Ja?32:2===Ja?(ba=this.jlc(oa),ba=xa.FormattingReader.Us(ba).cache.wI,
this.TFa=new Ht(this.oPk,rd.FocusManager.instance(),y.AFrameworkApplication.va,ba),32):8;this.yhd=(ba,oa,Ja,jb,zb)=>{if(1===Ja)return 32;if(2===Ja&&!zb)return 8;if(this.TFa.BRi){for(ba=0;ba<Yx.a.UTc.length;ba++)Jm.FontUtils.Y4j(Yx.a.UTc[ba]);this.TFa.BRi=!1}zn.a.Jbe(oa);zb.PopulationXML=Jm.FontUtils.gsi(zn.a.oze,zn.a.BFf,ub.a.XZd);return 32};this.cfo=(ba,oa,Ja,jb,zb)=>{ba=oa.contextId===mc.a.oS;if(1===Ja||!ba)return ba?32:8;if(2===Ja&&!zb)return 8;zb.MenuItems=this.BEk.Pzm();return 32};this.nQl=(ba,
oa,Ja,jb,zb)=>{if(1===Ja)return 32;if(2===Ja){ba=Object(Ma.a)(13,zb);if(!ba||!ba.td)return 8;this.TFa.fontName=ba.td.fontName;this.TFa.Qyp();return 32}return 8};this.ga=b;this.kg=A.resolve(10);this.l$=h;this.oPk=r;switch(this.l$){case 0:b=A.resolve(717);this.SRa=new Vu;break;case 1:b=A.resolve(718);this.SRa=new KG;break;case 2:b=A.resolve(931);this.SRa=new LC;break;default:b=A.resolve(717),this.SRa=new Vu}M=this.kg?this.kg.Czm(M):null;b.iFe(M);this.BEk=new Yx.a(h,b,M,!!y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Hb.WTb)}Wb(){this.ga.qa(this.SRa.w4c(),mc.a.view,df.a.r0a.R9h(11));this.ga.qa(this.SRa.w4c(),mc.a.oS,this.cfo);this.ga.Pc(this.SRa.w4c(),1124);this.l$||(this.ga.fb(ub.a.D3f,mc.a.view,this.Nzn,1028),this.ga.fb(ub.a.yhd,mc.a.view,this.yhd,1124),this.ga.fb(ub.a.XZd,mc.a.view,this.nQl,1028),this.ga.fb(ub.a.ZZd,xe.a.frame,this.Udi,64),this.ga.fb(ub.a.YZd,xe.a.frame,this.Udi,64));this.ga.qa(this.SRa.S3c(),mc.a.view,this.A7i);this.ga.qa(this.SRa.S3c(),mc.a.oS,this.A7i);this.ga.Pc(this.SRa.S3c(),
1124)}jlc(b){return this.u5d(b).Qa}u5d(b){let h=null;b=b.view;return b?h=Le.a.yk(b.lb.gb.K(0),!1,!1):h}}Object(u.a)(ih,"ListMarkerGalleryActor",null,[408]);class LG{constructor(){this.Sf=this.Z=null}get name(){return"Box4.ListMarkerGallery"}init(){if(Object(Jb.a)()){var b=Object(Jb.a)();b.Ke&&(this.Sf=b.Ke.qd,this.fxo())}}dispose(){}uc(b){this.Z=b}fxo(){(new ih(y.AFrameworkApplication.va,1,this.Z.resolve(48).Cha,this.Z,this.Sf)).Wb();(new ih(y.AFrameworkApplication.va,0,this.Z.resolve(48).Cha,this.Z,
this.Sf)).Wb();(new ih(y.AFrameworkApplication.va,2,this.Z.resolve(48).Cha,this.Z,this.Sf)).Wb()}static main(){E.a.instance.Mc(new LG)}}Object(u.a)(LG,"Box4ListMarkerGalleryPackage",null,[0,1]);var Mz=d(498),iB=d(634),gJ=d(556),jt=d(169);const hJ=b=>{b.element.style.top=""};var op=d(713);class IE{constructor(b,h,r){this.HJ=!1;this.Qhb=0;this.Dia=this.myh=null;this.ZWn=A=>{A.element.style.top="";y.AFrameworkApplication.ta.ved()};this.RWn=A=>{A.element.parentNode.removeChild(A.element);this.htmlElement.hasChildNodes()||
this.set_visible(!1);y.AFrameworkApplication.ta.ved()};this.Vv=()=>{const A=this.Ut.entries.length,M=Sys.UI.DomElement.getBounds(this.htmlElement).height;let ba;for(let oa=0;oa<A;++oa)ba=this.Ut.entries[oa],ba.htmlElement&&ba.fHj();this.Qhb=Sys.UI.DomElement.getBounds(this.htmlElement).height;M!==this.Qhb&&this.L2b()};this.XIa=()=>!0;this.nl=b;this.tQk=h;this.Ut=r;this.d$=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.ay=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.A3)&&
!this.Ut.syf&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";X.a.yj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.d$}get visible(){return this.HJ}set_visible(b){if(this.HJ!==b)return(this.HJ=b)?this.Rjf():this.fZc(),b}dispose(){this.visible&&this.fZc();xd.a.ZT(this.htmlElement);this.nl=this.d$=null}DUj(b,h){const r=b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(r):
this.htmlElement.insertBefore(r,this.htmlElement.childNodes[h]);b.fHj();this.Qhb+=b.htmlElement.clientHeight;var A=this.htmlElement.childNodes,M=b.CRh,ba=this.ZWn;jt.WacAirSpace.vY(r,"Shared_BasicClass");var oa=new gJ.a(r);oa.$ya(0,1);const Ja=new iB.a(r);Ja.bIa(r.clientTop-30,r.clientTop);M?(jt.WacAirSpace.jvb(oa,null,null),jt.WacAirSpace.jvb(Ja,null,ba)):(jt.WacAirSpace.animate(oa,null,null),jt.WacAirSpace.animate(Ja,null,ba));for(h+=1;h<A.length;h++)ba=A[h],jt.WacAirSpace.vY(ba,"Shared_BasicClass"),
oa=new iB.a(ba),oa.bIa(ba.clientTop-r.clientHeight,ba.clientTop),M?jt.WacAirSpace.jvb(oa,null,null):jt.WacAirSpace.animate(oa,null,null);b.g9o();this.set_visible(!0)}POi(b){const h=b.htmlElement;if(xd.a.Aoc(h)){this.Qhb-=b.htmlElement.clientHeight;var r=h.parentNode.children;b=b.CRh;var A=this.RWn;jt.WacAirSpace.vY(h,"Shared_BasicClass");var M=new Mz.a(h);M.$ya(1,0);b?jt.WacAirSpace.jvb(M,null,A):jt.WacAirSpace.animate(M,null,A);A=!1;for(M=0;M<r.length;M++){if(A){const ba=r[M];jt.WacAirSpace.vY(ba,
"Shared_BasicClass");const oa=new iB.a(ba);oa.bIa(ba.clientTop,-h.clientHeight);b?jt.WacAirSpace.jvb(oa,null,hJ):jt.WacAirSpace.animate(oa,null,hJ)}A||r[M]!==h||(A=!0)}}}Rjf(){""===this.nl.style.top.trim()&&(this.nl.style.top=this.nl.offsetTop+"px");this.htmlElement.style.left=this.nl.style.left;this.htmlElement.style.top=this.nl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.myh=this.nl.style.top;
this.Qhb=b.height;this.L2b();y.AFrameworkApplication.ta.o2(this.Vv);uf.a.addHandler(this.htmlElement,zd.a.vwe,uf.a.Fec);this.Dia=this.XIa;y.AFrameworkApplication.ta.FEa.nb(this.htmlElement,this.Dia,null);if(rd.FocusManager.BM()){var h=rd.FocusManager.instance();b=h.ie(op.a.ZTa);b.parent=pd.AFrame.Kq;const r=new He.DOMFocusListing(()=>this.htmlElement);r.un(1);r.un(2);r.un(8);h.gra(()=>this.htmlElement,b,r);h=h.getRegion(op.a.ZTa);h.WZa();h.BP=!0;h.l7a=!0;const A=y.AFrameworkApplication.ta.Jy;b.fKb(()=>
{A.Cx(op.a.ZTa)});A.IW(op.a.ZTa);(r.dla||y.AFrameworkApplication.J.$("ReactBusinessBarIsEnabled"))&&A.eL(op.a.ZTa)}}fZc(){this.iUj()&&(this.nl.style.top=this.myh);this.htmlElement.style.visibility="hidden";y.AFrameworkApplication.ta&&(rd.FocusManager.BM()&&rd.FocusManager.instance().pxb(op.a.ZTa),this.Dia&&(y.AFrameworkApplication.ta.FEa.xc(this.htmlElement,this.Dia),this.Dia=null));uf.a.removeHandler(this.htmlElement,zd.a.vwe,uf.a.Fec)}L2b(){if(this.iUj()&&this.visible){var b=this.nl,h=this.Qhb+
this.tQk;const r=xd.a.OP(b.style.top);jt.WacAirSpace.vY(b,"Shared_BasicClass");b=new iB.a(b);b.bIa(r,h);jt.WacAirSpace.animate(b,null,null)}}iUj(){return!this.ay&&!this.Ut.syf}}Object(u.a)(IE,"BusinessBarDom",null,[1979,11]);var Pq;(function(b){b[b.none=0]="none";b[b.pZp=1]="corruptPage";b[b.IZp=2]="currentPageStatus";b[b.W_p=3]="documentMarkedAsFinal";b[b.c0p=4]="documentSigned";b[b.E2p=5]="fileAccess";b[b.C8p=6]="kickoutWithDataLoss";b[b.YU=7]="lostSession";b[b.$9p=8]="malformedHyperlinkUris";b[b.Fij=
9]="odt";b[b.Xjq=10]="readonlyRecommended";b[b.fmq=11]="saveReplaySuccess";b[b.emq=12]="saveReplayFailed";b[b.gwp=13]="unsupportedObjects";b[b.atq=14]="word11Compat";b[b.Wrq=15]="unsupportedBrowser";b[b.eWp=16]="applicationNotification";b[b.xoq=17]="skypeDocChatFailed";b[b.Tnq=18]="showDialogInNewWindowInfo";b[b.aTo=19]="sessionExpired";b[b.Cfn=20]="irmPolicyDescription";b[b.Xiq=21]="policyWarningMessage";b[b.Hqq=22]="thirdPartyAddinDisabled";b[b.Q3p=23]="gdprPrivacyNotice";b[b.ZZp=24]="datacenterDecommissionWarning";
b[b.U4p=25]="graphMergePrompt";b[b.Tjq=26]="readOnlyDocument";b[b.D_p=27]="dictationSilence";b[b.tWp=28]="autoSensitivityLabel";b[b.ekq=29]="recommendedSensitivityLabel";b[b.C_p=30]="dictationDebugInfo";b[b.Hhq=31]="oneNoteCovid19Message";b[b.WXp=32]="citationStylePrompt";b[b.Nhq=33]="oneNoteViewModeMessage";b[b.Mhq=34]="oneNotePrintImagesDownloading";b[b.Lhq=35]="oneNotePagePrintReady";b[b.d8p=36]="irmPolicyCausedFeatureDisabled";b[b.b$p=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.K$p=
39]="minorVersionLimit";b[b.eqq=40]="testEntry1";b[b.fqq=41]="testEntry2";b[b.gqq=42]="testEntry3";b[b.hqq=43]="testEntry4";b[b.iqq=44]="testEntry5";b[b.jqq=45]="testEntry6";b[b.kqq=46]="testEntry7"})(Pq||(Pq={}));Object(u.b)("BusinessBarId",Pq);class ps{constructor(b,h=0,r=null,A=null){this.fqh=this.kfh=!1;this.w$b=null;this.JC=[];this.A1a=A||new IE(b,h,this);this.l$m(r)}l$m(b){if(b){this.w$b={};b=b.ranking;for(let h=0;h<b.length;h++)this.w$b[Pq[b[h]]]=h}}dispose(){this.A1a.dispose();lm.a.Hwg(this.JC);
this.JC=null}get htmlElement(){return this.A1a.htmlElement}get visible(){return this.A1a.visible}get syf(){return this.kfh}set syf(b){this.kfh=b}get x0f(){return this.fqh}set x0f(b){this.fqh=b}get entries(){return this.JC}set entries(b){this.JC=b}J7(b){for(let h=0;h<this.JC.length;h++)if(this.JC[h].id===b)return!0;return!1}Pz(b,h=!1,r=null,A=null,M=null){b.$Q=this;let ba=this.rxm(b.id);h&&!this.w$b&&(ba=0);ba<ps.LVb&&(this.A1a.DUj(b,ba),this.JC.length>=ps.LVb&&this.A1a.POi(this.JC[ps.LVb-1]),this.A1a.L2b());
Array.insert(this.JC,ba,b);v.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Pq[b.id],void 0===b.m7a||null===b.m7a?"":b.m7a);b.errorCode&&y.AFrameworkApplication.wS(b.errorCode,r,A,M)}removeEntry(b){const h=Array.indexOf(this.JC,b);-1!==h&&h<ps.LVb&&(this.JC.length>ps.LVb&&this.A1a.DUj(this.JC[ps.LVb],ps.LVb),this.A1a.POi(b),this.A1a.L2b());Array.remove(this.JC,b);b.$Q=null;b.dispose()}rxm(b){if(!this.w$b||0===b)return this.JC.length;b=this.w$b[Pq[b]];if(void 0===
b||null===b)return this.JC.length;for(let h=0;h<this.JC.length;h++)if(b<this.w$b[Pq[this.JC[h].id]])return h;return this.JC.length}}ps.LVb=2;Object(u.a)(ps,"BusinessBar",null,[1959,11,1960]);class xv{create(b,h,r){return new ng.a(b,h,r)}}Object(u.a)(xv,"Factory",null,[1978]);class MC{static xzl(b,h){b.register(ps,1192).as(447).ha().Sd(()=>new ps(h.value,0,b.Oa(946)));b.register(xv,"CommonUI.BusinessBarEntry.Factory").as(813).ha()}}Object(u.a)(MC,"CommonUIComponentConfiguration",null,[]);var MG=d(1662);
class uu extends MG.a{constructor(){super()}static get instance(){return uu._instance||uu.FVf()}static FVf(){uu._instance=new uu;return uu._instance}}uu._instance=null;Object(u.a)(uu,"ReactRootManager",MG.a,[383,384]);class Qy extends Pj.a{constructor(){super()}get ControlType(){return 3}}Object(u.a)(Qy,"CompoundButtonProps",Pj.a,[]);class Ry{constructor(b,h,r,A,M,ba,oa){this.EZ=h;this.NOc=b;this.ooh=h.Yjn;this.w8b=h.C$c;this.tXe=ba;this.rDd=A;this.sDd=M;this.mDd=r;this.QM=oa;this.cjb=new yf.a;this.cjb.W(1,
"SpellingIssue_16x16x32");this.cjb.W(2,"GrammarIssue_16x16x32");this.cjb.W(3,"WritingIssue_16x16x32");this.cjb.W(4,null);this.cjb.W(0,null)}create(b,h,r){h=Object(Ma.a)(vn.a,h);if(!h)return v.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const A=new Sys.StringBuilder;b=this.XAi(b);this.gYc(A,h,r,b);this.Htf(A,h);this.mKl(A,h,b);return A.toString()}QMb(b,h,r){const A=Object(Ma.a)(vn.a,h);if(!A)return v.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),
[];h=[];b=this.XAi(b);this.vuf(h,A,r,b);this.Itf(h,A);this.nKl(h,A,b);for(r=0;r<h.length;r++)h[r].Id=`${ew.Lii}_${r}`;return h}gYc(b,h,r,A=null){h.errorType?1===h.errorType&&(this.gic(h)||b.append(this.tmf(h,r,A))):b.append(this.NOc.build())}vuf(b,h,r,A=null){h.errorType?1===h.errorType&&(this.gic(h)||b.push(this.Wgl(h,r,A))):b.push(this.NOc.dYh())}Htf(b,h){const r=new Sys.StringBuilder;this.xVj(h)?r.append(Nk.a("btnIgnoreAllSpellingError",(2===h.errorType?ub.a.jPa:ub.a.Xsa).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,
null)):this.gic(h)||r.append(Nk.a("btnIgrnoreSpellingError",this.Pzi(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.DVj(h)&&(this.EZ.vXi&&r.append(Nk.a("btnDoNotCheckForThisIssue",ub.a.PNb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),r.append(Nk.a("btnGrammarOptions",ub.a.mwb.toString(),C.a.If(Box4Intl.Box4Strings.l_GrammarOptions),null)));r.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(r.toString()),
b.append("</Controls></MenuSection>"))}Itf(b,h){const r=Object.assign(new xh.a,{ControlList:[]});if(this.xVj(h)){var A=Su.xD()?Object.assign(new Pj.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:ub.a.Xsa,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new Pj.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});r.ControlList.push(A)}else this.gic(h)||(A=Object.assign(new Pj.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.Pzi(h.errorType).toString(),
LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),r.ControlList.push(A));this.DVj(h)&&(this.EZ.vXi&&(h=Object.assign(new Pj.a,{ExternalId:"DoNotCheckForThisIssue"}),r.ControlList.push(h)),h=Object.assign(new Pj.a,{ExternalId:"GrammerSettingsContext"}),r.ControlList.push(h));b.push(r)}XAi(b){if(!this.QM)return null;b=this.QM.language(this.QM.Us(b.Qa));return Ag.a.Hg(b)?Ag.a.Hg(b).name:null}Pzi(b){return 2===b?ub.a.jPa:this.EZ.$mn?ub.a.h5m:ub.a.BBa}mKl(b,h,r=null){if(this.aCg(h)){var A=C.a.If(h.Du.CategoryTitle);
A=Nk.m(ew.Iuc,La.a.Yya,this.cjb.K(h.proofingType),""!==A?A:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.rDd,this.sDd);A=Nk.d("cgProofingOuter",[A]);b.clear();b.append(Nk.g("msProofingOuter",A,"Menu16",void 0,void 0,r,"ariaLabelledById"));v.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}nKl(b,h,r=null){if(this.aCg(h)){var A=C.a.If(h.Du.CategoryTitle);r=Object.assign(new gh.a,{ExternalId:String.format("{0}_{1}",
ew.Iuc,h.proofingType),Command:La.a.Yya.toString(),Image16by16Class:this.cjb.K(h.proofingType),LabelText:""!==A?A:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:r,Menu:Object.assign(new Xe.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.wjm(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});r.Menu.MenuSectionList.push(...b);Array.clear(b);A=Object.assign(new xh.a,{ControlList:[]});A.ControlList.push(r);
b.push(A);v.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}tmf(b,h,r=null){const A=this.jsm(b);var M=[];let ba=!1;var oa=b.Du.Suggestions;if(oa)if(oa=oa.slice(0,Math.min(3,oa.length)),this.ooh&&(ba=!Ye.a.any(oa,Ja=>!Ja||!Ja.Description)),1!==oa.length||oa[0].Action){let Ja=0,jb=null;ba&&(jb="font-weight: bold;");for(const zb of oa){if(!zb)continue;oa=null;let Eb="";const Sb=C.a.If(zb.Text);ba&&(oa=this.qui(zb.Description),Eb=this.pui(zb.Description));
M.push(Nk.a("btnCorrectWord"+Ja,h[Ja].toString(),Sb,null,null,null,null,null,jb,null,oa,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,A,Sb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.f8h(b.token)),"ariaDescribedById",Eb));Ja++}}else h=C.a.If(oa[0].Text),M.push(Nk.a("btnCorrectWord0",ub.a.jPa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,
A,h)));h="Menu16";0<M.length?ba&&(h="Menu16DescriptionEnabled"):M=[Nk.a("btnNoSuggestions",ub.a.jPa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return Nk.g("msUnknownWord",Nk.d(null,M),h,A,this.RAm(b),r,"ariaLabelledById")}Wgl(b,h,r=null){var A=1!==b.proofingType&&0!==b.proofingType?b.Du.ExplanationTitle:"";A=Object.assign(new xh.a,{Title:A,Lang:r,ControlList:[]});let M=!1;var ba=b.Du.Suggestions;if(ba)if(ba=ba.slice(0,Math.min(3,ba.length)),this.ooh&&(M=!Ye.a.any(ba,oa=>!oa||!oa.Description)),
1!==ba.length||ba[0].Action){let oa=0;for(const Ja of ba){if(!Ja)continue;ba=null;let jb="";M&&(ba=this.qui(Ja.Description),jb=this.pui(Ja.Description));if(oa>=h.length)break;ba?(ba=Object.assign(new Qy,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",oa,b.proofingType),Command:h[oa].toString(),LabelText:Ja.Text,Description:ba,Lang:r,AriaDescription:jb}),A.ControlList.push(ba)):(ba=Object.assign(new Pj.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",oa,b.proofingType),
Command:h[oa].toString(),LabelText:Ja.Text,Lang:r,RoleInMenu:"menuitem"}),A.ControlList.push(ba));oa++}}else b=ba[0],b=Object.assign(new Pj.a,{ExternalId:"NoSuggestion",Command:ub.a.jPa.toString(),LabelText:b.Text}),A.ControlList.push(b);0>=A.ControlList.length&&A.ControlList.push(Object.assign(new Pj.a,{ExternalId:"btnNoSuggestions",Command:ub.a.jPa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return A}jsm(b){return C.a.If(0!==b.proofingType?b.Du.ExplanationTitle:"")}RAm(b){return this.aCg(b)?
null:this.cjb.K(b.proofingType)}aCg(b){return this.w8b&&2!==b.errorType&&(1!==b.errorType||!this.gic(b))}xVj(b){return this.tXe&&!!b.errorType&&1===b.proofingType&&!this.gic(b)}wjm(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.f8h(b.token)):""}DVj(b){return this.EZ.wfe&&this.w8b&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}gic(b){return!!b.errorType&&!!this.mDd&&this.mDd.contains(b.token,b.lcid)}qui(b){return""===
b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}pui(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}f8h(b){let h="";if(b){let r;for(r=0;r<b.length-1;r++)h=h+b.charAt(r)+",";h+=b.charAt(r)}return h}}Object(u.a)(Ry,"EditorServiceProofingContextMenuCreator",null,[]);class hw{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(u.a)(hw,
"BusinessBarRankProvider",null,[406]);class Wu{constructor(){this.Z=null}get name(){return"Wonca.UI"}uc(b){this.Z=b;b.ia(946,()=>new hw).ha();MC.xzl(b,new Pf.a(()=>qa.StaticActiveAppFrame.za().Mka));b.ia(831,()=>new Ry(b.resolve(829),b.resolve(41),b.resolve(652),y.AFrameworkApplication.Nfa,y.AFrameworkApplication.Vs,y.AFrameworkApplication.J.$("WordEditorProofingIgnoreAll"),b.resolve(387))).ha();b.ia("CommandUI.ReactRootManager",()=>uu.instance).as(708).ha()}init(){this.Z.resolve(453);this.Z.resolve(447)}dispose(){}static main(){E.a.instance.Mc(new Wu)}}
Object(u.a)(Wu,"WoncaUIPackage",null,[0,1]);class NG{constructor(b){this.BQ=this.PMc=null;this.Gp=b}get key(){return"BOOKMARK"}get Jv(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get iP(){return this.BQ}reset(b){this.BQ=b.node}MEa(b){let h=null;if(this.PMc&&this.Gp.RWi(b,this.iP,this.PMc))return h=Object.assign(new Ow.a,{fG:this.key,contentObject:this.PMc}),{returnValue:!0,OG:h};this.PMc=null;if(!this.iP.hasBookmark)return{returnValue:!1,OG:h};const r=new zc.a;r.set(this.iP.Lj());this.Gp.Pdd(r);
if(this.Gp.chn(r)){let A=r.$d();for(;A;){if(this.Gp.RWi(b,this.iP,A))return this.PMc=A,h=Object.assign(new Ow.a,{fG:this.key,contentObject:A,description:this.MVa()}),{returnValue:!0,OG:h};A=r.Mk()}}return{returnValue:!1,OG:h}}MVa(){return null}}Object(u.a)(NG,"BookmarkDetailsProvider",null,[144,136]);class iJ{constructor(b,h,r,A,M=null){this.Mnh=this.vi=!1;this.yHd=this.$Id=null;this.Rjj=(ba,oa)=>{ba=oa.node;ba.wc!==rn.a.kza?v.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",ba.wc):(v.ULS.sendTraceTag(24155019,
324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.tki(!0))};this.FG=r;this.oj=A;this.Ez=h;this.u$g=b;this.QV=M}get tv(){return this.Ez.value}initialize(){this.org();this.vi=!0}tki(b=!1){if(!this.vi)return v.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.Mnh)return!0;let h=!1;this.oj.ee(()=>{this.$Id={};this.yHd={};if(this.tv){const r=new zc.a;r.set(this.tv);if(this.SQn(r)){if(r.Ub(1)){do this.WYk(r.currentNode);while(r.Nf(1))}h=
this.Mnh=!0}}},"BGM:EBGL");return h}LAa(b){return this.tki()?b in this.yHd?this.yHd[b]:null:null}dispose(){this.vi?this.gvp():v.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}SQn(b){if(this.FG.iS(b))return(b=b.Ub(30))||v.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}org(){v.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.u$g.cQh(this.Rjj)}gvp(){v.ULS.sendTraceTag(24691924,
324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.u$g.uEj(this.Rjj)}WYk(b){var h,r,A,M;b?(this.XNh(null!==(r=this.QV.bnb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:P.a.nil,b),this.XNh(null!==(M=this.QV.bec.get(null===(A=b.id)||void 0===A?void 0:A.toString()))&&void 0!==M?M:P.a.nil,b),(h=b.properties.ka(Rc.a.zu,null))&&(this.yHd[h]=b)):v.ULS.sendTraceTag(24155022,324,50,"Node is null")}XNh(b,h){b===P.a.nil?v.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=
b.toString(),b in this.$Id||(this.$Id[b]=new qb.a),b=this.$Id[b],b.contains(h)||b.add(h))}}Object(u.a)(iJ,"BookmarkGraphManager",null,[521]);var jJ=d(804),kJ=d(1091);class OG{create(){return new kJ.a}}Object(u.a)(OG,"BookmarkContainerNodeFactory",null,[433]);class PG{constructor(b,h,r,A=null){this.K2n=(M,ba)=>{this.Gp.Nmj(ba)};this.Bfd=(M,ba)=>{var oa=this.doi(ba.clone);M=ba.original.Ic;const Ja=new fb.a;for(const jb of oa)oa=jb.Ao.toString(),Ja.mb(oa)||(Ja.add(oa,!0),(oa=M.Eb(jb.Ao))&&!oa.anchor&&
(oa=this.Gp.yPb(jb.Ao)),oa?oa.anchor?this.wDl(oa,ba.clone):v.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",oa.id,oa.ka(Rc.a.YKb,-1))):v.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.Ggg=(M,ba)=>{M=ba.clone;ba=this.doi(M);this.Gp.xkd(M,ba)};this.LG=h;this.Gp=r;this.Rpk=A||new OG}init(){jJ.a.Uuo(Object(F.a)(this.Gp,this.Gp.Ldg,"onAfterFullBookmarkRangeDeleted"));this.LG.wgf(this.K2n);$w.a.IRd(this.Bfd);$w.a.JRd(this.Ggg)}doi(b){const h=
new qb.a;for(let r=0;r<b.ra.length;r++){const A=b.ra.K(r);if(A.ei)for(let M=0;M<A.ei.length;M++)h.add(A.ei.K(M))}return h}wDl(b,h){var r=h.Lj().ud;r=Eo.b(b,r,!0);h=zc.a.Za(h);this.T1l(h);h.Ub(30);h.o6(r,1,b.id);h.Yj(r)}T1l(b){if(b.vb(25)&&b.fd(25)&&!b.pv(30)){const h=this.Rpk.create(rn.a.kza);b.Wf(h,30)}}}Object(u.a)(PG,"BookmarksEventHandler",null,[]);var kt=d(268),Xu=d(211),QG=d(406),lJ=d(1136),RG=d(129),Zx=d(1051);class JE{create(){return new Zx.a}}Object(u.a)(JE,"BookmarkNodeFactory",null,[433]);
class jB{constructor(b,h){this.yea=b;this.Xpk=h}get UYb(){return this.Xpk}}Object(u.a)(jB,"FoundBookmarkRangeObject",null,[432]);class SG{constructor(b,h,r,A,M,ba,oa,Ja=null,jb,zb=null){this.Ria="_";this.U2a="OLE_LINK";this.x$g=40;this.kPk=" ";this.Ez=b;this.FG=h;this.Qd=r;this.A_e=A;this.Qc=M;this.hb=ba;this.ib=oa;this.Wpk=Ja||new JE;this.QV=zb}n4c(b,h){return b?this.QV.bnb.get(null===h||void 0===h?void 0:h.toString()):this.QV.bec.get(null===h||void 0===h?void 0:h.toString())}get tv(){return this.Ez.value}get c1a(){return this.A_e.value}vef(b,
h){if(!h||!h.Qa||!h.Wc)return v.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const r=h.Qa.node,A=h.Wc.node,M=kt.a.Pqb(h,!0);h=kt.a.Pqb(h,!1);return this.xSc(b,M,h,r,A)}xSc(b,h,r,A,M,ba=!1){v.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ba));const oa=this.LAa(b);if(oa)if(ba)this.kCj(oa);else return v.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!A||!M)return v.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),
!1;ba=this.Qc.Lc(15);ba.Ab(this.c1a);b=this.PVk(b);if(!b)return!1;this.MVk(A,h,b,M,r);ba.dispose();return!0}LAa(b){v.ULS.shipAssertTag(34936482,3029,!!b);return this.goi(h=>b===h.properties.ka(Rc.a.zu,null))}yPb(b){return b&&b!==P.a.nil?this.goi(h=>b.equals(h.id)):(v.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}Ldg(b){const h=this.yPb(b);h?(v.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.jCj(h),this.wkd(h)):
v.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}MAa(b,h){var r;const A=null!==(r=this.n4c(h,b.id))&&void 0!==r?r:P.a.nil;if(A===P.a.nil)return v.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new jB(null,2);r=this.tv.ud.Eb(A);return r?r.isConnected?this.getBookmarkRange(r,b,h):(v.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new jB(null,3)):(v.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),
new jB(null,2))}Nmj(b){const h=this.W$l(b);h[Symbol.iterator]().next().done||this.NQn(b,h)}xkd(b,h){const r=new qb.a;let A=0,M=!1;for(const ba of h)ba&&ba.Jb.ei?(A++,ba.Jb.ei.remove(ba),0<=ba.te&&ba.te<b.qe.length&&(ba.Jb.cp||(M=!0),r.add(ba.te))):v.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.qna(r);v.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",A,r.count));M&&!b.qe.length&&b.qe.append(Xu.CharacterPropertiesEditor.ON,
1024)}Q4d(b=!1){var h;v.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const r=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");h=new qb.a;const A=zc.a.Za(this.tv);if(null!==this.Pdd(A)){var M=A.Gq();v.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",M);if(0<M)for(M=A.$d();null!==M;){const ba=M.ka(Rc.a.zu,"");C.a.Uf(ba)||(b?h.add(M):ba.startsWith(this.Ria)||r&&ba.startsWith(this.U2a)||h.add(M));M=A.Mk()}}!b&&
0<h.count&&v.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}GZm(){return this.tv?this.FAl():!1}FAl(){var b;v.ULS.sendTraceTag(524321506,3029,50,"Finding bookmarks with includeHidden: {0}",!1);const h=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.$("HideBookMarkStartingWithOleLink");b=zc.a.Za(this.tv);if(null!==this.Pdd(b)&&0<b.Gq())for(var r=b.$d();null!==r;){r=r.ka(Rc.a.zu,"");if(!(C.a.Uf(r)||r.startsWith(this.Ria)||h&&r.startsWith(this.U2a)))return!0;
r=b.Mk()}return!1}QDi(b){var h=this.LAa(b);const r=new qb.a;if(h){b=this.n4c(!0,h.id);h=this.n4c(!1,h.id);var A=this.tv.ud.Eb(b);A&&r.add(A);if(b.equals(h))return r;b=A;do(b=A=this.hb.mg(b,!1,!1,!0))&&r.add(A);while(A&&!A.id.equals(h))}else v.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",b);return r}iCj(b){if(null===b)return v.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.yPb(b);return this.kCj(b)}pkm(b){let h="";const r=b.id;b=b.characterData.split(this.kPk);
for(let A=0;3>A&&A<b.length;A++)h+=this.Ria+b[A];h.length>this.x$g&&(h=h.substring(0,this.x$g));return this.Sek(h,r)}Sek(b,h){const r=this.Q4d(!0),A=[];let M;for(let oa=0;oa<r.count;oa++){var ba=r.K(oa);M=ba.ka(Rc.a.zu,"");ba=this.n4c(!0,ba.id);M.startsWith(b)&&!h.equals(ba)&&A.push(M)}return 0<A.length?(A.sort((oa,Ja)=>oa.localeCompare(Ja,void 0,{numeric:!0})),(h=A[A.length-1].substring(b.length+1))?b+this.Ria+(parseInt(h)+1):b+this.Ria+1):b}eUm(b){C.a.Uf(b)?v.ULS.sendTraceTag(544777296,3029,10,
"Cannot navigate to bookmark as name is null"):(b=this.LAa(b),null===b?v.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.MAa(b,!0))?(b=sc.SelectionFactory.ve(b.yea.paragraph,b.yea.Jb.cp))&&this.ib.Kc(b):v.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}kCj(b){if(!b)return v.ULS.sendTraceTag(559228888,3029,15,"Could not find bookmark node with given id"),!1;v.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",
b.id));const h=this.Qc.Lc(15);h.Ab(this.c1a);this.jCj(b);this.wkd(b);h.dispose();return!0}l6d(b,h){var r;if(!b||0>h)return v.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;const A=null===(r=y.AFrameworkApplication.J)||void 0===r?void 0:r.$("HideBookMarkStartingWithOleLink");r=null;const M=new qb.a,ba=new qb.a;var oa=b.ra;for(var Ja=0;Ja<oa.length;Ja++){var jb=oa.K(Ja);if(jb.cp>h||jb.cp===h&&0<M.count)break;if(jb.ei){var zb=jb.ei;if(2===zb.length&&
zb.K(0).Ao.equals(zb.K(1).Ao)&&jb.cp===h){M.add(zb.K(0).Ao.toString());break}for(let Eb=0,Sb=zb.length;Eb<Sb;Eb++){jb=zb.K(Eb);const nc=b.Ic.Eb(jb.Ao).ka(Rc.a.zu,"");C.a.Uf(nc)||nc.startsWith(this.Ria)||A&&nc.startsWith(this.U2a)||(jb.Uc?M.add(jb.Ao.toString()):M.contains(jb.Ao.toString())?M.remove(jb.Ao.toString()):ba.add(jb.Ao.toString()))}}}0<M.count&&(r=b.Ic.Eb(P.a.Af(M.K(M.count-1))));if(!r)for(h=Ed.ParagraphReader.mg(b,!0);h&&!r;){for(oa=0;oa<h.ra.length;oa++)if(Ja=h.ra.K(oa),Ja.ei){Ja=Ja.ei;
for(let Eb=0,Sb=Ja.length;Eb<Sb;Eb++)zb=Ja.K(Eb),jb=b.Ic.Eb(zb.Ao).ka(Rc.a.zu,""),C.a.Uf(jb)||jb.startsWith(this.Ria)||A&&jb.startsWith(this.U2a)||(zb.Uc?ba.contains(zb.Ao.toString())?ba.remove(zb.Ao.toString()):M.add(zb.Ao.toString()):M.contains(zb.Ao.toString())?M.remove(zb.Ao.toString()):ba.add(zb.Ao.toString()))}0<M.count?r=h.Ic.Eb(P.a.Af(M.K(M.count-1))):h=Ed.ParagraphReader.mg(h,!0)}return r}Qwp(b,h){if(null===b)return v.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.dhn(h)||
this.VYl(h))return!1;const r=this.Qc.Lc(15);r.Ab(this.c1a);this.Pwp(b,h);r.dispose();return!0}goi(b){if(!this.tv)return v.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new zc.a;h.set(this.tv);if(!this.Pdd(h))return v.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Ub(1))return null;do{const r=h.currentNode;if(b(r))return r}while(h.Nf(1));return null}getBookmarkRange(b,h,r){for(let A=0;A<b.ra.length;A++){const M=b.ra.K(A);if(M.ei)for(let ba=
0;ba<M.ei.length;ba++){const oa=M.ei.K(ba);if(oa.Ao.equals(h.id)&&r===oa.Uc)return new jB(oa,0)}}v.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ka(Rc.a.YKb,-1),r,h.id,b.ra.length,this.lH(b));return new jB(null,1)}Pdd(b){if(this.FG.iS(b))return b=b.Ub(30),v.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;v.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");
return null}W$l(b){const h=new fb.a;for(let r=0;r<b.ra.length;r++){const A=b.ra.K(r);if(A.ei)for(let M=0;M<A.ei.length;M++){const ba=A.ei.K(M),oa=ba.Ao.toString();h.mb(oa)?(v.ULS.shipAssertTag(36218379,3029,ba.Uc!==h.K(oa).Uc),h.remove(oa)):h.add(oa,ba)}}return h.values}NQn(b,h){this.xkd(b,h);this.rQn(b,h)}rQn(b,h){let r=Ed.ParagraphReader.mg(b,!1,!0);b=Ed.ParagraphReader.mg(b,!0,!0);r||b?(r||this.CWh(h,!0)&&v.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),
b||this.CWh(h,!1)&&v.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),r=r||b,b=b||r,this.bfj(r,h,0,!0),this.bfj(b,h,b.ra.last.cp,!1)):v.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}CWh(b,h){for(const r of b)if(h===r.Uc)return!0;return!1}bfj(b,h,r,A){const M=new qb.a;r=this.VHf(b,r);for(const ba of h)ba.Uc===A&&(r?(h=this.RVk(b,A,r,ba.Ao))&&M.add(h):v.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",A));
M.count&&(b.Ql(),this.kNg(b,M),v.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",M.count,A)))}RVk(b,h,r,A){const M=this.yPb(A);return M?this.wef(b,h,r,M):(v.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",A)),null)}wef(b,h,r,A){var M;if(!A)return v.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!r)return v.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;r.ei||(r.ei=new QG.a(r));const ba=new lJ.a(r,null,A.id,h);r.ei.add(ba);(h?this.QV.bnb:this.QV.bec).set(null===(M=A.id)||void 0===M?void 0:M.toString(),b.id);return ba}kNg(b,h){if(h){v.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((r,A)=>r.te-A.te);for(let r=0;r<h.count;r++){const A=h.K(r);A.te?b.qe.DX(A.te-1,1024):b.qe.cta(A.te,1024);b.qe.Mq.W(A.te,Xu.CharacterPropertiesEditor.ON);b.qe.Ot.W(A.te,Xu.CharacterPropertiesEditor.lS)}}else v.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}VHf(b,h){if(!b||!b.ra||!b.ra.last)return null;v.ULS.shipAssertTag(36471766,3029,h<=b.ra.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.ra.last.cp===h){var r=b.ra.length-1;if(!b.ra.K(r).formatting)for(var A=r-1;0<=A;A--){var M=b.ra.K(A);if(M.formatting){this.Qd.Q0(b,r,h,M.formatting);break}}return b.ra.last}r=null;for(A=0;A<b.ra.length;A++){M=b.ra.K(A);if(M.cp>=h){if(M.cp>h||!M.formatting)this.Qd.Q0(b,A,h,r),M=b.ra.K(A);M.ei||(M.ei=new QG.a(M));
v.ULS.shipAssertTag(36471768,3029,M!==b.ra.last);return M}M.formatting&&(r=M.formatting)}return null}PVk(b){const h=new zc.a;h.set(this.tv);if(!this.Pdd(h))return v.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.eFl(b);h.o6(b,1,null);h.Yj(b);return b}eFl(b){const h=this.Wpk.create(rn.a.$mb);h.setValue(Rc.a.zu,b);h.setValue(Rc.a.YKb,Lg.a.gG());return h}wkd(b){if(b&&b.anchor){v.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",b.ka(Rc.a.YKb,
-1),b.id);var h=new zc.a;h.set(b);h.vb(64);h.Tg()}}lH(b){const h=[];let r=0;for(;b.anchor.Lr&&7!==b.type;)h[r]=RG.a[b.type],b=b.anchor.Lr.gt.node,r++;h[r]=RG.a[b.type];return h.join(" ")}Pwp(b,h){b.setValue(Rc.a.zu,h)}jCj(b){const h=this.MAa(b,!0).yea;b=this.MAa(b,!1).yea;if(h&&b&&h.paragraph===b.paragraph){let r;this.xkd(h.paragraph,(r=new qb.a,r.add(h),r.add(b),r))}else{if(h){let r;this.xkd(h.paragraph,(r=new qb.a,r.add(h),r))}if(b){let r;this.xkd(b.paragraph,(r=new qb.a,r.add(b),r))}}}MVk(b,h,
r,A,M){if(h=this.wef(b,!0,this.VHf(b,h),r)){b.Ql();var ba;this.kNg(b,(ba=new qb.a,ba.add(h),ba));(r=this.wef(A,!1,this.VHf(A,M),r))?(A.Ql(),this.kNg(b,(ba=new qb.a,ba.add(r),ba))):v.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else v.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}RDi(b,h){var r;if(!b)return null;h=null!==(r=this.n4c(h,b.id))&&void 0!==r?r:P.a.nil;
return b.Ic.Eb(h)?b.Ic.Eb(h):null}chn(b){return!!b&&64===b.nf}Djg(b){var h,r;if(0===b.Qna)return!1;const A=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");for(h=0;h<(null===(r=b.ra)||void 0===r?void 0:r.length);h++){const M=b.ra.K(h);if(null!=M.ei)for(let ba=0;ba<M.ei.length;ba++){const oa=M.ei.K(ba),Ja=b.Ic.Eb(oa.Ao).Dqb();if(!(C.a.Uf(Ja)||Ja.startsWith(this.Ria)||A&&Ja.startsWith(this.U2a))&&oa.Uc)return!0}}return!1}cui(b){var h,r;const A=[];if(0===
b.Qna)return A;const M=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");for(h=0;h<(null===(r=b.ra)||void 0===r?void 0:r.length);h++){const ba=b.ra.K(h);if(null!=ba.ei)for(let oa=0;oa<ba.ei.length;oa++){const Ja=ba.ei.K(oa),jb=b.Ic.Eb(Ja.Ao),zb=jb.Dqb();C.a.Uf(zb)||zb.startsWith(this.Ria)||M&&zb.startsWith(this.U2a)||!Ja.Uc||A.push(jb)}}return A}i7o(b){return b.ka(Rc.a.FI,!1)}dhn(b){return C.a.Uf(b)?(v.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),
!0):!1}VYl(b){return null!==this.LAa(b)?(v.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}bui(b,h,r){return this.getBookmarkRange(b,h,r).yea}RWi(b,h,r){if(this.i7o(r)||this.Hmn(r))return!1;const A=this.RDi(r,!0),M=this.RDi(r,!1);if(A&&M&&this.hb.q$c(h,A,M)){if(h!==A&&h!==M)return!0;const ba=this.bui(A,r,!0);if(ba&&(A!==h||ba.Jb.cp<=b)&&(r=this.bui(M,r,!1))&&(M!==h||r.Jb.cp>=b))return!0}return!1}Hmn(b){var h;b=null===b||void 0===b?
void 0:b.ka(Rc.a.zu,"");const r=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");return!C.a.Uf(b)&&(b.startsWith(this.Ria)||r&&b.startsWith(this.U2a))?!0:!1}}Object(u.a)(SG,"FullBookmarkManager",null,[403]);class KE{constructor(){this.DLe=this.Pq=this.Z=null}get name(){return"WordEditor.Bookmark"}uc(b){this.Z=b;this.Pq=this.Z.resolve(59).Pl;const h=new SG(new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed),Object(fn.a)(),this.Z.resolve(323),new Pf.a(()=>
qa.StaticActiveAppFrame.za().kb.Jc.qd),xn.a.instance,this.Z.resolve(164),this.Z.resolve(26),null,null,this.Z.resolve(381));this.Z.ia(930,()=>h).as(457).ha();this.Z.ia(947,()=>new PG(this.Pq.jf(12),this.Z.resolve(785),this.Z.resolve(457))).ha();$l.a.Dck&&(this.DLe=new iJ(this.Pq.jf(64),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed),Object(fn.a)(),vp.a.instance,this.Z.resolve(381)),this.Z.ia("WordEditor.Bookmark.BookmarkGraphManager",()=>this.DLe).as(948).ha())}init(){this.Z.resolve(23).Qr.continueWith(()=>
{this.No()})}dispose(){this.DLe.dispose()}No(){v.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");this.Z.resolve(947).init();v.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.avo(this.Z.Ra(325),this.Z.resolve(930))}avo(b,h){b&&b.execute(r=>{r.nY(new NG(h))})}static main(){E.a.instance.Mc(new KE)}}Object(u.a)(KE,"BookmarkPackage",null,[0,1]);var mJ=d(878),LE=d(1041),ME=d(1472),iw=d(1288);class TG extends iw.a{constructor(b){super();this.mSk=b}get index(){return 3}run(){this.mSk()}$I(){this.z0()}}
Object(u.a)(TG,"FootnoteEndnoteGraphUpdateTracker",iw.a,[]);class UG{constructor(){this.wCd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}uc(){}init(){UG.qc.Qr.continueWith(()=>{this.No()})}No(){mJ.a.eqb=ME.a.instance;this.DTf()}dispose(){}DTf(){this.wCd=new TG(()=>{ME.a.instance.$v()});LE.a.Gte(Object(F.a)(this.wCd,this.wCd.$I,"setUpdateNeeded"));Ls.a.instance.sva(this.wCd,3)}static get qc(){return $a.a.instance.resolve(23)}}Object(u.a)(UG,"PackageManager",null,[0,1]);var NC=d(770),
VG=d(244),OC=d(536),Km=d(480),PC=d(1627);class kB extends Gy{constructor(){super()}get Jv(){return null}getTitle(b){b=b.Esa();if(!b||!OC.a.instance.qta(b))return"";const h=new Sys.StringBuilder,r=OC.a.instance.q7(b);h.append(1===r?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(OC.a.instance.kkc(b));return h.toString()}}Object(u.a)(kB,"FootnoteEndnoteBaseDetailsProvider",Gy,[]);class WG extends kB{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get $h(){return 7}}
Object(u.a)(WG,"FootnoteEndnoteDetailsProvider",kB,[]);var NE=d(1548),Nz=d(1580),QC=d(1700);class yv extends kB{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get $h(){return 10}}Object(u.a)(yv,"FootnoteEndnoteRefMarkDetailsProvider",kB,[]);class Oz{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he){this.KSi=(fe,Yd,Td,wf,Lf)=>{wf=Yd.view;if(!wf.features.BBe||this.lF.MWi)return 8;const ii=wf.lb.Ng;if(!ii)return 2;if(this.Al.F2(ii))return 8;wf=fe===Hc.a.insertFootnote?1:
0;var Bi=this.u5d(Yd);if(!Bi)return v.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;Yd=!0;Bi=Bi.Qa;Lf&&Lf.gpc&&Lf.zLa&&(Bi=Lf.zLa,Yd=!Lf.keepCurrentFocus);if(1===Td&&Bl.a.dma(ii)||!Bi||!Le.a.qf(Bi)||this.vch.instance&&this.vch.instance.Vnn(Bi)||Oc.a.ZBa(Bi,!0))return 8;if(1===Td)return 32;2===Td&&(Td=this.AW.Xf("UserAction","InsertFootnoteEndnote"),fe=this.Zwk.dcn(Bi,wf,fe),Lf&&Lf.gpc&&(Lf.Phj=fe),Yd&&this.Eoe(fe,!0,!0),Td.stop(),this.Xd.ev(6));return 32};this.gsc=(fe,Yd,Td)=>
{const wf=Yd.view;if(fe===Hc.a.Jeb||fe===Hc.a.Xyb){if(!wf.features.BBe)return 8}else if(!wf.features.EGg)return 8;if(!wf.lb.Ng)return 2;Yd=this.jlc(Yd);return Yd?fe!==Hc.a.Jeb&&fe!==Hc.a.Xyb||this.eRa.e_m(Yd.node,fe===Hc.a.Jeb?1:0)?1===Td?32:2===Td&&32===this.ga.Pb(Hc.a.U6,2,!0)?(this.ga.Pb(Hc.a.Cbg,2,fe),32):8:8:2};this.mdm=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;if(2===Td){fe=this.zLm(Yd);if(!fe)return 8;Td=Yd=null;switch(Lf){case Hc.a.Nke:Td=fe.Wc;Yd=this.w7b.f$d(Td,1);break;case Hc.a.Mke:Td=fe.Wc;
Yd=this.w7b.f$d(Td,0);break;case Hc.a.Pke:Td=fe.Qa;Yd=this.w7b.uLi(Td,1);break;case Hc.a.Oke:Td=fe.Qa;Yd=this.w7b.uLi(Td,0);break;case Hc.a.Jeb:Td=fe.Qa;(Yd=this.w7b.f$d(Td,1,!0))||(Yd=this.eRa.oyi(Td.node,1));break;case Hc.a.Xyb:Td=fe.Qa,(Yd=this.w7b.f$d(Td,0,!0))||(Yd=this.eRa.oyi(Td.node,0))}if(Yd)this.Eoe(Yd);else{if(!this.Sy.Jc)return 8;(Lf=bm.d(Td.node,Td.cpBegin))&&7===Lf.$h&&this.eRa.iLj(Lf)}}return 32};this.A9o=(fe,Yd,Td,wf,Lf)=>1===Td?32:2===Td?(v.ULS.shipAssertTag(4520066,308,!!Lf),v.ULS.shipAssertTag(4520067,
308,!!Lf.q7a),fe=Lf.q7a,v.ULS.shipAssertTag(4520068,308,this.xG.qta(fe)),this.Eoe(fe,Lf.Uye)?32:8):32;this.B9o=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;2===Td&&(fe=Lf.Oaa,Lf=Lf.pdm)&&(this.kxa.cic(),Yd=this.xG.mtb(fe),Lf.title=this.xG.Uum(fe)+(Yd?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};this.Acb=(fe,Yd,Td,wf,Lf)=>2===Td?(v.ULS.shipAssertTag(4520069,308,!!Lf),v.ULS.shipAssertTag(4520070,308,!!Lf.q7a),v.ULS.shipAssertTag(4520071,
308,Ed.ParagraphReader.Vb(Lf.q7a)),fe=this.xG.x9a(Lf.q7a),this.Eoe(fe,Lf.Uye)?32:8):32;this.gWo=(fe,Yd,Td)=>{2===Td&&this.lF.O0();return 32};this.iWl=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;if(2===Td)return void 0!==Lf&&null!==Lf?this.lF.byf(Lf,Lf):this.lF.byf(),32;v.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};this.aAn=(fe,Yd,Td)=>{fe=this.jlc(Yd);return fe&&Le.a.qf(fe)?1===Td?32:2===Td?(Td=0<this.Xp.Y2(fe.node).Uu,this.lF.qtf(),this.lF.dialog.Qrb=
Td,32):8:(v.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.kdm=(fe,Yd,Td)=>1===Td?32:2===Td?(this.lF.dialog.Qrb=!1,32):8;this.lmo=(fe,Yd,Td,wf,Lf)=>this.Eqi(fe,Td,Lf);this.jmo=(fe,Yd,Td,wf,Lf)=>1===Td?32:this.lF.dialog&&this.lF.dialog.fontName?(Lf[ka.a.Value]=this.lF.dialog.fontName,32):this.mtk.oVa(ub.a.DYb.toString(),Lf,null)?32:8;this.jdm=(fe,Yd,Td)=>1===Td?32:2===Td?(this.lF.dialog.Qrb=!0,32):8;this.kmo=(fe,Yd,Td,wf,Lf)=>this.Eqi(fe,Td,Lf);this.hdm=(fe,Yd,Td)=>{if(1===
Td)return 32;if(2===Td){fe=this.jlc(Yd);if(!fe)return v.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;Yd=this.xG.x9a(fe.node);this.xG.qta(Yd)&&(Td=this.Qc.Lc(15),Td.Ab(Yd),this.K7j(fe),this.eRa.dTh(Yd,this.lF.dialog),Td.dispose());this.lF.Gld();return 32}return 8};this.gdm=(fe,Yd,Td)=>{if(1===Td)return 32;if(2===Td){fe=this.jlc(Yd);if(!fe)return v.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;Yd=this.xG.x9a(fe.node);this.xG.qta(Yd)&&(Td=this.Qc.Lc(15),
Td.Ab(Yd),this.K7j(fe),this.eRa.W8k(Yd,this.lF.dialog),Td.dispose());this.lF.Gld();return 32}return 8};this.idm=(fe,Yd,Td)=>1===Td?32:2===Td?(this.lF.Gld(),32):8;this.edm=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;if(2===Td){fe=Object(Ma.a)(13,Lf);if(!fe||!fe.td)return 8;this.lF.dialog.fontName=fe.td.fontName;return 32}return 8};this.fdm=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;if(2===Td){fe=Object(Ma.a)(13,Lf);if(!fe||!fe.td)return 8;this.lF.dialog.v7b=fe.td;return 32}return 8};this.ga=b;this.Sy=h;this.mtk=
r;this.od=A;this.xG=M;this.Zwk=ba;this.eRa=oa;this.kxa=Ja;this.lF=jb;this.Xp=zb;this.w7b=Eb;this.Qc=Sb;this.Al=nc;this.Gb=Dc;this.AW=Zc;this.Xd=Gd;this.Zmk=de;this.vch=he}K7j(b){(b=xa.FormattingReader.Us(b))?(this.lF.dialog.fontName||(this.lF.dialog.fontName=b.cache.wI),-1===this.lF.dialog.fontSize&&(this.lF.dialog.v7b=b.cache.fontSize)):v.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}Eqi(b,h,r){return 1===h&&this.lF.dialog?32:2===h&&this.lF.dialog?(r[Jd.a.On]=
b===Hc.a.Kog?this.lF.dialog.Qrb:!this.lF.dialog.Qrb,32):8}Wb(){df.a.instance.aQi([Hc.a.Nke,Hc.a.Mke,Hc.a.Pke,Hc.a.Oke,Hc.a.Cbg,Hc.a.Jeb,Hc.a.Xyb,Hc.a.U6]);this.ga.fb(Hc.a.insertFootnote,mc.a.view,this.KSi,4);this.ga.fb(Hc.a.insertEndnote,mc.a.view,this.KSi,4);this.ga.qa(Hc.a.Nke,mc.a.view,this.gsc);this.ga.qa(Hc.a.Cbg,mc.a.view,this.mdm);this.ga.qa(Hc.a.Mke,mc.a.view,this.gsc);this.ga.qa(Hc.a.Pke,mc.a.view,this.gsc);this.ga.qa(Hc.a.Oke,mc.a.view,this.gsc);this.ga.qa(Hc.a.Jeb,mc.a.view,this.gsc);this.ga.qa(Hc.a.Xyb,
mc.a.view,this.gsc);this.ga.qa(Hc.a.NUj,mc.a.view,this.A9o);this.ga.fb(Hc.a.Cqi,mc.a.view,this.jdm,4);this.ga.fb(Hc.a.Kog,mc.a.view,this.kmo,100);this.ga.fb(Hc.a.Dqi,mc.a.view,this.kdm,4);this.ga.fb(Hc.a.yxj,mc.a.view,this.lmo,100);this.ga.qa(Hc.a.OUj,mc.a.view,this.B9o);this.ga.fb(Hc.a.Acb,mc.a.view,this.Acb,96);this.ga.fb(Hc.a.f4d,mc.a.view,this.gWo,96);this.ga.qa(Hc.a.U6,mc.a.view,this.iWl);this.ga.fb(Hc.a.y6i,mc.a.view,this.aAn,4);this.ga.fb(Hc.a.zqi,mc.a.view,this.hdm,4);this.ga.fb(Hc.a.Aqi,
mc.a.view,this.gdm,4);this.ga.fb(Hc.a.Bqi,mc.a.view,this.idm,4);this.ga.fb(Hc.a.d4d,mc.a.view,this.edm,4);this.ga.fb(Hc.a.xxj,mc.a.view,this.jmo,100);this.ga.fb(Hc.a.e4d,mc.a.view,this.fdm,4);this.ga.fb(Hc.a.Bhd,mc.a.view,Oz.Bhd,100);this.ga.fb(Hc.a.Chd,mc.a.view,Oz.Chd,100)}irg(){this.Zmk.execute(b=>{b.nY(new WG);b.nY(new yv)})}jlc(b){b=this.u5d(b);return b?b.Qa:(v.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}u5d(b){let h=null;b=b.view;if(!b)return v.ULS.sendTraceTag(3486740,
308,10,"We expected a view here."),h;b=b.lb;if(!b)return v.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.gb;if(!b||!b.length)return v.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.K(0);if(!b)return v.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=Le.a.yk(b,!1,!1))||v.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}zLm(b){return(b=b.view)?
b.lb.gb.K(0):null}Eoe(b,h=!0,r=!1){if(b){this.kxa.cic();var A=b.ssa;if(A){var M=A.Jb,ba=sc.SelectionFactory.rL(M.paragraph,M.cp,M.cp+1);M=this.Sy.Jc;if(!M)return!1;this.od.Bha(M,ba);M.Uxb=150;M.n4();b=new Km.a(b,h);ba=VG.a.pkc(A,M);A=A.aBa(M,ba);if(!A)return v.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;r||A.element?this.lF.lDg(b):(this.lF.lDg(new Km.a(b.q7a,!1)),h&&(h=new wc.a(2,1,10,()=>{this.lF.O0()}),this.Gb.Yb(h)));return!0}}return!1}static Kum(){return new Oz(y.AFrameworkApplication.va,
qa.StaticActiveAppFrame.za().kb,$a.a.instance.resolve(710),Object(Jb.a)(),OC.a.instance,Nz.a.instance,NE.a.instance,ME.a.instance,PC.FootnoteEndnoteControlManager.instance,$a.a.instance.resolve(34),QC.a.instance,new xn.a,ve.a.instance,me.a.instance,y.AFrameworkApplication.ta.$r,$a.a.instance.resolve(46).instance,$a.a.instance.Ra(325),$a.a.instance.Ra(13))}static Jum(){return Oz.Kum()}static Bhd(b,h,r,A,M){if(1===r)return 32;if(2===r&&!M)return 8;zn.a.Jbe(h);M.PopulationXML=Jm.FontUtils.gsi(zn.a.oze,
zn.a.BFf,Hc.a.d4d);return 32}static Chd(b,h,r,A,M){if(1===r)return 32;if(2===r&&!M)return 8;M.PopulationXML=Jm.FontUtils.hsi(Hc.a.e4d);return 32}}Object(u.a)(Oz,"FootnoteEndnoteActor",null,[435]);class zv extends iw.a{constructor(b){super();this.ccf=b}get index(){return 1}run(){this.ccf()}$I(){this.z0()}}Object(u.a)(zv,"FootnoteEndnoteControlUpdateTracker",iw.a,[]);var Sy=d(353);class nJ extends Sy.a{constructor(b,h,r,A,M,ba,oa){super(b,h,r,A);this.sv=()=>{this.atd(this.Cb)};this.JK=b.container;this.nx=
document.createElement("div");b.container.appendChild(this.nx);this.eQ(this.nx);this.PLk=M;this.ko.execute(Ja=>{Ja.oY(this.sv)});this.iRa=ba;this.XM=oa;this.iRa.execute(Ja=>{Ja.yBg(this.ic,this.JK)});this.JK.style.backgroundColor=this.XM.Qkc()}dispose(){super.dispose();this.ko.instance&&this.ko.instance.BNa(this.sv)}get ko(){return null!=this.TXg?this.TXg:this.TXg=$a.a.instance.Ra(6)}WB(b){this.JK.classList.add("FootnoteEndnoteViewElement");this.atd(b.currentNode)}atd(b){this.ko.instance&&(this.ko.instance.Qud(this.nx),
this.nx.style.width=Math.round(100/this.ko.instance.Cj)+"%");this.PLk(b)}}Object(u.a)(nJ,"FootnoteEndnoteViewElement",Sy.a,[]);class oJ{constructor(){this._initialized=!1;this.Oyd=this.QSe=this.Z=null;this.rdm=(b,h,r,A)=>b.xab?new nJ(b,h,r,A,M=>{PC.FootnoteEndnoteControlManager.instance.$Go(M)},this.Z.Ra(194),this.Z.resolve(319)):null}get name(){return"WordEditor.FootnoteEndnote"}uc(b){this.Z=b}init(){this.Z.resolve(23).Qr.continueWith(()=>{this.No()})}No(){Ku.WordSectionNavigator.instance.Fbg=Object(F.a)(NE.a.instance,
NE.a.instance.jSn,"navigateToWordSectionNodeWithFootnoteEndnote");NC.a.nBg(this.rdm);PC.FootnoteEndnoteControlManager.instance.bind(qa.StaticActiveAppFrame.za().nG);this.QSe=Oz.Jum();this.QSe.Wb();this.QSe.irg();qa.StaticActiveAppFrame.za().Fe();this.DTf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,PC.FootnoteEndnoteControlManager.instance.dispose())}DTf(){this.Oyd=new zv(()=>{PC.FootnoteEndnoteControlManager.instance.btd()});LE.a.Gte(Object(F.a)(this.Oyd,this.Oyd.$I,
"setUpdateNeeded"));Ls.a.instance.sva(this.Oyd,3)}}Object(u.a)(oJ,"PackageManager",null,[0,1]);class Ty{constructor(b,h,r,A){this.ib=h;this.aja=A}get bookmarkManager(){return this.aja.value}Mnn(b){return $l.a.Dck?b.startsWith(C.a.Ymb):!1}iXm(b){try{this.jXm(b)}catch(h){v.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}sKg(b){return{returnValue:!1,Srg:b,nPb:""}}jXm(b){if(this.bookmarkManager){b=b.split("/");var h=this.bookmarkManager.LAa(b[b.length-
1]);h&&h.anchor?(b=this.bookmarkManager.MAa(h,!0).yea,h=this.bookmarkManager.MAa(h,!1).yea,b||h?b?this.jQj(b):(v.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.jQj(h)):(v.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.c5i(!1))):(v.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.c5i(!0))}}c5i(b){b=sc.SelectionFactory.vp(qa.StaticActiveAppFrame.za().kb.ed.gwi(),b);this.ib.Kc(b)}jQj(b){b.paragraph&&b.Jb?(b=sc.SelectionFactory.ve(b.paragraph,
b.Jb.cp),b.PVi=!0,this.ib.Kc(b)):v.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(u.a)(Ty,"InternalLinkManager",null,[402]);class dx{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}uc(b){b.ia("WordEditor.InternalLinks.InternalLinkManager",()=>new Ty(new Pf.a(()=>b.Oa(948)),b.resolve(327),b.resolve(23),new Pf.a(()=>b.Oa(457)),b.resolve(381))).as(66).ha()}static main(){E.a.instance.Mc(new dx)}}Object(u.a)(dx,"WordEditorInternalLinksPackage",
null,[0,1]);class Pz{constructor(b){this.ORa=null;this.rpl=h=>{h=h.em;if(h.anchor){db.a.mark(4763);var r=zc.a.Za(h);if(r.vb(8)&&r.fd(8)&&r.zKg(h)===h){if(Lj.OutlineReader.isEmpty(r)){let A=!1;for(let M=0;M<$f.a.instance.gb.length;M++){const ba=$f.a.instance.gb.K(M);for(let oa=0;oa<ba.length;oa++)if(ba.K(oa).node===h){A=!0;break}}A||this.Aei(r)}db.a.mark(4764)}}};Pz.sT=b}LYd(b){if(!Pz.rj.hfe(b))return null;b.Ub(1)&&(b.currentNode.fm(8,!0),b.rc());const h=Pz.sT.JJl();Pz.rj.isRtl(b.currentNode)?h.setValue(ze.a.Ds,
11):h.setValue(ze.a.Ds,9);b.Wf(h,1);b.Yj(h);return h}IXo(b){if(this.ORa&&b!==this.ORa){const h=new wc.a(2,1,0,this.rpl,120);h.em=this.ORa;y.AFrameworkApplication.oc.Yb(h)}this.ORa=b}Aei(b){this.ORa===b.currentNode&&(this.ORa=null);const h=new Qb.GraphTransaction(7);h.pu(b);b.Tg();h.dispose()}w2h(){if(this.ORa&&this.ORa.anchor){const b=zc.a.Za(this.ORa);b.yq()&&Lj.OutlineReader.k9c(b)&&this.Aei(b);this.ORa=null}}static get rj(){return cm.PageReader.instance}}Pz.sT=null;Object(u.a)(Pz,"PageContentEditor",
null,[1450]);var XG=d(1133),lu=d(602);class OE extends Vv{constructor(){super()}rTj(b,h,r,A,M){let ba=!1,oa=!0;Le.a.qf(M)&&(h=mf.ListItemReader.Dg(b)&&h,M=Ua.a.aB(b,M,!1)&&!Ua.a.aB(b,M,!0),h&&r.znf(b,A)&&(ba=!0),Jf.a.vd().wn&&(M||h&&!ba)&&(oa=!1));return{qTj:oa,ack:ba}}}Object(u.a)(OE,"CursorMoveValidator",Vv,[]);var pJ=d(217);class Qo{constructor(b,h,r,A,M){this.KI=M;this.G3e=b;this.V9=A;this.ixa=h;this.Rh=r}get Pd(){return null!=this.i6g?this.i6g:this.i6g=$a.a.instance.resolve(46).instance}get Oj(){return null!=
this.U5g?this.U5g:this.U5g=$a.a.instance.resolve(39).instance}get Xb(){return null!=this.G7g?this.G7g:this.G7g=$a.a.instance.resolve(8)}get Jg(){return null!=this.Y4g?this.Y4g:this.Y4g=$a.a.instance.Oa(28)}get fu(){return this.V9.value}get Of(){return this.Rh.value}get Ss(){return this.ixa}bVm(b){const h=window.performance.now(),r=new nr.ScriptSharpLegacyMap,A=new Xo.a,M=new nr.ScriptSharpLegacyMap;if(b&&b.Uw){var ba=null;for(let oa=0;oa<b.length;oa++){const Ja=b.getContext(oa);ba=ba||Object(fn.a)().Nu(Ja.node);
let jb;if(!({groupId:jb}=this.Nrp(Ja.node,ba)).returnValue)continue;let zb;r.mb(jb)||(zb=[],r.add(jb,zb));zb=r.K(jb);zb.push(Ja)}for(const oa of an.toArray(r.keys))b=r.K(oa),ba=new zc.a,ba.set(b[0].node),({CHj:b,Zs:ba}=this.ixa.lrp(ba)).returnValue?(r.W(oa,b),M.add(oa,ba)):A.add(oa)}v.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:r,eVm:A,dVm:M}}GLb(b){return this.Oml(b)}Bec(b){return this.lml(b)}EUd(b,
h,r=!0){return zc.a.jfa(()=>{var A=!1;if(mf.ListItemReader.Dg(b))return this.znf(b,h,r);A||(Ab.OutlineElementNavigator.Me(b),A=Ed.ParagraphReader.Eh(b)||Hi.TableReader.isTable(b),Ab.OutlineElementNavigator.ke(b),A=A&&this.Nml(b,h));return A})}znf(b,h,r=!0){return zc.a.jfa(()=>{const A=Ua.a.CKa(b),M=Lj.OutlineReader.E_(b.currentNode);if(r?!this.wpn(b,h):!this.xpn(b,h))return!1;var ba=zc.a.Za(b.currentNode);if(0<h&&ba.vb(14)){ba.fd(16);var oa=ba.currentNode;const Ja=Xh.TableCellReader.MOf(ba);ba.fd(14);
const jb=ba.currentNode;ba=bf.a.pP(oa,jb,Rc.a.CS,Rc.a.Aa,0);oa=bf.a.pP(oa,jb,Rc.a.AV,Rc.a.Ba,0);ba=Rh.a.gA(ba,0);oa=Rh.a.gA(oa,0);return A+M<Ja-ba-oa}return!0})}Nml(b,h){const r=Ua.a.CKa(b);var A=Ua.a.xI(b);if(0<h){h=Lj.OutlineReader.E_(b.currentNode);A=0;const {Bp:Ja,marginLeft:jb,marginRight:zb}=Qo.W7d(b.currentNode);var M=zc.a.Za(b.currentNode);Ab.OutlineElementNavigator.Me(b);if(Hi.TableReader.isTable(b)){A=Hi.TableReader.Saa(b);var ba=0;for(var oa of A)ba+=oa;A=Rh.a.gA(Rh.a.xf(ba,0),0)}Ab.OutlineElementNavigator.ke(b);
return M.vb(14)?(M.fd(16),oa=M.currentNode,b=Xh.TableCellReader.MOf(M),M.fd(14),ba=M.currentNode,M=bf.a.pP(oa,ba,Rc.a.CS,Rc.a.Aa,0),oa=bf.a.pP(oa,ba,Rc.a.AV,Rc.a.Ba,0),M=Rh.a.gA(M,0),oa=Rh.a.gA(oa,0),r+h<b-M-oa-A):r+h<Ja-jb-zb-A}return 0<r-A}CZa(b,h){this.Dqj(b,-1*Math.abs(h))}bZc(b,h){this.Dqj(b,Math.abs(h))}XTl(b,h,r,A,M){let ba=Qo.tej;if(h>=Qo.tej){ba=h-=r;const oa=A*M,Ja=Math.abs(oa),jb=Math.abs(h)%Ja;jb&&(ba=0>ba?0>A?ba+jb:ba-(Ja-jb):0<A?ba-jb:ba+(Ja-jb));ba+=oa;ba+=r;Qo.xpe&&(r=Ua.a.Y2(b),ba=
Qo.xpe.kvi(b.currentNode,h+r,ba+r,M,ba<h)-r)}return ba}Lml(b,h,r){if(!b||!b.length)return!1;h=r?h?-1:1:this.cxi(b[0].node,h);return this.Mml(b,h,r)}j9n(b,h,r){if(!b)return v.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return v.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!r)return v.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),
8;if(!r.length)return v.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const A=b[0].node;h=this.cxi(A,h);if(!this.$Pn(A,r[0],h)||!this.XPn(b,h))return 8;this.fu.Z0();return 32}XPn(b,h){for(let r=0;r<b.length;r++){const A=new zc.a;A.set(b[r].node);let M=null;Ab.OutlineElementNavigator.Me(A);if(Ed.ParagraphReader.Eh(A)){if(M=A.currentNode,!M)return v.ULS.shipAssertTag(589592461,338,!M,"The paraNode is null for the list OE node"),!1}else if(!Ed.ParagraphReader.Eh(A)&&
!Hi.TableReader.isTable(A))return v.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;A.rc();if(M){if(this.k_m(M)){const ba=M.UA(),oa=Ua.a.CKa(A);this.Of.iEa(A,1,oa+h);ba&&this.Oj.fQ(M,ba,this.Pd.Ag)}ch.a.getInstance().Ku||M.setValue(ze.a.SU,new Date)}}return!0}$Pn(b,h,r){for(let A=0;A<fk.a.OI;A++){const M=this.ixa.$y(b,h,A);if(!M)return v.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const ba=M.getValue(Rc.a.je);
ba&&M.setValue(Rc.a.je,ba+r)}return!0}k_m(b){return b.hasProperty(Rc.a.je)||b.hasProperty(Rc.a.Pt)||b.hasProperty(Rc.a.GD)}lml(b){return this.EUd(b,1,!0)}Oml(b){return this.EUd(b,-1,!0)}cxi(b,h){var r=new zc.a;r.set(b);const A=Ua.a.CKa(r),M=Ua.a.xI(r),ba=Ua.a.Y2(r);r=Lj.OutlineReader.E_(b);Qo.W7d(b);b=(M?A-M:ba)%r;return h?-1*(b?b:r):r-b>Qo.sdi?Qo.sdi:r-b}Nrp(b,h){if(mf.ListItemReader.De)return h=mf.ListItemReader.sla(b),h=pJ.a.Kkc(null===h||void 0===h?void 0:h.listId),{groupId:h,returnValue:null!=
h};let r;const A=new zc.a;A.set(b);b=A.Ub(4).getValue(Rc.a.listID);return({id:r}=this.ixa.MAc(b,h)).returnValue?{returnValue:!0,groupId:r}:{returnValue:!1,groupId:r}}Mml(b,h,r){var A=!1;for(let M=0;M<b.length;M++){A=b[M];const ba=new zc.a;ba.set(A.node);Le.a.yv(ba);if(!Ua.a.Qh(ba))return Qo.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.UNb}),!1;if(this.EUd(ba,h,r))A=!0;else return Qo.Bc.$b(Uf.a.khc,{["Reason"]:Ff.a.Snf}),!1}return A}Dqj(b,h){if(this.EUd(b,h,!0)){var r=!1;if(mf.ListItemReader.Dg(b)){var A=new zc.a;
A.kd(b);this.Ss.y0(A);var M=A.currentNode;A.rc();r=!0;const {listId:oa,listLevel:Ja}=mf.ListItemReader.sla(b);var ba=this.oNm(oa,Ja+h);if(ba)Ab.OutlineElementNavigator.Me(A),Ed.ParagraphReader.Eh(A)&&Qo.CM.gQ(ba,A.currentNode,!1),A.rc();else{ba=null;let jb;Ab.OutlineElementNavigator.Me(A);Ed.ParagraphReader.Eh(A)&&(ba=A.currentNode);A.rc();jb=ba?ba.UA():null;ba||(Ab.OutlineElementNavigator.Me(A),Ed.ParagraphReader.Eh(A)&&(ba=A.currentNode),A.rc());ba&&(ba.hasProperty(Rc.a.je)&&ba.removeProperty(Rc.a.je),
ba.hasProperty(Rc.a.Pt)&&ba.removeProperty(Rc.a.Pt));ch.a.getInstance().Nt||M.setValue(Rc.a.listLevel,Ja+h);ch.a.getInstance().Ku&&this.KI.W_b(ba,oa,Ja+h);ch.a.getInstance().Nt||M.removeProperty(Rc.a.r0);ba&&jb&&(this.Oj.fQ(ba,jb,this.Pd.Ag),this.fu.Z0());this.Cip(b,mf.ListItemReader.De?ba:M)}}r||(r=Ua.a.CKa(b),A=Ua.a.xI(b),M=Lj.OutlineReader.E_(b.currentNode),h=this.XTl(b,r,A,h,M),this.Of.iEa(b,1,h))}}xpn(b,h){const r=Ua.a.CKa(b),A=Ua.a.xI(b),M=Ua.a.Y2(b),{Bp:ba,marginLeft:oa,marginRight:Ja}=Qo.W7d(b.currentNode);
if(0<h){if(b=ba-oa-Ja,M&&M+h+df.a.fFa>b||r+h+df.a.fFa>b)return!1}else if(M&&0>r+h||0>r-A+h)return!1;return!0}wpn(b,h){var r=this.fu.yE(b);const A=r.level+h;if(Nw.a.Bzn<A||A<Nw.a.Vam)return!1;r=this.Ss.$y(b.currentNode,r.listID,A);if(!r)return v.ULS.shipAssertTag(590700875,338,!!r),!1;if(0<h&&r.hasProperty(Rc.a.je)){h=r.getValue(Rc.a.je);const {Bp:M,marginLeft:ba,marginRight:oa}=Qo.W7d(b.currentNode);if(h+df.a.fFa>M-ba-oa)return!1}return!0}oNm(b,h){const r=this.Xb.xo();let A,M;this.Jg.xn?(A=r.mv(),
M=A.Ow):M=r.Ow;for(let oa=0;oa<M;oa++){var ba=void 0;this.Jg.xn?(ba=A.Bla(oa),ba=r.mh(this.Xb.Be(ba))):ba=r.eBa(oa);if(this.Ss.Yob(ba)&&ba.ka(Rc.a.listID,this.fu.Bba+1)===b&&ba.ka(Rc.a.listLevel,-1)===h)return ba}return null}Cip(b,h){Ab.OutlineElementNavigator.Me(b);if(Ed.ParagraphReader.Eh(b)&&b.currentNode.hasProperty(Rc.a.je)&&(h=this.Ss.zkc(h))){if(h.hasProperty(Rc.a.Pt)){var r=h.getValue(Rc.a.Pt);this.G3e.qyb(b.currentNode,r)}h.hasProperty(Rc.a.je)&&(r=h.getValue(Rc.a.je),this.G3e.iEa(b,1,r));
h.hasProperty(Rc.a.GD)&&(h=h.getValue(Rc.a.GD),this.G3e.sha(b.currentNode,h))}Ab.OutlineElementNavigator.ke(b)}static get CM(){return null!=Qo.f7g?Qo.f7g:Qo.f7g=$a.a.instance.resolve(393)}static get xpe(){return null!=Qo.a3g?Qo.a3g:Qo.a3g=$a.a.instance.Oa(658)}static get sl(){return Qo.Dv||(Qo.Dv=$a.a.instance.resolve(349))}static set sl(b){Qo.Dv=b}static get Bc(){return Wg.a.instance}static get ig(){return sr.a.instance}static W7d(b){var h=Ku.WordSectionNavigator.instance.jS(b);b=Qo.ig.Mv(h);const r=
Qo.ig.vN(h);h=Qo.ig.wN(h);return{Bp:b,marginLeft:r,marginRight:h}}}Qo.sdi=Cg.a.uD(.25);Qo.Dv=null;Qo.tej=Cg.a.uD(-11);Object(u.a)(Qo,"OutlineElementIndentationEditor",null,[522,523]);var PE=d(248),RC;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(RC||(RC={}));Object(u.b)("StyleTargetType",RC);class QE{constructor(b,h){this.JT=null;this.VM=h;this.kg=b}get sl(){return null!=this.J2g?this.J2g:this.J2g=$a.a.instance.resolve(349)}get iD(){return null!=
this.nXg?this.nXg:this.nXg=$a.a.instance.resolve(29)}get xj(){return null!=this.EXg?this.EXg:this.EXg=$a.a.instance.resolve(101)}get Xb(){return null!=this.H7g?this.H7g:this.H7g=$a.a.instance.resolve(8)}get d1(){return this.JT||(this.JT=new lu.WACStyleSet)}set d1(b){this.JT=b}get qc(){return null!=this.MWg?this.MWg:this.MWg=$a.a.instance.Oa(23)}get Ll(){return this.VM.value}get tk(){return null!=this.OYg?this.OYg:this.OYg=$a.a.instance.Oa(106)}get Tbd(){return this.kg||(this.kg=$a.a.instance.resolve(10))}get Bg(){return null!=
this.lUg?this.lUg:this.lUg=$a.a.instance.resolve(323)}get Pd(){return null!=this.z6g?this.z6g:this.z6g=$a.a.instance.resolve(46).instance}get Oj(){return null!=this.Z5g?this.Z5g:this.Z5g=$a.a.instance.resolve(39).instance}get OF(){return null!=this.eYg?this.eYg:this.eYg=$a.a.instance.resolve(86)}wNm(b){const h=b.node;var r=this.tk?this.tk.Sui():null;if(r&&!r.equals(P.a.nil)){if(b=h.Ic,!b||(r=this.d1.Cla(r,b))&&1!==this.Xb.NF(r))return null}else r=xa.FormattingReader.Us(b),r=xa.FormattingReader.kBa(r);
return r}A0o(b,h){const r=this.Xb.MF(h);r&&r.mh(this.Xb.Be(b))&&(this.ZMg(h,r),this.tk&&(this.tk.Cxb(),this.tk.Aeb(b,h)))}x8k(b,h){if(h)if(h.mPb&&0<h.mPb.length){let M=new Pa.a;for(var r of h.mPb)M.add(r);if(h.h5i){r=xa.FormattingReader.Zsi(b);const ba=[];for(var A of r)A.formatting&&A.formatting.uo&&ba.push(A.formatting.uo);if(0<ba.length){A=wC.APropertySet.FAi(ba);r=new Pa.a;for(const oa of M)(!A.hasProperty(oa)||h.hyn&&oa===le.a.fgb)&&r.add(oa);M=r}}this.sl.XLb(b,!0,M)}else this.sl.XLb(b,!0);else Tc.b(576582787,
3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}gQ(b,h,r,A=!1,M=!1,ba=!1,oa=null,Ja=!1){var jb,zb,Eb;if(Ed.ParagraphReader.Vb(h))if(b)if(this.Xb.p0(b.Yi()))if(2!==this.Xb.NF(b))v.ULS.shipAssertTag(593506381,324,!1);else{var Sb=this.Xb.MF(h);if(Sb){var nc=this.Xb.Be(b);if(!nc)v.ULS.shipAssertTag(593506377,324,!1);else if(Sb.mh(nc)){var Dc=null,Zc=A?null:h.UA();r||((null===oa||void 0===oa?0:oa.cml)&&(null===(jb=this.qc)||void 0===jb?0:jb.isFeatureEnabled(93))?
(this.x8k(h,oa),ch.a.getInstance().Nt||1!=oa.mPb.length||oa.mPb[0]!=le.a.fgb?this.qyp(h,b,oa):Dc=this.Ll.rzj(Dc,h)):(ch.a.getInstance().Nt||(Dc=this.Ll.rzj(Dc,h)),this.sl.XLb(h,!0)));this.ZMg(h,Sb);M&&(null===Zc||void 0===Zc?0:Zc.hasProperty(Yf.a.fx))&&Zc.removeProperty(Yf.a.fx);mf.ListItemReader.De&&!ch.a.getInstance().Nt&&this.oTh(b,h,Dc,Ja);(null===(zb=this.OF)||void 0===zb?0:zb.Bca)?this.OF.Bca(h,Yf.a.fx,b.id):h.properties.setValue(Yf.a.fx,b.id);(Ja||(mf.ListItemReader.De?mf.ListItemReader.isListItem(h):
this.Tbd.zfa(h)))&&(null===(Eb=this.qc)||void 0===Eb?0:Eb.isFeatureEnabled(93))&&this.z7j(h,b,oa);h.qQ=b;h.yOa=null;for(r=0;r<h.ra.length;r++)h.ra.K(r).formatting&&h.ra.K(r).formatting.MSb();mf.ListItemReader.De||this.oTh(b,h,Dc,Ja);null!=this.iD&&this.iD.oyc(nc);A||!Zc||ba||this.Oj.fQ(h,Zc,this.Pd.Ag);mf.ListItemReader.De&&this.Tbd.Yob(b)&&this.Ll.Z0()}}else v.ULS.shipAssertTag(593506379,324,!1)}else v.ULS.shipAssertTag(593506382,324,!1);else v.ULS.shipAssertTag(593506383,324,!1);else v.ULS.shipAssertTag(593506384,
324,!1)}oTh(b,h,r,A){this.Tbd.Yob(b)&&(r||(r=new zc.a,r.set(h),r.Ld(),Ab.OutlineElementNavigator.ke(r)),A||mf.ListItemReader.Dg(r)||(h.Vf(Rc.a.je,Rc.a.jV,Rc.a.GD,Rc.a.t8,Rc.a.gZa,Rc.a.Cy),this.ISd(r,b)))}qyp(b,h,r){let A;ch.a.getInstance().Nt||(A=this.Tbd.zfa(b));const M=this.Tbd.Yob(h);if(!ch.a.getInstance().Nt&&A||mf.ListItemReader.De&&mf.ListItemReader.isListItem(b))this.z7j(b,h,r),ch.a.getInstance().Nt||!A||M||A.removeProperty(Rc.a.r0)}z7j(b,h,r){const A=b.Ic;if(b=this.Bg.u8a(b)){var M=null==
b.uo?new PE.a:b.uo.clone();zi.a.EBp(M,h,r&&!r.h5i&&r.mPb?r.mPb:null);M.VLa?h=A.WP(M,!0):(A.nu(M,null),h=M);b.Lk=h.id}else v.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}ISd(){}zod(b,h){if(h){v.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var r=this.Xb.MF(h);r?(zi.a.Jg.xn?(b=r.mv().fBa(b),r=r.mh(this.Xb.Be(b))):r=r.MKa(b),r?this.Xb.p0(r.Yi())?this.gQ(r,h,!1,void 0,void 0,void 0,null):v.ULS.shipAssertTag(593506368,324,this.Xb.p0(r.Yi())):
v.ULS.shipAssertTag(593506369,324,!!r)):v.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else v.ULS.shipAssertTag(593506372,324,!1)}jpf(b,h=!1,r=!1){const A=this.Xb.MF(b).mh(Jl.StyleReader.wordStyleIdNormal);this.gQ(A,b,h,void 0,r)}ZMg(b,h){(b=Object(fn.a)().Nu(b))&&h.PAg(b)}qei(b){var h=null;if(!b||!b.count)return v.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=zi.a.Qp(),!h))return v.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),
!1;var r=this.d1.lla(h);if(!r)return v.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var A=new Map;A.set("NumberOfStyles",b.count.toString());A.set("Source","DeleteStyleAPI");za.Health.instance.recordKpiUsage(Or.a.KGe,0,Or.a.$B,A);A=0;const M=(new Date).getTime();var ba=null;let oa=null,Ja=null,jb=null;const zb=this.qc.isFeatureEnabled(29)&&!0;zb&&(ba=new qb.a,oa=new qb.a,Ja=new qb.a,jb=new qb.a);for(var Eb of b){if(!Eb)return v.ULS.sendTraceTag(592221655,
3018,50,"Style ID is null."),!1;const Sb=r.hWa(Eb);if(!Sb||!this.Xb.me(Sb,r))return v.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!Sb,!!Sb&&this.Xb.me(Sb,r)),!1;const nc=this.Xb.NF(Sb);if(2!==nc&&1!==nc)return v.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",nc),!1;const Dc=this.Xb.xkc(Sb,r);let Zc=0;if(Dc){if(!this.Xb.me(Dc,r))return v.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),
!1;Zc=this.Xb.NF(Dc);if(2!==Zc&&1!==Zc)return v.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",nc,Zc),!1}else v.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let Gd=this.DNb(Sb,r);if(!Gd)return!1;A++;zb&&(1===nc?(oa.add(Eb),jb.add(Sb.id)):(ba.add(Eb),Ja.add(Sb.id)));if(Dc){Gd=this.DNb(Dc,r);if(!Gd)return!1;A++;zb&&(1===Zc?(oa.add(this.Xb.Be(Dc)),jb.add(Dc.id)):(ba.add(this.Xb.Be(Dc)),Ja.add(Dc.id)))}}dB.a.snc();
r=zi.a.vOf(r);Eb=new Qb.GraphTransaction(15);Eb.Ab(h);zb&&this.uCo(ba,oa,Ja,jb,h);h.setValue(Yf.a.Nha,r);Tc.b(572302817,3018,50,String.format("Style Object Ids - {0}",r));Eb.nxe();Eb.dispose();h=(new Date).getTime();ba=new Map;ba.set("Source","DeleteStyleAPI");ba.set("NumberOfStyles",b.count.toString());ba.set("TrueStyleCount",A.toString());ba.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new bb.a,{extendedProperties:ba,durationMs:h-M});za.Health.instance.recordKpiSuccess(Or.a.KGe,
b);return!0}uCo(b,h,r,A,M){if(b&&b.count||h&&h.count)if(M){var ba=(new Date).getTime();if(M=this.wrm(M)){for(;M.moveNext();){if(!Ed.ParagraphReader.Eh(M.iterator))continue;const oa=M.currentNode;this.cCo(oa,b,r);this.dCo(oa,h,A)}r=(new Date).getTime();v.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",r-ba));A=new Map;A.set("Source","DeleteStyleRemoveStylesReferences");A.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new bb.a,{extendedProperties:A,
durationMs:r-ba});za.Health.instance.recordKpiSuccess(Or.a.KGe,b)}}else Tc.b(577520338,3018,50,"PageContentNode not provided.");else Tc.b(577520337,3018,50,"No style IDs provided")}cCo(b,h,r){if(h&&h.count&&b){var A=b.Nx;A&&A.hasProperty(Yf.a.fx)&&r.contains(A.getValue(Yf.a.fx))&&(A.removeProperty(Yf.a.fx),b.Nx=A,b.UA()&&this.Oj.fQ(b,b.UA(),this.Pd.Ag));(r=this.Xb.Hq(b))&&(r=this.Xb.Be(r))&&h.contains(r)&&this.jpf(b,!0,!0)}}dCo(b,h,r){if(b&&b.ra&&b.ra.length&&h&&h.count)for(let oa=0;oa<b.ra.length;oa++){var A=
b.ra.K(oa);if(A&&A.formatting&&(A=A.formatting)&&A.Jb){var M=xa.FormattingReader.kBa(A);M&&(M=this.Xb.Be(M))&&h.contains(M)&&this.xj.apf(A);if(M=A.Jb.Oo){var ba=M.uo;ba&&(ba=ba.clone(),ba.hasProperty(Yf.a.Jw)&&r.contains(ba.getValue(Yf.a.Jw))&&this.iAo(b,ba,M,A));ba=oa===b.ra.length-1?b.characterData.length:b.ra.K(oa+1).cp;this.Oj.T_b(b,A.Jb,A.Jb.cp,ba,M,A,this.Pd.Ag)}}}}iAo(b,h,r,A){b&&h&&r&&A&&(b=b.Ic)&&(h.removeProperty(Yf.a.Jw),h.VLa?h=b.WP(h,!0):b.nu(h,null),r.Lk=h.id,A.Jb.Oo=r)}wrm(b){if(!b)return null;
b=zc.a.Za(b);return b.yq()?Be.a.Bt(b,b.origin):null}DNb(b,h){if(!b)return v.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var r=b.Yi();return this.Xb.p0(r)?h.Psg(b)?!0:(r=new Map,r.set("Source","DeleteStyle"),r.set("StyleType",RC[this.Xb.NF(b)]),r.set("IsCustomStyle",this.Xb.me(b,h).toString()),r.set("IsLinkedStyle",(!!this.Xb.xkc(b,h)).toString()),b=Object.assign(new bb.a,{extendedProperties:r}),za.Health.instance.recordKpiFailure(Or.a.KGe,"UnableToDeleteStyle",!1,
!0,b),v.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(v.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}Xbb(b,h,r,A){if(this.qc&&this.qc.isFeatureEnabled(73)){if(!b)return v.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!r&&(r=zi.a.Qp(),!r))return v.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ba=this.d1.lla(r);if(!ba)return v.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),
!1;b=ba.hWa(b);if(!b)return v.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var M=this.Xb.NF(b);if(2!==M&&1!==M)return v.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",M),!1;za.Health.instance.recordKpiUsage(Or.a.sPg,0,Or.a.$B,new Map([["Source","ModifyStyleAPI"]]));M=Date.now();const oa=new Qb.GraphTransaction(15);let Ja,jb;try{oa.Ab(r);if(!(A&&0!=A.length||h&&0!=h.count))return!1;if(A&&0!=A.length&&(Ja=zi.a.R3c(b),!ba.Nwf(b,A)))return this.gMa("ModifyStyleAPI",
b,ba,M,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const Dc=ba.YMg(b,h);jb=zi.a.R3c(b);if(!Dc)return this.gMa("ModifyStyleAPI",b,ba,M,"UnableToModifyStyle"),!1}this.bQn(b,r,jb,Ja);dB.a.snc();const zb=zi.a.vOf(ba);r.setValue(Yf.a.Nha,zb);Tc.b(572302818,3018,50,String.format("Style Object Ids - {0}",zb));const Eb=Date.now(),Sb=new Map([["Source","ModifyStyleAPI"]]),nc=Object.assign(new bb.a,{extendedProperties:Sb,durationMs:Eb-M});za.Health.instance.recordKpiSuccess(Or.a.sPg,nc);return!0}finally{oa&&
oa.dispose()}}return!1}bQn(b,h,r,A){var M,ba;if(null!==b){var oa;A&&((oa=null===(M=this.Ll)||void 0===M?void 0:M.ltd(h,A,b,!0))||Tc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));r&&((oa=null===(ba=this.Ll)||void 0===ba?void 0:ba.ltd(h,r,b,!1))||Tc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}gMa(b,h,r,A,M){const ba=Date.now(),oa=!!this.Xb.xkc(h,r);b=new Map([["Source",b],["StyleType",RC[this.Xb.NF(h)]],
["IsCustomStyle",this.Xb.me(h,r).toString()],["IsLinkedStyle",oa.toString()]]);A=Object.assign(new bb.a,{extendedProperties:b,durationMs:ba-A});za.Health.instance.recordKpiFailure(Or.a.sPg,M,!1,!0,A)}}Object(u.a)(QE,"WACStyleEditor",null,[1486]);class lB extends QE{constructor(b,h,r){super(b,r);this.V9=h}get fu(){return this.V9.value}ISd(b,h){this.fu.ISd(b,h)}}Object(u.a)(lB,"WACStyleEditor",QE,[]);class YG{qeb(b,h){b.properties.setValue(Rc.a.marginTop,h)}oeb(b,h){b.properties.setValue(Rc.a.marginBottom,
h)}Ena(b,h){b.properties.setValue(Rc.a.marginLeft,h)}peb(b,h){b.properties.setValue(Rc.a.marginRight,h)}oAg(b,h){b.properties.setValue(Rc.a.Bp,h)}nAg(b,h){b.properties.setValue(Rc.a.vw,h)}WOj(b,h){b.properties.setValue(Rc.a.y5i,h)}O_b(b,h){b.properties.setValue(le.a.ZG,h)}AUo(b,h){b.properties.setValue(le.a.rra,h)}jxc(b,h){b.properties.setValue(le.a.iI,h)}c0o(b,h){b.properties.setValue(le.a.separator,h)}}Object(u.a)(YG,"WordSectionEditor",null,[401]);class RE{get name(){return"WordEditor.OutlineLevelEditors"}uc(b){b.ia("WordEditor.OutlineLevelEditors.WordSectionEditor",
()=>new YG).as(1155).ha();y.AFrameworkApplication.J.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ia("Box4.OutlineLevelEditors.PageContentEditor",()=>new Pz(b.resolve(110))).as(102).ha(),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Qo(rv.a.Q9a,b.resolve(455),b.rf(16),b.rf(620),b.resolve(949))).as(661),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Qo(rv.a.Q9a,b.resolve(455),b.rf(16),b.rf(620),b.resolve(949))).as(950),b.ia("WordEditor.OutlineLevelEditors.CursorMoveValidator",
()=>new OE).as(1094).ha(),b.ia("Box4.Styles.WACStyleReader",()=>new XG.a(new lu.WACStyleSet)).as(8).ha(),b.ia("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new lB(b.resolve(10),b.rf(620),b.rf(31))).as(393).ha())}init(){}dispose(){}static main(){E.a.instance.Mc(new RE)}}Object(u.a)(RE,"WordEditorOutlineLevelEditorsPackage",null,[0,1]);var ZG=d(593),SE=d(206);class Xn{constructor(b,h){this.Nd=b;this.Rh=h;this.uSa=null}jYo(b,h,r){en.a.Don||({listId:h,listLevel:r}=mf.ListItemReader.rLf(b,{Ora:0,
NUa:-1}));if(0<h&&0<=r)this.uSa=b;else{let A=1;const M=b.listStyle;42!==M&&0<M&&(A=M);this.uSa=Qu.a.$W(b.listType,A,null,h,r,void 0,"")}h=new HE.a;switch(b.n9){case 0:this.uSa.eB=h.itf();break;case 2:this.uSa.eB=h.w9h(h.rYh,h.qYh);break;case 1:this.uSa.eB=h.cuf(h.odg,h.pdg)}}zZo(b){b&&(this.uSa=b)}Q$h(b){var h=Wg.a.instance.wq(ub.a.qIl);Ua.a.Qh(b)||(v.ULS.sendTraceTag(508904658,393,15,"PossiblyIncorrectListCreation - createList called with a non OE iterator"),Wg.a.instance.$b("PossiblyIncorrectListCreation",
{["Reason"]:Ff.a.UNb}));mf.ListItemReader.Dg(b)&&(v.ULS.sendTraceTag(508904657,393,15,"PossiblyIncorrectListCreation - createList called when OE already has list"),Wg.a.instance.$b("PossiblyIncorrectListCreation",{["Reason"]:Ff.a.LAl}));const r=Ua.a.yN(b);r&&!r.hasProperty(Rc.a.uAa)&&v.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");if(mf.ListItemReader.De&&b.Ub(4))return v.ULS.sendTraceTag(508412242,393,15,"PossiblyIncorrectListCreation - createList called when OE already has numberListNode"),
h=b.currentNode,b.rc(),h;mf.ListItemReader.De&&b.Ub(31)&&b.Tg();const A=this.uIl();b.Wf(A,4);r&&(r.qE=A);h.end();return A}uIl(){return Hq.a.instance.createInstance(rn.a.pcb)}dha(b){const h=Wg.a.instance.wq(ub.a.dha);Ua.a.Qh(b)||Wg.a.instance.$b("PossiblyIncorrectListRemoval",{["Reason"]:Ff.a.UNb});mf.ListItemReader.Dg(b)&&(ch.a.getInstance().Ku?this.nca(b):this.hDj(b));h.end()}hDj(b){this.Nd.y0(b);b.Tg()}V_i(b){let h=!1;1===b.$s&&b.Ita&&!b.ZL&&(h=!0);const r=b.ef.ka(Rc.a.Yw,null);r&&r===Box4Intl.Box4Strings.L_ListStyleNone&&
(1===b.listType?h=b.Ita&&!b.ZL:b.listType||(h=!b.listStyle));return h}Qqa(b,h,r,A=!1){const M=Wg.a.instance.wq(ub.a.E8k);this.UPj(b,r,A);const ba=b.hasProperty(Bd.a.vgj);var oa=b.ka(Bd.a.ide,!1);const Ja=this.V_i(r);if(oa)Ja&&(r.zca(16,0),b.setValue(Bd.a.iC,16),b.setValue(Bd.a.dYa,0));else{oa=this.Nd.Tw(h);this.PCg(r,oa,ba,Ja)&&(M.properties.W("ToggledOff","true"),r.zca(16,0),this.mYo(b));if(!this.Xpe(b,h,r,A))return M.end(),v.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),
{returnValue:!1,Rla:r};!r.listType&&b.hasProperty(Bd.a.cMa)&&(r.JD=b.getValue(Bd.a.cMa),b.removeProperty(Bd.a.cMa))}if(ba&&(M.properties.W("MultipleOESelection","true"),this.WTj(h,r)))return M.end(),v.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),{returnValue:!1,Rla:r};this.m4k(h,r,b,A);Qs.SGj();b.hasProperty(Fe.a.RT)&&Qs.OEl(b.getValue(Fe.a.RT),h,this.Nd);b.setValue(Bd.a.ide,!0);M.end();return{returnValue:!0,Rla:r}}PCg(b,h,r,A){if(A)return!0;if(h){A=b.listType===
h.listType;const M=!b.listStyle&&b.JD===fk.a.Pk;let ba=b.listStyle===h.listStyle&&b.JD===h.JD;b=(!b.Ita||this.Kwg(h,b))&&!r;ba=ba&&b;return A&&(M||ba)}return!1}mYo(b){b.setValue(Bd.a.iC,16);b.setValue(Bd.a.dYa,0)}Kwg(){return!0}UPj(){}Xpe(){return!0}WTj(b,h){return h&&16!==h.listType&&Ua.a.isEmpty(b,!0)}LVc(b){const h=Wg.a.instance.wq(ub.a.LVc);Ed.ParagraphReader.Vb(b)||Wg.a.instance.$b("ClearingListFromNonParagraph",{["Reason"]:Ff.a.dzf});const r=new zc.a;r.set(b);r.Ld();r.mt(12);Ab.OutlineElementNavigator.ke(r);
this.nca(r);h.end()}merge(b,h,r){const A=Wg.a.instance.wq(ub.a.kCn);Ua.a.Qh(h)||Wg.a.instance.$b("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Ua.a.Qh(b)||Wg.a.instance.$b("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});mf.ListItemReader.Dg(h)&&(A.properties.W("UseSourceListWithNonlistDestination",r.toString()),r&&mf.ListItemReader.Dg(b)&&this.dha(b),mf.ListItemReader.Dg(b)&&!r?this.wwj(h,b):r&&(r=this.uBi(h),1===r.$s&&r.Mof(!0),this.FKb(b,r),A.properties.W("MoveListInfoFromSrcToDestOE",
"true")),this.dha(h),A.properties.W("RemoveListFromSrcOE","true"));A.end();return!0}wwj(){}uBi(b){return this.Nd.Tw(b)}Q_c(b,h){h.hasProperty(Bd.a.iC)||(b===ub.a.fF?h.setValue(Bd.a.iC,1):(b===ub.a.aO||b===ub.a.yga)&&h.setValue(Bd.a.iC,0));h.hasProperty(Bd.a.dYa)||h.setValue(Bd.a.dYa,0);return h}Qdc(b,h,r,A,M,ba,oa,Ja){const jb=Wg.a.instance.wq(ub.a.Qdc),zb=this.Nd.Tw(h);r=Qu.a.$W(0,r,void 0,void 0,void 0,oa);r.JD=A;r.RT=ba;zb&&r.FSf(zb)&&r.JD===zb.Jx||(A=new Qb.GraphTransaction(15),A.pu(h),Ja.KVn(r.listType,
r.listStyle,r.JD,r.levelText,r.RT)&&(Xn.Bg.Ue(M,""),!mf.ListItemReader.De&&Ed.ParagraphReader.Vb(b)&&SE.a.jma(b)&&(h=this.Nd.zfa(b))&&Xn.Bg.m2l(b,h)),A.dispose());jb.end()}ltd(b,h,r,A=!1){if(null===r||null===b||null===h)return!1;b=this.Nd.$y(b,h.listId,h.listLevel);if(!b)return v.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(A){if(b.hasProperty(Yf.a.fx)){b.getValue(Yf.a.fx)instanceof P.a||v.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");
if(!P.a.xt(b.getValue(Yf.a.fx),r.id))return v.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(Yf.a.fx);return!0}}else{r=r.id;r instanceof P.a||v.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(Yf.a.fx))return v.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(Yf.a.fx,
r);return!0}return!1}static get Zic(){return null!=Xn.hXg?Xn.hXg:Xn.hXg=$a.a.instance.Oa(118)}static get Bg(){return null!=Xn.dUg?Xn.dUg:Xn.dUg=$a.a.instance.resolve(323)}static get Es(){return ch.a.getInstance()}}Object(u.a)(Xn,"ListEditor",null,[548]);var Qz=d(802),ex=d(321);class vu{constructor(b,h,r,A,M,ba){this.kg=M;this._pageContent=r;this.mGb=Array(vu.OI);this.Tac=Array(vu.OI);this.fGh=Array(vu.OI);this.O6e=Array(vu.OI);this.sCh=Array(vu.OI);this.W5=A;this.LRc=ba;for(A=0;A<vu.OI;A++){var oa=
this.Q3c(b,A,r,M);oa?(ba=oa.ka(ze.a.VU,fk.a.Pk),oa=oa.ka(Rc.a.VZb,fk.a.Pk)):oa=ba=fk.a.Pk;this.Tac[A]=ba!==fk.a.Pk?ba:fk.a.R7a;this.O6e[A]=oa===fk.a.Pk?A-1:oa-1;vu.Eba(h)&&(this.fGh[A]=fk.a.Pk,this.sCh[A]=fk.a.Pk);this.mGb[A]=this.Tac[A]}}Q3c(b,h,r,A){A.Y6(r);return ch.a.getInstance().P8c&&this.LRc?this.kg.CLf(b,h,this.W5,r):this.kg.T3c(b,h,r.Ic,r)}restart(b){this.mGb[b]=this.Tac[b]}gle(b){for(var h=0;h<b;h++)this.mGb[h]===this.Tac[h]&&this.mGb[h]++;for(h=b+1;h<vu.OI;h++)this.O6e[h]>=b&&this.restart(h);
return this.mGb[b]++}static Eba(b){return!!b&&b.isFeatureEnabled(63)}}vu.OI=9;Object(u.a)(vu,"AWordList",null,[1630]);class SC{constructor(b,h,r,A){this.Ijb=new nr.ScriptSharpLegacyMap;this.kg=b;this.YM=h;this.W5=r;this.LRc=A}Tw(b,h){this.Ijb.mb(b)||this.Ijb.W(b,new vu(b,h,this.YM,this.W5,this.kg,this.LRc));return this.Ijb.K(b)}fsc(b,h,r){return this.Tw(b,r).gle(h)}}Object(u.a)(SC,"AListNumberingMap",null,[1629]);class $G extends vu{constructor(b,h,r,A,M,ba){super(b,h,r,A,M,ba)}AMf(b,h,r,A){A.Y6(r);
return ch.a.getInstance().P8c&&this.LRc?this.kg.Xzm(b,h,this.W5):this.kg.Wzm(b,h,this._pageContent.Ic)}dtd(b,h,r){var A=this.AMf(b,h,this._pageContent,this.kg);A?(b=A.ka(ze.a.VU,fk.a.R7a),A=A.ka(Rc.a.VZb,fk.a.Pk),this.mGb[h]=this.fGh[h]=this.Tac[h]=b,A!==fk.a.Pk&&(this.sCh[h]=this.O6e[h]=A-1)):r&&(A=this.Q3c(b,h,this._pageContent,this.kg),b=fk.a.R7a,A&&(b=A.ka(ze.a.VU,fk.a.R7a)),this.mGb[h]=this.Tac[h]=b)}}Object(u.a)($G,"WordList",vu,[]);class TC extends SC{constructor(b){super(b.Nd,b.Vh,b.jB,b.R$j);
this.JAh=new qb.a}sLf(b,h,r){let A;ch.a.getInstance().o0?{value:A}=this.kg.XF.Ec(b,A):{value:A}=this.kg.D3.Ec(b,A);this.Ijb.mb(A)||this.Ijb.W(A,new $G(b,r,this.YM,this.W5,this.kg,this.LRc));if(!this.JAh.contains(b))for(this.JAh.add(b);h<fk.a.OI;h++)this.Ijb.K(A).dtd(b,h,!1);else if(!h)for(h+=1;h<fk.a.OI;h++)this.Ijb.K(A).dtd(b,h,!0);return this.Ijb.K(A)}fsc(b,h,r){return vu.Eba(r)?this.sLf(b,h,r).gle(h):super.fsc(b,h,r)}}Object(u.a)(TC,"ListNumberingMap",SC,[]);class aH{constructor(){this.Dvb=0;this.Ebk=
!1}}Object(u.a)(aH,"LastNumber",null,[]);var bH=d(383);class vq{constructor(b,h,r,A){this.nle=!1;this.fu=b;this.OZi=r;this.Anc=A;this.vv=this.fu.yE(h);this.oS=new zc.a;this.oS.kd(h)}static get Nd(){return vq.kg||(vq.kg=$a.a.instance.resolve(10))}static set Nd(b){vq.kg=b}static get Es(){return ch.a.getInstance()}static i$l(b,h,r,A=!1,M=!1){var ba=h.currentNode;let oa=null,Ja=!1,jb=!1;h=h.$2b();const zb=Be.a.Zo(h);zb.moveNext();for(h=zb.iterator;h.currentNode!==ba;){let Sb=jb=Ja=!1;var Eb=vq.$Yl(h);
if(Ua.a.Qh(h)&&!Eb){Eb=!1;if(h.pv(4))if(vq.Iij(h,r,!0,A,M)){if(Sb=!0,oa=new vq(b,h,!1,!1),zb.moveNext(),zb.iterator===ba&&(Ja=!0),A)break}else Ua.a.isEmpty(h,!1)||(Eb=!0),jb=!0;else!Ua.a.isEmpty(h,!1)&&h.q$a(12)&&(Ua.a.eU(h)||(Eb=!0));!A&&Eb&&oa&&(r.ef.hasProperty(Rc.a.listLevel)?oa.vv.level=0:oa=null)}Sb||zb.moveNext();h=zb.iterator}oa&&(oa.Anc=Ja);if(!oa&&h.Nf(1))for(ba=!0;h.currentNode;){if(Ua.a.Qh(h)){if(h.pv(4)&&vq.Iij(h,r,!1,A,M)){oa=new vq(b,h,!0,ba);break}if(!Ua.a.isEmpty(h,!1))break}if(!h.Nf(1))break;
ba=!1}oa&&(oa.nle=jb);return oa}static $Yl(b){var h=b.Ub(2);if(!h)return!1;h=Ed.ParagraphReader.Eh(b)&&vq.Lqn(h);b.rc();return h}static Lqn(b){return bm.a(b,8)}static Iij(b,h,r,A=!1,M=!1){if(!mf.ListItemReader.Dg(b)&&(v.ULS.sendTraceTag(508913603,393,15,"Trying to call oeMatchesInfo for non list item"),mf.ListItemReader.De))return!1;if(mf.ListItemReader.De)var ba=mf.ListItemReader.s7(b);else vq.Nd.y0(b),ba=b.currentNode,b.rc();const oa=vq.Nd.b3(ba);(b=h.$z===oa.$z)&&h.listStyle&&1!==h.$s&&(b=h.listStyle===
oa.listStyle);b&&(h.Ita&&1!==h.$s||h.ojc||M)&&(b=vq.von(h,oa),h.$z||(b=b&&h.font===oa.font));if(1===h.$s)if(1===oa.$s&&oa.ef.hasProperty(Fe.a.Pub))b=h.n9===oa.n9;else return!1;b&&h.$z&&h.JD!==fk.a.Pk&&(b=oa.Jx,r&&(A&&1===h.JD&&1===b||b++),b=h.JD===b);b&&(A||h.ojc)&&(h=mf.ListItemReader.rLf(h,{Ora:0}).listId,ba=mf.ListItemReader.Nr(ba,{Ora:0}).listId,0<h&&0<ba&&(b=h===ba));return b}static von(b,h){h=h.b7i;b.Ita&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.b7i.toLocaleLowerCase()}static j$l(b,
h,r){var A=h.currentNode;let M=null;const ba=new zc.a,oa=b.cBa(A,r);var Ja=!1;let jb=!1;ba.kd(h);ba.rc();for(ba.Ub(1);ba.currentNode!==A;)jb=Ja=!1,Ua.a.Qh(ba)&&ba.pv(4)&&(h=b.yE(ba),vq.Jij(h,r,!0)?(M=new vq(b,ba,!1,!1),Ja=!0):(jb=!0,h.listID===r.listID&&h.level<=oa.Idb&&(M=null))),ba.Nf(1);M&&(M.Anc=Ja);if(!M&&ba.Nf(1))for(A=!0;ba.currentNode;){if(Ua.a.Qh(ba)&&ba.pv(4)){Ja=b.yE(ba);if(Ja.listID===r.listID&&Ja.level<=oa.Idb)break;if(vq.Jij(Ja,r,!1)){M=new vq(b,ba,!0,A);break}}if(!ba.Nf(1))break;A=
!1}M&&(M.nle=jb);return M}static Jij(b,h,r){let A=b.listID===h.listID&&b.level===h.level;A&&h.Jx!==fk.a.Pk&&(b=b.Jx,r&&b++,A=h.Jx===b);return A}}vq.kg=null;Object(u.a)(vq,"JoinTargetInfo",null,[]);class wq{constructor(b,h){this.vv=null;this.action=b;h&&(this.vv=h)}static ccb(){return new wq(0)}static G4f(){return new wq(1)}static MBn(b){return new wq(3,b)}static cCn(b){return new wq(2,b)}static PBn(b){return new wq(4,b)}}Object(u.a)(wq,"ApplyListInfoResult",null,[]);class cH{constructor(){this.startAt=
this.Idb=0}}Object(u.a)(cH,"WordListRestartInfo",null,[]);var UC=d(891);class Rz{constructor(b,h,r){this.tqd=r;this.lgd=h.listID}}Object(u.a)(Rz,"ListTransferInfo",null,[]);class bu extends Xn{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){super(b,r,jb);this.KI=nc;this.IFh=!1;this.kGc=this.Hzd=this.o6b=null;this.fAe=(Dc,Zc)=>Zc.listID===Dc.listID&&Zc.level===Dc.level;this.Qap=(Dc,Zc,Gd)=>Zc.listID!==Dc.listID&&Zc.listID!==Gd.lgd||Zc.level!==Dc.level?!1:!0;this.iMn=(Dc,Zc,Gd)=>Zc.listID===Dc.listID||
Gd&&Zc.listID===Gd.lgd?!0:!1;this.ZVj=(Dc,Zc,Gd,de)=>{ch.a.Xs||this.YVj(Dc,Zc,Gd,de)};this.YVj=(Dc,Zc,Gd,de)=>{if(!ch.a.Xs){if(mf.ListItemReader.De){const {listId:he}=mf.ListItemReader.Nr(Zc);he!==Gd&&v.ULS.sendTraceTag(508347426,393,15,`siblingRenumberAndUpdateSublists: existingListId:${he} newListId:${Gd}`)}ch.a.getInstance().Nt||this.KI.GAb(Dc,Gd);Zc=mf.ListItemReader.De?Zc:Dc;Dc=this.Akc(Zc);Zc=zc.a.Za(Zc);Zc.Ld();Zc.rc();this.wdm(Zc,Dc,this.iMn,this.nhp,de)}};this.Sap=(Dc,Zc,Gd,de)=>{if(!ch.a.Xs){var {vv:he,
iterator:fe}=this.lhc(Zc,()=>{if(mf.ListItemReader.De){var {listId:Yd}=mf.ListItemReader.Nr(Zc);Yd!==Gd&&v.ULS.sendTraceTag(508347424,393,15,`siblingRenumberAndUpdateListID: existingListId:${Yd} newListId:${Gd}`)}ch.a.getInstance().Nt||this.KI.GAb(Dc,Gd);ch.a.getInstance().Ku&&this.KI.GAb(Zc,Gd);var Td=mf.ListItemReader.De?Zc:Dc;Yd=this.Akc(Td);Td=zc.a.Za(Td);Td.Ld();Td.rc();return{vv:Yd,iterator:Td}});this.l4d(fe,he,this.yZj,this.rBe,de)}};this.lhp=(Dc,Zc,Gd,de)=>{ch.a.Xs||this.Vyj(Dc,Zc,Gd,de)};
this.rBe=(Dc,Zc,Gd,de)=>{Gd.listID=Zc.listID;de.Ub(4);const he=this.Ss.aWa(de.currentNode);this.lhc(he,()=>{this.ETc(de.currentNode,Gd,he);de.rc()})};this.nhp=(Dc,Zc,Gd,de)=>{!ch.a.Xs&&mf.ListItemReader.Dg(de)&&(Dc=new zc.a,Dc.kd(de),Dc.Ld(),this.Nd.y0(Dc),this.xen(de.currentNode,Dc.currentNode))};this.mhp=(Dc,Zc,Gd,de)=>{Gd.listID=Zc.listID;this.Vyj(Dc,Zc,Gd,de);this.rBe(Dc,Zc,Gd,de)};this.xZj=(Dc,Zc)=>Zc.listID===Dc.listID;this.khp=(Dc,Zc)=>Zc.level<=Dc.level;this.yZj=(Dc,Zc,Gd)=>Zc.listID===Gd.lgd;
this.Xp=M;this.ixa=b;this.IDd=h;this.Qc=A;this.okg={};this.yEk=ba;this.Xd=oa;this.oq=Ja;this.Cd=zb;this.hy=Eb;this.hw=Sb}get Eba(){return this.ixa.ima}get czb(){return this.IFh}set czb(b){this.IFh=b}get Ss(){return this.ixa}get Mha(){return this.hw}get Xb(){return this.hy}get Zs(){return this.Ss.Zs}get Xq(){return this.Ss.Xq}get Lya(){return this.Ss.Lya}get Bba(){return this.Ss.Bba}set Bba(b){this.Ss.Bba=b}get YXa(){return this.Ss.YXa}set YXa(b){this.Ss.YXa=b}get Upd(){return null!=this.i4g?this.i4g:
this.i4g=$a.a.instance.Oa(882)}m4k(b,h,r,A){v.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const M=r.ka(Bd.a.ide,!1);let ba=!1,oa=-1;!M||h.listStyle&&1!==h.$s||(ba=!r.ka(Bd.a.B2f,!1),oa=r.ka(Bd.a.l4f,-1));b=this.FKb(b,h,{iRi:ba,kBn:oa,gqb:A,ef:r});M||r.setValue(Bd.a.B2f,2===b.action);3===b.action&&!r.hasProperty(Bd.a.l4f)&&b.vv&&r.setValue(Bd.a.l4f,b.vv.level)}merge(b,h,r,A=null){const M=mf.ListItemReader.Dg(b)||mf.ListItemReader.Dg(h);b=super.merge(b,h,r,A);M&&this.Z0();
return b}wwj(b,h){this.Gnl(b,h)}Gnl(b,h){b=mf.ListItemReader.De?mf.ListItemReader.sla(b,{NUa:-1}).listLevel:this.Nd.vLf(b);const r=mf.ListItemReader.De?mf.ListItemReader.sla(h,{NUa:-1}).listLevel:this.Nd.vLf(h);-1!==b&&-1!==r&&(b-=r,0<b?this.IDd.value.bZc(h,b):0>b&&this.IDd.value.CZa(h,b,0))}hDj(b){this.Nd.y0(b);b.Tg();this.Z0()}ZJg(b,h,r,A){var M=zc.a.Za(r);M=this.yE(M);const ba=this.X_b(b,M,!ch.a.getInstance().Ku);if(!ch.a.Xs){b=this.Ss.J9a(b.currentNode,M);b.listType||(ba.setValue(Xn.Es.Aoa,M.Jx),
ba.setValue(Xn.Es.jFa,M.SZc),this.mFj(ba,M,h?r:A));switch(b.listType){case 0:h="Numbering";break;case 1:h="Bullet";break;default:h="Invalid List Type"}y.AFrameworkApplication.va.Ob(ub.a.A2f,2);v.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",h);ch.a.getInstance().Nt||this.KI.W_b(ba,M.listID,M.level)}}yE(b){if(!mf.ListItemReader.Dg(b)&&(v.ULS.sendTraceTag(508924048,393,15,"Trying to fetch list Ref info for non list item"),mf.ListItemReader.De))return null;let h;mf.ListItemReader.De?
h=mf.ListItemReader.s7(b):(this.Nd.y0(b),h=b.currentNode,b.rc());return this.Akc(h)}JYo(b,h){this.Nd.y0(b);const r=b.currentNode;b.rc();ch.a.getInstance().Nt||this.KI.GAb(r,h);b=Ua.a.yN(b);ch.a.getInstance().Ku&&this.KI.GAb(b,h);this.Akc(mf.ListItemReader.De?b:r)}Akc(b){var h;const r=new Qz.a;mf.ListItemReader.De&&(b&&Ed.ParagraphReader.Vb(b)||v.ULS.sendTraceTag(509141474,393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===(h=null===b||void 0===b?void 0:b.constructor)||void 0===
h?void 0:h.name}`));h=mf.ListItemReader.De?mf.ListItemReader.Nr(b)||mf.ListItemReader.yla(b):this.Nd.K_(b,!1,!0);r.listID=h.listId;r.level=h.listLevel;r.r0=mf.ListItemReader.U$d(b);h=this.x7d(b);r.tWo(h);r.Jx=mf.ListItemReader.W9d(b);r.SZc=mf.ListItemReader.eQf(b);return r}X_b(b,h,r=!1){const A=Ua.a.yN(b);b=ch.a.getInstance().Nt?null:this.Q$h(b);this.ETc(b,h,A,r);return b}ETc(b,h,r=null,A=!1){ch.a.getInstance().Nt||b||Wg.a.instance.$b("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!ch.a.getInstance().Ku||
A||r||Tc.b(509364259,393,15,"Apply list ref info called without para node");h||Wg.a.instance.$b("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});ch.a.getInstance();ch.a.getInstance().Ku&&r&&(ch.a.iu?!h.r0:!A)&&this.KI.W_b(r,h.listID,h.level);ch.a.getInstance().oma&&(r=r||this.Nd.aWa(b),this.KI.HCo(r));ch.a.getInstance().Nt||(this.KI.W_b(b,h.listID,h.level),h.r0&&b.setValue(Rc.a.r0,!0),ch.a.getInstance().Ku||null==h.levelText||b.setValue(Rc.a.Yw,h.levelText))}B8j(b){this.Ss.Y6(b);b=Object(fn.a)().Nu(b);
let h=b.ka(Rc.a.Xq,null);h=h?Array.clone(h):[];b.setValue(Rc.a.Xq,h);this.Ss.rnc()}Xgp(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}Izm(b){b=b.view;if(!b.lb||!b.lb.gb)return null;b=wy.OutlineElementGeneralizer.gla(b.lb.gb,!1);if(1!==b.length)return null;b=zc.a.Za(b.getContext(0).node);if(!mf.ListItemReader.Dg(b))if(14===b.$d().type){const h=mf.ListItemReader.ryi(b.currentNode);h&&b.set(h)}else Tc.b(589177753,393,15,
"Encountered an OE of non list type."),b.rc();b.Ld();return b}bJl(b,h,r,A){const M=b.GL(),ba=new Qz.a;ba.listID=this.hai(b);this.Eba?(ba.Ihe=Xn.Es.o0?this.iai(b):this.$$h(b),this.Rzj(b,ba.listID,ba.Ihe)):this.Tzj(b,ba.listID);ba.cPj(h.ef,this.zbd(r));this.o1d(b);r=this.rBi(b,h);for(let Ja=0;9>Ja;Ja++){const jb=new Qp.a;M.ud.nu(jb);this.Szj(b,this.Eba?P.a.nil:jb.id,this.Eba?jb.id:P.a.nil);this.TWk(jb,h.$z,Ja);this.fOh(jb,r,Ja);var oa=A.bVb[Ja];oa=6===oa?Qu.a.$W(1,1):Qu.a.$W(0,oa);oa.yma&&jb.setValue(ze.a.e8,
oa.yma);h.JD!==fk.a.Pk&&Ja===ba.level&&jb.setValue(ze.a.VU,h.JD);A.hKa&&A.hKa[Ja]&&jb.setValue(ze.a.font,A.hKa[Ja]);oa=A.Bbd[Ja];v.ULS.shipAssertTag(22127636,338,!!oa);jb.setValue(Rc.a.Yw,oa);jb.setValue(Rc.a.rga,A.Tge[Ja]);ex.a.Eye(A.n9,jb)}return ba}$Il(b,h,r){const A=b.GL(),M=new Qz.a;M.listID=this.hai(b);this.Eba?(M.Ihe=Xn.Es.o0?this.iai(b):this.$$h(b),this.Rzj(b,M.listID,M.Ihe)):this.Tzj(b,M.listID);M.cPj(h.ef,this.zbd(r));if(!h.listStyle)switch(M.level%3){case 0:h.zca(h.listType,1);break;case 1:h.zca(h.listType,
2);break;case 2:h.zca(h.listType,3)}this.o1d(b);r=this.rBi(b,h);for(let ba=0;9>ba;ba++){const oa=new Qp.a;A.ud.nu(oa);this.Szj(b,this.Eba?P.a.nil:oa.id,this.Eba?oa.id:P.a.nil);this.SWk(oa,h.$z,ba);this.fOh(oa,r,ba);2===ba%3&&h.$z?oa.setValue(Rc.a.rga,"right"):oa.setValue(Rc.a.rga,"left");ba===M.level&&(h.yma&&oa.setValue(ze.a.e8,h.yma),h.JD!==fk.a.Pk&&oa.setValue(ze.a.VU,h.JD),h.$z?this.gPj(h,oa,ba):(bu.dPj(h,oa),bu.fPj(h,oa)),bu.ePj(h,oa),h.ojc&&oa.Mza(h.ef,Rc.a.listID,Rc.a.listLevel))}return M}gPj(b,
h,r){b.Ita?(b=b.levelText,b=C.a.replaceAll(b,"%1","%"+(r+1))):b=b.A8c||b.wBa?b.levelText:"%"+(r+1)+".";v.ULS.shipAssertTag(22127638,338,!!b);h.setValue(Rc.a.Yw,b)}PCg(b,h,r,A){if(b.A8c)return!1;if(1===b.$s)return A;if(A)return!0;if(h){A=b.listType===h.listType;const M=!b.listStyle&&b.JD===fk.a.Pk;let ba=b.listStyle===h.listStyle&&b.JD===h.JD;b=(!b.Ita||this.Kwg(h,b))&&!r;ba=ba&&b;return A&&(M||ba)}return!1}o1d(b){this.o6b||(this.o6b=b.ka(Rc.a.BPl,null));this.Hzd||(this.Hzd=b.ka(Rc.a.APl,null));this.kGc||
(this.kGc=b.ka(Rc.a.CPl,null))}zbd(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}$zi(b){return b?this.Xp.qX(b).Uu-this.Xp.xI(b).Uu:-1}Tzj(b,h){const r=b.ka(Rc.a.Zs,null),A=r?r.length:0,M=Array(A+1);let ba=0;for(;ba<A;ba++)M[ba]=r[ba];M[ba]=h;b.setValue(Rc.a.Zs,M);this.Ss.rnc()}Rzj(b,h,r){this.aff(Rc.a.Zs,b,h);if(Xn.Es.o0){this.aff(le.a.IYa,b,r);var A=this.Ss.v7d(b);A.add(h,r);b.setValue(le.a.XF,bH.d(ZG.a.jAc(A)))}else this.aff(Rc.a.Lya,b,r),A=this.Ss.u7d(b),A.add(h,r),b.setValue(Rc.a.D3,
bH.d(ZG.a.jAc(A)))}Szj(b,h,r){this.Eba?(this.VNh(Rc.a.Xq,b,r),this.VNh(Rc.a.q8,b,h)):(r=(r=b.ka(Rc.a.Xq,null))?Array.clone(r):[],r.push(h),b.setValue(Rc.a.Xq,r),this.Ss.rnc())}aff(b,h,r){const A=h.ka(b,null),M=A?A.length:0,ba=Array(M+1);let oa=0;for(;oa<M;oa++)ba[oa]=A[oa];ba[oa]=r;h.setValue(b,ba)}VNh(b,h,r){let A=h.ka(b,null);A=A?Array.clone(A):[];A.push(r);h.setValue(b,A)}SWk(b,h,r){var A=r%3+1;const M=h?this.kGc:this.Hzd;M&&r<M.length?b.setValue(Rc.a.Pt,M[r]):b.setValue(Rc.a.Pt,360);A=Qu.a.$W(h?
0:1,this.Xgp(A),null,0,r);b.At(A.ef);b.setValue(Rc.a.xkf,h?-1:-2);h?b.setValue(Rc.a.Yw,"%"+(r+1)+"."):(b.setValue(ze.a.font,this.Cqm(r)),b.setValue(Rc.a.Yw,String.fromCharCode(this.tqm(r))));ex.a.sxc(2,b)}TWk(b,h,r){const A=h?this.kGc:this.Hzd;A&&r<A.length?b.setValue(Rc.a.Pt,A[r]):b.setValue(Rc.a.Pt,360);b.setValue(Rc.a.xkf,h?-1:-2);ex.a.sxc(1,b)}tqm(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}Cqm(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";
case 2:return"Wingdings";default:return"Symbol"}}hai(b){if(this.Eba)this.Bba<fk.a.Pbd&&this.Ss.Y6(b),this.Bba=this.zCi(this.Zs,this.Bba,fk.a.Pbd);else{if(this.Bba<fk.a.Pbd&&(this.Ss.Y6(b),this.Zs&&this.Xq)){b=this.Zs.length;for(let h=0;h<b;h++)this.Zs[h]>=this.Bba&&(this.Bba=this.Zs[h])}this.Bba+=1}return this.Bba}$$h(b){this.YXa<fk.a.rQd&&this.Ss.Y6(b);return this.YXa=this.zCi(this.Lya,this.YXa,fk.a.rQd)}iai(b){var h;this.Ss.Y6(b);do b=Math.floor(Math.random()*(bu.PMn-bu.Aej))+bu.Aej;while(null===
(h=this.Ss.uWb)||void 0===h?0:h.includes(b));return b}zCi(b,h,r){if(h<r&&b){r=b.length;for(let A=0;A<r;A++)b[A]>h&&(h=b[A])}h++;return h}DFo(b,h){ch.a.Xs||this.Jqi(b,h,this.fAe,this.ZVj,null,!1)}CFo(b,h){ch.a.Xs||this.xdm(b,h,this.fAe,this.YVj)}$bl(){ch.a.Xs||this.Z0()}Z0(b=null){var h,r;if(!ch.a.Xs){var A=new zc.a;if(b)if(8===b.type)A.set(b);else{v.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else A.set(qa.StaticActiveAppFrame.za().kb.ed),
Object(fn.a)().GKg(A),b=Object(fn.a)().Nu(A.currentNode);if(A.vb(7)||A.fd(7)){A=Be.a.Bt(A,A.origin);var M=new TC({Nd:this.Ss,Vh:b,jB:null,R$j:!1});for(b=new TC({Nd:this.Ss,Vh:b,jB:null,R$j:!1});A.moveNext();){var ba=A.iterator;let Ja;if(!ch.a.getInstance().Nt){if(!ba.pv(4)&&!ba.pv(31))continue;this.Nd.eWb(ba);Ja=ba.currentNode;ba.rc();if(!Ja){v.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ba.isValid);continue}}const jb=mf.ListItemReader.De?
mf.ListItemReader.M7d(ba):Ja;if(!this.Eba&&!mf.ListItemReader.m_f(jb)&&this.Nd.b3(jb).listType)continue;var oa=void 0;if(mf.ListItemReader.De){if(!jb){v.ULS.sendTraceTag(509141473,393,50,"Skipping updating list numbers because paraNode not found");continue}oa=mf.ListItemReader.Nr(jb)}else oa=this.Nd.K_(Ja,!1,!1);if(this.Eba&&oa&&this.Nd.Bee(oa.listId)){v.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",oa.listId);continue}const zb=mf.ListItemReader.De?jb:Ua.a.yN(ba);
zb&&(zb.ra?(null==zb.ra.last&&v.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.Eba&&this.Ss.Y6(ba.currentNode),12===zb.type&&(zb.nj&&zb.Nx.hasProperty(Rc.a.listID)||null===(h=zb.ra.last)||void 0===h||!h.Wi)&&((ba=mf.ListItemReader.De?zb.nj?mf.ListItemReader.yla(jb):mf.ListItemReader.Nr(jb):this.Nd.K_(Ja,!0,!0))?this.iPj(Ja,jb,b,Xn.Es.Hvd,ba):v.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",
Ja.type)),!oa||null!==(r=zb.ra.last)&&void 0!==r&&r.Wh||!this.iPj(Ja,jb,M,Xn.Es.Aoa,oa)||(oa=Ja.getValue(Xn.Es.Aoa),this.Eba&&this.Nd.b3(jb).listType||Ja.setValue(Xn.Es.jFa,oa))):v.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else v.ULS.shipAssertTag(593234060,376,7===A.nf,"Couldnt reach to page manifest node")}}iPj(b,h,r,A,M){if(!ch.a.Xs)return A||v.ULS.shipAssertTag(571757918,393,!!A,"Prop definition is null"),r=r.fsc(M.listId,M.listLevel,this.Cd),
M=-1,b.hasProperty(A)&&(M=b.getValue(A)),r===M||this.Eba&&!mf.ListItemReader.m_f(h)&&this.Nd.b3(h).listType&&(A!==Xn.Es.Hvd||1!==this.Nd.b3(h).listType)?!1:(b.setValue(A,r),!0)}fnn(b,h){if(!ch.a.Xs){var r=!1,A=!0,M=0,ba=this.yE(b),oa=b.currentNode;b=b.$2b();b=Be.a.Zo(b);for(b.Dp(UC.a.Rhe,null);b.moveNext();){var Ja=b.iterator.currentNode;if(Ja===oa)break;mf.ListItemReader.Dg(Ja)&&(Ja=this.yE(b.iterator),Ja.listID===ba.listID&&(Ja.level>ba.level?(r=!0,M++):Ja.level===ba.level?(A=!1,M=0):Ja.level<=
h.Idb&&(A=!0,M=0)))}return r&&A&&!0}}Sol(b){if(!ch.a.Xs){this.Nd.y0(b);var h=b.currentNode;b.rc();var r=this.yE(b);r&&this.Ss.Lhe(h,r.listID,r.level)&&this.CFo(b.currentNode,r)}}uBi(b){var h;const r=this.Nd.Tw(b);r.ojc=!0;mf.ListItemReader.De?(b=mf.ListItemReader.sla(b),r.ef.setValue(Rc.a.listID,null!==(h=null===b||void 0===b?void 0:b.listId)&&void 0!==h?h:0)):(this.Nd.y0(b),h=b.currentNode.ka(Rc.a.listID,0),r.ef.setValue(Rc.a.listID,h),b.fd(11));return r}n3f(b,h,r){if(!ch.a.Xs){var A=new zc.a,M=
h.currentNode,ba=fk.a.Pk,oa=!1,Ja=!1,jb=!1,zb=null,Eb=h.$2b();Eb=Be.a.Zo(Eb);for(Eb.Dp(UC.a.Rhe,null);Eb.moveNext();){A.kd(Eb.iterator);if(A.currentNode===M)break;oa=!1;if(mf.ListItemReader.Dg(A)){var Sb=this.yE(A);Sb.listID===b.listID&&(Sb.level===b.level?(this.Nd.y0(A),ba=A.currentNode,A.rc(),ba=ba.ka(Xn.Es.Aoa,fk.a.Pk),oa=!0,zb=A.rBc(1),Ja=!0):Sb.level>b.level?jb=!0:Sb.level<=r.Idb&&(ba=fk.a.Pk,jb=Ja=!1))}}!Ja&&jb&&(ba=r.startAt);oa&&(oa=h.rBc(1)===zb);b=new aH;b.Dvb=ba;b.Ebk=oa;return b}}nAp(b,
h){var r=mf.ListItemReader.s7(b);b=this.Akc(r);const A=new zc.a;A.set(r);if(A.Ld()&&(r=A.p_a())){r=Be.a.Zo(r);for(r.Dp(UC.a.Rhe,b);r.moveNext();)mf.ListItemReader.Dg(r.iterator.currentNode)&&this.yE(r.iterator).listID===h&&this.JYo(r.iterator,b.listID);v.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}xen(b,h){ch.a.Xs||(v.ULS.shipAssertTag(22819227,338,!!b&&!!h),h.setValue(Th.a.A4f,P.a.create().toString()))}cBa(b,h){const r=Wg.a.instance.wq(ub.a.cBa),A=new cH;(b=
this.Ss.$y(b,h.listID,h.level))?(A.Idb=b.ka(Rc.a.VZb,h.level-1),A.startAt=b.ka(ze.a.VU,1)):Wg.a.instance.$b("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});r.end();return A}hLl(b){const h=Hq.a.instance.createInstance(rn.a.Sod);b.Wf(h,31)}kCo(b){b.Ub(31)&&b.Tg()}bDj(b){var h=this.Xb.Hq(b);h?this.Xb.Be(h)===Jl.StyleReader.wordStyleIdListParagraph&&(h=this.Xb.MF(b),this.Mha.gQ(h.mh(Jl.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.czb)):v.ULS.shipAssertTag(8271188,315,!1)}kPj(b){if(this.Xb.Be(this.Xb.Hq(b))===
Jl.StyleReader.wordStyleIdNormal){const h=this.Xb.MF(b);this.Mha.gQ(h.mh(Jl.StyleReader.wordStyleIdListParagraph),b,!0,!0,void 0,void 0,void 0,!0)}b.Vf(Rc.a.je,Rc.a.jV,Rc.a.GD,Rc.a.t8,Rc.a.Pt,Rc.a.Aua);b.setValue(Rc.a.gZa,0)}Uol(b,h){var r=mf.ListItemReader.Nr(b);if(!r)return null;const A=r.listId;r=r.listLevel;for(let ba=0;9>ba;ba++){const oa=this.Ss.$y(b,A,ba);if(!oa)return Wg.a.instance.$b("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var M=h.bVb[ba];M=6===M?Qu.a.$W(1,1):Qu.a.$W(0,
M);M.yma&&oa.setValue(ze.a.e8,M.yma);oa.hasProperty(ze.a.font)&&oa.removeProperty(ze.a.font);h.hKa&&h.hKa[ba]&&oa.setValue(ze.a.font,h.hKa[ba]);M=h.Bbd[ba];v.ULS.shipAssertTag(22127641,338,!!M);oa.setValue(Rc.a.Yw,M);oa.setValue(Rc.a.$s,ex.a.Yrc);ex.a.Eye(h.n9,oa);oa.setValue(Rc.a.rga,h.Tge[ba]);oa.Vf(Rc.a.VZb,ze.a.VU);this.B8j(b)}b=new Qz.a;b.listID=A;b.level=r;return b}Rol(b,h,r,A){if(A)return this.Uol(b,A);var M=mf.ListItemReader.Nr(b);if(!M)return null;A=M.listId;M=M.listLevel;const ba=this.Ss.$y(b,
A,M);if(!ba)return Wg.a.instance.$b("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&v.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,h.listType,A,M),null;h.ojc&&(ba instanceof wC.APropertySet?ba.Mza(h.ef,Rc.a.listID,Rc.a.listLevel):v.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===ba||void 0===ba?void 0:ba.constructor.name));var oa=ba.ka(Rc.a.$s,
null);oa&&oa===ex.a.Yrc&&this.Qol(b,A);if(!h.listStyle){oa=0;if(-1!==r){for(oa+=M-r;0>oa;)oa+=3;oa%=3}switch(oa){default:r=1;break;case 1:r=2;break;case 2:r=3}h.zca(h.listType,r)}h.yma&&ba.setValue(ze.a.e8,h.yma);h.$z?(this.gPj(h,ba,M),ba.hasProperty(ze.a.font)&&ba.removeProperty(ze.a.font)):(bu.dPj(h,ba),bu.fPj(h,ba));bu.ePj(h,ba);ba.Vf(Rc.a.VZb,ze.a.VU,Rc.a.x$c);this.B8j(b);b=new Qz.a;b.listID=A;b.level=M;return b}Qol(b,h){let r;for(let A=0;9>A;A++){r=this.Ss.$y(b,h,A);if(!r){v.ULS.sendTraceTag(588022421,
393,15,"List def is null for List id {0}, List level {1}",h,A);break}r.setValue(Rc.a.$s,ex.a.Hae);r.removeProperty(Fe.a.Pub)}}Pxe(b,h){const r=Wg.a.instance.wq(ub.a.Pxe);this.IDd.value||Wg.a.instance.$b("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.uSa?(r.properties.W("PendingListInfo","true"),mf.ListItemReader.Dg(b)&&(r.properties.W("RemoveCurrentListInfo","true"),this.czb=!0,this.nca(b),this.IDd.value.CZa(b,-1,0),this.czb=!1),16!==this.uSa.listType&&
this.FKb(b,this.uSa,{iRi:!0,lfm:!0}),this.uSa=null):h||(r.properties.W("CurrentlyUnderPastedList","true"),this.nca(b,{UCj:!0}));r.end()}Qye(b,h){var r;if(mf.ListItemReader.Dg(b))return!1;b.Ub(2);var A=Gl.a.Dcl;const M=[!0,!1].map(ba=>Ed.ParagraphReader.mg(b.currentNode,ba,void 0,!1));b.rc();for(let ba=0;ba<M.length;ba++){const oa=M[ba];if(oa&&!SE.a.jma(oa))for(const Ja of A)if(Ja.test(oa.characterData))return A=null===(r=Ja.exec(oa.characterData))||void 0===r?void 0:r[0],this.Xso(h,ba?"nextPara":
"prevPara",A),!1}return!0}Xso(b,h,r){const A=new Map;A.set("CurrentAutoListPreventedAutoListText",b);A.set("UndoAutoListPreferenceFoundIn",h);A.set("UndoAutoListPreferenceAutoListText",r);za.Health.instance.recordKpiUsage(fk.a.ibb.Fzo,0,fk.a.$B,A)}C7o(b,h){return b&&h}cDj(b){for(let h=0;h<b.count;h++){const r=zc.a.Za(b.K(h));r.yq();this.dha(r)}b.clear()}BFo(b){ch.a.Xs||mf.ListItemReader.Dg(b)&&this.Z0()}rzj(b,h){b=new zc.a;b.set(h);b.Ld();Ab.OutlineElementNavigator.ke(b);b.Orb(h)||Wg.a.instance.$b("PossibleLossOfDirectFormatting",
{["Reason"]:"OeDoesNotContainParagraph"});this.nca(b);return b}PXo(b,h,r){this.Rh.iEa(b,h,r,!0)}YXo(b){b.zca(1,1)}ISd(b,h){const r=Wg.a.instance.wq(ub.a.q9k);if(this.Xb.p0(h.Yi())){if(mf.ListItemReader.Dg(b)&&this.nca(b),h=this.Ss.DBi(h)){if(ch.a.Xs)var A=this.X_b(b,h,!0);else if(this.Ss.J9a(b.currentNode,h),A=vq.j$l(this,b,h))A=this.hPj(b,A,!0);else{A=this.Q$h(b);var M=this.l4d(b,h,this.xZj,this.lhp);if(M){const ba=this.yE(M);if(ba.listID===h.listID&&ba.level<h.level&&this.Nd.Tw(M).$z){const oa=
this.cBa(M.currentNode,ba);ba.Jx===(oa.startAt===fk.a.Pk?1:oa.startAt)&&(ba.SZc=ba.Jx,this.mFj(A,ba,M.currentNode))}}M=this.cBa(A,h);b=this.n3f(h,b,M);b=b.Dvb!==fk.a.Pk?b.Dvb+1:M.startAt===fk.a.Pk?1:M.startAt;ch.a.getInstance().Nt||this.ETc(A,h,null,!0);A.setValue(Xn.Es.Aoa,b);A.setValue(Xn.Es.jFa,b)}ch.a.getInstance().Nt||A.setValue(Rc.a.r0,!0);r.end()}}else Wg.a.instance.$b("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}mFj(b,h,r){ch.a.Xs||this.Ss.Lhe(b,h.listID,h.level)&&this.DFo(r,
h)}D9k(b,h,r){if(!mf.ListItemReader.Dg(h)&&(v.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),mf.ListItemReader.De))return;let A=null;ch.a.getInstance().Nt||(A=h.Ub(4),h.rc());(h=Ua.a.yN(h))||Tc.b(509386772,393,15,"Encountered a list node but paragraph node is not present");b=this.auf(b,r,0,null);this.ETc(A,b,h);return b}auf(b,h,r,A=null){b=A?this.bJl(b,h,r,A):this.$Il(b,h,r);Xn.Es.Ku||(h.wBa?(h=h.levelText,A||(h=h.replace("%1","%"+(b.level+
1))),b.levelText=h):(v.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),b.levelText=""));return b}vMg(b,h,r,A=null){if(mf.ListItemReader.Dg(b)){var M=b.Ub(4);b.rc();var ba=Ua.a.yN(b);this.lhc(ba,()=>{this.ETc(M,h.vv,ba,r);ch.a.Xs||this.hhi(M,h,r,A)})}else v.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}hPj(b,h,r,A=null){const M=Ua.a.yN(b);return this.lhc(M,()=>{const ba=this.X_b(b,h.vv,r);if(!ch.a.Xs)return this.hhi(ba,
h,r,A),ba})}hhi(b,h,r,A=null){if(!ch.a.Xs&&this.Ss.J9a(b,h.vv).$z){const M=new zc.a;M.set(b);M.Ld();M.rc();const ba=this.Cbm(M,h,A);b=this.ubm(M,b,h,r,A,ba);this.zbm(h,r,A,ba,b)}}Cbm(b,h,r){if(!ch.a.Xs){if(h.OZi)h=h.oS;else{let A,M;r?(A=this.yZj,M=this.rBe):h.Anc?(A=this.xZj,M=this.rBe):(A=this.khp,M=this.mhp);h=this.l4d(b,h.vv,A,M,r)}!h&&r&&(r=new zc.a,r.kd(b),r.e$d()&&mf.ListItemReader.Dg(r)&&(h=r));return h}}ubm(b,h,r,A,M,ba){if(!ch.a.Xs)return A?(M?b=M.tqd:(ba=this.cBa(h,r.vv),r=this.n3f(r.vv,
b,ba),b=r.Dvb!==fk.a.Pk?r.Dvb+1:ba.startAt===fk.a.Pk?1:ba.startAt),h.setValue(Xn.Es.Aoa,b),h.setValue(Xn.Es.jFa,b)):(b=fk.a.Pk,this.PYo(h,ba,r)),b}zbm(b,h,r,A,M){if(!ch.a.Xs&&A){var ba=!1;const jb=this.yE(A);var oa=jb.level===b.vv.level,Ja=!!r&&jb.listID===r.lgd;(jb.listID===b.vv.listID||Ja)&&oa&&(oa=this.cBa(A.currentNode,jb),Ja=oa.startAt===fk.a.Pk?1:oa.startAt,jb.Jx===Ja+1&&(ba=h?M===Ja:this.fnn(A,oa)));if(!ba||r)r?(h=this.Qap,M=this.Sap):(h=this.fAe,M=this.ZVj),ba=new zc.a,ba.set(A.currentNode),
ba.Ld(),this.Nd.y0(ba),ba.rc(),this.Jqi(A.currentNode,b.vv,h,M,r)}}PYo(b,h,r){if(!ch.a.Xs){var A=null;h&&(A=this.yE(h));if(A&&A.listID===r.vv.listID&&A.level===r.vv.level){const M=this.Nd.Tw(h),ba=M.Jx;b.setValue(Xn.Es.Aoa,ba);b.setValue(Xn.Es.jFa,ba);M.ef.setValue(Rc.a.listID,A.listID);M.ef.setValue(Rc.a.listLevel,A.level);if(!r.Anc||r.nle)r.OZi&&!r.nle&&(this.Nd.y0(h),b=h.currentNode,Ab.OutlineElementNavigator.ke(h)),b.setValue(Xn.Es.jFa,b.getValue(Xn.Es.Aoa))}else h=r.vv.Jx+1,b.setValue(Xn.Es.Aoa,
h),b.setValue(Xn.Es.jFa,h)}}Mnp(b,h,r=!1){let A,M=!1;const ba=[];for(const jb of b){if(!Ed.ParagraphReader.Vb(jb.node))continue;const zb=jb.node;M||(M=Le.a.qf(jb));if(h&&16!==h.listType){var oa=zc.a.Za(zb);oa.vb(8);oa.rc();if(1<b.length&&this.WTj(oa,h))continue;if(!Ja){var Ja=this.Nd.Tw(oa);oa=this.V_i(h);oa=this.PCg(h,Ja,!0,oa);Ja=!oa;null!==A&&void 0!==A?A:A=oa}}ba.push(zb)}M?Ja?this.SVh(ba,h,{gqb:r,u8j:!0}):this.TVh(ba):Ja?this.SVh(ba,h,{gqb:r,u8j:A}):this.TVh(ba)}SVh(b,h,{gqb:r=!1,u8j:A=!1}={}){const M=
[];for(const Ja of b){(b=Ja.UA())&&M.push([Ja,b]);b=zc.a.Za(Ja);b.vb(8);b.rc();let jb;var ba=this.$zi(Ja);const zb=this.infoAtLevel(b,h),Eb=mf.ListItemReader.De?null:b.Ub(4);if(mf.ListItemReader.De?mf.ListItemReader.isListItem(Ja):Eb)if(mf.ListItemReader.De||b.rc(),!A||oa)({listLevel:jb}=mf.ListItemReader.sla(b)),this.nca(b,void 0,!0);else{var oa=this.Qif(zb,mf.ListItemReader.De?Ja:Eb,-1,h.eB).vv;continue}this.kPj(Ja);oa||(oa=this.SAi(h,b,zb,!1,r),this.sOj(oa,zb),null==oa||r||zb.$z!==this.Nd.J9a(b.currentNode,
oa.vv).$z?(oa=Ua.a.Y2(b),0<oa&&(ba+=oa),oa=this.auf(Ja.Ic.Qp(),h,ba,h.eB)):oa=oa.vv);ba=oa.level;null!=jb&&(oa.level=jb);this.X_b(b,oa);null!=jb&&(oa.level=ba)}if(!this.czb)for(const [Ja,jb]of M)Ja&&jb&&this.oq.fQ(Ja,jb,this.Xd.Ag);this.Z0()}TVh(b){for(const h of b)b=zc.a.Za(h),b.vb(8),b.rc(),this.nca(b,void 0,!0);this.Z0()}FKb(b,h,{iRi:r=!1,kBn:A=-1,gqb:M=!1,lfm:ba=!1}={}){return h&&16!==h.listType?zc.a.jfa(()=>{if(!Ua.a.Qh(b))return v.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),
wq.ccb();const oa=Ua.a.yN(b);return mf.ListItemReader.De&&!oa&&(v.ULS.sendTraceTag(508441813,393,15,"No paraNode was found while trying to applyListInfo"),mf.ListItemReader.De)?wq.ccb():oa&&bm.a(oa,8)?(v.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),wq.ccb()):(null===oa||void 0===oa?0:oa.ra.last.Wh)?(v.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),wq.ccb()):this.lhc(oa,()=>{var Ja=Object(fn.a)().Nu(b.currentNode);const jb=
h.eB,zb=this.infoAtLevel(b,h);var Eb=mf.ListItemReader.De?null:b.Ub(4);if(mf.ListItemReader.De?mf.ListItemReader.isListItem(oa):Eb)return mf.ListItemReader.De||b.rc(),Ja=this.Qif(zb,mf.ListItemReader.De?oa:Eb,A,jb),Ja.vv=this.yE(b),Ja;this.kCo(b);({listId:Eb}=mf.ListItemReader.rLf(h,{Ora:-1}));const Sb=this.Bzm(Eb,ba),nc=this.$zi(oa),Dc=this.SAi(h,b,zb,ba,M,r);this.sOj(Dc,zb);oa&&this.kPj(oa);return null==Dc||M||zb.$z!==this.Nd.J9a(b.currentNode,Dc.vv).$z?this.ZYl(zb,Sb,Dc,b.currentNode)?this.s9k(b,
zb,Sb,nc,jb):this.r9k(b,zb,Ja,nc,jb,Sb,Eb):(zb.listStyle||(Dc.Anc=!0),this.t9k(Sb,Dc,b))})}):(h||v.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.nca(b))}s9k(b,h,r,A,M){r=this.Zzm(h,r,A);r=this.X_b(b,r);b=mf.ListItemReader.De?mf.ListItemReader.s7(b):r;return this.Qif(h,b,-1,M)}SAi(b,h,r,A,M,ba){var oa;M=b.Ivb?new vq(this,zc.a.Za(b.Ivb),!1,!0):vq.i$l(this,h,r,A,M);if(!M)return null;ba?(M.vv.level=this.Bxm(h,r,A),this.hbm(h,M)):M.vv&&(null===(oa=b.ef)||void 0===oa?
0:oa.hasProperty(Rc.a.listLevel))&&(M.vv.level=b.ef.getValue(Rc.a.listLevel));return M}Bzm(b,h){return h&&0<b&&b+""in this.okg?this.okg[b+""]:-1}Zzm(b,h,r){var A,M;const ba=new Qz.a;ba.listID=h;ba.level=null!==(M=null===(A=b.ef)||void 0===A?void 0:A.wf(Rc.a.listLevel))&&void 0!==M?M:this.zbd(r);b.ef&&b.wBa&&!Xn.Es.Ku&&(ba.levelText=b.levelText.replace("%1","%"+(ba.level+1)));return ba}Qif(b,h,r,A){b=this.Rol(h,b,r,A);return wq.MBn(b)}t9k(b,h,r){let A=null;0<b&&(A=new Rz(0,h.vv,-1),A.lgd=b);ch.a.Xs?
this.X_b(r,h.vv):this.hPj(r,h,!1,A);return wq.cCn(h.vv)}r9k(b,h,r,A,M,ba,oa){const Ja=Ua.a.Y2(b);0<Ja&&(A+=Ja);r=this.auf(r,h,A,M);this.mAp(ba,oa,r);b=this.X_b(b,r);ch.a.Xs||h.listType||(h=h.JD,h===fk.a.Pk&&(h=1),b.setValue(Xn.Es.Aoa,h),b.setValue(Xn.Es.jFa,h));return wq.PBn(r)}nca(b,{UCj:h=!1}={},r=!1){return zc.a.jfa(()=>{if(!Ua.a.Qh(b))return v.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),wq.ccb();const A=Ua.a.yN(b);if(ch.a.getInstance().Ku&&!A&&(v.ULS.sendTraceTag(508432897,
393,15,"OutlineElement has listNode but no paraNode during removeListInfo [setter flight ON]"),this.Rh.UBo(b.currentNode),ch.a.getInstance().Nt))return wq.ccb();if(null===A||void 0===A?0:A.ra.last.Wh)return v.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),wq.ccb();const M=b.Ub(4);return ch.a.iu||M?ch.a.iu&&!mf.ListItemReader.isListItem(A)?M?(M.Zxc=!1,b.Tg(),wq.G4f()):wq.ccb():A?this.lhc(A,()=>{var ba;this.bDj(A);this.oBo(A);mf.ListItemReader.De||(A.qE=null);
this.Nd.Bee(mf.ListItemReader.De?mf.ListItemReader.Nr(A,{Ora:0}).listId:M.ka(Rc.a.listID,0))?(M&&(M.Zxc=!1),this.KI.dha(A,b),mf.ListItemReader.De&&!ch.a.getInstance().Nt&&(A.qE=null)):M&&b.rc();h||this.hVo(b);if(b.Ub(4)||ch.a.iu&&mf.ListItemReader.isListItem(A))M&&(M.Zxc=!1),this.KI.dha(A,b),mf.ListItemReader.De&&!ch.a.getInstance().Nt&&(A.qE=null);!ch.a.getInstance().Nt&&(this.Xd.Ag&&!this.czb||!this.Xd.Ag&&A.nj)&&(!A.nj||(null===(ba=A.Nx)||void 0===ba?0:ba.hasProperty(Rc.a.listID)))&&this.hLl(b);
return wq.G4f()},{Jbp:r}):(v.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),M&&(M.Zxc=!1,b.Tg()),wq.G4f()):wq.ccb()})}hVo(b){const h=Object(fn.a)().Nu(b.currentNode),r=Ua.a.CKa(b),A=Ua.a.xI(b),M=Ua.a.Y2(b);this.o1d(h);this.Rh.iEa(b,1,Math.max(0,r+(M||-1*A)-this.kGc[0]))}lhc(b,h,{Jbp:r=!1}={}){let A=null;b&&(A=b.UA());h=h();this.czb||(b&&A&&this.oq.fQ(b,A,this.Xd.Ag),r||this.Z0());return h}oBo(b){b.hasProperty(Rc.a.je)&&b.removeProperty(Rc.a.je);
b.hasProperty(Rc.a.GD)&&b.removeProperty(Rc.a.GD);b.hasProperty(Rc.a.Pt)&&b.removeProperty(Rc.a.Pt)}infoAtLevel(b,h){if(!h)return null;const r=h.eB;if(1===h.$s){if(h.Ita&&!h.ZL||!h.Mof(!1))return h;b=Ua.a.CKa(b);const A=this.zbd(b),M=r.bVb[A];b=Qu.a.yaa(h.ef,h.ef);6===M?b.zca(1,1):b.zca(0,M);b.Rxe("multilevel");b.levelText=r.Bbd[A];r.hKa&&r.hKa[A]&&(b.font=r.hKa[A]);b.Ix=r.Tge[A];b.n9=r.n9;b.Jhe=h.Jhe}else b=h;return b}sOj(b,h){null!==b&&void 0!==b&&b.vv&&(h.levelText=b.vv.levelText,h.$z||(h.font=
b.vv.font))}Bxm(b,h,r){let A=Ua.a.CKa(b);const M=Ua.a.Y2(b);0<M?A+=M:(b=Ua.a.xI(b),0<b&&(A-=b));h=h.ef.ka(Rc.a.listLevel,-1);return r&&0<=h?h:this.zbd(A)}hbm(b,h){if(!ch.a.Xs&&!this.Ss.J9a(b.currentNode,h.vv).listType){const r=this.cBa(b.currentNode,h.vv);b=this.n3f(h.vv,b,r);h.vv.SZc=h.vv.Jx=b.Dvb===fk.a.Pk?r.startAt-1:b.Dvb;h.Anc=b.Ebk}}mAp(b,h,r){0>=b?this.okg[h+""]=r.listID:r.listID=b}ZYl(b,h,r,A){if(0>=h)return!1;const M=(ba,oa)=>ba.length!==oa.length||ba.some((Ja,jb)=>Ja!==oa[jb]);if(r)return h=
this.Nd.J9a(A,r.vv),b.$z!==h.$z||M(b.yma,h.yma);r=b.ef.ka(Rc.a.listLevel,-1);return 0<=r&&(h=this.Ss.$y(A,h,r))&&(h=h.ka(ze.a.e8,null))&&b.yma?M(h,b.yma):!1}mBo(b,h){var r;const A=!!h&&Ed.ParagraphReader.Vb(h);let M=0,ba=0;A&&(M=this.Xp.qX(mf.ListItemReader.De?h:this.Nd.CBi(b)).Uu,ba=this.Xp.xI(h).Uu);A&&this.bDj(h);(null===(r=ch.a.getInstance())||void 0===r?0:r.Nt)||b.Ub(4);this.KI.dha(h,b);A&&this.Rh.iEa(b,1,M-ba)}Tea(b,h,r,A=-1,M=!1,ba=null,oa=!1){v.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");
const Ja=Wg.a.instance.wq(ub.a.Tea),jb=this.Qc.Lc(15);jb.pu(b);let zb=null,Eb=0;({Pxn:zb,nVn:Eb,returnValue:A}=this.I$l(b,h,A,zb,Eb,M,ba));if(!zb||oa&&(1===r||0>r-zb.vv.Jx||2<r-zb.vv.Jx))return jb.dispose(),Ja.end(),!1;for(;0<Eb;)b.e$d(),Eb--;this.iAp(b,h,A,zb);jb.dispose();Ja.end();return!0}iAp(b,h,r,A){for(;b.e$d();){var M=mf.ListItemReader.s7(b);if(M&&(M=this.Akc(M),M.listID===h.listID)){h=new Rz(0,h,r);ch.a.getInstance().Ku?this.vMg(b,A,M.r0,h):this.vMg(b,A,!0,h);break}}}I$l(b,h,r,A,M,ba=!1,oa=
null){for(var Ja;b.qLi();){if(b.pv(4)){const jb=this.yE(b),zb=this.Nd.Tw(b);if(zb.listType!==oa.listType){M++;continue}if(ba&&zb.listStyle!==oa.listStyle||!ba&&h.level<jb.level){M++;continue}-1===r&&(r=jb.Jx+1);A=null;if(h.level===jb.level||ba)null===(Ja=this.Upd)||void 0===Ja?void 0:Ja.bVf(b),A=new vq(this,b,!1,!1);ba&&jb.level!==h.level&&b.pv(4)&&(b.Ub(4).setValue(Rc.a.listLevel,jb.level),b.rc());break}M++}return{returnValue:r,Pxn:A,nVn:M}}Yzm(b){b=mf.ListItemReader.s7(b);return this.x7d(b)}x7d(b){let h;
h=mf.ListItemReader.De?mf.ListItemReader.Nr(b)||mf.ListItemReader.yla(b):this.Nd.K_(b,!1,!0);return this.Nd.$y(b,h.listId,h.listLevel)}startNewList(b,h,r){v.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var A=Wg.a.instance.wq(ub.a.startNewList),M=this.Qc.Lc(15);M.pu(b);var ba=Qu.a.$W(0,h.listStyle,null,0,h.ef.ka(Rc.a.listLevel,-1));if(mf.ListItemReader.De)({listId:oa,listLevel:Ja}=mf.ListItemReader.sla(b,{Ora:0,NUa:-1}));else{b.Ub(4);var oa=b.currentNode.ka(Rc.a.listID,
0);var Ja=b.currentNode.ka(Rc.a.listLevel,-1);b.rc()}ba.Jhe=oa;var jb=h.ef.ka(Rc.a.je,0);0<jb&&ba.ef.setValue(Rc.a.je,jb);-1===ba.ef.ka(Rc.a.listLevel,-1)&&ba.ef.setValue(Rc.a.listLevel,Ja);1===h.$s&&((Ja=new HE.a,oa=h.OJi(b.currentNode,oa),oa)?1===oa&&(ba.Rxe(ex.a.Yrc),ba.eB=Ja.cuf(Ja.odg,Ja.pdg),ba.n9=ba.eB.n9):(ba.Rxe(ex.a.Yrc),ba.eB=Ja.itf(),ba.n9=ba.eB.n9));h.Ksa()&&1>r&&(r=1);ba.JD=r;Ja=new ji.DictionaryPropertySet;Ja=this.Q_c(ub.a.aO,Ja);oa=Ua.a.yN(b);h=this.yE(b);if(jb=this.Yzm(b))ba.levelText=
jb.ka(Rc.a.Yw,""),ba.ZL=42,ba.Ix=jb.ka(Rc.a.rga,"left");this.mBo(b,oa);({Rla:ba}=this.Qqa(Ja,b,ba,!0));b.Ub(4);22!==b.currentNode.type&&63!==b.currentNode.type&&v.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);ch.a.getInstance().Nt||b.currentNode.setValue(Rc.a.listLevel,h.level);ch.a.getInstance().Ku&&({listId:ba}=mf.ListItemReader.Nr(ch.a.getInstance().oma?oa:b.currentNode),this.KI.W_b(oa,ba,h.level));b.rc();ba=new vq(this,b,!1,!1);r=new Rz(1,h,r);this.vMg(b,
ba,!!ch.a.getInstance().Ku,r);M.dispose();A.end()}else v.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}Z_f(b){if(!b)return!1;const h=b.Ub(2);h&&b.rc();return h&&12===h.type&&h.ra&&h.ra.last&&h.ra.last.Wh?!0:!1}Xpe(b,h,r,A){return this.yEk.Xpe(b,h,r,A)}Kwg(b,h){if(!b||!h)return!1;const r=b.ef.ka(Rc.a.Yw,null);h=h.ef.ka(Rc.a.Yw,null);if(!r||!h)return!1;const A=b.ef.ka(ze.a.font,null);b=b.ef.ka(ze.a.font,null);return r===h&&A===b}UPj(b,h,r){r||h.listType||(h.JD=b.ka(ze.a.VU,
fk.a.Pk))}rBi(b,h){if(!h)return null;const r=Array(9),A=h.Jhe;if(!this.Eon(h,b)||1>A)return null;for(h=0;9>h;h++){const M=this.Nd.$y(b,A,h);if(null===M||void 0===M?0:M.hasProperty(Rc.a.je))r[h]=M.getValue(Rc.a.je);else return null}return r}Eon(b,h){if(!b)return!1;const r=b.ef.ka(Rc.a.listLevel,-1);b=b.ef.ka(Rc.a.je,-1);if(0>r||0>b)return!1;this.o1d(h);return b!==this.o6b[r]}fOh(b,h,r){b&&b.setValue(Rc.a.je,h?h[r]:this.o6b&&r<this.o6b.length?this.o6b[r]:720*(r+1))}Jqi(b,h,r,A,M=null,ba=!1){if(!ch.a.Xs){var oa=
new zc.a,Ja=this.cBa(b,h);oa.set(b);oa.Ld();b=Uv.a.Bt(oa,oa.$2b());b.Dp(UC.a.Rhe,null);for(var jb=-1;b.moveNext();){if(!mf.ListItemReader.Dg(oa))continue;const zb=this.yE(oa),Eb=Ua.a.yN(oa);this.Nd.y0(oa);const Sb=oa.currentNode;oa.rc();if(r!==this.fAe||zb.listID===h.listID){if(ba){if(-1!==jb&&jb>zb.level)break;if(-1===jb)jb=zb.level;else if(zb.level!==jb)continue}else{if(zb.level<=Ja.Idb)break;if(!r(h,zb,M))continue}A(Sb,Eb,h.listID,M)}}}}xdm(b,h,r,A){if(!ch.a.Xs){var M=new zc.a,ba=this.cBa(b,h);
M.set(b);M.Ld();if(mf.ListItemReader.Dg(M)){b=this.yE(M);var oa=Ua.a.yN(M);this.Nd.y0(M);var Ja=M.currentNode;M.rc();b.level<=ba.Idb||r(h,b,null)&&A(Ja,oa,h.listID,null)}}}wdm(b,h,r,A,M=null){const ba=new zc.a;ba.kd(b);A(b,h,this.yE(ba),ba,0);this.l4d(b,h,r,A,M)}l4d(b,h,r,A,M=null){let ba=new zc.a;const oa=this.cBa(b.currentNode,h);let Ja=null,jb=0;var zb=new zc.a;zb.kd(b);zb.vb(10);const Eb=Be.a.Bt(zb,zb.origin);for(Eb.moveNext();Eb.moveNext();)if(Ja=null,ba=Eb.iterator,1===ba.role&&(Ja=Eb.currentNode,
ba.pv(4)&&(zb=this.yE(ba),r(h,zb,M))))if(zb.level>h.level)A(b,h,zb,ba,jb),jb++;else if(zb.level===h.level||zb.level<=oa.Idb)break;return Ja?ba:null}Vyj(b,h,r,A){ch.a.Xs||this.cBa(b.currentNode,r).Idb>=h.level&&this.Sol(A)}static dPj(b,h){h.setValue(ze.a.font,b.Ita||b.A8c||b.a6c?b.font:"Symbol")}static fPj(b,h){b=b.Ita||b.A8c||b.wBa?b.levelText:fk.a.MZd;v.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Rc.a.Yw,b)}static ePj(b,h){b=b.ef.ka(Rc.a.rga,"left");h.setValue(Rc.a.rga,b)}}bu.PMn=2147450879;bu.Aej=
1;Object(u.a)(bu,"FlatListEditorCssVersion",Xn,[547,548]);class qJ{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){this.Ss=b;this.k9n=h;this.Of=r;this.fp=A;this.oC=M;this.JBn=ba;this.Pd=oa;this.Oj=Ja;this.UBn=jb;this.qc=zb;this.Xb=Eb;this.CM=Sb;this.KI=nc}create(){return new bu(this.Ss,this.k9n,this.Of,this.fp,this.oC,this.JBn,this.Pd,this.Oj,this.UBn,this.qc,this.Xb,this.CM,this.KI)}}Object(u.a)(qJ,"FlatListEditorFactory",null,[]);class dH{constructor(){this.startAt=this.listLevel=this.listId=0;this.Ivb=
null}}Object(u.a)(dH,"ListAutoCorrectionRefInfo",null,[]);class $x{constructor(b,h){this.XDk=b;this.kg=h}Xpe(b,h,r,A){if(!b.hasProperty(Bd.a.cMa))return!0;h=zc.a.Za(h.currentNode);Le.a.yv(h);let M=!0;if(!r.listType&&!A){23===h.nf&&h.ML(1);A=b.ka(Bd.a.cMa,1);if(1<A){var ba=new zc.a;ba.kd(h);ba.vb(10);ba=Be.a.Zo(ba.origin);A=this.H$l(ba,A,r,h.currentNode);r.Ivb||(M=!1)}b.setValue(Bd.a.cMa,A)}return M}H$l(b,h,r,A){const M=new qb.a;for(;b.moveNext()&&b.iterator.currentNode!==A;){const ba=b.iterator;if(!ba.pv(4))continue;
const oa=this.XDk.value.yE(ba),Ja=this.kg.Tw(ba);this.Qlo(M,oa);Ja.listType===r.listType&&Ja.listStyle===r.listStyle&&(0>h-oa.Jx||2<h-oa.Jx||M.add(Object.assign(new dH,{listId:oa.listID,listLevel:oa.level,Ivb:ba.currentNode,startAt:oa.Jx+1})))}0<M.count&&(h=M.K(M.count-1).startAt,r.Ivb=M.K(M.count-1).Ivb);return h}Qlo(b,h){let r=0;for(;r<b.count;){const A=b.K(r);A.listId===h.listID&&A.listLevel>=h.level?b.removeAt(r):r++}}}Object(u.a)($x,"ListAutoCorrector",null,[520]);class TE{constructor(b,h,r,
A,M){this.Zeb=(ba,oa,Ja)=>{var jb;ba=mf.ListItemReader.De?mf.ListItemReader.j3c(oa):this.UXc(oa);if(!ba||this.fu.Z_f(ba))return 8;oa=this.fu.yE(ba);if(1===oa.Jx||this.M9c(oa.level))return 8;oa=null===(jb=this.Nd)||void 0===jb?void 0:jb.Tw(ba);if(!oa||this.b_i(oa))return 8;if(1===Ja)return 32;this.fu.startNewList(ba,oa,1);return 32};this.Yeb=(ba,oa,Ja)=>{ba=mf.ListItemReader.De?mf.ListItemReader.j3c(oa):this.UXc(oa);if(!ba||this.fu.Z_f(ba))return 8;oa=this.fu.yE(ba);if(this.M9c(oa.level))return 8;
const jb=this.Nd.Tw(ba);if(!jb||this.b_i(jb))return 8;if(1===Ja)return 32;this.lZc.nCm(ba.currentNode,oa.Jx,this.Nd,this.fu,this.s0a);return 32};this.Tea=(ba,oa,Ja)=>{ba=mf.ListItemReader.De?mf.ListItemReader.j3c(oa):this.UXc(oa);if(!ba||this.fu.Z_f(ba))return 8;oa=this.fu.yE(ba);if(1!==oa.Jx||this.M9c(oa.level))return 8;if(1===Ja)return 32;Ja=this.Nd.Tw(ba);return this.fu.Tea(ba,oa,Ja.JD,-1,!1,Ja)?32:8};this.kzb=(ba,oa,Ja,jb,zb)=>{ba=mf.ListItemReader.De?mf.ListItemReader.j3c(oa):this.UXc(oa);if(!ba)return 8;
oa=this.fu.yE(ba);if(this.M9c(oa.level))return 8;if(1===Ja)return 32;Ja=this.Nd.Tw(ba);this.fu.startNewList(ba,Ja,zb);return 32};this.fob=(ba,oa,Ja,jb,zb)=>{ba=mf.ListItemReader.De?mf.ListItemReader.j3c(oa):this.UXc(oa);if(!ba)return 8;oa=this.fu.yE(ba);return this.M9c(oa.level)?8:1===Ja?32:this.fu.Tea(ba,oa,oa.Jx,zb)?32:8};this.Qb=b;this.Nd=r;this.fu=A;this.lZc=M}M9c(b){return 0>b}Wb(){this.Qb.qa(ub.a.Zeb,mc.a.oS,this.Zeb);this.Qb.qa(ub.a.Zeb,mc.a.Vc,this.Zeb);this.Qb.qa(ub.a.Zeb,mc.a.view,this.Zeb);
this.Qb.Pc(ub.a.Zeb,12);this.Qb.qa(ub.a.Yeb,mc.a.oS,this.Yeb);this.Qb.qa(ub.a.Yeb,mc.a.Vc,this.Yeb);this.Qb.qa(ub.a.Yeb,mc.a.view,this.Yeb);this.Qb.Pc(ub.a.Yeb,12);this.Qb.qa(ub.a.Tea,mc.a.oS,this.Tea);this.Qb.qa(ub.a.Tea,mc.a.Vc,this.Tea);this.Qb.qa(ub.a.Tea,mc.a.view,this.Tea);this.Qb.Pc(ub.a.Tea,12);this.Qb.qa(ub.a.kzb,mc.a.oS,this.kzb);this.Qb.qa(ub.a.kzb,mc.a.Vc,this.kzb);this.Qb.qa(ub.a.kzb,mc.a.view,this.kzb);this.Qb.Pc(ub.a.kzb,12);this.Qb.qa(ub.a.fob,mc.a.oS,this.fob);this.Qb.qa(ub.a.fob,
mc.a.Vc,this.fob);this.Qb.qa(ub.a.fob,mc.a.view,this.fob);this.Qb.Pc(ub.a.fob,12)}get s0a(){return $a.a.instance.resolve(48).Cha}UXc(b){return this.fu.Izm(b)}b_i(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(u.a)(TE,"ListContextMenuSectionActor",null,[]);var Lm=d(597);class iq{static get TBn(){return ug.a.ry(iq.Qn,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}iq.Qn="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(u.a)(iq,"ListSetStartValueDialogHtml",null,[]);class Av extends ug.a{constructor(b,h,r,A,M){super();this.eId=this.hOe=this.wId=this.M9e=null;this.dQe=!0;this.cW=!1;this.Tjb=0;this.lXj=[ub.a.dAg,ub.a.XEg,ub.a.Uog];this.q0o=(ba,oa)=>{ba=oa[ki.a.Number];this.rda=Number.isInteger(oa[ki.a.Number])&&ba>=this.Tjb?ba:this.Tjb};this.JMm=(ba,oa)=>{this.rda=this.rda>=this.Tjb?this.rda:this.Tjb;oa[ki.a.Number]=this.rda;oa[ki.a.UnitType]=0};this.kYo=(ba,oa)=>{if(1===ba){var Ja=oa.ListRadioStartNew,jb=oa.ListRadioContinue,
zb=zc.a.Za(this.Sf);zb.Ld();oa=this.fu.yE(zb);ba=this.kg.Tw(zb);if(Ja)this.fu.startNewList(zb,ba,this.rda);else if(jb)if(this.dQe)this.fu.Tea(zb,oa,this.Y2e,-1,!1,ba);else{Ja=!0;for(jb=null;zb.bK();)if(mf.ListItemReader.Dg(zb)){jb=new vq(this.fu,zb,!1,!1);break}if(!jb||this.fu.yE(zb).Jx>=this.rda)Ja=!1;Ja?(zb=zc.a.Za(this.Sf),zb.Ld(),this.fu.Tea(zb,oa,this.Y2e,this.rda,!1,ba)):(this.dispose(),this.aOa(CommonUIStrings.l_ErrorDialogMessage,this.SBn))}}};this.SBn=()=>{new Av(this.Sf,this.Y2e,this.kg,
this.fu,this.Bd)};this.D5n=()=>{document.getElementById(Av.D7i).style.visibility="visible"};this.gZn=()=>{document.getElementById(Av.D7i).style.visibility="hidden"};this.Pg="ListSetStartValueDialog";this.lh=iq.TBn;this.Sf=b;this.rda=h;this.kg=r;this.Y2e=h;this.V9=A;h=new zc.a;b?(h.set(b),h.Ld(),Ua.a.Qh(h)||Ab.OutlineElementNavigator.ke(h),mf.ListItemReader.Dg(h)&&(b=null,mf.ListItemReader.De?b=this.kg.Tw(h):(h.Ub(4),h=h.currentNode,22===h.type&&(b=this.kg.b3(h))),b&&(b.Ksa()?this.Tjb=1:this.Tjb=0))):
this.Tjb=1;this.Bd=M;this.gi(Box4Intl.Box4Strings.l_SetNumberingValueList,this.kYo,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.dQe&&(this.M9e=document.getElementById("ListRadioStartNew"),this.wId=this.D5n,this.hOe=document.getElementById("ListRadioContinue"),this.eId=this.gZn,uf.a.addHandler(this.M9e,"click",this.wId),uf.a.addHandler(this.hOe,"click",this.eId));for(const ba of this.lXj)Object(Lm.a)(ba,this.q0o,this.JMm);this.Bd.An()}get fu(){return this.V9}dispose(){if(!this.cW){for(const b of this.lXj)Object(Lm.b)(b);
this.dQe&&(this.wId&&uf.a.removeHandler(this.M9e,"click",this.wId),this.eId&&uf.a.removeHandler(this.hOe,"click",this.eId));this.Bd.K0("ListStartSpinner");super.dispose();this.cW=!0}}Hhl(){const b=Nk.l("none",this.Tjb+"","100","1");return Nk.j(Av.E7i,ub.a.dAg,ub.a.Uog,Box4Intl.Box4Strings.l_SetValueTo,[b],null,ub.a.XEg)}OKb(b){const h=document.getElementById(Av.E7i);this.Bd.V5a("ListStartSpinner",b);b=this.Bd.RPb("ListStartSpinner","Medium");h.appendChild(b)}Pba(){const b=this.Hhl();this.OKb(b)}}
Av.E7i="SetListStartSpinnerContainer";Av.D7i="ListStartAtSpinnerBox";Object(u.a)(Av,"ListSetStartValueDialog",ug.a,[]);class ay{nCm(b,h,r,A,M){new Av(b,h,r,A,M)}static get instance(){return ay._instance||(ay._instance=new ay)}}ay._instance=null;Object(u.a)(ay,"ListDialogFactory",null,[405]);class VC{constructor(b,h,r){this.V9=b;this.kg=h;this.Qc=r}bVf(b){v.ULS.shipAssertTag(40420184,393,Ua.a.Qh(b));if(mf.ListItemReader.Dg(b)){const h=this.kg.Tw(b);h.$s||this.q7m(b,h)}}mrl(b){for(let h=0;h<b.length;h++){const r=
new zc.a;r.set(b.getContext(h).node);this.bVf(r)}}q7m(b,h){const r=Object(fn.a)().Nu(b.currentNode),A=this.V9.yE(b),M=this.Qc.Lc(15);M.pu(b);h=this.V9.D9k(r,b,h);this.V9.nAp(b,A.listID);M.dispose();this.kg.J9a(b.currentNode,h)}}Object(u.a)(VC,"SingleLevelListEditor",null,[404]);var lt=d(395);class UE{dwj(b,h,r,A,M,ba){return b?y.AFrameworkApplication.va.Pf(b,h,r,!0,M,ba):8}}Object(u.a)(UE,"ListContextManager",null,[1635]);class by extends UE{constructor(b){super();by.tJc=b}dwj(b,h,r,A,M,ba){if(!b||
!b.length)return 8;let oa;const Ja=({eVm:b,dVm:oa}=by.ir.bVm(b)).returnValue;let jb=1;for(const Eb of Ja.keys){var zb=b.contains(Eb);const Sb=Ja.K(Eb);by.ir.Lml(Ja.K(Eb),this.wVc(h),zb)?zb?(v.ULS.sendTraceTag(508350475,393,50,"List Actions: {0} lists, with change in level",this.wVc(h)?"Promote":"Demote"),zb=y.AFrameworkApplication.va.Pf(lt.a.dJa(Sb),h,r,A,M,ba)):(v.ULS.sendTraceTag(508350474,393,50,"List Actions: {0} lists, without change in level",this.wVc(h)?"Promote":"Demote"),zb=by.ir.j9n(Ja.K(Eb),
this.wVc(h),oa.K(Eb))):(v.ULS.sendTraceTag(508350476,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.wVc(h)?"Promote":"Demote"),zb=8);jb=kd.ActionManager.Ddd(jb,zb)}return jb}wVc(b){return b===ub.a.XI?!0:!1}static get ir(){return by.tJc||(by.tJc=$a.a.instance.resolve(950))}}by.tJc=null;Object(u.a)(by,"WordEditorListContextManager",UE,[]);class fx{get name(){return"WordEditor.ListEditors"}uc(b){y.AFrameworkApplication.J.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ia(951,
()=>new $x(b.rf(620),b.resolve(10))).ha(),b.ia(620,()=>(new qJ(b.resolve(455),b.rf(661),b.resolve(16),new xn.a,b.resolve(34),b.resolve(951),b.resolve(46).instance,b.resolve(39).instance,b.resolve(925),b.resolve(23),b.resolve(8),b.resolve(393),b.resolve(949))).create()).ha(),b.ia(31,()=>b.resolve(620)).ha(),b.ia(882,()=>new VC(b.resolve(620),b.resolve(10),b.resolve(42))).ha(),b.ia("Box4.ListEditors.WordEditorListContextManager",()=>new by(b.resolve(950))).as(695))}init(){(new TE(y.AFrameworkApplication.va,
new zk.a,fx.Nd,fx.fu,ay.instance)).Wb();const b=y.AFrameworkApplication.va;b.fb(ub.a.Uog,mc.a.view,Lm.d,96);b.fb(ub.a.XEg,mc.a.view,Lm.c,96);b.fb(ub.a.dAg,mc.a.view,Lm.c,96)}dispose(){}static get Nd(){return null!=fx.n1g?fx.n1g:fx.n1g=$a.a.instance.resolve(10)}static get fu(){return null!=fx.aXg?fx.aXg:fx.aXg=$a.a.instance.resolve(620)}static main(){E.a.instance.Mc(new fx)}}Object(u.a)(fx,"WordEditorListEditorsPackage",null,[0,1]);var cy=d(1701),Yu=d(518),qL=d(2110);class VE extends Nb.a{constructor(b,
h,r,A,M,ba){super(b,h);this.styleId=null;this.Fh=0;this.Xta=null;this.characterData=r;this.paragraphNode=A;this.listMarker=M;this.KRb=ba}}Object(u.a)(VE,"HeadingText",Nb.a,[]);var Uy=d(350),mt=d(996);class rJ{constructor(b,h,r,A,M,ba,oa){this.Dqn=oa;this.Fmh=!0;this.guh=0;this.HJh=8;this.Xma=null;this.e1m=Ja=>{if(Ja.Sr)return!0;Ja=Ja.role;return 1===Ja||2===Ja||4===Ja};this.RDk=b;this.FG=h;this.xe=r;this.kg=A;this.zJ=M;this.k1=ba}get tv(){return this.RDk.value}get SUf(){return this.Fmh}set SUf(b){this.Fmh=
b}get vVb(){return this.guh}set vVb(b){this.guh=b}get P2b(){return this.HJh}set P2b(b){this.HJh=b}async bwm(){if(this.Dqn){var b=await this.YEm();return this.mmg(b,!0)}b=this.Xma;return isNullOrUndefined(b)?null:Promise.resolve(this.mmg(b,!0))}cwm(){return this.mmg([],!1)}mmg(b,h){const r=window.performance.now(),A=this.vzi();if(!A)return null;const M=new qb.a;let ba=0;for(;A.moveNext();){var oa=A.iterator;if(11===oa.nf){const Ja=mf.ListItemReader.s7(oa),jb=Ab.OutlineElementNavigator.Me(oa,!0);h&&
b[ba]&&b[ba].ParaId===Ed.ParagraphReader.CU(jb)&&ba++;Ab.OutlineElementNavigator.ke(oa);if(!jb||!Ed.ParagraphReader.Vb(jb)||jb.Jq||""===jb.characterData||"\ufffc"===jb.characterData)continue;const zb=this.O6d(jb);zb&&(Ja&&(zb.listMarker=this.zJ.eYa(Ja,!1).UU,oa=this.kg.Tw(oa),1===oa.listType&&oa.a6c&&(zb.Xta=oa.font)),h&&(b[ba-1]&&b[ba-1].ParaId===Ed.ParagraphReader.CU(jb)?zb.Fh=ba:zb.Fh=ba+1),M.add(zb))}}v.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",
window.performance.now()-r));return M}YEm(){const b=new fh.a;var h=qL.a.Qea(y.AFrameworkApplication.rootQuerySignature,null);const r=new pj.a;r.Zq=h;r.status=mt.a.DH;this.vIk=window.performance.now();h=this.k1.Qaa(0,()=>{if(2!=r.statusCode||null==r.hk||0==r.hk.length||null==r.hk[0]){const A=String.format("GetPageEndsOperation Failed with status code: {0};",r.statusCode);b.setException(Error.create(A));v.ULS.sendTraceTag(543802465,3019,10,A)}else b.hg(r.hk[0].PageEnds),v.ULS.sendTraceTag(543802466,
3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.vIk))});h.TG(r);h.t_();return Dg.b(b.task)}uzi(){const b=this.vzi();if(!b)return-1;let h=0;for(;b.moveNext();){const r=b.iterator;if(11===r.nf){const A=Ab.OutlineElementNavigator.Me(r,!0);Ab.OutlineElementNavigator.ke(r);A&&Ed.ParagraphReader.Vb(A)&&!A.Jq&&""!==A.characterData&&"\ufffc"!==A.characterData&&this.O6d(A)&&h++}}return h}vzi(){if(!this.tv)return v.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),
null;var b=this.FG.BU(this.tv);if(!b)return v.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=zc.a.Za(b);if(!b.yq())return v.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=Be.a.Bt(b,b.origin);b.Dp(this.e1m,null);return b}O6d(b){var h;return null!==(h=this.OSm(b))&&void 0!==h?h:this.qFm(b)}OSm(b){if(!this.Vwn(b))return null;var h=Object(Uy.c)(9);h=Object(Uy.a)(h);h=[...Ed.ParagraphReader.sDf(b,h)];if(0===h.length)return null;const r=Ed.ParagraphReader.XAa(b)+
1;return this.v6h(b,h,r)}qFm(b){var h,r,A,M,ba=Object(Uy.c)(9);ba=Object(Uy.a)(ba);const oa=Ed.ParagraphReader.C4c(b),Ja=this.xe.MF(b),{f1m:jb,Sam:zb}=this.$Nm(oa,Ja,ba);ba=null!==(M=null!==(r=null===(h=zb.linkedStyle)||void 0===h?void 0:h.KRb)&&void 0!==r?r:null===(A=zb.Jw)||void 0===A?void 0:A.KRb)&&void 0!==M?M:10;return this.o$c(ba-1)?this.v6h(b,jb,ba):null}v6h(b,h,r){var A;if(!this.o$c(r-1))return null;const {Q3j:M,P3j:ba}=this.Sqp(b,h);return 0===M.length?null:(h=null===(A=Ed.ParagraphReader.A9d(b,
M))||void 0===A?void 0:A.trim())&&""!=h?new VE(ba.xd,ba.endCp,h,b,null,r):null}$Nm(b,h,r){const A=[];let M={linkedStyle:null,Jw:null},ba=null,oa=null;for(const Ja of b)if(ba=Ja.F6.formatting?this.Zvm(h,Ja.F6):ba,b=r(Ja)){if(!oa&&b){oa=ba;if(!oa)break;M=ba}else if(!this.Dmn(ba,oa))break;A.push(Ja)}return{f1m:A,Sam:M}}Sqp(b,h){var r;let A=-1,M;for(M=0;M<h.length;M++){var ba=h[M],oa=b.characterData.substring(ba.F6.cp,ba.cpEnd),Ja=null===oa||void 0===oa?void 0:oa.trimStart();if(Ja){A=ba.F6.cp+(oa.length-
Ja.length);break}}if(-1===A)return{Q3j:[],P3j:{xd:-1,endCp:-1}};ba=-1;for(oa=h.length;0<oa;oa--){Ja=h[oa-1];const jb=b.characterData.substring(Ja.F6.cp,Ja.cpEnd),zb=null===jb||void 0===jb?void 0:jb.trimEnd();if(zb){ba=Ja.cpEnd-(jb.length-zb.length);break}}return{Q3j:null!==(r=h.slice(M,oa))&&void 0!==r?r:[],P3j:{xd:A,endCp:ba}}}Dmn(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.KRb===b.linkedStyle.KRb||h.Jw&&b.Jw&&h.Jw.d1h==b.Jw.d1h?!0:!1}Zvm(b,
h){h=xa.FormattingReader.kBa(h.formatting);b=this.awm(b,h);h=this.Yvm(h);return b||h?{linkedStyle:b,Jw:h}:null}awm(b,h){b=this.xe.$qb(h,b);if(!b)return null;h=b.ka(Rc.a.Nj,9);return this.DTj(h)?{D9p:b.id,KRb:h+1}:null}Yvm(b){var h;b=this.xe.Be(b);if(!b||!zi.a.h4i(b))return null;const r=null!==(h=zi.a.C3c(b))&&void 0!==h?h:"0";h=Number.parseInvariant(r);return this.o$c(h-1)?{d1h:b,KRb:h}:null}Vwn(b){const h=Ed.ParagraphReader.XAa(b);if(!this.o$c(h))return!1;if(this.DTj(h))return!0;b=this.xe.Hq(b);
b=this.xe.Be(b);return zi.a.Kpc(b)?!0:!1}DTj(b){return this.SUf&&this.o$c(b)}o$c(b){return b>=this.vVb&&b<=this.P2b}}Object(u.a)(rJ,"StyleBasedDocumentHeadings",null,[443]);var WE=d(985);class eH{constructor(){this.startTime=0}}Object(u.a)(eH,"TocCallbackData",null,[]);class Bv{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){this.aNg=(Sb,nc,Dc)=>{const Zc=nc.node;if(!Zc)return v.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==Zc.type)return v.ULS.sendTraceTag(36705297,
324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!Zc.Jq)return 2;if(1===Dc)return fc.SessionStatusManager.instance.Nk?8:32;this.Cd&&this.Cd.isFeatureEnabled(112)?this.hRc.Jyp(Zc).then(Gd=>{Gd||this.e$j(Zc)}):this.e$j(Zc);return 32};this.iDp=Sb=>{Sb=window.performance.now()-Sb.startTime;v.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",Sb));Sb=Object.assign(new bb.a,{durationMs:Sb});za.Health.instance.recordKpiSuccess(Bv.adk,Sb);Bv.Ffb()};
this.lTi=(Sb,nc,Dc,Zc,Gd)=>{if(Ed.ParagraphReader.Vb(nc.node)&&nc.node.Jq)return 2;if(1===Dc)return fc.SessionStatusManager.instance.Nk?8:32;if(nc.contextId!==mc.a.Vc||this.Al.qba(nc)||!Ed.ParagraphReader.Vb(nc.node))return 32;this.Xd.ev(17);(null===Gd||void 0===Gd?0:Gd.resolve)?this.hRc.I9h(nc,Gd.resolve):this.hRc.I9h(nc);return 32};this.Ssg=(Sb,nc,Dc)=>{Sb=nc.node;if(!Sb)return v.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==Sb.type)return v.ULS.sendTraceTag(39358979,
324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!Sb.Jq)return 2;if(1===Dc)return fc.SessionStatusManager.instance.Nk?8:32;Dc=null;Sb.isConnected&&(Dc=WE.a.Jkc(Sb,!0),Dc.wAc(Sb));nc=new zc.a;nc.set(Sb);nc.vb(8);nc.fd(8);const Zc=this.Qc.Lc(15);Zc.pu(nc);this.hRc.PAo(Sb)?(Zc.dispose(),Dc&&Dc.normalize(),Bv.Ffb()):(Dc&&Dc.cancel(),Zc.dispose(),v.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.jxd=h;this.$c=A;this.Qc=M;this.Al=ba;
this.hRc=oa;this.Xd=Ja;this.Cd=jb;this.kjh=zb;this.bL=Eb}Wb(){this.ga.qa(ub.a.K2b,mc.a.paragraph,this.aNg);this.ga.qa(ub.a.K2b,mc.a.Fd,this.aNg);this.ga.qa(ub.a.K2b,mc.a.Vc,this.aNg);this.ga.Pc(ub.a.K2b,1028);this.ga.qa(Hc.a.sWf,mc.a.Vc,this.lTi);this.ga.Pc(Hc.a.sWf,1028);this.ga.qa(Hc.a.Nkd,mc.a.paragraph,this.Ssg);this.ga.qa(Hc.a.Nkd,mc.a.Fd,this.Ssg);this.ga.qa(Hc.a.Nkd,mc.a.Vc,this.Ssg);this.ga.Pc(Hc.a.Nkd,1028)}e$j(b){za.Health.instance.recordKpiUsage(Bv.adk,1,Bv.$B,null);const h=this.Gjm(b),
r=new eH;r.startTime=window.performance.now();this.jxd.pMj(h,Rc.a.cMg,this.oRm(this.nFm(b)),this.iDp,null,r);this.hRc.Kpl()}$hk(b){if(null!=b&&b.Jq)if(null==this.kjh.instance)v.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var h=this.kjh.instance.KDi();b=this.B$l(b);var r=!1;1===this.bL.Et&&(r=!0);0!=b&&h!=b&&(h=[Object.assign(new fa.a,{name:"TOCPageNo",string:b}),Object.assign(new fa.a,{name:"HeadingPageNo",string:h}),Object.assign(new fa.a,{name:"isMainView",string:r})],
$b.a("TOCPageNoMismatch",!0,void 0,h))}}B$l(b){for(let h=0;h<b.ra.length;h++){const r=b.ra.K(h);if(null!=r.nc)for(let A=0;A<r.nc.length;A++){const M=r.nc.K(A);if(1===M.pe&&M.IU.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(r.cp,b.characterData.length-r.cp))}}return 0}nFm(b){return b?b.ka(Rc.a.nQ,null):(v.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}Gjm(b){return this.$c.Dsa(b,7,7).Ub(35)}oRm(b){const h=[];h.push(b+",TOC,0");return h}static Ffb(){y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=$a.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},Bv.eAa)}}Bv.eAa=5E3;Bv.adk="WordUpdateTOC";Bv.$B="wwaengidc";Object(u.a)(Bv,"TableOfContentsActor",null,[442]);class mB{}Object(u.a)(mB,"FieldData",null,[]);class sJ extends mB{constructor(){super();this.aAb=null}}Object(u.a)(sJ,"TOCFieldData",mB,[]);class dy{constructor(b,h,r,A,M,ba=null){this.h1m=
b;this.zu=h;this.Fh=r;this.rZj=A;this.listMarker=M;this.Xta=ba}}Object(u.a)(dy,"TOCHeadingData",null,[]);class Wp{constructor(b,h){this.u2a=b;this.Gp=h}async wzi(b){this.u2a.SUf=b.TUf;this.u2a.vVb=b.vVb;this.u2a.P2b=b.P2b;return this.u2a.bwm()}rkm(b){if(b=this.qkm(b))return this.Gp.LAa(b)}qkm(b){const h=b.ra.length;for(let r=0;r<h;r++){const A=b.ra.K(r);if(A.hyperlink&&A.hyperlink.Zla&&A.hyperlink.url.startsWith(C.a.Ymb))return A.hyperlink.url.substr(A.hyperlink.url.indexOf("_Toc"))}return null}Vte(b){(b=
this.rkm(b))&&this.Gp.Ldg(b.id)}aOm(){return this.u2a.uzi()}dvj(b,h){const r=new sJ,A=new qb.a;for(const M of b){b=this.ZNm(M,h);if(!b)return null;A.add(b)}r.aAb=A;return r}ZNm(b,h){let r;if(h&&(r=this.dFl(b),!r))return v.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=Pn.AParagraphNode.tV(b.characterData.trim());const A=this.TPm(b.KRb);return new dy(h,r,b.Fh,A,b.listMarker,b.Xta)}dFl(b){const h=String.format("{0}{1}","_Toc",Lg.a.gG());return this.Gp.xSc(h,
b.Dc,b.end,b.paragraphNode,b.paragraphNode)?h:null}TPm(b){return String.format("toc {0}",b)}}Object(u.a)(Wp,"TOCDataManager",null,[441]);class Sz{MDg(){const b=Object.assign(new kh.StandardDialog,{Gu:y.AFrameworkApplication.$fa,Ed:0,nOa:!1});b.xY(1);b.Nna(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=Sz.WZg?Sz.WZg:Sz.WZg=new Sz}}Object(u.a)(Sz,"TOCDialogHelper",null,[]);var tJ=d(167),uJ=d(505),
rL=d(288),XE=d(149);class WC{constructor(b,h,r,A,M,ba,oa){this.NDg=b;this.ptb=h;this.TUf=r;this.vVb=A;this.P2b=M;this.eKb=ba;this.Usd=[];this.IU=oa}toString(){return"showPageNumber:"+this.NDg+"  isHyperlink:"+this.ptb+" includeOutlineLevels:"+this.TUf+" lowerOutlineLevel:"+this.vVb+" upperOutlineLevel:"+this.P2b+" addContentControl:"+this.eKb+" unsupportedSwitches:"+this.Usd.toString()}}Object(u.a)(WC,"TOCSettings",null,[]);class nk{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he,fe){this.jnh=
"TOC";this.Qpb=this.WOe=this.Uaf=null;this.tfb=b;this.Rh=h;this.oF=r;this.hw=A;this.hy=M;this.Al=ba;this.ib=oa;this.Qd=Ja;this.qIh=jb;this.Je=zb;this.Saf=Eb;this.jq=nc;this.cL=Dc;this.Eo=Zc;this.Qc=Gd;this.Gb=de;this.th=he;this.hb=fe}get l8c(){return this.jnh}set l8c(b){this.jnh=b}get bAb(){this.Uaf||(this.Uaf=this.Xwi());return this.Uaf}Xwi(){return new WC(!0,!0,!0,0,8,!0,this.Wgo())}async I9h(b,h){$b.a(nk.gMl);const r=window.performance.now();if(this.hb.Vb(b.node))if(this.Al.qba(b))v.ULS.shipAssertTag(592233794,
3019,!1,"We can't insert table of contents, current insertion point is in locked range"),nk.lYa("IP is in locked range");else{var A=await this.tfb.wzi(this.bAb);if(A){var M=new wc.a(2,1,0,()=>{this.iMl(b,A,this.bAb.ptb,r);h&&h()});this.Gb.Yb(M)}else v.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),nk.lYa("Failed to get TOC data")}else v.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),nk.lYa("Context should be paragraph")}iMl(b,
h,r,A=0){let M;try{if(0==A&&(A=window.performance.now()),this.wni(b.node)){var ba=new zc.a;ba.set(b.node);ba.vb(7);ba.fd(7);M=this.Qc.Lc(15);M.pu(ba);var oa=this.tfb.dvj(h,r);oa||nk.lYa("Failed to prepare TOC Field data");var Ja=oa.aAb?oa.aAb.count:0;if(Ja){h=null;var jb;for(r=0;r<Ja;r++){const nc=oa.aAb.K(r);if(!({jNb:jb}=this.iTi(b,h,r,Ja,nc,Eb?Eb.toString():void 0)).returnValue){nk.lYa("Failed to populate new TOC paragraph");return}if(0==r){var zb=jb.currentNode;var Eb=Ed.ParagraphReader.CU(zb)}h=
jb}if(this.bAb.eKb&&!this.ctf(zb.id,h.so.id))nk.lYa("Failed to add content control block");else{var Sb=window.performance.now()-A;$b.a(nk.Duf,!0,Sb)}}else if(this.Saf.MDg(),this.EGl(b)){const nc=window.performance.now()-A;$b.a(nk.Duf,!0,nc)}}else nk.lYa("Failed to fetch style set")}catch(nc){nk.lYa(String.format("{0} {1}",nc.message,nc.stack))}finally{M&&M.dispose()}}wni(b){this.WOe=this.hy.MF(b);return this.WOe?!0:(v.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static hMa(b){b=
[Object.assign(new fa.a,{name:nk.gDp,string:b})];$b.a(nk.cNg,!1,void 0,b)}static a7f(b){b=[Object.assign(new fa.a,{name:nk.CCo,string:b})];$b.a(nk.ODj,!1,void 0,b)}static lYa(b){b=[Object.assign(new fa.a,{name:nk.hMl,string:b})];$b.a(nk.Duf,!1,void 0,b)}async Jyp(b){const h=this.dIi(b);if(null==h)nk.hMa("Cannot update TOC when firstTocPara = null");else{var r=this.cOm(h);if(0<r.Usd.length)return this.NIn(r.Usd),!1;$b.a(nk.fDp);var A=window.performance.now(),M=await this.tfb.wzi(r);if(!M)return v.ULS.sendTraceTag(559248668,
3019,10,"Failed to get data for TOC update."),nk.hMa("Failed to fetch TOC data"),!1;b=new wc.a(1,1,0,()=>{this.hDp(h,M,r,A)});this.Gb.Yb(b);return!0}}hDp(b,h,r,A=0){let M;try{if(null==b)nk.hMa("Attempt to update TOC when firstTocPara = null");else{0==A&&(A=window.performance.now());var ba=new zc.a;ba.set(b);ba.vb(7);ba.fd(7);M=this.Qc.Lc(15);M.pu(ba);var oa=this.tfb.dvj(h,r.ptb);if(null==oa)nk.hMa("Attempt to update TOC when tocFieldData = null");else{var Ja;if(({aof:Ja}=this.iDj(b,r)).response){v.ULS.sendTraceTag(559018207,
3019,50,String.format("Attempting to update TOC with settings: {0}",r.toString()));var jb=oa.aAb?oa.aAb.count:0;if(this.wni(b)){var zb;this.x0i(b)&&(this.NDj(b),(b=this.hb.mg(b,!1,!0))&&(zb=b.ka(Rc.a.Zc,null).toString()));var Eb=b.ka(Rc.a.nQ,null);h=Eb;zb=null!==zb&&void 0!==zb?zb:Eb;if(jb){for(var Sb=0,nc;b.Jq&&h==Eb&&Sb<jb;){const Gd=oa.aAb.K(Sb);r.ptb&&this.tfb.Vte(b);if(!this.KCp(b,Sb,jb,Gd,r)){v.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");nk.hMa("Failed to update TOC paragraph");
return}b.setValue(Rc.a.nQ,zb);Sb++;nc=b;b=this.hb.mg(nc,!1,!0);if(!b){h=null;break}this.F0i(b)&&this.MDj(b);h=b.ka(Rc.a.nQ,null)}h==Eb&&this.Gsg(b);var Dc;if(({o3f:Dc}=this.PZk(oa,Sb,jb,nc,zb)).response)if(r.eKb&&!this.ctf(Ja,Dc.id))nk.hMa("Failed to add content control block");else{var Zc=window.performance.now()-A;$b.a(nk.cNg,!0,Zc)}else nk.hMa("Failed to add new paragraph")}else this.Saf.MDg(),this.cDp(b,r.eKb,Ja,r.IU,zb)&&(Sb=window.performance.now()-A,$b.a(nk.cNg,!0,Sb))}else nk.hMa("Failed to fetch style set")}else nk.hMa("Failed to remove Content Control")}}}catch(Gd){nk.hMa(String.format("{0} {1}",
Gd.message,Gd.stack))}finally{M&&M.dispose()}}PZk(b,h,r,A,M){let ba=new zc.a;for(ba.set(A);h<r;){A=b.aAb.K(h);if(!({jNb:A}=this.iTi(null,ba,h,r,A,M)).returnValue)return{o3f:ba.currentNode,response:!1};ba=A;h++}return{o3f:ba.currentNode,response:!0}}iDj(b,h){var r;let A,M;const ba=null===(r=null===b||void 0===b?void 0:b.ra)||void 0===r?void 0:r.first.Ib;if(ba&&0<ba.length)if(b=b.ra.first.Ib.K(0),b.zg){r=b.Wd.getValue(Rc.a.Mw);A=this.th.hr(b.Wd.id,!0);M=this.th.hr(b.Wd.id,!1);if(0!=this.jq.yZb(r))return v.ULS.sendTraceTag(558952907,
3019,10,"Failed to release content control"),{response:!1,aof:A,z0h:M};h.eKb=!0}else v.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.eKb=!1;else h.eKb=!1;return{response:!0,aof:A,z0h:M}}cDp(b,h,r,A,M){v.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.tfb.Vte(b);const ba=this.M5d(b);if(!this.huj(ba,h,r,A))return nk.hMa("Failed to populate empty TOC."),!1;if(h=this.hb.mg(b,!1,!0))r=b.ka(Rc.a.nQ,null),A=h.ka(Rc.a.nQ,null),r==A&&this.Gsg(h);b.setValue(Rc.a.nQ,
M);return!0}huj(b,h,r,A){this.Qd.Ue(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.qfj(b);const M=b.ra.first;this.Je.YN(M.formatting,!0);this.mtf(b,0,1,A);M.UBg&&b.qe.Mq.W(M.formatting.te,Xu.CharacterPropertiesEditor.ON);return h&&r&&!this.ctf(r,b.id)?!1:!0}M5d(b){b.ra.reset();b.hUa();const h=new tJ.a(b,0);h.formatting=new XE.a(h,P.a.nil);h.ri=!0;b.ra.add(h);return vc.a.createTextRange(b,0,b.characterData.length)}x0i(b){if(Ed.ParagraphReader.UR(b)){var h=b.ra.last.nc;if(!h||!h.length)return!1;
if(4<=h.length){b=0===h.K(h.length-4).pe;const r=1===h.K(h.length-3).pe&&h.K(h.length-3).IU.trim().startsWith(this.l8c),A=2===h.K(h.length-2).pe;h=5===h.K(h.length-1).pe;return b&&r&&A&&h}}return!1}F0i(b){if(Ed.ParagraphReader.UR(b)){var h=b.ra.first.nc;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.K(0).pe,h=3===h.K(1).pe,b&&h}return!1}NDj(b){const h=b.ra.last.nc,r=h.K(h.length-4),A=h.K(h.length-3),M=h.K(h.length-2),ba=h.K(h.length-1);h.remove(r);h.remove(A);h.remove(M);h.remove(ba);b.removeProperty(Rc.a.nQ)}MDj(b){const h=
b.ra.first.nc,r=h.K(0),A=h.K(1);h.remove(r);h.remove(A);b.removeProperty(Rc.a.nQ)}Gsg(b){if(b){var h=b.ka(Rc.a.nQ,null),r=b.ka(Rc.a.Zc,null).toString(),A=h;r==h&&this.x0i(b)&&(this.NDj(b),(b=this.hb.mg(b,!1,!0))&&(A=b.ka(Rc.a.nQ,null)));r=new zc.a;r.set(b);r.vb(8);v.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var M;b&&b.Jq&&A==h&&M!=b;){if(this.F0i(b)){this.MDj(b);break}this.tfb.Vte(b);this.Eo.ke(r);A=this.Eo.at(r,!1,!0);this.Rh.JDa(b);if(!A)return null;M=b;r.Ub(2);
A=(b=r.currentNode)?b.ka(Rc.a.nQ,null):null}return b}}cOm(b){var h=b.ra,r=h?h.length:0,A=null;b=new WC(!0,!1,!1,0,8,!0,void 0);for(let M=0;M<r&&(A=this.bOm(h.K(M)),b.IU=A,A=this.WKm(A),A[0]!==this.l8c);M++);h=A?A.length:0;for(r=1;r<h;r++)switch(A[r]){case "\\h":b.ptb=!0;break;case "\\u":b.TUf=!0;break;case "\\o":this.hZo(A[r+1],b)&&r++;break;case "\\z":break;case "\\n":b.NDg=!1;b.Usd.push(A[r]);break;default:b.Usd.push(A[r])}return b}hZo(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&
3===b.length?(h.vVb=Number.parseInvariant(b[1])-1,h.P2b=Number.parseInvariant(b[2])-1,!0):!1}PAo(b){try{$b.a(nk.BCo);const h=window.performance.now(),r=this.dIi(b);if(null==r){nk.a7f("Attempt to remove TOC when firstTocPara = null");return}let A,M,ba;const oa=this.Xwi();if(!({aof:A,z0h:M}=this.iDj(r,oa)).response)return nk.a7f("Failed to remove content control"),!1;if(void 0==A&&void 0==M)ba=this.Gsg(r);else{ba=r.Ic.Eb(A);const jb=new zc.a;jb.set(ba);jb.vb(8);b=!1;let zb;for(;!b&&ba&&zb!=ba;){ba.id.equals(M)&&
(b=!0);ba&&ba.Jq&&this.tfb.Vte(ba);this.Eo.ke(jb);const Eb=this.Eo.at(jb,!1,!0);this.Rh.JDa(ba);if(!Eb){ba=null;break}jb.Ub(2);zb=ba;ba=jb.currentNode}}ba&&this.Odd(ba);const Ja=window.performance.now()-h;$b.a(nk.ODj,!0,Ja)}catch(h){nk.a7f(String.format("{0} {1}",h.message,h.stack))}return!0}Odd(b){b=vc.a.Tc(b,0);b=new or.Selection([b],!0);this.ib.Kc(b)}ctf(b,h){return this.jq.Kqa(b,h,null,nk.whi,!0,11).returnValue?(v.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),
!1):!0}Kpl(){this.tfb.aOm()||this.Saf.MDg()}dIi(b){if(!b.Jq)return v.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ka(Rc.a.nQ,null);return this.cL.zFm(b)}NIn(b){b.length&&(b=[Object.assign(new fa.a,{name:"UnsupportedSwitches",string:b.toString()})],$b.a("UnsupportedTocInstruction",void 0,void 0,b))}bOm(b){const h=(b=b.nc)?b.length:0;for(let r=0;r<h;r++)if(1===b.K(r).pe&&b.K(r).IU.trim().startsWith(this.l8c))return b.K(r).IU.trim();return null}WKm(b){const h=
[];if(!b)return h;b=b.split(" ");return b.length?b:h}EGl(b){b=this.jai(b,null,!0,void 0).returnValue;if(!b)return nk.lYa("Failed to create paragraph"),!1;const h=vc.a.Tc(b,0);if(!this.huj(h,!0,b.id,this.bAb.IU))return nk.lYa("Failed to populate empty TOC"),!1;v.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}jai(b,h,r,A){let M,ba;r&&b?(M=this.UGl(b),ba=M.currentNode,A=Ed.ParagraphReader.CU(ba).toString()):h&&(M=this.pCm(h),ba=this.Rh.qL(M));if(!ba)return v.ULS.sendTraceTag(592233798,
3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,jNb:M};ba.setValue(Rc.a.nQ,A);return{returnValue:ba,jNb:M}}Wgo(){const b=new Sys.StringBuilder(this.l8c);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}kho(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.bAb.ptb&&h.append(" \\h");return h.toString()}pCm(b){b.Ld();this.Eo.ke(b);return this.Rh.eta(b,!1)}UGl(b){const h=new zc.a;h.set(b.node);h.Ld();this.Eo.ke(h);let r=this.ACi(h);const A=!b.cpBegin;
if(Ua.a.isEmpty(h,!0))return this.SSi(r);if(A)return this.Rh.gz(r,!0,!1),this.Rh.Jca(h,r,b,!1,!1,!1),b=this.ACi(r),this.SSi(b);r=this.Rh.eta(h);this.Rh.Jca(h,r,b,!1,!1,!0);b=this.Rh.eta(h);this.Rh.k0b(b.currentNode,!1);this.Rh.qL(b);this.Eo.Me(b);return b}ACi(b){const h=new zc.a;h.kd(b);h.Ld();return h}SSi(b){this.Rh.gz(b,!0,!0);this.Rh.k0b(b.currentNode,!1);this.Eo.Me(b);return b}qfj(b){const h=b.ra;1===h.length&&(h.first.ri=!1,b.m1d().ri=!0)}KCp(b,h,r,A,M){const ba=this.M5d(b);this.Qd.Ue(ba,"");
this.ouj(b,A,M);this.mtf(b,h,r,M.IU);return M.ptb&&!this.CF(b,A.zu)?!1:!0}iTi(b,h,r,A,M,ba){h=({jNb:b}=this.jai(b,h,0==r,ba)).returnValue;if(!h)return{returnValue:!1,jNb:b};this.ouj(h,M,this.bAb);this.mtf(h,r,A,this.bAb.IU);return this.bAb.ptb&&!this.CF(h,M.zu)?{returnValue:!1,jNb:b}:{returnValue:!0,jNb:b}}ouj(b,h,r){this.Ebn(b,h.h1m,h.listMarker,h.rZj,h.Xta);this.qIh.odn(b,b.characterData.length);r.NDg&&this.Ccn(b,h);this.qfj(b);this.H0o(b,h.rZj)}Qzm(b,h){if(!b)return 0;const r=nk.UPm();return 4<
b.length?r.K(h)+.5*Math.floor(b.length/3):r.K(h)}Ebn(b,h,r,A,M){r&&this.Xbn(b,r,A);r=vc.a.Tc(b,b.characterData.length);this.Qd.Ue(r,h);M&&(b=b.ra.Ch(0),this.Je.uha(b.formatting,M))}Xbn(b,h,r){r=this.Qzm(h,r);const A=vc.a.Tc(b,0);this.Qd.Ue(A,h);this.qIh.Ybn(b,h.length,r)}Ccn(b,h){var r=vc.a.Tc(b,b.characterData.length);this.Qd.Ue(r,h.Fh.toString());r=b.ra.Ch(b.characterData.length-h.Fh.toString().length);h=this.kho(h.zu);this.TWa(b,r,0,2,h);this.TWa(b,r,1,2,h);this.TWa(b,r,2,2,h);r=b.ra.Ch(b.characterData.length);
this.TWa(b,r,3,2,h)}H0o(b,h){h=this.WOe.mh(h);this.hw.gQ(h,b,!0)}mtf(b,h,r,A){const M=b.ra.first,ba=b.ra.last;h?this.TWa(b,M,4,1,A):(this.TWa(b,M,0,1,A),this.TWa(b,M,1,1,A),this.TWa(b,M,2,1,A));h===r-1?this.TWa(b,ba,3,1,A):this.TWa(b,ba,5,1,A)}TWa(b,h,r,A,M=null){r=new uJ.a(h,null,r,A,!0,!1,!1,M);h.nc||(h.nc=new rL.a(h));h.nc.add(r);b.Ql();this.LMl(r,b)}LMl(b,h){b.te?h.qe.DX(b.te-1,2):h.qe.cta(b.te,2);h.qe.Mq.W(b.te,Xu.CharacterPropertiesEditor.ON);h.qe.Ot.W(b.te,Xu.CharacterPropertiesEditor.lS)}CF(b,
h){b=vc.a.createTextRange(b,0,b.characterData.length);return this.oF.CF(b,h,!1,!1,!1,!0)?!0:(v.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static UPm(){nk.Bya||(nk.Bya=new fb.a,nk.Bya.W("toc 1",1),nk.Bya.W("toc 2",1.5),nk.Bya.W("toc 3",2),nk.Bya.W("toc 4",2.5),nk.Bya.W("toc 5",3),nk.Bya.W("toc 6",3.5),nk.Bya.W("toc 7",4),nk.Bya.W("toc 8",4.5),nk.Bya.W("toc 9",5));return nk.Bya}}nk.Bya=null;nk.whi="Table of Contents";nk.gMl="CreateTocClient";nk.Duf=
"CreateTocSuccess";nk.hMl="CreateTocFailureCause";nk.fDp="UpdateTocClient";nk.cNg="UpdateTocSuccess";nk.gDp="UpdateTocFailureCause";nk.BCo="RemoveTocClient";nk.ODj="RemoveTocSuccess";nk.CCo="RemoveTocFailureCause";Object(u.a)(nk,"TOCField",null,[437,438]);var nB=d(631);class YE{constructor(b,h){this.RFa=b;this.VPa=h}odn(b,h){if(Ed.ParagraphReader.Vb(b)&&!(0>h)){var r=sr.a.yec(b);r=new nB.a(r,4,1,1);this.RFa.Sbe(b,r);b=vc.a.Tc(b,h);this.VPa.ece(b)}}Ybn(b,h,r){var A=zn.a.lR/2;const M=b.ra.v9a(h);A=
xa.FormattingReader.Yg(M.formatting,ze.a.fontSize,2*A)/2;r=new nB.a(Cg.a.uD(A/36)*r,1,0,1);this.RFa.Sbe(b,r);b=vc.a.Tc(b,h);this.VPa.ece(b)}}Object(u.a)(YE,"TOCTabUtility",null,[424]);class sL{constructor(){this.Z=null}get name(){return"WordEditor.TableOfContents"}uc(b){this.Z=b;this.Z.ia(957,()=>new cy.a(this.Z.resolve(293),Yu.a.sU)).ha();this.Z.ia(929,()=>new rJ(new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed),Object(fn.a)(),this.Z.resolve(8),this.Z.resolve(10),this.Z.resolve(244),new rr.a,this.Z.resolve(114).Pra)).as(488).ha();
this.Z.ia("WordEditor.TableOfContents.TOCDataManager",()=>new Wp(this.Z.resolve(488),this.Z.resolve(457))).as(954).ha();this.Z.ia("WordEditor.TableOfContents.TOCTabUtility",()=>new YE(this.Z.resolve(952),this.Z.resolve(953))).as(955).ha();this.Z.ia("WordEditor.TableOfContents.TOCField",()=>new nk(this.Z.resolve(954),this.Z.resolve(16),this.Z.resolve(82),this.Z.resolve(393),this.Z.resolve(8),ve.a.instance,this.Z.resolve(327),this.Z.resolve(323),this.Z.resolve(955),this.Z.resolve(101),Sz.instance,this.Z.resolve(23),
this.Z.resolve(956),this.Z.Oa(442),this.Z.resolve(197),xn.a.instance,y.AFrameworkApplication.oc,this.Z.resolve(198),b.resolve(164))).as(958).ha();this.Z.ia("WordEditor.TableOfContents.TableOfContentsActor",()=>new Bv(y.AFrameworkApplication.va,this.Z.resolve(957),this.Z.resolve(16),this.Z.resolve(293),xn.a.instance,ve.a.instance,this.Z.resolve(958),this.Z.resolve(46).instance,this.Z.resolve(23),this.Z.Ra(487),b.resolve(76))).as(94).ha()}init(){this.Z.resolve(94).Wb()}dispose(){}}Object(u.a)(sL,"PackageManager",
null,[0,1]);class Xp{constructor(b,h,r,A,M,ba,oa,Ja){this.JZa=(jb,zb,Eb,Sb,nc)=>{if(!({Oz:jb}=this.Qyb(zb,Eb,nc,!0,!0)).returnValue)return jb;this.gOd.r$h(nc,zb.node);return 32};this.vDa=(jb,zb,Eb,Sb,nc)=>this.XMi(zb,Eb,Sb,nc,!0);this.ZXb=(jb,zb,Eb,Sb,nc)=>{if(!({Oz:jb}=this.Qyb(zb,Eb,nc,!1,!0)).returnValue)return jb;this.gOd.MIl(nc,zb.node);v.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Tqa=(jb,zb,Eb,Sb,nc)=>{if(!({Oz:Sb}=this.Qyb(zb,Eb,nc,!1,!0)).returnValue)return 2==Eb&&
8==Sb&&dr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Ff.a.GOb),Sb;const Dc=zb.node;let Zc=null;(Zc=jb===ub.a.Tqa?this.gOd.r3b(nc[Ng.a.SourceControlId],Dc):this.Ry.i9d(Dc,nc))?(this.Wpe(Dc,()=>{this.aQd.p0b(Zc,Dc)}),this.EM(),Sb=32):(dr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Ff.a.GOb),Sb=8);jb===ub.a.Tqa&&32===Sb&&v.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");v.ULS.shipAssertTag(0,324,32===Sb);return Sb};this.dza=
(jb,zb,Eb,Sb,nc)=>this.XMi(zb,Eb,Sb,nc,!1);this.jCe=(jb,zb,Eb,Sb,nc)=>Dq.a.Iua(jb,zb,Eb,Sb,nc,{},14);this.YLb=(jb,zb,Eb,Sb,nc)=>{if(!({Oz:jb}=this.Qyb(zb,Eb,nc,!1,!1)).returnValue)return jb;const Dc=zb.node;this.Wpe(Dc,()=>{this.aQd.Htl(Dc)});return 32};this.Ry=b;this.gOd=h;this.ga=r;this.aQd=A;this.Qc=M;this.wB=ba;this.cDk=Ja}Wb(){this.svc(df.a.r0a.S9h())}svc(b){this.ga.qa(ub.a.JZa,mc.a.view,b);this.ga.qa(ub.a.JZa,mc.a.table,this.JZa);this.ga.Pc(ub.a.JZa,1127);this.ga.qa(ub.a.Tqa,mc.a.view,this.jCe);
this.ga.qa(ub.a.Tqa,mc.a.table,this.Tqa);this.ga.Pc(ub.a.Tqa,1030);this.ga.qa(ub.a.PT,mc.a.table,this.Tqa);this.ga.qa(ub.a.dza,mc.a.view,this.jCe);this.ga.qa(ub.a.dza,mc.a.table,this.dza);this.ga.Pc(ub.a.dza,1038);this.ga.qa(ub.a.vDa,mc.a.view,b);this.ga.qa(ub.a.vDa,mc.a.table,this.vDa);this.ga.Pc(ub.a.vDa,1127);this.ga.qa(ub.a.ZXb,mc.a.view,b);this.ga.qa(ub.a.ZXb,mc.a.table,this.ZXb);this.ga.Pc(ub.a.ZXb,1126);this.ga.qa(ub.a.YLb,mc.a.view,this.jCe);this.ga.qa(ub.a.YLb,mc.a.table,this.YLb);this.ga.Pc(ub.a.YLb,
1028)}EM(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=$a.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}XMi(b,h,r,A,M){if(!({Oz:ba}=this.Qyb(b,h,A,M,!0)).returnValue)return 2==h&&8==ba&&dr.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],Ff.a.R6l),ba;b=b.node;h=this.Ry.d3(b);var ba=A[Ng.a.On];
const oa=Xp.wOm(A.MenuItemId);M?A[Ng.a.On]=Xp.F6o(h,oa):(this.q$k(h,oa,ba,b),r.Ft=oa,r.tE=ba?0:1,v.ULS.shipAssertTag(0,324,!!oa));return 32}Wpe(b,h){const r=this.Qc.Lc(15);try{r.Ab(b),this.wB.Cxb(),h()}finally{r&&r.dispose()}}Qyb(b,h,r,A,M){return this.cvn(b,h,r,A,M)?{returnValue:A||2===h,Oz:32}:{returnValue:!1,Oz:8}}cvn(b,h,r,A,M){if(b.contextId!==mc.a.table)return!1;if(A||2===h)if(M&&!r||!Object(Za.a)(Xt.TableNode,b.node)||this.cDk(b.node))return!1;return!0}q$k(b,h,r,A){const M=(512===h||1024===
h?!r:r)?b|h:b&~h;M!==b&&this.Wpe(A,()=>{this.aQd.kEa(M,A)})}static gF(){Xp.Blb[Xp.Lam]=32;Xp.Blb[Xp.Cam]=128;Xp.Blb[Xp.rzn]=64;Xp.Blb[Xp.hzn]=256;Xp.Blb[Xp.adl]=512;Xp.Blb[Xp.$cl]=1024}static F6o(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static wOm(b){let h=0;b in Xp.Blb&&(h=Xp.Blb[b]);return h}}Xp.Lam="buttonFirstRow";Xp.Cam="buttonFirstColumn";Xp.rzn="buttonLastRow";Xp.hzn="buttonLastColumn";Xp.adl="buttonBandedRow";Xp.$cl="buttonBandedColumn";Xp.Blb={};Object(u.a)(Xp,"TableStyleActor",
null,[]);Xp.gF();var oB=d(416);class XC extends oB.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(u.a)(XC,"TableGalleryButtonProps",oB.a,[]);class pB extends XC{constructor(){super()}get Type(){return 6}}Object(u.a)(pB,"TableStyleGalleryButtonProps",XC,[]);class Pg{}Pg.fUn=2147483647;Object(u.a)(Pg,"TableStyleUtil",null,[]);class xq{constructor(b,h,r){this.lpf="Clear";this.DOb=null;this.oQk=b;this.xe=h;this.Ry=r;this.Nfa=y.AFrameworkApplication.Nfa;this.Vs=
y.AFrameworkApplication.Vs}t8a(){}DXk(b,h){this.t8a(b);const r=this.iti(b),A=r.length;if(!(0>=A)){var M=Pg.fUn,ba=null;for(let jb=0;jb<A;jb++){var oa=r[jb],Ja=this.Ry.OOm(oa);M!==Ja&&(M=Object.assign(new xh.a,{Id:"msMoreTableStyles"+Ja,Title:this.POm(Ja),ControlList:[]}),ba=Object.assign(new Bn.a,{Type:6,Id:"galleryMoreTableStyles"+Ja,ExternalGalleryId:"TableStylesGallery",Width:xq.gGg,ElementDimensions:"Size64by48",GalleryItems:[]}),this.DOb&&(ba.ExternalId=this.DOb[Ja.toString()]),M.ControlList.push(ba),
h.MenuSectionList.push(M),M=Ja);Ja=this.xe.LL(oa);oa=xq.zHg+jb;Ja=Object.assign(new pB,{Id:oa,ExternalId:oa,Command:ub.a.Tqa.toString(),QueryCommand:ub.a.JZa.toString(),LabelText:Ja?C.a.If(Ja):"",Alt:Ja,VerticalCenterAlign:"true"});Ja.TableCellStyles=this.p9d(oa,b);Ja.TableStyles=this.R4c(oa,b);ba&&ba.GalleryItems.push(Ja)}}}BXk(b){const h=Object.assign(new xh.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),r=Object.assign(new Pj.a,{Id:"fseaClearTableFormatting",
Command:ub.a.YLb.toString(),LabelText:C.a.If(this.lpf),Alt:C.a.If(this.lpf),Image16by16:this.Vs,Image16by16Class:ag.getImageClassWithCluster(this.Nfa,xq.Gtl),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(r);b.MenuSectionList.push(h)}r$h(b,h){this.t8a(h);const r=b[Ng.a.SourceControlId];var A=this.r3b(r,h);if(A){var M=this.Ry.mH(h);M=M?this.xe.Be(M):null;var ba=this.xe.LL(A);A=this.xe.Be(A);b[Jd.a.Alt]=ba;b[Jd.a.On]=A===M;h=Object.assign(new pB,{Id:r,ExternalId:r,Command:ub.a.Tqa.toString(),
QueryCommand:ub.a.JZa.toString(),TableCellStyles:this.p9d(r,h),TableStyles:this.R4c(r,h),Alt:ba});b[Jd.a.GalleryButtonProps]=h}else b[Jd.a.InnerHTML]=null,b[Jd.a.Alt]=null,b[Jd.a.On]=!1,b[Jd.a.GalleryButtonProps]=null}p9d(b,h){this.t8a(h);return(b=this.r3b(b,h))?this.oQk.Jui(b,h):null}R4c(b,h){this.t8a(h);return this.r3b(b,h),null}MIl(b,h){b.MenuItems=this.JBm(h)}JBm(b){const h=Object.assign(new Xe.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.DXk(b,h);this.BXk(h);return h}r3b(b,h){return b?
b.startsWith(xq.zHg)?this.bQf(parseInt(b.substr(xq.zHg.length)),h):this.mJo(parseInt(b.substr(xq.Rjp.length)),h):null}}xq.zHg="buttonTableStyleMenu";xq.Rjp="buttonTableStyleRibbon";xq.gGg=7;xq.Gtl="ClearTableStyle_16x16x32";Object(u.a)(xq,"ATableStyleRibbonControl",null,[429]);class Tz extends xq{constructor(b,h,r){super(null,h,r);this.uHh=b}r$h(b,h){this.t8a(h);const r=b[Ng.a.SourceControlId];var A=this.r3b(r,h);if(A){var M=this.Ry.mH(h);M=M?this.xe.Be(M):null;var ba=this.xe.LL(A);A=this.xe.Be(A);
b[Jd.a.Alt]=ba;b[Jd.a.On]=A===M;h=Object.assign(new pB,{Id:r,ExternalId:r,Command:ub.a.Tqa.toString(),QueryCommand:ub.a.JZa.toString(),TableCellStyles:this.p9d(r,h),TableStyles:this.R4c(r,h),Alt:ba});b[Jd.a.GalleryButtonProps]=h}else b[Jd.a.InnerHTML]=null,b[Jd.a.Alt]=null,b[Jd.a.On]=!1,b[Jd.a.GalleryButtonProps]=null}p9d(b,h){this.t8a(h);return(b=this.r3b(b,h))?this.uHh.Jui(b,h,5,5):null}R4c(b,h){this.t8a(h);return this.r3b(b,h),null}}Object(u.a)(Tz,"ATableStyleRibbonControlVariableSizePreviews",
xq,[]);var Uz=d(1360),fH=d(1101);class wp{constructor(b,h,r,A){this.Ikm=(M,ba)=>this.getBorder(M,this.i5.oP(ba));this.Hkm=(M,ba)=>this.getBorder(M,this.i5.IR(ba));this.hy=b;this.Kz=h;this.TIb=r;this.i5=A;this.$pk=new Pf.a(()=>this.Gkm());this.ghb=new Pf.a(()=>this.Fkm())}Gkm(){const b={},h=y.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":
"border-right";return b}Fkm(){const b={};b[hi.a.oza]=hi.a.dnb;b[hi.a.dnb]=hi.a.dnb;b[hi.a.x6a]=hi.a.x6a;return b}EFl(b,h,r,A){const M=new fH.a;M.rowCount=r;M.Lnb=A;M.g0a=this.TIb.TNm(b);M.Ja=b.ka(Rc.a.Ja,1);M.Ia=b.ka(Rc.a.Ia,1);M.tableLook=h;M.dCe=1;return M}Jui(b,h,r,A){if(!this.hy.Be(b)||!Object(Za.a)(244,b)||!Object(Za.a)(Mw.a,h))return null;const M=this.Kz.d3(h);r=this.EFl(b,M,r,A);A=[];for(r.rowIndex=0;r.rowIndex<r.rowCount;r.rowIndex++)this.g_k(b,h,r,A);return A}R4c(){return null}Xla(){}g_k(b,
h,r,A){r.Pmc=!r.rowIndex;for(r.cellIndex=0;r.cellIndex<r.Lnb;r.cellIndex++)this.$Vk(b,h,r,A)}$Vk(b,h,r,A){h=this.TIb.Iyl(r,this.TIb.mIf(r),h,b);const M={};var ba=this.Kz.cIf(b,h,ze.a.fontColor,!0,zm.a.BR(),"None");M.color=ba?ba:"inherit";ba=this.Kz.cIf(b,h,ze.a.YG,!0,zm.a.BR(),"None");M["background-color"]=ba?ba:"inherit";this.K_k(r,b,h,M);A.push(M)}K_k(b,h,r,A){b=this.TIb.IVa(b);this.$Qd(5,b,h,r,A);this.$Qd(3,b,h,r,A);this.$Qd(0,b,h,r,A);this.$Qd(4,b,h,r,A)}$Qd(b,h,r,A,M){h=this.Qrm(b,h,r,A);h!==
hi.a.dI&&(M[this.$pk.value[Uz.a[b]]]=h)}Qrm(b,h,r,A){let M=hi.a.dI;if(({bra:M}=this.aPa(A,b,1,h,this.Hkm,M)).returnValue)return M;({bra:M}=this.aPa(r,b,3,h,this.Ikm,M));return M}aPa(b,h,r,A,M,ba){return this.i5.USj(r,h,A)&&(ba=M(b,h))!==hi.a.dI||!h&&({bra:ba}=this.aPa(b,1,r,A,M,ba)).returnValue||4===h&&({bra:ba}=this.aPa(b,2,r,A,M,ba)).returnValue?{returnValue:!0,bra:ba}:{returnValue:ba!==hi.a.dI,bra:ba}}getBorder(b,h){let r="",A,M;({borderStyle:A,borderWidth:M}=this.Mkm(b,h));if(A===hi.a.x6a)return r;
r=String.format(hi.a.KTd,M,A,this.ykm(b,h));return r.trim()}ykm(b,h){if(!h)return hi.a.s2;b=this.Kz.w0c(b,h.color,Yl.a.auto);return b!==Yl.a.auto?Yl.a.QB(b):hi.a.s2}Mkm(b,h){var r=hi.a.nza;let A=hi.a.eI+hi.a.fec;if(!h)return{borderStyle:r,borderWidth:A};r=this.Kz.w0c(b,h.style,hi.a.x6a);b=this.Kz.w0c(b,h.size,hi.a.eI);A=this.Jkm(r,b)+hi.a.fec;r=this.Akm(r);return{borderStyle:r,borderWidth:A}}Jkm(b,h){let r=2;b===hi.a.kLb&&h<hi.a.faa&&(r=1);return r}Akm(b){return this.ghb.value[b]||hi.a.dec}static SOm(){return new wp($a.a.instance.resolve(8),
$a.a.instance.resolve(461),tr.a.instance,hi.a.instance)}static get instance(){return null!=wp.eZg?wp.eZg:wp.eZg=wp.SOm()}}Object(u.a)(wp,"TableStylePreviewGenerator",null,[436]);var Op;(function(b){b[b.wWp=0]="background1";b[b.lqq=1]="text1";b[b.xWp=2]="background2";b[b.mqq=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.u3p=11]="followedHyperlink";b[b.RZp=
12]="dark1";b[b.r9p=13]="light1";b[b.SZp=14]="dark2";b[b.s9p=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(Op||(Op={}));Object(u.b)("ThemeColor",Op);class jw{constructor(b){this.E9b=b}Cim(b,h,r){let A;({Ryj:h,PVh:A}=this.OIm(h));b=[];const M=[];for(let oa=0;16>oa;oa++){if(!(Op[oa]in r.cJb))continue;const Ja=oa,jb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[A[Ja]],this.Bym(oa));var ba=h[Ja];ba=ba&4278190080|(ba&255)<<16|ba&65280|(ba&16711680)>>>16;M.push(Object.assign(new kn,
{Color:Ja.toString(),DisplayColor:"#"+C.a.QJ(ba,6),Alt:C.a.If(jb)}));b[b.length]=oa}return{returnValue:M,Zlp:b}}Bym(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;
case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}OIm(b){let h=null,r=null;b=this.E9b(b);if(!b)return{Ryj:h,PVh:r};h=b.properties.ka(Rc.a.ofb,null);r=b.properties.getValue(Rc.a.SCe).split(" ");return{Ryj:h,PVh:r}}static UOm(){return new jw(Object(F.a)(Object(fn.a)(),Object(fn.a)().Nu,"navigateToPageContentNode"))}static get instance(){return null!=jw.xZg?jw.xZg:jw.xZg=jw.UOm()}}Object(u.a)(jw,"TableStyleThemeHelper",null,[455]);var Vz=
d(894);class Vy{get Jg(){return null!=this.H4g?this.H4g:this.H4g=$a.a.instance.Oa(28)}constructor(b,h){this.Y$e={};this.cJb={};this.xe=b;this.Ry=h}wBf(b,h){const r=this.Y$e[Op[h]];return r&&r.length?r:this.vgm(b,h)}hAi(b,h,r){if(h=this.wBf(h,r))for(b=this.xe.Be(b),r=0;r<h.length;r++)if(this.xe.Be(h[r])===b)return r;return-1}Xla(){this.Y$e={};this.cJb={}}vgm(b,h){const r=[];this.cJb={};b=this.Ry.N4c(b);this.zSd(r,this.cJb,0,h,b);this.zSd(r,this.cJb,1,h,b);this.zSd(r,this.cJb,2,h,b);this.zSd(r,this.cJb,
3,h,b);return this.Y$e[Op[h]]=r}zSd(b,h,r,A,M){let ba;const oa=M.mv();ba=this.Jg.xn?oa.Ow:M.Ow;for(let jb=0;jb<ba;jb++){var Ja=void 0;this.Jg.xn?(Ja=oa.Bla(jb),Ja=M.mh(this.xe.Be(Ja))):Ja=M.eBa(jb);if(3!==this.xe.NF(Ja))continue;const zb=this.Ry.NOm(Ja),Eb=this.Ry.v9d(Ja);h[Op[Eb]]=!0;zb!==r||Eb!==A&&16!==Eb||this.xe.Be(Ja)===Vz.a.rWb||(b[b.length]=Ja)}}static BSm(){return new Vy($a.a.instance.resolve(8),$a.a.instance.resolve(461))}static FMl(){return Vy.BSm()}}Object(u.a)(Vy,"WACTableStyleRibbonList",
null,[454]);class wu extends Tz{constructor(b,h,r,A,M){super(b,h,r);this.d6b=4;this.AOd=[];this.Qen=()=>{this.acc.Xla();this.uHh.Xla()};this.pQk=M;this.acc=A;this.lpf=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.Ueo()}zFl(b,h){b.MenuItems=this.Hfm(h)}Ueo(){this.DOb={};this.DOb["0"]="CustomTableStyles";this.DOb["1"]="PlainTableStyles";this.DOb["2"]="GridTableStyles";this.DOb["3"]="ListTableStyles"}Hfm(b){const h=Object.assign(new Xe.a,{Id:"menuTableTheme"});h.MenuSectionList=[];
if(this.sun(b))return h;const r=Object.assign(new xh.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),A=Object.assign(new Wx.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:Hc.a.Jmb.toString(),QueryCommand:Hc.a.PYb.toString(),Width:wu.$lp});A.Colors=({Zlp:this.AOd}=this.pQk.Cim(this.AOd,b,this.acc)).returnValue;r.ControlList.push(A);h.MenuSectionList.push(r);return h}t8a(b){if(b=this.Ry.mH(b))b=this.Ry.v9d(b),16!==b&&(this.d6b=b)}iti(b){return this.acc.wBf(b,
this.d6b)}bQf(b,h){h=this.acc.wBf(h,this.d6b);return 0>b||b>=h.length?null:h[b]}mJo(b,h){var r=this.Ry.mH(h);r=this.acc.hAi(r,h,this.d6b);r=-1!==r?Math.floor(r/xq.gGg)*xq.gGg:0;return this.bQf(r+b,h)}POm(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}sun(b){this.t8a(b);
return 0>=this.iti(b).length}aDp(b,h){if(!b||!h)return null;b=parseInt(b[fo.Color]);var r=this.Ry.mH(h);const A=this.Ry.v9d(r);if(A===b)return null;if(16===A)return this.d6b=b,null;r=this.acc.hAi(r,h,A);this.d6b=b;return this.bQf(r,h)}cUl(b){b=this.Ry.mH(b);b=this.Ry.v9d(b);if(16!==b)for(let h=0;h<this.AOd.length;h++)if(this.AOd[h]===b)return h;return-1}b6a(b){b.yef(this.Qen,2)}static TOm(){return new wu(wp.instance,$a.a.instance.resolve(8),$a.a.instance.resolve(461),Vy.FMl(),jw.instance)}static get instance(){return null!=
wu.b_g?wu.b_g:wu.b_g=wu.TOm()}}wu.$lp=4;Object(u.a)(wu,"TableStyleRibbonControls",Tz,[428,429]);var Wz=d(1491);class kw extends Xp{constructor(b,h,r,A,M,ba,oa,Ja){super(b,h,r,A,M,ba,oa,Ja);this.tuc=(jb,zb,Eb,Sb,nc)=>{if(!({Oz:jb}=this.Qyb(zb,Eb,nc,!1,!0)).returnValue)return jb;this.AHg.zFl(nc,zb.node);return 32};this.Jmb=(jb,zb,Eb,Sb,nc)=>{if(!({Oz:jb}=this.Qyb(zb,Eb,nc,!1,!0)).returnValue)return 2==Eb&&8==jb&&dr.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],Ff.a.S6l),
jb;const Dc=zb.node,Zc=this.AHg.aDp(nc,Dc);Zc&&this.Wpe(Dc,()=>{this.aQd.p0b(Zc,Dc)});return 32};this.PYb=(jb,zb,Eb,Sb,nc)=>{if(!({Oz:jb}=this.Qyb(zb,Eb,nc,!0,!0)).returnValue)return jb;nc[fo.IndexColorSelected]=this.AHg.cUl(zb.node);return 32}}svc(b){super.svc(b);this.ga.qa(Hc.a.Jmb,mc.a.view,this.jCe);this.ga.qa(Hc.a.Jmb,mc.a.table,this.Jmb);this.ga.Pc(Hc.a.Jmb,1030);this.ga.qa(Hc.a.tuc,mc.a.view,b);this.ga.qa(Hc.a.tuc,mc.a.table,this.tuc);this.ga.Pc(Hc.a.tuc,1126);this.ga.qa(Hc.a.PYb,mc.a.view,
b);this.ga.qa(Hc.a.PYb,mc.a.table,this.PYb);this.ga.Pc(Hc.a.PYb,1127)}get AHg(){return this.gOd}static MOm(){return new kw($a.a.instance.resolve(461),wu.instance,y.AFrameworkApplication.va,Wz.a.instance,new xn.a,$a.a.instance.resolve(106),$a.a.instance.resolve(46).instance,Object(F.a)(ve.a.instance,ve.a.instance.aub,"isTableNodeInLockedRange"))}static get instance(){return null!=kw.mZg?kw.mZg:kw.mZg=kw.MOm()}}Object(u.a)(kw,"TableStyleActor",Xp,[]);class ys{constructor(){this.Z=null}get name(){return"WordEditor.TableStyle"}uc(b){this.Z=
b;this.Z.ia("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>wp.instance).ha();this.Z.ia(617,()=>Wz.a.instance).ha()}init(){this.Z.resolve(23).Qr.continueWith(()=>{this.No()})}No(){this.Z.resolve(23).isFeatureEnabled(102)&&(kw.instance.Wb(),wu.instance.b6a(tn.a.instance),qa.StaticActiveAppFrame.za().Fe())}dispose(){}}Object(u.a)(ys,"TableStylePackage",null,[0,1]);var Cv=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",
attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},
children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",
QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",
Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},
children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},
{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",
LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},
children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",
LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},YC=d(1343);class It{constructor(b,h){this.rRa=b;this.LFa=h}zxo(b){this.rRa.GRd(b)}QIa(b){this.LFa.QIa(b)}I0b(b,h){return this.LFa.I0b(b,h)}H0b(b,h){return this.LFa.H0b(b,h)}MDe(b,h,r){this.LFa.MDe(b,h,r)}}Object(u.a)(It,"ClientPaginationHeaderFooterBridge",null,[488]);class qB{constructor(b,h){this.Ym=b;this.ga=h;this.Nda=new Ip.a;this.Oda=new Ip.a}QIa(b){b=zc.a.Za(b);if(b.yq()&&b.Gq()){b.$d();do 10===b.nf&&this.Clg(b.currentNode),
b.Fu();while(8!==b.nf)}}I0b(b,h){var r=this.UQb(h);if(!this.Nda.mb(r))return v.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.Nda.K(r);v.ULS.shipAssertTag(573400389,336,this.Oda.mb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");r=this.Oda.K(r);return this.cTf(h,b,r)}H0b(b,h){var r=this.UQb(h);if(!this.Nda.mb(r))return v.ULS.sendTraceTag(573400390,
3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.Nda.K(r);v.ULS.shipAssertTag(573400391,336,this.Oda.mb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");r=this.Oda.K(r);return this.aFf(h,b,r)}MDe(b,h,r){h=this.WOf(h,r);this.ga.Pb(b?Hc.a.pGe:Hc.a.gud,2,h)}WOf(b,h){h=this.Ym.ZPb(h);if(!h)return v.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),
0;h=this.Ym.Dla(h);const r=1===b;b=!(b%2);return 1===h?1:2===h?r?2:1:3===h?b?3:4:r?2:b?3:4}Clg(b){if(10===b.type){var h=new Ip.a,r=this.Ym.ZPb(b);v.ULS.shipAssertTag(573400393,336,!!r,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var A=this.Ym.Dla(r);b=this.UQb(b);this.SMg(b,A);this.RMg(b,h);r=zc.a.Za(r);if(r.Gq()){r.$d();do b=r.currentNode,A=this.Ym.A3c(b),b=this.Ym.vOi(b),h.add(A,b),r.Fu();while(36===r.nf)}}}SMg(b,
h){this.Oda.mb(b)?this.Oda.W(b,h):this.Oda.add(b,h)}RMg(b,h){this.Nda.mb(b)?this.Nda.W(b,h):this.Nda.add(b,h)}UQb(b){v.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ka(Rc.a.yna,0)}cTf(b,h,r){const A=1===h;h=!(h%2);switch(r){case 2:if(A){if(b.mb(2))return b.K(2)}else if(b.mb(0))return b.K(0);break;case 3:if(h){if(b.mb(1))return b.K(1)}else if(b.mb(0))return b.K(0);break;case 4:if(A){if(b.mb(2))return b.K(2)}else if(h){if(b.mb(1))return b.K(1)}else if(b.mb(0))return b.K(0);
break;case 1:if(b.mb(0))return b.K(0)}return!1}aFf(b,h,r){const A=1===h;h=!(h%2);switch(r){case 2:if(A){if(b.mb(5))return b.K(5)}else if(b.mb(3))return b.K(3);break;case 3:if(h){if(b.mb(4))return b.K(4)}else if(b.mb(3))return b.K(3);break;case 4:if(A){if(b.mb(5))return b.K(5)}else if(h){if(b.mb(4))return b.K(4)}else if(b.mb(3))return b.K(3);break;case 1:if(b.mb(3))return b.K(3)}return!1}}Object(u.a)(qB,"ClientPaginationPageAdornmentContentManager",null,[486]);class ZE{constructor(b,h,r,A,M,ba){this.Gzl=
oa=>{1===oa&&this.uG.BG&&(oa=this.$c.Dsa(this.uG.BG,8,8),this.Ym.iml(oa)?this.FRl(oa):this.D8o())};this.Wtp=oa=>{1===oa&&this.ga.Pb(ub.a.bY,2,!1)};this.uG=b;this.Ym=h;this.$c=r;this.Qc=A;this.JIc=M;this.ga=ba}S8o(){const b=new kh.StandardDialog;b.Ed=1;b.Qe(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);b.xY(0);b.Mx(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.Gzl)}FRl(b){b.fd(8);const h=this.Qc.Lc(15);
h.set(b.so.qk);this.JIc.Qzo(b);this.uG.dismiss();h.dispose();v.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}D8o(){const b=new kh.StandardDialog;b.Ed=1;b.Qe(1,Box4Intl.Box4Strings.L_OpenInWord);b.Qe(0,CommonUIStrings.l_Close);b.xY(0);b.Mx(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,0,this.Wtp);v.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(u.a)(ZE,"DeleteHeaderFooterDialog",
null,[]);class gH{constructor(b,h,r,A,M){this.Ym=b;this.$c=h;this.Qc=r;this.JIc=A;this.ga=M}create(b){return new ZE(b,this.Ym,this.$c,this.Qc,this.JIc,this.ga)}}Object(u.a)(gH,"DeleteHeaderFooterDialogFactory",null,[485]);class Xz{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){this.yda=null;this.kJg=(Eb,Sb,nc,Dc,Zc)=>{var Gd=this.fQf(Sb);return Gd?1===nc?32:(nc=this.control)?(Sb=this.Qc.Lc(15),Sb.Ab(Gd),Sb.Ei=Eb,nc.bfa?this.ga.Ob(Hc.a.dX,2):(Gd=this.Yki(Gd),Dc.Ft=Gd?1:0,Dc=Eb!==Hc.a.gud,(Eb=this.wKf(Eb,Zc))&&
nc.fEa(Eb),this.ga.Pb(Hc.a.S_d,2,Dc)),Sb.dispose(),32):8:8};this.vwf=(Eb,Sb,nc)=>{if(1===nc)return 32;this.Utk.create(this.control).S8o();return 32};this.wmo=(Eb,Sb,nc,Dc,Zc)=>1===nc?32:(Eb=this.control)?(Zc[Ng.a.On]=Eb.bfa,32):8;this.Hyb=(Eb,Sb,nc,Dc,Zc)=>{if(1===nc||!this.control.bfa)return 32;Sb=this.tzi(Eb,Zc);nc=Xz.wKi(this.control.BG);Dc=this.Qc.Lc(15);Dc.Ab(nc);Dc.Ei=Eb;Eb=this.$c.Vl();Eb.set(nc);this.sRa.uBf(Eb.currentNode,Sb);this.Ym.cWb(Eb);this.JIc.FQj(Eb,Sb);Dc.dispose();return 32};this.fEa=
(Eb,Sb,nc,Dc,Zc)=>{if(1===nc)return 32;Eb=this.wKf(Eb,Zc);this.control.bfa&&this.control.fEa(Eb);return 32};this.Uwe=(Eb,Sb,nc,Dc,Zc)=>{if(1===nc)return 32;Eb=this.EGi(Eb,Zc);Dc.Ft=Eb;Sb=this.fQf(Sb);if(!Sb)return 8;Dc=this.$c.Vl();Dc.set(Sb);Dc.vb(8);Dc.mt(8);if(!this.vl.ZQn(Dc,Eb))return 8;this.Ym.cWb(Dc);this.control.Yka(Dc.currentNode);return 32};this.Dlg=(Eb,Sb,nc,Dc,Zc)=>{if(1===nc)return 32;Eb=this.xRk.aLl(this.fQf(Sb));Zc.PopulationXML=Eb;return 32};this.wse=(Eb,Sb,nc,Dc,Zc)=>{Eb=this.tzi(Eb,
Zc);Sb=this.control.BG;nc=this.Ym.Dla(Sb);Zc[Ng.a.On]=Eb===nc;1===Eb&&(Zc[Ng.a.LabelText]=this.BLi(Sb)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.vre=(Eb,Sb,nc,Dc,Zc)=>{if(1===nc||!this.control.bfa)return 32;Sb=this.control.BG;void 0!==Sb&&null!==Sb&&(Sb=this.Ym.Dla(Sb),Eb=this.wKf(Eb,Zc),nc=this.control.f6b,Zc[Ng.a.Visible]=this.Ykp(Eb,Sb),Zc[Ng.a.On]=Eb===nc);return 32};this.Mmo=(Eb,Sb,nc,Dc,Zc)=>{if(1===
nc||!this.control.bfa)return 32;Eb=this.control.BG;void 0!==Eb&&null!==Eb&&this.qfo(Eb,Zc);return 32};this.Wlo=(Eb,Sb,nc,Dc,Zc)=>{if(1===nc||!this.control.bfa)return 32;Eb=this.EGi(Eb,Zc);Sb=this.control.BG;nc=0;void 0!==Sb&&null!==Sb&&(nc=Sb.getValue(Rc.a.yna));Zc[Ng.a.On]=Eb===nc;return 32};this.dX=(Eb,Sb,nc)=>{if(1===nc)return 32;this.control.dismiss();return 32};this.kae=()=>32;this.S_d=(Eb,Sb,nc,Dc,Zc)=>{if(1===nc)return 32;this.control.show(Zc);return 32};this.xub=(Eb,Sb,nc,Dc,Zc)=>{if(1===
nc)return 32;if(!Zc)return 8;Sb=Zc.q7a;if(!Sb||!Sb.isConnected)return 8;Eb=this.Ym.Xdd(Sb);if(!({isHeader:nc,kIg:Sb}=this.Ym.OIi(Sb)).returnValue)return 8;this.control.Yka(Eb);this.control.fEa(Sb);this.control.show(nc,Zc.Uye);return 32};this.ga=b;this.Ym=h;this.JIc=r;this.sRa=A;this.vl=M;this.$c=ba;this.Qc=oa;this.xRk=Ja;this.xyk=jb;this.Utk=zb}get control(){return this.yda}set control(b){this.yda=b}Wb(){this.ga.qa(Hc.a.Vbe,mc.a.view,this.kJg);this.ga.fb(Hc.a.Pog,mc.a.application,this.wmo,96);this.ga.qa(Hc.a.pGe,
mc.a.view,this.kJg);this.ga.qa(Hc.a.gud,mc.a.view,this.kJg);this.ga.fb(Hc.a.kae,mc.a.view,this.kae,64);this.ga.qa(Hc.a.S_d,mc.a.view,this.S_d);this.ga.fb(Hc.a.dX,mc.a.application,this.dX,96);this.ga.fb(Hc.a.xub,mc.a.application,this.xub,96);this.ga.fb(Hc.a.qTo,mc.a.view,this.fEa,96);this.ga.qa(Hc.a.RMj,mc.a.view,this.fEa);this.ga.qa(Hc.a.TMj,mc.a.view,this.fEa);this.ga.qa(Hc.a.SMj,mc.a.view,this.fEa);this.ga.qa(Hc.a.UMj,mc.a.view,this.fEa);this.ga.fb(Hc.a.QWo,mc.a.view,this.Hyb,100);this.ga.fb(Hc.a.DOj,
mc.a.view,this.Hyb,4);this.ga.fb(Hc.a.COj,mc.a.view,this.Hyb,4);this.ga.fb(Hc.a.AOj,mc.a.view,this.Hyb,4);this.ga.fb(Hc.a.BOj,mc.a.view,this.Hyb,4);this.ga.qa(Hc.a.Uwe,mc.a.view,this.Uwe);this.ga.qa(Hc.a.Tyg,mc.a.view,this.Uwe);this.ga.fb(Hc.a.Dlg,mc.a.view,this.Dlg,96);this.ga.fb(Hc.a.vwf,mc.a.view,this.vwf,4);this.ga.fb(Hc.a.jxj,mc.a.view,this.vre,97);this.ga.fb(Hc.a.lxj,mc.a.view,this.vre,97);this.ga.fb(Hc.a.kxj,mc.a.view,this.vre,97);this.ga.fb(Hc.a.mxj,mc.a.view,this.vre,97);this.ga.fb(Hc.a.Cxj,
mc.a.view,this.wse,97);this.ga.fb(Hc.a.Bxj,mc.a.view,this.wse,97);this.ga.fb(Hc.a.zxj,mc.a.view,this.wse,97);this.ga.fb(Hc.a.Axj,mc.a.view,this.wse,97);this.ga.fb(Hc.a.qmo,mc.a.view,this.Mmo,97);this.ga.fb(Hc.a.jog,mc.a.view,this.Wlo,97)}Yki(b){const h=this.Ym.ZPb(b),r=this.Ym.Dla(h);b=this.sRa.uBf(b,r);this.control.Yka(h);return b}tzi(b,h){switch(b){case Hc.a.DOj:case Hc.a.Cxj:b=1;break;case Hc.a.COj:case Hc.a.Bxj:b=2;break;case Hc.a.AOj:case Hc.a.zxj:b=3;break;case Hc.a.BOj:case Hc.a.Axj:b=4;break;
default:b=h}return b}wKf(b,h){switch(b){case Hc.a.RMj:case Hc.a.jxj:b=1;break;case Hc.a.TMj:case Hc.a.lxj:b=2;break;case Hc.a.SMj:case Hc.a.kxj:b=3;break;case Hc.a.UMj:case Hc.a.mxj:b=4;break;case Hc.a.pGe:case Hc.a.gud:b=h;break;case Hc.a.Vbe:b=0;break;default:b=h}return b}EGi(b,h){return b===Hc.a.Tyg||b===Hc.a.jog?parseInt(h.MenuItemId):h}fQf(b){return this.vl.aba(b.Ok)}Ykp(b,h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}qfo(b,
h){const r=this.BLi(b);if(h[Vc.a.Visible]=r)b=this.vl.xKi(this.xyk(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[Vc.a.LabelText]=b}BLi(b){const h=this.$c.Vl();h.set(b);h.vb(8);h.mt(8);return 1<this.vl.wPf(h)}static wKi(b){const h=new zc.a;h.set(b);h.vb(10);return Ku.WordSectionNavigator.JKo(h)}}Object(u.a)(Xz,"HeaderFooterActor",null,[]);var vJ=d(793),ey=d(710);class fy{constructor(b,h,r,A,M){this.xGk=b;this.Ym=h;this.vl=r;this.$c=A;this.ga=M}Kki(b,h){this.Ym.cWb(b);
h=this.B2l(b,h);b.rc();return h}uBf(b,h){b=this.$c.Dsa(b,8,8);let r=!1;this.vl.xVa(b,A=>{const M=this.$c.Vl();M.set(A);r=(A=this.Kki(M,h))||r;return A});return r}B2l(b,h){if(3!==this.ga.mode)return!1;let r=!1;h=ey.a.pxf(h);for(let A=0;A<h.length;++A)r=this.xGk.A2l(b,h[A])||r;return r}}fy.dQl=1;Object(u.a)(fy,"HeaderFooterInserter",null,[478]);class lw{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){this.yEh=this.mfh=!1;this.BG=null;this.mXe=!1;this.f6b=0;this.KWb=()=>{this.mXe=!0};this.K9=b;b.bind(this);
this.acf=A;this.tuk=jb;this.exh=M;this.qHk=ba;this.Nib=oa;this.U_=h;this.footer=r;this.U_.kMl();this.K9.gB();this.jaf=fy.dQl;this.sRa=Ja;lw.ga=zb;this.zQ=Eb}get bfa(){return this.mfh}show(b=!0,h=!0){this.bfa||(this.$9j(),this.$Nj(!0),this.U_.Cuo(),this.tuk(),this.Qep(),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.kCa&&(zg.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new vJ.a,{state:0,disablePopover:!0}))):v.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));
(this.yEh=h)&&this.exh(b)}dismiss(b=!1){this.bfa&&(this.qHk(b),this.$Nj(!1),this.JNb(),this.f6b=0,this.cgp(),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.kCa&&(zg.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new vJ.a,{disablePopover:!1}))):v.ULS.sendTraceTag(509384031,3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}$Nj(b){this.mfh=b;lw.ga.Ob(ub.a.xFf,2);this.K9.p4(b);this.U_.p4(b);this.footer.p4(b);this.acf()}Yka(b){this.BG!==b&&(this.BG=
b,this.U_.Yka(b),this.footer.Yka(b),this.f6b=0,this.Hyb(this.Nib.Dla(b)))}JNb(){this.BG&&(this.U_.Rob(),this.footer.Rob(),this.BG=null)}update(){this.bfa&&this.F2b()}F2b(){this.BG&&(this.Nib.XYl(this.BG)&&this.Nib.M0m(this.BG)?this.$9j():this.dismiss())}$9j(){const b=this.Nib.Dla(this.BG);b!==this.jaf&&this.Hyb(b)}Hyb(b){this.jaf=b;this.fEa(this.qPm(b))}qPm(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}fEa(b,h=!0){this.f6b!==b&&(this.sRa.uBf(this.BG,this.jaf),this.U_.QMj(b),
this.U_.bVh(Ii.a.Kfa),this.footer.QMj(b),this.footer.bVh(Ii.a.pfa),this.f6b=b,this.bfa&&this.yEh&&this.i3l(h))}i3l(b){this.exh(b);b?this.U_.pxc():this.footer.pxc()}dispose(){this.K9.Vca();this.U_.dispose();this.footer.dispose()}Qep(){this.zQ.VSc(this.KWb);this.mXe=!1}cgp(){this.zQ.lue(this.KWb);this.mXe&&lw.ga.Ob(Hc.a.kae,2)}static nWl(){lw.ga.Pb(La.a.Zrb,2,!0);lw.ga.Ob(Hc.a.U6,2)}}lw.ga=null;Object(u.a)(lw,"HeaderFooterControl",null,[504,11]);class xp{constructor(b,h,r,A,M){this.acf=b;this.Nib=h;
this.sRa=r;this.ga=A;this.zQ=M}create(b,h,r,A,M){return new lw(b,h,r,this.acf,A,M,this.Nib,this.sRa,lw.nWl,this.ga,this.zQ)}}Object(u.a)(xp,"Factory",null,[484]);class gx{constructor(){this.yda=null}get control(){return this.yda}set control(b){this.yda=b}mGf(b){return this.nGf(this.control.BG,this.control.f6b,b.isHeader,b)}nGf(b,h,r,A){return()=>{if(!b.isConnected)return null;this.control.Yka(b);this.control.fEa(h);this.control.show(r);return A}}dismiss(){this.yda.bfa&&this.yda.dismiss()}}Object(u.a)(gx,
"HeaderFooterControlLauncher",null,[]);var Yz=d(1114),wJ=d(773),ZC=d(810);class Wy{constructor(b,h,r){this.mAc=null;const A=h?"Header":"Footer";this.Ls=b.ownerDocument.createElement("div");this.Ls.id=h?"HeaderPane":"FooterPane";this.Ls.classList.add(Wy.P0m,A);this.FJb=(new ZC.a(this.Ls,"WACViewPanel_"+A)).CK;this.Ls.appendChild(this.FJb);b.appendChild(this.Ls);h&&(this.mAc=b.ownerDocument.createElement("div"),this.mAc.classList.add(Wy.V0m),this.Ls.appendChild(this.mAc));this.c9g=r.jFm(this.Ls)}bind(){}p4(b){b?
this.c9g.s6k():this.c9g.u6k()}Ydl(b){b.Wdc(this.FJb)}}Wy.V0m="HeaderToolbarContainer";Wy.P0m="HeaderFooterPane";Object(u.a)(Wy,"PaneControlDom",null,[515]);class mw{constructor(b,h,r,A,M){this.uG=this.xr=null;this.Emj=()=>{this.uG.dismiss(!0);if(this.f7b){const ba=new dw.a(!0);this.f7b.tNa(ba)}return!0};this.FD=ba=>{ba.Nb.preventDefault();return!1};this.Ls=b.ownerDocument.createElement("div");this.Ls.id=mw.J7h;this.Ls.className=mw.J7h;this.T1=A;this.f7b=M;this.tOi=new Wy(this.Ls,!0,h);this.LJl(this.Ls);
this.yqi=new Wy(this.Ls,!1,h);this.p4(!1);b.appendChild(this.Ls)}LJl(b){this.xr=b.ownerDocument.createElement("div");this.xr.id=mw.A9n;this.xr.className=mw.y9n;this.xr.tabIndex=0;this.xr.setAttribute(Pe.a.Sh,Pe.a.X$);this.xr.setAttribute(Pe.a.Yja,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.xr)}bind(b){this.uG=b}p4(b){if(!b&&this.T1){var h=new dw.a(!0);this.T1.tNa(h)}!b&&this.f7b&&(h=new dw.a(!0),this.f7b.tNa(h));this.Ls.style.display=b?"":"none";this.tOi.p4(b);
this.yqi.p4(b)}hWo(){this.xr.focus()}gB(){Nc.a.instance.nb(zd.a.click,this.xr,this.Emj);ee.a.instance.nb(zd.a.lz,this.Ls,this.FD)}Vca(){Nc.a.instance.xc(zd.a.click,this.xr,this.Emj);ee.a.instance.xc(zd.a.lz,this.Ls,this.FD)}}mw.J7h="HeaderFooterControl";mw.A9n="HeaderFooterOverlay";mw.y9n="EditingSurfaceOverlay HeaderFooterOverlay";Object(u.a)(mw,"HeaderFooterControlDom",null,[503]);var cu=d(155);class hH{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){this.K9=null;this.sa=new Fd.a;this.uG=this.RLd=null;this.Cfg=
Eb=>{this.xca(Eb);this.sa.raiseEvent("OnShowEventKey")};this.Bfg=Eb=>{this.xl&&(this.RLd=new Yz.a(this.xl));this.Zb.FYc(Ii.a.Kfa);this.Zb.FYc(Ii.a.pfa);this.tha(Eb);this.sa.raiseEvent("OnDismissEventKey")};this.lpe=()=>{this.RLd&&(this.RLd.dispose(),this.RLd=null)};this.Zb=b;this.kq=h;this.Wyh=r;this.Zyk=A;this.gJk=M;this.ga=ba;this.Ich=wJ.a.create();this.Kgh=kc.KeyInputManager.lc(rf.a.Tu,0);this.G1=kc.KeyInputManager.lc(rf.a.T4,0);this.lPk=kc.KeyInputManager.lc(rf.a.W0a,0);this.$K=oa;this.Ga=Ja;
this.T1=jb;this.f7b=zb;this.xl&&this.xl.r6(this.lpe)}fQh(b){this.sa.addHandler("OnShowEventKey",b)}BDo(b){this.sa.removeHandler("OnShowEventKey",b)}GRd(b){this.sa.addHandler("OnDismissEventKey",b)}oEj(b){this.sa.removeHandler("OnDismissEventKey",b)}get xl(){const b=this.$K.value;return b?b.jj?b:(v.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(v.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),
null)}get control(){return this.uG}get VBl(){return this.Ich}bind(b){this.uG=this.fAl(b);this.Ich.instance=this.uG}fAl(b){this.K9=new mw(b,this.gJk.value,this.Ga,this.T1,this.f7b);b=this.Wyh.value.create(this.ga,this.K9.tOi,!0,Ii.a.Kfa);const h=this.Wyh.value.create(this.ga,this.K9.yqi,!1,Ii.a.pfa);this.uG=this.Zyk.value.create(this.K9,b,h,this.Cfg,this.Bfg);this.zVf();this.IW();return this.control}zVf(){var b=3===this.ga.mode?Ii.a.GF:Ii.a.nvc;const h=this.Zb.ie(Ii.a.Kfa);h.parent=b;this.Zb.Mef(Ii.a.Kfa);
const r=this.Zb.ie(Ii.a.pfa);r.parent=b;this.Zb.Mef(Ii.a.pfa);b=this.Zb.ie(cu.a.JRb);b.parent=pd.AFrame.Kq;b.Pja(()=>{this.K9.hWo()});b.bindAction(this.Kgh,Hc.a.dX);b.bindAction(this.G1,Hc.a.dX);b.bindAction(this.lPk,Hc.a.dX);h.bindAction(this.G1,Hc.a.dX);r.bindAction(this.G1,Hc.a.dX)}IW(){this.kq.IW(Ii.a.Kfa);this.kq.IW(cu.a.v$a);this.kq.IW(Ii.a.pfa);this.kq.IW(cu.a.JRb)}xca(b){this.kq.eL(Ii.a.Kfa);this.kq.eL(cu.a.v$a);this.kq.eL(Ii.a.pfa);this.kq.eL(cu.a.JRb);this.kq.Cx(pd.AFrame.Jo);this.Zb.oSc(Ii.a.Kfa);
this.Zb.oSc(Ii.a.pfa);b?this.Zb.Eg(Ii.a.Kfa):this.Zb.Eg(Ii.a.pfa)}tha(b){this.kq.Cx(Ii.a.Kfa);this.kq.Cx(cu.a.v$a);this.kq.Cx(Ii.a.pfa);this.kq.Cx(cu.a.JRb);this.kq.eL(pd.AFrame.Jo);(b||this.Zb.currentScope&&(this.Zb.currentScope.name===Ii.a.Kfa||this.Zb.currentScope.name===cu.a.v$a||this.Zb.currentScope.name===Ii.a.pfa||this.Zb.currentScope.name===cu.a.JRb))&&this.Zb.Eg(pd.AFrame.Jo)}dispose(){const b=this.Zb.ie(cu.a.JRb);b.qt(this.Kgh);b.qt(this.G1);this.Zb.ie(Ii.a.Kfa).qt(this.G1);this.Zb.ie(Ii.a.pfa).qt(this.G1);
this.xl&&this.xl.IZb(this.lpe);this.control.dispose()}}Object(u.a)(hH,"HeaderFooterControlOwner",null,[482,483]);var Qr=d(1099);class er{constructor(b,h,r,A,M,ba,oa,Ja){this.wqa=b;this.jQk=h;this.xMe=r;this.Zm=A;this.JIk=M;this.IOk=ba;this.Oyk=oa;er.Rh=Ja}pbn(b,h){this.jQk(b,1,3,null,!1);this.wqa.sQj(Vz.a.rWb,1696,b.currentNode);this.xMe(b,0,this.Zm?3:1,h);this.xMe(b,1,2,h);this.xMe(b,2,this.Zm?1:3,h);this.JIk(b);this.IOk(b,!1,!0,null);this.Oyk(b,h)}static get CM(){return null!=er.d7g?er.d7g:er.d7g=
$a.a.instance.resolve(393)}static get sl(){return null!=er.R2g?er.R2g:er.R2g=$a.a.instance.resolve(349)}static nUo(b,h,r){bi.moveToCellContent(b,0,h);Ab.OutlineElementNavigator.Me(b);er.CM.zod(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);er.sl.HH(b.currentNode,r);h||er.sl.ir.iEa(b,1,-115);2===h&&er.sl.ir.syb(b.currentNode,1,-115);bi.returnToContainingTable(b)}static OWo(b,h){Ab.OutlineElementNavigator.Me(b);er.CM.zod(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,
b.currentNode);Ab.OutlineElementNavigator.ke(b)}static Ulm(){return(b,h,r)=>{er.nUo(b,h,r)}}static Dvm(){return(b,h)=>{er.OWo(b,h)}}static tOm(b){return(h,r,A,M,ba)=>b.Vza(h,r,A,M,ba)}static oMm(){return(b,h,r,A,M)=>er.Rh.gz(b,h,r,A,M)}}er.Rh=null;Object(u.a)(er,"HeaderFooterDefaultTableInserter",null,[480]);class $C{constructor(b,h,r,A){this.Ym=b;this.TId=h;this.$c=r;this.vl=A}FQj(b,h){b.so.properties.setValue(Rc.a.wSf,2===h||4===h);b.vb(8);b.Jtd(8).properties.setValue(Rc.a.R$d,3===h||4===h)}Qzo(b){this.vl.xVa(b,
h=>{const r=this.$c.Vl();r.set(h);this.Ym.cWb(r);this.FQj(r,1);this.Rzo(r);return!0})}Rzo(b){for(;b.$d();)b.Tg()}}Object(u.a)($C,"HeaderFooterEditor",null,[479]);var xJ=d(1084);class $E extends iw.a{constructor(b){super();this.ccf=b}get index(){return 0}run(){this.ccf()}L0m(b,h){h.property===Rc.a.wSf&&this.$I()}Z9n(b,h){h.property===Rc.a.R$d&&this.$I()}$I(){this.z0()}}Object(u.a)($E,"ControlUpdateNeededTracker",iw.a,[]);class Rs{constructor(b,h,r,A,M,ba){this.Chb=null;this.$yk=r;this.KCd=h;this.L7b=
b;this.YIk=A;this.pSa=ba}start(){this.L7b.bind(qa.StaticActiveAppFrame.za().nG);this.KCd.control=this.L7b.control;this.KCd.Wb();this.$yk.control=this.L7b.control;this.YIk.value.create(this.L7b.control,Object(F.a)(this.KCd,this.KCd.Yki,"ensureSectionHeaderFooterAttachedToControl")).Wb();this.H3m()}H3m(){this.Chb=new $E(()=>{this.L7b.control.update()});const b=df.a.ff.Pl;b.jf(35).ro(Object(F.a)(this.Chb,this.Chb.L0m,"headerFooterContainerNodePropertyChanged"));b.jf(8).ro(Object(F.a)(this.Chb,this.Chb.Z9n,
"pageContentNodePropertyChanged"));xJ.a.Gte(Object(F.a)(this.Chb,this.Chb.$I,"setUpdateNeeded"));Ls.a.instance.sva(this.Chb,3)}dispose(){this.L7b.dispose();this.pSa.Bgi()}}Object(u.a)(Rs,"HeaderFooterManager",null,[]);class yJ{constructor(b,h,r,A){this.vl=b;this.Ym=h;this.H9b=r;this.qPe=A}A2l(b,h){let r=!1;const A=ey.a.iMf(h);b.pv(A)||(this.Dbn(b,h),this.qPe.obn(b.currentNode,h),r=!0);return r}Dbn(b,h){const r=this.H9b.create(rn.a.emc),A=b.currentNode.ka(Rc.a.yna,0);r.properties.setValue(Rc.a.yna,
A);r.properties.setValue(Rc.a.dmc,h);h=ey.a.iMf(h);b.Wf(r,h)}}Object(u.a)(yJ,"HeaderFooterNodeLevelInserter",null,[477]);var Xy=d(1407),Zz=d(1443);class gy extends Xy.a{constructor(b,h,r){super(b,h,"","");this.LGb=null;this.HOi=gy.qdi;this.r6c=[];this.DUe=r}get BC(){return!0}get cssClass(){return"cui-herodock"}Bn(){this.wuo();super.Bn()}iVa(){for(const b of this.r6c)b.l1d();super.iVa()}Sdp(){const b=[],h=[],r=[];for(let A=0;A<this.r6c.length;A++){const M=this.r6c[A];M.visible?b.length<this.HOi?b.push(M):
Object(Za.a)(Zz.FlyoutAnchor,M)?Array.addRange(h,M.Pom()):h.push(M):r.push(M)}return{oop:b,w9n:h,Wen:r}}KJl(b){if(!b||!b.length)return null;const h=new fj.a(this.root,this.id+"OverflowMenu",null,null,null),r=new Wf.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const A of b)r.Wf(A.ZW("Menu20"));h.Wf(r);return h}wuo(){this.$ua();this.Rc=Yg.a.$Za(this.Rc);this.vE();const {oop:b,w9n:h,Wen:r}=this.Sdp();for(var A of b){var M=A.ZW("Medium20");
M.enabled=!0;this.zcc(M,this.children.count);this.Rc.appendChild(M.Rc);M.isa()}if(A=this.KJl(h)){if(this.LGb)this.LGb.Ig=A;else{M=this.id+"OverflowMenuLauncher";const ba={};ba.Image20by20=this.DUe.OverflowMenuImage20by20;ba.Image20by20Class=this.DUe.OverflowMenuImage20by20Class;ba.PopulateDynamically="false";ba.HideDefaultArrow="true";ba.Alt=this.DUe.OverflowMenuTooltip;ba.Command="798637440";ba.Id=M;this.LGb=new Zz.FlyoutAnchor(this.root,M,ba,A)}A=this.LGb.ZW("Small20");A.enabled=!0;this.zcc(A,this.children.count);
this.Rc.appendChild(A.Rc);A.isa()}if(y.AFrameworkApplication.J.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const ba of r)A=ba.ZW("Medium20"),this.Wf(A),A.isa()}dispose(){this.LGb&&(this.LGb.dispose(),this.LGb=null);for(const b of this.r6c)b.dispose();this.$ua();super.dispose()}set BC(b){super.BC=b}}gy.qdi=4;Object(u.a)(gy,"HeroDock",Xy.a,[]);var $z=d(1485);class iH extends $z.a{constructor(){super();this.ABe=this.cqn=this.Ffp=!1;this.CMn=y.AFrameworkApplication.x_f?1:gy.qdi}}Object(u.a)(iH,
"ToolbarBuildOptions",$z.a,[]);var Ij=d(1440),rB=d(1517),$o=d(1543);class sB extends Xy.a{constructor(b,h,r){super(b,h,"","");this.GDc=r.Alignment;this.Sfh=r.ScalingDirection===Ij.a.tgk}Bn(){this.yAa();this.c_(this.Rc);super.Bn()}c_(b){for(const h of this.children){h.vE();switch(this.GDc){case Ij.a.XHe:Yg.a.rg(h.Rc,"cui-toolbar-button-left");break;case Ij.a.tgb:Yg.a.rg(h.Rc,"cui-toolbar-button-center");break;case Ij.a.T3b:Yg.a.rg(h.Rc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.GDc);
}h.visible&&b.appendChild(h.Rc);h.isa()}}tR(b){if(!Object(Za.a)(gj.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.GDc){case Ij.a.XHe:return"cui-toolbar-buttondock alignleft";case Ij.a.tgb:return"cui-toolbar-buttondock aligncenter";case Ij.a.T3b:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.GDc);}}get BC(){return!0}get alignment(){return this.GDc}Flc(){let b=0;if(this.alignment===Ij.a.tgb)for(const h of this.children){const r=
h;r.visible&&(b+=r.Rc.offsetWidth)}else b=this.Rc.offsetWidth;return b}f9d(){let b=null;if(this.alignment===Ij.a.tgb)for(const h of this.children){if(h.visible){b=Sys.UI.DomElement.getBounds(h.Rc);break}}else b=Sys.UI.DomElement.getBounds(this.Rc);return b?0===this.root.H4?b.x:b.x+b.width:0}m6d(){let b=null;if(this.alignment===Ij.a.tgb){if(0<this.children.count){const h=this.children.EJf(this.children.count-1);for(;h.mvb();){const r=h.get_current();if(r.visible){b=Sys.UI.DomElement.getBounds(r.Rc);
break}}}}else b=Sys.UI.DomElement.getBounds(this.Rc);return b?0===this.root.H4?b.x+b.width:b.x:0}nBf(){for(const b of this.children){const h=b;if(!Object(Za.a)(gj.a,h)||h.control.visible)h.visible=!0}}TNo(b){const h=this.children.toArray(),r=new $o.a;let A=this.Sfh?0:h.length-1;const M=this.children.count,ba=this.root.i0a;for(;this.Flc()>=b&&!(A>=M||0>A);){const oa=h[A];ba&&Object(Za.a)(gj.a,oa)&&oa.control.visible&&(r.add(oa),oa.gTh());A+=this.Sfh?1:-1}for(const oa of r)oa.QCj(),oa.visible=!1}set BC(b){super.BC=
b}}Object(u.a)(sB,"ButtonDock",Xy.a,[]);class Dv extends Om.a{constructor(b,h,r,A,M,ba,oa=!1){super(b,h,ba);this.axa=this.n1=this.pqa=null;this.i1e=!1;this.Zab=A;this.ABe=M;this.POd=0;Mf.c(h.Size)||(h.Size===Ij.a.FRg||r.options.cqn?this.POd=0:h.Size===Ij.a.Ajk&&(this.POd=1));this.yRk=oa}get i0a(){return!0}Wf(b){super.Wf(b);Object(Za.a)(sB,b)&&!this.i1e&&(b.alignment===Ij.a.XHe?(this.pqa&&this.jAg(),this.pqa=b):b.alignment===Ij.a.tgb?(this.n1&&this.jAg(),this.n1=b):b.alignment===Ij.a.T3b&&(this.axa&&
this.jAg(),this.axa=b))}jAg(){this.i1e=!0;this.axa=this.n1=this.pqa=null}myb(b,h){b=this.L2c(b);Mf.c(b)||b.visible===h||(b.visible=h,this.refresh())}Bn(){super.Bn();this.AAj(!0)}AAj(b){const h=this.root.xMb;Mf.c(this.Rc)&&this.lMl();this.Rc=Yg.a.$Za(this.Rc);this.s6c&&this.Rc.appendChild(this.s6c);for(const r of this.children)r.visible&&(r.vE(),this.Rc.appendChild(r.Rc),r.isa());this.n1&&b&&this.Y1l();h&&h.O0();this.dirty=!1}Y1l(){if(this.n1.visible&&this.n1.children.count&&(this.tTh(0,0),this.WYl(this.pqa,
this.n1,this.axa))){let b=0,h=0;const r=this.pqa?this.pqa.Flc():0,A=this.axa?this.axa.Flc():0;if(0<A||0<r)A>r?(b=0,h=A-r):(b=r-A,h=0);this.tTh(b,h)}}WYl(b,h,r){let A=!1;0===this.root.H4?(b&&(A=b.m6d()>h.f9d()),!A&&r&&(A=h.m6d()>r.f9d())):(b&&(A=b.m6d()<h.f9d()),!A&&r&&(A=h.m6d()<r.f9d()));return A}tTh(b,h){0===this.H4?(this.n1.Rc.style.marginLeft=b+"px",this.n1.Rc.style.marginRight=h+"px"):(this.n1.Rc.style.marginRight=b+"px",this.n1.Rc.style.marginLeft=h+"px")}lMl(){this.vE()}uv(){this.thi(()=>{Wv.a.prototype.uv.call(this)})}Oua(b){b=
this.L2c(b);Mf.c(b)||this.thi(Object(F.a)(b,b.An,"pollForStateAndUpdate"))}thi(b){this.Zrc=this.$bb=!1;b();if(this.$bb||this.Zrc)this.yRk||this.refresh(),this.scale()}tR(b){if(!Object(Za.a)(gy,b)&&!Object(Za.a)(sB,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(Za.a)(sB,b)&&b.alignment===Ij.a.tgb)for(const h of this.children)if(h.alignment===Ij.a.tgb)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b=
"cui-toolbar-toolbar ";0===this.POd?(b+="cui-toolbar-onerow ",y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.wba||(b+="UITextTranformUpperCase ")):1===this.POd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get lAa(){return"div"}get rca(){return 26}get e2j(){return this.ZQ}set e2j(b){this.ZQ=b}kFl(b){b=b[Ij.a.Ux];return new sB(this.root,b.Id,b)}vE(){super.vE();this.Rc.setAttribute("role","toolbar");this.properties.Title&&this.Rc.setAttribute("title",this.properties.Title)}rPa(b){return this.root&&
this.root.rvc(b)?!0:!1}kWo(){this.B_a()}scale(){super.scale();if(!Yg.a.Ys(this.properties.Scale)||this.i1e)return!1;Mf.c(this.pqa)||(this.pqa.visible=!0,this.pqa.nBf());Mf.c(this.n1)||(this.n1.visible=!0,this.n1.nBf());Mf.c(this.axa)||(this.axa.visible=!0,this.axa.nBf());this.AAj(!1);const b=this.Rc.offsetWidth,h=Mf.c(this.pqa)?0:this.pqa.Flc(),r=Mf.c(this.n1)?0:this.n1.Flc(),A=Mf.c(this.axa)?0:this.axa.Flc();A+r+h>=b&&(A+h>=b?(this.MOi(this.n1),A>=b?(this.MOi(this.pqa),this.Xwg(this.axa,b)):this.Xwg(this.pqa,
b-A)):this.Xwg(this.n1,b-A-h));this.$bb=!1;this.Bn();return!1}MOi(b){b&&(b.visible=!1)}Xwg(b,h){b&&b.TNo(h)}}Object(u.a)(Dv,"Toolbar",Om.a,[1790]);class Yy extends Dv{constructor(b,h,r,A,M=!1){super(b,h,r,!1,!1,A,M);this.Ush=!0}get rca(){return 7}get cssClass(){return Yy.Gfp+" "+super.cssClass}static get Gfp(){let b="cui-statusbar";y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.wba||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(u.a)(Yy,"StatusBar",Dv,[]);var tB=d(1469);class xu extends tB.a{constructor(){super();
this.toolbar=null;this.Zfe=!1}}Object(u.a)(xu,"ToolbarBuildContext",tB.a,[]);class zJ extends Gp.a{constructor(b,h,r,A){super(b,h,di.Task.j7(r),A);this.v4n=M=>{this.uBg(this.Uil(M.Hid,M.YWc));this.toolbar.e2j=this;this.toolbar.Bn();this.placeholder.appendChild(this.toolbar.Rc);Yg.a.rg(this.placeholder,"loaded");this.pza.continueWith(()=>{this.pza.result.IWb(this.toolbar)},11)};if(Mf.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}uBg(b){this.root=
b}get vJg(){return this.options}Sil(){const b=new xu,h=new rB.a;h.id="toolbar";h.mjd=1;h.handler=this.v4n;h.data=b;this.cAa.Sve(h)}Uil(b,h){var r=Ij.a.pla(b,Ij.a.ukk);Mf.c(r)&&(r=Ij.a.pla(b,Ij.a.Hjk),h.Zfe=!0);if(Mf.c(r))throw Error.create("No toolbar element was present in the data");b=new Ij.a(r);r=y.AFrameworkApplication.J.$("ToolbarScalingRedundancyEliminationIsEnabled");h.Zfe?this.uBg(new Yy(b.attributes[Ij.a.id],b.attributes,this,this.Zda,r)):this.uBg(new Dv(b.attributes[Ij.a.id],b.attributes,
this,this.vJg.Ffp,this.vJg.ABe,this.Zda,r));this.toolbar.yza=this.options.yza;this.toolbar.IFe=!0;this.toolbar.Bn();b=Ij.a.Fx(Ij.a.pla(b.node,Ij.a.Xfk));h=this.ygl(b,h);for(const A of h)this.toolbar.Wf(A);return this.toolbar}ygl(b,h){const r=[];for(let A=0;A<b.length;A++)this.AXa(b[A])||Array.add(r,this.bhl(b[A],h));return r}bhl(b,h){const r=Ij.a.g4c(b);let A=null;r===Ij.a.tek?A=this.Igl(b,h):r===Ij.a.Hgk&&(A=this.yhl(b,h));return A}yhl(b,h){var r=new Ij.a(b);r=new gy(this.root,r.attributes[Ij.a.id],
b[Ij.a.Ux]);r.HOi=this.vJg.CMn;b=Ij.a.pla(b,Ij.a.gBb);b=Ij.a.Fx(b);const A=[];for(let ba=0;ba<b.length;ba++){var M=b[ba];this.AXa(M)||(M=this.fka(M,h),Array.add(A,M))}r.r6c=A;return r}Igl(b,h){new Ij.a(b);const r=this.toolbar.kFl(b);b=Ij.a.pla(b,Ij.a.gBb);b=Ij.a.Fx(b);for(let A=0;A<b.length;A++){if(this.AXa(b[A]))continue;const M=this.Til(b[A],h);r.Wf(M)}return r}Til(b,h){var r=new Ij.a(b);const A=r.name;r=r.attributes[Ij.a.vCc];let M;M=h.Zfe?"Small14":"Small";switch(A){case Ij.a.button:return b=
this.fka(b,h),b.ZW(Mf.b(r)?M:r);case Ij.a.eKa:return M=h.Zfe?"Medium14":"Medium",b=this.fka(b,h),b.ZW(Mf.b(r)?M:r);case Ij.a.label:return b=this.fka(b,h),b.ZW(Mf.b(r)?M:r);case Ij.a.separator:return b=this.fka(b,h),b.ZW("Small");case Ij.a.toggleButton:return b=this.fka(b,h),b.ZW(Mf.b(r)?M:r);default:throw Error.create("Invalid control type.");}}}Object(u.a)(zJ,"ToolbarBuilder",Gp.a,[]);var jH=d(2108);class aF{constructor(b,h,r,A,M,ba){this.Nvb=()=>{this.toolbar.An()};this.JK=b;b=new Vo.a(Li.a.B6a,
WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);A=new iH;A.iJ={};ba=3!==ba.mode;A.iJ.HeaderToolbarControlsRight=ba;A.iJ.HeaderToolbarButtonDockRight=ba;A.iJ.HeaderToolbarButtonRemovePageNumbers=ba;M=new zJ(A,this.JK,this,M);M.cAa=new jH.a(aF.W0m,b);M.Sil();this.Bqa=M.toolbar;r.execute(oa=>{this.toolbar.EH=oa});this.toolbar.refresh();this.toolbar.An();this.ii=h;h.d6a(this.Nvb)}get toolbar(){return this.Bqa}dispose(){this.ii.Hvc(this.Nvb);this.toolbar&&(this.toolbar.dispose(),
this.Bqa=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.kWo()}mWl(){this.toolbar.T6()}IWb(){}}aF.W0m="WordEditorHeaderToolbarData";Object(u.a)(aF,"HeaderFooterToolbar",null,[267,502]);class AJ{constructor(b,h,r,A,M){this.ii=b;this.EOe=h;this.Cd=r;this.Zda=A;this.ga=M}create(b){return new aF(b,this.ii,this.EOe,this.Cd,this.Zda,this.ga)}}Object(u.a)(AJ,"Factory",null,[476]);class kH{constructor(b,h){this.$c=b;this.vl=h}aLl(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+
this.$Kl(b)+"</Controls></MenuSection></Menu>"}nvm(b){const h=this.$c.Vl();h.set(b);h.vb(8);h.fd(8);return h}$Kl(b){if(!b)return"";let h="";b=this.nvm(b);this.vl.xVa(b,r=>{const A=this.vl.xKi(r);r=r.getValue(Rc.a.yna);h+=Nk.k(r.toString(),r.toString(),Hc.a.Tyg.toString(),Hc.a.jog.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,A));return!0});return h}}Object(u.a)(kH,"HeaderFooterToolbarGenerator",null,[475]);var bF=d(130);class xr extends Sy.a{constructor(b,
h,r,A,M,ba,oa){super(b,h,r,A);this.sv=()=>{this.atd(this.Cb)};this.JK=b.container;this.nx=document.createElement("div");this.eQ(this.nx);this.$Ga=M;this.iRa=ba;this.ko.execute(Ja=>{Ja.oY(this.sv)});this.XM=oa;this.JK.style.backgroundColor=this.XM.Qkc()}dispose(){super.dispose();this.ko.instance&&this.ko.instance.BNa(this.sv)}get ko(){return null!=this.PXg?this.PXg:this.PXg=$a.a.instance.Ra(6)}WB(b){this.JK.classList.add("HeaderFooterViewElement");this.nx.classList.add("HeaderFooterViewContent");this.atd(b.currentNode)}V6(b){this.nx.parentNode&&
this.nx.parentNode===this.JK||(this.JK.appendChild(this.nx),this.iRa.instance&&this.iRa.instance.yBg(this.ic,this.JK));super.V6(b)}NNb(b){bF.a.ee(()=>{bF.a.prototype.NNb.call(this,b);this.i7j();this.iRa.instance&&this.iRa.instance.m6j(this.ic,this.nx.style.paddingLeft,this.nx.style.paddingTop)},"HFVE:UFO")}atd(b){this.ko.instance&&this.ko.instance.Qud(this.nx);this.i7j();b=this.$Ga.llc(b);this.nx.style.paddingLeft=b.Jfc+"px";this.nx.style.width=b.XWc+"px";this.iRa.instance&&this.iRa.instance.m6j(this.ic,
this.nx.style.paddingLeft,this.nx.style.paddingTop)}i7j(){if(this.ko.instance){this.nx.style.paddingTop="";var b=Jo.a.bC(this.nx);b.paddingTop&&(b=xd.a.OP(b.paddingTop),this.nx.style.paddingTop=Math.round(b/this.ko.instance.Cj)+"px")}}}Object(u.a)(xr,"HeaderFooterViewElement",Sy.a,[]);class hx{constructor(b,h,r){this.$Ga=b;this.iRa=h;this.XM=r}create(b,h,r,A){return new xr(b,h,r,A,this.$Ga,this.iRa,this.XM)}}Object(u.a)(hx,"Factory",null,[474]);var lH=d(351),zs=d(193),mH=d(960),nH=d(583);class oH extends lH.a{constructor(b,
h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he){super(h,ba,oa,Ja,jb,zs.a.IPi,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he);this.isHeader=this.isHeader=b;this.H4a=M;this.H4a.krd=this;A(this);this.Jyd=r;this.cGa=document.createElement("div");this.cGa.setAttribute("Unselectable","on");this.cGa.setAttribute("hideselection","hideselection");this.cGa.setAttribute("style","outline:none;");this.cGa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;this.cGa.tabIndex=0;this.features.UTj=!0;this.features.Enf=
!0}get FZf(){return!0}YPf(){const b=this.Jyd.mGf(this);return mH.ViewReference.jH(this,b)}eyf(b){Object(Za.a)(oH,b)||this.Jyd.dismiss()}get fTf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}I4c(){return nH.a.Nej}Vv(){super.Vv();this.H4a.Xki()}xF(b,h=null){this.cGa.parentNode&&this.cGa.parentNode.removeChild(this.cGa);super.xF(b,h);this.H4a.Jki(this.qd.qk)}detach(){this.H4a.Wki();super.detach();this.cGa.parentNode||this.container.insertBefore(this.cGa,this.container.firstChild)}vod(){this.sw?
super.vod():this.cGa.focus()}q4d(){this.Vv()}}Object(u.a)(oH,"HeaderFooterView",lH.a,[500,227,192,99,11,228,229,230,231]);class nw{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd){this.Jyd=b;this.mTk=h;this.lTk=r;this.Sy=A;this.od=M;this.Dqa=ba;this.ga=oa;this.c3a=Ja;this.zya=jb;this.E$=zb;this.QTk=Eb;this.tu=Sb;this.HC=nc;this.jg=Dc;this.pi=Zc;this.Byd=Gd}create(b,h){return new oH(b,h,this.Jyd,this.mTk,this.lTk(),this.Sy,this.od,this.Dqa,this.ga,this.c3a,this.zya,this.E$,this.QTk,this.tu,
this.HC,this.jg,this.pi,this.Byd)}}Object(u.a)(nw,"Factory",null,[473]);class nt{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he){this.Oyh=!1;this.UFh="SourceControlId";this.ump=1;this.vmp=1E3;this.Ure=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;this.oCd(Lf[this.UFh]);Lf[Jd.a.Text]=this.y3e.s$n(this.nkb.iSb);return 32};this.vmo=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;Lf[Ng.a.On]=this.nkb.iSb;return 32};this.E6m=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;this.nkb.Mzp(Lf[Ng.a.On]);return 32};this.lDj=
(fe,Yd,Td)=>{if(1===Td)return 32;if(this.yda){Yd=Object(fn.a)().Nu(Yd.view.qd);Td=zc.a.Za(Yd);const wf=this.Xd.v6a();try{const Lf=this.Qc.Lc(15);try{Lf.Ab(Yd),Lf.Ei=fe,sr.a.instance.xVa(Td,ii=>{this.d$b.Kkd(ii,this.Ppm,this.zXo);return!0})}finally{Lf&&Lf.dispose()}}finally{wf&&wf.dispose()}}return 32};this.Dhd=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;Lf.MenuItems=this.$Ik.value;this.Oyh?this.nkb.gIo():this.Oyh=!0;return 32};this.Dcn=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;const ii=this.oCd(Lf[this.UFh]);
if(this.yda){Yd=Object(fn.a)().Nu(Yd.view.qd);Td=zc.a.Za(Yd);wf=this.Qc.Lc(15);try{wf.Ab(Yd);wf.Ei=fe;let Bi=null;const Ml=this.Zd.Xf("UserAction","InsertPageNumber");sr.a.instance.xVa(Td,hk=>{this.yda.bfa||this.tvk(hk);Bi=this.x3e.Bcn(hk,ii,this.nkb.iSb)||Bi;return!0});Ml.stop();if(!Bi)return 8;this.H9o(Bi,ii)}finally{wf&&wf.dispose()}this.Xd.ev(12)}return 32};this.r$n=()=>32;this.t$o=(fe,Yd,Td,wf,Lf)=>{if(1===Td)return 32;2===Td&&this.pSa.showCallout(Lf);return 32};this.s$o=(fe,Yd,Td,wf,Lf,ii)=>
this.W8e.create(fe,Yd,Td,wf,Lf,ii);this.pWl=(fe,Yd,Td)=>{if(1===Td)return 32;this.pSa.Bgi();return 32};this.x8o=fe=>{y.AFrameworkApplication.va.Rua(null,Hc.a.tVj,fe.em,null)};this.Ppm=fe=>{const Yd=$f.a.instance.gb.currentSelection;let Td=-1;for(const wf of Yd)if(wf.node===fe){Td=wf.cpBegin;break}return{returnValue:Td,Fee:Le.a.Fm(Yd)}};this.zXo=(fe,Yd)=>{fe=sc.SelectionFactory.ve(fe,Yd);$f.a.instance.Kc(fe)};this.ga=b;this.Qc=h;this.Gb=r;this.nkb=A;this.yda=M;this.Ym=ba;this.y3e=oa;this.x3e=Ja;this.d$b=
jb;this.pSa=zb;this.ib=Eb;this.W8e=Sb;this.Zd=nc;this.Xd=Dc;this.oCd=Zc;this.tvk=he;this.$Ik=new Pf.a(()=>this.nkb.dFm())}Wb(){this.ga.fb(Hc.a.Dhd,mc.a.view,this.Dhd,100);this.ga.fb(Hc.a.grj,mc.a.view,this.r$n,68);this.ga.fb(Hc.a.YSi,mc.a.view,this.Dcn,4);this.ga.fb(Hc.a.iSb,mc.a.view,this.E6m,4);this.ga.fb(Hc.a.Kkd,mc.a.view,this.lDj,4);this.ga.fb(Hc.a.OBo,mc.a.view,this.lDj,4);this.ga.fb(Hc.a.Nog,mc.a.application,this.vmo,97);this.ga.fb(Hc.a.Ure,mc.a.application,this.Ure,97);this.ga.fb(Hc.a.sVj,
mc.a.view,this.t$o,4);this.ga.HW(Hc.a.tVj,mc.a.view,this.s$o,100);this.ga.fb(Hc.a.oWl,mc.a.view,this.pWl,4)}H9o(b,h){const r=b.Jb.paragraph;if(r){var A=this.Ym.Xdd(r);A&&this.yda.Yka(A)}A=this.yda.bfa;this.yda.show(4>h);r&&this.PWo(r)&&(this.X_o(b,r),this.U_k(b,A))}PWo(b){let h;if(!({isHeader:h,kIg:b}=this.Ym.OIi(b)).returnValue)return!1;this.yda.fEa(b,h);return!0}X_o(b,h){b=sc.SelectionFactory.ve(h,b.Jb.cp);this.ib.Kc(b)}U_k(b,h){h=new wc.a(2,1,h?this.ump:this.vmp,this.x8o);h.em=b;this.Gb.Yb(h)}}
Object(u.a)(nt,"PageNumbersActor",null,[501]);class ix{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){this.ga=b;this.Gb=h;this.nkb=r;this.y3e=A;this.x3e=M;this.d$b=ba;this.pSa=oa;this.W8e=Ja;this.Ym=jb;this.Xd=zb;this.oCd=Eb;this.vSk=Sb;this.Hja=nc}create(b,h){return new nt(this.ga,new xn.a,this.Gb,this.nkb,b,this.Ym,this.y3e,this.x3e,this.d$b,this.pSa,$f.a.instance,this.W8e,qa.StaticActiveAppFrame.za().$r,this.Xd,this.oCd,this.vSk,this.Hja,h)}}Object(u.a)(ix,"Factory",null,[472]);var aA=d(2006),
uB;(function(b){b[b.small=0]="small";b[b.s$p=1]="mediumSmall";b[b.Fs=2]="medium";b[b.VX=3]="large"})(uB||(uB={}));Object(u.b)("ModalCalloutSize",uB);var bA;(function(b){b[b.xDe=0]="topCenter";b[b.brq=1]="topJustified";b[b.crq=2]="topLeft";b[b.drq=3]="topRight";b[b.Rlf=4]="bottomCenter";b[b.fXp=5]="bottomLeft";b[b.gXp=6]="bottomRight"})(bA||(bA={}));Object(u.b)("BeakLocation",bA);class ow{constructor(b,h,r){this.tmp=1;this.d6e=!1;this.tac=null;this.hwo=()=>{this.ib.BA(this.Sua);this.d6e=!0;this.tac=
null};this.Sua=(A,M)=>{if(A=M.Tm.currentSelection)1<A.length||!A.length?A=!0:(A=A.Qa,A=A.cpEnd-A.cpBegin,A=1<A||!A),A&&this.suk()};this.Gb=b;this.ib=h;this.suk=r}gB(){this.T_k()}Vca(){this.d6e?(this.ib.hha(this.Sua),this.d6e=!1):this.tac&&(this.Gb.uf(this.tac),this.tac=null)}T_k(){this.tac=new wc.a(2,1,this.tmp,this.hwo);this.Gb.Yb(this.tac)}}Object(u.a)(ow,"CalloutDismissManager",null,[]);class Zy{constructor(b,h,r,A){this.dismiss=()=>{this.fK&&(this.MGc.Vca(),this.Kdd.dismiss())};this.Kdd=b;this.Vp=
A;this.MGc=new ow(h,r,this.dismiss)}get fK(){return this.Kdd.fK}show(){if(!this.fK){const b=document.createElement("div");b.classList.add(Zy.q$n);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.Kdd.content=b;this.Kdd.show();this.Vp&&this.Vp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.MGc.gB()}}dispose(){this.dismiss();this.Kdd.dispose()}static SIl(b,h){h=aA.a.X$h(Te.a.getElementBounds(b.targetElement),h,qa.StaticActiveAppFrame.za().nG,
uB.small);h.aka=Zy.MHf(b);h.Gu=!1;return h}static MHf(b){let h=bA.Rlf;Object(Za.a)(500,b.view)&&b.view.isHeader&&(h=bA.xDe);return h}}Zy.q$n="PageNumbersCalloutControl";Object(u.a)(Zy,"PageNumbersCallOutControl",null,[499]);class cF{constructor(b,h,r){this.rW=null;this.kW=!1;this.dismiss=()=>{this.fK&&this.rW&&hm.UISurfaces.$J().then(A=>{this.MGc.Vca();A.removeNotification(this.rW);this.kW=!1;return null},A=>{v.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",A);return null})};
this.nl=b;this.MGc=new ow(h,r,this.dismiss)}get fK(){return this.kW}show(){this.fK||hm.UISurfaces.$J().then(b=>{const h=b.callout(Object.assign(new Jr.a,{target:this.nl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),r=Object.assign(new Kj.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.kW=!0},expirationOptions:Object.assign(new Pm.a,{displayTimeoutSeconds:7,onExpire:()=>{this.dismiss()}})});this.rW=b.addNotification(h,r);this.MGc.gB();return null},b=>{v.ULS.sendTraceTag(593352340,
383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(u.a)(cF,"ReactPageNumbersCallOutControl",null,[499]);class pH{constructor(b,h,r){this.ib=h;this.Gb=b;this.Vp=r}create(b,h){if(y.AFrameworkApplication.ta.Hb&&y.AFrameworkApplication.ta.Hb.GXa)return new cF(h.targetElement,this.Gb,this.ib);b=Zy.SIl(h,b);return new Zy(b,this.Gb,this.ib,this.Vp,y.AFrameworkApplication.ta.HS)}}Object(u.a)(pH,"Factory",null,[470]);class BJ{constructor(b,h){this.uG=null;this.ZIk=b;this.Bj=h}get control(){return this.uG}showCallout(b){this.control&&
this.control.fK&&this.control.dismiss();this.uG=this.lho(b);this.control.show()}Bgi(){this.control&&(this.control.dismiss(),this.uG=null)}lho(b){const h=this.Bj.zsa();this.uG=this.ZIk.value.create(h,b);return this.control}}Object(u.a)(BJ,"PageNumbersCalloutControlManager",null,[471]);var CJ=d(765);class aD extends oB.a{constructor(){super();this.Text=null}get Type(){return 7}}Object(u.a)(aD,"PageNumberGalleryButtonProps",oB.a,[]);const vB=(b,h,r)=>{b=b.Vl();b.set(r);h.cWb(b);return b};class Rm{constructor(b,
h,r){this.QVe=!1;this.Hja=h;this.Zm=r}get iSb(){return this.QVe}dFm(){const b=Object.assign(new Xe.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.tYk());b.MenuSectionList.push(this.mZk());b.MenuSectionList.push(this.QZk());return b}Mzp(b){this.QVe=b;this.xAj()}gIo(){this.QVe=!1;const b={};b[Rm.MQi]="CheckboxModel";this.Hja(b);this.xAj()}tYk(){const b=Object.assign(new xh.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:C.a.If(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),
ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new CJ.a,{Id:Rm.F6m,Command:Hc.a.iSb.toString(),QueryCommand:Hc.a.Nog.toString(),LabelText:C.a.If(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:C.a.If(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}mZk(){const b=Object.assign(new xh.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),h=Object.assign(new Bn.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Zm){for(var r=3;1<=r;r--)h.GalleryItems.push(this.qKf(r));for(r=6;4<=r;r--)h.GalleryItems.push(this.qKf(r))}else for(r=1;6>=r;r++)h.GalleryItems.push(this.qKf(r));b.ControlList.push(h);return b}QZk(){const b=Object.assign(new xh.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",
DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new Pj.a,{Id:"btnRemovePageNumber",Command:Hc.a.Kkd.toString(),LabelText:C.a.If(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:C.a.If(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:y.AFrameworkApplication.Vs,Image16by16Class:ag.getImageClass("WordRemovePageNumbers_16x16x32"),KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}qKf(b){const h=Rm.gjg+b.toString();var r=Object,A=r.assign,
M=new aD,ba=Hc.a.YSi.toString(),oa=Hc.a.Ure.toString(),Ja=C.a,jb=Ja.If;let zb="";switch(b){case 1:zb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:zb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:zb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:zb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;break;case 5:zb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:zb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return A.call(r,
M,{Id:h,Command:ba,QueryCommand:oa,Alt:jb.call(Ja,zb)})}xAj(){const b={};for(let h=1;6>=h;h++)b[Rm.gjg+h.toString()]="PageNumberGalleryButtonModel";b[Rm.MQi]="CheckboxModel";this.Hja(b)}static eFm(b){return b?parseInt(b.substr(Rm.gjg.length)):1}}Rm.F6m="btnIncludePageCount";Rm.MQi="IncludePageCount";Rm.gjg="btnPageNumbersPosition";Object(u.a)(Rm,"PageNumbersControl",null,[468]);class pw{constructor(b,h,r,A,M=null,ba=null,oa=null,Ja=null){this.Rvm=(jb,zb)=>{const Eb=new dc.a;jb=4>jb;switch(zb){case 1:case 2:Eb.add(jb?
0:3);break;case 3:case 4:Eb.add(jb?0:3),Eb.add(jb?1:4)}return Eb};this.tom=(jb,zb,Eb)=>{var Sb=vB(this.$c,this.Ym,jb);this.Ym.dWb(Sb,Eb);let nc=this.Hsk(Sb,zb);if(nc)this.d$b.PDj(nc);else{Sb=vB(this.$c,this.Ym,jb);this.Ym.dWb(Sb,Eb);Sb.$d();if(Ua.a.Qh(Sb)&&(Ab.OutlineElementNavigator.Me(Sb),Ed.ParagraphReader.Eh(Sb))){Sb=Sb.currentNode;const Dc=this.TIi(zb);Ed.ParagraphReader.Zy(Sb)===Dc&&this.d$b.PDj(Sb)&&(nc=Sb)}nc||(Sb=vB(this.$c,this.Ym,jb),this.Ym.dWb(Sb,Eb),this.VN.ASb(Sb,null,!0),nc=Ab.OutlineElementNavigator.Me(Sb),
this.HH(zb,nc))}return nc};this.uom=(jb,zb)=>{let Eb=null;jb.Ub(1);if(Ua.a.Qh(jb)&&(jb.Ub(2),Hi.TableReader.isTable(jb))){var Sb=jb.currentNode;if(3===Hi.TableReader.Dh(Sb)){let nc=0;Sb=Hi.TableReader.zo(Sb);switch(zb){case 1:case 4:nc=Sb?2:0;break;case 2:case 5:nc=1;break;case 3:case 6:nc=Sb?0:2}bi.moveToCellContent(jb,0,nc);jb.currentNode&&Ua.a.Qh(jb)&&(jb=Ab.OutlineElementNavigator.Me(jb),Ed.ParagraphReader.Vb(jb)&&(Eb=jb))}}return Eb};this.ymn=(jb,zb)=>{const Eb=vB(this.$c,this.Ym,jb);jb=Eb.currentNode.ka(Rc.a.yna,
0);this.Ym.dWb(Eb,zb);zb=Eb.currentNode.ka(Rc.a.yna,0);return jb===zb};this.$c=b;this.aJk=h;this.d$b=r;this.Ym=A;this.KIc=M||this.Rvm;this.Isk=ba||this.tom;this.Hsk=oa||this.uom;this.$Bk=Ja||this.ymn}get VN(){return null!=this.S1g?this.S1g:this.S1g=$a.a.instance.resolve(110)}Bcn(b,h,r){var A=vB(this.$c,this.Ym,b).so;A=this.Ym.Dla(A);A=this.KIc(h,A);let M=null;for(let oa=0;oa<A.length;oa++){var ba=A.tg(oa);this.$Bk(b,ba)&&(ba=this.Isk(b,h,ba),M=this.aJk.lZk(ba,r)||M)}return M}HH(b,h){pw.Mha.zod(4>
b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);pw.sl.HH(h,this.TIi(b))}TIi(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get sl(){return null!=pw.P2g?pw.P2g:pw.P2g=$a.a.instance.resolve(349)}static get Mha(){return null!=pw.y4g?pw.y4g:pw.y4g=$a.a.instance.resolve(393)}}Object(u.a)(pw,"PageNumbersInserter",null,[469]);var wB=d(888),DJ=d(892);class $y{constructor(b,h,r=null,A=null,M=null){this.GEl=(ba,oa)=>
{ba=vc.a.Tc(ba,Ed.ParagraphReader.textLength(ba));const Ja=ba.node.Ic;return Ja?$y.Bg.Tla(ba,jb=>{jb=DJ.a.getInstance(jb,wB.a.MJf(oa));this.rYd(jb,15,Ja,oa);this.rYd(jb,47,Ja,oa);this.rYd(jb,16,Ja);this.rYd(jb,17,Ja);return jb}):null};this.idn=(ba,oa)=>{ba=vc.a.Tc(ba,Ed.ParagraphReader.textLength(ba));$y.Bg.Ue(ba,oa)};this.Qc=b;this.UId=r||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.yOe=A||this.GEl;this.LHh=M||this.idn}lZk(b,h){const r=this.Qc.Lc(15);r.Ab(b);var A=
Ed.ParagraphReader.text(b),M=!1;0<A.length&&" "!==A.charAt(A.length-1)&&(M=!0);if(h){h=String.format(this.UId,"#","$");M&&(h=" "+h);M=h.indexOf("#");A=h.indexOf("$");v.ULS.shipAssertTag(4256717,309,-1!==M,"{0}",{["PageNumberIndex"]:M});v.ULS.shipAssertTag(4256718,309,-1!==A,"{0}",{["PageCountIndex"]:A});v.ULS.shipAssertTag(4256719,309,M!==A,"{0}",{["PageNumberIndex"]:M,["PageCountIndex"]:A});let Ja;let jb;if(M<A){var ba=M;Ja=A;var oa=wB.a.f3c(0);jb=wB.a.f3c(1)}else ba=A,Ja=M,oa=wB.a.f3c(1),jb=wB.a.f3c(0);
this.tWf(b,h,0,ba);oa=this.yOe(b,oa);this.tWf(b,h,ba+1,Ja);ba=this.yOe(b,jb);this.tWf(b,h,Ja+1,h.length);b=M<A?oa:ba}else M&&this.LHh(b," "),b=this.yOe(b,wB.a.f3c(0));r.dispose();return b}rYd(b,h,r,A=null){const M=new Qp.a;M.setValue(ze.a.Qca,!0);M.setValue(Rc.a.NOb,1);M.setValue(Rc.a.ht,h);switch(h){case 15:M.setValue(Rc.a.KXa,!0);M.setValue(Rc.a.S2,A);break;case 47:M.setValue(Rc.a.S2,A);break;case 17:M.setValue(Rc.a.aUb,!0)}h=r.nu(M,P.a.create());this.j_k(b,h)}j_k(b,h){b.Tya(h,P.a.nil,Pn.AParagraphNode.YB,
null)}tWf(b,h,r,A){h=h.substring(r,A);0<h.length&&this.LHh(b,h)}static get Bg(){return $y.Qd||($y.Qd=$a.a.instance.resolve(323))}static set Bg(b){$y.Qd=b}}$y.Qd=null;Object(u.a)($y,"PageNumbersNodeLevelInserter",null,[467]);class xB{s$n(b){return xB.GHm(b)}static GHm(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,xB.Wqj,xB.Wqj)}}xB.Wqj="1";Object(u.a)(xB,"PageNumbersPositionPreviewGenerator",
null,[466]);class EJ{constructor(){this.jch=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");this.dsk=this.jch.length}h0m(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===Ed.ParagraphReader.textLength(b)?{returnValue:!0,Ghd:h}:{returnValue:!1,Ghd:-1}}KZm(b){let h=b.characterData.lastIndexOf(this.jch);return-1!==h&&h+this.dsk===Ed.ParagraphReader.textLength(b)?{returnValue:!0,Ghd:h}:{returnValue:!1,Ghd:-1}}F_m(b){return bm.a(b,
9)?!0:!1}}Object(u.a)(EJ,"PageNumbersReader",null,[465]);class FJ{constructor(b,h,r,A,M,ba=null,oa=null){this.NBo=(Ja,jb,zb,Eb)=>{Ja=vB(this.$c,this.Ym,Ja);this.Ym.dWb(Ja,jb);jb=Uv.a.rq(Ja);for(Ja=!1;jb.moveNext();){const Sb=jb.currentNode;if(Ed.ParagraphReader.Vb(jb.currentNode)&&bm.a(jb.currentNode,9)){Ja=!0;let nc;const Dc=({Fee:nc}=zb(Sb,nc)).returnValue;let Zc=Dc;Zc=this.oAo(Sb,Zc);Zc=this.lCo(Sb,Zc);-1<Dc&&(Zc===Dc&&nc||Eb(Sb,Zc))}}Ja&&this.Xd.ev(12)};this.$c=b;this.Ym=h;this.z3e=r;this.Xd=
A;this.POc=M;this.KIc=ba||ey.a.pxf;this.qLk=oa||this.NBo;this.UId=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.Yih=String.format(this.UId,"#","$");this.nAk=this.Yih.indexOf("#");this.mAk=this.Yih.indexOf("$");this.ZSe=String.format(this.UId,"\ufffc","\ufffc");this.Rih=this.ZSe.length}Kkd(b,h,r){var A=vB(this.$c,this.Ym,b).so;A=this.Ym.Dla(A);A=this.KIc(A);for(const M of A)this.qLk(b,M,h,r)}PDj(b){if(this.z3e.F_m(b)){let h=-1;if(({Ghd:h}=this.z3e.KZm(b)).returnValue&&
this.p1h(b,h)||({Ghd:h}=this.z3e.h0m(b)).returnValue&&this.tpl(b,h))return!0}return!1}lCo(b,h){var r=b.ra.length;for(let M=0;M<r;M++){var A=b.ra.K(M);A.blob&&9===A.blob.$h&&(A=A.cp,r=vc.a.createTextRange(b,A,A+1),this.POc(r,""),r=b.ra.length,M--,h=this.TQh(h,A,1))}return h}oAo(b,h){let r=b.characterData.indexOf(this.ZSe);for(;-1!==r;)this.p1h(b,r)&&(h=this.TQh(h,r,this.Rih)),r=b.characterData.indexOf(this.ZSe);return h}tpl(b,h){const r=b.ra.Ch(h);return r&&r.blob&&9===r.blob.$h?(b=vc.a.createTextRange(b,
h,h+1),this.POc(b,""),!0):!1}p1h(b,h){const r=b.ra.Ch(h+this.nAk),A=b.ra.Ch(h+this.mAk);return r&&r.blob&&9===r.blob.$h&&A&&A.blob&&9===A.blob.$h?(b=vc.a.createTextRange(b,h,h+this.Rih),this.POc(b,""),!0):!1}TQh(b,h,r){-1<b&&b>h&&(h=b-h,b=h>r?b-r:b-h);return b}}Object(u.a)(FJ,"PageNumbersRemover",null,[464]);class GJ{constructor(b,h){this.JBb=this.IBb=null;this.Ls=b;this.Gb=h}s6k(){this.Ls.style.display="";this.IBb||(this.JBb&&(this.Gb.uf(this.JBb),this.JBb=null),this.IBb=new wc.a(0,1,10,()=>{this.Ls.classList.add("Displayed");
this.IBb=null}),this.Gb.Yb(this.IBb))}u6k(){this.Ls.classList.remove("Displayed");this.JBb||(this.IBb&&(this.Gb.uf(this.IBb),this.IBb=null),this.JBb=new wc.a(0,1,200,()=>{this.Ls.style.display="none";this.JBb=null}),this.Gb.Yb(this.JBb))}}Object(u.a)(GJ,"PaneControlAnimationHelper",null,[497]);class HJ{constructor(b){this.Gb=b}jFm(b){return new GJ(b,this.Gb)}}Object(u.a)(HJ,"PaneControlAnimationHelperFactory",null,[463]);class IJ{constructor(b,h,r,A,M,ba,oa,Ja,jb=!1){this.j8g=this.Bqa=this.LCd=null;
this.O0m=()=>{this.Gw.sendNotification(this.j8g+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=b;this.K9=h;this.K9.bind(this);this.lXe=r;this.$xa=M;this.Yaf=oa;this.Zb=Ja;this.eEd=jb;this.Oia=ba.value.create(r,A);this.K9.Ydl(this.Oia);this.G1=kc.KeyInputManager.lc(rf.a.T4,0)}get Gw(){return null!=this.CTg?this.CTg:this.CTg=$a.a.instance.resolve(25)}p4(b){this.K9.p4(b);this.Bqa&&!b&&this.Bqa.mWl()}Yka(b){this.LCd!==b&&(this.Rob(),this.LCd=b)}QMj(b){if(this.LCd){var h=
this.$xa.$Pb(this.LCd,ey.a.Qvm(b,this.lXe));this.eEd?(this.j8g=this.Msi(b,this.lXe),this.Oia.S_b(Pe.a.VSd)):this.owp(b);h&&this.Sjf(h)}}bVh(b){this.eEd&&this.Zb&&(b=this.Zb.ie(b))&&b.T$(this.O0m)}Msi(b,h){let r="";switch(b){case 1:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;
break;case 2:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:
h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;break;case 4:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return r}owp(b){this.Oia.dOj(this.Msi(b,
this.lXe),Pe.a.VSd)}pxc(){this.Oia.vod()}Sjf(b){this.Rob();this.Oia.xF(b,b.qk)}Rob(){this.Oia.detach()}kMl(){this.Bqa=this.Yaf.value.create(this.K9.mAc);this.Z2o(this.Bqa)}Z2o(b){if(this.Zb){const h=this.Zb.ie(cu.a.v$a);h.parent=pd.AFrame.Kq;h.Pja(()=>{b.setFocus();this.h1o()});h.bindAction(this.G1,Hc.a.dX)}}h1o(){if(this.Zb){var b=this.Zb.ie(cu.a.v$a);const h=new He.DOMFocusListing(()=>this.K9.mAc);h.cha=!0;h.un(1);this.Zb.inb(this.K9.mAc,b,h);b=this.Zb.getRegion(cu.a.v$a);b.WZa();b.BP=!0;h.dla&&
h.oA(h.dla)}}dispose(){void 0!==this.Bqa&&null!==this.Bqa&&(this.Zb.ie(cu.a.v$a).qt(this.G1),this.Bqa.dispose())}Cuo(){void 0!==this.Bqa&&null!==this.Bqa&&this.Bqa.refresh()}}Object(u.a)(IJ,"PaneControl",null,[452]);class qH{constructor(b,h,r,A){this.Ym=b;this.bzk=h;this.Yaf=r;this.Zb=A}create(b,h,r,A){return new IJ(b,h,r,A,this.Ym,this.bzk,this.Yaf,this.Zb,y.AFrameworkApplication.J.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(u.a)(qH,"Factory",null,[425]);var dF=d(1097);class Jt extends xj.a{constructor(b,
h,r,A,M,ba,oa,Ja,jb){super();this.init(b);this.sm("ShowCalloutForPageNumberOperation");this.hnk=Ja;this.Asb(this.hnk,h,A,M,ba);this.uA=0;this.oSa=ba;this.pSa=oa;this.ii=jb;1===this.behavior&&(this.us=32,this.zva())}get x1l(){if(null!=this.CVg)var b=this.CVg;else{var h;b=this.CVg=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.EndOperationOnFailureIsEnabled",!1)}return b}run(){var b=this.ii.kb.Fw;if(!this.uA){var h=VG.a.pkc(this.oSa,b);this.oSa.g6c(h)?
this.oSa.aBa(b,h).element&&(this.uA=1):this.x1l&&(this.uA=2)}1===this.uA&&(h=VG.a.pkc(this.oSa,b),h=this.oSa.aBa(b,h),b=new dF.a(h.element,b),this.pSa.showCallout(b),this.uA=2);2===this.uA&&(this.us=32,this.zva())}}Object(u.a)(Jt,"ShowCalloutForPageNumberOperation",xj.a,[]);class JJ{constructor(b,h,r){this.pSa=b;this.ga=h;this.j4b=r}create(b,h,r,A,M,ba){return new Jt(b,h,r,A,M,ba,this.pSa,this.ga,this.j4b)}}Object(u.a)(JJ,"Factory",null,[423]);class yr{get VN(){return null!=this.Q1g?this.Q1g:this.Q1g=
$a.a.instance.resolve(110)}uc(b){b.ia(985,()=>new Rs(b.resolve(755),b.resolve(959),b.resolve(960),b.rf(961),b.resolve(462),b.resolve(962),b.resolve(23))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new nw(b.resolve(960),YC.a.krf,()=>b.resolve(729),qa.StaticActiveAppFrame.za().kb,Object(Jb.a)(),()=>b.resolve(50),y.AFrameworkApplication.va,b.resolve(159),b.Ra(18),b.resolve(21),b.Ra(6),b.Oa(289),b.Oa(17),b.Oa(11),b.Oa(13),b.Oa(12))).as(963).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",
()=>new hx(b.resolve(730),b.Ra(194),b.resolve(319))).as(462).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new AJ($l.a.Pm,b.Ra(710),b.resolve(23),$l.a.Pm,y.AFrameworkApplication.va)).as(964).ha();b.ia("WordEditor.HeaderFooter.PaneControl.Factory",()=>new qH(b.resolve(468),b.rf(963),b.rf(964),rd.FocusManager.instance())).as(971).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new xp(()=>{qa.StaticActiveAppFrame.za().Fe()},b.resolve(468),b.resolve(965),y.AFrameworkApplication.va,
b.resolve(230))).as(972).ha();b.ia("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new ix(y.AFrameworkApplication.va,me.a.instance,b.resolve(966),b.resolve(967),b.resolve(968),b.resolve(969),b.resolve(962),b.resolve(970),b.resolve(468),b.resolve(46).instance,Rm.eFm,Object(F.a)(qa.StaticActiveAppFrame.za(),qa.StaticActiveAppFrame.za().rtd,"updateRibbonControl"),Object(F.a)(qa.StaticActiveAppFrame.za(),qa.StaticActiveAppFrame.za().lJ,"updateRibbonControls"))).as(961).ha();b.ia(960,()=>new gx).ha();
b.ia(973,()=>new HJ(me.a.instance)).ha();b.ia(755,()=>new hH(rd.FocusManager.instance(),qa.StaticActiveAppFrame.za().Jy,b.rf(971),b.rf(972),b.rf(973),y.AFrameworkApplication.va,new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc),y.AFrameworkApplication.J,b.resolve(258),b.resolve(211))).as(983).ha();b.ia(974,()=>new $C(b.resolve(468),cm.PageReader.instance,new zk.a,sr.a.instance)).ha();b.ia(975,()=>new kH(new zk.a,sr.a.instance));b.ia(959,()=>new Xz(y.AFrameworkApplication.va,b.resolve(468),b.resolve(974),
b.resolve(965),sr.a.instance,new zk.a,new xn.a,b.resolve(975),Xz.wKi,b.resolve(976))).ha();b.ia(977,()=>new er(Wz.a.instance,er.tOm(b.resolve(32)),er.Ulm(),y.AFrameworkApplication.isRtl,Ab.OutlineElementNavigator.ke,er.oMm(),er.Dvm(),b.resolve(16)));b.ia(978,()=>new Qr.a(b.resolve(468),new zk.a,h=>this.VN.ASb(h,null,Qr.a.oCg),y.AFrameworkApplication.isRtl,Object(F.a)(b.resolve(16),b.resolve(16).k0b,"setRtlSimple"),b.resolve(977),b.resolve(393)));b.ia(979,()=>new yJ(sr.a.instance,b.resolve(468),b.resolve(662),
b.resolve(978))).ha();b.ia(976,()=>new gH(b.resolve(468),new zk.a,new xn.a,b.resolve(974),y.AFrameworkApplication.va)).ha();b.ia(965,()=>new fy(b.resolve(979),b.resolve(468),sr.a.instance,new zk.a,y.AFrameworkApplication.va)).ha();b.ia(966,()=>new Rm(Object(F.a)(qa.StaticActiveAppFrame.za(),qa.StaticActiveAppFrame.za().rtd,"updateRibbonControl"),Object(F.a)(qa.StaticActiveAppFrame.za(),qa.StaticActiveAppFrame.za().lJ,"updateRibbonControls"),y.AFrameworkApplication.isRtl)).ha();b.register(xB,967).ha();
b.ia(980,()=>new $y(new xn.a,b.resolve(23))).ha();b.ia(968,()=>new pw(new zk.a,b.resolve(980),b.resolve(969),b.resolve(468))).ha();b.ia(981,()=>new EJ).ha();b.ia(969,()=>new FJ(new zk.a,b.resolve(468),b.resolve(981),b.resolve(46).instance,Object(F.a)(yr.Bg,yr.Bg.Ue,"replaceTextRange"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new BJ(b.rf(982),qa.StaticActiveAppFrame.za())).as(962).ha();b.ia("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new pH(me.a.instance,
$f.a.instance,b.resolve(25))).as(982).ha();b.ia("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new JJ(b.resolve(962),y.AFrameworkApplication.va,qa.StaticActiveAppFrame.za())).as(970).ha();b.ia("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new qB(b.resolve(468),y.AFrameworkApplication.va)).as(984).ha();b.ia("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new It(b.resolve(983),b.resolve(984))).as(558).ha()}static get Bg(){return null!=
yr.cUg?yr.cUg:yr.cUg=$a.a.instance.resolve(323)}}Object(u.a)(yr,"HeaderFooterComponentConfiguration",null,[1]);class eF{constructor(){this.NCd=this.Z=null}get name(){return"WordEditor.HeaderFooter"}uc(b){this.Z=b;(new yr).uc(b)}init(){this.Z.resolve(23).Qr.continueWith(()=>{this.No()})}No(){this.Z.resolve(23).isFeatureEnabled(102)&&(this.NCd=this.Z.resolve(985),this.NCd.start(),this.Z.resolve(558))}dispose(){this.NCd&&this.NCd.dispose()}static main(){E.a.instance.Mc(new eF)}}Object(u.a)(eF,"PackageManager",
null,[0,1]);var yq=d(330),Qq=d(506);class rH{constructor(b,h){this.jg=b;this.Xm=h}create(){return new Qq.a(this.jg.instance,this.Xm.instance)}}Object(u.a)(rH,"ContentControlNodeFactory",null,[433]);var az=d(1702),cA=d(393),KJ=d(1050);class dA{create(){return new KJ.a}}Object(u.a)(dA,"ContentControlContainerNodeFactory",null,[433]);var As=d(201),sH=d(402),LJ=d(304),jx=d(218),bD=d(224),tH=d(1090);const cD=b=>b?(b=b.ka(Rc.a.xUa,null))&&b.includes(As.a.Gdi):!1;class uH{constructor(b,h,r,A,M,ba,oa){this.Ssa=
b;this.Of=h;this.Bg=r;this.uka=A;this.OD=M;this.xj=ba;this.hBl=oa;this.BXn=(Ja,jb)=>{os.a.kga&&(Ja=jb.node,jb=zc.a.Za(Ja),jb.vb(7)&&(jb=jb.fd(54)))&&(jb=jb.getValue(Rc.a.Wd),Ja=Ja.id,1==(null===jb||void 0===jb?void 0:jb.length)&&Ja.equals(jb[0])&&(Ja=this.Ssa.Swi(),this.Gei(Ja)))};this.Ueg=(Ja,jb)=>{if(os.a.kga)for(const zb of jb.Ici)cD(zb.Wd)||(Ja=zb.Wd.ka(Rc.a.xUa,null),this.Gei(Ja))}}get yYf(){return y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.uka.YAj(this.Ueg);
this.hBl.KT(this.BXn)}Gei(b){const h=this.Ssa.nQb();h&&b&&this.Ssa.lRb(h,b)&&(b=new Qb.GraphTransaction(7),b.pu(h),h.Tg(),b.dispose())}NXc(){const b=new tH.a;b.setValue(Rc.a.dUm,!0);var h=(h=hb.a.create())?h.toString().replace(RegExp("-","g"),"").toUpperCase():null;b.setValue(Rc.a.Hlc,h);b.setValue(Rc.a.aBl,this.yYf);h=hb.a.create();b.setValue(Rc.a.cLi,h);return b}qil(b){const h=b.currentNode.getValue(Rc.a.cLi);b.Wf(new sH.a,1);b.O_();b.currentNode.setValue(Rc.a.xhi,h);b.Wf(this.Of.tob(),1);b.O_();
return this.Of.qL(b)}B0o(b){var h=this.Ssa.$Kf();h.vb(7);if(h.rc()&&h.nWa(0,A=>8==A.type)){h=h.currentNode;const A=(new lu.WACStyleSet).$aa(h);if(A){var r=A.mh(As.a.blg);if(!r&&(r=this.AZk(h),v.ULS.sendTraceTag(508952736,368,50,`Placeholder text style is not in document. Adding new style succeeded: ${!!r}`),!r))return;b=vc.a.createTextRange(b,0,Ed.ParagraphReader.textLength(b));this.OD.LW(b,M=>{this.xj.lra(M);this.xj.Aeb(M,r)})}}}dJl(b){var h=this.Ssa.$Kf();const r=this.NXc();h.Wf(r,29);h.O_();h=
this.qil(h);this.Bg.Ue(vc.a.Tc(h,0),b,!1,!1);this.B0o(h);return r}yul(b){const h=this.Ssa.nQb();this.Ssa.lRb(h,b);b=this.NXc();const r=this.Ssa.$Kf();r.Wf(b,29);r.Yj(b);Eo.a(h.currentNode,r.currentNode,!1);return b}vBp(b,h){const {upe:r,$Ni:A}=this.Ssa.Xtm(b);if(r){var M=vc.a.createTextRange(r,0,Ed.ParagraphReader.textLength(r));this.Bg.Ue(M,h,!1,!1);A&&this.bSl(b);this.dAp(b)}}bSl(b){const h=this.Ssa.nQb();if(h&&b&&this.Ssa.lRb(h,b))for(h.$d(),b=h.Gq(),--b;0<b;b--)h.eC(b),h.Tg()}dAp(b){const h=this.Ssa.nQb();
this.Ssa.lRb(h,b)&&h.currentNode.setValue(ze.a.SU,new Date)}AZk(b){var h;const r=null===(h=zi.a.Jg)||void 0===h?void 0:h.xn;h=r?new LJ.a(new jx.a):new bD.a(new jx.a);h.setValue(Yf.a.la,"Placeholder Text");h.setValue(Yf.a.na,1);h.setValue(Rc.a.ma,"PlaceholderText");h.setValue(le.a.oa,99);h.setValue(Rc.a.pa,"Default Paragraph Font");h.setValue(Rc.a.lo,!0);h.setValue(ze.a.fontColor,8421504);return zi.a.BSc([h],b)?(r&&(b=zi.a.Xb.xo(),h=zi.a.Xb.Be(h),h=b.mh(h)),h):null}}Object(u.a)(uH,"GlossaryEditor",
null,[526]);class MJ{constructor(b,h,r,A,M){this.uka=b;this.f7h=h;this.uMb=r;this.hM=A;this.Oj=M;this.ZAl=new dA;this.geg=(ba,oa)=>{this.hM.ee(()=>{if(oa){oa.Rm.selectedContentControls||(oa.Rm.selectedContentControls={});var Ja=oa.Rm.selectedContentControls,jb=oa.VNa;if(jb&&jb.length){var zb=jb[0];jb=jb[jb.length-1];zb=this.uka.AIf(vc.a.Tc(zb.node,zb.Jj),vc.a.Tc(jb.node,jb.Wo),!1);for(const Eb of zb)Eb.Wd.ka(Rc.a.UL,!1)||(Ja[Eb.Wd.id.toString()]=!0)}}},"CC:OnBeforeCopy")};this.Bfd=(ba,oa)=>{this.hM.ee(()=>
{if(oa){var Ja=oa.clone,jb=oa.original;try{const zb=oa.Rm.selectedContentControls,Eb=this.uka.HHf(jb,0,jb.characterData.length,!0,!0,!1);for(const Sb of Eb){const nc=Sb.se.toString();zb[nc]?Sb.sq&&!this.oDl(Sb.Wd,Ja,zb)&&(v.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",nc)),this.hsg(Ja,Sb.se)):this.hsg(Ja,Sb.se)}}catch(zb){v.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",zb.toString()),this.f7h.Mzo(Ja)}}},
"CC:onParagraphCopy")};this.Ggg=(ba,oa)=>{this.hM.ee(()=>{if(oa){var Ja=oa.clone,jb=oa.original;try{const zb=this.uka.HHf(Ja,0,jb.characterData.length);oa.Rm.ccObjectIdMapping||(oa.Rm.ccObjectIdMapping={});const Eb=oa.Rm.ccObjectIdMapping;for(let Sb=0;Sb<zb.count;Sb++){const nc=zb.K(Sb),Dc=nc.se.toString();if(this.Yrn(nc))if(nc.Uc){const Zc=jb.Lj().ud.Eb(Dc),Gd=this.AGm(nc),de=this.pul(Zc,Gd.asj,Gd.uSi,Ja.Lj().ud);Eb[Dc]=de.id;this.uMb.h7j(Eb[Dc],Ja.id,null);this.Oj.yrc(de)}else this.uMb.h7j(Eb[Dc],
null,Ja.id);Eb[Dc]?(nc.se=Eb[Dc],nc.lv=null):this.hsg(Ja,nc.se)}}catch(zb){v.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",zb.toString())}}},"CC:onParagraphPaste")}}init(){$w.a.oPh(this.geg);$w.a.IRd(this.Bfd);$w.a.JRd(this.Ggg)}Rmm(b){if(!b.vb(25)||!b.fd(25))return null;if(!b.pv(25)){const h=this.ZAl.create(rn.a.zra);b.Wf(h,25)}return b.Ub(25)}oDl(b,h,r){var A=b.ka(Rc.a.qaa,null);const M=zc.a.Za(h);h=h.Lj().ud;r=A&&r[A.toString()]?h.Eb(A):this.Rmm(M);if(!r)return v.ULS.sendTraceTag(521172765,
368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;A=Eo.b(b,h,!0);zc.a.Za(r).o6(A,26,b.id);54!==r.type&&A.setValue(Rc.a.qaa,r.id);cA.a.zWf(null,A);return A}hsg(b,h){this.f7h.pRl(new qb.a([b]),h)}Yrn(b){var h=b.Jb.paragraph.Ic;if(!h)return v.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.se.toString())),!1;h=h.Eb(b.lv);if(!h)return v.ULS.sendTraceTag(520152149,
368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.se.toString())),!1;b=h.getValue(Rc.a.ht);return 38===b||39==b}rlm(b,h){var r,A=b.ra.K(b.ra.length-1);let M=b.characterData.length;A=(null===(r=null===A||void 0===A?void 0:A.Ib)||void 0===r?void 0:r.length)||0;b.id.equals(h.Jb.paragraph.id)&&(M=h.Jb.cp,A=h.Jb.Ib.IL(h.se,h.Uc));return this.uka.IHf(b,0,M,0,A)}AGm(b){let h=null,r=b.Jb.paragraph;const A={};for(;r;){const M=this.rlm(r,b);for(let ba=M.count-1;0<=ba;ba--){const oa=
M.K(ba);if(!oa.sq)continue;const Ja=oa.se.toString();if(oa.Uc){if(!A[Ja])return{asj:oa.Wd,uSi:h}}else A[Ja]=!0,h||(h=oa.Wd)}r=Ed.ParagraphReader.mg(r,!0,!0)}return{asj:null,uSi:h}}pul(b,h,r,A){let M;h?M=this.uMb.PAa(h):(M=this.uMb.QAa(),h=M.currentNode);A=Eo.b(b,A,!0);A.Zg(Rc.a.Mw,Lg.a.gG());54!==h.type&&A.setValue(Rc.a.qaa,h.id);M.eK(A,r,26);os.a.kga&&!cD(b)&&this.uMb.vul(b,A);return A}}Object(u.a)(MJ,"ContentControlCCP",null,[]);var vH=d(720);class wH{constructor(b,h,r,A){this.Qd=b;this.jg=h;this.hb=
r;this.th=A}get F7(){return!!this.jg.instance&&this.jg.instance.F7}get aTb(){return!!this.jg.instance&&this.jg.instance.aTb}Pya(b,h,r,A,M,ba=As.a.yNb,oa=As.a.Ggc,Ja=null,jb=As.a.fwf,zb=-1){(b=this.Nkc(b,r))?(b.Ib||(b.Ib=new yq.a(b)),this.FWk(h,b.Ib,A,M,ba,oa,Ja,jb,zb)):v.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}oei(b,h,r){if(b){new qb.a;for(let M=0;M<b.count;M++){var A=this.xIf(b.K(M),h,!1);for(const ba of A)this.pAo(ba,r)}}}oRl(b,h){this.oei(b,
h,!0)}pRl(b,h){this.oei(b,h,!1)}Ue(b,h,r,A){this.Qd.Ue(b,h,r===ub.a.ypd||os.a.Xec&&8===A)}Nkc(b,h){var r=vc.a.Tc(b,h);this.Qd.Ueb(r);for(r=0;r<b.ra.length;r++){const A=b.ra.K(r);if(A.cp>h)break;if(A.cp===h)return A}return null}FWk(b,h,r,A,M=As.a.yNb,ba=As.a.Ggc,oa=null,Ja=As.a.fwf,jb=-1){const zb=h.Jb.paragraph;b=new vH.a(h.Jb,!0,!0,!0,null,b,A,r,M,ba,oa,Ja,null,this.th);if(!this.F7||-1>=jb||jb>h.length)jb=h.length;h.insert(b,jb);zb.Ql();b.te?zb.qe.DX(b.te-1,512):zb.qe.cta(b.te,512);zb.qe.Mq.W(b.te,
Xu.CharacterPropertiesEditor.ON);zb.qe.Ot.W(b.te,Xu.CharacterPropertiesEditor.lS)}xIf(b,h,r){const A=new qb.a;for(let M=0;M<b.ra.length;M++){const ba=b.ra.K(M);if(ba.Ib)for(let oa=0;oa<ba.Ib.length;oa++)if(ba.Ib.K(oa).se.equals(h)&&(A.add(ba.Ib.K(oa)),r))return A}return A}Xsd(b,h,r){if(this.aTb&&b){var A=b.node,M=b.Jj,ba=b.Wo,oa=this.Wvi(A,M,h,!0);h=this.Wvi(A,ba,h,!1);r?-1!==oa&&oa++:-1!==h&&h++;M||-1===oa||(oa=Math.max(oa,this.hb.uy(A)));ba===this.hb.textLength(A)&&-1!==h&&(h=Math.min(h,this.hb.Dx(A)));
b.Fb=oa;b.Tb=h}}Wvi(b,h,r,A){return(b=(b=b.ra.Ch(h))?b.Ib:null)&&b.length?b.IL(r,A):-1}pAo(b,h){b&&b.Jb.Ib&&(h?b.Jb.Ib.remove(b):b.Jb.Ib.ava(b),h=b.Jb.paragraph,0<=b.te&&b.te<h.qe.length&&(b.Jb.cp||1!==h.qe.length||(h.qe.DX(0,512),h.qe.Mq.W(1,Xu.CharacterPropertiesEditor.ON),h.qe.Ot.W(1,Xu.CharacterPropertiesEditor.lS)),h.qe.removeAt(b.te,512)),h.Ql())}Mzo(b){const h=b.ra;if(h){var r=new qb.a;for(let A=0;A<h.length;A++){const M=h.K(A);if(M&&M.Ib){for(let ba=0;ba<M.Ib.length;ba++)r.add(M.Ib.K(ba).te);
M.Ib=null}}b.qna(r)}}Cup(b,h,r){if(!(0>h||0>r))for(this.Qd.Ueb(vc.a.Tc(b,h)),this.Qd.Ueb(vc.a.Tc(b,r)),h=b.ra.a3(h),r=b.ra.a3(r),--r;r>h;r--){const A=b.ra.K(r);A.UYf?b.ra.removeAt(r):A.formatting=null}}}Object(u.a)(wH,"ContentControlChpManager",null,[536]);class xH{constructor(b,h,r,A,M){this.hb=b;this.Ip=h;this.pi=r;this.Cd=A;this.th=M}xHf(b){if(!b||!Le.a.qf(b))return null;if(!b.cpBegin){const h=this.Zti(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.hb.textLength(b.node)?this.Zti(b.node,
b.Fb-1,!1):null}jkm(b,h){b=this.J$h(b,h);return this.xHf(b)}Zti(b,h,r){return b.ra&&b.ra.length?(b=r?b.ra.first.Ib:b.ra.last.Ib)&&0<=h&&h<b.length&&b.K(h).zg&&b.K(h).Uc===r&&this.gYf(b.K(h))?b.K(h):null:null}TKf(b){if(!b||!Le.a.Vw(b))return null;var h=this.Ip.J5d(b,b);b=0<h.count?h.K(h.count-1):null;return b&&!b.zg&&this.gYf(b)?(h=1<h.count?h.K(h.count-2):null)&&!h.zg&&this.gYf(h)?null:b:null}gYf(b){if(!b)return!1;var h=this.NDi(b);if(!h)return!1;if(b.Uc)var r=b;else r=h,h=b;var A=this.hb.textLength(b.Jb.paragraph);
if(r.Jb.cp||h.Jb.cp!==A||!r.sq||r.mCa||!h.sq||h.mCa)return!1;r=r.Jb.Ib;h=h.Jb.Ib;for(A=0;A<r.length&&!r.K(A).se.equals(b.se);A++)if(!r.K(A).Uc)return!1;for(r=h.length-1;0<=r&&!h.K(r).se.equals(b.se);r--)if(h.K(r).Uc)return!1;return!0}Fsd(b){b=this.xHf(b);this.NXd(b,!1)}b5j(b,h){b=this.J$h(b,h);this.Fsd(b)}bPa(b){b=this.TKf(b);return this.NXd(b,!0)?b:null}$gn(b,h){b=this.xHf(b);return!!b&&b.se.equals(h)}Nnc(b,h,r){b=this.jkm(b,h);return!!b&&b.se.equals(r)}QZf(b,h){b=this.TKf(b);return!!b&&b.se.equals(h)}NXd(b,
h){if(!b)return!1;const r=this.NDi(b);return this.R7h(b,h)&&(!r||this.R7h(r,h))}R7h(b,h){if(!b||b.zg===h)return!1;var r=this.Ip.lEe(b.Jb.paragraph,b.Uc);const A=b.Jb.Ib;-1!==r||b.Uc||(r=A.length);const M=h===b.Uc?1:-1;r+=h?M:0;b=A.IL(b.se,b.Uc)+M;if(r===b||0<M!==b>r)return v.ULS.shipAssertTag(24933847,368,r!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",r,b,M),v.ULS.shipAssertTag(24933848,368,0<M===b>r,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",
r,b,M),!1;for(var ba=r;ba!==b;ba+=M){var oa=A.K(ba);A.ava(oa);oa.zg=h;A.sdn(oa,ba);this.Qzp(A.K(ba))}if(this.H7)for(A.Jb.paragraph.Ql(),ba=r;ba!==b;ba+=M)oa=A.K(ba),oa.paragraph.qe.Mq.W(oa.te,Xu.CharacterPropertiesEditor.ON),oa.paragraph.qe.Ot.W(oa.te,Xu.CharacterPropertiesEditor.lS);h||this.wCp(A,r,b,M);v.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(b-r),h?"block":"inline");return!0}o8d(b){return b.Uc&&this.th.hr(b.Wd.id,!0).equals(b.Jb.paragraph.id)?38:!b.Uc&&
this.th.hr(b.Wd.id,!1).equals(b.Jb.paragraph.id)?39:b.zg&&b.Uc?40:b.zg&&!b.Uc?41:!b.zg&&b.Uc?38:39}Qzp(b){const h=b.Jb.paragraph.Ic;if(h){var r=h.Eb(b.lv),A=b.Wd;if(r){r=r.clone();r.setValue(Rc.a.z1f,b.zg);const M=this.o8d(b);r.setValue(Rc.a.ht,M);h.nu(r,null);b.lv=r.id}A&&A.setValue(Rc.a.mba,b.zg)}}NDi(b){if(b.Jb.cp&&b.Jb.cp!==this.hb.textLength(b.Jb.paragraph)||!b.Jb.paragraph.ra||!b.Jb.paragraph.ra.length)return null;const h=b.Uc?b.Jb.paragraph.ra.last:b.Jb.paragraph.ra.first;if(!h.Ib)return null;
b=h.Ib.IL(b.se,!b.Uc);return-1===b?null:h.Ib.K(b)}wCp(b,h,r,A){var M=b.K(h).Wd;if(M){var ba=b.K(h).Uc;M=this.th.hr(M.id,ba);if(!M.equals(P.a.nil))if(b.Jb&&b.Jb.paragraph&&b.Jb.paragraph.id.equals(M)){for(h+=A;h!==r;h+=A){const oa=b.K(h).Wd;if(!oa)return;this.th.mJ(oa.id,M,ba)}0<=r&&r<b.length&&b.K(r).zg&&this.n1f(b.K(r))&&(b=b.K(r).Wd)&&this.th.mJ(b.id,M,ba)}else v.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}n1f(b){return b.sq&&
!b.mCa}J$h(b,h){if(!b||!this.pi)return null;const r=h?vc.a.Tc(b,0):vc.a.Bx(b);b=this.pi.Pr(b,h);r.Tb=r.Fb=b;return r}get H7(){return this.Cd.isFeatureEnabled(25)}}Object(u.a)(xH,"ContentControlConverter",null,[535]);var eA;(function(b){b[b.fOp=0]="BoundingBox";b[b.eTp=1]="Tags";b[b.eQp=2]="Hidden";b[b.uRp=3]="NumberOfContentControlAppearance"})(eA||(eA={}));Object(u.b)("ContentControlAppearance",eA);var fF=d(1581);class yH{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){this.qib=this.eea=this.LAd=this.mNd=
this.WHd=null;this.Goa=this.Sk=this.GNc=this._id=0;this.E6b=this.vkb=this.hOd=this._title=this.EFa=null;this.ZEd=this.YEd=this.Kqh=this.NKd=this.QJc=this.MJc=this.aAd=!1;this.esh=null;this.zg=!1;this.Cyd=null;this.Fi=r;this.Ez=h;this.kh=A;this.vr=M;this.Xm=ba;this.r5=oa;this.Nia=Ja;this.Jja=jb;this.QJb=zb;this.th=Eb;b?(this.WHd=b.id,this.Cyd=b,this.jX(!1)):this._id=Lg.a.gG()}get Gj(){return this.Fi.value}get id(){this.jX();return this._id}set id(b){this._id=b;this.isValid()&&(this.Wd.setValue(Rc.a.Mw,
this._id),this.KY())}get parentId(){this.jX();return this.GNc}set parentId(b){this.GNc=b}get title(){this.jX();return this._title}set title(b){this._title=b;this.isValid()&&(this.Wd.setValue(Rc.a.Ynb,this._title),this.KY(),this.$sd(h=>{h.title=this._title?this._title:As.a.yNb}))}get tag(){this.jX();return this.hOd}set tag(b){this.hOd=b;this.isValid()&&(this.Wd.setValue(Rc.a.bob,this.hOd),this.KY())}get type(){this.jX();return this.Sk}set type(b){this.Sk=b;this.isValid()&&(this.Wd.setValue(Rc.a.zUa,
fF.a[this.Sk]),this.KY())}get appearance(){this.jX();return this.Goa}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Goa=b;this.isValid()&&(this.Wd.setValue(Rc.a.Znb,eA[this.Goa].toLowerCase()),this.KY(),this.$sd(h=>{h.appearance=eA[this.Goa].toLowerCase()}))}get color(){this.jX();return this.EFa}set color(b){if(b&&16777215>=b)this.EFa=b,this.isValid()&&(this.Wd.setValue(Rc.a.SWc,this.EFa),this.KY(),this.$sd(h=>{h.color=this.EFa}));
else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.jX();return this.vkb}set placeholderText(b){this.vkb=b;os.a.kga&&this.kh.P7j(b,this.Cyd)&&(this.KY(),this.XL&&this.Xm.GKb(this,!0))}get b0d(){this.jX();return this.E6b}set b0d(b){this.E6b=b;this.isValid()&&(this.Wd.setValue(Rc.a.tMb,this.E6b),this.KY())}get Syf(){this.jX();return this.aAd}set Syf(b){b&&(this.aAd=b,this.isValid()&&(this.Wd.setValue(Rc.a.AXd,this.aAd),this.KY()))}get removeWhenEdited(){this.jX();
return this.NKd}set removeWhenEdited(b){if(b&&!this.$la)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.NKd=b;this.isValid()&&(this.Wd.setValue(Rc.a.i7h,this.NKd),this.KY())}get $la(){this.jX();return this.MJc}set $la(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.MJc=b;this.isValid()&&(this.Wd.setValue(Rc.a.Gfc,
this.MJc),this.$sd(h=>{h.mN=this.MJc}),this.KY())}get isEditable(){this.jX();return this.QJc}set isEditable(b){this.QJc=b;this.isValid()&&(this.Wd.setValue(Rc.a.aob,this.QJc),this.$sd(h=>{h.editable=this.QJc}),this.KY())}get isSupported(){this.jX();return this.Kqh}get fsn(){return this.isSupported&&11!==this.type&&10!==this.type}get C3i(){this.jX();return this.E6b&&"table of contents"===this.E6b.toLowerCase()?!0:!1}get bfe(){this.jX();return this.YEd}set bfe(b){this.YEd=b;this.isValid()&&(this.Wd.setValue(Rc.a.n7h,
this.YEd),this.KY())}get Qoc(){this.jX();return this.ZEd}set Qoc(b){this.ZEd=b;this.isValid()&&(this.Wd.setValue(Rc.a.o7h,this.ZEd),this.KY())}get XL(){return this.Wd.ka(Rc.a.raa,!1)}set XL(b){this.isValid()&&this.Wd.setValue(Rc.a.raa,b)}get isChecked(){return 8!==this.type?!1:this.Wd.ka(le.a.Prf,!1)}set isChecked(b){8===this.type&&this.isValid()&&(this.Wd.setValue(le.a.Prf,b),this.KY())}get xv(){this.jX();return this.mNd}set xv(b){this.mNd=b}get OA(){this.jX();return this.LAd}set OA(b){this.LAd=
b}get objectId(){return this.WHd}set objectId(b){this.WHd=b;this.Cyd=this.Gj.Eb(this.WHd)}get start(){this.M9j();return this.eea}set start(b){this.eea=b}get end(){this.M9j();return this.qib}set end(b){this.qib=b}get Wd(){return this.Cyd}bbo(b){for(let h=0;3>h;++h)if(eA[h].toLowerCase()===b)return h;return 0}KY(){const b=this.start.node;b&&b.setValue(ze.a.SU,new Date)}ntd(){this._id=this.Wd.ka(Rc.a.Mw,0);this.Goa=this.bbo(this.Wd.ka(Rc.a.Znb,null));this.EFa=this.Wd.ka(Rc.a.SWc,null);this._title=this.Wd.ka(Rc.a.Ynb,
null);this.hOd=this.Wd.ka(Rc.a.bob,null);this.zg=this.Wd.ka(Rc.a.mba,!1);this.MJc=this.Wd.ka(Rc.a.Gfc,!1);this.QJc=this.Wd.ka(Rc.a.aob,!1);this.Kqh=this.Wd.ka(Rc.a.tka,!1);this.E6b=this.Wd.ka(Rc.a.tMb,null);this.aAd=this.Wd.ka(Rc.a.AXd,!1);this.mNd=this.th.hr(this.Wd.id,!0);this.LAd=this.th.hr(this.Wd.id,!1);this.ZEd=this.Wd.ka(Rc.a.o7h,!1);this.YEd=this.Wd.ka(Rc.a.n7h,!1);this.NKd=this.Wd.ka(Rc.a.i7h,!1);this.Sk=Object(fF.b)(this.Wd.ka(Rc.a.zUa,"RichText"));let b=null;try{const h=this.Wd.ka(Rc.a.qaa,
P.a.nil);if(P.a.xt(h,P.a.nil))this.GNc=0;else if(b=this.Gj.Eb(h))this.GNc=b.ka(Rc.a.Mw,0)}catch(h){this.GNc=0}this.uBp()}uBp(){if(this.QJb){var b=this.Wd.ka(Rc.a.xUa,"");if((b=this.Nia.lKi(b))&&0<b.length){this.vkb=this.gti(b.Qa,b.Wc);return}}this.vkb=(b=this.kh.QAa())&&b.currentNode?b.currentNode.ka(Rc.a.TWc,null):null}jX(b=!0){if(!b||this.isValid())b=this.Wd.ka(ze.a.lastModifiedTime,new Date(0)),this.esh!==b?(v.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),
this.ntd(),this.esh=b):v.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}vCp(b,h){this.mNd=b;this.LAd=h;this.th.mJ(this.Wd.id,b,!0);this.th.mJ(this.Wd.id,h,!1)}M9j(){if(this.Wd){var b=this.xv,h=this.OA;if(!b||!h||b.equals(P.a.nil)||h.equals(P.a.nil))v.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.kh.wsa(b,!0),h=this.kh.wsa(h,!1),
b&&h)if(b.isConnected&&h.isConnected||v.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.zg)b=vc.a.create(b),this.vr.Xsd(b,this.objectId,!0),this.start=b,b=vc.a.create(h),this.vr.Xsd(b,this.objectId,!0),this.end=b;else{let r=h=-1;if(b.ra){for(let A=0;A<b.ra.length&&(-1===h||-1===r);A++){const M=b.ra.K(A);if(M.Ib)for(let ba=0;ba<M.Ib.length&&(-1===h||-1===r);ba++){const oa=M.Ib.K(ba);P.a.xt(oa.se,this.objectId)&&(oa.Uc?h=M.cp:r=M.cp)}}0<=h&&0<=r&&(b=vc.a.hU(h,r,
!1,b),this.vr.Xsd(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const r=this.end;if(!h||!r)return b;this.zg?b=this.gti(h,r):(h=Ed.ParagraphReader.text(h.node).substring(h.cpBegin,r.cpEnd),b+=Pn.AParagraphNode.tV(h));return b}isValid(){return!!this.Wd&&this.Wd.isConnected}vye(b){return this.Jja?this.Xm.WAg(this,b)?0:2:2}clear(){return this.Jja?this.Xm.WAg(this,"")?0:2:2}dvi(){const b=new qb.a;var h=this.Wd.ka(Rc.a.Wd,[]);for(const r of h)if(!P.a.xt(r,P.a.nil)){h=
this.Fi.value.Eb(r);try{b.add(this.r5.HMb(h,this.Ez,this.Fi,this.kh,this.vr,this.Xm,this.Nia,this.Jja,this.QJb))}catch(A){}}return b}VGf(){const b=new qb.a;this.Ysi(this,b);return b}Ysi(b,h){b=b.dvi();if(b.count)for(const r of b)h.add(r),this.Ysi(r,h)}JF(b=!1){const h=new qb.a;if(this.zg){var r=this.Xm.oX(this.start,this.end);for(var A of r)r=vc.a.create(A),this.vr.Xsd(r,this.objectId,b),h.add(r)}else A=this.start.clone(),this.vr.Xsd(A,this.objectId,b),h.add(A);return h}$sd(b){const h=this.Xm.oX(this.start,
this.end);for(let r=0;r<h.count;r++){const A=this.vr.xIf(h.K(r),this.objectId,!1);if(A){for(let M=0;M<A.count;M++)b(A.K(M));h.K(r).Vk()}}}gti(b,h){const r=new Sys.StringBuilder;h=this.Xm.oX(b,h);for(const A of h)A.id.equals(b.node.id)||r.append("\r"),r.append(Ed.ParagraphReader.d4(A));return r.toString()}}Object(u.a)(yH,"ContentControl",null,[549]);class kx{constructor(b){this.th=b}HMb(b,h,r,A,M,ba,oa,Ja,jb){return new yH(b,h,r,A,M,ba,this,oa,Ja,jb,this.th)}}Object(u.a)(kx,"ContentControlFactory",
null,[534]);class Ev{constructor(b,h,r,A,M){this.Fi=b;this.vr=h;this.TQk=r;this.OZ=A;this.Ga=M}Rxp(b,h,r){var A,M;if(!(os.a.Srf&&b&&h&&r))return!1;const ba=b.Wd;if(!ba)return!1;var oa=ba.ka(Rc.a.vMb,P.a.nil);oa&&!oa.equals(P.a.nil)?b=this.Fi.value.Eb(oa):(b=this.vr.Nkc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(A=null===b||void 0===b?void 0:b.formatting)||void 0===A?void 0:A.uo,b||(b=new PE.a,this.Fi.value.nu(b,null)),ba.setValue(Rc.a.vMb,b.id));A=this.Fi.value.Eb(b.id);oa="boolean"===
typeof r&&r;const Ja=null===(M=this.Ga)||void 0===M?void 0:M.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.TQk.mKf(ba,A,h,r,Ja?null:oa);h=this.OZ.aGe(h);for(const [jb,zb]of h)b.setValue(jb,zb);return!0}}Object(u.a)(Ev,"ContentControlFormattingManager",null,[533]);var NJ=d(929);class hy{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){this.Ez=b;this.Fi=h;this.$c=r;this.PGb=A;this.zsk=M;this.sT=ba;this.Rh=oa;this.hb=Ja;this.fJd=jb;this.aCd=zb;this.th=Eb;this.ITe=
Sb;this.Nia=nc}get tv(){return this.Ez.value}QAa(){const b=this.$c.Vl();b.set(this.tv);this.PGb.iS(b);if(b.Ub(25))return b;this.aCd.instance&&this.aCd.instance.pta&&v.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");v.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}w3c(b,h,r=!1){this.rOb();const A=new qb.a;let M;if(b){M=b.Ub(26);if(!M)return A;for(;M&&(!h(M)||(A.add(M),!r));){A.addRange(this.w3c(b,h));if(r&&0<A.count)break;
M=b.Nf(26)}b.rc()}return A}bFm(){const b=this.$c.Vl();b.set(this.Ez.value);this.PGb.iS(b);return b.currentNode}EXa(b,h,r){let A;A=b.equals(h);A||(A=(b=this.wsa(b,r))?b.id.equals(h):!1);return A}EVa(b,h){b=this.ov(b);if(!b)return null;let r=null;for(;55===b.type;){const A=this.th.hr(b.id,h);if(A.equals(r)){b=null;break}else b=this.ov(A);r=A}return b}wsa(b,h){return(b=this.EVa(b,h))?Ed.ParagraphReader.Vb(b)?b:h?this.hb.fn(b):this.hb.xE(b):null}mei(b,h=!1){this.Xwp(b);this.nei(b,h)}Xwp(b){var h=this.PAa(b);
h=this.PAa(h.parentNode);h=55===h.currentNode.type?h.currentNode.id:null;let r,A;r=this.ov(this.th.hr(b.id,!0));for(A=this.ov(this.th.hr(b.id,!1));r&&55===r.type;)r=this.ov(this.th.hr(r.id,!0));for(;A&&55===A.type;)A=this.ov(this.th.hr(A.id,!1));r&&A&&this.g7j(r.id,A.id,h,M=>{M=M.ka(Rc.a.o_,P.a.nil);return!M||M.equals(P.a.nil)||b.id.equals(M)})}nei(b,h=!1){v.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");var r=this.PAa(b);const A=this.PAa(r.parentNode);let M=P.a.nil,
ba=P.a.nil;var oa=A.currentNode.ka(Rc.a.Wd,[]);const Ja=new qb.a;for(var jb=0;jb<oa.length;jb++)Ja.add(oa[jb]);if(h){if(54!==A.currentNode.type){M=this.th.hr(A.currentNode.id,!0);ba=this.th.hr(A.currentNode.id,!1);oa=this.ov(M);for(jb=this.ov(ba);oa&&55===oa.type;)M=this.th.hr(oa.id,!0),oa=this.ov(M);for(;jb&&55===jb.type;)ba=this.th.hr(jb.id,!1),jb=this.ov(ba)}oa=this.PAa(b);if(oa.Ub(26)){jb=new qb.a;for(jb.add(oa.currentNode);oa.Nf(26);)jb.add(oa.currentNode);for(var zb of jb)this.nei(zb,h)}}else if(M=
this.th.hr(b.id,!0),ba=this.th.hr(b.id,!1),h=this.uxm(Ja,b.id),zb=this.PAa(b),zb.Ub(26)){oa=this.PAa(zb.currentNode);jb=oa.currentNode;let Eb=b;for(;jb;){const Sb=zb.currentNode;Ja.insert(h++,Sb.id);jb=oa.Nf(26);const nc=this.PAa(Sb);54!==A.currentNode.type?Sb.setValue(Rc.a.qaa,A.currentNode.id):Sb.removeProperty(Rc.a.qaa);Eo.h(nc,A,Eb,26);Eb=nc.currentNode;jb&&(zb.set(jb),zb.P4(this.QAa().currentNode))}}54!==A.currentNode.type&&(h=this.th.hr(A.currentNode.id,!0),zb=this.th.hr(A.currentNode.id,!1),
h.equals(b.id)&&this.th.mJ(A.currentNode.id,M,!0),zb.equals(b.id)&&this.th.mJ(A.currentNode.id,ba,!1));r.Tg();v.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Ja,b.id);oa=Array(Ja.count);for(r=0;r<Ja.count;r++)oa[r]=Ja.K(r);A.currentNode.setValue(Rc.a.Wd,oa);NJ.a.ACa(b.id)}EWk(b,h,r,A,M,ba,oa=null){let Ja;if(h){var jb=this.ov(h.objectId);Ja=this.PAa(jb)}else Ja=this.QAa(),jb=Ja.currentNode;const zb=this.zsk.create(rn.a.Wd);oa&&zb.properties.At(oa.properties);54!==jb.type&&
zb.setValue(Rc.a.qaa,jb.id);oa?Ja.vSb(zb,r,26,oa.id):Ja.eK(zb,r,26);this.N9j(b,zb.id,M,!0);this.N9j(b,zb.id,ba,!1);b.zg&&(h&&(r=this.th.hr(jb.id,!0),oa=this.th.hr(jb.id,!1),r.equals(M)&&this.th.mJ(jb.id,zb.id,!0),oa.equals(ba)&&this.th.mJ(jb.id,zb.id,!1)),this.g7j(M,ba,zb.id,Eb=>{Eb=Eb.ka(Rc.a.o_,P.a.nil);const Sb=h?h.objectId:null;return!Eb||Eb.equals(P.a.nil)||Eb.equals(Sb)}));M=this.PAa(zb);ba=Array(A.count);for(jb=A.count-1;0<=jb;jb--)ba[jb]=A.K(jb).objectId,r=this.ov(A.K(jb).objectId),r=this.PAa(r),
r.currentNode.setValue(Rc.a.qaa,zb.id),Eo.h(r,M,null,26);0<ba.length&&zb.setValue(Rc.a.Wd,ba);hy.qc.isFeatureEnabled(31)&&(b.b0d&&zb.setValue(Rc.a.tMb,b.b0d),b.Syf&&zb.setValue(Rc.a.AXd,!0));return zb}N9j(b,h,r,A){12===this.ov(r).type?this.th.mJ(h,r,A):(this.th.XMg(h,r,A),this.th.mJ(h,A?b.start.node.id:b.end.node.id,A))}jVo(b,h,r,A,M){b.setValue(Rc.a.mba,h);b.setValue(Rc.a.Gfc,!0);b.setValue(Rc.a.aob,!0);b.setValue(Rc.a.Mw,r);b.setValue(Rc.a.Znb,eA[0]);b.setValue(Rc.a.tka,!0);b.setValue(Rc.a.zUa,
fF.a[M]);A&&b.setValue(Rc.a.dAb,A);b.setValue(Rc.a.Hfc,0)}h7j(b,h=null,r=null){h&&this.th.mJ(b,h,!0);r&&this.th.mJ(b,r,!1)}Eei(b){if(!b||!b.count||!b.K(0))return null;const h=this.dNf(b);for(let r=0;r<b.count;r++)this.Rh.JDa(b.K(r));return h}dNf(b){if(!b||!b.K(0))return null;const h=this.$c.Vl();h.set(b.K(0));h.Ld();h.rc();return h.bK()?h.currentNode:null}mGm(b){const h=this.$c.Vl();h.set(b);h.Ld();h.rc();h.rc();return h}gOh(b,h,r){const A=new qb.a;for(let M=0;M<r;M++){h=this.sT.ASb(b,h,!0,null);
if(!h||!b.$d())return null;const ba=b.currentNode;b.rc();b.rc();A.add(ba)}return A}zlc(b){const h=this.$c.Vl();h.set(b);for(h.vb(7);h.rc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}zDi(b){const h=this.$c.Vl();h.set(b);h.Ld();return(b=h.p_a())?b.id:null}aLf(b){const h=this.$c.Vl();h.set(b);return h.vb(7)?h:null}ov(b){return this.Fi.value.Eb(b)}rOb(){if(!hy.coh){var b=this.QAa();b&&this.eKg(b);hy.coh=!0}}b0a(b){return this.fJd.b0a(b)}Kof(b,h,r,A){let M=
null,ba=b.fd(16);for(;ba!==r;){if(h&&Xh.TableCellReader.qYi(b)||!h&&Xh.TableCellReader.f_f(b))M=b.fd(14);else return{returnValue:!1,Gx:A};ba=b.fd(16)}M&&(A=vc.a.create(M));return{returnValue:!0,Gx:A}}eKg(b){if(b.Ub(26)){for(this.eKg(b);b.Nf(26);)this.eKg(b);b.rc()}}remove(b,h){for(let r=0;r<b.count;r++)if(b.K(r).toString()===h.toString()){b.removeAt(r);break}}PAa(b){const h=this.$c.Vl();h.set(b);h.P4(this.QAa().currentNode);return h}uxm(b,h){for(let r=0;r<b.count;r++)if(b.K(r).equals(h))return r;
return-1}g7j(b,h,r,A){b=this.bom(b,h);for(h=0;h<b.count;h++)A(b.K(h))&&(r?b.K(h).setValue(Rc.a.o_,r):b.K(h).removeProperty(Rc.a.o_),this.aCd.instance&&this.aCd.instance.zWi&&b.K(h).fm(16,!0))}bom(b,h){const r=new qb.a;var A=this.ov(b);const M=this.ov(h);if(!A||!M)return r;const ba=({wbd:oa}=this.R4d(A,M)).returnValue;A=oa[ba];if(14===A.type)r.add(A);else if(15===A.type&&1<=ba){const Ja=oa[ba-1];1===Hi.TableReader.ug(Ja)&&r.add(Ja)}var oa=zc.a.Za(ba>=oa.length-1?A:oa[ba+1]);oa.vb(7);for(A=Be.a.Bt(oa,
A);A.moveNext()&&A.currentNode!==M;)14===A.currentNode.type&&r.add(A.currentNode);if(!P.a.xt(h,b)&&14===M.type)for(oa=zc.a.Za(M),A=Be.a.Bt(oa,M);A.moveNext();)14===A.currentNode.type&&r.add(A.currentNode);return r}R4d(b,h){b=this.vqb(b);h=this.vqb(h);let r=0;for(;r<b.length&&r<h.length&&b[r]===h[r];++r);return{returnValue:0<r?r-1:r,wbd:b,hwg:h}}vqb(b){const h=[];h.push(b);b=zc.a.Za(b);for(b.vb(7);b.rc();)h.push(b.currentNode);h.reverse();return h}static get qc(){return null!=hy.gWg?hy.gWg:hy.gWg=
$a.a.instance.Oa(23)}NXc(b,h,r=!1){b=this.ITe.instance.dJl(b);r?(r=As.a.PPl,b.setValue(Rc.a.Hlc,r)):r=b.ka(Rc.a.Hlc,null);h.setValue(Rc.a.xUa,r)}vul(b,h){this.Ktj(b)&&(b=b.ka(Rc.a.xUa,null),b=this.ITe.instance.yul(b).ka(Rc.a.Hlc,null),h.setValue(Rc.a.xUa,b))}P7j(b,h){if(!this.Ktj(h))return!1;var r=h.ka(Rc.a.xUa,null);r?cD(h)?this.NXc(b,h):this.ITe.instance.vBp(r,b):(r=this.Nia.Swi())?h.setValue(Rc.a.xUa,r):this.NXc(b,h,!0);return!0}Ktj(b){if(!b)return!1;var h=b.getValue(Rc.a.zUa);if(!h)return!1;h=
Object(fF.b)(h);b=b.getValue(Rc.a.tMb);return(0==h||1==h)&&b!==nk.whi}}hy.coh=!1;Object(u.a)(hy,"ContentControlGraphManager",null,[530]);class Fv{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){this.XNe=zb;this.Foa=null;this.jqn=(Eb,Sb)=>{if(this.F7)return this.kqn(Eb,Sb);if(!Eb||!Eb.count)return v.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let nc=!0;switch(Sb){case 0:Sb=this.nP(Eb.K(0),Eb.K(Eb.count-1),1);if((Eb=this.nP(Eb.K(0),Eb.K(Eb.count-1),3))&&0<Eb.count){if(!Eb.K(0).isSupported||
!Eb.K(0).isEditable){nc=!1;break}for(Eb=Eb.K(0);Eb;)this.Ckd(Sb,Eb.id),Eb=this.getById(Eb.parentId)}if(Sb)for(var Dc of Sb)if(!Dc.isSupported||!Dc.isEditable){nc=!1;break}break;case 1:if(Eb.K(0).contextId!==mc.a.Vc){v.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");nc=!1;break}(Sb=this.nP(Eb.K(0),Eb.K(0),1))&&0<Sb.count&&(nc=!1);break;case 2:if(Eb.K(0).contextId!==mc.a.Vc){v.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");
nc=!1;break}(Sb=this.nP(Eb.K(0),Eb.K(0),3))&&0<Sb.count&&(nc=!1);break;case 3:case 4:Sb=this.d7d(Eb.K(0),!0);Dc=this.d7d(Eb.K(Eb.count-1),!1);if(!Sb||!Dc){v.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");nc=!1;break}if((Sb=this.nP(Sb,Sb,3))&&0<Sb.count){nc=!1;break}if((Sb=this.nP(Dc,Dc,3))&&0<Sb.count){nc=!1;break}if(Sb=this.Xm.nP(Eb.K(0),Eb.K(Eb.count-1),1))for(const Zc of Sb)if(!Zc.$la){nc=!1;break}break;default:nc=!1}return nc};
Fv.Ez=b;Fv.Fi=h;this.kh=r;this.vr=A;this.Xm=M;this.r5=ba;this.Nia=oa;this.jg=Ja;this.Ip=jb}get hXa(){return!!this.jg.instance&&this.jg.instance.hXa}get pta(){return!!this.jg.instance&&this.jg.instance.pta}get tde(){return!!this.jg.instance&&this.jg.instance.tde}get F7(){return!!this.jg.instance&&this.jg.instance.F7}get vde(){return!!this.jg.instance&&this.jg.instance.vde}aTb(){return!!this.jg.instance&&this.jg.instance.aTb}Kqa(b,h,r=null,A=null,M=!1,ba=0){if(!this.hXa)return{returnValue:2,id:0};b=
this.kh.wsa(b,!0);h=this.kh.wsa(h,!1);if(!b||!h)return{returnValue:2,id:0};b=vc.a.create(b);h=vc.a.create(h);return this.SMh(b,h,r,A,M,ba,!1)}LVk(b,h,r=0,A=!1){return this.hXa&&b&&h?this.SMh(b,h,null,null,!1,r,A):{returnValue:2,id:0}}X5a(b,h=null,r=0,A=!1){let M=0;if(!this.hXa)return{returnValue:2,id:M};const ba=this.r5.HMb(h,Fv.Ez,Fv.Fi,this.kh,this.vr,this.Xm,this.Nia,this.hXa,this.tde);ba.type=r;ba.start=b;ba.end=b;ba.xv=b.node.id;ba.OA=b.node.id;ba.zg=!1;return this.Xm.TNh(ba,h,A)?(M=ba.id,{returnValue:0,
id:M}):{returnValue:2,id:M}}DWk(b,h=null){if(!this.hXa||!this.mmn(b))return{returnValue:2,id:0};var r=b.K(0).contextId===mc.a.Yc?b.K(1):b.K(0);const A=b.K(b.count-1);if(this.xrf(b,mc.a.paragraph)||this.xrf(b,mc.a.Yc)){b=r.node.id;let M=A.node.id;const ba=b.equals(M);r=this.Xm.CXj(r,!0);void 0!==r&&null!==r&&(b=r,M=ba?b:M);this.Xm.CXj(A,!1);h.setValue(Rc.a.mba,!0);return this.Kqa(b,M,h)}return r!==A||r.contextId!==mc.a.Fd&&r.contextId!==mc.a.Vc?{returnValue:2,id:0}:(h.setValue(Rc.a.mba,!1),this.X5a(r,
h))}getById(b){if(!this.pta)return null;const h=this.kh.w3c(this.kh.QAa(),r=>r.getValue(Rc.a.Mw)===b,!0);return 0<h.count?this.Xm.JR(h.K(0)):null}getByTitle(b){if(!this.pta)return null;const h=this.kh.w3c(this.kh.QAa(),A=>A.ka(Rc.a.Ynb,null)===b,!1),r=new qb.a;for(const A of h)r.add(this.Xm.JR(A));return r}getByTag(b){if(!this.pta)return null;const h=this.kh.w3c(this.kh.QAa(),A=>A.ka(Rc.a.bob,null)===b,!1),r=new qb.a;for(const A of h)r.add(this.Xm.JR(A));return r}nP(b,h,r,A=!1){return this.pta?this.F7?
this.Xm.ysa(b,h,r):this.Xm.nP(b,h,r,A):null}oX(b,h){return this.Xm.oX(b,h)}bim(){if(!this.pta)return null;const b=this.kh.w3c(this.kh.QAa(),()=>!0,!1),h=new qb.a;for(const r of b)h.add(this.Xm.JR(r));return h}yZb(b){if(!this.hXa)return v.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.Xm.FDa(b)?0:2}eRl(b){if(!this.hXa)return 2;b=this.getById(b);return this.Xm.deleteContentControl(b)?0:2}WWk(b){this.Xm.YAj(b)}Ndl(b){this.Foa=
b;this.Foa.Exo(this.jqn)}pom(b){if(!this.aTb())return null;let h;var r=b.JF();h=this.d7d(r.K(r.count-1),!1);r=this.vr.Nkc(r.K(r.count-1).node,h.cpBegin).Ib;b=this.bPm(r,b);if(-1===b)return null;h.Fb=b;h.Tb=h.Fb;return h}kqn(b,h){if(!b||!b.count)return v.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.tkn(b);case 3:case 4:case 6:return this.qsn(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.K(0).contextId!==mc.a.Vc?(v.ULS.sendTraceTag(21031132,
368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.yZi(b.K(0),5===h,!1);default:return!1}}tkn(b){const h=this.Xm.ysa(b.K(0),b.K(b.count-1),3);if(h&&0<h.count){var r=h.K(0);if(!r.isSupported||!r.isEditable)return!1}b=this.Xm.ysa(b.K(0),b.K(b.count-1),1);for(r=0;h&&r<h.count;r++)this.Ckd(b,h.K(r).id);if(b)for(const A of b)if(!A.isSupported||!A.isEditable)return!1;return!0}qsn(b,h){var r=b.K(0),A=b.K(b.count-1),M=r.Jj,ba=A.Wo;if(-1===
M||-1===ba)return!1;M=this.Ip.Taa(r.node,M,r.Fb);ba=this.Ip.Taa(A.node,ba,A.Tb);var oa=-1,Ja=Math.min(M.count,ba.count);for(--Ja;0<=Ja;Ja--){const jb=M.K(Ja).se,zb=ba.K(Ja).se;if(jb.equals(zb)){oa=Ja;break}}if(-1<oa&&(Ja=this.Xm.JR(M.K(oa).Wd),!Ja.isEditable||!Ja.isSupported||Ja.XL&&!this.Vjn(Ja,b)))return!1;r=this.Xm.ysa(r,A,1);for(A=0;A<=oa;A++)this.Ckd(r,this.Xm.JR(M.K(A).Wd).id);for(A=oa+1;A<M.count;A++){Ja=this.Xm.JR(M.K(A).Wd);if(!Ja.isEditable||!Ja.$la||!Ja.isSupported||Ja.XL)return!1;this.Ckd(r,
Ja.id)}for(M=oa+1;M<ba.count;M++){oa=this.Xm.JR(ba.K(M).Wd);if(!oa.isEditable||!oa.$la||!oa.isSupported||oa.XL)return!1;this.Ckd(r,oa.id)}if(r)for(const jb of r)if(!jb.isSupported||!jb.$la)return!1;return h&&(b=this.d7d(b.K(0),!0))?this.yZi(b,!0,!0):!0}Vjn(b,h){h=this.Ip.jGm(h.K(0),h.K(h.count-1));return!!b&&!!h&&b.objectId.equals(h.se)}yZi(b,h,r){return(b=this.Xm.ysa(b,b,3))&&0<b.count&&(b=b.K(0),!b.isSupported||!b.isEditable||!this.vde&&h&&!b.zg||!r&&b.XL||h&&1===b.type)?!1:!0}d7d(b,h){if(!b)return null;
let r=null;switch(b.contextId){case mc.a.paragraph:r=h?vc.a.Tc(b.node,0):vc.a.Bx(b.node);break;case mc.a.Yc:r=vc.a.Bx(b.node);break;case mc.a.Fd:r=h?vc.a.Tc(b.node,b.cpBegin):vc.a.Tc(b.node,b.cpEnd);break;case mc.a.Vc:r=b}r&&(r.Tb=r.Fb=h?b.Fb:b.Tb);return r}Ckd(b,h){if(b)for(const r of b)if(r.id===h){b.remove(r);break}}bPm(b,h){if(!b)return-1;let r=-1;for(let A=0;A<b.length;A++)if(b.K(A).se.equals(h.objectId)&&!1===b.K(A).Uc){r=A;if(h.zg&&0<A&&b.K(A-1).zg&&!b.K(A-1).Uc)return-1;break}return r}mmn(b){if(void 0===
b||null===b)return!1;for(let h=0;h<b.count;h++){const r=b.K(h).contextId;if(r!==mc.a.paragraph&&r!==mc.a.Yc&&r!==mc.a.Fd&&r!==mc.a.Vc||0<h&&h<b.count-1&&r===mc.a.Fd&&(b.K(h).cpBegin||b.K(h).cpEnd!==b.K(h).node.characterData.length))return!1}return b.K(0).contextId===mc.a.Yc&&1===b.count||this.xrf(b,mc.a.Vc)&&1<b.count?!1:!0}xrf(b,h){for(const r of b)if(r.contextId===h)return!0;return!1}SMh(b,h,r=null,A=null,M=!1,ba=0,oa=!1){let Ja=0;var jb=h.node;let zb=vc.a.create(b.node);jb=vc.a.create(jb);if(!({YXj:zb,
Vji:jb}=this.XNe.d2h(zb,jb)).success)return{returnValue:2,id:Ja};const Eb=this.r5.HMb(r,Fv.Ez,Fv.Fi,this.kh,this.vr,this.Xm,this.Nia,this.hXa,this.tde);Eb.type=ba;Eb.start=b;Eb.end=h;Eb.xv=zb.node.id;Eb.OA=jb.node.id;Eb.zg=!0;Eb.b0d=A;Eb.Syf=M;return this.Xm.TNh(Eb,r,oa)?(Ja=Eb.id,{returnValue:0,id:Ja}):{returnValue:2,id:Ja}}}Fv.Ez=null;Fv.Fi=null;Object(u.a)(Fv,"ContentControlManager",null,[529]);var yB=d(622),OJ=d(146),lx=d(189);class gF extends Sys.EventArgs{constructor(b){super();this.Ici=b}}
Object(u.a)(gF,"ContentControlChangeEventArgs",Sys.EventArgs,[]);var cl=d(1378);class Oh{constructor(){this.Bhj=0;this.gsj=null}}Object(u.a)(Oh,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);const fA=b=>!(null===b||void 0===b?0:b.length),zH=b=>null==b?!1:[...b].some(h=>h.Uc),PJ=b=>null==b?!1:[...b].some(h=>!h.Uc);class qw{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he,fe,Yd,Td,wf,Lf,ii){this.Oj=Lf;this.XAh=[];this.C5e=[];this.Ez=b;this.Fi=h;this.kh=r;this.vr=A;this.r5=
M;this.Je=Ja;this.hy=jb;this.ib=ba;this.JG=oa;this.Nia=nc;this.QJb=Dc;this.Jja=zb;this.KK=Eb;this.ga=Sb;this.Ip=Zc;this.jg=Gd;this.pi=de;this.hb=he;this.Qc=fe;this.vKh=Yd;this.Cd=Td;this.th=wf;this.KK&&(this.KK.addHandler(yB.a.xZb,Object(F.a)(this,this.yoj,"onShowingPlaceholder")),this.KK.addHandler(yB.a.gue,Object(F.a)(this,this.Bnj,"onRemoveWhenEdited")),ii.execute(Bi=>{this.GG=Bi}))}get tv(){return this.Ez.value}get Gj(){return this.Fi.value}get F7(){return!!this.jg.instance&&this.jg.instance.F7}get H7(){return!!this.Cd&&
this.Cd.isFeatureEnabled(25)}dispose(){this.KK&&(this.KK.removeHandler(yB.a.xZb,Object(F.a)(this,this.yoj,"onShowingPlaceholder")),this.KK.removeHandler(yB.a.gue,Object(F.a)(this,this.Bnj,"onRemoveWhenEdited")))}nP(b,h,r,A=!1){if(this.F7)return this.ysa(b,h,r);if(!b||!h)return null;const M=this.kh.wsa(b.node.id,!0);var ba=this.kh.wsa(h.node.id,!1);if(!M||!ba)return null;b=b.contextId===mc.a.Yc?b:vc.a.Tc(M,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===mc.a.Yc?h:vc.a.Tc(ba,-1===h.cpEnd?ba.characterData.length:
h.cpEnd);ba=null;switch(r){case 0:ba=this.Fsm(b,h);break;case 1:ba=this.tGm(b,h);break;case 3:ba=this.iEi(b,h,A);break;case 2:ba=this.bQm(b,h);break;case 4:ba=this.AIf(b,h,!1)}return ba}ysa(b,h,r){if(!b||!h||b.contextId!==mc.a.Yc&&(b=this.S7h(b,!0),!b)||h.contextId!==mc.a.Yc&&(h=this.S7h(h,!1),!h))return null;let A=null;switch(r){case 0:A=this.Gsm(b,h);break;case 1:A=this.uGm(b,h);break;case 3:A=this.jEi(b,h);break;case 2:A=this.cQm(b,h);break;case 4:A=this.AIf(b,h,!0)}return A}S7h(b,h){var r=this.kh.wsa(b.node.id,
h);if(!r)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?r.characterData.length:b.cpEnd,b=b.Tb);r=vc.a.Tc(r,h);r.Fb=b;r.Tb=b;return r}Fsm(b,h){const r=new qb.a;if(b.contextId===mc.a.Yc||h.contextId===mc.a.Yc||b.equals(h))return r;const A=new Xo.a,M=this.CPb(b,b),ba=this.CPb(h,h);for(let oa=0;oa<M.count;oa++)if(M.K(oa).Uc)for(let Ja=0;Ja<ba.count;Ja++)ba.K(Ja).Uc||M.K(oa).se.equals(ba.K(Ja).se)&&(!M.K(oa).zg||this.kh.EXa(M.K(oa).se,b.node.id,!0)&&this.kh.EXa(ba.K(Ja).se,h.node.id,
!1))&&this.YQd(r,A,M.K(oa).se);return r}Gsm(b,h){const r=new qb.a;if(b.contextId===mc.a.Yc||h.contextId===mc.a.Yc||b.equals(h)&&b.Fb===b.Tb||-1===b.Fb||-1===h.Tb)return r;var A=b.node.ra.Ch(b.cpBegin),M=h.node.ra.Ch(h.cpEnd);A&&A.Ib&&0<A.Ib.length&&b.Fb<=A.Ib.length&&M&&M.Ib&&0<M.Ib.length&&h.Tb<=M.Ib.length&&(b=b.Fb,h=h.Tb,b===A.Ib.length&&b--,0<h&&h--,A=A.Ib.K(b),M=M.Ib.K(h),A.Uc&&!M.Uc&&P.a.xt(A.se,M.se)&&A.sq&&M.sq&&(M=A.Wd)&&r.add(this.JR(M)));return r}tGm(b,h){const r=new qb.a,A=new Xo.a,M=
this.CPb(b,h);for(let ba=0;ba<M.count;ba++)this.YQd(r,A,M.K(ba).se);b=this.iEi(b,h,!1,!1);for(const ba of b)A.contains(ba.objectId)||(r.add(ba),A.add(ba.objectId));return r}uGm(b,h){const r=new qb.a,A=new Xo.a,M=this.GHf(b,h);for(let ba=0;ba<M.count;ba++)this.Bef(r,A,M.K(ba));b=this.jEi(b,h);for(const ba of b)A.contains(ba.objectId)||(r.add(ba),A.add(ba.objectId));return r}iEi(b,h,r,A=!0){const M=new qb.a;b.equals(h)&&(r=!1);const ba=new Xo.a;let oa=!1;b=this.CPb(null,b,!0,r);h=this.CPb(h,null,r,
!0);for(r=b.count-1;0<=r;r--){for(let Ja=0;Ja<h.count&&!(b.K(r).se.equals(h.K(Ja).se)&&(b.K(r),this.YQd(M,ba,b.K(r).se)&&(oa=!this.kh.ov(b.K(r).se).ka(Rc.a.qaa,null),A||oa)));Ja++);if(0<M.count&&(A||oa))break}return M}jEi(b,h){const r=new qb.a,A=new Xo.a,M=b.node;var ba=h.node;const oa=h.contextId===mc.a.Yc?ba.characterData.length:h.cpEnd;b=this.Ip.Taa(M,b.contextId===mc.a.Yc?M.characterData.length:b.cpBegin,b.Fb);h=this.Ip.Taa(ba,oa,h.Tb);ba=b.count>h.count?h.count:b.count;for(--ba;0<=ba;ba--)b.K(ba).se.equals(h.K(ba).se)&&
this.Bef(r,A,b.K(ba));return r}bQm(b,h){const r=new qb.a;let A=new Xo.a;const M=this.CPb(b,h);let ba=0,oa=null;if(b.equals(h))return r;for(b=0;b<M.count;b++)!M.K(b).Uc||M.K(b).zg&&!this.kh.EXa(M.K(b).se,M.K(b).Jb.paragraph.id,!0)?M.K(b).Uc||M.K(b).zg&&!this.kh.EXa(M.K(b).se,M.K(b).Jb.paragraph.id,!1)||(ba--,0>ba?(ba=0,A=new Xo.a):!ba&&oa&&M.K(b).se.equals(oa)&&this.YQd(r,A,oa)):(ba||(oa=M.K(b).se),ba++);return r}cQm(b,h){const r=new qb.a;if(b.equals(h)&&b.Fb===h.Tb)return r;let A=new Xo.a;b=this.GHf(b,
h);h=0;let M=null;for(let ba=0;ba<b.count;ba++){const oa=b.K(ba);!oa.Uc||oa.zg&&!this.kh.EXa(oa.se,oa.Jb.paragraph.id,!0)?oa.Uc||oa.zg&&!this.kh.EXa(oa.se,oa.Jb.paragraph.id,!1)||(h--,0>h?(h=0,A=new Xo.a):!h&&M&&oa.se.equals(M.se)&&this.Bef(r,A,M)):(h||(M=oa),h++)}return r}AIf(b,h,r){const A=new qb.a;b=r?this.GHf(b,h):this.CPb(b,h);h=0;for(r=0;r<b.count;r++){var M=b.K(r);M.sq&&(M.Uc?h++:(h--,0>h?h=0:(M=this.JR(M.Wd))&&A.add(M)))}return A}CPb(b,h,r=!0,A=!0){const M=new qb.a,ba=this.oX(b,h);if(!ba.count)return M;
let oa,Ja,jb,zb;for(let Eb=0;Eb<ba.count;Eb++){oa=0;Ja=ba.K(Eb).characterData.length;jb=zb=!0;if(b&&ba.K(Eb).id.equals(b.node.id)){if(b.contextId===mc.a.Yc)continue;0<=b.cpBegin&&(oa=b.cpBegin)}h&&ba.K(Eb).id.equals(h.node.id)&&0<=h.cpEnd&&(Ja=h.cpEnd);Eb||(jb=r);Eb!==ba.count-1||h&&h.contextId===mc.a.Yc||(zb=A);M.addRange(this.HHf(ba.K(Eb),oa,Ja,jb,zb))}return M}GHf(b,h){const r=new qb.a,A=this.oX(b,h);let M,ba,oa;for(let jb=0;jb<A.count;jb++){const zb=A.K(jb);if(zb.ra.length){var Ja=zb.ra.K(zb.ra.length-
1);M=0;ba=zb.characterData.length;oa=0;Ja=Ja&&Ja.Ib?Ja.Ib.length:0;b&&zb.id.equals(b.node.id)&&(M=b.Jj,oa=b.Fb);h&&zb.id.equals(h.node.id)&&(ba=h.Wo,Ja=h.Tb);r.addRange(this.IHf(zb,M,ba,oa,Ja))}}return r}HHf(b,h,r,A=!0,M=!0,ba=!0){const oa=new qb.a;b=b.ra;for(let Ja=0;Ja<b.length;Ja++){if(b.K(Ja).cp<h)continue;if(b.K(Ja).cp>r)break;const jb=b.K(Ja);if(jb.Ib&&0<jb.Ib.length&&(jb.cp!==h||A)&&(jb.cp!==r||M))for(let zb=0;zb<jb.Ib.length;zb++){const Eb=jb.Ib.K(zb);(ba||Eb.Uc)&&oa.add(Eb)}}return oa}IHf(b,
h,r,A,M){const ba=new qb.a;b=b.ra;for(let oa=0;oa<b.length;oa++){if(b.K(oa).cp<h)continue;if(b.K(oa).cp>r)break;const Ja=b.K(oa);if(Ja.Ib&&0<Ja.Ib.length){let jb=0,zb=Ja.Ib.length;Ja.cp===h&&-1!==A&&(jb=A);for(Ja.cp===r&&-1!==M&&(zb=M);jb<zb&&jb<Ja.Ib.length;jb++)ba.add(Ja.Ib.K(jb))}}return ba}YQd(b,h,r){let A=null;if(h.contains(r)||!(A=this.Gj.Eb(r)))return!1;b.add(this.JR(A));h.add(r);return!0}Bef(b,h,r){let A=null;!h.contains(r.se)&&(A=r.Wd)&&(b.add(this.JR(A)),h.add(r.se))}d4j(b,h){let r,A=!1;
r=({Fcb:h,Ecb:b,dpd:A}=this.e4j(b,h,!1,A)).returnValue||A;A&&(r=r||({Fcb:h,Ecb:b,dpd:A}=this.e4j(h,b,!0,A)).returnValue);return{returnValue:r,Fcb:h,Ecb:b}}e4j(b,h,r,A){let M,ba;if(r)return M=ba=null,{returnValue:!1,Fcb:ba,Ecb:M,dpd:!1};let oa=!1;ba=b;M=h;const Ja=b.cpBegin,jb=h.cpEnd;A=!1;var zb=r?this.bti(h):this.rim(b);let Eb=!1,Sb=!1,nc=0,Dc=0;for(const Zc of zb)for(zb=0;zb<Zc.ra.length;zb++){const Gd=Zc.ra.K(zb);!Sb&&Zc.id.equals(h.node.id)&&(Sb=!0);if(!Eb&&(Zc.id.equals(h.node.id)&&-1!==jb&&
Gd.cp>jb||Sb&&!Zc.id.equals(h.node.id)))if(Eb=!0,nc!==Dc)oa=!0;else return{returnValue:!1,Fcb:ba,Ecb:M,dpd:A};if((!Zc.id.equals(b.node.id)||Gd.cp>=Ja||-1===Ja)&&Gd.Ib)for(let de=0;de<Gd.Ib.length;de++){const he=Gd.Ib.K(de),fe=this.Gj.Eb(he.se);if(!fe.getValue(Rc.a.mba)||(!he.Uc||this.kh.EXa(this.th.hr(fe.id,!0),Zc.id,!0))&&(he.Uc||this.kh.EXa(this.th.hr(fe.id,!1),Zc.id,!1))){he.Uc?nc++:nc--;if(oa&&nc===Dc)return{Fcb:ba,Ecb:M}=this.NFl(b.node,Zc,b.cpBegin,Gd.cp),{returnValue:!0,Fcb:ba,Ecb:M,dpd:A};
!r&&nc<Dc&&(A=!0,Dc--)}}}return{returnValue:oa,Fcb:ba,Ecb:M,dpd:A}}NFl(b,h,r,A){let M;h.id.equals(b.id)?b=0<r||A<Ed.ParagraphReader.textLength(h)?M=vc.a.createTextRange(h,r,A):M=vc.a.create(h):(M=0<r?vc.a.createTextRange(b,r,Ed.ParagraphReader.textLength(b)):vc.a.create(b),b=A<Ed.ParagraphReader.textLength(h)?vc.a.createTextRange(h,0,A):vc.a.create(h));return{Fcb:M,Ecb:b}}aCm(b){const h=b.cpBegin,r=this.bti(b);for(let M=r.count-1;0<=M;M--){const ba=r.K(M);for(let oa=ba.ra.length-1;0<=oa;oa--){const Ja=
ba.ra.K(oa);if((!ba.id.equals(b.node.id)||Ja.cp<=h||-1===h&&!Ja.cp)&&Ja.Ib){var A=Ja.Ib.length-1;for((Ja.cp===h||-1===h&&!Ja.cp)&&this.F7&&ba.id.equals(b.node.id)&&(A=b.Fb-1);0<=A;A--){const jb=Ja.Ib.K(A),zb=this.Gj.Eb(jb.se);if(jb.Uc){if(zb.getValue(Rc.a.mba)&&!this.kh.EXa(this.th.hr(zb.id,!0),ba.id,!0))continue;return null}if(!zb.getValue(Rc.a.mba)||this.kh.EXa(this.th.hr(zb.id,!1),ba.id,!1))return this.JR(zb)}}}}return null}JR(b){if(!b)return null;this.kh.rOb();return this.r5.HMb(b,this.Ez,this.Fi,
this.kh,this.vr,this,this.Nia,this.Jja,this.QJb)}oX(b,h){b=this.ati(b,h,qw.mQb(12));if(!b)return null;h=new qb.a;for(const r of b)h.add(r);return h}pim(b,h){const r=qw.jym();return this.ati(vc.a.create(b.node),vc.a.create(h.node),r)}ati(b,h,r){if(!r||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var A=b.node;if(A&&r(A)){var M;return M=new qb.a,M.add(A),M}}A=Object.assign(new Oh,{Bhj:35,gsj:r});b=b?b.node:null;h=h?h.node:null;M=this.IKm(b,h);if(!M)return null;h=this.v4k(h,
r,qw.IYh,A);return this.kim(b,h,M,r,qw.IYh,A)}IKm(b,h){return(b=b?this.QAi(b):this.QAi(h))?b.fd(35):this.kh.bFm()}v4k(b,h,r,A){if(!b)return null;h(b)||(h=this.mim(b,h,r,A),h.count&&(b=h.K(h.count-1)));return b}kim(b,h,r,A,M,ba){b?(b=zc.a.Za(b),b.vb(7),r=Be.a.Bt(b,r)):r=Be.a.Zo(r);M&&r.Dp(M,ba);for(M=new qb.a;r.moveNext()&&(A(r.currentNode)&&M.add(r.currentNode),!h||!r.currentNode.id.equals(h.id)););return M}mim(b,h,r,A){b=Be.a.Zo(b);r&&b.Dp(r,A);for(r=new qb.a;b.moveNext();)h(b.currentNode)&&r.add(b.currentNode);
return r}QAi(b){b=zc.a.Za(b);return b.vb(35)?b:null}ONi(b,h){b=this.oX(b,h);for(const r of b)if((b=this.kh.aLf(r))&&b.Gla(4))return!0;return!1}TNh(b,h=null,r=!1){if(!b)return!1;var A=b.start,M=b.end;if(!Le.a.Vw(A)&&A.contextId!==mc.a.paragraph||!Le.a.Vw(M)&&M.contextId!==mc.a.paragraph||!this.F7&&({Fcb:A,Ecb:M}=this.d4j(b.start,b.end)).returnValue||this.F7&&!({start:A,end:M}=this.yml(A,M)).returnValue)return!1;b.start=A;b.end=M;const ba=this.Fkn(A,M);if(this.F7){var oa=this.ysa(b.start,b.end,3);var Ja=
this.ysa(b.start,b.end,2)}else oa=this.nP(b.start,b.end,3),Ja=this.nP(b.start,b.end,2);const jb=oa&&0<oa.count?oa.K(0):null,zb=Ja&&0<Ja.count?Ja.K(0):null;if(r)return this.Y8c(b,0,oa)?!0:!1;if(this.Y8c(b,0,oa)){r=(r=Object(Ma.a)(yH,this.aCm(b.start)))?this.kh.ov(r.objectId):null;Ja=this.kh.EWk(b,jb,r,Ja,b.xv,b.OA,h);this.Oj.yrc(Ja);if(b.zg)for(M=this.oX(b.start,b.end),r=0;r<M.count;r++)if(this.F7){oa=jb?jb.objectId:null;const Eb=this.tAi(oa,M.K(r),!0);this.vr.Pya(M.K(r),Ja.id,0,!0,!0,void 0,void 0,
void 0,void 0,Eb);oa=this.tAi(oa,M.K(r),!1);this.vr.Pya(M.K(r),Ja.id,M.K(r).characterData.length,!0,!1,void 0,void 0,void 0,void 0,oa)}else this.vr.Pya(M.K(r),Ja.id,0,!0,!0),this.vr.Pya(M.K(r),Ja.id,M.K(r).characterData.length,!0,!1);else this.F7?(r=-1===A.Fb?0:A.Fb,this.vr.Pya(b.start.node,Ja.id,A.cpBegin,!1,!0,void 0,void 0,void 0,void 0,r),this.vr.Pya(b.end.node,Ja.id,M.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ba?r+1:M.Tb)):(this.vr.Pya(b.start.node,Ja.id,b.start.cpBegin,!1,!0),this.vr.Pya(b.start.node,
Ja.id,b.start.cpEnd,!1,!1));h||this.kh.jVo(Ja,b.zg,b.id,this.kh.zlc(this.kh.ov(b.xv)),b.type);1===b.type&&this.vr.Cup(b.start.node,A.Jj,A.Wo);h=!(os.a.Xec&&8===b.type);b.objectId=Ja.id;A=this.kh.QAa().currentNode;h&&!A.hasProperty(Rc.a.TWc)&&A.setValue(Rc.a.TWc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);h&&os.a.kga&&this.kh.P7j(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Ja);jb&&this.c9j(jb.Wd,b);zb&&this.c9j(Ja,zb);h&&ba&&this.ga.Pb(ub.a.ypd,2,b.id);os.a.Xec&&
8===b.type&&this.vNj(!1,b,Ja);cl.a.g7h()&&this.GG&&this.GG.fireEvent(3,{node:Ja});return!0}return!1}deleteContentControl(b){if(!this.Y8c(b,3))return v.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.Oj.Csd(b.Wd))return!0;b.XL&&(b.XL=!1);const h=this.ib.gb.currentSelection;b=b.JF();const r=new or.Selection(b.toArray(),!0);let A=!1;this.ib.p_b(()=>{this.ib.Kc(r);if(32===this.ga.Ob(ub.a.RJ,2)){if(this.vKh.instance){const M=this.vKh.instance.lCi(h,r,this.ib.gb.currentSelection);
this.ib.twp(new OJ.SelectionCollection([M],0))}A=!0}});return A}FDa(b,h=!1,r=!1){if(this.Y8c(b,2)){if(b.XL)return v.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const A=b.Wd;let M=new qb.a;h&&(M=b.VGf());M.add(b);if(r||!this.Oj.Csd(b.Wd)){A&&A.anchor&&this.kh.mei(A,h);for(const ba of M)b=this.oX(ba.start,ba.end),this.vr.oRl(b,ba.objectId);this.lyj(M)}v.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");
return!0}v.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}WAg(b,h){if(this.Y8c(b,1)){let Ja=!1;h||(Ja=!0,{V5o:r,returnValue:h}=this.MQb(b),r&&this.kh.QAa().currentNode.setValue(Rc.a.TWc,h));var r=b.dvi().toArray();for(var A=0;A<r.length;A++)this.FDa(r[A],!0);r=this.Odp(h);if(b.zg){A=this.oX(b.start,b.end);if(!A.count)return!1;if(1===A.count&&y.AFrameworkApplication.jv)this.vr.Ue(vc.a.createTextRange(A.K(0),0,A.K(0).characterData.length),h);else{var M=this.kh.mGm(A.K(0));
h=A.K(0).Fjc();A=this.kh.Eei(A);A=this.kh.gOh(M,A,r.length);for(M=0;M<A.count;M++){this.vr.Ue(vc.a.createTextRange(A.K(M),0,0),r[M],void 0,b.type);for(var ba=0;ba<h.count;ba++)this.vr.Pya(A.K(M),h.K(ba),0,!0,!0),this.vr.Pya(A.K(M),h.K(h.count-ba-1),A.K(M).characterData.length,!0,!1)}b.vCp(A.K(0).id,A.K(A.count-1).id);r=this.JG.ve(A.K(0),0);this.ib.Kc(r)}}else{M=0;1<r.length&&v.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");
h=b.start;A=h.node;for(var oa=0;oa<A.ra.length&&h.contextId===mc.a.Fd;oa++)if(ba=A.ra.K(oa),ba.cp===h.cpBegin&&ba.blob){M++;for(oa+=1;oa<A.ra.length;oa++)if(ba=A.ra.K(oa),ba.cp>h.cpBegin&&ba.cp<=h.cpEnd)if(ba.blob)M++;else break;else if(ba.cp>h.cpEnd)break;break}if(0<M&&M+h.cpBegin<h.cpEnd)A=vc.a.createTextRange(h.node,h.cpBegin,h.cpBegin+M),h=vc.a.createTextRange(h.node,h.cpBegin+M,h.cpEnd),this.vr.Ue(h,r[0]),this.vr.Ue(A,"");else if(0<M&&M+h.cpBegin===h.cpEnd)for(this.vr.Ue(b.start,r[0]),r=0;r<
A.ra.length;r++){if(M=A.ra.K(r),M.cp===h.cpBegin){M.blob=null;break}}else y.AFrameworkApplication.jv?(r=r.join(" "),this.vr.Ue(b.start,r)):this.vr.Ue(b.start,r[0],void 0,b.type)}this.GKb(b,Ja);let jb;this.voo((jb=new qb.a,jb.add(b),jb));return!0}return!1}GKb(b,h){const r=this.vr.Nkc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(r){const M=this.kh.ov(b.objectId);if(h){h=this.hy.MF(b.start.node);var A=h.mh(As.a.blg);A||(zi.a.Jg.xn?(A=h.mv().fBa(As.a.Mtj),A=h.mh(this.hy.Be(A))):A=h.MKa(As.a.Mtj));
A&&(this.Je.lra(r.formatting),this.Je.Aeb(r.formatting,A));M&&(b.XL=!0)}else M&&b.XL&&(this.MJo(b,r),b.XL=!1)}else v.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}MJo(b,h){b=this.kh.ov(b.objectId);let r=null;b&&(r=b.ka(Rc.a.vMb,P.a.nil));this.Je.lra(h.formatting);r&&!r.equals(P.a.nil)&&(b=this.Fi.value.Eb(r),h.formatting=b)}MQb(b){let h=!1;b=b.placeholderText;this.qun(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,
V5o:h}}rzo(b,h=!0){this.Jja&&(h&&this.mzo(b),this.yzo(b))}szo(b){if(this.Jja&&(b=this.nP(b,b,4)))for(const h of b)this.FDa(h,!1)}bZn(b,h){if(h&&!b.Uc&&(this.kh.rOb(),(b=b.Jb.paragraph.Ic.Eb(b.se))&&b.anchor)){this.kh.mei(b);b=this.r5.HMb(b,this.Ez,this.Fi,this.kh,this.vr,this,this.Nia,this.Jja,this.QJb);let r;this.lyj((r=new qb.a,r.add(b),r))}}Bnj(b,h){this.kh.rOb();b=this.kh.ov(h.se);const r=this.JR(b);if(r&&r.isValid()&&r.removeWhenEdited){const A=this.Qc.Lc(7);A.Ab(b);this.FDa(r,!1);h.state=2;
A.dispose()}}yoj(b,h){this.kh.rOb();b=this.kh.ov(h.se);this.Bin(b)&&(b=b.ka(Rc.a.Mw,0),this.ga&&(this.ga.Pb(ub.a.ypd,2,b),qw.Pd.Bhf()))}Bin(b){return b&&b.isConnected&&!b.ka(Rc.a.raa,!1)?this.fYf(b)&&!b.ix:!1}fYf(b){b=this.r5.HMb(b,this.Ez,this.Fi,this.kh,this.vr,this,this.Nia,this.Jja,this.QJb);if(!b.isValid())return!1;if(b.zg){if(b.xv.toString()===b.OA.toString()){var h=this.kh.ov(b.xv);if(!h)return v.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),
!1;if(12===h.type&&1===h.ra.length)return this.AWi(h.ra.K(0),b.objectId)}}else{h=b.start;if(!h)return v.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(h.cpBegin===h.cpEnd)return h=this.kh.ov(b.xv).ra.Ch(h.cpBegin),this.AWi(h,b.objectId)}return!1}AWi(b,h){b=b?b.Ib:null;if(!b)return!1;const r=b.IL(h,!0);return-1<r&&r+1<b.length&&b.K(r+1).se.toString()===h.toString()}YAj(b){this.C5e.push(b)}CXj(b,h){if(void 0===b||null===b||b.contextId!==
mc.a.Fd)return null;b=vc.a.Tc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<Ed.ParagraphReader.textLength(b.node)?this.kh.b0a(b):null}select(b,h){if(b&&!b.equals(P.a.nil)){var r=this.kh.ov(b);if(r&&55===r.type){r=this.JR(r);if(r.zg)r=this.kkm(r);else{r=r.start;if(!r)return;r.contextId=mc.a.Fd;r=this.JG.Yo(r)}if(r&&r.length)return this.INj(r.Qa,b,h,!0,!0),this.INj(r.Wc,b,h,!1,!1),this.ib.Kc(r),r}}}FPo(b,h){if(!Le.a.qf(b)||b.Fb!==b.Tb)return!1;const r=b.Fb;return-1===r?!1:(b=this.Ip.k9a(b.node,
b.cpBegin,r,!h))&&h===b.Uc?(h=this.JR(b.Wd),this.select(b.se,!h.isEditable),!0):!1}kkm(b){var h,r=this.kh.EVa(b.xv,!0),A=this.kh.EVa(b.OA,!1);if(!r||!A)return null;r=this.pim(vc.a.create(r),vc.a.create(A));if(!r||!r.count)return null;A=new qb.a;y.AFrameworkApplication.nd("DeleteTocUsingBackspace;DeleteTocUsingBackspaceCf");const M=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsDeleteTocUsingBackspaceEnabled",!1);for(h=0;h<r.count;h++){let ba;
if(12===r.K(h).type)ba=h!==r.count-1||M&&b.C3i?vc.a.create(r.K(h)):vc.a.createTextRange(r.K(h),0,Ed.ParagraphReader.textLength(r.K(h))),this.pi&&(ba.Fb=this.pi.Pr(ba.node,!0),ba.Tb=this.pi.Pr(ba.node,!1));else if(15===r.K(h).type)ba=lx.TableNodeContext.create(r.K(h));else continue;A.add(ba)}return new or.Selection(A.toArray(),!0)}GUo(b){if(b&&!b.equals(P.a.nil)&&(this.kh.rOb(),(b=this.kh.ov(b))&&55===b.type&&b.isConnected)){var h=b.ka(Rc.a.raa,!1);b.setValue(Rc.a.raa,!1);h&&this.guo(b)}}P1j(b){if(b&&
!b.equals(P.a.nil)&&(this.kh.rOb(),(b=this.kh.ov(b))&&55===b.type&&b.isConnected)){var h=this.JR(b);h.isEditable&&8===h.type&&this.vNj(!h.isChecked,h,b)}}vNj(b,h,r){const {AOa:A,font:M}=this.omm(b,r),ba=this.Qc.Lc(15);ba.Ab(r);h.isChecked=b;this.WAg(h,A);b=this.vr.Nkc(h.start.node,Math.max(h.start.cpBegin,0));this.Je.uha(b.formatting,M);ba.dispose()}omm(b,h){b?(b=h.ka(le.a.e7h,As.a.dPl),h=h.ka(le.a.d7h,As.a.cPl)):(b=h.ka(le.a.m7h,As.a.fPl),h=h.ka(le.a.l7h,As.a.ePl));b=String.fromCodePoint(Number("0x"+
b));return{AOa:b,font:h}}guo(b){var h=this.th.hr(b.id,!0);h.equals(P.a.nil)||(h=this.kh.wsa(h,!0))&&(b=this.vr.xIf(h,b.id,!0))&&0<b.count&&(b=b.K(0),h=b.Jb,h.formatting=b.tU?b.tU.Mf(h):new XE.a(h,P.a.nil))}TBj(b){if(b=this.ewi(b))for(const h of b)this.Oj.QBg()&&(h.XL=!1),this.FDa(h,!1)}awi(b){const h=new qb.a;if(b=this.ewi(b))for(const r of b)h.add(r.Wd);return h}tzo(b){if(b&&(11===b.type||14===b.type||15===b.type||16===b.type)){var h=this.hb.fn(b),r=this.hb.xE(b);if(this.pi&&h&&r){b=this.pi.Pr(h,
!0);const A=this.pi.Pr(r,!1);h=vc.a.create(h);r=vc.a.create(r);h.Fb=b;r.Tb=A;if(b=this.ysa(h,r,4))for(const M of b)this.FDa(M,!1)}}}sim(b){var h=this.th.hr(b.id,!0,b.yP);b=this.th.hr(b.id,!1,b.yP);if(h.equals(P.a.nil)||b.equals(P.a.nil))return new qb.a;h=this.kh.wsa(h,!0);b=this.kh.wsa(b,!1);return h&&b?this.oX(vc.a.create(h),vc.a.create(b))||new qb.a:new qb.a}EVa(b,h){return this.kh.EVa(b,h)}HKf(b,h){if(b&&55===b.type&&(b=this.JR(b),b=h?b.start:b.end)){const r=vc.a.Tc(b.node,h?b.Jj:b.Wo);r.Fb=r.Tb=
(h?b.Fb:b.Tb)+(h?-1:1);return r}return null}mom(b){return(b=this.JR(b))?b.start:null}INj(b,h,r,A,M){if((b.contextId===mc.a.Fd||b.contextId===mc.a.Vc||b.contextId===mc.a.paragraph)&&(M=b.node.ra.Ch(M?b.Jj:b.Wo))&&M.Ib)for(let ba=0;ba<M.Ib.length;ba++){const oa=M.Ib.K(ba);if(oa.se.equals(h)&&oa.sq)if(A&&oa.Uc){b.Fb=r?ba:ba+1;break}else if(!A&&!oa.Uc){b.Tb=r?ba+1:ba;break}}}voo(b){for(let h=0;h<this.XAh.length;++h)(0,this.XAh[h])(this,new gF(b))}lyj(b){for(let h=0;h<this.C5e.length;++h)(0,this.C5e[h])(this,
new gF(b))}yzo(b){b=vc.a.create(b);if(b=this.nP(b,b,4))for(const h of b)h.zg||this.FDa(h,!1)}mzo(b){if(b=b.Fjc())for(let r=0;r<b.count;r++){var h=this.kh.ov(b.K(0));h=this.r5.HMb(h,this.Ez,this.Fi,this.kh,this.vr,this,this.Nia,this.Jja,this.QJb);this.FDa(h)}}rim(b){return this.oX(b,null)}Y8c(b,h,r=null){let A=!0;try{if(!b)return v.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;v.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",
h,b.isSupported,b.$la));if(this.lqn(h)&&this.mqn(h)&&!this.Cin(b))return!1;if(!r){const oa=this.iGm(b);oa&&(r=new qb.a,r.add(oa))}var M=this.kh.zDi(b.start.node);const ba=this.kh.zDi(b.end.node);if(M&&ba&&!M.equals(ba)||!M&&ba||M&&!ba)return!1;M=!0;if(r&&0<r.count){if(!r.K(0).isSupported)return!1;M=r.K(0).isEditable}switch(h){case 0:A=this.Sfn(b,M);break;case 1:A=(this.H7||!this.PZf(b))&&b.isSupported&&b.isEditable&&this.$Th(b)&&this.DWi(b);y.AFrameworkApplication.jv||(A=A&&!this.ONi(b.start,b.end));
break;case 2:const oa=b.C3i?!0:b.isSupported;A=(this.H7||!this.PZf(b))&&oa&&b.$la&&M;v.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:A=b.isSupported&&b.$la&&M&&this.$Th(b)&&this.DWi(b)&&!this.ONi(b.start,b.end)}}catch(ba){v.ULS.sendTraceTag(17413646,368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+ba),A=!1}return A}mqn(b){return!(y.AFrameworkApplication.jv&&1===b)}lqn(b){return!(this.F7&&(!b||2===b||3===b))}Sfn(b,h){return(this.H7||!this.PZf(b))&&
this.Tfn(b)&&this.omn(b)&&h&&!this.Jnn(b)&&this.Zgn(b)?!0:!1}omn(b){var h;const r=b.start,A=r.contextId,M=null===(h=b.end)||void 0===h?void 0:h.contextId;return b.zg?A!==mc.a.paragraph&&A!==mc.a.Yc||M!==mc.a.paragraph&&M!==mc.a.Yc?!1:!0:Le.a.Vw(r)||A===mc.a.Yc?!0:!1}ewi(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.pi&&(this.hb.kn(h)&&12===h.node.type&&(h.Fb=this.pi.Pr(h.node,!0)),this.hb.kn(b)&&12===b.node.type&&(b.Tb=this.pi.Pr(b.node,!1)));return this.ysa(h,b,4)}$Th(b){b=b.VGf();
for(const h of b)if(!h.isSupported||!h.$la)return!1;return!0}Cin(b){if(this.d4j(b.start,b.end).returnValue)return!1;const h=this.nP(b.start,b.end,2);if(!h)return!0;for(const r of h)if(!r.objectId.equals(b.objectId)&&(r.zg&&(r.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||r.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===Ed.ParagraphReader.textLength(r.end.node)))||!r.zg&&(b.start.node.id.equals(r.start.node.id)&&(-1!==b.start.cpBegin?r.start.cpBegin===
b.start.cpBegin:!r.start.cpBegin)||b.end.node.id.equals(r.end.node.id)&&(-1!==b.end.cpEnd?r.end.cpEnd===b.end.cpEnd:r.end.cpEnd===Ed.ParagraphReader.textLength(b.end.node)))))return!1;return!0}DWi(b){if(b.zg){var h=this.kh.ov(b.xv),r=this.kh.ov(b.OA);let A=null;if(12===h.type&&12===r.type){h=this.kh.zlc(h);h=this.kh.ov(h);r=this.kh.zlc(r);r=this.kh.ov(r);if(!h||!r)return!1;16===h.type&&16===r.type&&h.id.equals(r.id)&&(A=h)}b=this.oX(b.start,b.end);if(!b.count)return!1;for(const M of b)if(b=this.kh.zlc(M),
b=this.kh.ov(b),!b||!(16!==b.type||A&&b.id.equals(A.id)))return!1}return!0}PZf(b){return b.zg?!1:(b=b.start.node)?b.ka(Rc.a.nXa,!0)||b.ka(Fe.a.pna,!1)?!1:!0:!0}Tfn(b){return 1!==b.type?!0:b.xv.equals(b.OA)&&Ed.ParagraphReader.Vb(b.start.node)&&!this.Q_m(b)?!0:!1}Q_m(b){const h=b.start;var r=h.node;const A=r.ra;if(b.zg){if(r.Pv||r.y7||r.hasBookmark)return!0;for(var M of A)if(this.TNi(M))return!0;return!1}b=h.Jj;r=h.Wo;let ba=M=null;for(const oa of A.V4i(b,r))if(!(oa.cp<b))if(oa.cp===b)M=oa;else if(oa.cp===
r)ba=oa;else if(this.TNi(oa))return!0;return this.R_m(h,M,ba)?!0:!1}TNi(b){return fA(b.Ib)&&fA(b.mf)&&fA(b.ei)&&fA(b.nc)&&null==b.hyperlink&&!b.yn&&null==b.blob?!1:!0}R_m(b,h,r){if(null==h&&null==r)return!1;const A=b.Fb;b=b.Tb;return null!=h&&(h.Ib&&A<h.Ib.length||null!=h.blob)||null!=r&&r.Ib&&0<b||null!=h&&null!=r&&(zH(h.mf)&&PJ(r.mf)||zH(h.ei)&&PJ(r.ei)||!fA(h.nc)&&!fA(r.nc)&&[...h.nc].some(M=>0===M.pe)&&[...r.nc].some(M=>3===M.pe)||null!=h.hyperlink&&r.yn)?!0:!1}Jnn(b){var h,r;return(null!==(r=
null===(h=this.nP(b.start,b.end,3))||void 0===h?void 0:h.toArray())&&void 0!==r?r:[]).some(A=>1===A.type)?!0:!1}Zgn(b){if(!b.zg)return!0;var h=this.kh.ov(b.xv);b=this.kh.ov(b.OA);if(Xh.TableCellReader.nCa(h)||Xh.TableCellReader.nCa(b)||Cn.a.sma(h)||Cn.a.sma(b))return!1;h=this.kh.zlc(h);h=this.kh.ov(h);b=this.kh.zlc(b);b=this.kh.ov(b);return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}iGm(b){if(!b)return null;b=this.kh.ov(b.objectId);if(!b)return null;b=b.ka(Rc.a.qaa,P.a.nil);return b.equals(P.a.nil)?
null:(b=this.kh.ov(b))?this.JR(b):null}bti(b){return this.oX(null,b)}Odp(b){return(b||"").split(RegExp("\r\n|\r|\n"))}qun(b){return b&&""!==b?!1:!0}tAi(b,h,r){h=h.ra.Ch(r?0:h.characterData.length);if(!h)return v.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Ib||!h.Ib.length)return 0;if(!b)return r?0:h.Ib.length;for(let A=0;A<h.Ib.length;A++){const M=h.Ib.K(A);if(P.a.xt(M.se,b)&&M.Uc===r)return r?A+1:A}return r?0:h.Ib.length}yml(b,h){var r=
b.node,A=h.node,M=b.contextId===mc.a.paragraph?0:b.cpBegin,ba=h.contextId===mc.a.paragraph?Ed.ParagraphReader.textLength(A):h.cpEnd;r=this.Ip.Taa(r,M,b.Fb);A=this.Ip.Taa(A,ba,h.Tb);ba=!r||!r.count;M=!A||!A.count;if(ba&&M)return{returnValue:!0,start:b,end:h};if(ba)return{returnValue:this.kEe(b,A.K(A.count-1).se,!0),start:b,end:h};if(M)return{returnValue:this.kEe(h,r.K(r.count-1).se,!1),start:b,end:h};if(r.count===A.count)return r=r.K(r.count-1),A=A.K(A.count-1),{returnValue:r.se.equals(A.se),start:b,
end:h};r=(ba=r.count<A.count)?A.K(A.count-1):r.K(r.count-1);return{returnValue:ba?this.kEe(b,r.se,!0):this.kEe(h,r.se,!1),start:b,end:h}}kEe(b,h,r){var A=b.node;let M;if(r){M=b.contextId===mc.a.paragraph?0:b.cpBegin;var ba=b.Fb}else M=b.contextId===mc.a.paragraph?Ed.ParagraphReader.textLength(A):b.cpEnd,ba=b.Tb;A=A.ra.Ch(M);if(-1===ba||!A||!A.Ib||!A.Ib.length)return!1;A=A.Ib;if(r)for(r=ba;r<A.length;r++){ba=A.K(r);if(!ba.Uc)break;if(ba.se.equals(h))return b.Fb=r+1,!0}else for(r=ba-1;0<=r;r--){ba=
A.K(r);if(ba.Uc)break;if(ba.se.equals(h))return b.Tb=r,!0}return!1}Fkn(b,h){return this.jal(b,h)&&b.Fb===b.Tb&&(b.contextId===mc.a.Vc||b.contextId===mc.a.paragraph&&!b.node.characterData.length)}jal(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Tb===h.Tb}c9j(b,h){if(b&&h.zg){var r=this.th.hr(b.id,!0),A=this.kh.wsa(h.xv,!0);r.equals(A?A.id:null)&&this.th.mJ(b.id,h.objectId,!0);r=this.th.hr(b.id,!1);A=this.kh.wsa(h.OA,!1);r.equals(A?A.id:null)&&this.th.mJ(b.id,h.objectId,!1)}}static get Pd(){return null!=
qw.h6g?qw.h6g:qw.h6g=$a.a.instance.resolve(46).instance}static mQb(b){return h=>h.type===b}static jym(){return b=>12===b.type||15===b.type}static IYh(b,h){return b.nf===h.Bhj||b.parentNode&&h.gsj(b.parentNode)?!1:!0}}Object(u.a)(qw,"ContentControlOperator",null,[527,11,528]);class AH{constructor(b,h,r){this.$c=b;this.Ez=h;this.PGb=r}lKi(b){const h=this.nQb();return h&&b&&this.lRb(h,b)?this.vSm(h):null}lRb(b,h,r=!1){if(!b||!h)return!1;do{var A=b.currentNode;if(!A)break;A=A.ka(Rc.a.Hlc,null);if(A===
h||r&&A&&A.includes(h))return!0}while(b.Nf(29));return!1}vSm(b){var h=b.Ub(1);b.rc();b=b.ML(1);if(!h||!b)return null;h=sc.SelectionFactory.Sai(h,b);b=Le.a.yk(h,!1,!1);return os.a.kga&&!b?null:sc.SelectionFactory.Yy(h,b.Wc)}nQb(){const b=this.$c.Vl();b.set(this.Ez.value);this.PGb.iS(b);return b.Ub(28)&&b.Ub(29)?b:null}$Kf(){const b=this.$c.Vl();b.set(this.Ez.value);this.PGb.iS(b);return b.Ub(28)?b:null}Xtm(b){var h=this.nQb();if(!h||!b||!this.lRb(h,b,!1))return null;h.$d();b=1<h.Gq();h.$d();h.$d();
h=h.currentNode;return Ed.ParagraphReader.Vb(h)?{upe:h,$Ni:b}:{upe:null,$Ni:b}}Swi(){const b=this.nQb();return this.lRb(b,As.a.Gdi,!0)?b.currentNode.getValue(Rc.a.Hlc):null}}Object(u.a)(AH,"GlossaryNavigator",null,[525]);class hF{constructor(b,h,r,A,M,ba){this.vr=b;this.kh=h;this.Xm=r;this.hb=A;this.Nh=M;this.Jja=ba}Knd(b,h,r){if(!this.Jja)return 1;if(!({Ep:M}=this.D1f(b)).returnValue||!this.Nh.Y2i(M,h)||this.QBj(b,h))return 2;var A=this.Nh.cti(h);var M=A.K(0).Fjc();M&&M.count||(M=new qb.a,M.add(b.objectId));
b=this.kh.Eei(A);r=r.split("\n");h=Object(Ma.a)(zc.a,this.kh.aLf(h));h=this.kh.gOh(h,b,r.length);for(b=0;b<h.count;++b){A=h.K(b);this.vr.Ue(vc.a.createTextRange(A,0,0),r[b]);for(let ba=0;ba<M.count;++ba)this.vr.Pya(A,M.K(ba),0,!0,!0),this.vr.Pya(A,M.K(M.count-ba-1),A.characterData.length,!0,!1)}return 0}QBj(b,h){if(!this.Jja)return 1;let r;if(!({Ep:r}=this.D1f(b)).returnValue||!this.Nh.Y2i(r,h))return 2;h=this.Nh.cti(h);if(0<h.count&&(h=this.Xm.nP(vc.a.create(h.K(0)),vc.a.create(h.K(h.count-1)),2)))for(const A of h)if(A.id!==
b.id&&!this.Xm.FDa(A,!0))return 2;return 0}Apc(b){if(!this.Jja||!({Ep:r}=this.D1f(b)).returnValue)return!1;b=b.VGf();for(var h of b)if(!h.$la||!h.isSupported)return!1;if(this.Nh.rin(r))return!1;var r=Object(Ma.a)(zc.a,this.kh.aLf(r));h=new qb.a;this.hb.LQb(r,!0,!1,h);for(const A of h)if(0<A.ka(Rc.a.NOb,0)||this.hb.R9a(A).jz)return!1;return!0}D1f(b){let h=null;return b&&b.xv.toString()===b.OA.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.kh.ov(b.xv))&&14===h.type?{returnValue:!0,Ep:h}:
{returnValue:!1,Ep:null}:{returnValue:!1,Ep:h}}}Object(u.a)(hF,"TableContentControlEditor",null,[524]);class BH{rin(b){let h=!1;const r=new zc.a;r.set(b);bi.forEachCellInTable(r,A=>{if(!Xh.TableCellReader.Lg(A)){let M=to.OutlineNavigator.Mba(A);for(;M;){if(Ua.a.bmc(A))return h=!0,!1;M=A.Mi(1)}}return!0});return h}Y2i(b,h){const r=new zc.a;r.set(h);return Xh.TableCellReader.nCa(h)&&r.vb(14)&&r.fd(14).id===b.id?!0:!1}cti(b){const h=new qb.a,r=new zc.a;r.set(b);b=new qb.a;Ed.ParagraphReader.LQb(r,!0,
!1,b);for(const A of b)h.add(A);return h}}Object(u.a)(BH,"TableReader",null,[400]);class bz{constructor(){this.Xm=null}get name(){return"WordEditor.ContentControl"}init(){y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled")&&(yq.a.UZa(Object(F.a)($a.a.instance.resolve(619),$a.a.instance.resolve(619).bZn,"onContentControlRangeChanged")),this.Xm=$a.a.instance.Oa(625),$a.a.instance.resolve(986).init(),$a.a.instance.resolve(987).init())}dispose(){this.Xm&&(this.Xm.dispose(),this.Xm=null)}uc(b){b.ia(996,
()=>new az.a(Te.a.Le)).ha();b.ia("WordEditor.ContentControl.ContentControlFactory",()=>new kx($a.a.instance.resolve(198))).as(993).ha();b.ia(988,()=>new rH($a.a.instance.Ra(11),$a.a.instance.Ra(19))).ha();b.ia("WordEditor.ContentControl.ContentControlGraphManager",()=>new hy(new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed.ud),new zk.a,Object(fn.a)(),$a.a.instance.resolve(988),$a.a.instance.resolve(110),$a.a.instance.resolve(16),$a.a.instance.resolve(164),
$a.a.instance.resolve(989),$a.a.instance.Ra(11),$a.a.instance.resolve(198),$a.a.instance.Ra(987),$a.a.instance.resolve(990))).as(991).ha();b.ia(995,()=>new AH(new zk.a,new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed),Object(fn.a)())).as(990).ha();b.ia(619,()=>new qw(new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed.ud),$a.a.instance.resolve(991),$a.a.instance.resolve(992),$a.a.instance.resolve(993),$f.a.instance,$a.a.instance.resolve(870),$a.a.instance.resolve(101),
$a.a.instance.resolve(8),y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled"),$a.a.instance.Oa(390),y.AFrameworkApplication.va,$a.a.instance.resolve(990),y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),$a.a.instance.resolve(20),$a.a.instance.Ra(11),$a.a.instance.Oa(13),$a.a.instance.resolve(164),$a.a.instance.resolve(42),$a.a.instance.Ra(881),$a.a.instance.resolve(23),$a.a.instance.resolve(198),$a.a.instance.resolve(382),$a.a.instance.Ra(757))).as(19).as(625).ha();
b.ia("WordEditor.ContentControl.ContentControlManager",()=>new Fv(new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed.ud),$a.a.instance.resolve(991),$a.a.instance.resolve(994),$a.a.instance.resolve(625),$a.a.instance.resolve(993),$a.a.instance.resolve(990),$a.a.instance.Ra(11),$a.a.instance.resolve(20),$a.a.instance.resolve(206))).as(956).ha();b.ia(992,()=>new wH($a.a.instance.resolve(323),$a.a.instance.Ra(11),$a.a.instance.resolve(164),$a.a.instance.resolve(198))).as(994).ha();
b.ia(987,()=>new uH($a.a.instance.resolve(995),$a.a.instance.resolve(16),$a.a.instance.resolve(323),$a.a.instance.resolve(625),$a.a.instance.resolve(377),$a.a.instance.resolve(101),df.a.ff.Pl.jf(55))).as("WordEditor.ContentControl.IGlossaryEditor").ha();b.ia("WordEditor.ContentControl.TableContentControlEditor",()=>new hF($a.a.instance.resolve(994),$a.a.instance.resolve(991),$a.a.instance.resolve(625),$a.a.instance.resolve(164),new BH,y.AFrameworkApplication.J.$("WordEditorContentControlWriteIsEnabled"))).as(876).ha();
y.AFrameworkApplication.J.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&b.ia("Box4.ContentControlConverter",()=>new xH(b.resolve(164),b.resolve(20),b.resolve(13),b.resolve(23),b.resolve(198))).as(87).ha();b.ia(986,()=>new MJ(b.resolve(619),b.resolve(994),b.resolve(991),b.resolve(996),b.resolve(382))).ha();b.ia("WordEditor.ContentControl.ContentControlFormattingManager",()=>new Ev(new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed.ud),$a.a.instance.resolve(992),$a.a.instance.resolve(938),
$a.a.instance.resolve(377),y.AFrameworkApplication.J)).as(1162).ha()}static main(){E.a.instance.Mc(new bz)}}Object(u.a)(bz,"ContentControlPackage",null,[0,1]);var tL=d(1291),QJ=d(1401),RJ=d(1779),SJ=d(1523);class iF{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(u.a)(iF,"UxManagerMenuActionTelemetryData",null,[]);class TJ extends Sys.EventArgs{constructor(b,h,r){super();this.definition=b;this.source=h;this.nyl=r}}Object(u.a)(TJ,"MenuDidCloseEventArgs",
Sys.EventArgs,[]);class CH extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=h}}Object(u.a)(CH,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class UJ{constructor(b,h,r,A,M,ba,oa=!1,Ja=null,jb=null,zb=null,Eb=!1,Sb=null,nc=!1,Dc=!0,Zc=null,Gd=!1,de=10){this.target=this.container=this.Ig=null;this.isDismissed=!1;this.gfd=this.Ued=this.Bmi=this.B0=this.Vv=this.Hga=this.PCa=this.VMa=this.documentElement=this.rva=this.editingElement=null;this.isFocused=!1;this.I_d=null;this.zkg=this.aZf=
!1;this.wFe=null;this.Fqe=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=r;this.definition=A;this.QUk=M;this.TXa=ba;this.VUa=oa;this.pUj=Ja;this.Vra=jb;this.hostServices=zb;this.V8o=Eb;this.Kqj=Sb;this.BUj=nc;this.lWl=Dc;this.Bmi=Zc;this.showDictationCommandUx=Gd;this.source=de}}Object(u.a)(UJ,"UxManagerState",null,[]);var mx=d(1582);class pp{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){this.Zb=b;this.ib=h;this.tB=r;this.od=A;this.oe=M;this.Gb=ba;this.Bj=oa;this.ml=Ja;this.X5=jb;this.f5b=zb;this.Y8e=!1;
this._state=null;this.shouldIgnoreFocusEvent=Eb=>{var Sb;return this.od.Ad.vz&&!this.od.Ad.LX&&Eb===(null===(Sb=this.od.Ke)||void 0===Sb?void 0:Sb.editingElement)};this.sa=new Fd.a;this.RMd=new fb.a;this.kgf((Eb,Sb)=>{pp.TGn(r,Sb.definition,Sb.source)});this.v1k((Eb,Sb)=>{pp.SGn(r,Sb.definition,Sb.source,Sb.nyl)});this.Zb.ie(pp.T3d).YL=!0;y.AFrameworkApplication.va.qa(Hc.a.zZc,mc.a.view,this.zZc.bind(this))}kgf(b){this.sa.addHandler(pp.U8f,b)}dEj(b){this.sa.removeHandler(pp.U8f,b)}Qoo(b,h){this.sa.raiseEvent(pp.U8f,
new CH(b,h))}v1k(b){this.sa.addHandler(pp.Ndj,b)}Poo(b,h,r){this.sa.raiseEvent(pp.Ndj,new TJ(b,h,r))}TCp(b){var h;if(!b.isDismissed&&b.rva){var r=mx.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(r&&r.length){r=mx.b(r);var A=Te.a.getElementBounds(b.rva);r.width||r.height?r.x+r.width<A.x||r.x>A.x+A.width||r.y+r.height<A.y||r.y>A.y+A.height?this.dismiss():(A=b.target,A.style.left=r.x+"px",A.style.top=r.y+"px",A.style.width=r.width+"px",A.style.height=r.height+"px",null===(h=b.Ig)||void 0===h?void 0:h.updatePosition(),
b.Ig||v.ULS.sendTraceTag(512255777,341,50,"Menu is null so can't update position")):(v.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else v.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}eyj(b){b.isDismissed||b.wFe||(b.wFe=new wc.a(2,1,1,()=>{b.wFe=null;this.TCp(b)},147),this.Gb.Yb(b.wFe))}VMa(b,h){!b.isDismissed&&b.lWl&&0<h.cQ.length&&(this.dismiss(),v.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}O5k(b){return!!b&&
b.id===pp.TUk}PCa(b,h){if(b.isDismissed||!h||!h.Nb)return!1;h=h.Nb;const r=h.keyCode,A=!b.isFocused&&!!b.Ig,M=h.altKey||h.ctrlKey||h.shiftKey;let ba=!1;r===rf.a.T4?(this.dismiss(),v.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ba=!0):r!==rf.a.Tu&&r!==rf.a.wz||!A||M||!this.O5k(b.definition)?r!==rf.a.h3b&&r!==rf.a.Ytd||!A||M||(this.gog(b),b.Ig?(b.Ig.focus(),ba=!0,v.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):v.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.Ig.executeDefaultAction(),v.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ba=!0);ba&&(h.preventDefault(),h.stopPropagation());return ba}Ued(b,h){if(b.isDismissed||!b.Ig)return v.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.Ig),!1;b.Ig.invokeBadgeId(h);v.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}gfd(b,h){if(b.isDismissed||!b.Ig)return v.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.Ig),!1;b.Ig.executeActionFromString(h);v.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}Hga(b,h){if(b.isDismissed||!h||!h.Nb||!b.Ig)return v.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===h?
0:h.Nb),!b.Ig),!1;const r=b.target;b=b.Ig.getElementBounds();var A=h.Nb;h=A.clientX;A=A.clientY;r&&pp.Otj(h,A,Te.a.getElementBounds(r),16)||b&&pp.Otj(h,A,pp.Nfl(b),4)||this.dismiss();return!1}I2o(b){var h=mx.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=mx.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=pp.FXc();b.target=h;b.editingElement=this.od.Ke.editingElement;b.rva=this.od.Ad.container;b.documentElement=document.documentElement;b.VMa=(r,A)=>{this.VMa(b,A)};b.PCa=
r=>this.PCa(b,r);b.Hga=r=>this.Hga(b,r);b.B0=()=>{this.eyj(b)};b.Vv=()=>{this.eyj(b)};b.showDictationCommandUx&&(b.Ued=r=>this.Ued(b,r),b.gfd=r=>this.gfd(b,r),this.f5b&&this.f5b.execute(r=>{r.VYo(b.Ued);r.XYo(b.gfd)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.ib.BA(b.VMa);this.Bj.o2(b.Vv);this.oe.nb(zd.a.jL,b.editingElement,b.PCa);b.VUa&&this.ml.nb(zd.a.mua,b.documentElement,b.Hga);uf.a.addHandler(b.rva,"scroll",b.B0);b.TXa||this.gog(b);return!0}tRb(b,h){const r=
!!b.Ig;this.Poo(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Zb.currentScope.name===pp.T3d&&this.Zb.oV(pp.T3d);b.VMa&&this.ib.hha(b.VMa);b.PCa&&b.editingElement&&this.oe.xc(zd.a.jL,b.editingElement,b.PCa);this.f5b&&this.f5b.execute(A=>{b.showDictationCommandUx&&(A.oIo(),A.pIo());A.TOj(!1,b.showDictationCommandUx)});b.Hga&&b.documentElement&&b.VUa&&this.ml.xc(zd.a.mua,b.documentElement,b.Hga);b.B0&&b.rva&&
uf.a.removeHandler(b.rva,"scroll",b.B0);b.Vv&&this.Bj.gha(b.Vv);b.Ig=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.rva=null;b.VMa=null;b.PCa=null;b.Hga=null;b.B0=null;b.Vv=null;b.Ued=null;b.gfd=null;r&&b.Vra&&(b.aZf?b.zkg=!0:b.Vra(b.I_d))}n$a(b,h){var r;if(!h)return!1;switch(h.actionType){case tq.b.Toggle:if(h.objectFulfillment===pp.Dnp)return this.Y8e=!this.Y8e,this.yMg(),this.vZc(b),!0;if(h.objectFulfillment===pp.Hnp)return{value:r}=this.RMd.Ec(h.suggestionGroup.type,
!1),this.RMd.W(h.suggestionGroup.type,!r),this.vZc(b),!0;break;case tq.b.GiveFeedback:if(RJ.a.Jjn(null===(r=h.suggestionGroup)||void 0===r?void 0:r.type)||SJ.a.Aun(h.objectName))break;this.focus();this.yMg();this.vZc(b);return!0;case tq.b.RevealSuggestions:this.vZc(b)}b.aZf=!0;h=b.QUk.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.aZf=!1;h&&this.vZc(b);b.zkg&&(b.zkg=!1,b.Vra(b.I_d),b.I_d=null);return h}vZc(b){b.Hga&&b.documentElement&&b.VUa&&(this.ml.xc(zd.a.mua,b.documentElement,b.Hga),b.VUa=
!1)}K6o(b,h){return b.id===QJ.a.fmb?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}jEe(b){var h;if(this.I2o(b)){var r=1;y.AFrameworkApplication.J.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(r=3);var A=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(A=b.definition.suggestionGroups[0].type,A=this.RMd.mb(A)?this.RMd.K(A):b.V8o);h=!1;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",!1)&&(h=!0);r={containerElement:b.container,
targetElement:b.target,definition:b.definition,onAction:M=>this.n$a(b,M),onDismiss:M=>{this.tRb(b,M)},keepCurrentFocus:b.TXa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.Y8e,showDescription:A,showEditorButton:b.BUj,showEditorBranding:this.K6o(b.definition,b.BUj),hostServices:b.hostServices,maxSuggestionGroupNumber:r,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.Bmi,showDictationCommandUx:b.showDictationCommandUx,editingElement:b.editingElement};
b.Kqj&&b.Kqj(r);this.tB.createContextualUi(r).then(M=>{this.Qoo(b.definition,b.source);b.Ig=M;v.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.pUj&&b.pUj();this.f5b&&9!==b.source&&this.f5b.execute(ba=>ba.TOj(!0,b.showDictationCommandUx))}).catch(M=>{this.tRb(b,{aVp:tL.a.Unknown});v.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",M)});0<b.Fqe&&v.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.Fqe)}else 5<++b.Fqe?(v.ULS.sendTraceTag(50968330,
341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Gb.Yb(new wc.a(2,1,Math.pow(3,b.Fqe),()=>{b.isDismissed||this.jEe(b)},146))}get GI(){return!!this._state&&!this._state.isDismissed}SLg(b,h){this.GI&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.GI?this._state.definition:null}set definition(b){this.GI&&(this._state.definition=b,this._state.Ig&&this._state.Ig.setDefinition(b))}focus(){this.GI&&this._state.Ig&&(this._state.isFocused||
this.gog(this._state),this._state.Ig.focus())}yMg(){this.GI&&this._state.Ig&&this._state.Ig.updatePosition()}gog(b){this.Zb.WN(pp.T3d,!1);b.isFocused=!0}Ona(b,h,r,A,M,ba=null,oa=null,Ja=null,jb=!1,zb=null,Eb=!1,Sb=!0,nc=null,Dc=!1,Zc=10){if(!h||this._state&&!this._state.isDismissed)return!1;let Gd,de;if(!({paragraphNode:de,start:b,end:Gd}=pp.nrp(b)).returnValue)return!1;this._state=new UJ(de,b,Gd,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc);this.jEe(this._state);return!0}R_b(b){this._state&&(this._state.I_d=
b)}zZc(b,h,r){if(1===r)return this.GI?32:0;this.GI&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.Ig)||void 0===b?void 0:b.dismiss())}static TGn(b,h,r){r=new iF(r);b.logAction({actionType:tq.b.SessionStart,engagement:tq.a.Try,objectName:pp.u0j,objectId:h.id,data:r});if(h.suggestionGroups)for(const A of h.suggestionGroups)b.logAction({actionType:tq.b.Presented,engagement:tq.a.See,objectName:A.type,objectId:A.id,data:r})}static SGn(b,h,r,A){r=
new iF(r);b.logAction({actionType:tq.b.SessionEnd,engagement:tq.a.None,objectName:pp.u0j,objectId:h.id,data:r},A)}static FXc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static Nfl(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static Otj(b,h,r,A){const M=r.y-A,ba=r.x+r.width+A,oa=r.y+r.height+A;return r.x-A<=b&&b<=ba&&M<=h&&h<=oa}static nrp(b){let h,r;if(!b||!Ed.ParagraphReader.Vb(b.node)||b.contextId!==mc.a.Vc&&b.contextId!==mc.a.Fd&&b.contextId!==
mc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};r=b.node;b.contextId!==mc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=r.characterData.length);return{returnValue:!0,paragraphNode:r,start:h,end:b}}frc(){this.X5&&this.X5.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}pp.TUk="ActionSet";pp.u0j="IntentGroup";pp.T3d="CanvasContextualUxReact";pp.Dnp="Context";pp.Hnp="Description";pp.U8f="MenuDidOpen";pp.Ndj="MenuDidClose";Object(u.a)(pp,"UxManager",null,[]);class jF{constructor(){this.Z=
null}get name(){return"WordEditor.CanvasContextualProvider"}uc(b){this.Z=b}init(){this.Z.resolve(23).Qr.continueWith(()=>{this.No()})}No(){const b=y.AFrameworkApplication.J.$("EditorGoalsEnabled"),h=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",!1);(this.Z.resolve(23).isFeatureEnabled(54)||Lk.a.MLa||y.AFrameworkApplication.J.$("RewriteIsEnabled")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.Z.resolve(78).$D.loadScript("canvasContextual")).then(()=>{this.Z.ia(999,()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:y.AFrameworkApplication.uiCulture,dataCulture:y.AFrameworkApplication.dataCulture,isRightToLeft:y.AFrameworkApplication.isRtl,
ulsLogger:new Do.a,dimeCallback:async()=>{this.Z.resolve(4).launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.Z.Ra(791).execute(r=>{r.P7i()})},getSoftPaywallData:()=>this.Z.resolve(997),getPremiumPreviewCritiquesList:()=>this.Z.resolve(998),logSystemInitiatedFeedback:async r=>{this.Z.Ra(2).execute(A=>A.logActivity(r,null))}})).ha();this.Z.ia(1001,()=>new pp(rd.FocusManager.instance(),this.Z.resolve(327),this.Z.resolve(999),Object(Jb.a)(),kc.KeyInputManager.instance,y.AFrameworkApplication.oc,
y.AFrameworkApplication.ta,y.AFrameworkApplication.ta.e9,this.Z.Ra(2),this.Z.Ra(1E3))).ha();this.Z.resolve(999);this.Z.resolve(1001);b&&(this.Z.ia(1002,()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:y.AFrameworkApplication.uiCulture,ulsLogger:new Do.a})).ha(),this.Z.resolve(1002).init(),this.Z.ia(1003,()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new Do.a})).ha(),this.Z.resolve(1003),h&&(this.Z.ia(1004,()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new Do.a})).ha(),
this.Z.resolve(1004)))}).catch(r=>{v.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",r)})}dispose(){}static main(){E.a.instance.Mc(new jF)}}Object(u.a)(jF,"PackageManager",null,[0,1]);class VJ{constructor(b,h,r,A){this.Pbn=(M,ba,oa)=>{M=null;ba.view.ue&&(M=ba.view);if(!M||!M.lb)return 8;if(!this.XK.VZf())return 2;if(1===oa)return 32;this.BJk.mGl();return 32};this.Ecj=(M,ba,oa)=>{let Ja=null;ba.view.ue&&(Ja=ba.view);if(!Ja||!Ja.lb)return 8;
if(!this.XK.VZf())return 2;if(1===oa)return 32;if(1!==this.XK.klc(this.ib.gb,!0).count)return 2;ba=new Qb.GraphTransaction(15);try{if(ba.Ab(Ja.qd),!this.XK.tsp(M===Hc.a.m8f))return 8}finally{ba&&ba.dispose()}return 32};this.ga=b;this.ib=h;this.XK=r;this.BJk=A}Wb(){this.ga.qa(Hc.a.Xbe,mc.a.view,this.Pbn);this.ga.qa(Hc.a.m8f,mc.a.view,this.Ecj);this.ga.qa(Hc.a.Fcj,mc.a.view,this.Ecj)}}Object(u.a)(VJ,"IntelligentPlaceholderActor",null,[]);class WJ{constructor(){this.jEc=new fb.a;this.lyd=new fb.a}OVk(b,
h){let r;({value:r}=this.jEc.Ec(b,r)).returnValue||this.jEc.W(b,r=new Pa.a);r.add(h)}tWk(b,h){this.lyd.mb(b)&&v.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.lyd.W(b,h)}NVk(b,h,r){this.OVk(b,h);this.tWk(h,r)}skm(b){let h;return({value:h}=this.jEc.Ec(b,h)).returnValue?h:null}znm(b){let h;return({value:h}=this.lyd.Ec(b,h)).returnValue?h:null}JCo(b){let h;if(({value:h}=this.jEc.Ec(b,h)).returnValue){for(const r of h)this.lyd.remove(r);this.jEc.remove(b)}else v.ULS.sendTraceTag(50954436,
323,15,"No bookmarks found for user ID")}}Object(u.a)(WJ,"IntelligentPlaceholderAtMentionManager",null,[541]);var DH=d(1686);class EH extends DH.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get Jv(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}VTj(b){return!b.ka(Rc.a.FI,!1)}MVa(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(u.a)(EH,"IntelligentPlaceholderDetailsProvider",DH.a,[]);var gA=d(1842),ck=d(2099),Sg=d(1846);class FH{constructor(){this.IFa=
""}Vla(b){this.IFa+=b}pWf(b){this.IFa+=b}Pbe(b){this.IFa+=b}enc(b){this.IFa+=b}ZVf(b){this.IFa+=b}}Object(u.a)(FH,"PlainTextFormatCreator",null,[1807]);var XJ=d(1563),YJ=d(2098);d(329);var kF=d(1562),dD=d(1410);class rw{constructor(){this.GGc=new fb.a}contains(b){return this.GGc.mb(rw.P2f(b))}add(b){this.GGc.W(rw.P2f(b),b)}remove(b){this.GGc.remove(rw.P2f(b))}Dup(b){for(const h of b.GGc)this.add(h.value)}wmi(){const b=new qb.a;for(const h of this.GGc)b.add(h.value.pk);return b}static P2f(b){return b.pk.toString()}}
Object(u.a)(rw,"CommentRangeSet",null,[]);class zB extends Sys.EventArgs{constructor(b){super();this.lL=b}}Object(u.a)(zB,"OnFollowUpEventArgs",Sys.EventArgs,[]);class AB extends zB{constructor(b,h){super(b);this.Udo=h}}Object(u.a)(AB,"OnCreateEventArgs",zB,[]);class hA extends zB{constructor(b,h){super(b);this.hsn=h}}Object(u.a)(hA,"OnResolveEventArgs",zB,[]);var BB=d(219);class iA{}iA.aIe="MentionExperienceDegraded";Object(u.a)(iA,"AtMentionsConstants",null,[]);class GH{constructor(b,h,r,A,M,ba,
oa,Ja,jb,zb){this.udd=b;this.obl=h;this.vrd=r;this.QUd=A;this.lb=M;this.fq=ba;this.rce=oa;this.LTi=Ja;this.Gw=jb;this.Jdc=zb;this.uZa=null;this.g4n=(Eb,Sb,nc)=>{v.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Eb=this.rce.U$a(Eb,nc.displayName,nc.email,nc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,Sb),!0);Eb?v.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.Jdc.logKpiFailure("LPPWordEditorKPI",
"FailedToInsertAtMention",{isInternal:!0},{name:iA.aIe,isInternal:!0})};this.T2n=(Eb,Sb)=>{v.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");Sb&&this.Jdc.$w(Hc.a.ynl);this.rce.QXm(Eb.id,Sb)};this.SZn=()=>{this.fq.Ad.vz&&!this.fq.Ad.LX&&this.fq.Ke.Czf?this.c0h=!0:(this.udd.reset(),v.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};this.t5n=()=>{v.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.uZk()};this.S2n=(Eb,Sb,nc,Dc=new Map)=>
{Dc=Object.assign(new bb.a,{extendedProperties:Dc});this.Jdc.logKpiFailure("LPPWordEditorKPI",Eb,{isIntentional:Sb,isInternal:nc,additionalValues:Dc},{name:iA.aIe,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:Sb,isInternal:nc,additionalValues:Dc})};(b=$a.a.instance.Oa(223))&&b.addHandler(BB.a.$Ha,this.PJo.bind(this))}pfe(){return!!this.uZa}PJo(){this.pfe()&&this.c0h&&(this.uZa.updateInputText(this.Vad,!1),this.c0h=!1)}ariaNotify(b,h){this.Gw.sendNotification(b,h)}uZk(){const b=this.fq.Ke.editingElement;
if(b){var h=b.getAttribute(Pe.a.OTc);b.setAttribute(Pe.a.OTc,h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else v.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}VBo(){const b=this.fq.Ke.editingElement;if(b){var h=b.getAttribute(Pe.a.OTc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(Pe.a.OTc,h.join(" ")):b.removeAttribute(Pe.a.OTc)):v.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else v.ULS.sendTraceTag(51218126,
323,15,"Cannot find editing element")}Xrl(){this.VBo();this.uZa&&this.uZa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.uZa=null;this.LTi.fOj(!0)}Ete(){this.udd.Grg(()=>{this.Xrl()});this.udd.vrg((b,h)=>{this.Vad=b;if(this.uZa)1<this.Vad.length&&"@"===this.Vad.trimEnd()?(this.Jdc.$w(Hc.a.xnl),this.udd.reset()):this.uZa.updateInputText(this.Vad,!1);else if(this.Jdc.logKpiUsage("LPPWordEditorKPI",0),this.Jdc.$w(Hc.a.B7n),(b=this.Jwm(h))&&
b.height){h=b.y;const r=b.height,A=document.createElement("div");A.id="PeoplePicker";A.style.position="absolute";A.style.top=h-5+"px";A.style.left=b.x+"px";A.style.height=r+10+"px";document.body.appendChild(A);this.obl.createPeoplePicker({editingElementId:this.fq.Ke.editingElement.id,containerElement:A,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.g4n,onPermissionsReceivedCallback:this.T2n,onDismiss:this.SZn,onShow:this.t5n,onFailure:this.S2n}).then(M=>{M.updateInputText(this.Vad,
!1);this.uZa=M;this.LTi.fOj(!1)})}});this.udd.wrg(b=>{if(this.uZa)this.uZa.onKeyDown(b.Nb.rawEvent)})}Jwm(b){var h=this.lb.gb;if(!h)return null;h=h.currentSelection;if(!h)return null;h=h.Qa;if(!h)return null;h=h.node;if(!h)return null;h=Object(Ma.a)(221,h);if(!h)return null;h=Object(Ma.a)(326,h.Wl(this.fq.Ad.sc));if(!h)return null;h=Object(Ma.a)(163,h);if(!h)return null;let r=null;try{r=this.vrd.t2(this.QUd.Jjc(2,b),h,!1,!1,!1,!1)}catch(A){v.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",
A)}return r}}Object(u.a)(GH,"WordEditorAtMentionsHandler",null,[419]);var Zu=d(1396);class zr{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc){this.ga=b;this.$c=h;this.rSa=r;this.ib=A;this.Tq=M;this.Qd=ba;this.oF=oa;this.UDd=Ja;this.Xd=jb;this.oq=zb;this.Xok=Sb;this.Fi=nc;this.Qc=Eb;this.sa=new Fd.a;this.uj=Dc;this.G9g=Zc;dD.a.ogf((Gd,de)=>{this.FI(de.lL,!0)&&this.sa.raiseEvent(zr.afd)})}OPh(b){this.sa.addHandler(zr.ukj,b)}F2k(b){this.sa.addHandler(zr.Lnj,b)}l2k(b){this.sa.addHandler(zr.I1n,b)}ogf(b){this.sa.addHandler(zr.afd,
b)}FI(b,h){let r=b.ka(Rc.a.FI,!1);h&&(r=r&&!b.ka(Rc.a.Kea,!1));return r}Joc(b){return this.Tq.Joc(b)}DDm(b){for(const h of b)for(const r of h)if(zr.b2f(r.contextId))return r.node.Ic;return null}dLm(b,h,r){const A=new rw,M=b.Ic;for(let ba=0;ba<b.ra.length;ba++){const oa=b.ra.K(ba);if(oa.cp>=h)break;if(oa.mf&&oa.mf.length)for(let Ja=0;Ja<oa.mf.length;Ja++){const jb=oa.mf.K(Ja);this.FI(M.Eb(jb.pk),r)&&(jb.Uc?A.add(jb):A.remove(jb))}}return A}eLm(b,h,r,A){const M=new rw,ba=b.Ic;for(let oa=0;oa<b.ra.length;oa++){const Ja=
b.ra.K(oa);if(Ja.cp>r)break;if(Ja.mf&&Ja.mf.length)for(let jb=0;jb<Ja.mf.length;jb++){const zb=Ja.mf.K(jb);this.FI(ba.Eb(zb.pk),A)&&(zb.Uc?Ja.cp<r&&M.add(zb):Ja.cp<=h&&M.remove(zb))}}return M}JGi(b,h){let r;const A=b.node;b.contextId!==mc.a.paragraph?(r=b.cpBegin,b=b.cpEnd):(r=0,b=A.characterData.length);return r===b?this.dLm(A,r,h):this.eLm(A,r,b,h)}K4c(b,h){return zr.b2f(b.contextId)?this.JGi(b,h).wmi():new qb.a}klc(b,h){const r=new rw;for(const A of b)for(const M of A)zr.b2f(M.contextId)&&r.Dup(this.JGi(M,
h));return r.wmi()}VZf(){var b=this.ib.gb;if(!b||1!==b.length||1!==b.K(0).length)return!1;b=b.K(0).Qa.node;return Ed.ParagraphReader.Vb(b)&&!Ed.ParagraphReader.Hza(b)&&this.Tq.btb(this.ga,!0)?!0:!1}NSi(b,h){if(!this.VZf())return null;if(this.Tq.SZm())return v.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let r=!1;var A=this.ib.gb.K(0).Qa;A.contextId===mc.a.Vc?(b=b?Le.a.c7(A,!1):null)&&b.Lw&&b.Qa.contextId===mc.a.Fd?this.ib.Kc(b):(this.Qd.Ue(A,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+
" ",!0),this.ib.Kc(sc.SelectionFactory.rL(A.node,A.cpBegin,A.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):r=!0;this.uj.BNb||gA.a.instance.O7c();b=this.Tq.Xfc(this.ib.gb.currentSelection);if(!b)return null;this.Joc(b)&&this.G9g.$w(La.a.xMa,{succeeded:!0,Jfb:29});var M=this.$c.lg(b);const ba=M.Ub(1);if(!ba||ba.wc!==rn.a.dY)return null;M=M.Ub(2);if(!M||M.wc!==rn.a.paragraphNode)return null;this.NLg(b.Ic,b.id);this.sa.raiseEvent(zr.ukj,new AB(b,h));r&&(h=
A.node,A=A.contextId!==mc.a.paragraph?A.cpEnd:h.characterData.length,this.ib.Kc(sc.SelectionFactory.rL(h,A,A)));return b}Xbe(b){return!!this.NSi(!0,b)}a8c(b,h,r,A,M,ba){if(0>h)return!1;A="@"+A;const oa=A+" ",Ja=new Qb.GraphTransaction(15);try{Ja.Ab(b);this.Qd.Ue(vc.a.createTextRange(b,h,r),oa);this.Xd.Ag&&(this.oq.opf(b,h,h+A.length),this.oq.Hna(b,h+A.length,h+oa.length,1));const jb=this.oF.CF(vc.a.createTextRange(b,h,h+A.length),"mailto:"+M,!1,!0,!1);if(!jb)return!1;const zb=jb.Hw;if(!zb)return v.ULS.sendTraceTag(51217483,
323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.ib.Kc(sc.SelectionFactory.rL(b,h,h+A.length));const Eb=this.NSi(!1,2);if(!Eb)return!1;ba&&this.UDd.NVk(ba,zb,Eb.id);this.ib.Kc(sc.SelectionFactory.ve(b,h+oa.length))}finally{Ja&&Ja.dispose()}return!0}U$a(b,h,r,A){const M=this.ib.Ng;return Le.a.qf(M)?this.a8c(M.node,M.cpBegin-b,M.cpBegin,h,r,A):!1}cHm(b){if(1===b.length&&b.K(0).Lw&&(b=b.K(0).Qa,b.contextId===mc.a.Vc&&Ed.ParagraphReader.Vb(b.node))){const h=b.node;for(let r=0;r<
h.ra.length;r++){const A=h.ra.K(r);if(A.cp===b.cpBegin){b=A.t8d(!0,!0);if(0<b.length)return b[0].pk;break}}}return null}DMb(b,h,r){return this.Tq.xXc(b,h,r).returnValue}T4d(b,h,r,A,M){let ba=!1;const oa=b.characterData;if(h>=oa.length||r>oa.length||r<h)return{returnValue:!1,BVa:ba};let Ja=h,jb=null;for(let Eb=0;Eb<b.ra.length;Eb++){const Sb=b.ra.K(Eb),nc=Sb.cp;if(!(nc<h)){if(Sb.yn&&jb)try{const Dc=oa.substring(Ja,nc),Zc=new ck.a;Zc.fullName=Dc.startsWith("@")?Dc.substr(1):Dc;kF.a(jb.url,jb.Hw,Zc);
const Gd=new Sg.a;kF.b(jb.Hw,Gd);M&&(Gd.contentId=this.Xok.fGf());A.Pbe(Dc,Zc,Gd);ba=!0;jb=null;Ja=nc}catch(Dc){var zb=Object.assign(new bb.a,{extendedProperties:new Map});zb.extendedProperties.set("exception",Dc.message);this.G9g.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:zb},{name:iA.aIe,isInternal:!0,additionalValues:zb})}nc<=r&&!jb&&(zb=Math.min(nc,r),zb>Ja&&A.Vla(oa.substring(Ja,zb)),Ja=nc);Sb.hyperlink&&Sb.hyperlink.DI&&(jb=Sb.hyperlink);if(nc>=
r)break}}return{returnValue:!0,BVa:ba}}mti(b,h,r,A,M=-1){var ba=!1,oa=b.Eb(h),Ja=b.Eb(Zu.k(oa));oa=b.Eb(Zu.h(oa));M=0<M?M:Number.MAX_VALUE;b=this.DMb(Ja,h,!0);h=this.DMb(oa,h,!1);if(-1===b||-1===h)return{returnValue:!1,BVa:ba};if(Ja===oa)return this.T4d(Ja,b,h,r,A);const jb=this.rSa.EUa(Ja,!1,!1);if(!jb)return{returnValue:!1,BVa:ba};Ja=new qb.a;let zb=0;do Ja.add(jb.JA),zb+=jb.JA.characterData.length;while(jb.JA!==oa&&jb.Hla()&&zb<M);for(M=0;M<Ja.count;M++)if(ba=Ja.K(M),oa=ba.characterData,M)if(M===
Ja.count-1){if(!({BVa:ba}=this.T4d(ba,0,h,r,A)).returnValue)return{returnValue:!1,BVa:ba}}else{if(!({BVa:ba}=this.T4d(ba,0,oa.length,r,A)).returnValue)return{returnValue:!1,BVa:ba};r.Vla("\n")}else{if(!({BVa:ba}=this.T4d(ba,b,oa.length,r,A)).returnValue)return{returnValue:!1,BVa:ba};r.Vla("\n")}return{returnValue:!0,BVa:ba}}S4d(b,h){const r=new FH;return this.mti(b,h,r,!1,-1).returnValue?r.IFa:null}e2d(b,h){var r=b.Eb(h);if(!r)return null;b=b.Eb(Zu.h(r));if(!b)return null;h=this.DMb(b,h,!1);if(-1===
h)return null;r=b.characterData;if(h>=r.length||!C.a.mga(r.charAt(h))){r=this.Qc.Lc(15);try{r.Ab(b),this.Qd.Ue(vc.a.Tc(b,h)," ")}finally{r&&r.dispose()}}return sc.SelectionFactory.ve(b,h+1)}NLg(b,h){const r=b.Eb(h),A=new XJ.a;this.mti(b,h,A,!0).returnValue&&(A.Vla("\n"),this.Tq.$6j(r,A.DQa),this.sa.raiseEvent(zr.H6n))}vQo(b,h){for(const r of b){if(r.contains(h))return!0;for(const A of r)for(const M of h)if(A.node===M.node&&A.Jj>=M.Jj)return!0}return!1}WYc(b,h,r,A,M){const ba=this.ib.gb.clone(),oa=
new Yt.a(qa.StaticActiveAppFrame.za().kb.Jc);b=sc.SelectionFactory.ve(b,h);r=vc.a.Tc(r,A);b=sc.SelectionFactory.Yy(b,r);this.ib.Kc(b);r=!this.vQo(ba,b);return 32===this.ga.Pf(oa,ub.a.RJ,2,!0,null,null)?(r?this.ib.P0(ba):M!==P.a.nil&&(M=this.e2d(this.Fi.value,M),this.ib.Kc(M)),!0):!1}wAo(b,h){var r=b.Eb(h);const A=b.Eb(Zu.k(r));b=b.Eb(Zu.h(r));if(A===b){r=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var M=A.characterData.indexOf(r);-1!==M&&this.WYc(A,M,b,M+r.length,
h)}}wei(b,h,r){var A=b.Eb(h);if(!A)return!1;const M=b.Eb(Zu.k(A));b=b.Eb(Zu.h(A));A=this.DMb(M,h,!0);const ba=this.DMb(b,h,!1);if(-1===A||-1===ba||!this.WYc(M,A,b,ba,P.a.nil))return!1;r&&this.Hei(h);return!0}Hei(b){this.Tq.Bsg(b,!0)}tsp(b){var h=this.DDm(this.ib.gb);if(!h)return!1;const r=this.klc(this.ib.gb,!0);if(1!==r.count)return!1;const A=h.Eb(r.K(0));if(b)h=this.wei(h,r.K(0),!1);else{const M=Zu.k(A),ba=Zu.h(A);P.a.xt(M,ba)||v.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");
this.HCl(r.K(0));h.Eb(M).fm(16,!0);h=!0}h&&(A.setValue(Rc.a.Kea,!0),this.sa.raiseEvent(zr.Lnj,new hA(A,b)));return h}YVh(b,h){b=this.klc(this.ib.gb,!1);h.Rm[zr.ngi]=!!b.count}Klj(b,h){if(h.Rm[zr.ngi]&&Ed.ParagraphReader.Vb(h.clone)&&(h=h.clone,b=h.Ic)&&(h=vc.a.createTextRange(h,0,h.characterData.length),h=this.K4c(h,!1),h.count))for(const r of h)(h=b.Eb(r))&&h.setValue(Rc.a.FI,!1)}ipm(b,h,r){let A;const M=({DVc:jb}=this.Tq.xXc(h,r,!0)).returnValue;r=({DVc:A}=this.Tq.xXc(h,r,!1)).returnValue;let ba=
null,oa=-1,Ja=-1;for(;jb<A;jb++){const zb=h.ra.K(jb);if(zb.hyperlink&&zb.hyperlink.DI&&zb.hyperlink.Hw===b){ba=zb.hyperlink;oa=zb.cp;break}}if(!ba||oa<M)return{returnValue:!1,b9h:oa,a9h:Ja};for(b=jb;b<h.ra.length;b++){var jb=h.ra.K(b);if(jb.cp>r)break;if(jb.zX){Ja=jb.cp;break}}return{returnValue:-1!==Ja,b9h:oa,a9h:Ja}}xBo(b){var h=this.UDd.znm(b);if(h){var r=null;qa.StaticActiveAppFrame.za()&&(r=qa.StaticActiveAppFrame.za().kb.ed.ud);if(r){var A=r.Eb(h);h=r.Eb(Zu.k(A));var M=r.Eb(Zu.h(A));if(h!==
M)v.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({b9h:b,a9h:M}=this.ipm(b,h,A.id)).returnValue){var ba=new Qb.GraphTransaction(7);try{ba.Ab(h);const oa=vc.a.createTextRange(h,b,M);this.Qd.Ue(oa,"");this.NLg(r,A.id)}finally{ba&&ba.dispose()}this.ib.gb&&0<this.ib.gb.length?(r=this.ib.gb.K(0).Qa,r.node===h?v.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",r.cpBegin,b):v.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):
v.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.ib.Kc(sc.SelectionFactory.ve(h,b))}else v.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else v.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else v.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}QXm(b,h){if(!h){h=this.UDd.skm(b);if(!h){v.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");
return}for(const r of h)this.xBo(r)}this.UDd.JCo(b)}him(){gA.a.instance.O7c();const b=new qb.a;for(const r of this.Tq.Hhf)if(r.Gr!==YJ.a.kE){var h=P.a.Af(r.objectId);h=this.Fi.value.Eb(h);this.FI(h,!0)&&b.add(h)}return b}WPo(b){b=this.Tq.YNf(b);this.ib.Kc(b)}HCl(b){b?this.Fi.value.Eb(b).setValue(Rc.a.FI,!1):v.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static b2f(b){return b===mc.a.Fd||b===mc.a.Vc||b===mc.a.paragraph}}zr.ngi="DisableNestedIntelligentPlaceholder";
zr.ukj="CreateIntelligentPlaceholder";zr.Lnj="ResolveIntelligentPlaceholder";zr.H6n="UpdateIntelligentPlaceholder";zr.afd="DeleteIntelligentPlaceholder";zr.I1n="MentionAddedToFollowUpEventKey";Object(u.a)(zr,"IntelligentPlaceholderEditor",null,[537,538,539]);class ZJ{constructor(b,h,r,A){this.xxa=!1;this.Ns=!0;this.oe=null;this.Smb=M=>{if(!this.Ns||!this.rml(M,this.ib.gb))return!1;M.Nb.preventDefault();M.Nb.stopPropagation();this.od.Ad&&this.od.Ad.J_c(!1);M=this.e2d(this.ib.gb);if(!M)return!1;this.ib.Kc(M);
return!0};this.od=b;this.Fi=h;this.ib=r;this.h$=A}Udc(b,h){this.xxa||(b.QBa?(this.Tmb(h),this.xxa=!0):b.Sja(()=>{this.xxa||(this.Tmb(h),this.xxa=!0)}))}dispose(){this.oe&&this.oe.xc(zd.a.jL,this.od.Ke.editingElement,this.Smb)}Tmb(b){this.oe=b;this.od.Ad.jj&&this.oe.nb(zd.a.jL,this.od.Ke.editingElement,this.Smb)}rml(b,h){if(b.Nb.keyCode!==rf.a.wz&&b.Nb.keyCode!==rf.a.Tu||1!==h.length||!h.K(0).Lw)return!1;var r=this.h$.klc(h,!0);if(1!==r.count)return!1;const A=h.K(0).Qa.node;if(!Ed.ParagraphReader.Vb(A))return!1;
b=this.h$.DMb(A,r.K(0),!0);r=this.h$.DMb(A,r.K(0),!1);return h.K(0).Qa.cpBegin<b||h.K(0).Qa.cpEnd>r?!1:!0}e2d(b){b=this.h$.klc(b,!0);if(1!==b.count)return null;b=b.K(0);return this.h$.e2d(this.Fi.value,b)}fOj(b){this.Ns=b}}Object(u.a)(ZJ,"IntelligentPlaceholderKeyboardListener",null,[399,11]);class sw{constructor(b,h){this.Rdn=r=>{1===r&&this.ga.Ob(La.a.xMa,2);2===r&&(this.sDh.instance?this.sDh.instance.PAc("https://go.microsoft.com/fwlink/?linkid=2154656")&&C.a.QX("https://go.microsoft.com/fwlink/?linkid=2154656")&&
window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):v.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));r=[Object.assign(new fa.a,{name:"DialogResult",int64:r})];$b.d(Hc.a.kqi,void 0,void 0,void 0,void 0,void 0,r)};this.ga=b;this.sDh=h}mGl(){const b=new kh.StandardDialog;b.Ed=11;b.Qe(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.Qe(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.Mx(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,
WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.Rdn);$b.a("FollowUpsPhaseOutDialogShown")}}Object(u.a)(sw,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var lF=d(1368);class HH{constructor(b,h,r,A,M,ba){this.y$=this.u4e=null;this.m8=()=>{this.y$||(this.y$=new wc.a(3,1,0,()=>{this.y$=null;this.H$d(this.ib.gb)},130),this.Gb.Yb(this.y$))};this.Qc=b;this.XK=h;this.ib=r;this.Gb=A;this.Mbf=M;this.Fi=ba;this.C5=new Ll.a;this.sr=new lF.a;this.kzh=new pk.a(this.C5);this.XK.OPh((oa,
Ja)=>{this.BZk(Ja.lL)})}BZk(b){b=b.id;const h=this.IEi(this.Fi.value,b);h&&this.sr.W(b,h)}IEi(b,h){const r=b.Eb(h);return!r||this.XK.Joc(r)?null:this.XK.S4d(b,h)}Jgl(b){const h=new lF.a;var r=this.XK.klc(b,!0);if(!r)return h;b=this.Fi.value;for(const A of r)(r=this.IEi(b,A))&&h.W(A,r);return h}Bsg(b){if(this.u4e){const h=this.Qc.Lc(15);try{h.Ab(this.Mbf()),this.XK.Hei(this.u4e)}finally{h&&h.dispose()}}this.u4e=b?this.XK.cHm(b):null}rYm(b){const h=this.Fi.value;if(b=b?this.Jgl(b):new lF.a){var r=new pk.a(this.C5),
A=new pk.a(this.C5);HH.rsm(this.sr,b,r,A);for(var M of r)this.sr.W(M,b.K(M));for(const ba of A)if(r=this.sr.K(ba),A=this.XK.S4d(h,ba),this.sr.remove(ba),A&&(b=M=!1,Wa.a.j5c().equals(A,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,r=!1):r=-1<A.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?M=!0:!Wa.a.j5c().equals(r,A),r||M||b)){A=this.Qc.Lc(15);try{A.Ab(this.Mbf()),b?this.XK.wei(h,ba,!0):(M&&this.XK.wAo(h,ba),r&&this.XK.NLg(h,ba))}finally{A&&
A.dispose()}}}}$Fm(b){const h=new pk.a(this.C5);for(const r of b)for(const A of r)b=A.node,Ed.ParagraphReader.Vb(b)&&h.add(b.id);return h}JWm(b){var h=this.Fi.value;const r=b?this.$Fm(b):new pk.a(this.C5);if(r){b=new qb.a;for(const ba of this.kzh)if(!r.contains(ba)){var A=h.Eb(ba);if(A){A=A.ra;for(let oa=0;oa<A.length;oa++){const Ja=A.K(oa).mf;if(Ja)for(let jb=0;jb<Ja.length;jb++){var M=Ja.K(jb);M.Uc&&(M=h.Eb(M.pk))&&M.ka(Rc.a.T3i,!1)&&P.a.xt(ba,Zu.h(M))&&this.XK.Joc(M)&&b.add(M)}}}}this.kzh=r;if(b.count){h=
this.Qc.Lc(7);try{h.Ab(this.Mbf());for(const ba of b)ba.Vf(Rc.a.T3i)}finally{h&&h.dispose()}}}}H$d(b){this.Bsg(b);this.rYm(b);this.JWm(b)}S_h(){this.y$&&(this.Gb.uf(this.y$),this.y$=null)}FWb(){if(this.y$||this.Fi.WSf)this.S_h(),this.H$d(null)}YE(){this.ib.BA(this.m8);y.AFrameworkApplication.JH(()=>{this.FWb()})}dispose(){this.ib.hha(this.m8);this.S_h()}static rsm(b,h,r,A){for(const M of h){const ba=M.key;b.mb(ba)||r.add(ba)}for(const M of b)b=M.key,h.mb(b)||A.add(b)}}Object(u.a)(HH,"IntelligentPlaceholderSelectionCache",
null,[11]);var Ss;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.lbl=2]="atMention";b[b.sqq=3]="textGesture";b[b.paste=4]="paste";b[b.wMp=5]="workItemIntent";b[b.LXp=6]="characterTrigger"})(Ss||(Ss={}));Object(u.b)("IntelligentPlaceholderCreation",Ss);class Gv{constructor(b,h,r,A){this.$Fa=b;this.In=h;this.c5b=r;this.Ez=A}bze(b){return b&&b.Ic&&b.Ic.id.equals(this.Ez.value.ud.id)?!0:!1}mTj(b){return this.bze(b)&&b.ka(Rc.a.FI,!1)?!0:!1}nHn(){this.c5b.execute(b=>{b.logAction({actionType:tq.b.SessionStart,
engagement:tq.a.Offer,objectName:Gv.Gzc})})}pie(b,h){const r=2==h&&this.bze(b);if(this.mTj(b)||r){var A=b.getValue(Rc.a.eH);this.c5b.execute(M=>{M.logAction({actionType:tq.b.Created,engagement:tq.a.None,objectName:Gv.Gzc,objectId:A.toString(),objectFulfillment:Ss[h]})})}}lFn(b){if(this.mTj(b)){var h=b.getValue(Rc.a.eH);this.c5b.execute(r=>{r.logAction({actionType:tq.b.Deleted,engagement:tq.a.None,objectName:Gv.Gzc,objectId:h.toString()})})}}QHn(b,h){if(this.bze(b)){var r=b.getValue(Rc.a.eH);this.c5b.execute(A=>
{A.logAction({actionType:tq.b.Resolved,engagement:tq.a.None,objectName:Gv.Gzc,objectId:r.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}IIn(b){b===Hc.a.Xbe&&this.c5b.execute(h=>{h.logAction({actionType:tq.b.Deleted,engagement:tq.a.None,objectName:Gv.Gzc,objectFulfillment:Gv.Skp})})}RGn(b){if(this.bze(b)){var h=b.getValue(Rc.a.eH);this.c5b.execute(r=>{r.logAction({actionType:tq.b.Modified,engagement:tq.a.None,objectName:Gv.Gzc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}vdl(){this.nHn();
this.$Fa.OPh((b,h)=>{this.pie(h.lL,h.Udo)});this.$Fa.F2k((b,h)=>{this.QHn(h.lL,h.hsn)});this.$Fa.l2k((b,h)=>{this.RGn(h.lL)});this.In.adc((b,h)=>{this.IIn(h.actionId)});dD.a.ogf((b,h)=>{this.lFn(h.lL)})}}Gv.Gzc="IntelligentPlaceholder";Gv.Skp="Undo";Object(u.a)(Gv,"IntelligentPlaceholderTelemetry",null,[]);class eD{constructor(){this.h$=this.FFd=this.fMd=this.Z=null}get name(){return"WordEditor.IntelligentPlaceholder"}uc(b){this.Z=b;b.ia(1008,()=>new sw(y.AFrameworkApplication.va,b.Ra(65))).ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new WJ).as(1006).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new zr(y.AFrameworkApplication.va,new zk.a,b.resolve(352),b.resolve(327),b.resolve(1005),b.resolve(323),b.resolve(82),b.resolve(1006),b.resolve(46).instance,b.resolve(39).instance,b.resolve(42),b.resolve(384),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed.ud),b.resolve(745),this.Z.resolve(1007))).as(1009).as(702).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").ha();
b.ia(1010,()=>new VJ(y.AFrameworkApplication.va,b.resolve(327),b.resolve(702),b.resolve(1008))).ha();b.ia(1012,()=>new HH(b.resolve(42),b.resolve(1009),b.resolve(327),y.AFrameworkApplication.oc,()=>qa.StaticActiveAppFrame.za().kb.Jc.qd,new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed.ud))).ha();b.ia(1013,()=>new ZJ(Object(Jb.a)(),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed.ud),b.resolve(327),b.resolve(1009))).as(1016).ha();b.ia(1011,()=>new Gv(b.resolve(1009),b.resolve(50),b.Ra(999),new Pf.a(()=>
qa.StaticActiveAppFrame.za().kb.ed))).ha()}init(){this.Z.resolve(23).Qr.continueWith(()=>{this.No()})}No(){const b=this.Z.resolve(23);this.Z.Ra(1001);this.Z.resolve(1010).Wb();this.Z.resolve(1011).vdl();this.h$=this.Z.resolve(1009);$w.a.h1k(Object(F.a)(this.h$,this.h$.YVh,"beforeIntelligentPlaceholderPaste"));$w.a.JRd(Object(F.a)(this.h$,this.h$.Klj,"onIntelligentPlaceholderPaste"));this.fMd=this.Z.resolve(1012);b.isFeatureEnabled(90)||this.fMd.YE();this.FFd=this.Z.resolve(1013);this.FFd.Udc(qa.StaticActiveAppFrame.za().kb,
kc.KeyInputManager.instance);this.Zwo(this.Z.Ra(325),this.Z.resolve(164),this.Z.resolve(762))}dispose(){this.fMd&&this.fMd.dispose();this.FFd&&this.FFd.dispose();this.h$&&($w.a.TCo(Object(F.a)(this.h$,this.h$.YVh,"beforeIntelligentPlaceholderPaste")),$w.a.wDo(Object(F.a)(this.h$,this.h$.Klj,"onIntelligentPlaceholderPaste")))}Zwo(b,h,r){b&&b.execute(A=>{A.nY(new EH(h,r))})}static main(){E.a.instance.Mc(new eD)}}Object(u.a)(eD,"PackageManager",null,[0,1]);var Ts=window.FindReplaceTaskPaneData={name:"CommandUI",
attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",
LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",
attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",
QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",
QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},tw=d(2163),fD=d(2156),ot=d(2111);class $u{}$u.Jdp="Search_16x16x32";$u.Bdp="ClosePaneGlyph_16x16x32";Object(u.a)($u,"SearchBoxIcons",null,[]);var iy=d(2114),jA=d(2115),Bs=d(2113);class mF{constructor(){this.$hh=null}get key(){return"FIND_HIT"}get Jv(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.$hh=
b.node.YVa()}MEa(b){let h=null;for(const r of this.$hh)if(r.Dc<=b&&b<r.end)return h=Object.assign(new Ow.a,{fG:this.key,contentObject:r}),{returnValue:!0,OG:h};return{returnValue:!1,OG:h}}}Object(u.a)(mF,"FindHitDetailsProvider",null,[144,136]);var wo=d(1626),CB=d(1524),nF=d(1585),DB=d(1632);class uw{constructor(b,h,r,A,M,ba,oa,Ja=null,jb=null){this.$m=null;this.find=(zb,Eb,Sb,nc,Dc)=>1===Sb?32:void 0===Dc||null===Dc?8:Dc.length?this.vFg(Dc):(this.Mnf(ot.a.initial),32);this.Kic=(zb,Eb,Sb,nc,Dc)=>
this.uVj(Hc.a.Yyb,zb,Eb,Sb,nc,Dc);this.p9l=(zb,Eb,Sb,nc,Dc)=>this.uVj(Hc.a.Zyb,zb,Eb,Sb,nc,Dc);this.Noi=(zb,Eb,Sb)=>1===Sb?32:this.vFg(this.np.UVa());this.Iid=(zb,Eb,Sb,nc,Dc)=>{zb=!this.np.nI;Dc[wm.a.Image16by16Class]=zb?ag.getImageClass($u.Jdp):ag.getImageClass($u.Bdp);Dc[wm.a.LabelText]=zb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Dc[wm.a.ApplyLabelTextToControlOnly]=!0;Dc[wm.a.EnsureControlRoleIsButton]=!0;Dc[wm.a.On]=!1;
return 32};this.u$l=(zb,Eb,Sb)=>{if(1===Sb)return 32;this.lLi(!1);return 32};this.E$l=(zb,Eb,Sb)=>{if(1===Sb)return 32;this.lLi(!0);return 32};this.Xog=(zb,Eb,Sb,nc,Dc)=>{Dc[al.a.Visible]=this.np.BVj;return 32};this.ipg=(zb,Eb,Sb,nc,Dc)=>{Dc[al.a.Visible]=this.np.BVj;return 32};this.b$d=(zb,Eb,Sb,nc,Dc)=>{if(1===Sb)return 32;this.KC.Tld.sLi(Dc);return 32};this.LUd=(zb,Eb,Sb)=>{if(1===Sb)return 32;this.Mnf(ot.a.initial);return 32};this.aWc=(zb,Eb,Sb)=>{if(1===Sb)return 32;this.Mnf(ot.a.initial);this.np.mA(!1);
return 32};this.CIa=(zb,Eb,Sb)=>{if(1===Sb)return this.Mhn(zb===La.a.k3h);this.np.CIa();return 32};this.bFe=(zb,Eb,Sb)=>{if(1===Sb)return 32;switch(zb){case La.a.FDf:this.np.matchCase=!this.np.matchCase;break;case La.a.YDf:this.np.matchWholeWord=!this.np.matchWholeWord}return this.vFg(this.np.UVa())};this.Bre=(zb,Eb,Sb,nc,Dc)=>{Dc[Ng.a.On]=this.np.matchCase;return 32};this.Dre=(zb,Eb,Sb,nc,Dc)=>{Dc[Ng.a.On]=this.np.matchWholeWord;return 32};this.Gog=(zb,Eb,Sb,nc,Dc)=>{zb=this.np.matchCase;Eb=this.np.matchWholeWord;
Sb="";zb&&Eb?Sb=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):zb?Sb=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):Eb&&(Sb=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Dc[Lh.a.Value]=Sb;Dc[Lh.a.Visible]=zb||Eb;return 32};this.Yuc=
(zb,Eb,Sb,nc,Dc)=>{zb=this.np.J5;Eb="";switch(this.np.nI){case ot.a.pYj:Eb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case ot.a.QKj:Eb=zb?this.zNf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case ot.a.Xxb:Eb=this.zNf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case ot.a.bia:Eb=this.zNf(this.np.LLa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);
break;case ot.a.EYa:Eb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case ot.a.Mvc:Eb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case ot.a.Lvc:Eb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Dc[Lh.a.Value]=Eb;return 32};this.Cre=(zb,Eb,Sb,nc,Dc)=>{Dc&&(Dc.CommandValueId=this.np.UVa());return 32};this.replace=(zb,Eb,Sb,nc,Dc)=>{if(1===Sb)return this.E0f()?32:8;if(!this.E0f())return 8;zb=this.np.OQb();"string"===typeof Dc&&Dc&&(zb=Dc);v.ULS.sendTraceTag(6033813,
312,50,"Replace Called");$b.a("NavigationPaneReplace");Dc=this.KHb.replace(zb);this.np.LTo(Dc);return 32};this.replaceAll=(zb,Eb,Sb,nc,Dc)=>{if(1===Sb)return this.psn()?32:8;zb=this.np.OQb();"string"===typeof Dc&&Dc&&(zb=Dc);$b.a("NavigationPaneReplace");this.$m=this.Zd.Xf("UserAction","ReplaceAll");this.np.jaa(ot.a.Mvc);v.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");nF.a.JFo(this.np.UVa(),this.np.OQb());this.KHb.replaceAll(zb,this.e4n);return 32};this.e4n=(zb,
Eb)=>{this.$m&&(this.$m.stop(),this.$m=null);v.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:zb,["TotalCount"]:Eb});nF.a.GFo(zb,Eb);this.np.jaa(ot.a.Lvc)};this.wxj=(zb,Eb,Sb,nc,Dc)=>{Eb=!1;if(!Dc)return 8;this.np.Qj.isVisible&&(Eb=zb===Hc.a.bjd===this.np.E4c());zb!==Hc.a.bjd||this.nqh||(Eb=!1);Dc[Ng.a.On]=Eb;return 32};this.Hog=(zb,Eb,Sb,nc,Dc)=>{if(!Dc||!this.np.Qj.isVisible)return 32;Dc[Ng.a.On]=this.np.LLa;return 32};this.Jog=(zb,Eb,Sb,nc,Dc)=>{if(!Dc)return 32;Dc.currentFindReplaceViewType=
this.np.nI;return 32};this.Cmo=(zb,Eb,Sb,nc,Dc)=>{if(1===Sb)return 32;zb=Dc[Ng.a.On];Dc&&(Dc[Ng.a.On]=this.np.Qj.isVisible);zb&&!Dc[Ng.a.On]&&(uw.w3j(),$b.a("NavigationPaneCrossClick"));return 32};this.w0a=(zb,Eb,Sb,nc,Dc)=>{const Zc=this.np.Qj.isVisible;v.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",Zc);return Zc?this.aWc(zb,Eb,Sb,nc,Dc):this.iyc(zb,Eb,Sb,nc,Dc)};this.iyc=(zb,Eb,Sb,nc,Dc)=>{if(1===Sb)return fc.SessionStatusManager.instance.cB?32:8;if(2===Sb){uw.w3j();this.y8();wo.FindReplaceUIManager.Zjl(zb,
Dc,this.np.Qj.isVisible);Eb=!0;zb===Hc.a.myc&&void 0!==Dc&&null!==Dc&&(Eb=Dc);this.np.mA(!0,Eb);Dc=Bs.a.initial;switch(zb){case Hc.a.jyc:v.ULS.sendTraceTag(42501022,367,50,"");Dc=Bs.a.headings;break;case Hc.a.Yyb:Dc=Bs.a.find;break;case Hc.a.Zyb:Dc=Bs.a.replace;break;case Hc.a.myc:Dc=Bs.a.intelligentPlaceholder;break;case Hc.a.w0a:Dc=this.np.ygc,Dc||(v.ULS.sendTraceTag(42501023,367,50,""),Dc=Bs.a.headings)}Dc!==Bs.a.find&&Dc!==Bs.a.replace||uw.pqp();this.np.GYo(Dc,Eb);DB.a.esp();return 32}return 8};
this.GMa=()=>{this.np.nI&&!this.np.LLa&&v.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.np=h;this.KC=r;this.KHb=A;this.nqh=M;this.Zd=oa;jb&&jb(1,this.GMa,null);this.hRa=Ja}y8(){}Wb(){this.ga.fb(Hc.a.ypg,mc.a.view,this.Cmo,96);this.ga.qa(Hc.a.w0a,mc.a.view,this.w0a);this.ga.qa(Hc.a.jyc,mc.a.view,this.iyc);this.ga.qa(Hc.a.Yyb,mc.a.view,this.iyc);this.ga.qa(ub.a.KDf,mc.a.view,this.find);this.ga.qa(La.a.Kic,mc.a.view,this.Kic);this.ga.qa(ub.a.JDf,mc.a.view,this.Noi);
this.ga.fb(La.a.cmo,mc.a.view,this.Iid,97);this.ga.qa(ub.a.ocg,mc.a.view,this.u$l);this.ga.qa(ub.a.Cmg,mc.a.view,this.E$l);this.ga.fb(ub.a.Xog,mc.a.view,this.Xog,97);this.ga.fb(ub.a.ipg,mc.a.view,this.ipg,97);this.ga.qa(Hc.a.b$d,mc.a.view,this.b$d);this.ga.qa(ub.a.Gec,mc.a.view,this.LUd);this.ga.qa(La.a.CIa,mc.a.view,this.CIa);this.ga.qa(La.a.k3h,mc.a.application,this.CIa);this.ga.qa(Hc.a.aWc,mc.a.view,this.aWc);this.ga.qa(La.a.FDf,mc.a.view,this.bFe);this.ga.qa(La.a.YDf,mc.a.view,this.bFe);this.ga.fb(La.a.Bre,
mc.a.view,this.Bre,97);this.ga.fb(La.a.Dre,mc.a.view,this.Dre,97);this.ga.fb(Hc.a.Gog,mc.a.view,this.Gog,97);this.ga.fb(Hc.a.Yuc,mc.a.view,this.Yuc,97);this.ga.fb(Hc.a.Hog,mc.a.view,this.Hog,97);this.ga.fb(Hc.a.Jog,mc.a.view,this.Jog,97);this.ga.fb(Hc.a.Iog,mc.a.view,this.wxj,97);Object(CB.b)()&&this.ga.fb(Hc.a.Cre,mc.a.view,this.Cre,96);this.nqh&&(this.ga.fb(Hc.a.Zyb,mc.a.view,this.iyc,1028),this.ga.fb(Hc.a.bjd,mc.a.view,this.wxj,97),this.ga.fb(Hc.a.replace,mc.a.view,this.replace,1028),this.ga.fb(Hc.a.replaceAll,
mc.a.view,this.replaceAll,1028),y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)&&this.ga.fb(La.a.RDf,mc.a.view,this.p9l,1028));this.ga.qa(Hc.a.myc,mc.a.view,this.iyc)}irg(){this.hRa&&this.hRa.execute(b=>{b.nY(new mF)})}uVj(b,h,r,A,M,ba){if(1===A)return fc.SessionStatusManager.instance.cB?32:8;if(void 0===ba||null===ba)return 8;this.iyc(b,r,2,M,ba);b=this.np;b.Czg(ba.CommandValueId);
Object(CB.b)()&&("MatchCase"in ba&&(b.matchCase=ba.MatchCase),"MatchWholeWord"in ba&&(b.matchWholeWord=ba.MatchWholeWord));return this.Noi(h,r,A,M,ba)}vFg(b){if(void 0===b||null===b||!b.length)return 32;b=iy.a.createQuery(b,this.hmo);if(void 0===b||null===b)return v.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.KC.find(b);return 32}get hmo(){let b=jA.a.none;this.np.matchCase&&(b|=jA.a.matchCase);this.np.matchWholeWord&&(b|=jA.a.aPg);return b}lLi(b){this.np.ygc!==Bs.a.headings&&this.np.J5&&
(b?this.KC.Tld.iUm():this.KC.Tld.nLi())}Mnf(b){this.np.nI&&(this.np.LLa||v.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.KC.M6a(),this.np.jaa(b))}Mhn(b){return this.np.nI===ot.a.Mvc||b&&!this.np.nI?8:32}zNf(b){return String.format(b,this.np.gzd,this.np.J5)}E0f(){return this.np.E4c()&&0<this.np.J5}psn(){return this.E0f()&&this.np.LLa}static w3j(){null!=y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>
{const b=$a.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},uw.eAa)}static ytm(b,h,r,A){return new uw(y.AFrameworkApplication.va,b,h,r,A,rd.FocusManager.instance(),qa.StaticActiveAppFrame.za().$r,$a.a.instance.Ra(325),Object(F.a)(y.AFrameworkApplication.ta.HS,y.AFrameworkApplication.ta.HS.nb,"registerHandler"))}static pqp(){null==y.AFrameworkApplication.J||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)||window.setTimeout(()=>{const b=$a.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("FindReplaceExperienceSurvey",null)})},uw.eAa)}static xtm(b,h,r,A){return uw.ytm(b,h,r,A)}}uw.eAa=5E3;Object(u.a)(uw,"FindReplaceActor",null,[]);var IH=d(908),cz=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.OM},set:function(h){this.OM=h},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"last",{get:function(){return this.q3a},enumerable:!1,
configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,r){this.removeItem(h);r={key:h,AH:this.q3a,next:void 0,data:r};this.first||(this.first=r);this.q3a&&(this.q3a.next=r);this.q3a=r;this._map.set(h,r)};b.prototype.insertAfter=function(h,r,A){h=this._map.get(h);if(!h)return!1;A={key:r,AH:h,next:h.next,data:A};var M=h.next;M&&(M.AH=A);h.next=A;this._map.set(r,A);return!0};b.prototype.insertBefore=function(h,
r,A){h=this._map.get(h);if(!h)return!1;A={key:r,AH:h.AH,next:h,data:A};var M=h.AH;M&&(M.next=A);h.AH=A;this._map.set(r,A);return!0};b.prototype.removeItem=function(h){var r=this._map.get(h);r&&(this.first===r&&(this.first=r.next),this.q3a===r&&(this.q3a=r.AH),r.AH&&(r.AH.next=r.next),r.next&&(r.next.AH=r.AH),this._map.delete(h))};return b}();class JH{constructor(){this.type="heading"}}Object(u.a)(JH,"NavPaneHeadingItem",null,[]);class oF{constructor(){this.type="bookmark"}}Object(u.a)(oF,"NavPaneBookmarkItem",
null,[]);class EB{constructor(b,h,r,A,M,ba,oa){var Ja;this.hb=b;this.ib=h;this.Zb=r;this.Gp=A;this.lV=M;this.zJ=ba;this.czk=oa;this.x4a=0;this.RHd=new Map;this.blh=!1;this.uFa=new Map;this.KDd=null===(Ja=y.AFrameworkApplication.J)||void 0===Ja?void 0:Ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.InitialHeadingsInNavPaneFix",!1)}get headingsReady(){return this.blh}set headingsReady(b){this.blh=b}get xYb(){return this.x4a}get a4(){this.e4a&&0!=this.e4a.length()||(this.e4a=this.eho());return this.e4a}set a4(b){this.e4a=
b}get D_b(){return this.XMk}set D_b(b){this.D_b&&(this.D_b.isSelected=!1);b.isSelected=!0;this.XMk=b}WLf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}eho(){const b=new cz;if(!this.lV)return b;this.RHd=new Map;let h;const r=[];for(const A of this.lV.paragraphs()){const M=this.xCi(A,r);null===M||void 0===M?void 0:M.forEach(ba=>{(h=this.nEi(ba,r))&&"heading"===h.type&&h.indentLevel<ba.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,ba.isHidden=!1):(h.isCollapsed=!0,ba.isHidden=!0));b.insert(this.WLf(ba,
A),ba)})}return b}nEi(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}AMg(b){var h,r,A;let M=Ed.ParagraphReader.XAa(b),ba=!1;9===M&&this.uFa.has(b.id.toString())&&(M=this.uFa.get(b.id.toString()),ba=!0);y.AFrameworkApplication.nd("InitialHeadingsInNavPaneFix-tf;InitialHeadingsInNavPaneFix-cf");const oa=this.KDd?null===(r=null===(h=this.e4a)||void 0===h?void 0:h.get(b.id.toString()))||void 0===r?void 0:r.data:null===(A=this.a4.get(b.id.toString()))||void 0===
A?void 0:A.data;if(oa){if(oa.indentLevel===M){h=Pn.AParagraphNode.tV(b.characterData.trim());r=this.Gp.value.Djg(b);this.KDd&&this.YYi(b)&&this.yei(b);if(h!==oa.text||oa.hasBookmark!==r)return oa.text=h,oa.hasBookmark=r,!0;!ba&&oa.isPurelyADH&&(oa.isPurelyADH=!1,--this.x4a);return!1}this.Ohd();return!0}if(9===M)return this.sgn(b)?(this.Ohd(),!0):!1;this.Ohd();return!0}sgn(b){var h;const r=this.Gp.value.cui(b);b=null!==(h=this.RHd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==r.length)return!0;for(h=
0;h<b;++h)if(!this.a4.get(r[h].Dqb()))return!0;return!1}yei(b){var h;if((this.KDd?null===(h=this.e4a)||void 0===h?0:h.get(b.id.toString()):this.a4.get(b.id.toString()))||this.Gp.value.Djg(b))return this.Ohd(),!0;this.uFa.has(b.id.toString())&&(this.uFa.delete(b.id.toString()),--this.x4a);return!1}Ohd(){const b=new cz;this.x4a=0;if(this.lV){this.RHd=new Map;var h=[],r,A;for(const M of this.lV.paragraphs()){const ba=this.xCi(M,h);null===ba||void 0===ba?void 0:ba.forEach(oa=>{var Ja=this.WLf(oa,M);A=
this.nEi(oa,h);this.cKo(Ja,oa,A);b.insert(Ja,oa);"heading"===(null===r||void 0===r?void 0:r.type)&&(Ja=r,Ja.indentLevel>=oa.indentLevel&&(Ja.isCollapsed=void 0));r=oa})}this.KDd?this.e4a=b:this.a4=b}else this.a4=b}cKo(b,h,r){var A,M;if(b=null===(A=this.e4a.get(b))||void 0===A?void 0:A.data)b.isSelected&&(h.isSelected=!0,this.D_b=h),h.isHidden=b.isHidden;if(r){if(A=null===(M=this.e4a.get(this.WLf(r,r.paragraphNode)))||void 0===M?void 0:M.data)r.isCollapsed=A.isCollapsed;r.isCollapsed?h.isHidden=!0:
r.isHidden?(r.isCollapsed=!0,h.isHidden=!0):(r.isCollapsed=!1,h.isHidden=!1)}}xCi(b,h){var r=Ed.ParagraphReader.XAa(b),A=!this.YYi(b);const M=this.Cmn(r)&&A?!0:!1;A=this.uFa.has(b.id.toString())&&A;const ba=[];if(M)ba.push(this.z$h(b,r,!1,h));else if(A)this.x4a+=1,this.h0c&&(r=this.uFa.get(b.id.toString()),ba.push(this.z$h(b,r,!0,h)));else{let oa=0;this.Gp.value.cui(b).forEach(Ja=>{const jb=new oF;jb.text=Ja.Dqb();jb.isSelected=!1;jb.bookmarkManager=this.Gp;jb.indentLevel=0<h.length?h[h.length-1].indentLevel+
1:0;oa+=1;ba.push(jb)});this.RHd.set(b.id.toString(),oa)}return ba}z$h(b,h,r,A){var M,ba;const oa=new JH;oa.text=Pn.AParagraphNode.tV(b.characterData.trim());oa.indentLevel=h;oa.paragraphNode=b;oa.isSelected=!1;oa.isPurelyADH=r;oa.listMarker=this.mMf(b);oa.hasBookmark=this.Gp.value.Djg(b);for(b=null===(M=A[A.length-1])||void 0===M?void 0:M.indentLevel;b&&b>=h;)A.pop(),b=null===(ba=A[A.length-1])||void 0===ba?void 0:ba.indentLevel;(!b||b<h)&&A.push(oa);return oa}YYi(b){return this.hb.Vb(b)&&0===this.hb.textLength(b,
9)}ism(b){for(b=this.lV.Tkc(b);b;){let h=this.a4.get(b.node.id.toString());for(;h;){const r=h.data;if("heading"===r.type&&!r.isHidden)return r;h=h.AH}b=b.AH}}o5l(b){(b=this.a4.get(b))&&(1==b.data.isCollapsed?this.GVj(b):this.L1m(b))}onClickHeading(b){var h;this.D_b=b=null===(h=this.a4.get(b))||void 0===h?void 0:h.data;h=sc.SelectionFactory.ve(b.paragraphNode,0);this.ib.Kc(h);this.Zb.Eg(pd.AFrame.Jo)}onClickBookmark(b){var h;this.D_b=b=null===(h=this.a4.get(b))||void 0===h?void 0:h.data;this.Gp.value.eUm(b.text);
this.Zb.Eg(pd.AFrame.Jo)}bPi(b){var h,r;if(b=null===(r=null===(h=b.entries())||void 0===h?void 0:h.next())||void 0===r?void 0:r.value)if(h=this.ism(b[0]))this.D_b=h}onShareHeadingClick(b){var h;$b.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.a4.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Rc.a.Zc),this.czk.value.A$h(h)}KLg(b,h){const r=b.id.toString(),A=this.uFa.has(r);if(!A||this.uFa.get(r)!==h){this.uFa.set(r,h);if(this.h0c)return this.AMg(b);A||this.a4.get(r)||
(this.x4a+=1)}return!1}cRl(b){const h=b.id.toString(),r=this.uFa.has(h);if(r){this.uFa.delete(h);if(this.h0c)return this.AMg(b);r&&!this.a4.get(h)&&--this.x4a}return!1}ynp(b){this.h0c=b;this.Ohd()}jMg(b){var h;const r=null===(h=this.a4.get(b.id.toString()))||void 0===h?void 0:h.data;if(!r)return!1;b=this.mMf(b);if(r.listMarker===b)return!1;this.wwp();return!0}h_d(b){var h;b=null===(h=this.a4.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;
return!0}GVj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,b=r.next,r.data.isHidden=!1,"heading"==r.data.type&&(b=r.data.isCollapsed?this.Hbp(r):this.GVj(r));return b}L1m(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,b=r.next,r.data.isHidden=!0}Hbp(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}Cmn(b){return 0<=b&&8>=b}wwp(){let b=this.a4.first;
for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.mMf(h.paragraphNode)}b=b.next}}mMf(b){var h;if(b.qE instanceof IH.a)return this.TRm(null===(h=this.zJ.eYa(b.qE))||void 0===h?void 0:h.UU)}TRm(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(u.a)(EB,"NavPaneHeadingsManager",null,[]);var kA=d(1525);class jy{constructor(){this.KHb=this.KC=this.SHc=this.rBd=this.Z=null}get name(){return"WordEditor.FindReplace"}uc(b){var h;this.Z=
b;y.AFrameworkApplication.nd("ImprovedNavPaneDiscoverability;ImprovedNavPaneDiscoverabilityCf");(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedNavPaneDiscoverabilityIsEnabled",!1))&&DB.a.initialize(b.Ra(78),b.Ra(6),b.Ra(76),"WACViewPanelContainer");const r=new EB(b.resolve(164),b.resolve(327),rd.FocusManager.instance(),b.rf(457),b.resolve(418),b.resolve(244),b.rf(1014));this.Z.ia(728,()=>r).as(728).ha()}init(){jy.qc.Qr.continueWith(()=>
{this.No()})}No(){if(df.a.lPg){const b=df.a.NGe;this.SHc=wo.FindReplaceUIManager.getInstance(b);this.KC=fD.a.createInstance(this.SHc,tw.a.instance,kA.a.instance,!0);this.KHb=this.KC.KZb;this.rBd=uw.xtm(this.SHc,this.KC,this.KHb,b);this.rBd.Wb();this.rBd.y8();this.rBd.irg();qa.StaticActiveAppFrame.za().Fe()}}dispose(){this.SHc&&this.SHc.dispose()}static get qc(){return null!=jy.bWg?jy.bWg:jy.bWg=$a.a.instance.resolve(23)}}Object(u.a)(jy,"FindReplacePackageManager",null,[0,1]);class vw{constructor(){}fGf(){return"_@_"+
hb.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}rzp(b,h,r,A){h.MTo(b,A);h.Nl(b,ze.a.Qca,!0);h.Nl(b,Rc.a.KXa,!0);h.Nl(b,Rc.a.S2,vw.Dni(r));h.Nl(b,Rc.a.ht,15)}h4k(b,h,r,A){const M=b.qYd(A);h.Nl(M,ze.a.Qca,!0);h.Nl(M,Rc.a.ht,47);h.Nl(M,Rc.a.S2,vw.Dni(r));b=b.qYd(A);h.Nl(b,ze.a.Qca,!0);h.Nl(b,Rc.a.ht,16);return[M.Lk,b.Lk]}Vfm(b,h,r){b=b.qYd(r);h.Nl(b,ze.a.Qca,!0);h.Nl(b,Rc.a.aUb,!0);return b.Lk}static Dni(b){return String.format(' HYPERLINK "{0}"',b)}}Object(u.a)(vw,"AtMentionHyperlinkConfigurator",
null,[490]);var dz=d(1544);class gD{constructor(b,h,r){this.dja=b;this.ib=h;this.gNi=this.CVi=this.vXe=!1;this.VWb=this.VWb.bind(this);this.WWb=this.WWb.bind(this);this.gXb=this.gXb.bind(this);r&&r.execute(A=>{this.U1a=A});bt.a.iTd.VIf.then(A=>{this.gNi=!0;this.CVi=A.isSuccess})}Ete(){this.dja.vrg(this.VWb);this.dja.wrg(this.WWb);this.dja.Grg(this.gXb)}pfe(){return!1}VWb(b,h,r){var A,M;h=Date.now();if(this.U1a)if(this.gNi&&!this.CVi)v.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");
else{var ba=null===(M=null===(A=this.ib.gb)||void 0===A?void 0:A.currentSelection)||void 0===M?void 0:M.Wc;ba?(A=ba.node,Ed.ParagraphReader.Vb(A)?(M=Ed.ParagraphReader.text(A),0>r||r>M.length?v.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the prefix was not within the bounds of the paragraph."):1<b.length&&("@"===b.trimEnd()||dz.a.mvd&&"/"===b.trimEnd())?($b.c(Hc.a.DBl,!0,void 0,void 0,void 0,void 0),this.dja.reset()):(this.vXe?this.U1a.Tzp():(this.vXe=
!0,this.U1a.Dap(ba)),this.U1a.SLg(r,r+b.length),b=M.substring(0,r)+b,this.U1a.xGf(A,b,r,h))):v.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):v.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else v.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}WWb(b){if(this.U1a)this.U1a.onKeyDown(b)}gXb(){this.vXe=
!1;this.U1a&&this.U1a.U3h()}}Object(u.a)(gD,"ContextIQUserInitHandler",null,[419]);class ww{constructor(){this.tB=null}get name(){return"WordEditor.AtMentions"}uc(b){this.Z=b;b.ia(384,()=>new vw(b.resolve(23))).ha();const h={crewAlias:ww.Mek,featureName:ww.rgk,topLevelKpiName:ww.vkk,vetoPillar:7};b.ia(1007,()=>new at.a(za.Health.instance,new ao.a,h)).as(1007).ha()}init(){this.Z.resolve(23).Qr.continueWith(()=>{this.No()})}dispose(){}No(){this.Z.Ra(143).execute(b=>{b.atMentionsEnabledAsync().then(h=>
{y.AFrameworkApplication.J.$("ConsumerMentionsHostIsEnabled")&&(h=h&&y.AFrameworkApplication.J.$("WordEditorConsumerCanvasMentionsIsEnabled"));(h||dz.a.nvd())&&this.ECn()})});this.Z.resolve(384)}ECn(){(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.Z.resolve(78).$D.loadScript("canvasAtMentions")).then(()=>{y.AFrameworkApplication.J.xp(()=>{this.qvo()})})}qvo(){const b={peopleAPI:this.Z.resolve(143),localizationDetails:{isRightToLeft:y.AFrameworkApplication.isRtl,
appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.ovn()};this.tB=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.Z.Ra(4).execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(r=>{r&&dz.a.ovd()||!r&&dz.a.nvd()?(dz.a.bYf=!r,this.Z.ia(1017,()=>new gD(this.Z.resolve(292),this.Z.resolve(327),this.Z.Ra(1015))).ha()):this.Z.ia(1017,()=>new GH(this.Z.resolve(292),this.tB,this.Z.resolve(18),this.Z.resolve(212),this.Z.resolve(327),Object(Jb.a)(),this.Z.resolve(702),
this.Z.resolve(1016),this.Z.resolve(25),this.Z.resolve(1007))).ha();this.Z.resolve(1017).Ete()})})}ovn(){var b,h;const r=null!==(b=y.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(h=y.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return r===ww.oek&&b===ww.nek}}ww.oek="-4";ww.nek="DC2";ww.Mek="webasynccollabeng";ww.rgk="AtMentions";ww.vkk="AtMentionsFeatureUsage";Object(u.a)(ww,"PackageManager",null,[0,1]);var Yp=d(1698);class Us{constructor(b,
h,r,A){this.ga=b;this.Re=h;this._augLoopRuntimeManager=r;this.DTk=A;this.Aya=0;this.qQd=this.Eac=!1;this.vah=this.cCh=this.I0e=this.dCh=0;this.ECb=null;this.Quk=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0],["Rewrite",!0]]);this.Ctk=[{id:`${ew.Iuc}_${1}`},{id:`${ew.Iuc}_${2}`},{id:`${ew.Iuc}_${3}`},{id:mp.a.DZd},{id:mp.a.$Xd},{id:mp.a.Zgd},{id:mp.a.Xgd}];this.Knk=[{id:"OpenCopilotComposeDraftContent"},
{id:"OpenCopilotComposeRewrite"},{id:"OpenCopilotComposeVisualizeAsTable"},{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"Sort"},{id:"ResetPictureEdits"},{id:"ReviewDesignerSuggestion"}];this.iyd=new Map;this.znh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.vFk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",
8);this.Rqk=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Re.nb(this,Yp.SearchSuggestionAnnotation.getTypeName());(y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost"))&&this.iyd.set("InsertLink","InsertLinkFlyout");this.iyd.set("GraphicsEditor","");this.D6j();this.Wb(this.ga)}ojo(b,h){if(this.znh){var r=Date.now();this.I0e&&1250>r-this.I0e||this.KGb||(this.I0e=r,this.ECb=b,this.iNd=this.VMm(h),
this.RIo(),this.hHo())}}oH(b,h){if(b.annotationType===Yp.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===Q.a.getTypeName()&&(h=Date.now(),b=b.content,this.KGb&&this.KGb===b.correlationId)){window.clearTimeout(this.Aya);this.KGb=void 0;var r=this.Eac,A=this.SAm(b),M=A&&0<A.length;M&&(this.GAp(A),this.qQd&&(r=!1));r&&this.gFj();h={["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.cCh,["canvasContextRetrievalTime"]:this.vah,
["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.dCh,["containsZTM"]:M,["shouldFallBack"]:this.Eac,["fallBack"]:r};v.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}SAm(b){const h=this.COf(b.intentSuggestions,Yp.IntentIds.ZeroTermMenu,Yp.ObjectSemantic.GenericSuggestions,Yp.ObjectSchemaType.RankedSuggestion);return 1===h.length?h[0]:b.menuSuggestions}COf(b,h,r,A){return Array.isArray(b)?b.filter(M=>M.intent===h&&M.result.semantic===
r&&M.result.type===A).map(M=>M.result.value):[]}Wb(b){b.fb(La.a.r$i,mc.a.application,this.iHo.bind(this),96)}VMm(b){const h=[],r=new Map,A=Date.now();for(const M of b){if(!M)continue;b=[];const ba={itemsMetadata:new fb.a};for(let oa=0;oa<M.ControlList.length;oa++){const Ja=M.ControlList[oa];if(Ja&&!Ja.ExternalId)continue;b.push(Ja.ExternalId);const jb={timeStamp:A,source:"FallbackZeroTermMenu",confidenceScore:-1};ba.itemsMetadata[Ja.ExternalId]=jb;r.set(Ja.ExternalId,jb)}h.push(appChrome.api.menuSection(b,
M.Title,M.Lang,M.Id,ba))}return{sections:h,commands:r}}b3j(b){return this.iyd.has(b)?this.iyd.get(b):b}nPa(b){const h={};for(const r of b)b=this.b3j(r.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));qa.StaticActiveAppFrame.za().t4d(h)}din(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?!1:this.Quk.has(b)?this.iNd.commands.has(b):!0}Fbi(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,
null,null,{menuTargetType:this.ECb})}rqb(b=!1){b=b?Mn.a.instance.PHc:Mn.a.instance.rqb();const h=[],r=Date.now();for(const A of b)A.commandId&&h.push({Id:A.commandId,TimeElapsedSinceClick:(r-A.timeStamp)/1E3,ContentType:A.contentType,CommandSurface:A.commandSurface,InputMethod:A.fz});return h}C2c(){const b=Mn.a.instance.C2c(),h=[],r=Date.now();for(const A of b)A.controlId&&h.push({Id:A.controlId,TimeElapsedSinceClick:(r-A.timeStamp)/1E3,ContentType:A.contentType,CommandSurface:A.commandSurface,InputMethod:A.fz});
return h}OHf(){const b={semantic:Yp.ObjectSemantic.CanvasContext,type:Yp.ObjectSchemaType.WordCanvasContext,value:{contentType:this.ECb}};if(this.Rqk){const h=Date.now(),r=this.DTk.OHf($f.a.instance.gb.currentSelection);r&&r.value.contentType&&(b.value=r.value);this.vah=Date.now()-h}return b}lwi(){const b=this.C2c(),h=this.rqb(),r=this.rqb(!0),A=[];A.push({semantic:Yp.ObjectSemantic.ControlIdHistory,type:Yp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Yp.SequenceType.ControlId,Sequence:b}});
A.push({semantic:Yp.ObjectSemantic.CommandIdHistory,type:Yp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Yp.SequenceType.CommandId,Sequence:h}});A.push({semantic:Yp.ObjectSemantic.FilteredCommandIdHistory,type:Yp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Yp.SequenceType.CommandId,Sequence:r}});A.push(this.OHf());return A}D6j(){this._augLoopRuntimeManager.getSession().then(b=>this.dxd=b).catch(()=>{this.dxd=void 0})}hHo(){const b=Date.now(),h=this.lwi(),r=[Yp.IntentIds.ZeroTermMenu,
Yp.IntentIds.Logging];this.cCh=Date.now()-b;this.BZj(r,h,"ContextualMenu")}iHo(b,h,r){2===r&&(b=this.lwi(),this.BZj([Yp.IntentIds.Logging],b,"Floatie"));return 32}BZj(b,h,r){if(0===b.length||0===h.length)v.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var A=new Yp.SearchSuggestionSignal({correlationId:this.O2c("ACM"),intents:b,contextObjects:h,entryPoint:r});this.Eac=0<=b.indexOf(Yp.IntentIds.ZeroTermMenu);this.dCh=Date.now();this.KGb=A.correlationId;
this.Aya=window.setTimeout(()=>{this.l4n(A.correlationId)},750);h=new Q.l({parentPath:["Signal",Yp.SearchSuggestionSignal.getTypeName()],items:[{id:hb.a.create().toString(),body:A}]});this.dxd&&!this.dxd.isClosed?this.dxd.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.D6j());v.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:A.correlationId,["shouldFallBack"]:this.Eac,
["intents"]:b}))}}O2c(b){const h=hb.a.create().toString();appChrome.api.setOfeCorrelationId(b,h);return h}l4n(b){this.KGb&&this.KGb===b&&(this.KGb=void 0,this.Eac&&this.gFj(),v.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.Eac})))}gFj(){const b=this.Fbi(this.iNd.sections);appChrome.api.dispatch(b);this.G5h()}G5h(){this.qQd=!0}FAo(b){var h,r;const A=[],M=new Map;if(!b||0===b.length)return A;
for(const ba of b){if(!ba||!ba.controlIds||0===ba.controlIds.length)continue;b={controlIds:[],id:ba.id,title:ba.title,lang:ba.lang,data:{itemsMetadata:new fb.a}};const oa="CommandsZTM"===ba.id;for(const Ja of ba.controlIds){if(M.has(Ja))continue;if(oa&&b.controlIds.length>=this.vFk)break;const jb=null===(r=null===(h=ba.data)||void 0===h?void 0:h.itemsMetadata)||void 0===r?void 0:r[Ja];M.set(Ja,jb);b.controlIds.push(Ja);jb&&(b.data.itemsMetadata[Ja]=jb)}0<b.controlIds.length&&A.push(b)}return A}RIo(){this.qQd=
!1;if(this.znh){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}GAp(b){this.qQd||(b=this.Mgm(b),0<b.length&&appChrome.api.dispatch(b))}Mgm(b){const h=[];let r=[];var A=this.vGm();A&&0<A.length&&r.push(...A);(A=this.Mfm())&&r.push(A);Array.isArray(b)&&0<b.length&&(b=this.Sza(b))&&(b.id="CommandsZTM",r.push(b));(b=this.Bfm())&&r.push(b);r=this.FAo(r);if(0===r.length)return[];
h.push(this.Fbi(r));this.G5h();return h}vGm(){var b,h;const r=null===(b=this.iNd)||void 0===b?void 0:b.sections.filter(A=>{var M;return null===(M=A.id)||void 0===M?void 0:M.startsWith(ew.Lii)});for(const A of r)if(null===(h=A.data)||void 0===h?0:h.itemsMetadata)for(const M in A.data.itemsMetadata)A.data.itemsMetadata[M].source="PassThroughZeroTermMenu";return r}Mfm(){const b=this.fsi(this.Ctk,"DefaultZeroTermMenu");return this.Sza(b)}Bfm(){const b=this.fsi(this.Knk,"AdvertizedZeroTermMenu");return this.Sza(b)}fsi(b,
h){const r=[];for(const A of b)A&&this.O6o(A)&&this.iNd.commands.has(A.id)&&r.push({suggestion:A.id,rankingScore:-1,suggestionSource:h});return r}O6o(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}Sza(b){const h=[],r={itemsMetadata:new fb.a},A=Date.now();this.nPa(b);for(const M of b)b=this.b3j(M.suggestion),this.din(b)&&(h.push(b),r.itemsMetadata[b]={timeStamp:A,source:M.suggestionSource,confidenceScore:M.rankingScore});return 0<h.length?
appChrome.api.menuSection(h,null,null,null,r):null}}Object(u.a)(Us,"AugLoopSearchSuggestionManager",null,[155,395]);class hD{constructor(){this.Z=null}get name(){return"WordEditor.ContextualSearch"}uc(b){this.Z=b;this.Z.ia(1019,()=>new Us(y.AFrameworkApplication.va,this.Z.resolve(454),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.Z.resolve(1018))).as(1084).ha()}init(){this.Z.resolve(23).Qr.continueWith(()=>{bt.a.Bm().then(()=>{this.start()})})}start(){this.Z.resolve(1019)}dispose(){}static main(){E.a.instance.Mc(new hD)}}
Object(u.a)(hD,"PackageManager",null,[0,1]);var uL=d(445),Hv=d(943);class KH extends Hv.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(u.a)(KH,"BootMessage",Hv.a,[]);var LH=d(1046);class FB{constructor(){this.LO=null;this.O1n=b=>{if(b.target===this.LO)if(void 0===b.data||null===b.data)v.ULS.sendTraceTag(50739143,3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=G.a(b.data);this.xBe(h.api)?this.Rwd.K(h.api).Rje(h.method,
h):v.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){v.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.Rwd=new yf.a}t2f(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}create(b,h){let r=!1;try{this.LO=new Worker(b);this.LO.onmessage=this.O1n;const A=Object.assign(new KH,
{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(A);this.t2f()&&LH.a.qmk(this.LO);r=!0}catch(A){v.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",A)}return r}postMessage(b){try{const h=G.c(b);this.LO.postMessage(h)}catch(h){v.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}xBe(b){return this.Rwd.mb(b)}pVk(b,h){this.xBe(b)&&v.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",
b);this.Rwd.W(b,h)}hjm(b){return this.xBe(b)?this.Rwd.K(b):null}}Object(u.a)(FB,"WebWorker",null,[1558]);class GB{constructor(){this.BPg=[]}HMl(b,h){if(h){var r=y.AFrameworkApplication.rC(b.yKj,7),A=[];for(let M=0;M<b.w1b.length;M++){let ba;switch(b.w1b[M].format){case 5:case 6:ba=uL.a.SQb(b.w1b[M].name);break;default:ba=b.w1b[M].name}A.push(y.AFrameworkApplication.rC(ba,b.w1b[M].format))}try{const M=URL.createObjectURL(new Blob(["importScripts('"+r+"');"],{type:"application/javascript"})),ba=new FB;
if(ba.create(M,A))for(this.BPg.push(ba),r=0;r<b.wBe.length;r++){const oa=h.REl(ba,b.wBe[r]);oa&&ba.pVk(b.wBe[r],oa)}}catch(M){v.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",M.message)}}else v.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(u.a)(GB,"WebWorkerCollection",null,[]);class $J{constructor(b,h){this.tdf=new GB;if(b){b=b.create();for(let r=0;r<b.length;r++)this.tdf.HMl(b[r],h)}else v.ULS.sendTraceTag(50442779,
3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...r){let A=!1;for(let ba=0;ba<this.tdf.BPg.length;ba++){var M=this.tdf.BPg[ba];M.xBe(b)&&((M=M.hjm(b))?A=M.callMethod(h,r)||A:v.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}A||v.ULS.sendTraceTag(50442781,3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(u.a)($J,
"WebWorkerRouter",null,[1559]);class aK extends Hv.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(u.a)(aK,"SettingsMessage",Hv.a,[]);class xw{constructor(b){this.LO=b}}Object(u.a)(xw,"WebWorkerApiMain",null,[]);class bK extends xw{constructor(b){super(b)}t2f(){return!!y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return v.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.Jll(h);v.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",b);return!1}Rje(b,h){switch(b){case 14:this.aXm(h);break;default:v.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",
b)}}Jll(b){if(2!==b.length)return v.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return v.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}","object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new aK,{api:0,method:1,
appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:y.AFrameworkApplication.userSessionId,LocalCobaltSessionId:Wm.a.instance.YF,LocalCobaltMachineId:Wm.a.instance.Ama,LocalCobaltClusterId:Wm.a.instance.Zta,LocalCobaltSessionHasBackup:Wm.a.instance.$ta,WaciiEnabledRequests:Wm.a.instance.voa,SettingsRoutedToServer:Wm.a.instance.xBg,WacClusterId:y.AFrameworkApplication.Ge.c1});this.LO.postMessage(b);return!0}aXm(b){this.t2f()&&b&&b.result&&(v.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),
this.XEp())}async XEp(){try{const b=await new LH.a.rmk.WorkerUtilsTestClass(10);await b.Uh(5);15==await b.counter?v.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):v.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){v.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(u.a)(bK,"InitializeWorkerApiMain",xw,[]);class pF extends Hv.a{constructor(){super();this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=
null;this.appMode=pq.a.none;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(u.a)(pF,"CatchUpNetworkRequestWorkerRequestMessage",Hv.a,[]);class qF extends xw{constructor(b,h){super(b);this.gVc=h}callMethod(b,h){if(4===b)return b=Object.assign(new pF,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.LO.postMessage(b),!0;v.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",b);return!1}Rje(b,
h){switch(b){case 5:v.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.gVc.iUo(h);break;default:v.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(u.a)(qF,"CatchUpNetworkRequestWorkerExternalApi",xw,[]);class ky extends Hv.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=null}}Object(u.a)(ky,
"LocalInferenceMessage",Hv.a,[]);class Yj{constructor(){this.prediction=this.context=null}}Object(u.a)(Yj,"LocalInferenceOutput",null,[]);class xo{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(u.a)(xo,"TextPredictionConfig",null,[]);class Kt{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(u.a)(Kt,"TextPredictionSettings",null,[]);class vL{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(u.a)(vL,"TextPredictionDynamicPayload",
null,[]);class $g extends xw{constructor(b,h){super(b);this.JTk=h}callMethod(b,h){if(!h)return v.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.Pll(h);case 7:return this.Kll(h);case 9:return this.Oll(h);case 10:return this.Lll(h);case 13:return this.Mll(h);case 14:return this.Nll(h);default:return v.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}Rje(b,h){switch(b){case 9:this.hYm(h);break;default:v.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}hYm(b){b&&b.prediction&&(b=Object.assign(new Yj,{prediction:b.prediction,context:b.context}),this.JTk.nVh().Ajo(b))}Kll(b){if(1>b.length)return v.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new ky,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.LO.postMessage(b);return!0}Pll(b){if(1>b.length)return v.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new ky,{api:4,method:8,paragraphContent:b});this.LO.postMessage(b);
return!0}Oll(b){if(2>b.length)return v.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new ky,{api:4,method:9,paragraphContent:b,context:h});this.LO.postMessage(h);return!0}Lll(b){if(1>b.length)return v.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new ky,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.LO.postMessage(b);return!0}Mll(b){if(1>b.length)return v.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new ky,{api:4,method:13,textPredictionConfig:this.wxi(b)});this.LO.postMessage(b);return!0}Nll(b){if(1>
b.length)return v.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(Za.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new ky,{api:4,method:14,textPredictionConfig:this.wxi(b)});this.LO.postMessage(b);return!0}getConfig(b=null){return Object.assign(new xo,{scriptDirectory:y.AFrameworkApplication.W8+"/intelligence/",settings:Object.assign(new Kt,{extendedRankLimit:0}),modelFilesUrl:b})}wxi(b=
null){return Object.assign(new xo,{scriptDirectory:y.AFrameworkApplication.W8+"/intelligence/",settings:Object.assign(new Kt,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(u.a)($g,"LocalInferenceWorkerApiMain",xw,[]);class iD extends xw{constructor(b){super(b);y.AFrameworkApplication.JH(()=>{this.FWb()})}callMethod(b){v.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}Rje(b){v.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}FWb(){const b=Object.assign(new Hv.a,{api:3,method:6});this.LO.postMessage(b)}}Object(u.a)(iD,"ShutdownWorkerApiMain",xw,[]);class HB{constructor(b){this.container=b}REl(b,h){let r=null;switch(h){case 0:r=new bK(b);break;case 2:r=new qF(b,this.container.resolve(835));break;case 3:r=new iD(b);break;case 4:r=new $g(b,this.container.resolve(644));break;default:v.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",
h)}return r}}Object(u.a)(HB,"WordWebWorkerApiFactory",null,[397]);var cK=d(326);class jD{constructor(b,h){this.name=b;this.format=h}}Object(u.a)(jD,"ImportedScript",null,[]);class Qd{constructor(){this.wBe=this.w1b=this.yKj=null}}Object(u.a)(Qd,"WebWorkerConfig",null,[]);var rF=d(1331);class sF{constructor(b){this.YGh=[];this.kCk=b;if(y.AFrameworkApplication.J){b=y.AFrameworkApplication.J.$("AppChromeOverrideIsCombinedBundle")||y.AFrameworkApplication.J.$("IsCombinedBundleEnabled");const r=y.AFrameworkApplication.J.jb("ContentBaseUrl")?
6:5;var h=y.AFrameworkApplication.J.jb("AppScriptBaseName");const A=b?"":".";if(h){const M=b?"":"{0}";h+=`${A}${M}worker.js`;this.YGh.push(new jD(`MicrosoftAjax${b?"":"DS"}.${M}js`,r),new jD(h,r))}else v.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else v.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=[],h=
Object.assign(new Qd,{yKj:"workerboot",w1b:this.YGh,wBe:[0,2,3,4]});this.kCk&&this.nkn()&&h.w1b.push(new jD("intelligence/edge-inference-web.js",5));b.push(h);return b}nkn(){return(new cK.a("arrowFunction",()=>{try{Object(rF.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(u.a)(sF,"WordWebWorkerConfigFactory",null,[396]);class kD{constructor(){this.Ga=this.Z=null}get name(){return"WordEditor.Workers"}init(){const b=this.Z.resolve(219);b.sendMessage.apply(b,
[0,1].concat([this.Ga.appSettings,y.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}uc(b){this.Z=b;this.Ga=this.Z.resolve(71);const h=this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ia("Box4.Workers.WebWorkerRouter",()=>new $J(new sF(h),new HB(b))).as(219).ha()}static main(){E.a.instance.Mc(new kD)}}Object(u.a)(kD,"WordEditorWorkersPackage",null,[0,1]);var tF=d(1129);class MH{constructor(){this.hLd=[]}YFi(b,h){let r=-1,A=null;A=M=>{M?h(this.hLd[r]):
(++r,r<this.hLd.length?this.hLd[r].Dec(b,A):h(null))};A(!1)}Dec(b,h){this.YFi(b,r=>{h(!!r)})}Uvc(b,h,r){this.YFi(b,A=>{if(!A)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");A.Uvc(b,h,r)})}uOh(b){this.hLd.push(b)}}Object(u.a)(MH,"CompositeExternalContentURLResolver",null,[398,343]);var NH=d(1325);class IB extends NH.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=0;this.ProviderName=this.IFrameHtml=null}}Object(u.a)(IB,
"ExternalContentEmbedResponse",NH.a,[]);var OH=d(1350),dK=d(751),PH=d(1117),yw=d(1244),lA=d(714),ez=d(511),du=d(163),uF=d(869),av;(function(b){b[b.Zjf=0]="autoCorrect";b[b.U5l=1]="externalComponentPaste";b[b.e6l=2]="externalHyperlinkPaste";b[b.M1p=3]="externalContentFloatieConversion"})(av||(av={}));Object(u.b)("ExternalContentConversionContext",av);class Fh{constructor(){this.FUb=this.EUb=null;this.DCf=new yw.ExternalContentEmbedRetriever;this.XPc=!0;this.CHc=this.gp=this.NPi=this.MPi=this.Km=this.tt=
null;this.ohd=()=>{v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.fuc=()=>{v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=Fh.nsa&&Fh.nsa.nwi()}get C0b(){return this.XPc}set C0b(b){this.XPc=b}xnf(b,h){let r=!1;if(b){switch(b.contextId){case mc.a.Vc:r=!h;break;case mc.a.Fd:r=!0}r&&!uF.a(b.node)&&(r=!1)}return r}Ewn(b){const h=b.startsWith(Oc.a.Kuc),r=b.startsWith(Oc.a.zid),A=b.startsWith(Oc.a.sre);
return(h||r||A)&&Oc.a.PXa(b)}Uyj(){this.gp=P.a.create();Fh.Ff.SMb(this.gp,4);Fh.Ff.w8(this.gp,0,Fh.Ff.ap());this.ySb(this.EUb,3,this.FUb,!0)}SWa(b,h,r){this.gp=P.a.create();Fh.Ff.SMb(this.gp,r?0:2);Fh.Ff.w8(this.gp,0,Fh.Ff.ap());this.CHc();this.ySb(b,r?0:2,h)}Rpe(b,h){this.gp=P.a.create();Fh.Ff.SMb(this.gp,1);Fh.Ff.w8(this.gp,0,Fh.Ff.ap());this.ySb(b,1,h)}Wbe(b,h,r,A){if(!b||!b.isConnected||!je.a.Lt(b))return null;const M=new lA.a;M.setValue(Yf.a.Amc,r);M.setValue(Yf.a.KWa,h);M.p7a=this.MPi;M.Jv=
this.NPi;M.providerName=A;M.dbb=1===r;M.creationTime=Date.now();zc.a.Za(b).Wf(M,2);this.Tcd(M);return M}OAj(b){this.CHc=b}SIe(b,h){const r=Fh.z4.Vgc(h)||0;h=Fh.z4.X7a(h)||0;const A=b.Width/b.Height;1<=A?(b.Width=r,b.Height=r/A):(b.Height=h,b.Width=h/A)}gRg(b,h,r){if(null!=b&&null!=h&&!C.a.Uf(r)){var A=Fh.Ced.Pkc(r);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?A.Eva=!1:A.Eva=!0;A.hideFloatie=
!0;this.SIe(b,h.node);this.cnc(b,h,!1,!1,A,r)}}qrb(b){return b?b.He:0}ZNg(b,h,r){let A=null;const M=b.node;if(!Ed.ParagraphReader.Vb(M)||!M.isConnected)return{returnValue:!1,iwa:A};if(r)return{returnValue:!0,iwa:b};r=b.cpBegin;const ba=b.cpEnd,oa=Ed.ParagraphReader.text(M);if(0<=r&&ba<=oa.length&&oa.substring(r,ba)===h)return{returnValue:!0,iwa:b};const Ja=oa.indexOf(h);return 0<=Ja?(A=vc.a.createTextRange(M,Ja,Ja+h.length),{returnValue:!0,iwa:A}):0<=r&&ba<=oa.length&&this.amc(b)?{returnValue:!0,
iwa:b}:{returnValue:!1,iwa:A}}amc(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=vc.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Oc.a.VA(h,!1);if(1===h.length){h=h[0];const r=Ed.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}g2f(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}Ffb(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>{const r=
$a.a.instance.Ra(2);r&&r.execute(A=>{A.logActivity(b,h)})},Fh.eAa)}IJf(b,h){const r=!C.a.maa(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}ySb(b,
h,r,A=!1){if(this.Ewn(r)){var M=Fh.Ced.Pkc(r);if(M)if(this.g2f(M)){v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(Ma.a)(vc.a,b);var ba=!h;this.xnf(b,ba)?this.r9c(r)?(h=1===h,A=this.pum(b),M.hideFloatie=!0,this.cnc(A,b,ba,h,M,r)):this.jmg(b,h,M,r,A):Fh.Ff.rU(this.gp,2,"URL inserted in Non-Embedable context",Fh.Ff.ap())}else v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Fh.Ff.rU(this.gp,2,"Size provided is not valid for OEmbed",
Fh.Ff.ap())}else v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Fh.Ff.rU(this.gp,2,"URL inserted is not valid for ExternalContent",Fh.Ff.ap())}pum(b){const h=new IB;h.Width=Fh.z4.Vgc(b.node)||0;h.Height=Fh.z4.X7a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}r9c(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=Fh.F3&&Fh.F3.S2i(b)}jmg(b,h,r,A,M){const ba=
!h,oa=1===h,Ja=Fh.z4.Vgc(b.node)||0,jb=Fh.z4.X7a(b.node)||0,zb=OH.a.trf(r.rNg,!0,Ja,jb);this.pcd(b,A,h,!0);this.DCf.o1h(zb,Eb=>{Fh.Ff.w8(this.gp,4,Fh.Ff.ap());Fh.Ff.Rnd(this.gp,this.qrb(Eb.data));if(Eb=this.qmg(Eb)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Sb=du.q(Eb.MediaType);Fh.Ff.tte(this.gp,7,Sb);Sb=b;({iwa:Sb}=this.ZNg(b,A,oa)).returnValue?(this.pcd(Sb,A,h,!1),null==r.width?0<Ja&&Eb.Width>Ja&&(v.ULS.sendTraceTag(591681426,
324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Eb.Width=Ja):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Eb.Width=this.Ztd(r.width,Eb.Width,Ja)),null==r.height?0<jb&&Eb.Height>jb&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Eb.Height=jb):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),
Eb.Height=this.Ztd(r.height,Eb.Height,jb)),Fh.nsa.Dhb||M?this.cnc(Eb,Sb,ba,oa,r,A):(this.EUb=b,this.FUb=A,this.KXc(A))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Fh.Ff.rU(this.gp,2,"No conversion as the context is no longer valid for the external content conversion",Fh.Ff.ap()));oa&&this.Y6a(Sb.node)}else oa&&this.Y6a(b.node),Fh.Ff.rU(this.gp,1,"URL not oEmbedable",Fh.Ff.ap())},Eb=>{Fh.Ff.w8(this.gp,
4,Fh.Ff.ap());Fh.Ff.Rnd(this.gp,this.qrb(Eb.data));oa&&this.Y6a(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Eb.data.Ee);Fh.Ff.rU(this.gp,2,"ExternalContentEmbedRequest failed",Fh.Ff.ap())},Eb=>{oa&&this.Y6a(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Eb)},this.gp)}Ztd(b,h,r){!b&&0<r&&h>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),
h=r):b>r?h=r:b&&b<r&&(h=b);return h}cnc(b,h,r,A,M,ba){this.Km=hb.a.create();b.Width=b.Width/b.Height*(b.Height-(ez.a.q6c+ez.a.B6))+2*ez.a.B6;const oa=new Qb.GraphTransaction(15);oa.Ab(h.node);oa.Ei=Hc.a.SWa;const Ja=this.amc(h);null!=M.Eva&&!M.Eva||A||Ja||(b.Title=""===M.title||M.title?M.title:b.Title,!b.Title&&""!==b.Title)||(h=this.uWf(h,oa,b.Title,ba,r));if(h){A&&(h=this.Bwf(h));var jb=this.FYd(h,A);if(jb){r=du.q(b.MediaType);var zb=this.D8d(b,r);this.MPi=b.IFrameHtml;this.NPi=b.Title;if(jb=this.bWf(jb,
zb,oa,A,ba,r,b.ProviderName))oa.iMa(this.Km,1),oa.dispose(),this.EUb=h,this.FUb=ba,this.Mig(M,b,jb),this.Wlg(ba,A||M.hideFloatie,Ja,r,b.Title,b.ProviderName)}else oa.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Fh.Ff.rU(this.gp,2,"Could not create IP context on splitting the paragraph",Fh.Ff.ap())}else Fh.Ff.rU(this.gp,2,"GraphNodeContext is null",Fh.Ff.ap())}D8d(b,h){const r=new ji.DictionaryPropertySet;
Fh.VR.Kqe(r,b.Width,b.Height);b=this.HJf(h,b.Title);r.setValue(ze.a.imageAltText,b);r.setValue(Rc.a.BX,Lg.a.gG());r.setValue(Rc.a.imageType,qk.other);return r}bWf(b,h,r,A,M,ba,oa){if(!b)return null;b=Fh.VR.$be(b,h);if(!b)return r.dispose(),v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Fh.Ff.rU(this.gp,2,"The anchored image could not be inserted",Fh.Ff.ap()),null;r=b.node;M=this.Wbe(r,M,ba,oa);Fh.Ff.oMg(this.gp,M.id);A||this.tzg(r);
return r}Mig(b,h,r){C.a.maa(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Fh.Ff.w8(this.gp,8,Fh.Ff.ap()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.$_d(r,h.Thumbnail))}Wlg(b,h,r,A,M,ba){h||this.KXc(b);this.Ffb("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.Toe("IsHyperlinkWithNonURLDisplayText",r,ba);this.ariaNotify(A,M);Fh.Ff.w8(this.gp,5,Fh.Ff.ap())}Toe(b,h,r){v.ULS.sendTraceTag(591267585,
324,50,"OtelLogging: ExternalContent transaction successfully completed");ca.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new fa.a,{name:b,bool:h}),Object.assign(new fa.a,{name:"ProviderName",string:r})]}))}ariaNotify(b,h){this.C0b&&Fh.Gw&&(b=this.IJf(b,h),Fh.Gw.sendNotification(b,!0))}uWf(b,h,r,A,M){if(M){if((M=Oc.a.VA(b,!1))&&1!==M.length)return h.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),
null;Fh.Rp.rV(M[0].paragraph,M[0].hyperlink)}return this.$tg(b,r,A)}Bwf(b){const h=b.node,r=Ed.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=vc.a.createTextRange(h,0,r.length),Fh.Bg.Ue(b,""),vc.a.Tc(h,0)):b}FYd(b,h){return h?b:this.GKf(b)}GKf(b){const h=Ed.ParagraphReader.text(b.node),r=zc.a.Za(b.node);if(r.Ld()){b=vc.a.Tc(b.node,b.cpEnd);Ab.OutlineElementNavigator.ke(r);const A=Fh.Of.eta(r);Fh.Rh.Jca(r,A,b,!0,!0,!0,!0);""!=h&&Fh.Rh.gz(r,!1,!0);r.$d();return vc.a.Tc(r.currentNode,
0)}return null}qmg(b){if(!({group:b}=Ck.a.N4(b.data.Ee)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}$tg(b,h,r){const A=b.cpBegin+h.length;Fh.Bg.Ue(b,h);b=vc.a.createTextRange(b.node,b.cpBegin,A);Fh.Rp.CF(b,r,!1);return b}HJf(b,h){const r=!C.a.maa(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}$_d(b,h){b.Lj().xg.jD(()=>{this.omg(h,b)},()=>{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}Tcd(b){b=zc.a.Za(b);b.vb(12);b.fd(12);b.so.eU=!0}Y6a(b){b.Ytc=null}tzg(b){b=zc.a.Za(b);b.vb(11)&&(b.fd(11),b.Ld()&&b.Mk()&&b.$d()&&Ed.ParagraphReader.Vb(b.currentNode)&&(b=sc.SelectionFactory.ve(b.currentNode,0),$f.a.instance.Kc(b)))}pcd(b,h,r,A){const M=b.cpBegin,
ba=b.cpEnd;b=Ed.ParagraphReader.text(b.node).trim();M||b!==h&&""!==b?M?ba===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",av[r],A):0<M&&ba<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",av[r],A):v.ULS.sendTraceTag(590958600,
324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",av[r],A):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",av[r],A)}KXc(b){this.chc();const h=new Ly.a(1,y.AFrameworkApplication.isRtl);h.$gd=b;Fh.Hpb.Ajd(h)}chc(){const b=new dw.a(!0);Fh.bca.tNa(b)}omg(b,h){if(b=
this.RMf(b,h))h=Array(1),h[0]=b,b=dK.a.construct(h,!1,y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.tt.Fq:null),h=this.Euf(),this.eyb(h,b)}RMf(b,h){if(!h)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.tt=h.Lj();(new zc.a).set(h);if(!h.anchor||!h.anchor.Lr||!h.anchor.Lr.gt)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),
null;var r=h.anchor.Lr.gt.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ka(Fe.a.jK,Bm.a.Mu);const A=h.getValue(ze.a.aH),M=Rh.a.xf(je.a.LF(h.properties),0),ba=Rh.a.xf(je.a.HL(h.properties),1);return PH.a.construct(h.id.toString(),b,h.ka(ze.a.imageAltText,""),M,ba,h.ka(Rc.a.a0,""),r,h.ka(Rc.a.BX,0),h.ka(Rc.a.ema,!1),h.ka(Fe.a.Oka,-1),h.ka(Rc.a.Qub,Box4Intl.Box4Strings.l_Picture),h.ka(ze.a.bCa,!1),A,h.ka(Rc.a.runId,
1),h.ka(Rc.a.Zc,0))}eyb(b,h){y.AFrameworkApplication.Ge.Xj(b,2,G.c(h),{},!1,2,this.ohd,this.fuc,null,void 0,void 0,void 0,void 0,"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}Euf(){let b=Fa.a.R1c("PicturePaste.ashx");const h=rn.a.NWa;y.AFrameworkApplication.J&&!y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=Fa.a.Lp(b,uj.a.fileId,this.tt.Fq));b=Fa.a.Lp(b,uj.a.cellId,this.tt.kl.toString());this.Km||(this.Km=hb.a.create(),v.ULS.sendTraceTag(591683677,
324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=Fa.a.Lp(b,uj.a.s_,this.Km.toString());b=Fa.a.Lp(b,uj.a.classId,h.toString());this.tt.fH&&(b=Fa.a.Lp(b,uj.a.fH,this.tt.fH));b=Fa.a.Lp(b,uj.a.VAb,"1");b=Fa.a.Lp(b,ui.a.imageType,qk.other.toString());b=Wm.a.instance.Nff(b);b=Fa.a.Lp(b,uj.a.jza,this.tt.xg.lr.toString());b=Fa.a.Lp(b,uj.a.Vtc,"0");return b=Fa.a.Lp(b,uj.a.c3b,"1")}static get Hpb(){return null!=Fh.LVg?Fh.LVg:Fh.LVg=$a.a.instance.resolve(211)}static get nsa(){Fh.gGa||
(Fh.gGa=$a.a.instance.resolve(1020));return Fh.gGa}static get bca(){return null!=Fh.e3g?Fh.e3g:Fh.e3g=$a.a.instance.resolve(258)}static get Gw(){return null!=Fh.ETg?Fh.ETg:Fh.ETg=$a.a.instance.resolve(25)}static get z4(){return null!=Fh.n4g?Fh.n4g:Fh.n4g=$a.a.instance.resolve(1021)}static get VR(){return null!=Fh.FYg?Fh.FYg:Fh.FYg=$a.a.instance.resolve(1022)}static get Of(){return Fh.Rh||(Fh.Rh=$a.a.instance.resolve(16))}static get Rp(){return null!=Fh.xYg?Fh.xYg:Fh.xYg=$a.a.instance.resolve(82)}static get Bg(){return null!=
Fh.mUg?Fh.mUg:Fh.mUg=$a.a.instance.resolve(323)}static get Ff(){return null!=Fh.UVg?Fh.UVg:Fh.UVg=$a.a.instance.resolve(639)}static get Ced(){return null!=Fh.L1g?Fh.L1g:Fh.L1g=$a.a.instance.resolve(1023)}static get F3(){return null!=Fh.C1g?Fh.C1g:Fh.C1g=$a.a.instance.resolve(646)}}Fh.Rh=null;Fh.eAa=5E3;Fh.gGa=null;Object(u.a)(Fh,"ExternalContentEditor",null,[333]);var fz=d(293),mA=d(1168);class lD{constructor(b,h){this.Dhb=!0;this.dXb=r=>{if(null!=r.result)return r.result.Value;v.ULS.sendTraceTag(556376794,
324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.Dhb};this.tcb=r=>{r.yp||r.ij?v.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.SYh(r.result),v.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.Dhb};this.gy=b;this.wT=h}nwi(){const b=new fh.a;this.N1i()&&this.wT?
this.wT.gxb(fz.a.eXc).CWRCo(this.dXb,0).CWRCo(this.tcb,8):b.hg(this.Dhb)}fia(b){this.wT&&this.wT.fia(fz.a.eXc,new mA.a(fz.a.eXc,b))}mNo(b){this.N1i()&&(this.gy.Cva("saveConvertExternalContentIsEnabled",b.toString()),v.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.SYh(b),this.fia(b))}N1i(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser");if(y.AFrameworkApplication.J.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(559437387,
324,50,"User is anonymous ");else return!0;return!1}SYh(b){this.Dhb=b}}Object(u.a)(lD,"ExternalContentSettingInfo",null,[544]);var eK=d(1106);class mD{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(u.a)(mD,"FluidComponentProperties",null,[]);class vF{constructor(){this.loopType=this.Jv=this.p7a=this.url=null;this.mediaType=0;this.$aj=null}}Object(u.a)(vF,"IFrameProps",null,[]);class ul{static get z4(){return null!=
ul.l4g?ul.l4g:ul.l4g=$a.a.instance.resolve(1021)}static get VR(){return ul.Ik||(ul.Ik=$a.a.instance.resolve(1022))}static get Gw(){return null!=ul.DTg?ul.DTg:ul.DTg=$a.a.instance.resolve(25)}static get Rp(){return null!=ul.rYg?ul.rYg:ul.rYg=$a.a.instance.resolve(82)}static get Of(){return null!=ul.g2g?ul.g2g:ul.g2g=$a.a.instance.resolve(16)}static get Bg(){return null!=ul.jUg?ul.jUg:ul.jUg=$a.a.instance.resolve(323)}static PXa(b){const h=b.startsWith(Oc.a.Kuc),r=b.startsWith(Oc.a.zid),A=b.startsWith(Oc.a.sre);
return(h||r||A)&&Oc.a.PXa(b)}static xnf(b,h){let r=!1;if(b){switch(b.contextId){case mc.a.Vc:r=!h;break;case mc.a.Fd:r=!0}r&&!uF.a(b.node)&&(r=!1)}return r}static amc(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=vc.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Oc.a.VA(h,!1);if(1===h.length){h=h[0];const r=Ed.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}static HJf(b,h){const r=!C.a.maa(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static Tcd(b){b=zc.a.Za(b);b.vb(12);b.fd(12);b.so.eU=!0}static D8d(b,h,r,A){const M=new ji.DictionaryPropertySet;ul.VR.Kqe(M,h,b);b=ul.HJf(A,r);M.setValue(ze.a.imageAltText,b);M.setValue(Rc.a.BX,Lg.a.gG());M.setValue(Rc.a.imageType,
qk.other);return M}static Wbe(b,h,r){if(!b||!b.isConnected||!je.a.Lt(b))return null;const A=new lA.a;A.setValue(Yf.a.Amc,h.mediaType);A.setValue(Yf.a.KWa,h.url);A.setValue(Bd.a.loopComponentType,h.loopType);A.p7a=h.p7a;A.Jv=h.Jv;A.providerName=r;A.creationTime=Date.now();A.dbb=1===h.mediaType;A.createMode=h.$aj;zc.a.Za(b).Wf(A,2);ul.Tcd(A);return A}static FYd(b,h){return h?b:ul.GKf(b)}static GKf(b){const h=Ed.ParagraphReader.text(b.node),r=zc.a.Za(b.node);if(r.Ld()){b=vc.a.Tc(b.node,b.cpEnd);Ab.OutlineElementNavigator.ke(r);
const A=ul.Of.eta(r);ul.Of.Jca(r,A,b,!0,!0,!0,!0);""!=h&&ul.Of.gz(r,!1,!0);r.$d();return vc.a.Tc(r.currentNode,0)}return null}static tzg(b){b=zc.a.Za(b);b.vb(11)&&(b.fd(11),b.Ld()&&b.Mk()&&b.$d()&&Ed.ParagraphReader.Vb(b.currentNode)&&(b=sc.SelectionFactory.ve(b.currentNode,0),$f.a.instance.Kc(b)))}static IJf(b,h){const r=!C.a.maa(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,h){ul.Gw&&(b=ul.IJf(b,h),ul.Gw.sendNotification(b,!0))}static Toe(b,h,r,A=""){v.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ca.a.sendTelemetryEvent(Object.assign(new ja.a,{name:r,dataFields:[Object.assign(new fa.a,
{name:b,bool:h}),Object.assign(new fa.a,{name:"ProviderName",string:A})]}))}}Object(u.a)(ul,"ExternalContentHelper",null,[]);var nx=d(740);class QH{constructor(){this.Km=this.tt=null}$_d(b,h,r){b.Lj().xg.jD(()=>{this.omg(h,b,r)},()=>{v.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}omg(b,h,r){if(b=this.RMf(b,h))h=Array(1),h[0]=b,r=dK.a.construct(h,r,y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.tt.Fq:
null),b=this.Euf(),this.eyb(b,r)}RMf(b,h){if(!h)return v.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.tt=h.Lj();(new zc.a).set(h);if(!h.anchor||!h.anchor.Lr||!h.anchor.Lr.gt)return v.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=h.anchor.Lr.gt.node;if(!r)return v.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;r=r.ka(Fe.a.jK,Bm.a.Mu);const A=h.getValue(ze.a.aH),M=Rh.a.xf(je.a.LF(h.properties),0),ba=Rh.a.xf(je.a.HL(h.properties),1);return PH.a.construct(h.id.toString(),b,h.ka(ze.a.imageAltText,""),M,ba,h.ka(Rc.a.a0,""),r,h.ka(Rc.a.BX,0),h.ka(Rc.a.ema,!1),h.ka(Fe.a.Oka,-1),h.ka(Rc.a.Qub,Box4Intl.Box4Strings.l_Picture),h.ka(ze.a.bCa,!1),A,h.ka(Rc.a.runId,1),h.ka(Rc.a.Zc,0))}eyb(b,h){y.AFrameworkApplication.Ge.Xj(b,2,G.c(h),{},!1,2,this.ohd.bind(this),this.fuc.bind(this),null,void 0,void 0,void 0,void 0,
"26");v.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}ohd(){v.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}fuc(){v.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}Euf(){let b=Fa.a.R1c("PicturePaste.ashx");const h=rn.a.NWa;y.AFrameworkApplication.J&&!y.AFrameworkApplication.J.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=Fa.a.Lp(b,uj.a.fileId,this.tt.Fq));b=Fa.a.Lp(b,uj.a.cellId,
this.tt.kl.toString());this.Km||(this.Km=hb.a.create(),v.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=Fa.a.Lp(b,uj.a.s_,this.Km.toString());b=Fa.a.Lp(b,uj.a.classId,h.toString());this.tt.fH&&(b=Fa.a.Lp(b,uj.a.fH,this.tt.fH));b=Fa.a.Lp(b,uj.a.VAb,"1");b=Fa.a.Lp(b,ui.a.imageType,qk.other.toString());b=Wm.a.instance.Nff(b);b=Fa.a.Lp(b,uj.a.jza,this.tt.xg.lr.toString());b=Fa.a.Lp(b,uj.a.Vtc,"0");return b=Fa.a.Lp(b,uj.a.c3b,"1")}}Object(u.a)(QH,
"ExternalContentThumbnailHelper",null,[]);class Ar extends QH{constructor(){super(...arguments);this.gp=null}static get Ff(){return null!=Ar.TVg?Ar.TVg:Ar.TVg=$a.a.instance.resolve(639)}Tak(b,h,r){return ul.PXa(h)?ul.xnf(b,r)?!0:(Ar.Ff.rU(this.gp,2,"URL inserted in Non-Embedable context",Ar.Ff.ap()),!1):(v.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Ar.Ff.rU(this.gp,2,"URL inserted is not valid for ExternalContent",Ar.Ff.ap()),!1)}}
Object(u.a)(Ar,"AbstractExternalContentEditor",QH,[333]);var nA=d(1138),Vr=d(1130);class fr extends Ar{constructor(b){super();fr.VRa=b;this.O5f()}O5f(){Vr.a.O5f(fr.VRa.Wwi())}static get sl(){return null!=fr.H2g?fr.H2g:fr.H2g=$a.a.instance.resolve(349)}YGl(b,h){h=this.SBi(b,h);this.JSi(h,b,5)}SWa(b,h,r){if(this.Tak(b,h,r)){var A=this.SBi(b,null);A.url=h;this.JSi(A,b,r?0:2)}}Rpe(b,h){this.SWa(b,h,!1)}JSi(b,h,r){this.Km=hb.a.create();const A=new Qb.GraphTransaction(15);A.Ab(h.node);A.Ei=Hc.a.Abn;const M=
ul.amc(h),ba=du.q(b.mediaType),oa=ul.D8d(b.height,b.width,b.title,ba);h=this.hzp(h,1==r);(h=ul.Ik.$be(h,oa))?(h=h.node,ul.Wbe(h,{url:b.url,mediaType:ba,Jv:b.title,loopType:b.type,$aj:r},void 0)||v.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),A.iMa(this.Km,1),A.dispose(),this.$_d(h,b.thumbnail,!1),this.Wfo(M,ba,b.type)):v.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}hzp(b,h){ul.Bg.Ue(b,"");return ul.FYd(b,h)}Wfo(b,
h,r){ul.Toe("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");ul.ariaNotify(h,this.xjm(r))}xjm(b){switch(b){case nx.a.CheckList:return"Checklist Component";case nx.a.TaskAssignment:return"Task List Component";case nx.a.Poll:return"Poll Component";default:return"Fluid Component"}}SBi(b,h){const r=new mD;r.width=ul.z4.Vgc(b.node)||0;du.j()?r.height=null!=fr.VRa&&fr.VRa.Twi(h)||ul.z4.X7a(b.node)||0:r.height=null!=fr.VRa&&fr.VRa.Twi(h)+2*ez.a.B6||ul.z4.X7a(b.node)||
0;r.title="Fluid Component";r.mediaType="fluid";r.type=h;r.thumbnail=this.qum();r.url=null!=fr.VRa&&fr.VRa.gJf();return r}qum(){return fr.VRa.Wwi()}static r9c(b){y.AFrameworkApplication.nd("2cejb611;b0jjh576");return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=fr.VRa&&fr.VRa.S2i(b)&&nA.a.rrl(b)}}Object(u.a)(fr,"FluidComponentEditor",Ar,[]);class RH{get Y5l(){return null!=this.KVg?this.KVg:this.KVg=$a.a.instance.resolve(1024)}get N3d(){return null!=
this.cXg?this.cXg:this.cXg=$a.a.instance.resolve(1025)}Rfo(b,h){b&&(fr.r9c(h)?this.N3d.SWa(b,h,!0):this.Y5l.SWa(b,h,!0))}}Object(u.a)(RH,"PostHyperlinkAutoCorrectStrategy",null,[542]);class gz{Dec(b,h){h(gz.ago.test(b))}Uvc(b,h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",
960,960,b);b=Object.assign(new IB,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:gz.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}gz.ago=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");gz.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(u.a)(gz,"PowerBIURLResolver",null,[398,343]);class JB{constructor(b){this.LJh=b}Dec(b,h){let r=!1;try{if(JB.Jun(b)){const A=this.LJh.Pkc(b);r=null!=A.width&&null!=A.height&&
!!A.thumbnailUrl&&!!A.title&&null!=A.Eva}}catch(A){}h(r)}Uvc(b,h){var r=this.LJh.Pkc(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
r.width,r.height,b);r=Object.assign(new IB,{Height:r.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:r.thumbnailUrl,Title:r.title,Width:r.width});h(r)}static Jun(b){for(const h of JB.Lhp)if(b.startsWith(h))return!0;return!1}static waa(){return new JB($a.a.instance.resolve(1023))}}JB.Lhp=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(u.a)(JB,"WedgeComponentExperimentsURLResolver",null,[398,343]);var wL=d(879);let bv=!1;class yu{static b$o(b){yu.d_i||
yu.addEventListener();const h=$a.a.instance.Ra(2);h&&h.execute(r=>{r.logActivity(b,null)})}static addEventListener(){window.addEventListener(yu.sip,yu.rip,!0);yu.d_i=!0}static Utl(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click();bv=!0}}yu.tJn="LoopHomeTabFlightActivity";yu.sip="switchToInsertTabAndClickLoopButtonEvent";yu.d_i=!1;yu.rip=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const r=null===(b=y.AFrameworkApplication.J)||
void 0===b?void 0:b.fc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new wc.a(0,1,r,()=>{yu.Utl()});null===(h=y.AFrameworkApplication.oc)||void 0===h?void 0:h.Yb(b)};Object(u.a)(yu,"FluidComponentsTUIHelper",null,[]);class eu{constructor(b,h,r){this.ga=b;this.Pwk=h;this.Al=r;this.Bph=!1;this.duh=1E3;this.euh=15E3;this.b9e=this.T8e=!0;this.b9e=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",!1);this.duh=!!y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.euh=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Wb(){this.ga.fb(Hc.a.OSi,mc.a.Vc,this.$bn.bind(this),1028);this.ga.fb(Hc.a.vqe,mc.a.Vc,this.vqe.bind(this),1028);this.ga.fb(Hc.a.g8c,mc.a.Vc,this.fWf.bind(this),1028);this.ga.fb(Hc.a.U7c,mc.a.Vc,this.fWf.bind(this),1028);this.ga.fb(Hc.a.dce,
mc.a.Vc,this.fWf.bind(this),1028);this.ga.fb(Hc.a.P6i,mc.a.Vc,this.Ghk.bind(this),1028)}$bn(){return 32}vqe(b,h,r){if(2!==r)return 32;this.b9e&&(this.HDj(),this.uqp());return 32}fWf(b,h,r){var A,M;if(1===r){if(!this.bee(b)||!wL.a.AYi())return v.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;if(!h.Cl||!Le.a.qf(h)||(null===(A=this.Al)||void 0===A?0:A.F2(h))||(null===(M=this.Al)||void 0===M?0:M.gma(h)))return 2;if(h&&h.node&&uF.a(h.node))return 32}else if(2===
r)return this.Pwk.YGl(h,eu.oum(b)),this.HDj(),32;return 2}uqp(){if(null!=cb.a.instance.getItem("LoopComponentSurveyShowed")||bv)this.T8e=!1;if(this.T8e){let b=this.RBi();window.setTimeout(()=>{b&&"hidden"!==b.visibility&&(this.Bph=!0)},this.duh);this.oLk=window.setTimeout(()=>{const h=$a.a.instance.Ra(2);this.Bph&&h&&h.execute(r=>{(b=this.RBi())&&"hidden"===b.visibility&&!bv&&(v.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),r.Meb("WordLoopFeedbackSurvey",null),this.T8e=
!1,cb.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.euh)}}RBi(){var b,h;let r=null;try{const A=document.getElementById("Ribbon-LoopComponentDropdown");A&&(r=Jo.a.bC(null===(h=null===(b=A.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(A){v.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=A?A.toString():""))}return r}HDj(){this.b9e&&window.clearTimeout(this.oLk)}bee(b){return b===Hc.a.U7c||
b===Hc.a.g8c?nA.a.bee():!0}Ghk(b,h,r){2===r&&C.a.QX("https://go.microsoft.com/fwlink/?linkid=2194838")&&df.a.Iwg.PAc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static oum(b){switch(b){case Hc.a.g8c:return nx.a.TaskAssignment;case Hc.a.U7c:return nx.a.CheckList;case Hc.a.dce:return nx.a.Poll;default:return null}}}Object(u.a)(eu,"FluidComponentsActor",null,[]);class Jj extends Ar{constructor(){super();this.FUb=this.EUb=null;this.DCf=new yw.ExternalContentEmbedRetriever;this.CHc=null;
null!=Jj.nsa&&Jj.nsa.nwi()}Uyj(){this.gp=P.a.create();Jj.Ff.SMb(this.gp,4);Jj.Ff.w8(this.gp,0,Jj.Ff.ap());this.ySb(this.EUb,3,this.FUb,!0)}SWa(b,h,r){this.gp=P.a.create();Jj.Ff.SMb(this.gp,r?0:2);Jj.Ff.w8(this.gp,0,Jj.Ff.ap());this.CHc();this.ySb(b,r?0:2,h)}Rpe(b,h){this.gp=P.a.create();Jj.Ff.SMb(this.gp,1);Jj.Ff.w8(this.gp,0,Jj.Ff.ap());this.ySb(b,1,h)}OAj(b){this.CHc=b}SIe(b,h){const r=Jj.z4.Vgc(h)||0;h=Jj.z4.X7a(h)||0;const A=b.Width/b.Height;1<=A?(b.Width=r,b.Height=r/A):(b.Height=h,b.Width=h/
A)}gRg(b,h,r){if(null!=b&&null!=h&&!C.a.Uf(r)){var A=Jj.Ced.Pkc(r);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",!1)?A.Eva=!1:A.Eva=!0;A.hideFloatie=!0;this.SIe(b,h.node);this.cnc(b,h,!1,!1,A,r)}}qrb(b){return b?b.He:0}ZNg(b,h,r){let A=null;const M=b.node;if(!Ed.ParagraphReader.Vb(M)||!M.isConnected)return{returnValue:!1,iwa:A};if(r)return{returnValue:!0,iwa:b};r=b.cpBegin;const ba=b.cpEnd,oa=Ed.ParagraphReader.text(M);
if(0<=r&&ba<=oa.length&&oa.substring(r,ba)===h)return{returnValue:!0,iwa:b};const Ja=oa.indexOf(h);return 0<=Ja?(A=vc.a.createTextRange(M,Ja,Ja+h.length),{returnValue:!0,iwa:A}):0<=r&&ba<=oa.length&&ul.amc(b)?{returnValue:!0,iwa:b}:{returnValue:!1,iwa:A}}g2f(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}Ffb(b,h){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(h)&&window.setTimeout(()=>{const r=$a.a.instance.Ra(2);r&&r.execute(A=>{A.logActivity(b,
h)})},Jj.eAa)}ySb(b,h,r,A=!1){if(this.Tak(b,r,!h)){var M=Jj.Ced.Pkc(r);M&&(this.g2f(M)?(v.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.jmg(b,h,M,r,A)):(v.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Jj.Ff.rU(this.gp,2,"Size provided is not valid for OEmbed",Jj.Ff.ap())))}}jmg(b,h,r,A,M){const ba=!h,oa=1===h,Ja=Jj.z4.Vgc(b.node)||0,jb=Jj.z4.X7a(b.node)||0,zb=OH.a.trf(r.rNg,!0,Ja,jb);this.pcd(b,
A,h,!0);this.DCf.o1h(zb,Eb=>{Jj.Ff.w8(this.gp,4,Jj.Ff.ap());Jj.Ff.Rnd(this.gp,this.qrb(Eb.data));if(Eb=this.qmg(Eb)){v.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Sb=du.q(Eb.MediaType);Jj.Ff.tte(this.gp,7,Sb);Sb=b;({iwa:Sb}=this.ZNg(b,A,oa)).returnValue?(this.pcd(Sb,A,h,!1),null==r.width?0<Ja&&Eb.Width>Ja&&(v.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),
Eb.Width=Ja):(v.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Eb.Width=this.Ztd(r.width,Eb.Width,Ja)),null==r.height?0<jb&&Eb.Height>jb&&(v.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Eb.Height=jb):(v.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Eb.Height=this.Ztd(r.height,Eb.Height,
jb)),Jj.nsa.Dhb||M?this.cnc(Eb,Sb,ba,oa,r,A):(this.EUb=b,this.FUb=A,this.KXc(A))):(v.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Jj.Ff.rU(this.gp,2,"No conversion as the context is no longer valid for the external content conversion",Jj.Ff.ap()));oa&&this.Y6a(Sb.node)}else oa&&this.Y6a(b.node),Jj.Ff.rU(this.gp,1,"URL not oEmbedable",Jj.Ff.ap())},Eb=>{Jj.Ff.w8(this.gp,4,Jj.Ff.ap());Jj.Ff.Rnd(this.gp,
this.qrb(Eb.data));oa&&this.Y6a(b.node);v.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Eb.data.Ee);Jj.Ff.rU(this.gp,2,"ExternalContentEmbedRequest failed",Jj.Ff.ap())},Eb=>{oa&&this.Y6a(b.node);v.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Eb)},this.gp)}Ztd(b,h,r){!b&&0<r&&h>r||b>r?(v.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=r):b>r?
h=r:b&&b<r&&(h=b);return h}cnc(b,h,r,A,M,ba){this.Km=hb.a.create();b.Width=b.Width/b.Height*(b.Height-(ez.a.q6c+ez.a.B6))+2*ez.a.B6;const oa=new Qb.GraphTransaction(15);oa.Ab(h.node);oa.Ei=Hc.a.SWa;const Ja=ul.amc(h);null!=M.Eva&&!M.Eva||A||Ja||(b.Title=""===M.title||M.title?M.title:b.Title,!b.Title&&""!==b.Title)||(h=this.uWf(h,oa,b.Title,ba,r));if(h){A&&(h=this.Bwf(h));var jb=ul.FYd(h,A);if(jb){r=du.q(b.MediaType);var zb=ul.D8d(b.Height,b.Width,b.Title,r);(jb=this.bWf(jb,zb,A,{url:ba,p7a:b.IFrameHtml,
Jv:b.Title,mediaType:r},b.ProviderName))?(oa.iMa(this.Km,1),oa.dispose(),this.EUb=h,this.FUb=ba,this.Mig(M,b,jb),this.Wlg(ba,A||M.hideFloatie,Ja,r,b.Title,b.ProviderName)):oa.dispose()}else oa.dispose(),v.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Jj.Ff.rU(this.gp,2,"Could not create IP context on splitting the paragraph",Jj.Ff.ap())}else Jj.Ff.rU(this.gp,2,"GraphNodeContext is null",Jj.Ff.ap())}bWf(b,h,r,A,M){if(!b)return null;
b=Jj.VR.$be(b,h);if(!b)return v.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Jj.Ff.rU(this.gp,2,"The anchored image could not be inserted",Jj.Ff.ap()),null;b=b.node;A=ul.Wbe(b,A,M);Jj.Ff.oMg(this.gp,A.id);r||ul.tzg(b);return b}Mig(b,h,r){C.a.maa(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Jj.Ff.w8(this.gp,8,Jj.Ff.ap()),v.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),
this.$_d(r,h.Thumbnail,!1))}Wlg(b,h,r,A,M,ba){h||this.KXc(b);this.Ffb("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");ul.Toe("IsHyperlinkWithNonURLDisplayText",r,"Office.Word.Online.ExternalContent.OEmbedInsertions",ba);ul.ariaNotify(A,M);Jj.Ff.w8(this.gp,5,Jj.Ff.ap())}uWf(b,h,r,A,M){if(M){if((M=Oc.a.VA(b,!1))&&1!==M.length)return h.dispose(),v.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;ul.Rp.rV(M[0].paragraph,
M[0].hyperlink)}return this.$tg(b,r,A)}Bwf(b){const h=b.node,r=Ed.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=vc.a.createTextRange(h,0,r.length),ul.Bg.Ue(b,""),vc.a.Tc(h,0)):b}qmg(b){if(!({group:b}=Ck.a.N4(b.data.Ee)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}$tg(b,h,r){const A=b.cpBegin+h.length;ul.Bg.Ue(b,h);b=vc.a.createTextRange(b.node,b.cpBegin,A);ul.Rp.CF(b,r,!1);return b}Y6a(b){b.Ytc=null}pcd(b,h,r,A){const M=b.cpBegin,ba=b.cpEnd;b=Ed.ParagraphReader.text(b.node).trim();
M||b!==h&&""!==b?M?ba===b.length?v.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",av[r],A):0<M&&ba<b.length&&v.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",av[r],A):v.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
av[r],A):v.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",av[r],A)}KXc(b){this.chc();const h=new Ly.a(1,y.AFrameworkApplication.isRtl);h.$gd=b;Jj.Hpb.Ajd(h)}chc(){const b=new dw.a(!0);Jj.bca.tNa(b)}static get Hpb(){return null!=Jj.MVg?Jj.MVg:Jj.MVg=$a.a.instance.resolve(211)}static get nsa(){Jj.gGa||(Jj.gGa=$a.a.instance.resolve(1020));return Jj.gGa}static get bca(){return null!=
Jj.f3g?Jj.f3g:Jj.f3g=$a.a.instance.resolve(258)}static get z4(){return null!=Jj.m4g?Jj.m4g:Jj.m4g=$a.a.instance.resolve(1021)}static get VR(){return null!=Jj.EYg?Jj.EYg:Jj.EYg=$a.a.instance.resolve(1022)}static get Ced(){return null!=Jj.K1g?Jj.K1g:Jj.K1g=$a.a.instance.resolve(1023)}}Jj.eAa=5E3;Jj.gGa=null;Object(u.a)(Jj,"ExternalContentEditorV2",Ar,[]);class SH{constructor(){this.Cd=this.Z=null}get name(){return"WordEditor.ExternalContent"}get qc(){return this.Cd?this.Cd:this.Cd=this.Z.resolve(23)}uc(b){var h;
this.Z=b;b.ia("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new tF.a(sr.a.instance,Ku.WordSectionNavigator.instance)).as(1021).ha();b.ia("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new RH).as(817).ha();b.ia("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new lD(b.resolve(217),b.resolve(218))).as(1020).ha();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ia("WordEditor.ExternalContent.ExternalContentEditorV2",
()=>new Jj).as(1024).ha(),b.ia(1025,()=>new fr(b.resolve(646))).ha(),b.ia(1026,()=>new eu(y.AFrameworkApplication.va,b.resolve(1025),ve.a.instance)).ha(),(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&yu.b$o(yu.tJn)):b.ia("WordEditor.ExternalContent.ExternalContentEditor",()=>new Fh).as(1024).ha()}init(){this.qc.Qr.continueWith(()=>{this.No()});y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&this.Z.resolve(1026).Wb()}dispose(){}PGl(){const b=new MH;this.Dji()&&b.uOh(JB.waa());b.uOh(new gz);return b}No(){null==y.AFrameworkApplication.J||y.AFrameworkApplication.J.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.Z.ia("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new eK.a).as(1023).ha();this.Dji()&&(this.Z.ia(491,()=>this.PGl()).as(491).ha(),this.Z.resolve(491))}Dji(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",
!1)}static main(){E.a.instance.Mc(new SH)}}Object(u.a)(SH,"ExternalContentPackage",null,[0,1]);var zw;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.bwf=6]="decimal";b[b.BWp=7]="bar";b[b.Dvb=8]="num"})(zw||(zw={}));Object(u.b)("TabStopValues",zw);class Ro{}Ro.Bdi=8;Ro.kQl=1;Ro.Kaa="wwaengidc";Ro.kpiName="WordRuler";Ro.precision=.0625;Ro.wjp=1;Ro.pFp="ShowHideRuler";Object(u.a)(Ro,
"Constants",null,[]);var nD=d(1047);class Rq{static hlc(b,h){if(!Rq.Q$c)return null;switch(b){case "Left":return r=>{const A=r.rulerCanvasProps;r=r.indents;return{QUb:0,g_b:A.scale-(A.margins[1].value+r[2].value+Math.max(r[0].value,r[1].value)+8*A.precision)}};case "Right":return r=>{const A=r.rulerCanvasProps;r=r.indents;return{QUb:0,g_b:A.scale-(r[2].value+(A.margins[0].value+Math.max(r[0].value,r[1].value))+8*A.precision)}};case "MoveTableColumn":return()=>{let r=0,A=0;if(0===h){var M={};32===
Rq.Qb.Pb(ub.a.avc,2,M)&&(r=Cg.a.pB(M.MinIndent),A=Cg.a.pB(M.MaxIndent))}else M={rp:h-1},32===Rq.Qb.Pb(ub.a.Zuc,2,M)&&(r=Cg.a.pB(M.MinResize),A=Cg.a.pB(M.MaxResize));return{QUb:r,g_b:A}};case "Top":return r=>{r=r.rulerCanvasProps;return{QUb:0,g_b:r.scale-(r.margins[1].value+8*r.precision)}};case "Bottom":return r=>{r=r.rulerCanvasProps;return{QUb:0,g_b:r.scale-(r.margins[0].value+8*r.precision)}}}return null}static R8d(b){if(!Rq.Q$c)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>
{var r=h.rulerCanvasProps,A=h.indents,M=h.ipContextIndex;h=r.margins;var ba=r.scale;r=r.precision;if("MoveTableColumn"!==h[0].type){M=h[0].value;h=h[1].value+A[2].value;var oa=M;"LeftIndent"===b&&(oa+=Math.max(A[0].value,A[1].value));A=-1*M;r=ba-(oa+h+8*r)}else{ba=0;for(oa=0;oa<=M;oa++)ba+=h[oa].value;oa=0;if("LeftIndent"===b){oa=A[0].value;const Ja=A[1].value;ba+=Math.max(oa,Ja);oa=Math.max(oa,Ja)}h=h[M+1].value;oa+=A[2].value;A=-1*ba;r=h-oa-r}return{QUb:A,g_b:r}};case "RightIndent":return h=>{var r=
h.rulerCanvasProps,A=h.indents,M=h.ipContextIndex,ba=r.margins;h=r.scale;r=r.precision;if("MoveTableColumn"!==ba[0].type){var oa=ba[0].value;ba=ba[1].value;M=A[0].value;var Ja=A[1].value;A=-1*ba;h-=oa+ba+Math.max(M,Ja)+8*r}else{oa=0;for(Ja=0;Ja<=M;Ja++)oa+=ba[Ja].value;ba=ba[M+1].value;M=A[0].value;Ja=A[1].value;A=-1*(h-oa-ba);h=ba-Math.max(M,Ja)-r}return{QUb:A,g_b:h}}}return null}static zKm(){return b=>{var h=b.rulerCanvasProps,r=b.indents,A=b.ipContextIndex,M=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==
M[0].type?(A=M[0].value,M=M[1].value+r[2].value,r=Math.min(r[0].value,r[1].value)+b,b=h-(A+M+b)):(h=r[2].value,M=M[A+1].value,r=Math.min(r[0].value,r[1].value)+b,b=M-(h+b));return{QUb:r,g_b:b}}}static get Qb(){return null!=Rq.tTg?Rq.tTg:Rq.tTg=y.AFrameworkApplication.va}static get Q$c(){null==this.wjb&&(y.AFrameworkApplication.tga("WoRul910;WoRul910cf"),this.wjb=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):
!1);return this.wjb}}Rq.wjb=null;Object(u.a)(Rq,"RulerPropertyBoundaryHelper",null,[]);var oD=d(924),fK=d(1367),Aw=d(942),pD=d(1204),gK=d(1205);class cv{constructor(b,h,r,A,M,ba,oa){this.c9n="OutlineContainer";this.pSk="UpdateCustomTabFailed";this.CHb="ReadRulerPropertiesFailed";this.tSk="UpdateIndentFailed";this.zJh="UpdateMarginFailed";this.Jne=Ja=>{(Ja.button===Sys.UI.MouseButton.rightButton||this.Psn&&Ja.button===Sys.UI.MouseButton.leftButton)&&this.s7e.show(new Sys.UI.Point(Ja.clientX,Ja.clientY),
2)};this.B9j=()=>{this.N0a()};this.io=b;this.J9b=h;this.ga=r;this.s7e=A;this.wA=M;this.AG=ba;this.Q6b=null;this.$K=oa;this.ay=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.A3;this.Dmj=this.sne.bind(this);this.Apj=this.sv.bind(this);this.A9j=this.N0a.bind(this)}YE(){this.yff();this.AOh();this.J9b.Pl.jf(10).ro(this.Dmj);uf.a.addHandler(this.Tcf,zd.a.scroll,this.B9j);this.io.execute(h=>{h.oY(this.Apj)});const b=[this.DMf(),document.getElementById(Ii.a.KBc),document.getElementById("PageContentContainer")];
this.Lrg(b);qa.StaticActiveAppFrame.za().fL.registerBoundingWindowRectsChanged("documentPanel",(h,r)=>{"undefined"!==r&&this.Vfb([1,0])})}Lrg(b){this.Q6b?this.Q6b.register(b,this.A9j):Aw.a(fK.a.b7k,()=>{appChrome.getResizeObserver().then(h=>{this.Q6b=h.createResizeObserver();this.Q6b.register(b,this.A9j);return null})})}DMf(){var b;return 0===this.AG.Et?this.xyh:(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isRulerPositionFixEnabled",!1))?
this.Tyh:this.Uyh}get Tcf(){return document.getElementById(Ii.a.b1a)}get xyh(){const b=document.getElementsByClassName(this.c9n);return b&&0<b.length?b[0]:null}get Uyh(){var b=this.wA.VOb;if(!b)return null;b=this.nPo(Ed.ParagraphReader.CU(b));return oD.a.LDi(b)}get qSa(){return this.$K.value}get Tyh(){return this.qSa.Ce(this.qSa.qd).qS}nPo(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}get CQ(){return this.io&&this.io.instance?this.io.instance.Cj:Ro.kQl}wkc(){const b=
{};return 32!==this.ga.Pb(ub.a.oNa,2,b)?(v.ULS.sendTraceTag(529065947,pD.a.KRn,gK.a.warning,"Unable to read page properties for Ruler"),Tl.recordQosError(this.CHb,[Tl.vja],"Unable to read page properties for Ruler"),null):b}dispose(){this.KOi();this.J9b.Pl.jf(10).XP(this.Dmj);uf.a.removeHandler(this.Tcf,zd.a.scroll,this.B9j);this.io.execute(b=>{b.BNa(this.Apj)});this.Q6b&&this.Q6b.dispose();qa.StaticActiveAppFrame.za().fL.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==
h&&this.Vfb([1,0])})}get C_i(){null==cv.MXe&&(cv.MXe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&y.AFrameworkApplication.J.$("RulerThemingIsEnabled"):!1);return cv.MXe}get Psn(){null==cv.tYe&&(cv.tYe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRulerContextMenuOnLeftClick",!1):!1);return cv.tYe}}
cv.MXe=null;cv.tYe=null;Object(u.a)(cv,"ARuler",null,[446]);var hK=d(302);class Sq extends cv{constructor(b,h,r,A,M,ba,oa,Ja){super(b,h,r,M,ba,oa,Ja);this.cS="HorizontalRuler";this.ufk="CustomTabModificationFromRuler";this.$gk="IndentModificationFromRuler";this.$He="MarginModificationFromRuler";this.xlh=this.wlh=this._tabStops=null;this.tZn=(jb,zb,Eb)=>{if(!(jb>=this._tabStops.length)){jb=this._tabStops[jb];var Sb="Modify"===Eb?this.ga.Pb(Hc.a.Orc,2,{["tabStop"]:jb,["value"]:Cg.a.uD(zb)}):this.ga.Pb(Hc.a.xdb,
2,jb);if(32===Sb){zb=1;var nc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",Eb,zw[jb.Qha]);v.ULS.sendTraceTag(591213271,3014,50,nc)}else zb=0,nc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",Eb,zw[jb.Qha]),v.ULS.sendTraceTag(591213272,3014,15,nc),Tl.recordQosError(this.pSk,[Tl.vja],"Unable to modify custom tab using ruler");$b.a(this.ufk,32===Sb,void 0,[Object.assign(new fa.a,{name:"Operation",string:Eb}),Object.assign(new fa.a,
{name:"TabType",int64:zw[jb.Qha]})]);Eb=new Map;Eb.set("Command","OnCustomTabChange");Eb.set("Source",this.cS);Eb.set("Response",nc);za.Health.instance.recordKpiUsage(Ro.kpiName,zb,Ro.Kaa,Eb)}};this.I0n=(jb,zb)=>{var Eb=new nD.a;Eb.unit=1;Eb.value=Cg.a.uD(zb);zb=8;switch(jb){case "FirstLineIndent":zb=this.ga.Pb(ub.a.xod,2,Eb);break;case "HangingIndent":zb=this.ga.Pb(ub.a.yod,2,Eb);break;case "LeftIndent":zb=this.ga.Pb(ub.a.J$a,2,Eb);break;case "RightIndent":zb=this.ga.Pb(ub.a.I$a,2,Eb)}let Sb;32===
zb?(Eb=1,Sb=String.format("Indents set using Ruler. Indent: {0}",jb),v.ULS.sendTraceTag(592517017,3014,50,Sb)):(Eb=0,Sb=String.format("Unable to set indent using Ruler. Indent: {0}",jb),v.ULS.sendTraceTag(592496523,3014,15,Sb,jb),Tl.recordQosError(this.tSk,[Tl.vja],"Unable to set indent using Ruler."));$b.a(this.$gk,32===zb,void 0,[Object.assign(new fa.a,{name:"Type",string:jb})]);jb=new Map;jb.set("Command","OnIndentChange");jb.set("Source",this.cS);jb.set("Response",Sb);za.Health.instance.recordKpiUsage(Ro.kpiName,
Eb,Ro.Kaa,jb)};this.mtc=(jb,zb)=>{if(Tl.instance.iga)switch(zb.AMa){case 3:case 2:case 1:this.Lrg([this.Tyh]);break;case 0:this.Lrg([this.xyh])}};this.igg=(jb,zb,Eb)=>{let Sb;Sb="Left"===jb?this.ga.Pb(ub.a.Ena,2,Cg.a.uD(zb)):"Right"===jb?this.ga.Pb(ub.a.peb,2,Cg.a.uD(zb)):Eb?this.ga.Pb(ub.a.$Be,2,{["columnIndex"]:Eb-1,["width"]:Cg.a.uD(zb)}):this.ga.Pb(ub.a.Dxc,2,Cg.a.uD(zb));32===Sb?(zb=1,Eb=String.format("Margins set using Ruler. Margin: {0}",jb),v.ULS.sendTraceTag(592517018,3014,50,Eb)):(zb=0,
Eb=String.format("Unable to set margins using Ruler. Margin: {0}",jb),v.ULS.sendTraceTag(592496524,3014,15,Eb),Tl.recordQosError(this.zJh,[Tl.vja],"Unable to set margins using Ruler."));$b.a(this.$He,32===Sb,void 0,[Object.assign(new fa.a,{name:"Type",string:jb})]);jb=new Map;jb.set("Command","OnMarginChange");jb.set("Source",this.cS);jb.set("Response",Eb);za.Health.instance.recordKpiUsage(Ro.kpiName,zb,Ro.Kaa,jb)};this.QSa=A;this.ps={}}get yX(){return this.wlh}get XKa(){return this.xlh}renderRuler(){this.yX.classList.remove("HideWACHorizontalRulerContainer");
this.yX.classList.add("ShowWACHorizontalRulerContainer");var b=this.wkc();if(b){var h=this.igg,r=this.I0n,A=this.tZn,M=this.usd(),ba=this.W3j(),oa=this.V3j();M&&ba&&oa||(this.ps.disabled=!0);this.ps.onIndentChange=r;this.ps.onMarginChange=h;this.ps.onTabChange=A;this.N0a();b=Rh.a.sj(b.Bp,0);this.XKa.style.width=(b*this.CQ).toString()+"px";return this.QSa().then(Ja=>{Ja.renderRuler(this.XKa,this.ps)})}}static jpc(){null==this.bFb&&null!=y.AFrameworkApplication.J&&(this.bFb=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isRulerPositionFixEnabled",
!1));return this.bFb}V3j(){const b=[];var h={};if(32!==this.ga.Pb(Hc.a.AYb,2,h))return v.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),Tl.recordQosError(this.CHb,[Tl.vja],"Unable to read paragraph tabs for Ruler"),!1;var r=h.customTabs;if(!r||0>=r.length)return this.ps.tabs=b,!0;this._tabStops=r;h="";for(const A of r){switch(A.Qha){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";break;case 7:h="BarTab"}r=Rh.a.xZa(A.BOa,
0);b.push({["type"]:h,["value"]:r,["getRulerPropertyBoundary"]:Rq.zKm()})}this.ps.tabs=b;return!0}Vfb(b){var h;if(this.yX){this.yX.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.ps&&delete this.ps.disabled;for(const r of b)switch(r){case 0:b=this.W3j();const A=this.V3j();b&&A||(this.ps.disabled=!0);break;case 1:this.usd()||(this.ps.disabled=!0)}if(null===(h=this.wA.currentSelection)||void 0===h?0:h.q9c)this.ps.disabled=!0;this.QSa().then(r=>{r.renderRuler(this.XKa,this.ps);return null})}}usd(){const b=
{};var h=this.wkc();if(!h)return!1;b.scale=Cg.a.pB(h.Bp);b.precision=Ro.precision;b.rulerType="Horizontal";if(!this.o7n())return this.ps.ipContextIndex=0,this.ps.permittedUnits=Ro.Bdi,h=[{["type"]:"Left",["value"]:Cg.a.pB(h.marginLeft),["getRulerPropertyBoundary"]:Rq.hlc("Left",0)},{["type"]:"Right",["value"]:Cg.a.pB(h.marginRight),["getRulerPropertyBoundary"]:Rq.hlc("Right",1)}],b.margins=h,this.ps.rulerCanvasProps=b,!0;var r={};h={};var A=this.ga.Pb(ub.a.hjd,2,r);const M=this.ga.Pb(ub.a.NYb,2,h);
if(32!==A||32!==M)return v.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),Tl.recordQosError(this.CHb,[Tl.vja],"Unable to read table properties for Ruler"),!1;r=r.ColumnWidths;A=h.TablePosition;if(!A||!r||0>=r.length)return v.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),Tl.recordQosError(this.CHb,[Tl.vja],"Cannot show table properties on the ruler as they are null"),!1;h=Array(r.length+1);h[0]={["type"]:"MoveTableColumn",
["value"]:Cg.a.pB(A.x/this.CQ),["getRulerPropertyBoundary"]:Rq.hlc("MoveTableColumn",0)};for(A=0;A<r.length;A+=1)h[A+1]={["type"]:"MoveTableColumn",["value"]:Cg.a.pB(r[A]),["getRulerPropertyBoundary"]:Rq.hlc("MoveTableColumn",A+1)};this.ps.ipContextIndex=this.pOm();this.ps.permittedUnits=Ro.wjp;b.margins=h;this.ps.rulerCanvasProps=b;return!0}W3j(){var b={};if(32!==this.ga.Pb(ub.a.ldb,2,b))return v.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),Tl.recordQosError(this.CHb,
[Tl.vja],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=Rq.R8d("FirstLineIndent");const r={type:"HangingIndent"};r.getRulerPropertyBoundary=Rq.R8d("HangingIndent");const A={type:"RightIndent"};A.getRulerPropertyBoundary=Rq.R8d("RightIndent");const M={type:"LeftIndent"};M.getRulerPropertyBoundary=Rq.R8d("LeftIndent");this.ps.rtl=b.isRtl;b=b.Iu;h.value=1===b.specialIndentType?Cg.a.pB(b.Gha+b.$A):2===b.specialIndentType?Cg.a.pB(b.$A-b.Gha):
Cg.a.pB(b.$A);r.value=Cg.a.pB(b.$A);M.value=Cg.a.pB(b.$A);A.value=Cg.a.pB(b.Sfa);this.ps.indents=[h,r,A,M];return!0}AOh(){uf.a.addHandler(this.yX,zd.a.lz,this.Jne);Sq.jpc()&&this.AG.Zcc(this.mtc)}KOi(){this.yX&&(this.yX.classList.remove("ShowWACHorizontalRulerContainer"),this.yX.classList.add("HideWACHorizontalRulerContainer"),uf.a.removeHandler(this.yX,zd.a.lz,this.Jne));this.QSa().then(b=>{b.dispose(this.XKa);return null});Sq.jpc()&&this.AG.kue(this.mtc)}sv(){this.D9j();this.N0a();this.Vfb([1,0])}sne(b,
h){b=h.property;if(b===Rc.a.Bp||b===Rc.a.marginLeft||b===Rc.a.marginRight)this.D9j(),this.N0a(),this.Vfb([1])}D9j(){var b=this.wkc();b&&(b=Rh.a.sj(b.Bp,0),this.XKa.style.width=Math.round(b*this.CQ).toString()+"px")}N0a(){window.requestAnimationFrame(()=>{var b=this.DMf();b&&(b=Te.a.getElementBounds(b),y.AFrameworkApplication.isRtl?this.XKa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.XKa.style.marginLeft=b.x.toString()+"px")})}pOm(){const b=zc.a.Za(this.wA.VOb);
if(b.vb(14))return b.fd(16),Kx.a(b,!0);v.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");Tl.recordQosError(this.CHb,[Tl.vja],"Unable to read table column index for Ruler");return 0}o7n(){let b=!0;const h=this.wA.currentSelection.jU();if(null===h)return v.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),Tl.recordQosError(this.CHb,[Tl.vja],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const r=zc.a.Za(h.current.node);
r.Ld();b=b&&Hi.TableReader.yy(r)}return b}yff(){if(!this.XKa&&!this.yX){this.wlh=document.createElement("div");this.yX.id=Sq.qzk;this.yX.className=Sq.pzk;this.yX.setAttribute(Pe.a.Yja,WordEditorIntl.WordEditorStrings.L_Ruler);this.yX.setAttribute(Pe.a.Sh,Pe.a.DUh);this.yX.classList.add("HideWACHorizontalRulerContainer");if(this.C_i){var b=y.AFrameworkApplication.J.jb("ModernUxExperimentPreferenceCookieName");const h=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");Qc.a.tfa(b,!h)&&
this.yX.classList.add(Sq.PFk)}this.xlh=document.createElement("div");this.XKa.className=Sq.ozk;this.XKa.id=Sq.rzk;this.yX.appendChild(this.XKa);b=null;this.ay&&((b=Object(hK.a)("EditorBars"))&&b.appendChild(this.yX),this.yX.classList.add("regionComposer"));b||(b=document.getElementById(Ii.a.KBc),b.insertBefore(this.yX,b.firstChild))}}static dH(){return new Sq($a.a.instance.Ra(6),df.a.ff,y.AFrameworkApplication.va,hm.UISurfaces.xGi,$a.a.instance.resolve(1027),kt.a.instance,$a.a.instance.resolve(76),
Sq.jpc()?new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc):null)}static get instance(){return null!=Sq.ZZg?Sq.ZZg:Sq.ZZg=Sq.dH()}}Sq.bFb=null;Sq.qzk="WACHorizontalRulerContainer";Sq.pzk="WACHorizontalRulerContainer";Sq.rzk="WACHorizontalRuler";Sq.ozk="WACHorizontalRuler";Sq.PFk="ModernUxWACHorizontalRulerContainer";Object(u.a)(Sq,"HorizontalRuler",cv,[]);var zu=d(1547);class yp extends cv{constructor(b,h,r,A,M,ba,oa,Ja){super(b,h,r,M,ba,oa,Ja);this.cS="VerticalRuler";this.$He="MarginModificationFromRuler";
this.pKh=this.oKh=null;this.igg=(jb,zb)=>{let Eb=8;"Top"===jb?Eb=this.ga.Pb(ub.a.qeb,2,Cg.a.uD(zb)):"Bottom"===jb&&(Eb=this.ga.Pb(ub.a.oeb,2,Cg.a.uD(zb)));let Sb;32===Eb?(zb=1,Sb=String.format("Margins set using Ruler. Margin: {0}",jb),v.ULS.sendTraceTag(529065945,3014,50,Sb)):(zb=0,Sb=String.format("Unable to set margins using Ruler. Margin: {0}",jb),v.ULS.sendTraceTag(529065946,3014,15,Sb),Tl.recordQosError(this.zJh,[Tl.vja],"Unable to set margins using Ruler."));$b.a(this.$He,32===Eb,void 0,[Object.assign(new fa.a,
{name:"Type",string:jb})]);jb=new Map;jb.set("Command","OnMarginChange");jb.set("Source",this.cS);jb.set("Response",Sb);za.Health.instance.recordKpiUsage(Ro.kpiName,zb,Ro.Kaa,jb)};this.QSa=A;this.ps={}}get W4(){return this.oKh}get APa(){return this.pKh}renderRuler(){this.W4.classList.remove("HideWACVerticalRulerContainer");this.W4.classList.add("ShowWACVerticalRulerContainer");var b=this.wkc();if(b){var h=this.igg;this.usd()||(this.ps.disabled=!0);this.ps.onMarginChange=h;this.N0a();b=Rh.a.sj(b.vw,
1);this.APa.style.height=(b*this.CQ).toString()+"px";this.QSa().then(r=>{r.renderRuler(this.APa,this.ps);return null})}}Vfb(b){var h;if(this.W4){this.W4.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.ps&&delete this.ps.disabled;for(const r of b)switch(r){case 1:this.usd()?this.N0a():this.ps.disabled=!0}if(null===(h=this.wA.currentSelection)||void 0===h?0:h.q9c)this.ps.disabled=!0;this.QSa().then(r=>{r.renderRuler(this.APa,this.ps);return null})}}static jpc(){null==this.bFb&&null!=
y.AFrameworkApplication.J&&(this.bFb=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isRulerPositionFixEnabled",!1));return this.bFb}usd(){const b={},h=this.wkc();if(!h)return!1;b.scale=Cg.a.pB(h.vw);b.precision=Ro.precision;b.rulerType="Vertical";this.ps.ipContextIndex=0;this.ps.permittedUnits=Ro.Bdi;b.margins=[{["type"]:"Top",["value"]:Cg.a.pB(h.marginTop),["getRulerPropertyBoundary"]:Rq.hlc("Top",0)},{["type"]:"Bottom",["value"]:Cg.a.pB(h.marginBottom),["getRulerPropertyBoundary"]:Rq.hlc("Bottom",
1)}];this.ps.rulerCanvasProps=b;return!0}AOh(){this.yff();uf.a.addHandler(this.W4,zd.a.lz,this.Jne)}KOi(){this.W4&&(this.W4.classList.remove("ShowWACVerticalRulerContainer"),this.W4.classList.add("HideWACVerticalRulerContainer"),uf.a.removeHandler(this.W4,zd.a.lz,this.Jne));this.QSa().then(b=>{b.dispose(this.APa);return null})}sv(){this.z9j();this.N0a();this.Vfb([1])}sne(b,h){b=h.property;if(b===Rc.a.vw||b===Rc.a.marginTop||b===Rc.a.marginBottom)this.z9j(),this.N0a(),this.Vfb([1])}z9j(){var b=this.wkc();
b&&(b=Rh.a.sj(b.vw,1),this.APa.style.height=Math.round(b*this.CQ).toString()+"px")}N0a(){window.requestAnimationFrame(()=>{var b;if(b=yp.jpc()?this.Uyh:this.DMf()){const h=Te.a.getElementBounds(b);this.APa.style.height=h.height.toString()+"px";b=this.fQm(b);this.APa.style.marginTop=b+"px"}})}fQm(b){b=b.getBoundingClientRect().y;const h=this.Tcf.getBoundingClientRect().y;return b-h}yff(){if(!this.APa&&!this.W4){this.oKh=document.createElement("div");this.W4.id=yp.gTk;this.W4.className=yp.fTk;this.W4.setAttribute(Pe.a.Yja,
WordEditorIntl.WordEditorStrings.L_Ruler);this.W4.setAttribute(Pe.a.Sh,Pe.a.DUh);this.W4.classList.add("HideWACVerticalRulerContainer");if(this.C_i){var b=y.AFrameworkApplication.J.jb("ModernUxExperimentPreferenceCookieName");const h=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");Qc.a.tfa(b,!h)&&Sys.UI.DomElement.addCssClass(this.W4,yp.QFk)}this.pKh=document.createElement("div");this.APa.className=yp.eTk;this.APa.id=yp.hTk;this.W4.appendChild(this.APa);b=document.getElementById(Ii.a.KBc);
b.insertBefore(this.W4,b.firstChild)}}static dH(){return new yp($a.a.instance.Ra(6),df.a.ff,y.AFrameworkApplication.va,hm.UISurfaces.xGi,$a.a.instance.resolve(1027),kt.a.instance,$a.a.instance.resolve(76),yp.jpc()?new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc):null)}static get instance(){return null!=yp.YZg?yp.YZg:yp.YZg=yp.dH()}}yp.bFb=null;yp.gTk="WACVerticalRulerContainer";yp.fTk="WACVerticalRulerContainer";yp.hTk="WACVerticalRuler";yp.eTk="WACVerticalRuler";yp.QFk="ModernUxWACVerticalRulerContainer";
Object(u.a)(yp,"VerticalRuler",cv,[]);class Tl{constructor(b,h,r,A,M,ba,oa,Ja,jb){this.HUe=this.nXe=!1;this.cS="RulerActor";this.lDh=null;this.iga=!1;this.hrk="ClearAllTabStopsFailed";this.tFh="ShowHideRulerFailed";this.ZYe=null;this.MVd=(zb,Eb,Sb)=>{if(1===Sb)return 32;zb=this.ga.Ob(Hc.a.zZb,2,null);32===zb?(Sb=1,Eb=String.format("Clear all tab stops from ruler"),v.ULS.sendTraceTag(591213266,3014,50,Eb)):(Sb=0,Eb=String.format("Unable to clear all tab stop from ruler"),v.ULS.sendTraceTag(591213267,
3014,15,Eb),Tl.recordQosError(this.hrk,[Tl.vja],Eb));const nc=new Map;nc.set("Command","ClearAllTabStops");nc.set("Source",this.cS);nc.set("Response",Eb);za.Health.instance.recordKpiUsage(Ro.kpiName,Sb,Ro.Kaa,nc);return zb};this.X7c=(zb,Eb,Sb)=>{if(1===Sb)switch(zb){case Hc.a.vkf:case Hc.a.cwf:return 2;default:return 32}Eb=this.s7e.kJm();switch(zb){case Hc.a.h4f:var nc=1;break;case Hc.a.iwg:nc=4;break;case Hc.a.gof:nc=3;break;default:return v.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),
2}zb=new nB.a(Eb,nc,0,1);zb=this.ga.Pb(Hc.a.Jnd,2,zb);32===zb?(Sb=1,Eb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",zw[nc],Eb.toString()),v.ULS.sendTraceTag(591213269,3014,50,Eb)):(Sb=0,Eb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",zw[nc],Eb.toString()),v.ULS.sendTraceTag(591213270,3014,15,Eb));nc=new Map;nc.set("Command","InsertCustomTabStopRuler");nc.set("Source",this.cS);nc.set("Response",Eb);za.Health.instance.recordKpiUsage(Ro.kpiName,
Sb,Ro.Kaa,nc);return zb};this.Y0b=(zb,Eb,Sb,nc,Dc)=>{var Zc;if(this.nXe||1===Sb&&Bl.a.dma(Eb.Ok))return 8;(null===(Zc=y.AFrameworkApplication.J)||void 0===Zc?0:Zc.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",!1))&&Eb.contextId!=mc.a.view&&(v.ULS.sendTraceTag(508359384,3014,15,String.format("context id: {0}",Eb.contextId)),Eb=new Yt.a(qa.StaticActiveAppFrame.za().kb.Jc));return this.iga?this.u6c(zb,Eb,Sb,nc,Dc):this.S$o(Eb,Sb)};this.$Lo=()=>{this.iga?v.ULS.sendTraceTag(574128526,
3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.Ob(ub.a.Y0b,2)?(v.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),Tl.recordQosError(this.tFh,[Tl.vja],"Ruler could not be enabled")):v.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.u6c=(zb,Eb,Sb)=>{if(1===Sb||!this.iga)return 32;this.iga=!1;this.t7e.RJj(!1);this.Wib.dispose();this.Jge()&&this.Ayf();this.C9j();v.ULS.sendTraceTag(593351623,
3014,50,"Ruler is disabled");zb=new Map;zb.set("Command","HideRuler");zb.set("Source",this.cS);zb.set("Response","");za.Health.instance.recordKpiUsage(Ro.kpiName,1,Ro.Kaa,zb);return 32};this.lse=(zb,Eb,Sb,nc,Dc)=>{if(1===Sb)return 32;Dc&&(Dc[Ng.a.On]=this.iga);return 32};this.e8m=zb=>{this.iga=zb.result};this.IRb=()=>{this.nXe=!1};this.wOi=()=>{this.nXe=!0};this.ga=b;this.Wib=h;this.Fcf=r;this.j4b=A;this.s7e=M;this.t7e=ba;Tl.vl=Ja;this.rRa=oa;this.AG=jb;this.rRa.fQh(this.wOi);this.rRa.GRd(this.IRb)}initialize(){this.Wb();
this.lDh=this.$Lo;window.addEventListener("TurnRulerOnAction",this.lDh,!0);return this.t7e.yKm().continueWith(this.e8m,8)}Wb(){this.ga.qa(ub.a.Y0b,mc.a.view,this.Y0b);this.ga.fb(ub.a.lse,mc.a.view,this.lse,96);this.ga.qa(Hc.a.vkf,mc.a.view,this.X7c);this.ga.qa(Hc.a.gof,mc.a.view,this.X7c);this.ga.qa(Hc.a.MVd,mc.a.view,this.MVd);this.ga.qa(Hc.a.cwf,mc.a.view,this.X7c);this.ga.qa(Hc.a.u6c,mc.a.view,this.u6c);this.ga.qa(Hc.a.h4f,mc.a.view,this.X7c);this.ga.qa(Hc.a.iwg,mc.a.view,this.X7c);zu.a.hd.addHandler(zu.a.ine,
this.$fd.bind(this));this.AG.sKb(this.mtc)}YRi(){this.iga&&(this.Wib.YE(),this.Wib.renderRuler(),this.Jge()&&this.eFj())}eFj(){this.Fcf.YE();this.Fcf.renderRuler()}Ayf(){this.Fcf.dispose()}Jge(){return this.t4i()&&this.isPaginatedView()}t4i(){null==this.ZYe&&null!=y.AFrameworkApplication.J&&(this.ZYe=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.ZYe}tqp(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",
!1)&&this.iga&&$a.a.instance.Ra(2).execute(b=>{b.logActivity("LocateRulerActivity",null)})}EAc(){this.iga||$a.a.instance.Ra(2).execute(b=>{b.logActivity("TurnRulerOnActivity",null)})}j_(){this.rRa.BDo(this.wOi);this.rRa.oEj(this.IRb);this.iga&&(this.Wib.dispose(),this.Jge()&&this.Ayf())}C9j(){if(this.j4b){const b={};b[Ro.pFp]="ToggleButtonModel";this.j4b.lJ(b)}}S$o(b,h){if(!Tl.vl.aba(b.Ok))return v.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),Tl.recordQosError(this.tFh,
[Tl.vja],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.iga=!0;this.t7e.RJj(!0);this.YRi();this.C9j();v.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.cS);b.set("Response","");za.Health.instance.recordKpiUsage(Ro.kpiName,1,Ro.Kaa,b);return 32}isPaginatedView(){return 1===this.AG.Et||2===this.AG.Et}$fd(b,h){switch(h.documentMode){case "View":this.iga&&(this.ga.Ob(ub.a.Y0b,2),this.HUe=!0);break;case "Edit":this.HUe&&
(this.ga.Ob(ub.a.Y0b,2),this.HUe=!1)}}mtc(b,h){if(Tl.instance.iga&&Tl.instance.t4i())switch(h.AMa){case 2:case 1:Tl.instance.eFj();break;case 3:case 0:Tl.instance.Ayf()}}static recordQosError(b,h,r){const A=Object.assign(new bb.a,{extendedProperties:new Map});r&&A.extendedProperties.set("exception",r);za.Health.instance.recordQosError(b,h,!1,!0,!1,!1,A)}static dH(){return new Tl(y.AFrameworkApplication.va,Sq.instance,yp.instance,qa.StaticActiveAppFrame.za(),$a.a.instance.resolve(1027),$a.a.instance.Oa(1028),
$a.a.instance.resolve(983),sr.a.instance,$a.a.instance.resolve(76))}static get instance(){return null!=Tl.ZYg?Tl.ZYg:Tl.ZYg=Tl.dH()}}Tl.vl=null;Tl.vja="RulerInteractionFailed";Object(u.a)(Tl,"RulerActor",null,[]);class KB{constructor(b,h){this.jPc=null;this.dXb=r=>r.result?r.result.Value.toString():"";this.tcb=r=>{if(r.yp||r.ij)v.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.jPc=!1;else{r=r.result;const A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableRuler",
!1);"true"===r.toLowerCase()&&A&&v.ULS.sendTraceTag(508703490,3014,50,"Roaming setting is set to true by default");""===r&&y.AFrameworkApplication.J&&(!A||appChrome.api.isSmallDevice()||appChrome.api.isVerySmallDevice()?r=y.AFrameworkApplication.J.jb("RulerDefaultOn"):(r="true",v.ULS.sendTraceTag(508703489,3014,50,"Enabling Ruler by default for undefined roaming setting for large screens")));this.jPc="true"===r.toLowerCase();v.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully.")}return this.jPc};
this.gy=b;this.wT=h}yKm(){const b=new fh.a;if(null==this.jPc){if(this.S1i())return this.wT.gxb(fz.a.Amd).CWRCo(this.dXb,0).CWRCo(this.tcb,8);b.hg(!1)}else b.hg(this.jPc);return b.task}fia(b){this.wT.fia(fz.a.Amd,new mA.a(fz.a.Amd,b))}RJj(b){this.S1i()&&(this.gy.Cva("saveRulerIsEnabled",b.toString()),v.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));this.fia(b)}S1i(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser");if(y.AFrameworkApplication.J.$("IsRoamingServiceEnabled"))if(b)v.ULS.sendTraceTag(591541277,
3014,50,"User is anonymous ");else return!0;return!1}}Object(u.a)(KB,"RulerSettingInfo",null,[416]);class wF{constructor(){this.Umh=this.Z=null}get name(){return"WordEditor.Ruler"}uc(b){this.Z=b;v.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.Z.ia("WordEditor.Ruler.RulerSettingInfo",()=>new KB(this.Z.resolve(217),this.Z.resolve(218))).as(1028).ha();this.Z.resolve(23).Qr.continueWith(()=>{this.No()});this.Umh=Tl.instance.initialize();v.ULS.sendTraceTag(578110852,
3014,50,"Word ruler package is initialized")}No(){this.Umh.continueWith(()=>{Tl.instance.YRi();Tl.instance.EAc();Tl.instance.tqp()});v.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){Tl.instance.j_();v.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(u.a)(wF,"PackageManager",null,[0,1]);class zp{constructor(){this.Smc=this.mdc=null}}Object(u.a)(zp,"CreatePickerCustomizationDictionaryOptions",null,[1866]);class qD{}qD.lh="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(u.a)(qD,"InsertMediaM365DialogHtml",null,[]);class ox{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de){this.kN=de;this.Ghb=null;this.eZf=this.wFd=!1;this.pVj=he=>{if(he.rawEvent&&(he=he.rawEvent.data))try{const fe=Sys.Serialization.JavaScriptSerializer.deserialize(he,!0),Yd=fe.MessageId?fe.MessageId.toString():null;fe&&Yd&&(Yd===K.a.enc||Yd===K.a.WVf)&&this.dNc.start(Yd===K.a.enc?this.kjb:this.fnh)}catch(fe){}};this.zyp=(he,fe,Yd,Td,wf)=>{if(1===Yd)return 32;this.Wph?he=CommonUIStrings.l_OneDriveName:
""!==this.WCd?he=this.WCd:(he=CommonUIStrings.l_HostGeneric,v.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));wf[al.a.LabelText]=he;return 32};this.Cyp=(he,fe,Yd,Td,wf)=>{if(1===Yd)return 32;if(!y.AFrameworkApplication.TZf())return wf[al.a.Visible]=!1,32;this.Wph?he=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.WCd?he=String.format(CommonUIStrings.l_ChangePictureFromHost,this.WCd):
(he=CommonUIStrings.l_ChangePictureFromHostGeneric,v.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));wf[al.a.LabelText]=he;return 32};this.Ayp=(he,fe,Yd,Td,wf)=>{if(1===Yd)return 32;y.AFrameworkApplication.J.$("InsertOnlinePictureEnabled")||(wf[al.a.Visible]=!1);return 32};this.Byp=(he,fe,Yd,Td,wf)=>{if(1===Yd)return 32;y.AFrameworkApplication.J.$("InsertPictureUsingStockImagesIsEnabled")||(wf[al.a.Visible]=
!1);return 32};this.Kze=(he,fe,Yd)=>{fe=this.pJc.value.hka(fe);if(1===Yd)return fe&&this.jjb.Cnn?32:8;if(2!==Yd||!fe)return 8;this.Ghb=hb.a.create();v.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");he=this.Rxm(he,this.Ghb);he=this.Fef(he);he=this.ODd.J3c(he);he.correlationId=this.Ghb;he.oWf=this.gnh;he.iua=1;return this.Ize(he,CommonUIStrings.L_PictureInsertTitle,this.kjb)};this.U9o=(he,fe,Yd)=>{he=32===this.ga.Pf(fe,ub.a.XR,1,!1,null,null);if(1===
Yd)return he&&this.jjb.wZi?32:8;if(2!==Yd||!he)return 8;v.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.Ize(this.enh.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.fnh)};this.cVj=(he,fe,Yd)=>{he=this.pJc.value.hka(fe);if(1===Yd)return he&&this.jjb.SZf?32:8;if(2!==Yd||!he)return 8;v.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.Ize(this.enh.getInstance(),
CommonUIStrings.L_PictureInsertTitle,this.kjb)};this.Gze=(he,fe,Yd)=>{fe=this.pJc.value.hka(fe);if(1===Yd)return fe&&this.jjb.Enn?32:8;if(2!==Yd||!fe)return 8;v.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");this.Ghb=hb.a.create();Yd=y.AFrameworkApplication.J.$("StockImagesFreemiumExperienceIsEnabled")&&this.HK.isFreemiumUpsellEnabled();Yd=this.wFd?1:Yd?0:-1;he=this.BAm(he,this.Ghb,Yd);he=this.ODd.J3c(he);he.lh=qD.lh;he.correlationId=this.Ghb;
he.iua=2;he.oWf=this.gnh;he.NTa=this.HK;he.userLicenseType=Yd;return this.Ize(he,CommonUIStrings.L_PictureInsertTitle,this.kjb)};this.Lze=(he,fe,Yd)=>{fe=this.pJc.value.hka(fe);he=$a.a.instance.Oa(1029);if(1===Yd)return fe&&!this.jjb.SZf&&he&&he.c1f()&&!y.AFrameworkApplication.jge?32:8;if(2!==Yd||!fe||!he)return 8;v.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.Ghb=hb.a.create();Yd=ox.kKh;fe=!1;y.AFrameworkApplication.UZf()&&(fe=this.dhm());
const Td=new zp;Td.mdc=fe;Td.Smc=!0;Yd=he.vtf(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,Yd,"Insert Media",1,Td);he.u6d(Yd).then(wf=>{if(null!=wf&&0<wf.length){const Lf=[];for(let ii=0;ii<wf.length;ii++){const Bi=wf[ii][H.a.Ctj],Ml=wf[ii][H.a.Btj],hk={};hk.Extension=Bi;hk.OriginalUrl=Ml;hk.caption=Bi;Lf.push(hk)}this.kjb.UWa=ub.a.C6;this.kjb.T$a(Lf)}});return 32};this.Jze=(he,fe,Yd)=>{var Td=this.pJc.value.hka(fe);fe=$a.a.instance.Oa(1029);if(1===Yd)return Td&&fe&&fe.c1f()?32:
8;if(2!==Yd||!Td||!fe)return 8;Yd=$a.a.instance.Oa(1030);null!=Yd&&Yd.N7l(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));v.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");this.Ghb=hb.a.create();Yd=ox.kKh;Td=new zp;Td.mdc=!0;Td.Smc=!0;Yd=fe.vtf(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,Yd,"InsertPictureFromMobile",3,Td);
fe.u6d(Yd).then(wf=>{if(null!=wf&&0<wf.length){var Lf=[];const ii=he===ub.a.ace;let Bi=!1;const Ml=y.AFrameworkApplication.J.jb("PhoneLinkServiceEndpoint");for(let hk=0;hk<wf.length;hk++){const Tn=wf[hk][H.a.Ctj],rx=wf[hk][H.a.Btj],sx={};sx.Extension=Tn;sx.OriginalUrl=rx;sx.caption=Tn;Lf.push(sx);Bi||(Bi=-1!==sx.OriginalUrl.indexOf(Ml))}this.kjb.UWa=ub.a.C6;this.kjb.T$a(Lf);Lf={};Lf.InsertImageCount=wf.length;Bi&&$b.c(ii?ub.a.acn:ub.a.Tol,void 0,void 0,void 0,void 0,void 0,Lf)}});return 32};this.dNc=
A;this.zId=M;this.ODd=oa;this.enh=Ja;this.M1=jb;this.ga=b;this.pJc=ba;this.Wph=nc;this.WCd=Zc;this.jjb=r;this.kjb=zb;this.fnh=Eb;this.gnh=Gd;(this.HK=Sb)&&this.HK.isFeatureEnabled("MsoPremiumStockImages",!1).catch(he=>v.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",he)).then(he=>{(this.wFd=he)||this.HK.Yua("MsoPremiumStockImages",()=>{this.wFd=!0;v.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});
return null})}Wb(){(this.jjb.SZf||this.jjb.wZi)&&this.jjb.Dnn&&this.iho();this.Ywo();this.Xwo();this.ga.fb(ub.a.W0h,mc.a.view,this.cVj,1284);this.ga.fb(ub.a.qxj,mc.a.view,this.Cyp,1124);this.ga.fb(ub.a.iWf,mc.a.view,this.cVj,1284);this.ga.fb(ub.a.Qog,mc.a.view,this.zyp,1124);this.ga.fb(ub.a.kcn,mc.a.view,this.U9o,1284)}Ywo(){this.ga.fb(ub.a.insertOnlinePicture,mc.a.view,this.Kze,1284);this.ga.fb(ub.a.Ybe,mc.a.view,this.Gze,1284);this.ga.j4("word_insertOnlinePictures",!0,ub.a.insertOnlinePicture,mc.a.view,
this.Kze,b=>{qa.StaticActiveAppFrame.za().I2b(b,Object(F.a)(new mp.a,(new mp.a).Mqb,"getCommandById"))});this.ga.j4("word_insertOnlinePictures",!0,ub.a.Ybe,mc.a.view,this.Gze,b=>{qa.StaticActiveAppFrame.za().I2b(b,Object(F.a)(new mp.a,(new mp.a).Mqb,"getCommandById"))});this.ga.fb(ub.a.oof,mc.a.view,this.Kze,1284);this.ga.fb(ub.a.qof,mc.a.view,this.Lze,1284);this.ga.j4("word_insertOnlinePictures",!0,ub.a.qof,mc.a.view,this.Lze);this.ga.fb(ub.a.rof,mc.a.view,this.Gze,1284);this.ga.fb(ub.a.oxj,mc.a.view,
this.Ayp,1284);this.ga.fb(ub.a.pxj,mc.a.view,this.Byp,1284);this.ga.j4("word_insertOnlinePictures",!0,ub.a.oof,mc.a.view,this.Kze);this.ga.j4("word_insertOnlinePictures",!0,ub.a.rof,mc.a.view,this.Gze);this.ga.fb(ub.a.kWf,mc.a.view,this.Lze,1284);this.ga.j4("word_insertOnlinePictures",!0,ub.a.kWf,mc.a.view,this.Lze,b=>{qa.StaticActiveAppFrame.za().I2b(b,Object(F.a)(new mp.a,(new mp.a).Mqb,"getCommandById"))})}Xwo(){y.AFrameworkApplication.UZf()&&(this.ga.fb(ub.a.ace,mc.a.view,this.Jze,1284),this.ga.fb(ub.a.pof,
mc.a.view,this.Jze,1284),this.ga.j4("mso_insertMobileDevicePictures",!0,ub.a.ace,mc.a.view,this.Jze,b=>{qa.StaticActiveAppFrame.za().I2b(b,Object(F.a)(new mp.a,(new mp.a).Mqb,"getCommandById"))}),this.ga.j4("mso_insertMobileDevicePictures",!0,ub.a.pof,mc.a.view,this.Jze,b=>{qa.StaticActiveAppFrame.za().I2b(b,Object(F.a)(new mp.a,(new mp.a).Mqb,"getCommandById"))}))}iho(){y.AFrameworkApplication.ta.get_element().appendChild(this.zId.D8a);uf.a.addHandler(this.zId.D8a.contentWindow,"message",this.pVj);
this.eZf=!0}Rxm(b,h){let r=0;y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb&&5===y.AFrameworkApplication.ta.Hb.Uk&&(r=12);const A=Ag.a.Hg(y.AFrameworkApplication.lcid);return String.format(y.AFrameworkApplication.J.appSettings.WordInsertPictureServiceEndpoint,b===ub.a.insertOnlinePicture?1:0,y.AFrameworkApplication.lcid,A?A.name:"en-us",y.AFrameworkApplication.buildVersion,h,r,y.AFrameworkApplication.J.jb("UserId"))}Ize(b,h,r){try{return b.Hze(h,r,void 0),v.ULS.sendTraceTag(7185476,352,
50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(A){return v.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",A.toString()),this.vq(se.a.ked,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}BAm(b,h,r){if(ub.a.Ybe===b)return b=this.M1.SXh(y.AFrameworkApplication.J.jb("InsertOnlineM365PictureEndpoint"),h.toString(),1,r),this.Fef(b);b=this.M1.SXh(y.AFrameworkApplication.J.jb("InsertOnlineM365PictureEndpoint"),
h.toString(),0,r);return this.Fef(b)}vq(b,h,r){const A=new kh.StandardDialog(!0);A.Gu=y.AFrameworkApplication.$fa;A.Ed=0;A.Qe(1,CommonUIStrings.l_DialogClose);A.Iy(b,h,r,()=>{})}dhm(){const b=$a.a.instance.Oa(1030);return null!=b?b.ulm():!1}dispose(){this.eZf&&this.zId.D8a.contentWindow&&(uf.a.removeHandler(this.zId.D8a.contentWindow,"message",this.pVj),this.eZf=!1)}Fef(b){return this.kN&&this.kN.jP?(b=new gb.QueryStringBuilder(b),b.Ae("theme","4"),b.toString()):b}}ox.kKh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");
Object(u.a)(ox,"InsertMediaActor",null,[11]);var dv=d(962);class oA extends dv.a{constructor(b,h){super(b,Fa.a.getOrigin(h))}Yr(b,h){this.isEnabled()&&this.Nja(this.kfb)&&(this.Gv(b),this.XE(b,h))}}Object(u.a)(oA,"InsertMediaCrossDocumentMessenger",dv.a,[517,56,11]);class ly{getInstance(b,h){return new oA(b,h)}}Object(u.a)(ly,"InsertMediaCrossDocumentMessengerFactory",null,[510]);var xL=d(772);class LB{}LB.lh="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(u.a)(LB,"InsertMediaDialogHtml",null,[]);var rD;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(rD||(rD={}));Object(u.b)("HubbleAction",rD);var hz;(function(b){b[b.unknown=0]="unknown";b[b.KWp=1]="bing";b[b.NQp=2]="M365";b[b.J6p=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.Gae=5]="hubble"})(hz||(hz={}));Object(u.b)("InsertMediaProviders",hz);class MB extends ug.a{constructor(b,h,r,A=null,M=!1){super(!1,!1,M);this.Hz=null;this.EHc=!1;this.Jcd=this.H3=
null;this.Xmf="KeepFocusDiv";this.lUd="KeepFocusStartDiv";this.correlationId=null;this.iua=0;this.NTa=this.oWf=null;this.userLicenseType=0;this.G_e=null;this.S0n=()=>{this.H3&&(this.H3.style.visibility="visible",window.setTimeout(()=>{if(this.Pj){const ba=this.Pj.getElementById(this.lUd);ba&&ba.focus()}},0))};this.oga=ba=>{ba.keyCode===Sys.UI.Key.tab&&(ba.target.id!==this.Xmf||ba.shiftKey?ba.target.id===this.lUd&&ba.shiftKey&&(ba.preventDefault(),this.Pj.getElementById(this.Xmf).focus()):(ba.preventDefault(),
this.Pj.getElementById(this.lUd).focus()))};this.Yjj=()=>{v.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.zOb(this.D6a);this.fyb(1)};this.wfg=()=>{this.Hz&&(v.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.Hz.sendMessage(K.a.TNj,{["CustomHeaders"]:""}))};this.qlj=()=>{this.Hz&&(v.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.Hz.sendMessage(K.a.f0o,{["SessionId"]:y.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};
this.plj=()=>{this.Hz&&(v.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.Hz.sendMessage(K.a.hUo,{["CID"]:""}))};this.n1n=()=>{this.NTa&&(v.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.NTa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.PDd=b;this.v6b="";this.M1=r;this.gya=[];this.LJd=h;this.lh=A||LB.lh;this.Pg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async Hze(b,
h){this.v6b=b;this.EHc=!1;this.showDialog(this.v6b,null);this.H3=this.bkc(this.Ej("insertmediaframe"));if(!this.H3)throw this.zOb(this.D6a),Error.invalidOperation("Couldn't get InsertMediaIframe.");b=document.createElement("div");b.setAttribute("Id",this.lUd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.H3.parentNode.insertBefore(b,this.H3.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",
this.Xmf);b.setAttribute("tabindex","0");this.H3.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.qxf,"keydown",this.oga);this.H3.src=this.PDd;this.H3.style.width="100%";this.H3.style.height="100%";this.H3.frameBorder="0";y.AFrameworkApplication.J.$("ShowInsertMediaIframeWhenIframeIsReady")&&X.a.yj?(this.H3.style.visibility="hidden",this.Jcd=this.S0n,uf.a.addHandler(this.H3,"load",this.Jcd)):this.H3.style.visibility=
"visible";this.bkc(this.Ej("WACDialogButtonPanel")).style.display="none";this.bkc(this.Ej("WACDialogTitleText")).style.display="none";2===this.iua&&(this.bkc(this.Ej("WACDialogTitlePanel")).style.display="none",this.bkc(this.Ej("WACDialogBodyPanel")).style.padding="0");rd.FocusManager.instance().gu().scope.YL=!0;this.Hz=this.LJd.getInstance(this.H3.contentWindow,this.PDd);this.Hz.Nja("https://osiziwuspersimmon002.blob.core.windows.net");this.Hz.Nja("https://osizewuspersimmon001.blob.core.windows.net");
this.Hz.Nja("https://osizpscuspersimmon000.blob.core.windows.net");this.Hz.Nja("https://cdn.hubblecontent.msit.osi.office.net");this.Hz.Nja("https://cdn.hubblecontent.osi.office.net");this.Hz.Yr(K.a.HNh,r=>{this.ljj(r,Object(F.a)(h,h.T$a,"insertMediaCallback"))});this.Hz.Yr(K.a.insert,r=>{this.Wme(r,Object(F.a)(h,h.T$a,"insertMediaCallback"))});this.Hz.Yr(K.a.dOh,r=>{this.Bmj(r)});this.Hz.Yr(K.a.Lwi,this.wfg);this.Hz.Yr(K.a.getSessionId,this.qlj);this.Hz.Yr(K.a.tui,this.plj);this.Hz.Yr(K.a.IUd,this.Yjj);
2!==this.iua||this.userLicenseType||(this.Hz.Yr(K.a.gAn,this.n1n),this.G_e=this.NTa.Yua("MsoPremiumStockImages",r=>{v.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.Hz.sendMessage(K.a.GDp,{["LicenseTier"]:r.toString()})}));this.fyb(3)}dispose(){this.NTa&&this.G_e&&this.NTa.CZb("MsoPremiumStockImages",this.G_e);this.Hz&&(this.Hz.dispose(),this.Hz=null);this.Jcd&&(uf.a.removeHandler(this.H3,"load",this.Jcd),this.Jcd=null);super.dispose()}ljj(b,h){v.ULS.sendTraceTag(7135752,
352,100,"OnAddItem : Got message.");if(b=this.M1.ubo(b))this.gya.push(b),this.EHc&&(h(this.gya),this.EHc=!1)}vq(){const b=new kh.StandardDialog(!0);b.Gu=y.AFrameworkApplication.$fa;b.Ed=0;b.Qe(1,CommonUIStrings.l_DialogOk);b.Mx(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}fyb(b){if(2===this.iua){const r=y.AFrameworkApplication.J.jb("InsertMediaDialogAriaTenantNameSpace");if(r&&""!==r){var h=[];h.push(Object.assign(new fa.a,{name:"InsertedFiles",
int64:this.gya.length}));h.push(Object.assign(new fa.a,{name:"MediaDetails",string:JSON.stringify(this.gya)}));h.push(Object.assign(new fa.a,{name:"DialogResult",string:rD[b]}));h.push(Object.assign(new fa.a,{name:"DialogMode",string:this.bCi()}));h.push(Object.assign(new fa.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new fa.a,{name:"Provider",string:hz[this.iua]||"Unknown"}));ca.a.sendTelemetryEvent(Object.assign(new ja.a,{name:String.format("{0}.{1}",r,this.telemetryEventName),
dataFields:h}))}}}bCi(){return 3===this.iua?"Icons":5===this.iua?"ExternalContent":"Images"}bkc(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}Wme(b,h){v.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.zOb(this.D6a);h?this.gya&&50<this.gya.length?(this.vq(),this.fyb(0),v.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.gya.length,hz[this.iua])):this.gya&&0<
this.gya.length?(h(this.gya),this.fyb(0),v.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.gya.length,hz[this.iua])):(v.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.EHc=!0,h(this.gya),this.fyb(2)):this.fyb(2)}Bmj(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,v.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),ca.a.sendOtelEvent(Object.assign(new xL.a,{otelEvent:b})))}}
Object(u.a)(MB,"InsertMediaDialog",ug.a,[509,11]);class sD{constructor(b,h){this.eWe=b;this.M1=h}J3c(b,h=!1){return new MB(b,this.eWe,this.M1,LB.lh,h)}getInstance(){throw Error.notImplemented();}}Object(u.a)(sD,"InsertMediaDialogFactory",null,[508]);class xF{constructor(b,h,r){this.YVi=!1;this.correlationId=null;this.iua=0;this.oWf=null;this.vzk=b;this.DRc=[];this.XCd=h;this.WGh=r.split(";")}async Hze(b,h){Array.clear(this.DRc);b=this.vzk.value;b.Nja(this.XCd);b.Gv(h.D6c);this.YVi||(b.XE(h.D6c,r=>
{this.Wme(r,h)}),this.YVi=!0);v.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.Lbi,{["FileExtensionFilterList"]:this.WGh})}v0k(b){Array.contains(this.DRc,b)||this.DRc.push(b)}Wme(b,h){v.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.ksj(b);const r=[];for(let A=0;A<b.length;A++){const M=b[A];h.Vde(M,this.WGh)?r.push(M):this.v0k(h.ZFi(M))}r&&r.length?h.T$a(r):v.ULS.sendTraceTag(20509843,
352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.DRc.length&&(h=this.DRc.join(", "),v.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.Bap(h))}Bap(b){const h=new kh.StandardDialog;h.Ed=0;h.AY(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(u.a)(xF,"InsertMediaFromHostManager",null,[509,11]);class TH{constructor(b){this.AAk=
b}J3c(){throw Error.notImplemented();}getInstance(){return this.AAk}}Object(u.a)(TH,"InsertMediaFromHostManagerFactory",null,[507,508]);class UH{constructor(){this.D8a=document.createElement("iframe");this.D8a.src="about:blank";this.D8a.style.visibility="hidden";this.D8a.style.position="absolute";this.D8a.style.zIndex="-100"}}Object(u.a)(UH,"InsertMediaFromHostOneDriveHostFrame",null,[505]);class NB extends dv.a{constructor(b,h){super(b,"*"===h?h:Fa.a.getOrigin(h));this.LMh(K.a.enc);this.LMh(K.a.WVf)}Mue(){}}
Object(u.a)(NB,"InsertMediaFromOneDriveCrossDocumentMessenger",dv.a,[123,56,11]);class Zp{}Object(u.a)(Zp,"OnlineMediaSearchResult",null,[]);class px{SXh(b,h,r,A){const M=Ag.a.Hg(y.AFrameworkApplication.lcid).name,ba=y.AFrameworkApplication.buildVersion,oa=C.a.XT(y.AFrameworkApplication.J.jb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Ja=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;y.AFrameworkApplication.nd("ShIns226;ShIns226cf");
return String.format(b,y.AFrameworkApplication.lcid,M,ba,h,px.cJe,oa,A,r,Ja)}return String.format(b,y.AFrameworkApplication.lcid,M,ba,h,px.cJe,oa,A,r)}ubo(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new Zp,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||
"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}vbo(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let A=0;A<b.length;A++){var r=b[A];r&&(r=Object.assign(new Zp,{Type:r.Extension||"",OriginalUrl:r.SourceUrl||"",Caption:r.caption,Height:r.Height||0,Width:r.Width||0}),h.push(r))}return h}ckg(b){const h=[];for(let A=0;A<b.data.files.length;A++){var r=b.data.files[A];
r&&(r=Object.assign(new Zp,{ContentType:r.itemType||"",Type:r.extension||"",OriginalUrl:r.urls&&r.urls.open?r.urls.open:"",Height:r.photo?r.photo.height:0,Width:r.photo?r.photo.width:0}),h.push(r))}return h}Vde(b,h){if(!b)return!1;for(let r=0;r<h.length;r++)if(0<=b.toLowerCase().indexOf(h[r]))return!0;return!1}dho(b){let h="";if(b)for(let r=0;r<b.length;r++){const A=b[r];A&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',A.OriginalUrl,A.Width,A.Height))}return h}}px.cJe=0;Object(u.a)(px,
"InsertMediaHelper",null,[491]);class yL{constructor(b,h,r,A,M){this.Cnn=b;this.SZf=h;this.wZi=r;this.Dnn=A;this.Enn=M}}Object(u.a)(yL,"InsertMediaSettingsManager",null,[]);class yF{constructor(b){this.AJc=ub.a.XR;this.ga=b}get UWa(){return this.AJc}set UWa(b){this.AJc=b}T$a(b){try{v.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Pb(this.UWa,2,b[h]);v.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",
b.length)}catch(h){v.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(u.a)(yF,"InsertOneDriveFileHandler",null,[418]);class VH extends yF{constructor(b){super(b)}get Lbi(){return K.a.WVf}get D6c(){return K.a.ybn}ksj(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}ZFi(){Tc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}Vde(){return!0}Awj(b,
h,r){b=r(b);b.length&&(r={},r.Items=b,h.sendMessage(this.D6c,r))}nsj(b){const h=[];for(let r=0;r<b.data.files.length;r++){const A=b.data.files[r];if(A){const M={};M.DisplayText=String.format("{0}{1}",A.name,A.extension);M.Url=this.Uam([A.urls.viewInBrowser,A.urls.open,A.urls.download]);h.push(M)}}return h}Uam(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];v.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(u.a)(VH,"InsertOneDriveFileHelper",
yF,[417,418]);class pA{constructor(b,h,r,A){this.Po=A;this.AJc=ub.a.C6;this.Vp=null;this.Z2n=()=>{Xc.a.xV&&this.Po.lM([26],this.Yd)};this.ga=b;this.M1=h;this.Eja=r;Xc.a.xV&&(this.Yd=Ik.a.getInstance(Sc.a),Go.a.qrg(this.Z2n))}get Qb(){return this.ga}get Gw(){return this.Vp||(this.Vp=$a.a.instance.resolve(25))}get UWa(){return this.AJc}set UWa(b){this.AJc=b}T$a(b){try{Xc.a.xV&&this.Po.mY([26]);v.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",
b.length);const h=this.M1.dho(b);let r=2;if(h&&0<h.length){const A=new ji.DictionaryPropertySet;A.setValue(Bd.a.hY,h);A.setValue(Bd.a.ega,!0);if(this.Eja){const M=this.Eja.sqd();M.Adc("insertOnlineImage");A.setValue(Bd.a.zza,M)}r=this.ga.Pb(this.UWa,2,A)}v.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===r,""===h)}catch(h){v.ULS.jA(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}
Object(u.a)(pA,"InsertOnlineImageHandler",null,[418]);class my extends pA{constructor(b,h,r,A=null){super(b,h,A,r)}get Lbi(){return K.a.enc}get D6c(){return K.a.Mbn}ksj(b){return this.M1.vbo(b)}ZFi(b){return b.Type}Vde(b,h){return this.M1.Vde(b.Type,h)}nsj(b){return this.M1.ckg(b)}Awj(b,h,r){r=r(b);if(r.length){b=[];for(let A=0;A<r.length;A++){const M=r[A],ba={};ba.Extension=M.Type;ba.SourceUrl=M.OriginalUrl;ba.caption=M.Type;ba.SourceUrl=M.OriginalUrl;ba.Width=M.Width;ba.Height=M.Height;b.push(ba)}r=
{};r.Items=b;h.sendMessage(this.D6c,r)}}}Object(u.a)(my,"InsertOnlineImageHelper",pA,[417,418]);class OB{constructor(b,h){this.MDb=b;this.LJd=h}start(b){this.MDb.start({mode:"open",select:"multi",lightbox:"white"},(h,r)=>{this.processResponse(h,r,b)})}processResponse(b,h,r){v.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.LJd.getInstance(window.frames[0].parent,
window.document.URL),r.Awj(h,b,A=>r.nsj(A))):v.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(u.a)(OB,"OneDriveFilePickerHelperV5",null,[415]);class Lt{constructor(){this.NDd=this.Z=null}get name(){return"Box4.Media"}uc(b){this.Z=b;b.ia(1034,()=>new UH).as(1041).ha();const h=new yL(Boolean.parse(y.AFrameworkApplication.J.appSettings.InsertOnlinePictureEnabled||"false"),y.AFrameworkApplication.TZf(),!1,y.AFrameworkApplication.ZCg(),
y.AFrameworkApplication.J.$("InsertPictureUsingStockImagesIsEnabled"));b.ia("Box4.Media.OneDriveFilePickerHelperV5",()=>new OB(b.resolve(1031),b.resolve(1032))).as(1033).ha();b.ia(1042,()=>new ox(y.AFrameworkApplication.va,y.AFrameworkApplication.J,h,b.resolve(1033),b.resolve(1034),new Pf.a(()=>$a.a.instance.resolve(822)),b.resolve(1035),b.resolve(1036),b.resolve(1037),b.resolve(1038),b.resolve(1039),b.resolve(4),y.AFrameworkApplication.Vtb,y.AFrameworkApplication.Vta,y.AFrameworkApplication.U3m,
y.AFrameworkApplication.J.appSettings.InsertPictureTelemetryEndpoint,b.resolve(113))).ha();b.ia("Box4.Media.InsertMediaDialogFactory",()=>new sD(b.resolve(1032),b.resolve(1037))).as(1035).ha();b.ia("Box4.Media.InsertMediaFromHostManagerFactory",()=>new TH(b.resolve(1040))).as(1036).ha();b.ia(1040,()=>new xF(new Pf.a(()=>{if(y.AFrameworkApplication.ZCg()){var r=$a.a.instance.resolve(1041).D8a;r=new NB(r.contentWindow,"*")}else r=y.AFrameworkApplication.Y_;return r}),y.AFrameworkApplication.ZCg()?Fa.a.getOrigin(window.document.URL):
Fa.a.getOrigin(y.AFrameworkApplication.Lwb),y.AFrameworkApplication.J.appSettings.ImageFetcherSupportedExtensions)).ha();b.register(ly,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as(1032).ha();b.register(px,1037).ha();b.ia(1038,()=>new my(y.AFrameworkApplication.va,b.resolve(1037),new wk.b,b.resolve(259))).ha();b.ia(1039,()=>new VH(y.AFrameworkApplication.va)).ha()}init(){this.NDd=this.Z.resolve(1042);this.NDd.Wb()}dispose(){this.NDd&&this.NDd.dispose()}}Object(u.a)(Lt,"MediaPackage",null,
[0,1]);var WH=d(972);class zF{get name(){return"Box4.PlaceholderText"}uc(b){this.Z=b;this.Z.ia(928,()=>new WH.a(qa.StaticActiveAppFrame.za().kb.Jc,this.Z.resolve(413),this.Z.resolve(370),this.Z.Ra(72),df.a.ff.Pl.jf(12),this.Z.rf(164))).ha()}init(){this.Z.resolve(928).init()}dispose(){}static main(){E.a.instance.Mc(new zF,4)}}Object(u.a)(zF,"PlaceholderTextPackage",null,[0,1]);class Bw{constructor(b,h,r,A){this.M9b=b;this.nja=h;this.pCk=r;this.yr=A;this.Mmj=()=>{(y.AFrameworkApplication.FEj||this.rcl())&&
this.WAc()}}init(){Bw.scl&&this.pCk&&this.nM()}nM(){this.nja.wt(this.Mmj)}WAc(){this.nja.vS(this.Mmj)}rcl(){var b;if(!this.M9b)return!1;const h=this.ktm();if(h){let r=h;if(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameDisableFailedDialog",!1))r={J_p:!0,M2p:h};if(32===y.AFrameworkApplication.va.Pb(La.a.cva,2,r)&&this.yr)return this.yr.execute(A=>{A.logActivity("AutoRenameDocumentCallout",null);y.AFrameworkApplication.oc.Yb(new wc.a(5,
1,12E4,()=>{A.logActivity("AutoRenameSentimentSurvey",null)},0,"floodgateSurveyForAutoRenameSentiment"))}),$b.a("AutoRenameDocumentSuccess"),!0}return!1}ktm(){let b,h=this.M9b.B3d();for(;h;){const r=h.node;if(0<Ed.ParagraphReader.textLength(r,9)&&(b=Pn.AParagraphNode.ltm(r.characterData.trim()),0<b.length))break;h=h.next}return b}static get scl(){var b;null===this.dLe&&(this.dLe=null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",
!1));return this.dLe}}Bw.dLe=null;Object(u.a)(Bw,"AutoRenameExecutor",null,[]);class AF{rpn(b){var h;if(!y.AFrameworkApplication.HI)return!1;var r=y.AFrameworkApplication.sessionStartInfoSettings.ApplicationModeExtended;r=0<=(null===r||void 0===r?void 0:r.toLowerCase().indexOf("new"));return(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocumentFileNew",!1))?(h=y.AFrameworkApplication.sessionStartInfoSettings.SessionOrigin,h=0<=
(null===h||void 0===h?void 0:h.toLowerCase().indexOf("wacfilenew")),(r||h)&&this.d9c(b)):r&&this.d9c(b)}d9c(b){return b.value.Xja(qa.StaticActiveAppFrame.za().kb.Jc.qd)}get name(){return"Box4.AutoRename"}uc(b){this.Z=b;this.Z.ia(1043,()=>new Bw(this.Z.resolve(413),df.a.ff.Pl.jf(12),this.rpn(this.Z.rf(164)),b.Ra(2))).ha()}init(){this.Z.resolve(1043).init()}dispose(){}static main(){E.a.instance.Mc(new AF,20)}}Object(u.a)(AF,"AutoRenamePackage",null,[0,1]);var XH=d(346);class ny{constructor(){this.xLo=
"getAddinShortcutsPreference";this.yLo="saveAddinShortcutsPreference";this.zLo="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.Ihm=6E4;this.cle=this.Mra=this.Gca=null}hGi(b){return String.format(this.zLo,y.AFrameworkApplication.J.appSettings.RoamingServiceHandlerWebServiceBase||"",b,y.AFrameworkApplication.xm)}executeRequest(b,h,r,A,M=null){return ny.aU.kKb(b,h,M,null,r,A,!1,null,this.Ihm)}saveSetting(b,h,r,A,M){return this.SJj(b,h,r,null,A,M)}startBatchUpdateScope(){this.cle=[]}saveShortcutInfoArrayBatch(b,
h,r){this.CNo(r,b,h)}CNo(b,h,r){const A={action:"",addinId:"",ownerType:0};A.timestamp=(new Date).toUTCString();const M=this.getShortcutInfoArray(h.toString(),r.toString());b?(A.shortcutInfoArray=b,this.Eef(h,r,b)):M&&(A.shortcutInfoArray=M);b={};b[h.toString()]=A;h=new XH.a(r.toString(),b);this.cle.push(h)}commitBatchUpdateScope(){return this.vpd()?this.ENo().then(()=>{this.nec();return Promise.resolve(!0)}):this.GNo().then(()=>{this.nec();return Promise.resolve(!0)})}ENo(){return this.getSetting().then(b=>
{let h=null;if(b&&!({hv:h}=G.d(b)).returnValue)return v.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const r of this.cle){(b=h[r.key])||(b={});const A=r.value;for(const M of tb.a.LR(A))b[M]=A[M];h[r.key]=b}this.Gca=h;try{return localStorage.setItem("AddinShortcutPreferenceData",G.c(h)),Promise.resolve(!0)}catch(r){return v.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",
r),Promise.resolve(!1)}})}GNo(){return this.NSo().then(b=>this.bwe(b))}NSo(){return this.dOf().then(b=>{let h=null;b&&(({hv:h}=G.d(b)).returnValue||v.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const r of this.cle){(b=h[r.key])||(b={});const A=r.value;for(const M of tb.a.LR(A))b[M]=A[M];h[r.key]=b}this.Gca=h;return G.c(h)})}saveShortcutInfoArray(b,h,r){return this.SJj(0,"","",r,b,h)}SJj(b,h,r,A,
M,ba){const oa=this.vpd(),Ja={};Ja.action=r;Ja.addinId=h;Ja.ownerType=b;Ja.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(M.toString(),ba.toString());0===b&&A?(Ja.shortcutInfoArray=A,this.Eef(M,ba,A)):h&&(Ja.shortcutInfoArray=h);b={};b[M.toString()]=Ja;M=new XH.a(ba.toString(),b);return oa?this.DNo(M):this.FNo(M)}DNo(b){return this.getSetting().then(h=>{let r=null;if(h&&!({hv:r}=G.d(h)).returnValue)return v.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);r||(r={});r[b.key]=b.value;this.Gca=r;try{return localStorage.setItem("AddinShortcutPreferenceData",G.c(r)),Promise.resolve(!0)}catch(A){return v.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",A),Promise.resolve(!1)}})}FNo(b){return this.MSo(b).then(h=>this.bwe(h))}MSo(b){return this.dOf().then(h=>{let r=null;h&&(({hv:r}=G.d(h)).returnValue||v.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
r||(r={});r[b.key]=b.value;this.Gca=r;return G.c(r)})}saveSettings(b){this.Gca=G.a(b);this.nec();return this.vpd()?this.VJj(b):this.bwe(b)}VJj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return v.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}bwe(b){const h={};h.Wac=b;const r=G.c(h);return new Promise(A=>{try{if(void 0===r||null===r||!r.length||1E6<=r.length)A(!1);else{var M=this.executeRequest(this.hGi(this.yLo),
2,"SaveAddinShortcutsPreferenceRequest","38",r);M.continueWith(()=>{if(M.yp||M.ij)v.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),A(!1);else{var ba=M.result;void 0!==ba.args&&null!==ba.args&&void 0!==ba.args.data&&null!==ba.args.data&&ba.args.data.He===ea.a.xz?A(!0):A(!1)}})}}catch(ba){v.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ba.toString()),A(!1)}})}getSetting(){const b=this.vpd();return this.Gca?Promise.resolve(G.c(this.Gca)):
b?this.VLm():this.dOf()}vpd(){const b=y.AFrameworkApplication.J.$("IsAnonymousUser"),h=y.AFrameworkApplication.J.$("IsRoamingServiceEnabled");var r=y.AFrameworkApplication.J.jb("Puid");const A=y.AFrameworkApplication.J.jb("UserPrincipalName");r=!(void 0===r||null===r)&&!(void 0===A||null===A)&&0<r.length&&0<A.length;return b||!h||!r}VLm(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return v.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",
b),Promise.resolve("")}}dOf(){return new Promise((b,h)=>{try{const r=this.executeRequest(this.hGi(this.xLo),1,"GetSettingRequest","37");r.continueWith(()=>{if(r.yp||r.ij)v.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let M="";var A=r.result;A&&A.args&&A.args.data?A.args.data.He!==ea.a.xz?v.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",A.args.data.He):A.args.data.Ee?(A=G.a(A.args.data.Ee),A.Wac&&(M=A.Wac)):v.ULS.sendTraceTag(522739865,
0,10,"GetSettingFromRoaming : ResponseData is null"):v.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(M)}})}catch(r){v.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",r.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.vpd(),r=this;return this.getSetting().then(A=>{let M=null;A&&(M=G.a(A));if(!M)return v.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const ba of tb.a.LR(M)){A=M[ba.toString()];for(const oa of tb.a.LR(A)){const Ja=A[oa];if(Ja.addinId===b)delete A[oa.toString()];else if(0===Ja.ownerType&&Ja.shortcutInfoArray){const jb=Ja.shortcutInfoArray,zb=new qb.a;for(let Eb=0;Eb<jb.length;++Eb)jb[Eb].addinId!==b&&zb.add(jb[Eb]);Ja.shortcutInfoArray=zb.toArray()}}tb.a.count(A)||delete A[ba]}r.Gca=M;r.tAo(b);return h?r.VJj(G.c(M)):r.bwe(G.c(M))})}nec(){if(this.Gca){this.Mra=null;const r=this.Gca;for(const A in r){var b=
A;const M=r[A];for(const ba in M){var h=ba;const oa=M[ba];oa.shortcutInfoArray&&this.Eef(parseInt(h),parseInt(b),oa.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>{let h=null;if(b&&!({hv:h}=G.d(b)).returnValue)return v.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.Gca=h;this.nec();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,
h,r){return this.Gca&&(r=this.Gca[r])&&(h=r[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.Gca&&(h=this.Gca[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,h,r){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),r)}setShortcutInfoArray(b,h,r){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),r).then(()=>{this.nec();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Mra)return Promise.resolve(!0);
var r=this.Mra[b];if(!r)return Promise.resolve(!0);var A=r[h];r=A.modifiers;A=A.keyCode;const M=this.getShortcutInfoArray(r.toString(),A.toString());if(!M||!M.length)return Promise.resolve(!0);let ba=0;for(const oa of M){if(oa.addinId===b&&oa.action===h)break;++ba}if(ba>=M.length)return Promise.resolve(!0);M.splice(ba,1);return this.saveShortcutInfoArray(r,A,M).then(()=>{this.nec();return Promise.resolve(!0)})}Eef(b,h,r){this.Mra||(this.Mra={});for(const A of r){r=A.addinId;const M=A.action;let ba=
this.Mra[r];ba||(ba={});const oa={};oa.modifiers=b;oa.keyCode=h;ba[M]=oa;this.Mra[r]=ba}}tAo(b){b in this.Mra&&delete this.Mra[b]}isActionCustomized(b,h){return this.Mra&&(b=this.Mra[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,h){return this.Mra&&(b=this.Mra[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.Gca}static instance(){ny.dhf||(v.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),ny.dhf=new ny,ny.aU=y.AFrameworkApplication.Ge);return ny.dhf}}ny.dhf=
null;ny.aU=null;Object(u.a)(ny,"AddinShortcutsPreferenceSettingHelper",null,[]);class Cw{constructor(b,h){this.Zyd=null;new qb.a;this.aph=!0;this.rCd=b;this.$jh=h}bgf(b){this.$jh.addHandler("GoalChangedEvent",b)}NUn(){this.$jh.raiseEvent("GoalChangedEvent")}sYf(b,h){return this.Zyd&&this.aph?b in this.Zyd?this.Zyd[b]:"Formality"===h&&this.rCd.TNf().formality?!1:!0:!0}PUo(b,h){h===this.rCd.TNf().formality&&(this.Zyd=b,this.NUn())}fzp(b){this.aph=b}}Object(u.a)(Cw,"GoalChangeSource",null,[392,393,394]);
var PB=d(1588),QB=d(1705),YH=d(1418);class e{constructor(b,h,r,A,M,ba){this.nRa=h;this.nGa=r;this.Re=b;this.XC=A;this.Rg=M;this.Dyk=ba;this.nGa.lTb()&&this.initialize()}initialize(){return this.XC.Bm().then(()=>{this.Re.nb(this,PB.a.getTypeName());this.Re.addHandler(this,QB.a.getTypeName())}).catch(b=>{this.Rg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}oH(b,h){if(h===ia.a.getTypeName()||h===YH.a.getTypeName())if(!b||!b.content)this.Rg.sendTraceTag(528274564,
2252,10,"Handled annotation is invalid");else if(Tb.a.getTypeNameFor(b.content)===PB.a.getTypeName()||Tb.a.getTypeNameFor(b.content)===QB.a.getTypeName())if(Tb.a.getTypeNameFor(b.content)===PB.a.getTypeName()){var r=b.content;this.Rg.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",r.critiqueConfiguration.formalityGoal);this.nRa.PUo(r.critiqueConfiguration.mapping,r.critiqueConfiguration.formalityGoal)}else if(Tb.a.getTypeNameFor(b.content)===QB.a.getTypeName())if(b=
b.content,b.features){for(r of b.features)if("Goals"===r.featureName){this.Dyk.fzp(!!r.supportType);return}this.Rg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Rg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(u.a)(e,"GoalsAnnotationHandler",null,[155]);class n{constructor(b){this.Ga=b}lTb(){return this.Ga.$("EditorGoalsEnabled")}}Object(u.a)(n,"GoalsGate",null,[391]);var D=d(1132),U=d(1139),ha=d(1526);class Ea{}
Ea.NZd=0;Ea.TZd="1.0";Ea.settingType="Goals";Object(u.a)(Ea,"GoalsConstants",null,[]);var mb=d(1587);class Wb{constructor(b,h,r,A,M){this.n$b=null;this.QYi=!1;this.Jzh=b;this.tCd=h;this.Rg=r;this.nGa=A;this.JTe=M;this.nGa.lTb()?this.uqo():this.nGa.lTb()&&this.nyg(Ea.NZd,Ea.TZd)}uqo(){new Promise(b=>{this.Jzh.uEi(Ea.settingType,h=>{this.vqo(h)?(this.nyg(this.n$b.formality,this.n$b.version),b(this.n$b)):(this.nyg(Ea.NZd,Ea.TZd),b(null))})})}vqo(b){this.QYi=!0;if(!b||!b.Nyb)return this.Rg.sendTraceTag(528274529,
2252,50,"No persisted goal is registered."),!1;b=b.Nyb.properties;var h=b.getValue(Rc.a.xTi);h=parseInt(h);b=b.getValue(Rc.a.yTi);if(!this.tCd.iOg(b))return this.Rg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.n$b=b=Object.assign(new mb.a,{formality:h,version:b});this.Rg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}nyg(b,h){b=Object.assign(new ha.a,
{formality:b,version:h});this.JTe.rMj(b)}PMp(b){if(this.tCd.iOg(b.version)){var h=D.a.tHl(b.version,b.formality.toString());this.Jzh.iOh(Object.assign(new U.a,{Nyb:h,settingType:Ea.settingType}))?this.n$b=b:this.Rg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Rg.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}cBi(){this.QYi||this.Rg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");
return this.n$b}}Object(u.a)(Wb,"GoalsPersistenceHandler",null,[390]);class tc{constructor(b,h,r,A){this.Rg=b;this.KTe=h;this.tCd=r;this.nGa=A;this.sCd=Object.assign(new mb.a,{formality:Ea.NZd,version:Ea.TZd});this.N8e=this.nGa.lTb()}TNf(){this.N8e&&(this.N8e=!1,this.KTe.cBi()&&(this.sCd=this.KTe.cBi()));return this.sCd}O_o(b){this.N8e=!1;this.tCd.iOg(b.version)?(this.nGa.lTb()&&this.KTe.PMp(b),this.sCd=b):(this.Rg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",
b.version),this.sCd=Object.assign(new mb.a,{formality:Ea.NZd,version:Ea.TZd}))}}Object(u.a)(tc,"GoalsProvider",null,[388,389]);class Fc{constructor(b,h,r,A){this.Re=b;this.XC=h;this.RY=r;this.Rg=A}rMj(b){b=Object.assign(new ia.a,{parentPath:["Signal",ha.a.getTypeName()],items:[Object.assign(new nb.a,{body:b})]});this.j1d(b)}j1d(b){this.XC.Bm().then(()=>{this.Xdf(b)}).catch(h=>{this.Rg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}Xdf(b){this.Re.activateAnnotation(PB.a.getTypeName(),
Fc.qdc).then(()=>{this.RY.getAugLoopRuntimeManager().submitOperation(Object.assign(new na.a,{operation:b}))}).catch(h=>{this.Rg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}Fc.qdc="GoalSelected";Object(u.a)(Fc,"GoalsSignalSender",null,[387]);class Yc{constructor(){Yc.Ecf=new RegExp(Yc.cTk)}iOg(b){return!!b.match(Yc.Ecf)&&1===b.match(Yc.Ecf).length}}Yc.cTk="[0-9]+[.]?[0-9]*";Yc.Ecf=null;Object(u.a)(Yc,"GoalsValidator",null,[386]);class od{constructor(){this.Z=
null}get name(){return"WordEditor.Goals"}init(){this.Z.resolve(1044)}dispose(){}uc(b){this.Z=b;this.Z.ia("WordEditor.Goals.GoalsValidator",()=>new Yc).as(1046).ha();this.Z.ia(1047,()=>new n(this.Z.resolve(71))).ha();this.Z.ia("WordEditor.Goals.GoalsProvider",()=>new tc(this.Z.resolve(460),this.Z.resolve(1045),this.Z.resolve(1046),this.Z.resolve(1047))).as(1048).as(1435).ha();this.Z.ia("WordEditor.Goals.GoalChangeSource",()=>new Cw(this.Z.resolve(1048),new Fd.a)).as(1056).as(1051).as(1052).ha();this.Z.ia(1045,
()=>new Wb(this.Z.resolve(1049),this.Z.resolve(1046),this.Z.resolve(460),this.Z.resolve(1047),this.Z.resolve(1050))).as("WordEditor.Goals.IGoalsPersistenceHandler").ha();this.Z.ia(1044,()=>new e(this.Z.resolve(454),this.Z.resolve(1051),this.Z.resolve(1047),this.Z.resolve(659),this.Z.resolve(460),this.Z.resolve(1052))).as(1044).ha();this.Z.ia("WordEditor.Goals.GoalsSignalSender",()=>new Fc(this.Z.resolve(454),this.Z.resolve(659),this.Z.resolve(660),this.Z.resolve(460))).as(1050).ha()}static main(){E.a.instance.Mc(new od)}}
Object(u.a)(od,"WordEditorGoalsPackage",null,[0,1]);var Ad=d(1838),vd=d(625),pe=d(1439);class ne{constructor(){this.annotation=null;this.languages=new pk.a(Wa.a.vh())}}Object(u.a)(ne,"CritiqueCountWrapper",null,[]);class Ee{constructor(){this.Owa=new fb.a}P5d(){return this.Owa}TQi(b,h,r,A){if(this.Owa.mb(r)){this.Owa.K(r).annotation.count+=h;r=this.Owa.K(r).languages;for(var M of A)r.add(M)}else M=P.a.create().toString(),b=Object.assign(new pe.a,{id:M,categoryName:b,count:h}),this.Owa.add(r,Object.assign(new ne,
{annotation:b,languages:A}))}}Ee.pj=389;Object(u.a)(Ee,"BaseCritiquesByTypeCounter",null,[370]);class cf extends Ee{constructor(b){super();this.HHb=new Pa.a;this.uOe=new Pa.a;this.ZPd=b}EVm(b){const h=b.annotation;try{if(h&&vd.a(Tb.a.getTypeNameFor(h.content))){const r=h.content;if(b.opType===ia.a.getTypeName()){this.ZPd.LCo(h.parentPath,r);const A=r.M_.state;if(60!==A&&70!==A)return this.HHb.contains(h.id)&&this.HHb.remove(h.id),this.P6m(h.id,r),Ad.a.yzb(h,8),!0;this.HHb.add(h.id)}else if(b.opType===
Cc.a.getTypeName())if(this.HHb.contains(h.id))this.HHb.remove(h.id);else if(this.Uci(r.typeId,h.id))return Ad.a.yzb(h,16),!0}}catch(r){Ad.a.mcd(r,[h],!0)}return!1}DVm(b){if((b=b.annotation)&&vd.a(Tb.a.getTypeNameFor(b.content))){const h=b.content,r=h.M_.state;if((60===r||70===r)&&!this.HHb.contains(b.id))return this.HHb.add(b.id),this.Uci(h.typeId,b.id)}return!1}P6m(b,h){this.uOe.add(b);b=new pk.a(Wa.a.vh());h.language&&b.add(h.language);this.TQi(h.categoryName,1,h.typeId,b)}Uci(b,h){if(!this.uOe.contains(h))return!1;
if(!this.Owa.mb(b))return v.ULS.sendTraceTag(589866503,Ee.pj,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Owa.K(b).annotation.count)return v.ULS.sendTraceTag(589866504,Ee.pj,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.uOe.remove(h);this.Owa.K(b).annotation.count--;return!0}}Object(u.a)(cf,"AlCritiquesByTypeCounter",
Ee,[373,370]);var rg=d(1654);class hh extends iw.a{constructor(b,h,r,A,M,ba,oa,Ja,jb){var zb;super();this.Re=b;this.ZPd=h;this.jKe=r;this.Weh=A;this.nRa=M;this.Txa=ba;this.oj=oa;this.Ida=this.qdh=!1;this.Z1e=new fb.a;this.n_n=(Eb,Sb)=>{this.ZPd.EWm(Sb)&&(this.Ida=!0,this.z0())};this.mXn=(Eb,Sb)=>{this.jKe.EVm(Sb)&&this.G_b()};this.Hkj=()=>{this.G_b()};this.Udg=(Eb,Sb)=>{this.jKe.DVm(Sb)&&this.G_b()};this.Svb=()=>{this.G_b()};this.G_b=()=>{let Eb=!1;this.oj.ee(()=>{var Sb=this.npm();const nc=new qb.a;
for(const Dc of Sb)Sb=Object.assign(new rg.a,{id:Dc.id,parentPath:bt.a.RNb,content:Dc,annotationType:Tb.a.getTypeNameFor(Dc)}),nc.add(Sb),Eb||(Eb=0<Dc.count);this.Re.OUo(nc)},"CC:SATH");!this.qdh&&Eb&&(ca.a.sendTelemetryEvent({...(new ja.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),this.qdh=!0)};this.ajn=(Eb,Sb,nc)=>{const Dc=!this.nRa||this.nRa.sYf(Eb,nc);Eb=this.Txa&&this.Txa.instance?this.Txa.instance.rYf(Eb,nc,Sb.substr(1,Sb.length-2)):!0;return Dc&&Eb};null===Ja||void 0===Ja?void 0:
Ja.bgf(this.Svb);jb.sva(this,7);null===(zb=this.Txa)||void 0===zb?void 0:zb.execute(Eb=>{Eb.Bgf(this.G_b)})}get index(){return 3}run(){this.Ida&&(this.G_b(),this.Ida=!1)}fnj(){this.G_b()}$Dl(b){let h=0;if(({value:h}=this.Z1e.Ec(b.categoryName,0)).returnValue)if(h!==b.count)this.Z1e.W(b.categoryName,b.count);else return!1;else this.Z1e.add(b.categoryName,b.count);return!0}npm(){const b=new fb.a;var h=this.ZPd.P5d();const r=this.jKe.P5d();this.TLg(b,h);this.TLg(b,r);this.Weh&&(h=this.Weh.P5d(),this.TLg(b,
h));h=new qb.a;for(const A of b.values)this.$Dl(A)&&h.add(A);return h}TLg(b,h){for(const M of h){h=M.value.annotation;const ba=M.key;var r=this.LSo(M.value.languages);if(!b.mb(h.categoryName)){var A=P.a.create().toString();A=Object.assign(new pe.a,{id:A,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,A)}this.ajn(ba,r,h.categoryName)&&(r=b.K(h.categoryName),r.count+=h.count,r.countsByTypeId[ba]=(r.countsByTypeId[ba]?r.countsByTypeId[ba]:0)+h.count)}}LSo(b){const h=[];let r=
0;for(const A of b)h[r++]=A;return G.c(h)}}Object(u.a)(hh,"CritiquesCounter",iw.a,[372,162]);class Yh{constructor(b){this.w5=b}P5d(){const b=new fb.a,h=new pk.a(Wa.a.vh()),r=Object.assign(new pe.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.w5.DFc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new ne,{annotation:r,languages:h}));return b}}Object(u.a)(Yh,"DictationCritiquesByTypeCounter",null,[371,370]);class yj extends Ee{constructor(b){super();
this.nhb=new fb.a;this.Re=b}EWm(b){const h=bt.a.i8d(b.nodeId);if(!bt.a.Uf(h)){if(b.Apb&&b.Apb.length){let r=null;for(const A of b.Apb)A.errorDetails.Aab()||(b=this.ywi(A),bt.a.Uf(b)||(r||(r=new fb.a),r.mb(b)||r.add(b,new qb.a),r.K(b).add(A)));this.Vci(h);r?this.LYo(h,r):this.nhb.remove(h)}else{if(!this.nhb.mb(h))return!1;this.Vci(h);this.nhb.remove(h)}return!0}return!1}LCo(b,h){var r;if(({value:r}=this.nhb.Ec(b,r)).returnValue)for(const M of r)if(b=M.value,0<b.count&&this.MIf(b.K(0))===h.categoryName)for(r=
b.count-1;0<=r;r--){var A=b.K(r).end-b.K(r).Dc;b.K(r).Dc===h.range.start&&A===h.range.length&&(A=this.ywi(b.K(r)),this.Owa.mb(A)&&(A=this.Owa.K(A).annotation,A.count=Math.max(0,A.count-1)),b.removeAt(r))}}Vci(b){if(this.nhb.mb(b))for(const r of this.nhb.K(b)){var h=r.key;b=r.value;this.Owa.mb(h)&&(h=this.Owa.K(h).annotation,h.count=Math.max(0,h.count-b.count))}}LYo(b,h){const r=new fb.a,A=new fb.a;for(const M of h){h=M.key;A.add(h,new pk.a(Wa.a.vh()));for(const ba of M.value){const oa=ba.end-ba.Dc,
Ja=this.MIf(ba);this.Ypl(b,Ja,ba.Dc,oa)?v.ULS.sendTraceTag(589866513,Ee.pj,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",h,b,ba.Dc,oa):(r.mb(h)||r.add(h,new qb.a),r.K(h).add(ba),A.K(h).add(this.ppm(ba)))}}this.nhb.W(b,r);for(const M of this.nhb.K(b))0<M.value.count&&(b=this.MIf(M.value.K(0)),this.TQi(b,M.value.count,M.key,A.K(M.key)))}ywi(b){let h=null;b&&(b=Object(Ma.a)(368,b.errorDetails))&&b.Du&&(h=b.Du.TypeId);return h}MIf(b){let h=
null;b&&(b=Object(Ma.a)(368,b.errorDetails))&&b.Du&&(h=b.Du.CategoryTitle);return h}ppm(b){let h="";b&&b.errorDetails&&(h=Ag.a.Hg(b.errorDetails.lcid).name);return h}Ypl(b,h,r,A){if((b=this.Re.V4d(b))&&0<b.count)for(const M of b)if(b=Tb.a.getTypeNameFor(M.content),M&&vd.a(b)&&(b=M.content,b.categoryName===h&&b.range.start===r&&b.range.length===A))return!0;return!1}}Object(u.a)(yj,"WacCritiquesByTypeCounter",Ee,[369,370]);class dl{constructor(){this.Z=null}get name(){return"WordEditor.CritiqueCounts"}uc(b){this.Z=
b}init(){var b=this.Z.resolve(71);if(b.$("AugLoopOperationsAreEnabled")){this.Z.ia(1053,()=>new yj(this.Z.resolve(454))).ha();this.Z.ia(1054,()=>new cf(this.Z.resolve(1053),this.Z.resolve(71))).ha();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.Z.ia(1055,()=>new Yh(this.Z.resolve(68))).ha();this.Z.ia(1057,()=>new hh(this.Z.resolve(454),this.Z.resolve(1053),this.Z.resolve(1054),this.Z.Oa(1055),this.Z.Oa(1051),this.Z.Ra(998),vp.a.instance,this.Z.Oa(1056),this.Z.resolve(201))).ha();
b=this.Z.resolve(1057);this.Z.resolve(43).UPh(b.n_n);this.Z.resolve(454).GPh(b.mXn);this.Z.resolve(454).FPh(b.Udg);h&&(h=this.Z.resolve(324),h.qPh(b.Hkj),h.rPh(b.Hkj))}}dispose(){}static main(){E.a.instance.Mc(new dl)}}Object(u.a)(dl,"WordEditorCritiqueCountsPackage",null,[0,1]);class Sm{get name(){return"WordEditor.GraphicsEditor"}uc(){}init(){}dispose(){}static main(){E.a.instance.Mc(new Sm)}}Object(u.a)(Sm,"PackageManager",null,[0,1]);var Cl=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},
children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",
Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",
Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",
LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",
LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class Gk{constructor(b){this.ivk={};this.Zb=b;this.RHb=new dh.a}oVa(b,h){const r=this.Zb.Qwb,A=parseInt(b);return b&&A!==kd.ActionManager.pAf?this.RHb.mb(r)?(b=this.RHb.K(r).Plc(A,h,2),32===b||1===b):!1:!1}SLa(b){const h=parseInt(b),r=this.Zb.Qwb;return b&&h!==kd.ActionManager.pAf?this.RHb.mb(r)?32===this.RHb.K(r).Plc(h,this.ivk,1):!1:!0}DBj(b,h){this.RHb.W(b,h)}bTj(b){b=parseInt(b);const h=this.Zb.Qwb;return!!h&&!!this.RHb.K(h)&&this.RHb.K(h).cin(b)}}
Object(u.a)(Gk,"NonCanvasCuiUser",null,[1814,365]);var gk=d(1163),zj;(function(b){b[b.HTp=0]="UnspecifiedGallery";b[b.oOp=1]="CharacterCodeGallery";b[b.PPp=2]="FontStyleGallery";b[b.qQp=3]="InkThicknessGallery";b[b.mQp=4]="IconGallery";b[b.IQp=5]="ListGallery";b[b.dTp=6]="TableStyleGallery";b[b.KRp=7]="PageNumberGallery";b[b.nOp=8]="ChangeColorsGallery"})(zj||(zj={}));Object(u.b)("GalleryType",zj);class yg{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(u.a)(yg,"CommonGalleryButtonProps",
null,[]);class ap extends yg{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(u.a)(ap,"AdditionalTableStyleGalleryButtonProps",yg,[]);class tk extends ap{constructor(){super()}}Object(u.a)(tk,"AdditionalChangeColorsGalleryButtonProps",ap,[]);class Au extends yg{constructor(){super();this.character=null}}Object(u.a)(Au,"AdditionalCharacterCodeGalleryButtonProps",yg,[]);class qA extends yg{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}
Object(u.a)(qA,"AdditionalFontStyleGalleryButtonProps",yg,[]);class ZH{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(u.a)(ZH,"AdditionalGalleryProperties",null,[]);class $H extends yg{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.role=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(u.a)($H,"AdditionalIconButtonProperties",
yg,[]);class aI extends yg{constructor(){super();this.styleDisplayName=null}}Object(u.a)(aI,"AdditionalInkThicknessGalleryButtonProps",yg,[]);class tD extends yg{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(u.a)(tD,"AdditionalListGallerButtonProps",yg,[]);class rA extends yg{constructor(){super();this.text=null}}Object(u.a)(rA,"AdditionalPageNumberGalleryButtonProps",yg,[]);var iz=d(1095);const qx=(b,h)=>{var r=appChrome.selectors.getActiveControlStates();if(r=Object(Ma.a)(Object,
r[b])){if((b=Object(Ma.a)(String,r.value))&&b===h)return!1;b=Object(Ma.a)(String,r.selectedKey);if(!h&&!b)return!1;if(b){r=Array.isArray(r.options)?r.options:null;let A=null;for(let M=0;M<r.length;M++){const ba=Object(Ma.a)(Object,r[M]);if(Object(Ma.a)(String,ba.key)===b){A=ba;break}}if(A&&Object(Ma.a)(String,A.text)===h)return!1}}return!0},iK=(b,h,r,A)=>{if(0<(A&2)){A=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":A.push(jq(b,r[Ng.a.On]));break;case "CheckboxModel":A.push(appChrome.actions.toggleCheckbox(b,
r[Ng.a.On]));break;case "ComboBoxModel":if(!qx(b,r[ka.a.Value]))break;(h=r[ka.a.Key])?A.push(appChrome.actions.updateComboBoxKey(b,h,r[ka.a.Value])):A.push(appChrome.actions.updateComboBoxValue(b,r[ka.a.Value]));break;case "FontPickerModel":A.push(appChrome.actions.updateFontPickerSelectedFont(b,r[iz.a.SelectedFont]));break;case "SplitButtonModel":A.push(jq(b,r[wm.a.On]));break;case "SpinButtonModel":A.push(appChrome.actions.updateSpinButton(b,r[ki.a.Number],Cg.a.r7a(r[ki.a.UnitType]),r[ki.a.Text],
r[ki.a.MaxValue],r[ki.a.Alt]));break;case "ColorPickerModel":A.push(appChrome.actions.updateColorPickerSelectedColor(b,r[fo.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":A.push(appChrome.actions.updatePageNumberGalleryButtonText(b,r[Jd.a.Text]));break;case "CompoundButtonModel":r[Ng.a.Description]&&A.push(appChrome.actions.updateCompoundButtonDescription(b,r[Ng.a.Description]));Ng.a.On in r&&A.push(jq(b,r[Ng.a.On]));break;case "SliderModel":r.snapToStep?A.push(appChrome.actions.updateSliderSelectedValue(b,
r[Hj.Value])):A.push(appChrome.actions.updateSliderValue(b,r[Hj.Value],r[Hj.MinValue]||0,r[Hj.MaxValue],r[Hj.Text]));break;case "FlyoutAnchorModel":Vc.a.ImageIsVisible in r&&A.push(appChrome.actions.hideFlyoutAnchorIcon(b,!r[Vc.a.ImageIsVisible]));Ng.a.On in r&&A.push(jq(b,r[Ng.a.On]));break;case "InputBoxModel":A.push(appChrome.actions.updateInputBoxValue(b,r[sl.a.Text]))}h=A;var M=Object(Ma.a)(String,r[Cm.a.iconColor]);void 0!==M&&null!==M&&h.push(appChrome.actions.updateIconColor(b,M));Iv(b,r,
A);h=A;(M=Object(Ma.a)(Object,r[Cm.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,M));h=A;M=Object(Ma.a)(String,r[Cm.a.customTooltip]);void 0!==M&&null!==M&&h.push(appChrome.actions.setControlCustomTooltip(b,M));b=A;(r=Array.isArray(r[Cm.a.Sqg])?r[Cm.a.Sqg]:null)&&b.push.apply(b,r);return A}return null},Cs=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),jq=(b,h)=>appChrome.actions.toggleButton(b,h),Iv=(b,h,r)=>{h=Object(Ma.a)(String,h[Cm.a.Icon]);void 0!==h&&null!==h&&
r.push(appChrome.actions.setControlIcon(b,h))};class bI{constructor(b,h,r,A){this.tl=A;this.cya=b;this.DB=h;this.bac=r;this.xKc={}}Zeo(b,h,r,A,M=null){const ba=b.ExternalGalleryId||b.ExternalId;var oa=b.ExternalId;A.push(ba);if(appChrome.selectors.isControlDefined(ba))b.GalleryStyle&&zg.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(ba,b.GalleryStyle));else{if(4!==b.Type)return;r.push(appChrome.api.createGalleryModel(ba,Object.assign(new ZH,{columns:b.Width,sections:[appChrome.api.gallerySection([],
oa)],styles:b.GalleryStyle,galleryType:"IconGallery"})))}r=0;if(zg.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){oa=[];A=[];const jb=[],zb={};for(var Ja of b.GallerySections){oa.push(appChrome.api.gallerySection([],Ja.SectionId,Ja.Title));0===r&&Ja.GalleryButtons&&0<Ja.GalleryButtons.length&&(r=Ja.GalleryButtons[0].Type);this.OEi(Ja.GalleryButtons,M,zb);const Eb=this.Pef(A,Ja.GalleryButtons,zb);A.push.apply(A,this.ZMf(Eb,ba,Ja.SectionId,!1,r,M,!0,zb));jb.push.apply(jb,Eb)}h.push(appChrome.actions.setGallerySections(ba,
oa));h.push.apply(h,A);h.push.apply(h,this.rKf(ba,zj[r],jb,null,5===b.Type,!0,null,zb))}else b.GalleryItems&&0<b.GalleryItems.length&&(r=b.GalleryItems[0].Type),Ja=this.OEi(b.GalleryItems,M,null),h.push.apply(h,this.ZMf(this.Pef(h,b.GalleryItems,Ja),ba,oa,!1,r,M,!1,Ja))}FHm(b,h){const r=[];let A=null,M=!1;if(!b)return null;const ba=this.cya.vhd(this.DB,b.commandId,h);r.push(Cs(b.externalUxCommand,!ba));if(b.previewControlIds){const jb=[];for(let zb=0;zb<b.previewControlIds.length;zb++){var oa={},
Ja=b.previewControlIds[zb];oa.SourceControlId=Ja;const Eb=this.tl.getCommandByExternalUxId(Ja);this.v8d(Eb||b,oa);oa[Jd.a.On]&&(A=oa.SourceControlId,oa[Jd.a.HighlightOn]&&(M=!0));Iv(Ja,oa,r);if(oa=Object(Ma.a)(oB.a,oa[Jd.a.GalleryButtonProps]))jb.push(oa),ba&&(Ja=this.cya.vhd(this.DB,oa.Command,h),oa.IsDisabled=!Ja)}0<jb.length&&r.push.apply(r,this.ZMf(this.Pef(r,jb),b.externalUxCommand,b.externalUxCommand,!0,jb[0].Type));r.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,A));M&&
(v.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",A),r.push(appChrome.actions.highlightSelectedFontStyle(A)))}return r}Pef(b,h,r=null){const A=[],M=[];for(let oa=0;oa<h.length;oa++){const Ja=h[oa],jb=Mf.b(Ja.ExternalId)?Ja.Id:Ja.ExternalId;A.push(jb);const zb=r&&r[jb]?r[jb].result:-1;switch(Ja.Type){case 1:var ba=Ja;M.push(appChrome.api.createCharacterCodeGalleryButtonModel(jb,Object.assign(new Au,{disabled:-1!==zb?1>(zb&1):ba.IsDisabled,character:ba.Character,
style:ba.Style,title:ba.Alt})));break;case 2:ba=Ja;M.push(appChrome.api.createFontStylesGalleryButtonModel(jb,Object.assign(new qA,{disabled:-1!==zb?1>(zb&1):ba.IsDisabled,styleDisplayName:ba.LabelText,style:ba.Style,title:ba.Alt,previewStyleLabel:ba.PreviewStyleLabel})));break;case 3:ba=Ja;M.push(appChrome.api.createInkThicknessGalleryButtonModel(jb,Object.assign(new aI,{disabled:-1!==zb?1>(zb&1):ba.IsDisabled,styleDisplayName:ba.LabelText,style:ba.Style,title:ba.Alt})));break;case 4:ba=Ja;M.push(appChrome.api.createIconGalleryButtonModel(jb,
Object.assign(new $H,{disabled:-1!==zb?1>(zb&1):ba.IsDisabled,icon:[ba.Icon],role:ba.Role,fullIconStyle:ba.FullIconStyle,previewIconStyle:ba.PreviewIconStyle,largePreviewIconStyle:ba.LargePreviewIconStyle,label:ba.LabelText,title:ba.Alt})));break;case 5:ba=Ja;M.push(appChrome.api.createListGalleryButtonModel(jb,Object.assign(new tD,{disabled:-1!==zb?1>(zb&1):ba.IsDisabled,infoAtLevel:ba.LevelInfo,ariaLabel:ba.Alt})));break;case 6:ba=Ja;M.push(appChrome.api.createTableStyleGalleryButtonModel(jb,Object.assign(new ap,
{disabled:-1!==zb?1>(zb&1):ba.IsDisabled,tableCellStyles:ba.TableCellStyles,tableStyles:ba.TableStyles,title:ba.Alt,columns:ba.columns})));break;case 8:ba=Ja;M.push(appChrome.api.createChangeColorsGalleryButtonModel(jb,Object.assign(new tk,{disabled:-1!==zb?1>(zb&1):ba.IsDisabled,tableCellStyles:ba.TableCellStyles,tableStyles:ba.TableStyles,title:ba.Alt})));break;case 7:ba=Ja,M.push(appChrome.api.createPageNumberGalleryButtonModel(jb,Object.assign(new rA,{disabled:-1!==zb?1>(zb&1):ba.IsDisabled,text:ba.Text,
title:ba.Alt})))}this.tl.addCommandToMaps(Object.assign(new Kq.a(jb,Ja.Command),{queryCommandId:Ja.QueryCommand,menuItemId:Ja.MenuItemId}))}b.push(appChrome.actions.addControls(M));return A}ZMf(b,h,r,A,M,ba=null,oa=!1,Ja=null){const jb=[];A?jb.push(appChrome.actions.populateGalleryItems(h,b)):(this.xKc[h]=!1,oa||(A=!0,appChrome.selectors.isControlDefined(h)&&(A=appChrome.selectors.getGalleryState(h),A=A.disableIndividualButtons?A.disableIndividualButtons:!0),jb.push.apply(jb,this.rKf(h,zj[M],b,null,
5===M,A,ba,Ja))),jb.push(appChrome.actions.updateGallerySectionItems(h,r,b)));return jb}ivm(b){return this.rKf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}rKf(b,h,r,A,M,ba=!0,oa=null,Ja=null){const jb=[];if(b in this.xKc){if(this.xKc[b])return delete this.xKc[b],jb;this.xKc[b]=!0}let zb=null,Eb=-1;if(r)({Pri:Eb,returnValue:zb}=this.zNh(h,r,jb,ba,oa,Ja));else if(A)for(const Sb of A)(r=({Pri:Eb}=this.zNh(h,Sb.galleryButtons,
jb,ba,null,Ja)).returnValue)&&(zb=r);jb.push(appChrome.actions.updateGallerySelectedId(b,zb));ba&&jb.push(Cs(b,!1));M&&0<Eb&&jb.push(appChrome.actions.updateListGalleryTextDirection(b,2===Eb));return jb}NEi(b,h=null){const r={},A={};A.SourceControlId=b;A.Location=h;b=this.tl.getCommandByExternalUxId(b);if(!b)return r.result=-1,r.props=A,r;b=this.v8d(b,A);r.result=b;r.props=A;return r}OEi(b,h=null,r=null){r||(r={});for(const A of b)b=Mf.b(A.ExternalId)?A.Id:A.ExternalId,r[b]=this.NEi(b,h);return r}zNh(b,
h,r,A,M=null,ba=null){let oa,Ja=null;oa=-1;let jb=!1;for(const Eb of h){var zb=this.fvm(b);h=ba&&ba[Eb]&&-1!==ba[Eb].result?ba[Eb]:this.NEi(Eb,M);const Sb=h.result;h=h.props;A&&r.push(Cs(Eb,1>(Sb&1)));(zb=iK(Eb,zb,h,Sb))&&r.push.apply(r,zb);h[Jd.a.On]&&(Ja=Eb,h[Jd.a.HighlightOn]&&h[Jd.a.HighlightOn]&&(jb=!0));void 0!==h[Cm.a.labelText]&&null!==h[Cm.a.labelText]&&(zb=this.tl.getCommandByExternalUxId(Eb),r.push(appChrome.actions.setControlLabel(zb.externalUxCommand,h[Cm.a.labelText])));h[Jd.a.IsRtl]&&
0>oa&&(oa=h[Jd.a.IsRtl])}jb&&(v.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Ja),r.push(appChrome.actions.highlightSelectedFontStyle(Ja)));return{returnValue:Ja,Pri:oa}}fvm(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";
case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}v8d(b,h){h.MenuItemId=b.menuItemId;return this.cya.Nua(this.DB,this.bac,b.commandId,b.queryCommandId,h)}}Object(u.a)(bI,"ReactGalleryPoller",null,[]);var sA=d(698),Jv=d(650),tA=d(1708),oy=d(775),pt=d(1709);class BF{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;
this.isSubscriber=!1;this.previewFontFamily=null}}Object(u.a)(BF,"PopulateFontPickerDataProps",null,[]);var Mt=d(289),Bu=d(1895);class Nt{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(u.a)(Nt,"CommonOptionalButtonProperties",null,[]);class uA extends Nt{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=
!1}}Object(u.a)(uA,"OptionalButtonProperties",Nt,[]);class uD extends Nt{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(u.a)(uD,"OptionalCompoundButtonProperties",Nt,[]);class cI extends Nt{constructor(){super();this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(u.a)(cI,"OptionalErrorViewProperties",Nt,[]);class vD extends Nt{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=
null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(u.a)(vD,"OptionalFlyoutAnchorProperties",Nt,[]);class dI extends Nt{constructor(){super();this.isBanner=null}}Object(u.a)(dI,"OptionalLabelProperties",Nt,[]);class py extends Nt{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}
Object(u.a)(py,"OptionalMultipActionButtonProperties",Nt,[]);class qy extends uA{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(u.a)(qy,"OptionalPersonaButtonProperties",uA,[]);class dm extends Nt{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1;this.stylingParameters=null}}Object(u.a)(dm,"OptionalToggleButtonProperties",Nt,[]);var zL=d(1711),jK=d(1710),kK=d(483);class Ld{constructor(){this.M4h=this.actions=null;this.Ibk=!1}}
Object(u.a)(Ld,"PopulateActions",null,[]);class ev{EHi(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.xIm(b);case "InkButtonModel":return this.wIm(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}xIm(b){const h={};h[Ng.a.On]=appChrome.selectors.getButtonToggleState(b);
return h}wIm(b){const h={};h[Ng.a.On]=zg.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(u.a)(ev,"ReactStatePropsSelector",null,[]);class Aj{constructor(b,h,r,A,M){this.cya=b;this.DB=h;this.bac=r;this.tl=A;this.q$e={};this.WKk=new ev;this.BHb=M}AWj(b){const h=b.populationProps.populateQueryCommandId;return b.populationProps.populateOnlyOnce&&h in this.q$e}ZIm(b,h,r=null){const A=[],M={};if(!this.AWj(b)){const ba=
b.populationProps.populateQueryCommandId,oa={};oa.MenuId=b.externalUxCommand;oa.IsShadowMenuOpen=this.isShadowMenuOpen(r);if(0<(this.cya.Nua(this.DB,this.bac,ba,ba,oa,this.Pxm(r))&1))if("FontPickerModel"===h)this.q$e[ba]=!0,A.push(Aj.jHm(b,oa)),M[b.externalUxCommand]="FontPickerModel";else if(oa.MenuItems)switch(this.q$e[ba]=!0,h){case "ComboBoxModel":A.push(Aj.hHm(b,oa));M[b.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":A.push.apply(A,
this.UJi(b.externalUxCommand,h,oa.MenuItems,M,r&&"location"in r?r.location:null))}}return Object.assign(new Ld,{actions:A,M4h:M,Ibk:this.isShadowMenuOpen(r)})}dCi(b,h,r,A,M,ba,oa,Ja,jb=null){let zb=null;const Eb=[];Mf.c(b.Title)||(zb=b.Title);for(let Sb=0;Sb<b.ControlList.length;Sb++){const nc=Object(Ma.a)(Bo.a,b.ControlList[Sb]);if(!nc||nc.ExternalId)ba&&this.qnm(nc,ba),h.push.apply(h,this.iHm(nc,oa,Eb,M,r,A,jb))}return Ja?appChrome.api.menuSection(Eb,zb,b.Lang):null}UJi(b,h,r,A,M=null){const ba=
[],oa=[],Ja=[],jb=[];for(var zb=0;zb<r.MenuSectionList.length;zb++){var Eb=Object(Ma.a)(xh.a,r.MenuSectionList[zb]);Eb&&(Eb=this.dCi(Eb,ba,b,h,jb,A,oa,r.UpdateDynamically,M),r.UpdateDynamically&&Ja.push(Eb))}zb=null;r.MenuFooterSection&&(zb=this.dCi(r.MenuFooterSection,ba,b,h,jb,A,oa,r.UpdateDynamically,M));r.UpdateDynamically&&ba.push(appChrome.actions.updateMenu(b,Ja,r.Title,r.AriaLabel,r.ShouldAutoOpen,r.AriaRoleDescription,r.MenuTargetDescriptor,zb,r.IsFlexLayout));0<oa.length&&ba.splice(0,0,
appChrome.actions.addControls(oa));0<jb.length&&zg.d("setStatefulSplitButtonMruBypassControls")&&ba.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,jb));return ba}qnm(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(Ma.a)(Wx.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");
break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}iHm(b,h,r,A,M,ba,oa=null){const Ja=[];switch(b.ControlType){case 14:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(A=Object(Ma.a)(oy.a,b),null!=A.IsBanner&&A.IsBanner&&this.Heo(Object(Ma.a)(oy.a,b),Ja,h,r));break;case 1:case 3:b=Object(Ma.a)(Pj.a,b);this.Jeo(b,Ja,h,r);b.MenuItemsStatefulData&&zg.d("setStatefulSplitButtonMenuItemsStatefulData")&&Ja.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(M,
b.MenuItemsStatefulData));break;case 2:this.vfo(Object(Ma.a)(kK.a,b),Ja,h,r);break;case 6:this.Keo(Object(Ma.a)(CJ.a,b),Ja,h,r);break;case 4:this.ofo(Object(Ma.a)(tj,b),Ja,h,r);break;case 7:this.Meo(Object(Ma.a)(Wx.a,b),Ja,h,r);break;case 12:this.Teo(Object(Ma.a)(tA.a,b),Ja,h,r);break;case 13:this.kfo(Object(Ma.a)(pt.a,b),Ja,h,r);break;case 9:b=Object(Ma.a)(gh.a,b);this.Veo(b,Ja,h,r);"StatefulSplitButtonModel"===ba&&A.push(b.ExternalId);break;case 8:this.BHb.Zeo(Object(Ma.a)(Bn.a,b),Ja,h,r,oa)}return Ja}Heo(b,
h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Bu.a(b.IconName)),r.push(appChrome.api.createLabelModel(b.ExternalId,b.LabelText,b.Id,Object.assign(new dI,{isBanner:b.IsBanner,iconSet:h?h.iconSet:null}))))}Jeo(b,h,r,A){A.push(b.ExternalId);
appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.iSd()&&((r=this.ZVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Bu.a(r)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(b.Description||Object(Za.a)(Qy,b)?r.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new uD,{iconSet:(new Bu.a(this.ZVa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(A=b.DismissHostingSurfaceOnExecute,r.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new uA,{iconSet:(new Bu.a(this.ZVa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&
!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==A&&null!==A?A:!0})))),this.tl.addCommandToMaps(Object.assign(new Kq.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));b.Lang&&zg.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}Keo(b,
h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.iSd()&&((r=this.ZVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Bu.a(r)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(r.push(appChrome.api.createToggleButtonModel(b.ExternalId,
b.LabelText,Object.assign(new dm,{iconSet:(new Bu.a(this.ZVa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.tl.addCommandToMaps(Object.assign(new Kq.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}Teo(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,
b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Bu.a(b.IconName)),r.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new cI,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}kfo(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(r={},b.Label&&
(r.label=b.Label),b.SecondaryLabel&&(r.secondaryLabel=b.SecondaryLabel),b.Details&&(r.details=b.Details),b.Description&&(r.description=b.Description),b.iconSet&&(r.iconSet=b.iconSet),b.Links&&(r.links=b.Links),b.CommandValueId&&(r.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(r.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(r.actionCommandId=b.ActionCommandId),b.CommandId&&(r.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,r))):(r.push(appChrome.api.createMultiActionButtonModel(b.Id,
Object.assign(new py,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,details:b.Details,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId}))),b.CommandIdMapped&&this.tl.addCommandToMaps(new Kq.a(b.CommandId,b.CommandIdMapped)),b.ActionIdMapped&&this.tl.addCommandToMaps(new Kq.a(b.ActionId,
b.ActionIdMapped)))}vfo(b,h,r,A){A.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.iSd()&&((r=this.ZVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Bu.a(r)).iconSet)),y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new dm,{iconSet:(new Bu.a(this.ZVa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:b.ToggleUsingIcon,stylingParameters:b.StylingParameters}))):r.push(appChrome.api.createToggleButtonModel(b.ExternalId,
b.LabelText,Object.assign(new dm,{iconSet:(new Bu.a(this.ZVa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,toggleUsingIcon:b.ToggleUsingIcon,stylingParameters:b.StylingParameters}))),this.tl.addCommandToMaps(Object.assign(new Kq.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}ofo(b,h,r,A){A.push(b.ExternalId);A=this.IGm(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,
A,b.LabelText)):zg.a("createPersonaButtonModel")&&r.push(appChrome.api.createPersonaButtonModel(b.ExternalId,A,b.LabelText,Object.assign(new qy,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}Veo(b,h,r,A){A.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.iSd()&&((r=this.ZVa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,
(new Bu.a(r)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{A=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const M=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;r.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new vD,{iconSet:(new Bu.a(this.ZVa(b))).iconSet,
keytip:b.KeyTip,hideIcon:A,toggled:M,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));this.tl.addCommandToMaps(Object.assign(new Kq.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new sA.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.UJi(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}Meo(b,h,r,A){b.McuLayout&&A.push(b.McuExternalId);A.push(b.ExternalId);
A=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(A=this.WKk.EHi(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(r.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.tl.addCommandToMaps(Object.assign(new Kq.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),A=b.Width),r.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.tl.addCommandToMaps(Object.assign(new Kq.a(b.ExternalId,
b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));r=[];const M=[];for(let ba=0;ba<b.Colors.length;ba++){const oa=b.Colors[ba],Ja=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.HighContrastColorPickerEnabled",!1)?oa.Disabled:!1;ba<A?r.push(appChrome.api.colorPickerCell(oa.Color,oa.DisplayColor,oa.Alt,Ja)):M.push(appChrome.api.colorPickerCell(oa.Color,oa.DisplayColor,oa.Alt,Ja))}0<r.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,
r));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,M));b.SelectedColorId&&(0<r.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}ZVa(b){return b.Image32by32Class?this.tl.Uxi(b.Image32by32Class):b.Image16by16Class?this.tl.Uxi(b.Image16by16Class):b.ExternalImageId}IGm(b){return b?Object.assign(new jK.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,
isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new zL.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}Pxm(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}iSd(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static jHm(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((r,A)=>{$a.a.instance.Ra(4).execute(M=>{M.isFeatureEnabled(Mt.a.SUb,
!1).then(ba=>{let oa=h.fonts;ba||M.isFreemiumUpsellEnabled()||(oa=Ye.a.Vbk(oa,Ja=>Ja.fontType!==Mt.a.fmg));ba=Object.assign(new BF,{commandId:b.externalUxCommand,fonts:oa,isSubscriber:ba,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});r(ba)}).catch(A)})}))}static hHm(b,h){const r=[];for(let A=0;A<h.MenuItems.MenuSectionList.length;A++){const M=h.MenuItems.MenuSectionList[A];M.Title&&r.push(appChrome.api.comboBoxHeader("Header-"+A.toString(),
M.Title));for(let ba=0;ba<M.ControlList.length;ba++){const oa=Object(Ma.a)(Jv.a,M.ControlList[ba]);oa&&r.push(appChrome.api.comboBoxItem(oa.MenuItemId,oa.LabelText,oa.Styles,oa.CommandValueId,oa.AriaLabel,oa.Data,oa.Disabled))}A<h.MenuItems.MenuSectionList.length-1&&r.push(appChrome.api.comboBoxDivider("Divider-"+A.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,r)}}Object(u.a)(Aj,"ReactPopulateQueryCommandPoller",null,[]);class lK{constructor(b,h,r,A,M){this.tl=
r;this.cya=b;this.DB=h;this.bac=A;this.BHb=M}YIm(b,h,r){const A=[];if(this.uin(h))b=this.$Mm(b,h,r),void 0!==b&&null!==b&&A.push.apply(A,b);else if(b){var M=this.v8d(b,r);Cm.a.visible in r&&A.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!r[Cm.a.visible]));A.push(Cs(b.externalUxCommand,1>(M&1)));void 0!==r[Cm.a.labelText]&&null!==r[Cm.a.labelText]&&A.push(appChrome.actions.setControlLabel(b.externalUxCommand,r[Cm.a.labelText]));void 0!==h&&null!==h&&(M=iK(b.externalUxCommand,
h,r,M),void 0!==M&&null!==M&&A.push.apply(A,M),"PeopleWell"===h&&this.vZk(b.externalUxCommand,r,A))}return A}gsm(b,h,r){const A=[];switch(h){case "FlyoutAnchorModel":var M=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ba=appChrome.selectors.getSplitButtonState(b);if(ba=this.tl.getCommandByExternalUxId(ba.command))r=this.cya.vhd(this.DB,ba.commandId,r),A.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!r)),A.push(Cs(b,!1));return A;default:return null}h=
!1;for(ba in M)if(M=this.tl.getCommandByExternalUxId(ba),Mf.c(M))h=!0;else if(r.SourceControlId=M.externalUxCommand,this.cya.vhd(this.DB,M.commandId,r))return A.push(Cs(b,!1)),A;A.push(Cs(b,!h));return A}$Mm(b,h,r){switch(h){case "PreviewGalleryModel":return this.BHb.FHm(b,r);case "GalleryModel":return this.BHb.ivm(r)}return null}uin(b){return"GalleryModel"===b||"PreviewGalleryModel"===b}v8d(b,h){h.MenuItemId=b.menuItemId;return this.cya.Nua(this.DB,this.bac,b.commandId,b.queryCommandId,h)}vZk(b,
h,r){const A=h[Vc.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[Vc.a.LabelText];A&&0<A.length&&(h=String.format.apply(null,[h].concat(A)));r.push(this.nRm(b,h))}nRm(b,h){return appChrome.actions.updatePeopleWell(this.Ymm(b),h)}Ymm(b){const h=[];var r={};b=this.tl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.cya.Nua(this.DB,this.bac,"1285265560",b,r);r=r.MenuItems;if(!r)return h;r=r.MenuSectionList[0];for(b=0;b<r.ControlList.length;b++){const A=r.ControlList[b],M=
{};M.name=A.Alt;M.id=A.MenuItemId;M.description=A.Description;M.color=A.ImageBackColor;M.joinTime=A.JoinTimeInMS;M.imageUrl=A.ImageUrl;M.activeStatus=A.ActiveStatus;M.isAnonymous=A.IsAnonymous;M.canJump=A.CanJump;M.upn=A.Upn;h.push(M)}return h}}Object(u.a)(lK,"ReactQueryCommandPoller",null,[]);var mK=d(1672);class wD{constructor(b,h,r){this.tl=b;this.DB=h;b=new mK.a;this.wPk=new ev;this.BHb=new bI(b,this.DB,r,this.tl);this.fBh=new Aj(b,this.DB,r,this.tl,this.BHb);this.UAh=new lK(b,this.DB,this.tl,
r,this.BHb)}JKa(){const b=[];if(!zg.c())return b;b.push.apply(b,this.lRm());var h=this.drm();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const r=this.erm();for(const A of r)b.push(appChrome.actions.updateControlEnabledDisabledState(A,!0)),delete h[A];b.push.apply(b,this.O9d(h))}return b}whd(b,h){zg.c()&&(b=this.O9d(b,h),appChrome.api.dispatch(b))}ylg(b,h,r=null){if(!Mf.c(b)&&b.populationProps&&!this.fBh.AWj(b)){b=this.fBh.ZIm(b,h,r);if(!b.Ibk){let A;
(A=b.actions).push.apply(A,this.O9d(b.M4h,zg.g(r)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}O9d(b,h=0){const r=[],A={};if(zg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var M of appChrome.selectors.getActiveGroupIds())for(var ba of appChrome.selectors.getVisibleControlsInGroup(M))A[ba]=!0;for(const oa in b)M=oa,ba=b[oa],0===h&&A[M]&&(h=2),
r.push.apply(r,this.kRm(M,ba,h));return r}kRm(b,h,r=0){const A=[],M=this.tl.getCommandByExternalUxId(b);let ba={};appChrome.selectors.isControlDefined(b)&&(ba=this.wPk.EHi(b,h));ba[gk.a.Jfb]=r;Mf.c(M)?(ba.ExternalUxId=b,(b=this.UAh.gsm(b,h,ba))&&0<b.length&&A.push.apply(A,b)):(ba.MenuItemId=M.menuItemId,ba.SourceControlId=b);A.push.apply(A,this.UAh.YIm(M,h,ba));return A}lRm(){const b=[],h=appChrome.selectors.getContextualTabIds(),r=appChrome.selectors.getActiveContextualTabIds();for(let M=0;M<h.length;M++){var A=
this.tl.IOf(h[M]);A&&(A=this.DB.SLa(A),0<=Array.indexOf(r,h[M])!==A&&b.push(appChrome.actions.activateDeactivateContextualTab(h[M],A)))}return b}drm(){var b=appChrome.selectors.getSelectedTabId();const h=[],r=this.tl.IOf(b);r&&(this.DB.SLa(r)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}erm(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const r of b)if(b=this.tl.Avm(r))for(const A of b)this.DB.SLa(A.commandId)||((b=A.externalUxCommandIds)||
(b=appChrome.selectors.getVisibleControlsInGroup(A.externalUxGroupId)),h.push.apply(h,b));return h}}Object(u.a)(wD,"ReactRibbonRootPoller",null,[1801]);class Br{constructor(b,h,r=null){this.DB=this.AGa=this.Kkb=null;this.D$b=h;b.ATa(this);this.EH=r}get Qta(){this.AGa||(this.AGa=new Date,this.AGa.setTime(0));return this.AGa}set Qta(b){this.AGa=b}get rca(){return 2}get EH(){return this.DB}set EH(b){this.DB=b}get lvc(){this.Kkb||(this.Kkb=new wD(this.D$b,this.EH,this.rca));return this.Kkb}Rnb(){const b=
document.activeElement;xd.a.isEditable(b)&&b.blur()}executeCommand(b,h,r,A,M,ba,oa,Ja=2){Mf.c(this.EH)||(M=new Uk.a,M.CommandLocation=Ja,M.InvocationMethod=A,M.CommandTabName=r,h[gk.a.Jfb]=Ja,this.EH.oVa(b,h,M,ba,oa),this.VEn(b,h))}JKa(){return Mf.c(this.EH)?[]:this.lvc.JKa()}An(){const b=this.JKa();0<b.length&&(this.Qta=new Date,appChrome.api.dispatch(b))}mtd(){zg.c()&&this.lvc.whd({PeopleWell:"PeopleWell"},18)}btd(){}VEn(b,h){try{const r=$a.a.instance.Oa(2);if(r&&h){const A=h.SourceControlId||h.launcherId||
h.LegacyId||h.NewContextId;let M=(A?"_"+A:"")+(h.SqmControlId?"_"+h.SqmControlId:"");M=M.length?M:"_"+b;r.i6f("Ribbon"+M)}}catch(r){v.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(r?r.toString():""))}}}Object(u.a)(Br,"ReactRibbonRoot",null,[641,1802]);var xD=d(1589);class eI{constructor(b){this.Ucf=this.iUe=!1;this.Bhb=null;this.oah=!1;this.WS=null;this.vxa=!1;this.fZn=h=>{h.Nb&&h.Nb.target&&"input"===h.Nb.target.tagName.toLowerCase()&&rd.FocusManager.instance().aF("ribbon");return!1};
this.I5e=b;ee.a.instance.nb(zd.a.lz,this.K2c(),this.fZn);(b=$a.a.instance.Ra(5))&&b.execute(h=>{this.WS=h});y.AFrameworkApplication.J.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&y.AFrameworkApplication.ta.Hb.KN?xl.a.get_instance().$k(16,()=>{this.isReady?this.initializeContextualUI(this.K2c()):xl.a.get_instance().$k(7,()=>{this.initializeContextualUI(this.K2c())})}):xl.a.get_instance().$k(7,()=>{this.initializeContextualUI(this.K2c())})}get t3(){return this.vxa}get isReady(){return y.AFrameworkApplication.J.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
y.AFrameworkApplication.ta.Hb.KN?xl.a.get_instance().isCompleted(16)&&xl.a.get_instance().isCompleted(7):xl.a.get_instance().isCompleted(7)}vml(){if(this.oah)return!0;try{return Promise.resolve(null),this.oah=!0}catch(b){return!1}}cLg(b){if(!this.isReady||this.Ucf)return this.e7f("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.vml())return this.e7f("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(y.AFrameworkApplication.c0d||""!==y.AFrameworkApplication.jv)if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",
!1)||"DocGen"===y.AFrameworkApplication.jv||"ContentAssemblyView"===y.AFrameworkApplication.jv)return this.e7f("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.Ucf=!0;let h=La.a.Ug;switch(b){case 1:h=La.a.showContextMenu;break;case 0:h=La.a.showFloatie;break;case 2:h=La.a.eyc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Ucf=!1;$b.c(h)},0)});return!1}mKi(b){return hm.UISurfaces.l9a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=
h.getBlockedSmallScreenFloatieGroupList();const r=[];for(const A of b)Array.contains(h,A)||r.push(A);return r}return b})}showFloatie(b,h,r,A=null){this.cLg(0)||this.mKi(h).then(M=>{if(0>=M.length)return null;this.ABg(M).then(()=>{const ba={};ba.target=b;hm.UISurfaces.l9a().then(oa=>{appChrome.api.dispatch(oa.showFloatie(ba,r,void 0,this.LLf(),A));this.vxa=!0;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&y.AFrameworkApplication.va&&
y.AFrameworkApplication.va.Ob(La.a.r$i,2);return null})});return null})}showContextMenu(b,h,r=null,A=null){this.cLg(1)||this.yUj(b,h,r,A)}yUj(b,h,r=null,A=null){this.ABg(null).then(()=>{const M={};M.target=b;A&&(M.directionalHint=A);hm.UISurfaces.l9a().then(ba=>{appChrome.api.dispatch(ba.showContextMenu(M,h,r,void 0,this.LLf()));return null})})}dyc(b,h,r,A=null){this.cLg(2)||this.mKi(h).then(M=>{0>=M.length?this.yUj(b,r,A):this.ABg(M).then(()=>{const ba={};ba.target=b;const oa={};oa.target=b;hm.UISurfaces.l9a().then(Ja=>
{appChrome.api.dispatch(Ja.showContextualUI(ba,oa,r,void 0,A,this.LLf()));this.vxa=!0;return null})});return null})}e7f(b){v.ULS.sendTraceTag(561394519,340,15,b)}ayf(){this.isReady&&hm.UISurfaces.isLoaded()&&hm.UISurfaces.l9a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}dismissFloatie(){this.isReady&&hm.UISurfaces.isLoaded()&&hm.UISurfaces.l9a().then(b=>{this.vxa=!1;appChrome.api.dispatch(b.hideFloatie());return null})}AZc(){this.isReady&&hm.UISurfaces.isLoaded()&&hm.UISurfaces.l9a().then(b=>
{appChrome.api.dispatch(b.hideContextualUI());this.vxa=!1;return null})}initializeContextualUI(b){return hm.UISurfaces.l9a().then(h=>{this.iUe||(h.initializeContextualUI(b),this.iUe=!0);return null})}ABg(b){if(!this.iUe)return this.initializeContextualUI(this.K2c()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);
var r=[];hm.UISurfaces.l9a().then(A=>{r.push.apply(r,this.I5e.lvc.O9d(A.selectors.getFloatieOnlyControlsMap(),9));0<r.length&&appChrome.api.dispatch(r);return null})}}K2c(){if(this.Bhb)return this.Bhb;this.Bhb=xD.a("div");this.Bhb.id="ReactContextualUIDiv";this.Bhb.style.position="absolute";this.Bhb.style.zIndex="1001";document.body.insertBefore(this.Bhb,document.body.firstChild);return this.Bhb}LLf(){return this.WS?this.WS.contentType:"Unknown"}}Object(u.a)(eI,"ReactContextualUILauncher",null,[1803]);
class Dr extends $z.a{constructor(){super()}}Object(u.a)(Dr,"FloatieBuildOptions",$z.a,[]);class Tq extends tB.a{constructor(){super()}}Object(u.a)(Tq,"FloatieBuildContext",tB.a,[]);var lz=d(1484);class fu extends Gp.a{constructor(b,h,r){super(b,h,r,null);this.s4n=A=>{this.jhl(A.Hid,A.YWc);this.yR.Fpi=this;this.yR.Bn();this.yR.Rc.style.display="none";this.placeholder.appendChild(this.yR.Rc);this.pza.continueWith(()=>{this.pza.result.IWb(this.yR)},11);kk.a.instance.nb(zd.a.jt,this.yR.Rc,Object(F.a)(this.yR,
this.yR.LE,"onPointerDown"))};if(Mf.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get yR(){return this.root}b2o(b){this.root=b}ihl(){const b=new Tq,h=new rB.a;h.mjd=1;h.handler=this.s4n;h.data=b;this.cAa.Sve(h)}jhl(b,h){b=Ij.a.pla(b,Ij.a.ugk);if(Mf.c(b))throw Error.create("No floatie element was present in the data");b=new Ij.a(b);this.b2o(new Dy(b.attributes[Ij.a.id],b.attributes));b=Ij.a.pla(b.node,Ij.a.NHe);this.pmf(b,h)}pmf(b,h){b=Ij.a.Fx(b);for(let r=0;r<b.length;r++){if(this.AXa(b[r]))continue;
const A=this.vmf(b[r],h);this.yR.Wf(A)}}vmf(b,h){var r=new Ij.a(b);b=new lz.Group(this.yR,r.attributes[Ij.a.id],r.attributes[Ij.a.r1a],r.attributes[Ij.a.uCc],r.attributes[Ij.a.k1a],!1,r.name===Ij.a.wkk,!1,r.attributes);r=Ij.a.Fx(r.node);for(let A=0;A<r.length;A++)b.Wf(this.cUd(r[A],h));return b}cUd(b,h){b=new Ij.a(b);var r=b.attributes[Ij.a.id];b=Ij.a.Fx(b.node);var A=2;2===b.length&&(A=3);r=new Em.a(this.yR,r,A,2,1);for(A=0;A<b.length;A++){const ba=new Ij.a(b[A]);var M=Ij.a.pla(ba.node,Ij.a.gBb);
M=Ij.a.Fx(M);this.Dmf(r.O8d(A+1),M,ba.attributes[Ij.a.id],h)}return r}Dmf(b,h,r,A){for(r=0;r<h.length;r++){if(this.AXa(h[r]))continue;const M=new Ij.a(h[r]),ba=this.fka(h[r],A);ba&&b.Wf(ba.ZW(M.attributes[Ij.a.vCc]))}}}Object(u.a)(fu,"FloatieBuilder",Gp.a,[]);class bo{constructor(b,h){this.Dw=null;this.Qwl=b;this.EOe=h;this.E_n=this.Fme.bind(this)}get yR(){return this.Dw}Tnb(b,h,r){h=new Vo.a(Li.a.B6a,Box4Intl.Box4Strings,null,null,h);const A=new Dr;A.iJ=r||{};A.iJ.floatieshadingColor=!1;const M=
new fu(A,document.body,this.Qwl.JIj);M.cAa=new jH.a(b,h);M.ihl();this.EOe.execute(ba=>{M.yR.EH=ba});M.yR.xxo(this.E_n);M.yR.Gwo(()=>[]);this.Dw=M.yR;return this.yR}}Object(u.a)(bo,"AFloatieInitializer",null,[]);class hI extends bo{constructor(b,h,r,A){super(h,r);this.plg=()=>{this.yR.An()};this.ii=b;this.UK=A}Tnb(b,h,r){if(b=super.Tnb(b,h,r))b.Cuc=!0,b.Pqe=!0,b.preventDismissOnScroll=!0;this.ii.d6a(this.plg);return b}H7c(b,h,r=null){this.UK.gWh(()=>this.Tnb(b,h,r))}Fme(){this.yR.Cuc=!0}}Object(u.a)(hI,
"PasteFloatieInitializer",bo,[]);var iI=d(807);class gv{pEa(b,h){this.Wml&&this.N8o(b,h,gv.X8f,gv.currentSelection)}N8o(b,h,r,A){switch(r){case 1:case 6:case 2:case 3:case 4:gv.Lzf.show(A,b,h)}}Odj(){switch(gv.X8f){case 5:case 1:return!0;default:return!1}}KNl(){return gv.X8f}get Wml(){return 1!==qa.StaticActiveAppFrame.za().state}static get Lzf(){return null!=gv.zVg?gv.zVg:gv.zVg=$a.a.instance.resolve(1058)}static TAm(b){if(!b)return 0;if(2===qa.StaticActiveAppFrame.za().mode){const h=b.Qa.node,r=
zc.a.Za(h);r.yq();return qq.e(r.currentNode)?2:y.AFrameworkApplication.g3b||!Nq.isEmbeddedFileNode(h)||Nq.isInvalid(h)?Bl.a.Tmn(b.Qa)||Bl.a.lZf(b.Qa)?6:1:3}return 4}static get currentSelection(){return $f.a.instance.gb.currentSelection}static get X8f(){return gv.TAm(gv.currentSelection)}}Object(u.a)(gv,"SelectionContextMenuProvider",null,[1568]);class TB{constructor(b,h){this.Pqe=this.Cuc=!1;this.k6c=!0;this.pO=b;this.tl=h}get isVisible(){return this.pO.t3}get controls(){return null}dismissFloatie(){this.pO.dismissFloatie();
return!0}aBf(){}Ieb(b,h,r,A,M=null){this.pO.showFloatie(Object.assign(new yz.a,{x:b.x,y:b.y}),this.KGf(r),r,M)}YPb(){return new Sys.UI.Bounds(0,0,0,0)}T6(){return this.dismissFloatie()}KGf(){return[]}}Object(u.a)(TB,"ReactFloatie",null,[410,411]);class IF{constructor(b){this.fzd=null;this.pO=b}dispose(){}T6(){this.pO.AZc();return!0}showContextMenu(b,h){this.V0b(b,h.clientPoint,h.yg)}V0b(b,h,r){this.Geb(b,new Sys.UI.Bounds(h.x,h.y,0,0),r);v.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",
b)}Geb(b,h,r,A=null){this.fzd?this.pO.dyc(Object.assign(new yz.a,{x:h.x,y:h.y}),this.fzd.KGf(r),r,b):this.pO.showContextMenu(Object.assign(new yz.a,{x:h.x,y:h.y}),r,b,A);this.fzd=null}eyc(b,h,r,A){this.fzd=Object(Ma.a)(TB,r);A.pEa(b,h);return!0}}Object(u.a)(IF,"ReactContextMenuController",null,[665,11]);var Ln=d(467);class OI{constructor(){this.wna=this.text=this.kta=null}}Object(u.a)(OI,"BusinessBarButtonData",null,[]);class xy{constructor(){this.text=this.kta=null}}Object(u.a)(xy,"BusinessBarLinkData",
null,[]);var Wr=d(729),$D=d(243);class uz{constructor(b,h,r,A){this.Jhh=this.Xeh=this.aib=this.Xch=null;this.Ut=b;this.Cwa=h;this.ga=r;this.Ga=A}Okg(){this.qVc();this.rVc();this.Yec()}rVc(){}qVc(){const b=qa.StaticActiveAppFrame.za().kb.ed;b&&(this.Xch=this.Xfb(this.Xch,1,2===qa.StaticActiveAppFrame.za().mode&&b.mYf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}v4i(){return y.AFrameworkApplication.ta&&1===y.AFrameworkApplication.ta.mode}Yec(){let b=null;if(10<=df.a.ff.BK){if(df.a.ff.Tca.yWa){var h=
df.a.ff.HGb;$D.a.VSb(h)?22===h?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===h||20===h?b=X.a.Di?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===h?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===h?b=X.a.Di?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===h&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):$D.a.YSf(df.a.ff.Tca.wea)||df.a.nn||this.v4i()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}}else if(h=
qa.StaticActiveAppFrame.za().kb.activeSection){const r=h.ogd;$D.a.VSb(r)?22===r?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===r||20===r?b=X.a.Di?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===r?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===r?b=X.a.Di?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===r&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):$D.a.YSf(h.O5a)||
df.a.nn||this.v4i()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.Jhh=this.Xfb(this.Jhh,5,!!b,b)}RUj(b,h,r,A){b=this.Cwa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.iRd(h,()=>{Te.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+r)});A&&(b.lka=A);this.Ut.Pz(b,!0)}D9o(b,h,r){this.RUj(b,h,r,null)}P9o(b){b=this.Cwa.create(null,b,null);b.closeable=!0;b.id=20;this.Ut.Pz(b)}X8o(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;
this.aib||(this.aib=this.Cwa.create(b,h,null),this.aib.closeable=!0,this.aib.id=27,this.Ut.Pz(this.aib))}u1m(){this.aib&&(this.aib=this.Xfb(this.aib,27,!1,""))}qDg(b){this.Xeh=this.Xfb(this.Xeh,30,!0,b)}Xfb(b,h,r,A,M=!1,ba="",oa=null,Ja=null,jb=null){r?b?b.message=A:(b=this.Cwa.create(ba,A,null),b.id=h,b.closeable=M,oa&&b.addButton(oa.text,oa.kta,oa.wna),Ja&&b.iRd(Ja.text,Ja.kta),jb&&(b.lka=jb),this.Ut.Pz(b,!1)):b&&(this.Ut.removeEntry(b),b=null);return b}xef(b){this.Ut.Pz(b,void 0)}}Object(u.a)(uz,
"BusinessBarController",null,[346]);class Gx extends uz{constructor(b,h,r,A){super(b,h,r,A);this.Bxa=null}cLf(b,h,r=null,A=null,M=null,ba=2){if(this.Bxa)return null;this.Bxa=this.Cwa.create(h,r||"",null);this.Bxa.id=6;this.Bxa.image=ba;this.Bxa.c$c=!1;b&&(this.Bxa.errorCode=b);this.Bxa.closeable=!1;h=y.AFrameworkApplication.iG&&this.Ga.$("ShowFeedbackButtonOnKickoutBusinessBar");A?(this.Bxa.addButton(A,M,""),h&&this.Bxa.EOh(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.$Ki(b)})):h&&this.Bxa.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,
()=>{this.$Ki(b)},"");this.Ut.Pz(this.Bxa,void 0,null,null,null);return this.Bxa}$Ki(b){v.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Pb(La.a.Fla,2,{["ErrorCode"]:b})}static get rj(){return cm.PageReader.instance}}Object(u.a)(Gx,"BusinessBarController",uz,[345,346]);class Hx{static get Gij(){const b=C.a.ej(Ag.a.Hg(y.AFrameworkApplication.lcid).name);return Hx.Wpn?String.format("https://support.office.com/{0}/client/results?Shownav=true&lcid=1033&ns=WDWAEndUser&version=15&omkt={0}&ver=15&apps=WDWAENDUSER%2CXLWAENDUSER%2CPPWAENDUSER%2CONWAENDUSER&HelpID=WordODF",
b):String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}static get Wpn(){if(null!=Hx.b0g)var b=Hx.b0g;else{var h;y.AFrameworkApplication.nd("d932d186;491d2669");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.OdtDialogLearnMoreUrlChangeEnabled",!1);b=Hx.b0g=b}return b}}Object(u.a)(Hx,"OdtUtils",null,[]);class lG extends Gx{constructor(b,h,r,A){super(b,h,r,A);this.vGb=this.jCb=this.BIc=this.luh=this.sTa=
this.ruh=this.EFh=null;this.tEk="https://go.microsoft.com/fwlink/?linkid=2134357"}Okg(){super.Okg();this.Sql();this.prl()}rVc(){const b=qa.StaticActiveAppFrame.za().kb.ed;if(b){var h=df.a.z3;if(df.a.yt||df.a.nn||h&&y.AFrameworkApplication.tw)this.EFh=this.Xfb(this.EFh,4,Gx.rj.Wab(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.ruh=this.Xfb(this.ruh,3,Gx.rj.Iab(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.luh=this.Xfb(this.luh,8,Gx.rj.NAl(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),Gx.rj.mUb(b)?this.sTa||(this.sTa=this.Cwa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.sTa.id=14,this.sTa.closeable=!0,this.sTa.image=3,this.sTa.addButton(Box4Intl.Box4Strings.L_LearnMore,Wr.a.PAn,""),this.Ut.Pz(this.sTa,!1)):this.sTa&&(this.Ut.removeEntry(this.sTa),this.sTa=null)}}Sql(){if($l.a.j$c){const b=Hx.Gij,h=this.Cwa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.AYk(b);this.Ut.Pz(h,!0)}}get Rvn(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",!1)?X.a.Svn:!1}prl(){this.Rvn&&!this.vGb&&(this.vGb=this.Cwa.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.vGb.id=15,this.vGb.closeable=!0,this.vGb.c$c=!1,this.vGb.addButton(Box4Intl.Box4Strings.L_DownloadNow,Wr.a.dwp,""),this.Ut.Pz(this.vGb,!1))}E9o(b,h){if(qa.StaticActiveAppFrame.za().kb.ed){const r=
new OI;r.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;r.kta=()=>{b()};const A=new xy;A.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;A.kta=()=>{Te.a.openWindow(4,y.AFrameworkApplication.privacyUrl)};this.BIc=this.Xfb(this.BIc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,r,A,()=>{h()})}}C1m(){this.BIc&&(this.BIc=this.Xfb(this.BIc,25,!1,""))}F8o(){if(qa.StaticActiveAppFrame.za().kb.ed){const b=
new xy;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.kta=()=>{Te.a.openWindow(4,this.tEk)};this.jCb||(this.jCb=this.Cwa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.jCb.id=32,this.jCb.closeable=!0,this.jCb.image=3,this.jCb.iRd(b.text,b.kta),this.Ut.Pz(this.jCb,!1))}}J7(b){return this.Ut.J7(b)}Pz(b,h){this.Ut.Pz(b,h)}}Object(u.a)(lG,"BusinessBarController",Gx,[378,345,346]);class aE{constructor(){this.menuTargetType=
null}}Object(u.a)(aE,"MenuTargetDescriptor",null,[]);class Gu{static get taa(){return null!=Gu.OUg?Gu.OUg:Gu.OUg=$a.a.instance.resolve(30)}static showContextMenu(b,h){Gu.taa.showContextMenu(b,h)}static V0b(b,h,r){Gu.taa.V0b(b,h,r)}static Geb(b,h,r,A=null){Gu.taa.Geb(b,h,r,A)}}Object(u.a)(Gu,"BaseContextMenu",null,[]);class Ri extends Gu{constructor(b,h,r,A=!1,M,ba=null,oa){super();this.duj=(Ja,jb,zb,Eb,Sb)=>{if(1===zb)return 32;Ja=Sb.fz;Sb=Sb.td;jb=Object.assign(new Xe.a,{ExternalId:"ContextMenu",
UpdateDynamically:!0,MenuSectionList:[]});this.NIl(jb,Ja,Sb.IsShadowMenuOpen);Sb.MenuItems=jb;return 32};this.Xko=h;this.qo=r;this.mlb=ba;this.VXe=A;this.Wb(b);this.Ygb=oa;Ri.$4a[1]=ub.a.FAe;Ri.$4a[2]=ub.a.g$d;Ri.$4a[3]=ub.a.lBe}get o_l(){return mp.a.DZd}get n_l(){return mp.a.$Xd}get p_l(){return mp.a.Zgd}get Jzf(){return mp.a.gkg}Wb(b){b.fb(ub.a.Blg,mc.a.application,this.duj,96);b.fb(ub.a.fuj,mc.a.application,this.duj,96)}show(b,h,r){let A=null,M=new Sys.UI.Bounds(0,0,0,0);const ba=this.jIm(b);if(ba&&
(b=b.Qa.node)&&(b=b.Ce(Object(Jb.a)().Ad.sc))){M=cB.a.Cr(b,ba.end);if(y.AFrameworkApplication.isRtl&&M.x>h.x||!y.AFrameworkApplication.isRtl&&M.x+M.width<h.x||M.y+M.height<h.y)M=cB.a.Cr(b,ba.end-1);h.x=M.x+(y.AFrameworkApplication.isRtl?0:M.width);h.y=M.y+M.height;A=6}Gu.Geb("ContextMenu",new Sys.UI.Bounds(h.x,h.y,M.width,M.height),r,A)}i3(b,h){return this.Mpd(b)||Ri.Wec(ub.a.mergeCells)||Ri.Wec(ub.a.vOa)||this.cEg(b)||this.tUj(b,h)||Ri.hVj()||Ri.WUj(b).returnValue}Mpd(b){return 2===qa.StaticActiveAppFrame.za().mode&&
this.Z9c(b)}gYc(b,h,r=null){if(Su.xD()&&2===qa.StaticActiveAppFrame.za().mode){h=this.Ygb.Y7h(b.Qa);if(!h||!this.Esn()&&!this.gun(h.errorDetails))return;h=h.errorDetails}else{if(!this.Mpd(b))return;h=this.mFi(b)}var A=Ag.a.Hg(h.lcid);const M=A?A.name:"UNKNOWN";A=Object(Za.a)(vn.a,h)?h.typeId:"";v.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,A,M);if(b=this.Xko.cgc(b,h))r.push.apply(r,b),this.rIn(h,A)}gun(b){return b&&(1===
b.proofingType||2===b.proofingType)}Esn(){y.AFrameworkApplication.nd("gec07842;ae49c383");return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",!1)}rIn(b,h){const r=Ri.$4a[b.proofingType];r&&(y.AFrameworkApplication.va.Ob(r,2),v.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",r,h,b.proofingType,Su.xD()))}mFi(b){return this.qo.Bsa(b.Qa).errorDetails}Z9c(b){return this.qo.Cwe(b)}ckc(){return null}wYd(){}jIm(b){return this.Z9c(b)?
this.qo.Bsa(b.Qa):(b=this.ckc(b))?new Nb.a(b.Cu,b.cpEnd):null}cEg(b){if(2!==qa.StaticActiveAppFrame.za().mode||!b)return!1;b=lt.a.dJa(b.toArray());return!!Object(zl.a)().PW(b,14)}IVj(b,h){return 2===h||3===h&&!this.Z9c(b)}tUj(b,h){return 3!==h||this.Z9c(b)}mFl(){const b=[];b.push(Object.assign(new Pj.a,{ExternalId:this.o_l}));b.push(Object.assign(new Pj.a,{ExternalId:this.n_l}));b.push(Object.assign(new Pj.a,{ExternalId:this.p_l}));return b}WJl(){const b=[];this.VXe&&b.push(Object.assign(new Pj.a,
{ExternalId:this.Jzf}));return b}static get Nd(){return null!=Ri.m1g?Ri.m1g:Ri.m1g=$a.a.instance.resolve(10)}static get Smn(){null==Ri.pXe&&(Ri.pXe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Ri.pXe}static get Udd(){null==Ri.rBb&&(Ri.rBb=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("MultiParagraphHyperlinkEditEnabled"):!1);return Ri.rBb}static get Sya(){null==Ri.ada&&(Ri.ada=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("AddHyperlinkWhenSelectionContainsLineBreak"):
!1);return Ri.ada}static Wec(b){return 32===y.AFrameworkApplication.va.Ob(b,1)}static hVj(){return 2===qa.StaticActiveAppFrame.za().mode&&!!df.a.NB.MJ&&df.a.NB.MJ.P$c(ub.a.Foe.toString())}static jVj(b){if(1!==b.length||!b.Qa.Cl)return!1;b=zc.a.Za(b.Qa.node);b.vb(11);b.rc();return(mf.ListItemReader.De?mf.ListItemReader.Dg(b):b.pv(4))&&!Ri.Nd.Tw(b).listType?!0:!1}static WUj(b){let h=!1,r=!1;if(!b)return{returnValue:!1,Srb:h,N6c:r};if(Ri.Udd)return Ri.O9o(b,r);if(!(b.Lw||Ri.Smn&&2===b.length&&b.Wc.contextId===
mc.a.Yc))return{returnValue:!1,Srb:h,N6c:r};b=b.Qa.clone();h=32===y.AFrameworkApplication.va.Pf(b,ub.a.Bcb,1,!0,null,null);r=32===y.AFrameworkApplication.va.Pf(b,ub.a.XR,1,!0,null,null);return{returnValue:h||r,Srb:h,N6c:r}}static O9o(b,h){let r;h=b.Qa.clone();r=Ri.Sya&&bm.l(h);let A=!r&&32===y.AFrameworkApplication.va.Pf(h,ub.a.Bcb,1,!0,null,null);if(b.Lw||2===b.length&&b.Wc.contextId===mc.a.Yc)h=!r&&32===y.AFrameworkApplication.va.Pf(h,ub.a.XR,1,!0,null,null);else{h=!0;const M=b.length;for(let ba=
0;ba<M;ba++){const oa=b.K(ba).clone();if(oa.contextId===mc.a.paragraph||oa.contextId===mc.a.Fd)(r=Ri.Sya&&bm.l(oa))||(h=32===y.AFrameworkApplication.va.Pf(oa,ub.a.XR,1,!0,null,null)&&h);else if(oa.contextId!==mc.a.Yc)return h=A=!1,{returnValue:!1,Srb:A,N6c:h}}}return{returnValue:A||h,Srb:A,N6c:h}}static eCi(b){const h=Object.assign(new xh.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new Pj.a,{ExternalId:r}));return h}static wE(b){const h=[];for(const r of b)h.push(Object.assign(new Pj.a,
{ExternalId:r}));return h}}Ri.pXe=null;Ri.rBb=null;Ri.ada=null;Ri.$4a=[];Object(u.a)(Ri,"AEditSurfaceContextMenu",Gu,[]);var Bh=d(708),bq=d(1473),ir=d(1785),dp=d(1017);class Hu{static sHm(b,h,r){h=[];r.xho.cgc(r.tim(b),h);return h}static Xqm(b,h,r){const A=[];if(r.Mpd(b))return A;Lk.a.MLa&&!X.a.Mt||r.wxf.wYd(b,null,h,A);return A}static IMm(b,h,r){const A=[];r.gYc(b,h,A);return A}}Object(u.a)(Hu,"ContextMenuSectionHelper",null,[]);class Um{static Kqm(b,h,r){h=[];r.ITl(b)&&h.push(Object.assign(new Pj.a,
{ExternalId:"ReviewDesignerSuggestion",LabelText:r.JJm(b)}));return h}static aBm(){return Ri.Wec(ub.a.mergeCells)?Ri.wE(["MergeCells"]):Ri.Wec(ub.a.KAe)?Ri.wE(["SplitCells"]):[]}static JOm(){return Ri.Wec(ub.a.xAe)&&(y.AFrameworkApplication.nd("4aah1391;h7hg6461"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableSortInContextMenuEnabled",!1))?Ri.wE(["Sort"]):[]}static pQm(b,h,r){h=[];if(!r.ti.F6h(b))return h;b=r.ti.yJi(b);h.push(Object.assign(new Pj.a,{ExternalId:"AcceptChangeContext",
LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new Pj.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static Ilm(b,h,r){return y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")&&b&&b.Qa&&b.Qa.node&&r.Bc&&r.Bc.yhj(b.Qa.node)?Ri.wE(["ShowCatchUpActivitiesForParagraph"]):
[]}static Erm(b){return un.a9o(b)?Ri.wE(["Draw"]):un.$Uj(b)?Ri.wE(["EditIllustration"]):[]}static nTm(b){return un.Iap(b)?[Object.assign(new gh.a,{ExternalId:"WrapTextMenu"})]:[]}static CJm(b){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.isResetPictureEnabled",!1)&&un.N$o(b)?Ri.wE(["ResetPictureEdits"]):[]}static E8d(b,h,r){return r.aUl(b)?Ri.wE(["CreatePullQuote"]):[]}static getContentControls(b,h,r){return r.HTl()?Ri.wE(["RemoveContentControl"]):[]}static wnm(){return Ri.wE(["NewComment"])}static cmm(b){const h=
[];!un.bEg(b)&&un.EDg(b)&&fc.SessionStatusManager.instance.cB&&b.HN&&h.push(Object.assign(new gh.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static Wxm(b,h,r){h=[];!un.bEg(b)&&un.EDg(b)&&fc.SessionStatusManager.instance.cB&&(v.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.HN&&!y.AFrameworkApplication.J.$("ChangePicturesIsEnabled")?h.push(...Ri.wE(["ChangePicture"])):h.push(...r.VHl().ControlList),(b=un.wAi())&&0<b.length&&
(r=r.NLl(b),null!=r&&h.push(...r.ControlList)));return h}static gIm(){return Ri.hVj()?Ri.wE(["SetProofingLanguage"]):[]}static SJm(b,h,r){return r.Csn&&r.O$o(b)?Ri.wE(["Rewrite"]):[]}static Gzm(b){return Ri.jVj(b)?Ri.wE(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static RFm(){return un.vVj()?Ri.wE(["ParagraphOptions"]):[]}static Qwm(b){return un.$Uj(b)?Ri.wE(["EditIllustration"]):[]}static zMm(b){return un.bEg(b)?Ri.wE(["ShowSmartLookupPane"]):[]}static AQm(b){return un.mVj(b)?Ri.wE(["ModernTranslatorSplitButton"]):
[]}static $vm(b,h,r){h=[];if(b.Lw){const A=b.Qa;if(A.contextId===mc.a.paragraph||A.contextId===mc.a.Vc||A.contextId===mc.a.Fd){b=b.Qa.node;if(!r.Mg.Vb(b)||b.Jq||""===b.characterData)return h;r.Xyf.O6d(b)&&h.push(...Ri.wE(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,r){h=[];if(b.Lw){const A=b.Qa;(Le.a.qf(A)||Le.a.eab(A))&&r.Wel.l6d(b.Qa.node,b.Qa.cpBegin)&&(h.push(...Ri.wE(["DeleteBookmarkContextMenu"])),h.push(...Ri.wE(["EditBookmarkNameContextMenu"])))}return h}static rla(b){let h=!1,
r=!1;const A=[];({Srb:h,N6c:r}=Ri.WUj(b)).returnValue&&(h?r?A.push(...Ri.wE(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):A.push(...Ri.wE(["OpenHyperlink"])):r&&(y.AFrameworkApplication.J.$("IsO365CommercialHost")||y.AFrameworkApplication.J.$("IsO365ConsumerHost")?A.push(...Ri.wE(["InsertLinkFlyout"])):A.push(...Ri.wE(["InsertLink"]))));return A}static Smm(b,h,r){const A=[];if(!r.tUj(b,h))return A;2===qa.StaticActiveAppFrame.za().mode?(A.push(...r.mFl()),
A.push(...r.WJl()),3===h&&r.Z9c(b)&&A.push(Object.assign(new Pj.a,{ExternalId:"Delete"}))):(!y.AFrameworkApplication.I0&&!y.AFrameworkApplication.BH||y.AFrameworkApplication.lOb)&&A.push(Object.assign(new Pj.a,{ExternalId:"Copy"}));return A}static bHf(b,h,r){return r.cEg(b)&&r.IVj(b,h)?Ri.wE(["EditTableAltText"]):[]}static AAi(b,h,r){return r.STl(b)?Ri.wE(["ShowIntentSuggestion"]):[]}static vOm(b,h,r){const A=[];r.cEg(b)&&!r.IVj(b,h)&&(A.push(Object.assign(new gh.a,{ExternalId:"InsertTableMenu"})),
A.push(Object.assign(new gh.a,{ExternalId:"DeleteTableMenu"})),A.push(Object.assign(new gh.a,{ExternalId:"SelectTableMenu"})));return A}static BOm(b,h,r){return r.kap(b)?Ri.wE(["UpdateTableOfContents"]):[]}static vsm(b){return un.h9o(b)?Ri.wE(["ShowHideEquationToolsPane"]):[]}static Rom(b,h,r){b=r.Hjm(b).map(A=>{switch(A.category){case "draftContent":return"OpenCopilotComposeDraftContent";case "rewrite":return"OpenCopilotComposeRewrite";case "visualize":return"OpenCopilotComposeVisualizeAsTable";
default:throw Error("Not supported category for compose action");}});return Ri.wE(b)}}Object(u.a)(Um,"ContextMenuSectionItemHelper",null,[]);class un extends Ri{get Mg(){return this.hb}get Xyf(){return this.u2a}constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd,de,he,fe=!1,Yd=null,Td=null,wf,Lf,ii,Bi){super(b,h,r,fe,void 0,Yd,wf);this.u_d=Bi;this.M4e=this.WS=null;this.MWe=this.Vkh=!1;this.owe=new Map;this.sC={};this.bvb={};this.ga=b;this.J=A;this.ti=M;this.EZ=Ja;this.YK=jb;this.eo=zb;this.JSk=
!!Yd;this.wxf=Eb;this.xho=Sb;this.Feh=Gd;this.$oa=de;this.Wel=he;this.u2a=ii;this.hb=Lf;Zc&&Zc.execute(Ml=>{this.DDh=Ml});nc&&nc.execute(Ml=>{this.M4e=Ml});this.Bc=oa;this.Bv=Dc;Td&&Td.execute(Ml=>{this.WS=Ml});this.V7m();this.sfo();this.Q7l();this.G7l().catch(()=>{v.ULS.sendTraceTag(508679947,3048,50,"Fetching copilot state for context menu failed.")});this.rfo()}get Jzf(){return this.JSk?mp.a.Xgd:super.Jzf}$6o(){const b=$l.a.Pm.kb.Jc.lb.gb.currentSelection;return this.Mpd(b)&&2!==this.mFi(b).errorType}i3(b,
h){return super.i3(b,h)||un.vVj()||Ri.jVj(b)||un.EDg(b)||un.mVj(b)}NIl(b,h,r){const A=[];let M=null;try{M=$l.a.Pm.kb.Jc.lb.gb.currentSelection}catch(ba){v.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.ffo(M,h,A,this.Fom(M));b.MenuSectionList.push(...A);this.wYo(b);!r&&this.DDh&&this.DDh.ojo(b.MenuTargetDescriptor.menuTargetType,A)}Fom(b){return Ri.Wec(ub.a.mergeCells)?fg.uSg:b.q9c?fg.NQg:b.HN?fg.ORg:b.opc()?fg.GQg:b.kXa?fg.zQg:fg.SQg}WHl(b){b=
un.jIl(b);return Object.assign(new Pj.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}OLl(b){return(b=un.rfk(b))?Object.assign(new Pj.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}VHl(){const b=Object.assign(new xh.a,{ControlList:[]}),h=un.wAi();b.ControlList.push(this.WHl(h));return b}NLl(b){const h=Object.assign(new xh.a,{ControlList:[]});if(b&&0<b.length){b=this.OLl(b);if(null==b)return null;h.ControlList.push(b)}return h}Mpc(b){return b.HN||2<b.length||!b.length||2===b.length&&!Le.a.rl(b.Wc)||
1===b.length&&Le.a.rl(b.Wc)?!1:this.f2f(b.Qa)}f2f(b){return Ed.ParagraphReader.Vb(b.node)?""!==Ed.ParagraphReader.text(b.node).trim():!1}kap(b){var h=zc.a.Za(b.Qa.node);h=Object(Ma.a)(Bh.a,h.currentNode);return b.HN?!1:!!h&&h.Jq}Q7l(){this.J.$("RewriteIsEnabled")||this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.Bv.execute(b=>{b.isFeatureEnabled(bq.a.Mgj,!1).then(h=>{h||v.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");
this.Vkh=h;return null})}):v.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}async G7l(){v.ULS.sendTraceTag(508679949,3048,50,"Fetching copilot state for context menu.");this.MWe=await (await Object(dp.b)(this.gDl)).isEnabled();v.ULS.sendTraceTag(508679948,3048,50,`Fetching copilot state for context menu complete. Enabled: ${this.MWe}`)}get Csn(){return this.J.$("RewriteIsEnabled")||this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",
!1)?this.Vkh&&!this.MWe:!1}O$o(b){if(!this.Mpc(b)||b.kXa||b.opc())return!1;b=b.Qa;if(Ed.ParagraphReader.kn(b)||Le.a.qf(b)||Le.a.gm(b)){b=this.YK.FKa(b);b||(b=y.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}STl(b){if(1!==b.length||X.a.Mt)return!1;const h=Lk.a.MLa;if(h&&this.$6o()||Su.xD()&&!this.Ygb.Y7h(b.Qa))return!1;const r=un.qc.isFeatureEnabled(54);return b.K(0).contextId===
mc.a.Vc&&(h||r)&&0<this.eo.K3c(b.K(0),0).count||h&&this.ckc(b)?!0:!1}ITl(b){return 1===b.length&&this.Feh.dC(b.Qa.node).fma}JJm(b){var h,r;const A=null===(h=this.u_d)||void 0===h?void 0:h.sX(null===(r=null===b||void 0===b?void 0:b.Qa)||void 0===r?void 0:r.node);return ir.a.rJi(A)}get Qw(){return null!=this.kVg?this.kVg:this.kVg=$a.a.instance.Oa(1059)}get jDl(){return null!=this.RUg?this.RUg:this.RUg=$a.a.instance.Oa(1060)}get gDl(){return null!=this.QUg?this.QUg:this.QUg=$a.a.instance.Ra(691)}aUl(b){if(!this.$oa.mXi()||
!this.Qw||this.Qw.isVisible||!(1===b.length||2===b.length&&Le.a.rl(b.Wc))||b.fub||!Le.a.gm(b.Qa)&&b.Qa.contextId!==mc.a.paragraph||b.b2i()||this.Feh.dC(b.Qa.node).fma)return!1;const h=Ed.ParagraphReader.text(b.Qa.node),r=b.Qa.contextId===mc.a.paragraph?0:b.Qa.cpBegin,A=b.Qa.contextId===mc.a.paragraph?h.length:b.Qa.cpEnd-r;return 1>A||1500<A||C.a.Uf(C.a.IDa(h.substr(r,A)))||1!=Lq.a.Nqb(b.Qa.node)?!1:!0}HTl(){return 32==this.ga.Ob(ub.a.Bkd,1)}ckc(b){return this.wxf.ckc(b)}wYd(b,h,r,A=null){this.Mpd(b)||
this.wxf.wYd(b,h,r,A)}tim(b){return this.M4e?this.M4e.uim(b):[]}wYo(b){const h=this.WS?this.WS.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new aE,{menuTargetType:h})}static get qc(){return null!=un.JWg?un.JWg:un.JWg=$a.a.instance.resolve(23)}static EDg(b){return y.AFrameworkApplication.m3&&!b.kXa&&$a.a.instance.resolve(1061).mwn()}static F8d(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=C.a.bB(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static jIl(b){let h=
WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=un.F8d(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static rfk(b){b=un.F8d(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,b):null}static wAi(){const b=(new Zr.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static $Uj(b){const h=un.qc.isFeatureEnabled(42);return!b.QWc&&h&&!X.a.Mt&&b.kXa}static a9o(b){const h=
un.qc.isFeatureEnabled(42);return!b.QWc&&h&&!X.a.Mt&&b.HN}static bEg(b){return y.AFrameworkApplication.J.$("WordEditorSmartLookupIsEnabled")&&!b.opc()}static mVj(b){return y.AFrameworkApplication.J.$("LanguageTranslationIsEnabled")&&!b.kXa&&!b.opc()}static h9o(b){return b.c2i()&&y.AFrameworkApplication.ta.Hb.I$c}static vVj(){return 2===$l.a.Pm.mode}static Iap(b){return b.HN}static N$o(b){return b.HN}Hjm(b){var h,r;return null!==(r=null===(h=this.jDl)||void 0===h?void 0:h.e1l(b))&&void 0!==r?r:[]}ffo(b,
h,r,A){this.bvb[A].forEach(M=>{const ba=Object.assign(new xh.a,{ControlList:[]}),oa=ba.ControlList;M.forEach(Ja=>{Ja instanceof Dl?r.push(...this.owe.get(Ja)(b,h,this)):oa.push(...this.sC[Ja](b,h,this))});(null===oa||void 0===oa?0:oa.length)&&r.push(ba)})}rfo(){this.owe.set(Dl.P3b,Hu.sHm);this.owe.set(Dl.DHe,Hu.Xqm);this.owe.set(Dl.vIe,Hu.IMm)}sfo(){this.sC[wh.hBb]=Um.Smm;this.sC[wh.BIe]=Um.vOm;this.sC[wh.CIe]=Um.BOm;this.sC[wh.CHe]=Um.Kqm;this.sC[wh.ZHe]=Um.aBm;this.sC[wh.DIe]=Um.JOm;this.sC[wh.nHe]=
Um.bHf;this.sC[wh.THe]=Um.Wxm;this.sC[wh.yvd]=Um.AAi;this.sC[wh.SHe]=Um.Qwm;this.sC[wh.uIe]=Um.zMm;this.sC[wh.FIe]=Um.AQm;this.sC[wh.gIe]=Um.gIm;this.sC[wh.lIe]=Um.SJm;this.sC[wh.Bvd]=Um.Gzm;this.sC[wh.Evd]=Um.RFm;this.sC[wh.hIe]=Um.E8d;this.sC[wh.hvd]=Um.getContentControls;this.sC[wh.bJe]=Um.nTm;this.sC[wh.kIe]=Um.CJm;this.sC[wh.EHe]=Um.Erm;this.sC[wh.uHe]=Um.cmm;this.sC[wh.EIe]=Um.pQm;this.sC[wh.tHe]=Um.Ilm;this.sC[wh.fvd]=Um.getBookmark;this.sC[wh.PHe]=Um.$vm;this.sC[wh.RHe]=Um.rla;this.sC[wh.l1a]=
Um.wnm;this.sC[wh.yvd]=Um.AAi;this.sC[wh.FHe]=Um.vsm;this.sC[wh.kQg]=Um.Rom}V7m(){const b=[wh.ZHe,wh.DIe,wh.nHe,wh.BIe];this.bvb[fg.uSg]=[[wh.hBb],b,[wh.l1a],[Dl.P3b],[wh.hvd]];this.bvb[fg.ORg]=[[wh.hBb],[wh.uHe,wh.EHe,wh.bJe,wh.kIe],b,[wh.l1a],[Dl.P3b]];this.bvb[fg.GQg]=[[wh.FHe],[wh.Bvd,wh.Evd],[wh.fvd,wh.l1a],[Dl.P3b]];this.bvb[fg.SQg]=[[wh.yvd],[wh.CHe],[Dl.vIe],[Dl.DHe],[wh.hBb],[wh.THe,wh.SHe,wh.uIe,wh.FIe],[wh.gIe,wh.lIe,wh.Evd],[wh.kQg],[wh.Bvd],b,[wh.hvd],[wh.RHe,wh.fvd,wh.PHe,wh.l1a],[wh.hIe],
[wh.EIe],[wh.tHe],[wh.CIe],[Dl.P3b]];this.bvb[fg.NQg]=[[wh.hBb],[wh.l1a]];this.bvb[fg.zQg]=[[wh.hBb],[wh.SHe]];this.bvb[fg.Ehk]=[[wh.yvd],[wh.CHe],[Dl.vIe],[Dl.DHe],[wh.hBb],[wh.uHe],[wh.EHe],[wh.bJe],[wh.kIe],[wh.THe],[wh.uIe],[wh.FIe],[wh.gIe],[wh.lIe],[wh.FHe],[wh.Bvd],[wh.Evd],[wh.RHe],[wh.ZHe],[wh.DIe],[wh.nHe],[wh.BIe],[wh.fvd],[wh.PHe],[wh.l1a],[wh.hIe],[wh.hvd],[wh.EIe],[wh.tHe],[wh.CIe],[Dl.P3b]]}}Object(u.a)(un,"EditSurfaceContextMenu",Ri,[]);var fg;(function(b){b[b.uSg=1]="TABLE_MULTI_CELL";
b[b.SQg=2]="GENERIC";b[b.ORg=3]="PICTURE";b[b.GQg=4]="EQUATION";b[b.Ehk=5]="LEGACY";b[b.NQg=6]="FLUID";b[b.zQg=7]="DRAWING"})(fg||(fg={}));Object(u.b)("Scenarios",fg);class Dl{}Dl.P3b=new Dl;Dl.DHe=new Dl;Dl.vIe=new Dl;Object(u.a)(Dl,"Sections",null,[]);var wh;(function(b){b[b.yvd=1]="INTENT_SUGGESTION";b[b.hBb=2]="ESSENTIALS";b[b.THe=3]="INSIGHT";b[b.SHe=4]="ILLUSTRATION";b[b.uIe=5]="SMART_LOOKUP";b[b.FIe=6]="TRANSLATE";b[b.gIe=7]="PROOFING";b[b.lIe=8]="REWRITE_SUGGESTIONS";b[b.Bvd=9]="LISTS";b[b.Evd=
10]="PARAGRAPH_OPTIONS";b[b.ZHe=11]="MERGE_SPLIT_CELLS";b[b.DIe=12]="TABLE_SORT";b[b.nHe=13]="ALT_TEXT";b[b.RHe=14]="HYPERLINK";b[b.fvd=15]="BOOKMARK";b[b.PHe=16]="HEADING_LINK";b[b.l1a=17]="COMMENT";b[b.hIe=18]="PULL_QUOTE";b[b.bJe=19]="WRAP_TEXT";b[b.kIe=20]="RESET_PICTURE";b[b.EHe=21]="DRAW";b[b.EIe=22]="TRACK_CHANGE";b[b.tHe=23]="CATCHUP_ACTIVITIES";b[b.CIe=24]="TABLE_OF_CONTENTS";b[b.CHe=25]="DESIGNER_REVIEW";b[b.BIe=26]="TABLE_ITEMS";b[b.uHe=27]="CHANGE_PICTURE";b[b.FHe=28]="EQUATION_TOOLS";
b[b.hvd=29]="CONTENT_CONTROL";b[b.kQg=30]="COPILOT_COMPOSE"})(wh||(wh={}));Object(u.b)("SectionItem",wh);class Hs extends Gu{constructor(b,h,r){super();this.nl=null;this.zqe=(A,M,ba,oa,Ja)=>{if(1===ba)return 32;A=[];M=[];this.a7o()&&M.push("InsertTabStopMenuSplitButton");this.M6o()&&M.push("ClearAllTabStops");M.push("HideRuler");A.push(Hs.eCi(M));M=Object.assign(new Xe.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});M.MenuSectionList.push(...A);Ja.MenuItems=M;return 32};
this.ga=b;this.io=h;this.wA=r;this.Wb()}get Wib(){return document.getElementById("WACHorizontalRuler")}get CQ(){return this.io&&this.io.instance?this.io.instance.Cj:1}get target(){return this.nl}show(b,h){this.nl=b;Gu.V0b("RulerContextMenu",b,h);v.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",Hs.cS);b.set("Response","Ruler Context menu invoked.");za.Health.instance.recordKpiUsage(Hs.kpiName,1,Hs.Kaa,b)}kJm(){var b=0,h=(this.target.x-
Te.a.DHf(this.Wib))/this.CQ;h=Rh.a.gA(h,0);var r={},A=this.wA.VOb,M=zc.a.Za(A);M.Ld();if(!Hi.TableReader.yy(M))return 32===this.ga.Pb(ub.a.oNa,2,r)&&(b=r.marginLeft),h-b;b={};M={};r=this.ga.Pb(ub.a.hjd,2,b);var ba=this.ga.Pb(ub.a.NYb,2,M);if(32!==r||32!==ba)return v.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;ba=M.TablePosition;if(!ba||!b||0>=b.length)return v.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),
h;r=0;M=zc.a.Za(A);M.vb(14)&&(M.fd(16),r=Kx.a(M,!0));A=ba.x/this.CQ;for(M=0;M<r;M++)A+=b[M];return h-A}Wb(){this.ga.fb(Hc.a.zqe,mc.a.application,this.zqe,96)}a7o(){var b={},h={},r=this.ga.Pb(ub.a.oNa,2,b),A=this.ga.Pb(ub.a.ldb,2,h);if(32===r&&32===A){A=h.Iu;r=Rh.a.sj(A.Sfa,0);A=1===A.specialIndentType?Rh.a.sj(A.$A,0):Rh.a.sj(A.$A-A.Gha,0);const M=Rh.a.sj(b.marginLeft,0);b=Rh.a.sj(b.marginRight,0);const ba=Te.a.DHf(this.Wib),oa=Te.a.jui(this.Wib);h.isRtl?(h=ba+this.CQ*Math.max(b,b+r),r=oa-this.CQ*
Math.max(M,M+A)):(h=ba+this.CQ*Math.max(M,M+A),r=oa-this.CQ*Math.max(b,b+r));if(this.target.x>=h&&this.target.x<=r)return!0}return!1}M6o(){var b={};if(32!==this.ga.Pb(Hc.a.AYb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static eCi(b){const h=Object.assign(new xh.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new Pj.a,{ExternalId:r}));return h}}Hs.Kaa="wwaengidc";Hs.kpiName="WordRuler";Hs.cS="RulerContextMenu";Object(u.a)(Hs,"RulerContextMenu",Gu,[377]);var Uo=
d(282),Iw=d(1352),mG=d(458),kL=d(752),Dw=d(1149),mz=d(1707);class Rj{constructor(){this.lineStyle=hi.a.dI;this.Iqc=hi.a.eI;this.borderColor=hi.a.s2}}Object(u.a)(Rj,"TableBorderFormattingData",null,[]);var Qt=d(700);class Xr{constructor(){this.r3=this.oZi=!1;this.Xzb=Qt.a.none;this.Ix=0;this.ngb=1}}Object(u.a)(Xr,"WrapTextPropertiesData",null,[]);var Ul=d(1055);class Sj extends Dw.a{constructor(b=null){super(b);this.JDh=new mz.a;this.lLh=new Xr;this.mHh=new Rj;this.fUe=!1;this.cQi=h=>{const r=new Uo.a;
r.UJa=!0;r.MO=h;return r};this.uY=()=>{const h=new Uo.a;h.FRb=!1;h.MO=ub.a.oNa;h.td=this.JDh;h.apc=!0;h.mma=!0;return h};this.Qxj=()=>{const h=new Uo.a;h.FRb=this.fUe;this.fUe=!0;h.MO=ub.a.rNa;h.td=this.mHh;h.apc=!0;h.mma=!0;return h};this.Iud=()=>{const h=new Uo.a;h.FRb=!1;h.MO=Hc.a.gvc;h.td=this.lLh;h.apc=!0;h.mma=!0;return h};this.Uae=(h,r)=>{const A=new Uo.a;A.td=new ji.DictionaryPropertySet;switch(h){case Hc.a.c7c:A.td.setValue(Bd.a.qsb,r[ki.a.Number]);break;case Hc.a.$6c:A.td.setValue(Bd.a.nsb,
r[ki.a.Number]);break;case Hc.a.a7c:A.td.setValue(Bd.a.osb,r[ki.a.Number]);break;case Hc.a.b7c:A.td.setValue(Bd.a.psb,r[ki.a.Number])}return A};this.smo=()=>{const h=new Uo.a;h.td=new ji.DictionaryPropertySet;h.mma=!0;return h}}initialize(){super.initialize();this.ld.W(Hc.a.C3f,Iw.a.Csb);this.ld.W(Hc.a.F3f,Iw.a.Csb);this.ld.W(Hc.a.H3f,Iw.a.Csb);this.ld.W(Hc.a.Pog,Sj.FZa);this.ld.W(Hc.a.bjd,Sj.FZa);this.ld.W(Hc.a.Iog,Sj.FZa);this.ld.W(La.a.cvc,Sj.FZa);this.ld.W(ub.a.Rre,this.uY);this.ld.W(ub.a.Qre,
this.uY);this.ld.W(ub.a.Ore,this.uY);this.ld.W(ub.a.Tre,this.uY);this.ld.W(ub.a.Sre,this.uY);this.ld.W(ub.a.Nre,this.uY);this.ld.W(ub.a.$re,this.uY);this.ld.W(ub.a.Zre,this.uY);this.ld.W(ub.a.Yre,this.uY);this.ld.W(ub.a.Vre,this.uY);this.ld.W(ub.a.Wre,this.uY);this.ld.W(ub.a.Xre,this.uY);this.ld.W(ub.a.dpg,this.uY);this.ld.W(ub.a.cpg,this.uY);this.ld.W(ub.a.rog,this.uY);this.ld.W(ub.a.tog,this.uY);this.ld.W(ub.a.sog,this.uY);this.ld.W(ub.a.qog,this.uY);this.ld.W(ub.a.reb,Sj.iLn);this.ld.W(ub.a.F_a,
Sj.y$n);this.ld.W(ub.a.lyb,Sj.wwl);Object(Ul.a)()&&(this.ld.W(ub.a.rxc,Sj.wBn),this.ld.W(ub.a.Tog,this.uY),this.ld.W(ub.a.Sog,this.uY));this.ld.W(ub.a.Tqa,Sj.FZa);this.ld.W(ub.a.ZXb,Sj.FZa);this.ld.W(ub.a.JZa,Sj.FZa);this.ld.W(ub.a.dza,Sj.FZa);this.ld.W(ub.a.vDa,Sj.FZa);this.ld.W(Hc.a.Dhd,Sj.FZa);this.ld.W(Hc.a.d4d,Iw.a.UEf);this.ld.W(Hc.a.e4d,this.Esi);this.Sn.W(Hc.a.Bhd,Iw.a.UUa);this.Sn.W(Hc.a.Chd,Iw.a.UUa);this.ld.W(ub.a.n0b,Iw.a.A8a);this.ld.W(ub.a.m0b,Iw.a.A8a);this.ld.W(ub.a.Fyb,Iw.a.A8a);
this.ld.W(ub.a.rpg,this.CH);this.ld.W(ub.a.ppg,this.CH);this.ld.W(ub.a.qpg,this.CH);this.ld.W(ub.a.rM,Sj.Oko);this.Sn.W(Hc.a.Fse,Sj.vkd);this.Sn.W(Hc.a.Gse,Sj.vkd);this.Sn.W(Hc.a.Hse,Sj.vkd);this.Sn.W(Hc.a.Dse,Sj.vkd);this.Sn.W(Hc.a.Ese,Sj.vkd);this.ld.W(Hc.a.Fse,this.Iud);this.ld.W(Hc.a.Gse,this.Iud);this.ld.W(Hc.a.Hse,this.Iud);this.ld.W(Hc.a.Dse,this.Iud);this.ld.W(Hc.a.Ese,this.Iud);this.ld.W(Hc.a.$Ge,Sj.cCc);this.ld.W(Hc.a.aHe,Sj.cCc);this.ld.W(Hc.a.bHe,Sj.cCc);this.ld.W(Hc.a.cHe,Sj.cCc);this.ld.W(Hc.a.dHe,
Sj.cCc);this.ld.W(Hc.a.eHe,Sj.cCc);this.ld.W(Hc.a.mOa,Sj.ijc);this.ld.W(Hc.a.PUj,Sj.ijc);this.ld.W(Hc.a.QUj,Sj.ijc);this.ld.W(Hc.a.Dze,Sj.ijc);this.ld.W(Hc.a.Eze,Sj.ijc);this.ld.W(Hc.a.Apd,Sj.ijc);this.ld.W(Hc.a.$wb,this.smo);this.ld.W(Hc.a.Nid,Sj.I4d);this.ld.W(Hc.a.Fre,Sj.I4d);this.ld.W(Hc.a.Gre,Sj.I4d);this.ld.W(Hc.a.Hre,Sj.I4d);this.ld.W(Hc.a.c7c,this.Uae);this.ld.W(Hc.a.$6c,this.Uae);this.ld.W(Hc.a.a7c,this.Uae);this.ld.W(Hc.a.b7c,this.Uae);this.ld.W(ub.a.Xsa,this.cQi);this.ld.W(ub.a.PNb,this.cQi);
this.ld.W(Hc.a.Ywb,Sj.Ywb);this.ld.W(Hc.a.Mze,Iw.a.A8a);this.ld.W(ub.a.vpg,this.Qxj);this.ld.W(ub.a.wpg,this.Qxj)}clearCache(){super.clearCache();this.fUe=!1;this.JDh=new mz.a;this.lLh=new Xr;this.mHh=new Rj}SIf(){const b=super.SIf();b.hIa=Sj.hIa;b.l6a=Sj.l6a;return b}static get V9n(){return null!=Sj.q2g?Sj.q2g:Sj.q2g=$a.a.instance.Oa(1062)}static get nB(){Sj.vya||(Sj.vya=$a.a.instance.Oa(875));return Sj.vya}static FZa(b,h){b=new Uo.a;b.td=h;return b}static Znd(b,h,r){h[Ng.a.Description]=b?b.fLn(r):
null}static hIa(b,h){const r=Object(Ma.a)(mz.a,b.td),A=Object(Ma.a)(mG.a,b.td),M=Object(Ma.a)(Xr,b.td),ba=Object(Ma.a)(Rj,b.td);let oa=!0;const Ja=Sj.V9n;switch(b.owb){default:oa=Dw.a.hIa(b,h);break;case ub.a.Rre:h[Cm.a.Icon]=r.$Ba?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[Ng.a.On]=!r.FVb;Sj.Znd(Ja,h,0);break;case ub.a.Qre:h[Cm.a.Icon]=r.$Ba?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[Ng.a.On]=1===r.FVb;Sj.Znd(Ja,h,1);break;case ub.a.Ore:h[Cm.a.Icon]=r.$Ba?
"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[Ng.a.On]=2===r.FVb;Sj.Znd(Ja,h,2);break;case ub.a.Tre:h[Cm.a.Icon]=r.$Ba?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[Ng.a.On]=3===r.FVb;Sj.Znd(Ja,h,3);break;case ub.a.Sre:h[Cm.a.Icon]=r.$Ba?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[Ng.a.On]=4===r.FVb;Sj.Znd(Ja,h,4);break;case ub.a.Nre:h[Cm.a.Icon]=r.$Ba?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[Ng.a.On]=5===r.FVb;
break;case ub.a.$re:h[Ng.a.On]=!r.yXb;h[Ng.a.Description]=Ja?Ja.Cgd(0):null;break;case ub.a.Zre:h[Ng.a.On]=1===r.yXb;h[Ng.a.Description]=Ja?Ja.Cgd(1):null;break;case ub.a.Yre:h[Ng.a.On]=2===r.yXb;h[Ng.a.Description]=Ja?Ja.Cgd(2):null;break;case ub.a.Vre:h[Ng.a.On]=3===r.yXb;h[Ng.a.Description]=Ja?Ja.Cgd(3):null;break;case ub.a.Wre:h[Ng.a.On]=4===r.yXb;h[Ng.a.Description]=Ja?Ja.Cgd(4):null;break;case ub.a.Xre:h[Ng.a.On]=5===r.yXb;break;case ub.a.dpg:h[Ng.a.On]=!r.$Ba;break;case ub.a.cpg:h[Ng.a.On]=
r.$Ba;break;case ub.a.rog:h[Ng.a.On]=1===r.kWc;break;case ub.a.tog:h[Ng.a.On]=2===r.kWc;break;case ub.a.sog:h[Ng.a.On]=3===r.kWc;break;case ub.a.qog:h[Ng.a.On]=0===r.kWc;break;case ub.a.Tog:h[Ng.a.On]=-1===r.h7i;break;case ub.a.Sog:h[Ng.a.On]=2===r.h7i;break;case ub.a.rpg:h[Ng.a.On]=A.Iu?!A.Iu.specialIndentType:!1;break;case ub.a.ppg:h[Ng.a.On]=A.Iu?1===A.Iu.specialIndentType:!1;h[al.a.Image16by16Class]=A.isRtl?ag.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):ag.getImageClass("IndentSpecialFirstLine_Server_16x16x32");
break;case ub.a.qpg:h[Ng.a.On]=A.Iu?2===A.Iu.specialIndentType:!1;h[al.a.Image16by16Class]=A.isRtl?ag.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):ag.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case Hc.a.Fse:h[Ng.a.On]=1===M.ngb;break;case Hc.a.Gse:h[Ng.a.On]=8===M.ngb;break;case Hc.a.Hse:h[Ng.a.On]=9===M.ngb;break;case Hc.a.Dse:h[Ng.a.On]=3===M.ngb;break;case Hc.a.Ese:h[Ng.a.On]=4===M.ngb;break;case Hc.a.$wb:h[Ng.a.On]=b.td.ka(Bd.a.WBa,!1);break;case Hc.a.Ywb:h[ka.a.IsFreeForm]=
!0;h[ka.a.Value]=b.td[Lh.a.Value];break;case ub.a.vpg:h[Jd.a.On]=Sj.nB.fui(h.MenuItemId)===ba.lineStyle;break;case ub.a.wpg:h[Jd.a.On]=Sj.nB.gui(h.MenuItemId)===ba.Iqc}return oa}static iLn(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new Uo.a;h.td=b;return h}static y$n(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;
case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new Uo.a;h.td=b;return h}static wwl(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new Uo.a;h.td=b;return h}static wBn(b,h){b=3;switch(h.MenuItemId){case "buttonLineNumberingNone":b=-1;break;case "buttonLineNumberingContinuous":b=2}h=new Uo.a;h.td=b;return h}static Ywb(){const b=new Uo.a;b.MO=
Hc.a.Ywb;b.td={};b.mma=!0;b.apc=!0;return b}static cCc(b,h){const r=new Uo.a;r.td=new ji.DictionaryPropertySet;let A=1;switch(b){case Hc.a.cHe:A=1;break;case Hc.a.dHe:A=8;break;case Hc.a.eHe:A=9;break;case Hc.a.aHe:A=3;break;case Hc.a.bHe:A=4}r.td.setValue(Bd.a.ngb,A);r.td.setValue(Bd.a.tOa,h[Ng.a.SourceControlId]);return r}static ijc(b,h,r){b=new Uo.a;b.td=r.InvocationMethod;return b}static Oko(b,h){b=new Uo.a;b.td=h;return b}static vkd(){const b=new kL.a;b.MO=Hc.a.gvc;return b}static I4d(){const b=
new Uo.a;b.td=new ji.DictionaryPropertySet;b.E$c=!0;return b}static l6a(b,h){let r=!0;switch(b.owb){case Hc.a.Nid:b=b.td.ka(Bd.a.qsb,0);h[ki.a.Number]=b;h[ki.a.UnitType]=7;break;case Hc.a.Fre:b=b.td.ka(Bd.a.nsb,0);h[ki.a.Number]=b;h[ki.a.UnitType]=7;break;case Hc.a.Gre:b=b.td.ka(Bd.a.osb,0);h[ki.a.Number]=b;h[ki.a.UnitType]=7;break;case Hc.a.Hre:b=b.td.ka(Bd.a.psb,0);h[ki.a.Number]=b;h[ki.a.UnitType]=7;break;default:r=Dw.a.l6a(b,h)}return r}}Sj.vya=null;Object(u.a)(Sj,"CuiActionBridge",Dw.a,[]);class jC extends ug.a{constructor(b){super();
this.Uwl=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.J3o=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.y_d=this.fIb=this.O9=this.K3a=this.H8e=null;this.XIj=h=>{h.target.setAttribute(Pe.a.Nmb,Pe.a.qq);Sys.UI.DomElement.removeCssClass(this.fIb,"inactiveRowSelection");this.fIb=h.target};this.WIj=h=>{h.target.removeAttribute(Pe.a.Nmb);Sys.UI.DomElement.addCssClass(h.target,"inactiveRowSelection")};this.I0h=h=>{(h=h.target.parentNode)&&h!==this.fIb&&this.q4(h)};this.U_j=h=>h.Nb.keyCode===
rf.a.Tu?(h.Nb.stopPropagation(),!0):!1;this.ELh=h=>{if(!h.Nb)return!1;const r=h.Nb.keyCode;if(h.eventName===zd.a.kj){h=this.xxm(this.fIb);let A=-1;const M=tb.a.count(this.Oye)-1;r===Sys.UI.Key.down?A=h<M?h+1:0:r===Sys.UI.Key.up?A=0<h?h-1:M:r===Sys.UI.Key.home?A=0:r===Sys.UI.Key.end&&(A=M);-1!==A&&this.q4(this.O9.tBodies[0].children[A])}return!0};this.Zb=b;this.lh="<div id='AccessibilityHelpDialogBody'></div>";this.Pg="AAccessibilityHelpDialog";this.Ed=6;this.Qe(0,CommonUIStrings.l_DialogClose)}get vxf(){return null}get Oye(){this.H8e||
(this.H8e=this.l9m());return this.H8e}get ojp(){return 300}get Zej(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get Yej(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get J7a(){return this.Zb.gu()}A_a(b){super.A_a(b);this.Qeo()}U_a(){this.showDialog(this.dialogTitle,Object(F.a)(this,this.lUk,"accHelpDialogResultHandler"));this.vNa();this.setFocus()}setFocus(){this.O9?(this.fIb=this.O9.tBodies[0].firstChild,this.q4(this.fIb)):this.qJ&&"none"!==this.qJ.style.display?this.q4(this.qJ):
this.q4(this.sB)}$qa(){this.oe.nb(zd.a.kj,this.y_d,this.ELh);if(this.O9){this.oe.nb(zd.a.hi,this.O9,this.U_j);const b=this.O9.tBodies[0].children;for(let h=0;h<b.length;h++)if(uf.a.addHandler(b[h],zd.a.focus,this.XIj),uf.a.addHandler(b[h],zd.a.blur,this.WIj),X.a.Mt){const r=b[h].children;for(let A=0;A<r.length;A++)uf.a.addHandler(r[A],zd.a.focus,this.I0h)}}super.$qa()}Qob(){this.oe&&(this.oe.xc(zd.a.kj,this.y_d,this.ELh),this.O9&&this.oe.xc(zd.a.hi,this.O9,this.U_j));if(this.O9){const b=this.O9.tBodies[0].children;
for(let h=0;h<b.length;h++)if(uf.a.removeHandler(b[h],zd.a.focus,this.XIj),uf.a.removeHandler(b[h],zd.a.blur,this.WIj),X.a.Mt){const r=b[h].children;for(let A=0;A<r.length;A++)uf.a.removeHandler(r[A],zd.a.focus,this.I0h)}}super.Qob()}vNa(){this.J7a.scope.qt(this.Zb.LZ);this.J7a.scope.qt(this.Zb.MZ);this.J7a.scope.bindAction(this.Zb.LZ,La.a.kSc);this.J7a.scope.bindAction(this.Zb.MZ,La.a.jSc)}HYm(b){if(!this.J7a.Tk||!this.J7a.Tk.Hra)return 2;var h=this.J7a.Tk.Hra;if(this.O9&&(h===this.sB&&b===La.a.kSc||
h===this.K3a&&b===La.a.jSc))this.q4(this.fIb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===La.a.kSc?h=this.K3a:b===La.a.jSc&&(h=this.sB),h&&this.q4(h);else if(b===La.a.kSc)this.J7a.Rrc();else if(b===La.a.jSc)this.J7a.Prc();else return 2;return 32}lUk(){}Qeo(){this.y_d=document.getElementById("AccessibilityHelpDialogBody")||this.Oq;this.KLl();this.kLl();this.UIl()}KLl(){if(this.vxf){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");
h.innerText=this.vxf;b.appendChild(h);this.dpa.appendChild(b)}}kLl(){if(this.Oye&&!tb.a.isEmpty(this.Oye)){this.O9=document.createElement("table");this.O9.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(Pe.a.Sh,Pe.a.STc);b.appendChild(h);var r=xd.a.IXc(14,this.Uwl);h.appendChild(r);r=xd.a.IXc(14,this.J3o);h.appendChild(r);this.O9.appendChild(b);b=document.createElement("tbody");h=0;r=this.Oye;for(const ba in r){var A=ba,M=r[ba];
const oa=document.createElement("tr");oa.tabIndex=0;oa.setAttribute(Pe.a.Sh,Pe.a.STc);oa.id="SelectableTableRow"+h++;A=xd.a.IXc(15,A);oa.appendChild(A);M=xd.a.IXc(15,M);oa.appendChild(M);b.appendChild(oa)}b.style.maxHeight=this.ojp+"px";this.O9.appendChild(b);this.y_d.appendChild(this.O9)}}UIl(){if(this.Yej&&this.Zej){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.K3a=document.createElement("a");this.K3a.innerText=this.Yej;this.K3a.href=this.Zej;this.K3a.target=
"_blank";this.K3a.id=this.Ej("AccessibilityHelpDialogLink");this.K3a.className=pd.AFrame.Khf;b.appendChild(this.K3a);this.Oc.insertBefore(b,this.Oc.lastChild)}}xxm(b){return Number.parseInvariant(b.id.substr(18))}k2(b,h,r,A=null){b&&h&&r&&(r=A?String.format(r,A):r,b[h]=r)}vHi(b,h){return X.a.om?h:b}}Object(u.a)(jC,"AAccessibilityHelpDialog",ug.a,[34]);class Is extends jC{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get vxf(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}l9m(){const b=
this.vHi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.vHi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),r={};this.k2(r,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);this.k2(r,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.k2(r,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);
this.k2(r,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.k2(r,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,
b);this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,b);this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,
b);this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("AccessibleMovingDialogsEnabled")&&this.k2(r,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled")&&this.k2(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(Is.qc&&Is.qc.isFeatureEnabled(54)||Lk.a.MLa)&&this.k2(r,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return r}static get qc(){return null!=Is.tWg?Is.tWg:Is.tWg=$a.a.instance.Oa(23)}}Object(u.a)(Is,"AccessibilityHelpDialog",jC,[]);var Vs=d(392);class bj{static get lh(){return ug.a.ry(bj.Qn,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}
bj.Qn="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";Object(u.a)(bj,"ApplyStylesDialogHtml",null,[]);class Ew extends ug.a{constructor(b,
h){super();this.DJ=null;this.LQc=!1;this.CJb=this.$gb=this.XMc=this.bNc=this.aRc=null;this.n$k=(r,A)=>{if(this.zh.sw){if(r){r=A.styleList;A=A.styleText;if(-1===r||C.a.xh(A)!==C.a.xh(this.DJ[r]))r=this.OHi(A);A=this.DJ[r];r=this.Xb.xo();zi.a.Jg.xn?(r=r.mv(),A=this.Xb.Be(r.fBa(A))):A=this.Xb.Be(r.MKa(A));y.AFrameworkApplication.va.Pf(this._context,ub.a.PT,2,!1,new Vs.a,A)}this.zh.Z8()}};this.$5n=r=>{this.LQc?(this.LQc=!1,this.validate()):"value"===r.rawEvent.propertyName&&(this.LQc=!0,this.b2.value!==
this.aRc&&(this.aRc=this.b2.value,this.AVh()))};this.u1n=()=>{-1!==this.rqa.selectedIndex&&(X.a.N7&&(this.LQc=!0),this.aRc=this.DJ[this.rqa.selectedIndex],this.b2.value=this.DJ[this.rqa.selectedIndex],this.validate())};this.onKeyDown=r=>{X.a.tM?r.keyCode!==rf.a.UD&&r.keyCode!==rf.a.S4||this.$gb||this.CJb||(this.CJb=new wc.a(0,1,1,this.jGp),y.AFrameworkApplication.oc.Yb(this.CJb)):X.a.N7&&r.keyCode===rf.a.UD&&(this.LQc=!0)};this.VI=()=>{this.$gb||(this.$gb=new wc.a(0,1,1,this.Ubl),y.AFrameworkApplication.oc.Yb(this.$gb));
this.CJb&&(y.AFrameworkApplication.oc.uf(this.CJb),this.CJb=null)};this.Ubl=()=>{this.$gb=null;this.AVh()};this.jGp=()=>{this.CJb=null;this.validate()};this._context=b;this.Cd=h;this.Pg="ApplyStylesDialog";this.zh=this._context.view;this.uOf();b=this.$gp();h="";this.DJ.length>b&&(h=this.DJ[b]);h={["styleText"]:h,["styleList"]:b};this.lh=bj.lh;this.gi(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.n$k,h);this.rqa=document.getElementById("styleList");this.Olg();this.rqa.selectedIndex=b;this.b2=
document.getElementById("styleText");this.b2.focus();this.b2.select();this.oId=this.u1n;uf.a.addHandler(this.rqa,"change",this.oId);this.nId=this.onKeyDown;uf.a.addHandler(this.b2,"keydown",this.nId);X.a.N7?(this.bNc=this.$5n,uf.a.addHandler(this.b2,"propertychange",this.bNc),this.aRc=this.DJ[b]):(this.XMc=this.VI,uf.a.addHandler(this.b2,"keypress",this.XMc))}get Xb(){return null!=this.l7g?this.l7g:this.l7g=$a.a.instance.resolve(8)}get Jg(){return null!=this.S4g?this.S4g:this.S4g=$a.a.instance.Oa(28)}$gp(){var b=
this.zh.lb;if(!b||!b.gb)return Tc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.gb.currentSelection;if(!b)return Tc.b(579216409,3018,15,"CurrentSelection is null"),0;Ed.ParagraphReader.kn(b.Qa)&&(b=Le.a.yk(b,!0,!1));b=b.Qa;if(!b||!Le.a.Vw(b))return Tc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=xa.FormattingReader.Us(b);(h=xa.FormattingReader.kBa(h))||(h=this.Xb.Hq(b.node));if(!h)return 0;b=this.Xb.LL(h);b=Array.indexOf(this.DJ,b);0>b&&(b=0);
return b}Olg(){const b=this.DJ.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.DJ[h];this.rqa.add(r,null)}}uOf(){var b=zi.a.Qp();if(b){if(this.Jg.xn){var h=(new lu.WACStyleSet).lla(b);b=h.Ow}else{var r=(new lu.WACStyleSet).$aa(b);b=r.Ow}var A=this.Cd.isFeatureEnabled(102)&&!!this.Xb.Xg;this.DJ=[];for(let M=0;M<b;M++){let ba;ba=r instanceof lu.WACStyleSet?r.eBa(M):h.Bla(M);if(this.Xb.isHidden(ba))continue;const oa=this.Xb.NF(ba);if(!A){if(3===oa)continue}else if(3===
oa&&this.Xb.Be(ba)===Vz.a.rWb)continue;Array.add(this.DJ,this.Xb.LL(ba))}this.DJ.sort(Ew.Cyl)}else Tc.b(577644352,3018,15,"Couldn't find PageContentNode")}dispose(){this.bNc&&uf.a.removeHandler(this.b2,"propertychange",this.bNc);this.nId&&uf.a.removeHandler(this.b2,"keydown",this.nId);this.oId&&uf.a.removeHandler(this.rqa,"change",this.oId);this.XMc&&uf.a.removeHandler(this.b2,"keypress",this.XMc);this.$gb&&y.AFrameworkApplication.oc.uf(this.$gb);this.$gb=this.XMc=this.rqa=this.b2=this.nId=this.bNc=
this.oId=null;super.dispose()}AVh(){var b=this.b2.value,h=this.b7m(b);const r=-1===h?b:this.DJ[h];b=b.length;const A=r.length;this.aRc=r;this.b2.value=r;this.rqa.selectedIndex=h;A>b&&(X.a.tM?this.b2.setSelectionRange(b,A):X.a.N7&&(h=this.b2.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",A-b),h.select()));this.validate();this.b2.focus()}b7m(b){let h=0,r=this.DJ.length,A=-1;for(b=C.a.xh(b);h<r;){const M=Math.floor((h+r)/2),ba=Ew.Nqf(b,this.DJ[M]);if(!ba){A=M;break}0<
ba?h=M+1:r=M}if(A>h)for(;!Ew.Nqf(b,this.DJ[A-1])&&(A--,A!==h););return A}validate(){const b=-1===this.OHi(this.b2.value),h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}OHi(b){b=C.a.xh(b);const h=this.DJ.length;for(let r=0;r<h;r++)if(b===C.a.xh(this.DJ[r]))return r;return-1}static Nqf(b,h){const r=Math.min(b.length,h.length);b=C.a.xh(b);h=C.a.xh(h);for(let A=0;A<
r;A++){const M=C.a.charCodeAt(b,A),ba=C.a.charCodeAt(h,A);if(M!==ba)return M-ba}return b.length<=h.length?0:1}static Cyl(b,h){return Ew.Nqf(b,h)}}Object(u.a)(Ew,"ApplyStylesDialog",ug.a,[]);var wA=d(225);class jI extends kh.StandardDialog{constructor(b){super();this.gy=b;this.T8o()}T8o(){this.Ed=1;this.xY(1);this.Qe(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.Mx(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.Lwf.bind(this))}Lwf(b){1===
b&&this.gy.Cva("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.ij?Tc.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.zk,h.zk.stack):(this.NIo(),Tc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}NIo(){wA.a.OAb="{}"}}Object(u.a)(jI,"DeleteSavedStylesConfirmationDialog",kh.StandardDialog,[]);class JF extends kh.StandardDialog{constructor(b,h){super();this.Lwf=M=>{if(1===M){M=new Map;M.set("Source","DeleteStyleConfirmationDialog");M.set("Action",
"DeleteStyle");za.Health.instance.recordKpiUsage(Or.a.gFa,0,Or.a.$B,M);var ba=zi.a.Qp();M=new Qb.GraphTransaction(15);M.Ab(ba);M.Ei=ub.a.DNb;this.CM.qei(this.HGh)?Tc.b(578359694,3018,50,"User deleted a style via UI."):(ba=new Map,ba.set("Source","DeleteStyleConfirmationDialog"),ba.set("Action","DeleteStyle"),ba=Object.assign(new bb.a,{extendedProperties:ba}),za.Health.instance.recordKpiFailure(Or.a.gFa,"DeleteStyleFailed",!1,!0,ba),Tc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));
M.dispose()}};h||Tc.b(590128417,3018,10,"styleId is null");let r=null,A=null;if(this.zh=b.view)A=this.zh.lb;A&&(r=A.gb.currentSelection.Qa);r?(b=r.node)?(this.YM=Object(fn.a)().Nu(b))?(this.HGh=new qb.a,this.HGh.add(h),this.U8o(h)):Tc.b(590128448,3018,10,"_pageContenNode is null."):Tc.b(590128419,3018,10,"node is null."):Tc.b(590128418,3018,10,"nodeContext is null.")}get CM(){return null!=this.c7g?this.c7g:this.c7g=$a.a.instance.resolve(393)}get Xb(){return null!=this.u7g?this.u7g:this.u7g=$a.a.instance.resolve(8)}U8o(b){const h=
(new lu.WACStyleSet).$aa(this.YM);h?((b=h.mh(b))||Tc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.Xb.LL(b),this.Ed=4,this.xY(2),this.Mx(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.Lwf)):Tc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(u.a)(JF,"DeleteStyleConfirmationDialog",kh.StandardDialog,[]);class zD{static get lh(){return ug.a.ry(zD.Qn)}}zD.Qn=
"<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(u.a)(zD,"DeleteStyleDialogHtml",null,[]);class Ot extends ug.a{constructor(b){super();this.YM=this.DJ=null;this.eSl=(h,r)=>{this.zh.sw&&(h?(h=r.styleList,-1!==h&&(h=this.DJ[h],r=this.Xb.xo(),zi.a.Jg.xn?(r=r.mv(),h=this.Xb.Be(r.fBa(h))):h=this.Xb.Be(r.MKa(h)),this.lZc.dSl(this._context,h),this.zh.Z8())):this.zh.Z8())};this._context=b;this.Pg="DeleteStyleDialog";this.Ed=1;this.Qe(1,
WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.zh=this._context.view;this.uOf();this.lh=zD.lh;this.gi(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.eSl,{["styleList"]:0});this.rqa=document.getElementById("styleList");this.Olg();this.rqa.selectedIndex=0;this.rqa.focus()}get Xb(){return null!=this.o7g?this.o7g:this.o7g=$a.a.instance.resolve(8)}get lZc(){return null!=this.mVg?this.mVg:this.mVg=$a.a.instance.resolve(1063)}Olg(){const b=this.DJ.length;for(let h=0;h<b;h++){const r=
document.createElement("OPTION");r.value=h.toString();r.text=this.DJ[h];this.rqa.add(r,null)}}uOf(){if(this.YM=zi.a.Qp()){var b=(new lu.WACStyleSet).$aa(this.YM),h=b.mv();var r=zi.a.Jg.xn?h.Ow:b.Ow;this.DJ=[];for(let M=0;M<r;M++){let ba;ba=zi.a.Jg.xn?h.Bla(M):b.eBa(M);if(!this.Xb.isHidden(ba)&&this.Xb.me(ba,b)){var A=this.Xb.NF(ba);if(2===A||1===A)ba.hasProperty(Rc.a.linkedStyle)&&2!==A||(A=ba.ka(Rc.a.nE,null))&&0<A.length||this.DJ.push(this.Xb.LL(ba))}}this.DJ.sort()}else Tc.b(578650370,3018,15,
"PageContentNode is null")}}Object(u.a)(Ot,"DeleteStyleDialog",ug.a,[]);var vK=d(776);class kI{constructor(b){this.em=null;this.xR=b}}Object(u.a)(kI,"PropertySetChangedState",null,[]);class KF{static ajo(b,h,r){if(b&&h){var A=new kI(h),M=(ba,oa,Ja)=>{r.$io(ba,oa,Ja,A)};b=new vK.a(h,b);b.ORd=M;b.kVd=M;b.sue=M;b.ddb()}}}Object(u.a)(KF,"PropertySetChangedManager",null,[]);class UB{constructor(b){this.FSa=b}$io(b,h,r,A){const M=this.FSa[b.id.toString()];M&&M(b,h,r,A)}}Object(u.a)(UB,"PropertyChangedProcessor",
null,[]);const AD=(b,h,r)=>{const A=kt.a.instance.VOb;if(A){const M=new Qb.GraphTransaction(15);M.Ab(A);KF.ajo(b,h,new UB(r));M.dispose()}};class xA{static get lh(){return ug.a.ry(xA.Qn,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}xA.Qn="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(u.a)(xA,"MarginsDialogHtml",null,[]);class Bp{static get r8(){return null!=Bp.r2g?Bp.r2g:Bp.r2g=$a.a.instance.Oa(1064)}static eLn(b,h,r){Bp.r8&&null!==r&&Bp.r8.Txe(0,r)}static aLn(b,h,r){Bp.r8&&null!==r&&Bp.r8.Txe(3,r)}static cLn(b,h,r){Bp.r8&&null!==r&&Bp.r8.Txe(1,r)}static dLn(b,h,r){Bp.r8&&null!==r&&Bp.r8.Txe(2,r)}static H$n(b,h,r){Bp.r8&&null!==r&&Bp.r8.F_a(0,r)}static i$n(b,h,r){Bp.r8&&null!==r&&Bp.r8.F_a(1,r)}static xwl(b,h,r){Bp.r8&&null!==r&&(b==le.a.ZG?Bp.r8.dxe(0,r):b==le.a.iI?Bp.r8.dxe(1,
r):b==le.a.rra?Bp.r8.dxe(2,r):b==le.a.separator&&Bp.r8.dxe(3,r))}}Object(u.a)(Bp,"PageLevelPropertyChangedHandlers",null,[]);const lI=[Hc.a.fgd,Hc.a.egd,Hc.a.Goe,Hc.a.Hoe,Hc.a.Mre,Hc.a.Jre,Hc.a.Kre,Hc.a.Lre];class Er extends ug.a{constructor(b,h,r,A,M){super();this.W1c=(ba,oa)=>{var Ja=Er.wid(ba);ba=df.a.Fba;this.Cq.hasProperty(Ja)?(Ja=this.Cq.getValue(Ja),oa[ki.a.Number]=Cg.a.zPa(Ja,ba)):oa[ki.a.Number]=0;oa[ki.a.UnitType]=ba};this.Dnd=(ba,oa)=>{this.Cq.setValue(Er.wid(ba),Cg.a.ePa(oa[ki.a.Number],
oa[ki.a.UnitType]));this.Fv.An()};this.gLn=ba=>{let oa=!1;1===ba&&(Math.abs(this.Cq.getValue(Rc.a.marginTop))+Math.abs(this.Cq.getValue(Rc.a.marginBottom))+df.a.fFa<=this.Fya.getValue(Rc.a.vw)&&this.Cq.getValue(Rc.a.marginLeft)+this.Cq.getValue(Rc.a.marginRight)+df.a.fFa<=this.Fya.getValue(Rc.a.Bp)?AD(this.uGa,this.Cq,Er.$kc()):oa=!0);this.dispose();oa&&this.aOa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.bLn)};this.bLn=()=>{$a.a.instance.resolve(1063).V$h(this.uGa,this.Fya,this.j$)};this.Pg=
"MarginsDialog";this.Fya=h.clone();this.uGa=b.clone();this.Cq=b.clone();this.j$=r;this.fZ=!1;this.Fv=M;this.lh=xA.lh;r&&(this.dGc=vr.a.h2b);this.gi(WordEditorIntl.WordEditorStrings.L_PageMargins,this.gLn,null);this.M7c();this.V9e=document.getElementById("DialogMarginTopSpinner");this.q4(this.V9e)}Pba(){this.aUd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",Hc.a.fgd,Hc.a.Mre,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.aUd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",Hc.a.egd,Hc.a.Jre,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.aUd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",Hc.a.Goe,Hc.a.Kre,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.aUd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",Hc.a.Hoe,Hc.a.Lre,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}M7c(){for(const b of lI)Object(Lm.a)(b,this.Dnd,this.W1c);this.Fv.Oua("DialogMarginTopSpinner");
this.Fv.Oua("DialogMarginBottomSpinner");this.Fv.Oua("DialogMarginLeftSpinner");this.Fv.Oua("DialogMarginRightSpinner")}dispose(){for(const b of lI)Object(Lm.b)(b);this.Fv.K0("DialogMarginTopSpinner");this.Fv.K0("DialogMarginBottomSpinner");this.Fv.K0("DialogMarginLeftSpinner");this.Fv.K0("DialogMarginRightSpinner");super.dispose()}aUd(b,h,r,A,M){r=Er.Ihl(h,r,A,M);this.OKb(r,b,h)}OKb(b,h,r){h=document.getElementById(h);this.Fv.V5a(r,b);b=this.Fv.RPb(r,"Medium");h.appendChild(b)}static $kc(){return Er.FSa||
(Er.FSa=Er.bgc())}static bgc(){const b={};b[Rc.a.marginTop.id.toString()]=Bp.eLn;b[Rc.a.marginBottom.id.toString()]=Bp.aLn;b[Rc.a.marginLeft.id.toString()]=Bp.cLn;b[Rc.a.marginRight.id.toString()]=Bp.dLn;return b}static Ihl(b,h,r,A){let M=!0;if(h===Hc.a.fgd||h===Hc.a.egd)M=!1;return Nk.j(b,h,r,A,[Er.Khl(M),Er.Jhl(M)])}static Khl(b){return Nk.l("inch",b?"0":"-22","22",".1")}static Jhl(b){return Nk.l("centimeter",b?"0":"-55.8","55.8","1")}static wid(b){let h=null;switch(b){case Hc.a.fgd:case Hc.a.Mre:h=
Rc.a.marginTop;break;case Hc.a.egd:case Hc.a.Jre:h=Rc.a.marginBottom;break;case Hc.a.Goe:case Hc.a.Kre:h=Rc.a.marginLeft;break;case Hc.a.Hoe:case Hc.a.Lre:h=Rc.a.marginRight}return h}}Er.FSa=null;Object(u.a)(Er,"MarginsDialog",ug.a,[]);class Cu{static get lh(){return ug.a.ry(Cu.Qn,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}Cu.Qn="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(u.a)(Cu,"PaperSizeDialogHtml",null,[]);const mI=[Hc.a.Koe,Hc.a.Joe,Hc.a.bse,Hc.a.ase];class $p extends ug.a{constructor(b,h,r,A,M){super();this.W1c=(ba,oa)=>{var Ja=this.wid(ba);ba=df.a.Fba;this.Cq.hasProperty(Ja)?(Ja=this.Cq.getValue(Ja),oa[ki.a.Number]=Cg.a.zPa(Ja,ba)):oa[ki.a.Number]=0;oa[ki.a.UnitType]=ba};this.Dnd=(ba,oa)=>{this.Cq.setValue(this.wid(ba),Cg.a.ePa(oa[ki.a.Number],oa[ki.a.UnitType]));this.Fv.An()};this.U$n=ba=>{let oa=!1;1===ba&&(this.Cq.getValue(Rc.a.vw)>=df.a.fFa+this.Fya.getValue(Rc.a.marginTop)+
this.Fya.getValue(Rc.a.marginBottom)&&this.Cq.getValue(Rc.a.Bp)>=df.a.fFa+this.Fya.getValue(Rc.a.marginLeft)+this.Fya.getValue(Rc.a.marginRight)?AD(this.uGa,this.Cq,$p.$kc()):oa=!0);this.dispose();oa&&this.aOa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.T$n)};this.T$n=()=>{$a.a.instance.resolve(1063).wai(this.uGa,this.Fya,this.j$)};this.Pg="PaperSizeDialog";this.Fya=h.clone();this.uGa=b.clone();this.Cq=b.clone();this.j$=r;this.fZ=!1;this.Fv=M;this.lh=Cu.lh;r&&(this.dGc=vr.a.h2b);this.gi(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,
this.U$n,null);this.M7c();this.V9e=document.getElementById("DialogWidthSpinner");this.q4(this.V9e)}Pba(){this.ZXh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",Hc.a.Koe,Hc.a.bse,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.ZXh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",Hc.a.Joe,Hc.a.ase,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}M7c(){for(const b of mI)Object(Lm.a)(b,this.Dnd,this.W1c);this.Fv.Oua("DialogWidthSpinner");this.Fv.Oua("DialogHeightSpinner")}dispose(){for(const b of mI)Object(Lm.b)(b);
this.Fv.K0("DialogWidthSpinner");this.Fv.K0("DialogHeightSpinner");super.dispose()}ZXh(b,h,r,A,M){r=$p.Yhl(h,r,A,M);this.OKb(r,b,h)}OKb(b,h,r){h=document.getElementById(h);this.Fv.V5a(r,b);b=this.Fv.RPb(r,"Medium");h.appendChild(b)}wid(b){let h=null;switch(b){case Hc.a.Joe:case Hc.a.ase:h=Rc.a.vw;break;case Hc.a.Koe:case Hc.a.bse:h=Rc.a.Bp}return h}static $kc(){return $p.FSa||($p.FSa=$p.bgc())}static bgc(){const b={};b[Rc.a.Bp.id.toString()]=Bp.H$n;b[Rc.a.vw.id.toString()]=Bp.i$n;return b}static Yhl(b,
h,r,A){return Nk.j(b,h,r,A,[$p.$hl(),$p.Zhl()])}static $hl(){return Nk.l("inch",$p.LWj,$p.czn,$p.ecp)}static Zhl(){return Nk.l("centimeter",$p.LWj,$p.bzn,$p.dcp)}}$p.LWj="0";$p.czn="22";$p.ecp=".1";$p.dcp="1";$p.bzn="55.8";$p.FSa=null;Object(u.a)($p,"PaperSizeDialog",ug.a,[]);const yA=RegExp("[{|}|;|\\\\]"),zA=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,r=b.Ow;let A;for(A=1;A<=r;A++){const M=h+A;if(!(b.hWa(M)||b.qlc(M)||b.hWa(M+"Char")||b.qlc(M+"Char")))break}return h+
A};class tx extends ug.a{constructor(b,h,r,A,M){var ba,oa,Ja,jb;super(!1,!1,!0);this.context=b;this.Qb=h;this.T2=r;this.Xb=A;this.dZa=M;this.L1d=null;this.Zyj=(zb,Eb)=>{if(this.ne.sw){if(0!==zb){zb="string"===typeof Eb.styleText?Eb.styleText:null;Eb=this.Hqd;var Sb=zb;const nc=C.a.IDa(Sb);let Dc=null;if(0===nc.length)Dc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<Sb.length)Dc=WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(yA.test(Sb))Dc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;
else if(Eb.fBa(Sb)||Eb.qlc(nc))Dc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Eb=Dc)?(this.L1d=Eb,Eb=zA(this.Hqd),zb=this.QPb(zb,Eb),this.L1d=null,this.fZ=!1,this.hide(),this.gi(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.Zyj,zb),this.fZ=!0):(this.hide(),Eb=new Map,Eb.set("Source","ReactCreateNewStyleDialog"),Eb.set("Action","CreateStyle"),za.Health.instance.recordKpiUsage(Or.a.gFa,0,Or.a.$B,Eb),this.Yef(zb)||(zb=new Map,zb.set("Source","ReactCreateNewStyleDialog"),zb.set("Action",
"CreateStyle"),zb=Object.assign(new bb.a,{extendedProperties:zb}),za.Health.instance.recordKpiFailure(Or.a.gFa,"CreateStyleFailed",!1,!0,zb)))}else this.hide();this.ne.Z8()}};this.Pg="CreateNewStyleDialog";this.ne=b.view;(b=null===(jb=null===(Ja=null===(oa=null===(ba=this.ne)||void 0===ba?void 0:ba.lb)||void 0===oa?void 0:oa.gb)||void 0===Ja?void 0:Ja.currentSelection)||void 0===jb?void 0:jb.Qa)?(ba=b.node)?(this.Vh=this.dZa.Nu(ba))?(this.Hqd=(new lu.WACStyleSet).lla(this.Vh),(this.nWb=this.T2.G2d(b))?
(ba=this.nWb.ka(ze.a.fontSize,22),16>ba?Tc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=ba?Tc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=ba?Tc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Tc.b(593078047,3018,50,"Font size more than 45pt in create new style dialog preview"),this.Tsg(this.nWb),this.Vh&&this.nWb&&(this.zda=!1,ba=zA(this.Hqd),ba=this.QPb(ba,ba),this.gi(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,
this.Zyj,ba))):Tc.b(592737758,3018,10,"_newStyleProperties is null.")):Tc.b(592737757,3018,10,"_pageContenNode is null."):Tc.b(592725466,3018,10,"node is null."):Tc.b(556917206,3018,10,"nodeContext is null.")}Tsg(b){b.Vf(Yf.a.fx,Yf.a.Jw,...Or.a.bba())}QPb(b,h){const r=52<=this.nWb.ka(ze.a.fontSize,zn.a.lR),A=dB.a.RIf(this.nWb,"97%",26,!1,!0,r);A["padding-left"]="5px";r||(A["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,
["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>A};this.L1d&&(b.errorMessage=this.L1d);return{["id"]:this.Pg,["bodyControls"]:b}}Yef(b){const h=new Qb.GraphTransaction(15);h.Ab(this.Vh);h.Ei=ub.a.TMb;const r=zi.a.Yef(b,zi.a.qFi(this.nWb),null,this.Vh);r&&(Tc.b(593078046,3018,50,"User created linked style"),this.Hqd=(new lu.WACStyleSet).lla(this.Vh),b=C.a.IDa(C.a.$_(b)),b=this.Hqd.qlc(b),this.Qb.Pf(this.context,ub.a.PT,2,!1,new Vs.a,this.Xb.Be(b)));h.dispose();return r}}Object(u.a)(tx,
"ReactCreateNewStyleDialog",ug.a,[]);class mu extends ug.a{constructor(b,h=!1,r){super(!1,!1,h);let A=h=this.QM=null;this.Pg=mu.id;this.zh=b.view;this.Gp=r;this.zh&&(A=this.zh.lb);A&&A.gb&&A.gb.currentSelection&&(h=A.gb.currentSelection.Qa);h?(b=h.node)?(this.YM=Object(fn.a)().Nu(b))||v.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):v.ULS.sendTraceTag(539762889,3029,10,"node is null"):v.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}UFp(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$",
"gu"),r=this.Zhm();const A=""===C.a.IDa(b),M=b.length>mu.tMn;r=r.includes(b);h=h.test(b);b=b.startsWith("_");let ba=null;if(A||M||r||b||!h)ba=A?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:M?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ba}ehn(b,h){return b?b===h:!1}Zhm(){const b=
this.Gp.Q4d(!1),h=[];for(let r=0;r<b.count;r++){const A=b.K(r).ka(Rc.a.zu,"");h.push(A)}return h}}mu.id="BookmarkEditDialog";mu.tMn=40;Object(u.a)(mu,"AEditBookmarkDialog",ug.a,[]);class Rv extends mu{constructor(b,h,r){super(b,!0,r);this.HRe=null;this.I2a="wwaengidc";this.AKc="ReactCreateEditBookmarkNameDialog";this.vrh="EditBookmarkName";this.Cxa="EditBookmarkNameDialog";this.CLe=h;this.Gp=r;this.YM&&(this.zda=!1,b=this.QPb(h.properties.ka(Rc.a.zu,null)),this.gi(WordEditorIntl.WordEditorStrings.l_EditBookmark,
this.azj.bind(this),b))}azj(b,h){if(this.zh.sw){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var r;this.CLe.hasProperty(Rc.a.zu)?r=this.CLe.getValue(Rc.a.zu):v.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.UFp(b);this.ehn(b,r)?(v.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.HRe=h,r=this.QPb(b),this.HRe=null,this.fZ=!1,this.hide(),this.gi(WordEditorIntl.WordEditorStrings.l_EditBookmark,
this.azj.bind(this),r),this.fZ=!0):(this.hide(),r=new Map,r.set("Source",this.AKc),r.set("Action",this.vrh),za.Health.instance.recordKpiUsage(this.Cxa,0,this.I2a,r),this.Jol(b)||(r=new Map,r.set("Source",this.AKc),r.set("Action",this.vrh),r=Object.assign(new bb.a,{extendedProperties:r}),za.Health.instance.recordKpiFailure(this.Cxa,"Unable to edit bookmark",!1,!0,r)))}else this.hide();this.zh.Z8()}}Jol(b){b=C.a.IDa(C.a.$_(b));try{const h=this.Gp.Qwp(this.CLe,b);if(h)v.ULS.sendTraceTag(539762886,3029,
50,"Updated bookmark name to name specified by user");else return v.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),h}catch(h){return v.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}QPb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.HRe;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.Pg,["bodyControls"]:h}}}Object(u.a)(Rv,"ReactEditBookmarkNameDialog",
mu,[]);class cq extends ug.a{constructor(b,h,r,A){super(!1,!1,!0);this.uwl=()=>{this.lZc.F9h(this.ARi,this.fGe,this.pad)};this.vwl=(M,ba)=>{ba&&1===M&&(ba.columnsCountSpinButtonProps&&this.s0.setValue(le.a.ZG,ba.columnsCountSpinButtonProps.value),ba.columnsWidthSpinButtonProps&&(M=ba.columnsWidthSpinButtonProps,this.s0.setValue(le.a.iI,[Cg.a.ePa(M.value,Cg.a.AUa(M.unitType.toLowerCase()))])),ba.columnsSpacingSpinButtonProps&&(M=ba.columnsSpacingSpinButtonProps,this.s0.setValue(le.a.rra,Cg.a.ePa(M.value,
Cg.a.AUa(M.unitType.toLowerCase())))),ba.columnsLineBetweenCheckboxProps&&this.s0.setValue(le.a.separator,ba.columnsLineBetweenCheckboxProps.checked),this.ywl()&&(ba=cq.ETd,this.mal()?AD(this.ARi,this.s0,this.$kc):ba=ba!==cq.ETd?ba:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),ba!==cq.ETd&&this.aOa(ba,this.uwl)))};this.ywl=()=>this.s0.hasProperty(le.a.ZG)&&this.s0.hasProperty(le.a.iI)&&this.s0.hasProperty(le.a.rra)&&this.s0.hasProperty(le.a.separator);this.h5d=(M,ba,oa)=>Math.floor((M-
(ba-1)*oa)/ba);this.LHf=(M,ba,oa)=>1==ba?0:Math.floor((M-ba*oa)/(ba-1));this.L4k=(M,ba,oa,Ja)=>{const jb=M/ba;oa<cq.Ayc?(oa=cq.Ayc,Ja=this.LHf(M,ba,oa)):oa>jb&&(oa=jb,Ja=this.LHf(M,ba,oa));return[oa,Ja]};this.I4k=(M,ba,oa,Ja)=>{const jb=(M-cq.Ayc*ba)/(ba-1);0>Ja?(Ja=0,oa=this.h5d(M,ba,Ja)):Ja>jb&&(Ja=jb,oa=this.h5d(M,ba,Ja));return[oa,Ja]};this.ePa=(M,ba)=>Cg.a.ePa(M,Cg.a.AUa(ba));this.jYc=(M,ba,oa,Ja,jb)=>({["unitType"]:M,["unitPlaceholder"]:C.a.iqe(ba),["minValue"]:oa,["maxValue"]:Ja,["step"]:jb});
this.ARi=b.clone();this.s0=b.clone();this.fGe=h.clone();this.swb=this.fGe.getValue(Rc.a.Bp)-this.fGe.getValue(Rc.a.marginLeft)-this.fGe.getValue(Rc.a.marginRight);this.MVb=Math.floor(this.swb/cq.Ayc);this.pad=r;this.lZc=A;this.Pg=cq.id;b={};b.getUnitValue=3==df.a.Fba?Cg.a.pB:Cg.a.G0a;b.getCalculatedWidthValue=this.h5d;b.getCalculatedSpacingValue=this.LHf;b.twipsFromValueAndUnits=this.ePa;b.adjustWidthForLimits=this.L4k;b.adjustSpacingForLimits=this.I4k;b.pageContentWidth=this.swb;b.maxColumnCount=
this.MVb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.hnm();b.columnsWidthSpinButtonProps=this.lnm();b.columnsSpacingSpinButtonProps=this.jnm();b.columnsLineBetweenCheckboxProps=this.inm();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.gi(Box4Intl.Box4Strings.l_ColumnsDialogTitle,this.vwl.bind(this),b)}hnm(){var b=[this.jYc("None",0,1,this.MVb,1)];const h=this.kOf(le.a.ZG);
b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Cg.a.r7a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.w0b(h,b)}lnm(){var b=[this.jYc("Inch",3,.5,Cg.a.pB(this.swb),.1),this.jYc("Centimeter",
1,1.27,Cg.a.G0a(this.swb),1)];const h=df.a.Fba,r=this.kOf(le.a.iI);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Cg.a.r7a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.w0b(r,b)}jnm(){var b=
[this.jYc("Inch",3,0,Cg.a.pB(this.swb-2*cq.Ayc),.1),this.jYc("Centimeter",1,0,Cg.a.G0a(this.swb-2*cq.Ayc),1)];const h=df.a.Fba,r=this.kOf(le.a.rra);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:Cg.a.r7a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.w0b(r,b)}inm(){const b=this.s0.getValue(le.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get $kc(){return null!=this.YXg?this.YXg:this.YXg=(()=>this.Juf())()}Juf(){const b={};b[le.a.ZG.id.toString()]=b[le.a.iI.id.toString()]=b[le.a.rra.id.toString()]=
b[le.a.separator.id.toString()]=Bp.xwl;return b}mal(){const b=this.s0.getValue(le.a.iI),h=this.s0.getValue(le.a.ZG),r=this.s0.getValue(le.a.rra);let A=0;for(let M=0;M<h;M++)A+=b[0];if(h<=this.MVb&&(h-1)*r+A<=this.swb)return!0;v.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],r);return!1}kOf(b){if(this.s0.hasProperty(b)){if(b==le.a.ZG)return this.s0.getValue(b);if(b==le.a.iI){var h=df.a.Fba;b=this.s0.getValue(le.a.rra);
const r=this.s0.getValue(le.a.ZG);return Cg.a.zPa(this.h5d(this.swb,r,b),h)}if(b==le.a.rra){if(1==this.s0.getValue(le.a.ZG))return 0;h=df.a.Fba;b=this.s0.getValue(b);return Cg.a.zPa(b,h)}}return 0}w0b(b,h){h.value=isNaN(b)?cq.ETd:b;return h}}cq.id="ColumnsDialog";cq.ETd="";cq.Ayc=720;Object(u.a)(cq,"WordReactColumnsDialog",ug.a,[]);var nG=d(482);const nv=(b,h,r)=>{const A=[];if(b.length!==h.length||r&&r.length!==h.length)return A;for(let M=0;M<b.length;M++){const ba={};ba.key=h[M];ba.text=b[M];ba.type=
"AppComboBoxItem";r&&(ba.ariaLabel=r[M]);A[M]=ba}return A},qp=(b,h,r,A,M)=>({["unitType"]:b,["unitPlaceholder"]:C.a.iqe(h),["minValue"]:r,["maxValue"]:A,["step"]:M}),rk=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),kC=(b,h,r)=>{let A=!1;b.hasProperty(h)&&b.hasProperty(r)?(r=b.getValue(r),1===r?(b=Number.NaN,h=5,A=!0):(b=b.getValue(h),h=2===r?4:5)):(b=Number.NaN,h=df.a.ILa?4:5);
return{Byc:b,Lfb:h,Hnc:A}};class lC{constructor(){this.gXj=this.Drj=this.Brj=this.Y$n=this.zjg=!1}}Object(u.a)(lC,"Box4PropertySetChangedState",null,[]);class Ol{static get Vmc(){return null!=Ol.HYg?Ol.HYg:Ol.HYg=$a.a.instance.Oa(1065)}static get e5i(){return null!=Ol.I0g?Ol.I0g:Ol.I0g=$a.a.instance.Oa(1066)}static get S8(){return null!=Ol.r4g?Ol.r4g:Ol.r4g=$a.a.instance.Oa(827)}static Yxn(b,h,r){Ol.e5i&&r&&(null===h||11!==r||10!==h&&9!==h)&&Ol.e5i.HH(r)}static BBn(b,h,r){Ol.S8&&r&&Ol.S8.bF(r)}static JBl(b,
h,r){h!=r&&Ol.S8.lxc(r)}static kyn(b,h,r){h!=r&&Ol.S8.Wnd(r)}static GIp(b,h,r){h!=r&&Ol.S8.Lod(r)}static iyn(b,h,r){h!=r&&Ol.S8.Vnd(r)}static Irj(b,h,r,A){Ol.S8&&void 0!==r&&null!==r&&(b=Ol.p2c(A),!b.zjg&&A.xR.hasProperty(Bd.a.Ltc)&&A.xR.hasProperty(Bd.a.Mtc)&&(h=A.xR.getValue(Bd.a.Mtc),A=A.xR.getValue(Bd.a.Ltc),b.zjg=!0,Ol.S8.wha(1,h,A)))}static Hrj(b,h,r,A){Ol.S8&&void 0!==r&&null!==r&&(b=Ol.p2c(A),!b.Y$n&&A.xR.hasProperty(Bd.a.Jtc)&&A.xR.hasProperty(Bd.a.Ktc)&&(h=A.xR.getValue(Bd.a.Ktc),A=A.xR.getValue(Bd.a.Jtc),
b.zjg=!0,Ol.S8.wha(0,h,A)))}static Arj(b,h,r,A){Ol.Vmc&&void 0!==r&&null!==r&&(b=Ol.p2c(A),!b.Brj&&A.xR.hasProperty(Bd.a.aNa)&&A.xR.hasProperty(Bd.a.bNa)&&(h=A.xR.getValue(Bd.a.bNa),A=A.xR.getValue(Bd.a.aNa),b.Brj=!0,Ol.Vmc.EPj(1,h,A)))}static Crj(b,h,r,A){Ol.Vmc&&void 0!==r&&null!==r&&(b=Ol.p2c(A),!b.Drj&&A.xR.hasProperty(Bd.a.wwb)&&A.xR.hasProperty(Bd.a.xwb)&&(h=A.xR.getValue(Bd.a.xwb),A=A.xR.getValue(Bd.a.wwb),b.Drj=!0,Ol.Vmc.EPj(0,h,A)))}static OEg(b,h,r,A){Ol.Vmc&&void 0!==r&&null!==r&&(b=Ol.p2c(A),
!b.gXj&&A.xR.hasProperty(Bd.a.$_a)&&A.xR.hasProperty(Bd.a.a0a)&&(h=0,A.xR.hasProperty(Bd.a.T8)&&(h=A.xR.getValue(Bd.a.T8)),r=A.xR.getValue(Bd.a.a0a),A=A.xR.getValue(Bd.a.$_a),b.gXj=!0,Ol.Vmc.pye(h,r,A)))}static p2c(b){b.em||(b.em=new lC);return b.em}}Object(u.a)(Ol,"ParagraphLevelPropertyChangedHandlers",null,[]);class Jw{constructor(){this.FSa=null}AFm(b){const h={};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};
var r=qp("Point",5,0,1584,1),A=qp("Line",4,0,327,1),M=[r,A];A=rk();var ba=[Box4Intl.Box4Strings.L_SpinnerAuto];r=[""];({Byc:Ja,Lfb:oa,Hnc:jb}=kC(b,Bd.a.Mtc,Bd.a.Ltc));var oa={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Cg.a.r7a(oa),["validUnits"]:M,["numberFormatInfo"]:A,["validReservedValues"]:ba};jb?oa.reservedValue=ba[0]:oa.value=
isNaN(Ja)?"":Ja;h.beforeSpacingSpinButtonProps=oa;({Byc:Ja,Lfb:oa,Hnc:jb}=kC(b,Bd.a.Ktc,Bd.a.Jtc));M={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Cg.a.r7a(oa),["validUnits"]:M,["numberFormatInfo"]:A,["validReservedValues"]:ba};jb?M.reservedValue=ba[0]:M.value=isNaN(Ja)?"":Ja;h.afterSpacingSpinButtonProps=M;if(ba=M=b.hasProperty(Bd.a.xa))ba=
Jw.rbb.tQb(b),ba=b.hasProperty(Bd.a.xa)&&b.hasProperty(Bd.a.sbb)&&2===b.getValue(Bd.a.sbb)?!Lg.a.UBa(ba,1)&&!Lg.a.UBa(ba,1.5)&&!Lg.a.UBa(ba,2):!1;if(M){var Ja=Jw.rbb.tQb(b);M=0;var jb=!1;b.hasProperty(Bd.a.xa)&&b.hasProperty(Bd.a.sbb)||(jb=!0);jb||(2!==b.getValue(Bd.a.sbb)&&(jb=!0),M=Ja,1>M&&(jb=!0));jb?M="":(Ja="multiple",ba||(Lg.a.UBa(M,1)?Ja="1.00":Lg.a.UBa(M,1.5)?Ja="1.50":Lg.a.UBa(M,2)&&(Ja="2.00")),M=Ja)}else M=null;Ja={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:nv([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};M?Ja.selectedKey=M:Ja.defaultSelectedKey="";h.lineSpacingComboBoxProps=Ja;M=0;Ja=!1;b.hasProperty(Bd.a.xa)&&b.hasProperty(Bd.a.sbb)&&
2===b.getValue(Bd.a.sbb)&&ba&&(M=Jw.rbb.tQb(b),Ja=!0,1>M&&(M=Number.NaN));b=[qp("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,["numberFormatInfo"]:A,["validReservedValues"]:r};Ja?b.value=M:b.reservedValue=r[0];h.atSpinButtonProps=b;return h}$kc(){return this.FSa||(this.FSa=this.bgc())}bgc(){const b=
{};b[Bd.a.xa.id.toString()]=Ol.BBn;b[Bd.a.Ktc.id.toString()]=Ol.Hrj;b[Bd.a.Jtc.id.toString()]=Ol.Hrj;b[Bd.a.Mtc.id.toString()]=Ol.Irj;b[Bd.a.Ltc.id.toString()]=Ol.Irj;return b}static get rbb(){return null!=Jw.T0g?Jw.T0g:Jw.T0g=$a.a.instance.resolve(385)}}Object(u.a)(Jw,"ReactParagraphDialog",null,[]);const bE=b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,mC=(b,h,r,A)=>{let M=df.a.Fba;b.hasProperty(h)&&b.hasProperty(r)&&!A?(h=b.getValue(h),b=b.getValue(r),h?2===b?M=2:h=Cg.a.zPa(h,
M):df.a.ILa&&(M=2)):(h=Number.NaN,df.a.ILa&&(M=2));return{Byc:h,Lfb:M}},cE=b=>{let h="0";b.hasProperty(Bd.a.T8)&&(b=b.getValue(Bd.a.T8),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},dE=(b,h)=>{if(h.hasProperty(Bd.a.T8)&&2===h.getValue(Bd.a.T8)&&h.hasProperty(Bd.a.a0a)&&h.hasProperty(Bd.a.$_a)&&b.hasProperty(Bd.a.bNa)&&b.hasProperty(Bd.a.aNa)){var r=b.getValue(Bd.a.bNa),A=b.getValue(Bd.a.aNa);r=(new Iq.a(A,r)).Uu;A=h.getValue(Bd.a.a0a);h=h.getValue(Bd.a.$_a);h=(new Iq.a(h,A)).Uu;
b.setValue(Bd.a.bNa,r+h);b.setValue(Bd.a.aNa,1)}},MA=b=>{const h=b.getValue(Bd.a.bNa);b=b.getValue(Bd.a.aNa);return(new Iq.a(b,h)).Uu},eE=b=>{const h=b.getValue(Bd.a.xwb);b=b.getValue(Bd.a.wwb);return(new Iq.a(b,h)).Uu},fE=(b,h)=>h.hasProperty(Bd.a.bNa)&&h.hasProperty(Bd.a.aNa)&&h.hasProperty(Bd.a.xwb)&&h.hasProperty(Bd.a.wwb)&&b.hasProperty(Rc.a.marginLeft)&&b.hasProperty(Rc.a.marginRight)&&b.hasProperty(Rc.a.Bp),oG=b=>b.hasProperty(Bd.a.Jgd)?b.getValue(Bd.a.Jgd):!1,yy=b=>b.hasProperty(le.a.keepWithNext)?
b.getValue(le.a.keepWithNext):!1,Fo=b=>b.hasProperty(le.a.widowControl)?b.getValue(le.a.widowControl):!1,Uq=b=>b.hasProperty(le.a.keepTogether)?b.getValue(le.a.keepTogether):!1;class LF extends ug.a{constructor(b,h,r,A){super(!1,!1,!0);this.kLh=null;this.hao=()=>{$a.a.instance.resolve(1067).NYd(this.uGa,this.Fya,this.j$)};this.jao=(jb,zb)=>{if(zb&&(1===jb||2===jb)){if(zb.alignmentComboBoxProps){var Eb=parseInt(zb.alignmentComboBoxProps.selectedKey);isNaN(Eb)||bE(Eb)&&this.Cq.setValue(Bd.a.Ix,Eb)}var Sb=
zb.bySpinButtonProps;Eb=!!Sb&&""!==Sb.value;var nc=zb.didChangeSpecialIndentationComboBoxValue;if(zb.specialIndentationComboBoxProps){var Dc=parseInt(zb.specialIndentationComboBoxProps.selectedKey);1!==Dc&&2!==Dc&&Dc||!(Dc||nc||Eb)||this.Cq.setValue(Bd.a.T8,Dc)}if(Sb){Dc=Sb.value;Sb=Cg.a.AUa(Sb.unitType.toLowerCase());let Zc;0<=Dc||(Dc=0);2===Sb?Zc=2:(Zc=1,Dc=Cg.a.ePa(Dc,Sb));if(Eb||nc)this.Cq.setValue(Bd.a.a0a,Dc),this.Cq.setValue(Bd.a.$_a,Zc)}zb.beforeTextSpinButtonProps&&(nc=zb.beforeTextSpinButtonProps,
Eb=Cg.a.AUa(nc.unitType.toLowerCase()),nc=""===nc.value?Number.NaN:nc.value,isNaN(nc)||(Dc=nc,2===Eb?Sb=2:(Sb=1,Dc=Cg.a.ePa(nc,Eb)),this.Cq.setValue(Bd.a.bNa,Dc),this.Cq.setValue(Bd.a.aNa,Sb)));zb.afterTextSpinButtonProps&&(nc=zb.afterTextSpinButtonProps,Eb=Cg.a.AUa(nc.unitType.toLowerCase()),nc=""===nc.value?Number.NaN:nc.value,isNaN(nc)||(Dc=nc,2===Eb?Sb=2:(Sb=1,Dc=Cg.a.ePa(nc,Eb)),this.Cq.setValue(Bd.a.xwb,Dc),this.Cq.setValue(Bd.a.wwb,Sb)));zb.beforeSpacingSpinButtonProps&&(Eb=zb.beforeSpacingSpinButtonProps,
nc=Cg.a.AUa(Eb.unitType.toLowerCase()),Dc=Eb.reservedValue,""!==Eb.value&&(Dc===Box4Intl.Box4Strings.L_SpinnerAuto?(nc=1,Eb=0):(nc=4===nc?2:4,Eb=Eb.value),this.Cq.setValue(Bd.a.Mtc,Eb),this.Cq.setValue(Bd.a.Ltc,nc)));zb.afterSpacingSpinButtonProps&&(Eb=zb.afterSpacingSpinButtonProps,nc=Cg.a.AUa(Eb.unitType.toLowerCase()),Dc=Eb.reservedValue,""!==Eb.value&&(Dc===Box4Intl.Box4Strings.L_SpinnerAuto?(nc=1,Eb=0):(nc=4===nc?2:4,Eb=Eb.value),this.Cq.setValue(Bd.a.Ktc,Eb),this.Cq.setValue(Bd.a.Jtc,nc)));
if(zb.atSpinButtonProps||zb.lineSpacingComboBoxProps)if(Eb=zb.atSpinButtonProps.value,1<Eb)this.Cq.setValue(Bd.a.xa,Eb),this.Cq.setValue(Bd.a.sbb,2);else if(Eb=zb.lineSpacingComboBoxProps.selectedKey)Eb="1.00"===Eb?1:"1.50"===Eb?1.5:"2.00"===Eb?2:0,Eb=1<=Eb?Eb:1,this.Cq.setValue(Bd.a.xa,Eb),this.Cq.setValue(Bd.a.sbb,2);zb.contextualSpacingCheckboxProps&&this.Cq.setValue(Bd.a.Jgd,zb.contextualSpacingCheckboxProps.checked);zb.keepWithNextCheckboxProps&&this.Cq.setValue(le.a.keepWithNext,zb.keepWithNextCheckboxProps.checked);
zb.widowOrphanCheckboxProps&&this.Cq.setValue(le.a.widowControl,zb.widowOrphanCheckboxProps.checked);zb.keepTogetherCheckboxProps&&this.Cq.setValue(le.a.keepTogether,zb.keepTogetherCheckboxProps.checked);dE(this.uGa,this.uGa);dE(this.Cq,this.uGa);zb="";Eb=this.Fya;nc=this.Cq;if(Dc=fE(Eb,nc))Dc=nc.hasProperty(Bd.a.a0a)&&nc.hasProperty(Bd.a.$_a);Dc?(Dc=nc.getValue(Bd.a.a0a),Sb=nc.getValue(Bd.a.$_a),Dc=(new Iq.a(Sb,Dc)).Uu,Eb=MA(nc)+eE(nc)+Eb.getValue(Rc.a.marginRight)+Eb.getValue(Rc.a.marginLeft)+Dc+
df.a.fFa<=Eb.getValue(Rc.a.Bp)):Eb=fE(Eb,nc)?MA(nc)+eE(nc)+Eb.getValue(Rc.a.marginRight)+Eb.getValue(Rc.a.marginLeft)+df.a.fFa<=Eb.getValue(Rc.a.Bp):!0;Eb?AD(this.uGa,this.Cq,this.fTm(this.D8e?this.D8e.bgc():{})):zb=""!==zb?zb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==zb?this.aOa(zb,this.hao):2===jb&&($b.c(Hc.a.fyc,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Pb(Hc.a.fyc,2,null))}};this.uGa=b.clone();this.Cq=b.clone();this.Fya=h.clone();this.j$=
r;this.ga=A;this.D8e=new Jw;b=this.D8e.AFm(this.Cq);h=qp("Inch",3,-11,22,.1);r=qp("Inch",3,0,22,.1);var M=qp("Centimeter",1,-27.94,55.88,1);A=qp("Centimeter",1,0,55.88,1);var ba=qp("Character",2,-316.8,316.8,.5),oa=qp("Character",2,0,316.8,.5);h=[h,M,ba];A=[r,A,oa];r=rk();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};M=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,
Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ba=["1","2","3","6","7"];let Ja=5;oa=this.Cq.hasProperty(Bd.a.Ix)?this.Cq.getValue(Bd.a.Ix):0;if(10===oa||9===oa)oa=11;if(y.AFrameworkApplication.lcid===Ag.a.Hg("AR-SA").LCID||11===oa)b.isKashidaSupported=!0,M[Ja]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,ba[Ja]="11",Ja=6;if(y.AFrameworkApplication.lcid===Ag.a.Hg("TH-TH").LCID||13===
oa)b.isThaiSupported=!0,M[Ja]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ba[Ja]="13";M={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:nv(M,ba),["allowFreeForm"]:!1};bE(oa)?M.selectedKey=oa.toString():M.defaultSelectedKey="";b.alignmentComboBoxProps=M;b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};oa={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:yy(this.Cq)};b.keepWithNextCheckboxProps=oa;oa={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:Fo(this.Cq)};b.widowOrphanCheckboxProps=oa;oa={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:Uq(this.Cq)};b.keepTogetherCheckboxProps=oa;b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};M=cE(this.Cq);oa="0"===M;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,
["showLabel"]:!0,["options"]:nv([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:M,["allowFreeForm"]:!1};ba=df.a.Fba;M=0;({Byc:M,Lfb:ba}=mC(this.Cq,Bd.a.a0a,Bd.a.$_a,oa));A={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,
["unitType"]:Cg.a.r7a(ba),["validUnits"]:A,["numberFormatInfo"]:r};A=this.w0b(M,A);b.bySpinButtonProps=A;oa=df.a.Fba;A=0;({Byc:A,Lfb:oa}=mC(this.Cq,Bd.a.bNa,Bd.a.aNa,!1));oa={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Cg.a.r7a(oa),["validUnits"]:h,["numberFormatInfo"]:r};oa=this.w0b(A,oa);b.beforeTextSpinButtonProps=oa;oa=df.a.Fba;A=0;({Byc:A,
Lfb:oa}=mC(this.Cq,Bd.a.xwb,Bd.a.wwb,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Cg.a.r7a(oa),["validUnits"]:h,["numberFormatInfo"]:r};h=this.w0b(A,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};r={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,
["checked"]:oG(this.Cq)};b.contextualSpacingCheckboxProps=r;h.dialogButtonsOption=9;b=nG.a.isSharedUxGateEnabled("SharedOnline.ChangeGate.DialogButtonSpacingFix");h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions,["positionInFooter"]:b?"left":void 0};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:b?void 0:"left",["margin-left"]:"0"}}};this.gi(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.jao,
h)}fTm(b){return this.kLh||(this.kLh=this.Juf(b))}Juf(b){b[Bd.a.Ix.id.toString()]=Ol.Yxn;b[Bd.a.aNa.id.toString()]=Ol.Arj;b[Bd.a.bNa.id.toString()]=Ol.Arj;b[Bd.a.wwb.id.toString()]=Ol.Crj;b[Bd.a.xwb.id.toString()]=Ol.Crj;b[Bd.a.T8.id.toString()]=Ol.OEg;b[Bd.a.$_a.id.toString()]=Ol.OEg;b[Bd.a.a0a.id.toString()]=Ol.OEg;b[Bd.a.Jgd.id.toString()]=Ol.JBl;b[le.a.keepWithNext.id.toString()]=Ol.kyn;b[le.a.widowControl.id.toString()]=Ol.GIp;b[le.a.keepTogether.id.toString()]=Ol.iyn;return b}w0b(b,h){h.value=
isNaN(b)?"":b;return h}}Object(u.a)(LF,"WordReactParagraphDialog",ug.a,[]);class BD{WEl(b){new Ew(b,$a.a.instance.resolve(23))}gJl(b,h){new tx(b,h,$a.a.instance.resolve(387),$a.a.instance.resolve(8),Object(fn.a)())}i_l(b,h,r){new Rv(b,h,r)}V$h(b,h,r){new Er(b,h,r,$a.a.instance.resolve(1064),$a.a.instance.resolve(48).Cha)}wai(b,h,r){new $p(b,h,r,$a.a.instance.resolve(1064),$a.a.instance.resolve(48).Cha)}F9h(b,h,r){new cq(b,h,r,$a.a.instance.resolve(1063))}oEl(b){return new Is(b)}NYd(b,h,r){new LF(b,
h,r,y.AFrameworkApplication.va)}ZRl(){const b=$a.a.instance.Oa(217);null==b?Tc.b(524834398,3018,10,"Roaming service not resolved."):new jI(b)}dSl(b,h){new JF(b,h)}Mwf(b){return new Ot(b)}}Object(u.a)(BD,"DialogFactory",null,[375,376]);class hv extends ug.a{constructor(b,h){super(!1,!1,!0);this.ohi="DoNotCheckSpellingCheckbox";this.DVh="AutoDetectLanguageCheckbox";this.Ahi="DocumentChoiceGroup";this.izd=0;this.z5i="LanguageList";this.documentContext="DocumentContext";this.Xr="RangeContext";this.GXo=
(r,A)=>{const M=Wg.a.instance.wq(ub.a.XOj);if(1!==r)M.properties.W("canceled","true");else{r=A[this.z5i].replace(hv.URg,"");var ba=parseInt(r),oa=Boolean.parse(A[this.ohi]),Ja;hv.Huc&&(Ja=Boolean.parse(A[this.DVh]));A=A[this.Ahi];A===this.documentContext?this.JFd.rVo(ba,oa):this.JFd.N_o(ba,oa);M.properties.W("PreviousLCID",this.izd.toString());M.properties.W("ChangedLCID",ba.toString());M.properties.W("NoProof",oa.toString());hv.Huc&&M.properties.W("AutoDetect",Ja.toString());this.zrh.FXo(ba,this.izd);
$b.d(ub.a.XOj,!0,void 0,void 0,void 0,void 0,[Object.assign(new fa.a,{name:"SelectedLcid",string:r}),Object.assign(new fa.a,{name:"NoProof",string:oa.toString()}),Object.assign(new fa.a,{name:"Context",string:A}),hv.Huc?Object.assign(new fa.a,{name:"AutoDetect",string:Ja.toString()}):null].filter(Boolean));qa.StaticActiveAppFrame.za().Fe(!0)}M.end()};this.zrh=h;this.JFd=b}GDg(){const b=Array(2);b[0]={["key"]:this.Xr,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,
["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps={["id"]:this.Ahi,["defaultSelectedKey"]:this.yqm(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.izd=({alo:this.ptk}=this.JFd.$Km()).returnValue;h.languageListPropsProvider=this.Fym();h.spellingCheckboxProps={["id"]:this.ohi,["checked"]:!this.ptk,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};
hv.Huc&&(h.autoDetectLanguageCheckboxProps={["id"]:this.DVh,["checked"]:!1,["label"]:WordEditorIntl.WordEditorStrings.l_AutoDetectLanguage});this.gi(Box4Intl.Box4Strings.l_Language,this.GXo,{["id"]:"LanguageDialog",["bodyControls"]:h})}yqm(){return this.JFd.qf()?this.documentContext:this.Xr}Fym(){return()=>{let b,h;const r=({selectedIndex:b,Eyc:h}=this.zrh.Eym(this.izd)).returnValue;for(let A=0;A<r.length&&A<h;A++)r[A].value=hv.URg+r[A].value;return{["id"]:this.z5i,["items"]:r,["selectedLanguageIndex"]:b,
["applyBorderIndex"]:h}}}static get Huc(){if(null!=hv.o3g)var b=hv.o3g;else{var h;y.AFrameworkApplication.nd("ProofingLanguageAutoDetectTF;ProofingLanguageAutoDetectCF");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AugloopProofingLanguageAutoDetect",!1);b=hv.o3g=b}return b}}hv.URg="recent-";Object(u.a)(hv,"ReactLanguageDialog",ug.a,[374]);class AA extends bo{constructor(b,h,r,A){super(h,r);this.plg=()=>{this.yR.An()};this.ii=b;this.UK=
A}Tnb(b,h,r){if(b=super.Tnb(b,h,r))b.Cuc=!0,b.Pqe=!0,b.preventDismissOnScroll=!0;this.ii.d6a(this.plg);return b}H7c(b,h,r=null){this.UK.gWh(()=>this.Tnb(b,h,r))}Fme(){this.yR.Cuc=!0}}Object(u.a)(AA,"ExternalContentFloatieInitializer",bo,[]);class pi{UXb(){Tl.instance.iga&&(Sq.instance.Vfb([1,0]),Tl.instance.Jge()&&yp.instance.Vfb([1]))}}Object(u.a)(pi,"RulerUser",null,[367]);class Gh{constructor(){this.whitelistedControlIds=null}}Object(u.a)(Gh,"StatusBarProps",null,[]);class Ws{constructor(b,h,r=
!0){this.sa=new Fd.a;this.EYj=()=>4;this.wKd=!1;this.K5e=null;this.Hja=h.lJ;this.Y9e=h.BYj;r?xl.a.get_instance().$k(7,()=>{this.bYh(b,h)}):this.bYh(b,h)}bYh(b,h){const r={};r.StatusBarBuildStartTime=Date.now();window.setTimeout(()=>{r.FirstTimeoutCallbackExecutionStartTime=Date.now();vp.a.instance.ee(()=>{hm.UISurfaces.dNm().then(A=>{r.StatusBarApiResolutionTime=Date.now();const M=Object.assign(new Gh,{whitelistedControlIds:h.whitelistedControlIds});A.initializeNewStatusBar(b,M,this.Y9e);this.K5e=
A;this.wKd=!0;r.ReactStatusBarInitializedTime=Date.now();window.setTimeout(()=>{r.SecondTimeoutCallbackExecutionStartTime=Date.now();vp.a.instance.ee(()=>{const ba=[];if(h.iJ){const oa=h.iJ;for(const Ja in oa)ba.push(appChrome.actions.updateControlHiddenState(Ja,oa[Ja]));appChrome.api.dispatch(ba)}r.PollingStartTime=Date.now();this.UXb();r.PollingEndTime=Date.now();v.ULS.sendTraceTag(509748573,813,50,JSON.stringify(r))},"RSB:I2")},0);y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&
this.gpo();return null}).catch(()=>{v.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.Lva&&b){Ws.Jkh||(y.AFrameworkApplication.va.qa(La.a.DYj,xe.a.frame,this.EYj),y.AFrameworkApplication.va.qa(La.a.CYj,xe.a.frame,this.EYj),Ws.Jkh=!0);const A=vr.a.Hbe(h.Lva,h.nOj,b,!1);A.YL=!0;this.XYb(A,La.a.DYj,La.a.CYj)}},0)}UXb(){this.wKd&&this.Hja&&window.setTimeout(()=>{this.Hja(this.K5e.selectors.getStatusBarControlsMap(this.Y9e),7)},0)}myb(b,h){this.wKd&&
window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}sS(b){this.wKd&&this.Hja&&window.setTimeout(()=>{const h=this.K5e.selectors.getStatusBarControlsMap(this.Y9e);if(h[b]){const r={};r[b]=h[b];this.Hja(r,7)}},0)}XYb(b,h,r){const A=kc.KeyInputManager.lc(rf.a.wz,0),M=kc.KeyInputManager.lc(rf.a.wz,4);b.qt(A);b.qt(M);b.bindAction(A,h);b.bindAction(M,r)}gpo(){this.sa&&(this.sa.raiseEvent("RSBIE"),this.sa.dispose(),this.sa=null)}}Ws.Jkh=!1;Object(u.a)(Ws,"ReactStatusBar",
null,[]);class Cp{constructor(){this.whitelistedControlIds=this.iJ=this.lJ=null;this.Iwn=!1;this.nOj=this.Lva=this.BYj=null}}Object(u.a)(Cp,"ReactStatusBarInitOptions",null,[]);var To=d(472);class Kv{constructor(b,h,r,A,M){this.D$b=this.GSa=this.Ga=null;this.Nfp=()=>{const ba=qa.StaticActiveAppFrame.za().xq.getRegion(Ii.a.Lva);ba&&ba.W9f()};this.iZm=(ba,oa,Ja,jb,zb)=>{if(!zb)return v.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Ja)return 32;
zb&&2===zb.length&&this.GSa&&this.GSa.myb(zb[0],zb[0]);return 32};this.vtd=ba=>{qa.StaticActiveAppFrame.za().lJ(ba)};this.ga=A;vp.a.instance.ee(()=>{this.Ga=M;this.D$b=this.GSa=null;const ba={};y.AFrameworkApplication.CVj||(ba[To.a.ULo]=!0);ba.GiveFeedback=!y.AFrameworkApplication.iG;this.Ga.$("OfficeOnlineInGallatinTextVisible")||(ba.CenterStatusLabel=!0);ba[To.a.Vqj]=!0;this.Ga.$("WPMPackageIsEnabled")&&this.Ga.$("WPMStatusBarLabelIsEnabled")||(ba[To.a.FPg]=!0);this.Ga.$("AddInCommandsIsEnabled")||
(ba[To.a.WXk]=!0);this.Ga.$("WordEditorShowOcsConnectionStatus")||(ba[To.a.vdg]=!0);ba[To.a.uJp]=!0;this.Ga.$("ReadingTimeIsEnabled")||(ba[To.a.nzj]=!0);window.setTimeout(()=>{this.s$m(b,ba)},0)},"SBU:I")}Wb(){this.ga.fb(ub.a.$Ae,mc.a.application,this.iZm,96)}s$m(b,h){this.D$b=$a.a.instance.Oa(1068);const r={};for(const M in h){var A=h[M];r[this.kNf(M)]=A}this.GSa=new Ws(b,Object.assign(new Cp,{iJ:r,lJ:this.vtd,Iwn:!1,BYj:"WordEditorStatusBar",Lva:Ii.a.Lva,nOj:this.Nfp}))}kNf(b){let h="";if(this.D$b){const r=
this.D$b.JJf(b);r&&0<r.count&&(h=r.K(0))}return h&&""!==h?h:b}UXb(){this.GSa&&this.GSa.UXb()}myb(b,h){this.GSa&&this.GSa.myb(this.kNf(b),h)}sS(b){this.GSa&&this.GSa.sS(this.kNf(b))}dispose(){}}Object(u.a)(Kv,"StatusBarUser",null,[366,11]);var gu=d(1572);class hu{constructor(b){this.uld=(h,r,A,M,ba)=>{this.ga.Ob(this.jtm(ba[gu.a.gpe]),2);return 32};this.ga=b;this.ga.qa(La.a.uld,xe.a.frame,this.uld);this.ga.qa(La.a.OFj,xe.a.frame,kd.ActionManager.$f)}}Object(u.a)(hu,"FileMenuSQMInformation",null,[1850]);
class rt extends hu{constructor(b){super(b);this.Tvo()}Tvo(){this.ga.qa(La.a.jug,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.IFj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.kug,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.JFj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.KFj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.lug,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.LFj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.MFj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.NFj,xe.a.frame,
kd.ActionManager.$f);this.ga.qa(La.a.nGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(Hc.a.HFj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.oGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.RFj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.SFj,xe.a.frame,kd.ActionManager.$f)}jtm(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return La.a.jug;case "tabHome":case "FileHomePage":return y.AFrameworkApplication.nd("1ba3i132;45gid285"),La.a.IFj;case "menuJewelInfo":case "FileInfoPage":return La.a.kug;
case "menuJewelNew":case "FileNewPage":return La.a.JFj;case "menuJewelOpen":case "FileOpenPage":return La.a.KFj;case "menuJewelPrint":case "FilePrintPage":return La.a.lug;case "menuJewelSaveAs":case "FileSaveAsPage":return La.a.LFj;case "menuJewelDownload":case "FileDownloadPage":return Hc.a.HFj;case "menuJewelShare":case "FileSharePage":return La.a.MFj;case "menuJewelTransform":case "FileTransformPage":return La.a.NFj}return La.a.OFj}}Object(u.a)(rt,"WordEditorFileMenuSQMInformation",hu,[]);var Fr=
d(1566);class Xs{constructor(b){this.ga=b;this.ga.qa(La.a.vld,xe.a.frame,Object(F.a)(this,this.vld,"reportTabSwitch"));this.ga.qa(La.a.iGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.kGj,xe.a.frame,kd.ActionManager.$f)}vld(b,h,r,A,M){this.ga.Ob(this.VJm(M[Fr.a.bHg]),2);return 32}}Object(u.a)(Xs,"RibbonSQMInformation",null,[1799]);class nI extends Xs{constructor(b){super(b);this.nyo()}nyo(){this.ga.qa(La.a.$Fj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.bGj,xe.a.frame,kd.ActionManager.$f);
this.ga.qa(Hc.a.nug,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.cGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.dGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(Hc.a.eGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(Hc.a.fGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(Hc.a.gGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(Hc.a.hGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(Hc.a.oug,xe.a.frame,kd.ActionManager.$f);this.ga.qa(Hc.a.jGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(La.a.lGj,xe.a.frame,kd.ActionManager.$f);
this.ga.qa(Hc.a.mGj,xe.a.frame,kd.ActionManager.$f);this.ga.qa(Hc.a.aGj,xe.a.frame,kd.ActionManager.$f)}VJm(b){switch(b){case "tabAddins":case "Addins":return La.a.$Fj;case "tabHome":case "Home":return La.a.cGj;case "tabInsert":case "Insert":return La.a.dGj;case "tabDeveloper":case "Developer":return La.a.bGj;case "tabPageLayout":case "Layout":return Hc.a.eGj;case "tabReferences":case "References":return Hc.a.hGj;case "tabReview":case "Review":return Hc.a.oug;case "tabView":case "View":return La.a.lGj;
case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return Hc.a.jGj;case "tabMailings":case "Mailings":return Hc.a.fGj;case "tabWordDesign":case "Design":return Hc.a.mGj;case "tabHelp":case "Help":return Hc.a.nug;case "ctabPictureTools":case "Picture":return Hc.a.gGj;case "Copilot":return Hc.a.aGj}return La.a.kGj}}Object(u.a)(nI,"WordEditorRibbonSQMInformation",Xs,[]);class Pp{constructor(b=null,h=null,r=null){this.iJ=b||{};this.N3j=h||[];this.R3j=
r||{}}}Object(u.a)(Pp,"RibbonTrimmingProperties",null,[]);class ux{constructor(b,h,r){this.cAa=b;this.iJ=h;this.z2f=r}}Object(u.a)(ux,"ReactRibbonJewelProperties",null,[]);class CD{constructor(){this.Zpo=(b,h,r,A,M)=>{if(1===r)return 32;y.AFrameworkApplication.tga("54hi9858;4f638686");if(!M)return 32;b=M.SourceControlId;17!==M.UILocation||"New"!==b&&"Open"!==b||(M=[],zg.d("setFileMenuSelectedPage")&&("New"===b&&y.AFrameworkApplication.ta?2===y.AFrameworkApplication.ta.Hb.Uk?M.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):
M.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&y.AFrameworkApplication.ta&&(2===y.AFrameworkApplication.ta.Hb.Uk?M.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):M.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),M.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(M));return 32};y.AFrameworkApplication.va.qa(La.a.aYa,xe.a.frame,this.Zpo)}x6i(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}SZa(){return!1}Ttj(){}Wgi(){}}
Object(u.a)(CD,"ReactFileMenu",null,[445]);class VB{ntf(){const b=new CD,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(u.a)(VB,"ReactFileMenuFactory",null,[409]);class BA{constructor(b,h,r,A=!1){this.Tzc=b;this.Yoh=this.Tzc.sab;this.Nle=$a.a.instance.Oa(120);this.CVb=$a.a.instance.Oa(1069);BA.hMe=!1;this.Wqn=A;this.ga=h;this.Zb=r}get Qb(){return this.ga}get focusManager(){return this.Zb}pjf(){return this.Yoh&&
!!this.Nle&&!!this.CVb}d1a(b,h){this.Tzc.xp(()=>{v.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.Yoh=!0;this.cCf(b,h)});$a.a.instance.Ra(120).execute(r=>{v.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.Nle=r;this.cCf(b,h)});$a.a.instance.Ra(1069).execute(r=>{v.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.CVb=r;this.cCf(b,h)})}cCf(b,h){BA.hMe||(this.pjf()?(v.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),
b(this,h),BA.hMe=!0):v.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}BA.hMe=!1;Object(u.a)(BA,"RibbonDependencies",null,[82]);class vx{constructor(b,h,r){this.cEb=b;this.ga=h;this.Zb=r}}Object(u.a)(vx,"WoncaRibbonUserFactory",null,[238]);class MF{constructor(b,h){this.zNe=b;this.icc=h}Jyb(b){this.zNe.Jyb(b);this.icc&&this.icc.Jyb(b)}Und(b){this.zNe.Und(b);this.icc&&this.icc.Und(b)}ytd(b){this.zNe.ytd(b);this.icc&&this.icc.ytd(b)}}Object(u.a)(MF,"RibbonCommandTrimmer",
null,[239]);var iv=d(1200),DD=d(1112);class Du{constructor(b,h){this.Ga=b;this.V$b=h}Jyb(b){X.a.Di&&6>X.a.A$a&&(b.fseaInsertPicture=!0);this.Ga.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Ga.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Ga.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);wL.a.$_i()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Ga.$("InsertOnlinePictureEnabled"),r=y.AFrameworkApplication.TZf();h||(b.fseaInsertOnlinePicture=!0,b.fseaFlyInsertOnlinePictureFromSearch=
!0);r||(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);if(r||y.AFrameworkApplication.jge)b.fseaInsertPictureFromOneDrive=!0;r&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;y.AFrameworkApplication.UZf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);y.AFrameworkApplication.FAc&&(b.btnOpenInClient=!0);y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&y.AFrameworkApplication.J.$("DisablePrint")&&
this.GAc(b)}Und(b){b.menuJewel=!0;y.AFrameworkApplication.iG||(b.jbtnGiveFeedback=!0)}GAc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}ytd(b){delete b.menuJewel;y.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);y.AFrameworkApplication.rld||(b.jbtnReportAbuse=!0);y.AFrameworkApplication.CCe||(b.jbtnTermsOfUse=!0);y.AFrameworkApplication.V2d||(b.jbtnFileSharing=
!0);y.AFrameworkApplication.vxb||(b.jbtnShareRWC=!0);y.AFrameworkApplication.rDf||y.AFrameworkApplication.zNg||(b.jbtnVersion=!0);this.V$b.Nle&&this.V$b.Nle.$Vn||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.V$b.CVb&&this.V$b.CVb.L5o||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);y.AFrameworkApplication.FAc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[df.a.yt?"btnjOpenInClient":"btnjEditInClient"]=!0;y.AFrameworkApplication.Nqp&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=
!0,b.jbtnDownloadAsOdt=!0);y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&y.AFrameworkApplication.J.$("DisablePrint")?this.GAc(b):y.AFrameworkApplication.J.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;y.AFrameworkApplication.BH&&(this.GAc(b),b.faShare=!0);if(y.AFrameworkApplication.I0||X.a.LXa||!y.AFrameworkApplication.E6c&&!y.AFrameworkApplication.iDf&&!y.AFrameworkApplication.xNg)b.jbtnFileEmbed=!0;iv.a.B6m()||(b.btnjClose=!0);y.AFrameworkApplication.Vtb?(b.jbtnVersion=
!0,v.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):y.AFrameworkApplication.Ige()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);y.AFrameworkApplication.mqg||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ga.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&
b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.u1i;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(y.AFrameworkApplication.vL||".ODT"===df.a.C0c.toUpperCase()||!y.AFrameworkApplication.J.$("WordEditorAppsForOfficeRibbonIsEnabled")||!DD.a.jSd||y.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=
!0}}Object(u.a)(Du,"WoncaCommandTrimmer",null,[239]);var nz=d(976);d(727);var ED=d(1571),Aq=d(1789);class FD{constructor(b,h){this.F1=this.RM=null;this._clientId=b;this.Zda=h}w3l(){if(!Mf.c(this.F1))return this.F1;this.jBf();if(Mf.c(this.F1))throw Error.create("HeaderSkeleton.EnsureTopBarDomElement _elmTopBar1 is null or undefined");this.F1.style.display="block";this.Zda&&this.Zda.o2(Object(F.a)(this,this.Vv,"onResize"));return this.F1}Vv(){this.WDa()}WDa(){this.RAf()?(document.getElementById("application").style.minWidth=
"0px",(new Aq.a(this.F1,null,y.AFrameworkApplication.isRtl)).WNo(this.F1)):y.AFrameworkApplication.ta.Hb.KN||ED.a.XNo(this.F1,y.AFrameworkApplication.isRtl)}RAf(){return y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("EnhancedMobileViewIsEnabled"):!1}jBf(){if(Mf.c(this.RM)){var b;({p6c:b}=vr.a.wsd(!y.AFrameworkApplication.W_)).returnValue?(this.RM=xD.a("div"),this.RM.className=vr.a.$5l,this.RM.id=Vo.a.j2d,b.appendChild(this.RM),this.cBf(),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.vba&&
!y.AFrameworkApplication.W_&&this.dBf(),this.v3l()):y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("ReactHeaderCrashLogs")&&v.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}v3l(){Mf.c(this.F1)&&(this.F1=xD.a("div"),this.F1.className=vr.a.yJg,this.F1.style.display="none",this.RM.appendChild(this.F1))}cBf(){Sys.UI.DomElement.addCssClass(this.RM,vr.a.a6l);y.AFrameworkApplication.isRtl&&xD.b(this.RM,"cui-rtl")}dBf(){Sys.UI.DomElement.addCssClass(this.RM,
"FlexBoxLayout")}}Object(u.a)(FD,"HeaderSkeleton",null,[]);var CA=d(615);class wx{constructor(){this.kDc=null}Usp(){this.kDc||(this.kDc=$a.a.instance.Oa(1070))||v.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}ehm(){this.Usp();return this.kDc?this.kDc.getCustomAuthConfig():null}static jjn(){return y.AFrameworkApplication.J.$("UiHostSupportsCustomAuthConfig")}}Object(u.a)(wx,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class xx{constructor(){this.mqc=this.cultureName=
null}}Object(u.a)(xx,"HeaderCultureInfo",null,[]);var lg=d(1590);class NF{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(u.a)(NF,"SearchInitializationSettings",null,[]);var Gw=d(301);class oI{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=
this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(u.a)(oI,"DocumentTitleAppProps",null,[]);class GD{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(u.a)(GD,"DocumentTitleCalloutAppProps",null,[]);class oz{constructor(){this.language=
this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;
this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(u.a)(oz,"HeaderAppProps",null,[]);class HD{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(u.a)(HD,"HeaderControls",null,[]);class OF{constructor(){this.command=
this.label=null}}Object(u.a)(OF,"WorkflowButtonAppProps",null,[]);var mi;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.y7p=2]="insufficientPermission";b[b.X6p=3]="incompatibleEditorsPresent";b[b.J0p=4]="editorsPresent";b[b.qle=5]="notSupported"})(mi||(mi={}));Object(u.b)("RenameDisableReason",mi);class PF{constructor(b=""){this.pxg=this.documentTitleAppProps=this.CPg=null;this.gQf=()=>{if(!this.CPg){const h=CA.a();if(h){const r=this.PIm(h.command);r&&(this.CPg=Object.assign(new OF,
{command:r,label:h.label}))}}return this.CPg};this.YZn=()=>{xl.a.get_instance().vK(17)};this.onMove=()=>{const h={};h.MoveButtonClickedTime=new Date;y.AFrameworkApplication.va.Pb(La.a.bWb,2,h)};this.nrm=()=>{let h=null,r=null;var A=$a.a.instance.Oa(1071);A?(A=A.QFi(),0!==A&&(h=this.oJm(A),r=mi[A])):v.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new GD,{breadcrumbBrandName:y.AFrameworkApplication.Ht.breadcrumbBrandName,breadcrumbBrandUrl:y.AFrameworkApplication.Ht.breadcrumbBrandUrl,
breadcrumbFolderName:y.AFrameworkApplication.Ht.breadcrumbFolderName,breadcrumbFolderUrl:y.AFrameworkApplication.Ht.breadcrumbFolderUrl,hideDocumentTitleInput:y.AFrameworkApplication.ta.Hb.y1m,isVersionHistoryEnabled:this.d7o(),documentExtension:C.a.ola(y.AFrameworkApplication.fileName),isMoveEnabled:32===y.AFrameworkApplication.va.Ob(La.a.bWb,1),onMove:this.onMove,message:h,renameDisableReason:r,openBreadcrumbsInNewTab:y.AFrameworkApplication.J.$("OpenLinksInNewWindow")})};this.txi=()=>{if(!this.documentTitleAppProps){const h=
y.AFrameworkApplication.Ht.HA;this.documentTitleAppProps=Object.assign(new oI,{documentTitle:y.AFrameworkApplication.e0d?h:C.a.FL(h),onFirstRender:this.YZn,getCalloutAppProps:this.nrm,isShared:!1})}return this.documentTitleAppProps};this.QBl=h=>{appChrome.getHeaderApi().then(r=>{r.setNavBarData(h.result);return null});v.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")};this.onFirstRender=()=>{$a.a.instance.Ra(1072).execute(h=>{h.C3o.continueWith(this.QBl,3)});xl.a.get_instance().vK(15)};
this.onFullyLoaded=()=>{xl.a.get_instance().vK(16)};this.xPk=""!==b?b:Ie.a.A4}PIm(b){const h=$a.a.instance.Oa(665).Mqb(b);if(h&&0<h.length)return h[0].externalUxCommand;v.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}Oom(){return Object.assign(new HD,{workflowButton:this.gQf()})}oJm(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;
case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}d7o(){return!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.s2i}H4o(){return!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.r2i}L6o(){const b=!CA.b()&&!y.AFrameworkApplication.hideHeader&&!y.AFrameworkApplication.jTf&&(y.AFrameworkApplication.J.$("SkypeWebControlIsEnabled")||y.AFrameworkApplication.J.$("TeamsChatIsEnabled"));v.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}evo(b=
!1){appChrome.getHeaderApi().then(h=>{const r=$a.a.instance.resolve(799);h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",A=>{r.onFlexPaneOpen(A)});h.setHeaderCommandHandler("OnFlexPaneClose",A=>{r.onFlexPaneClose(A)});h.setHeaderCommandHandler("SetCookie",A=>Qc.a.set(A.cookieName,A.value));h.setHeaderCommandHandler("GetCookie",A=>this.Qom(A));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",
this.gQf);b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",this.txi),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.ZZn();return null}));lg.a.Ife()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(F.a)(this,this.CGi,"getSearchInitializationSettings"))})}ZZn(){$a.a.instance.Ra(55).execute(b=>{b.HAb(!1,y.AFrameworkApplication.va.mode)})}Qom(b){b=Qc.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}ONm(){return Gw.AppChromeOverrideUtilities.isEnabled?
Gw.AppChromeOverrideUtilities.k8d("suiteux-shell",!1):this.xPk+y.AFrameworkApplication.xna+"suiteux-shell"}zla(b=!1){a:{try{var h=Ag.a.Hg(y.AFrameworkApplication.lcid);if(h){var r=Object.assign(new xx,{cultureName:h.name,mqc:h.mqc});break a}}catch(A){v.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+y.AFrameworkApplication.lcid.toString())}r=Object.assign(new xx,{cultureName:"en-us",mqc:"en"})}h=$a.a.instance.resolve(799);r=Object.assign(new oz,{appName:CommonUIStrings.l_AppNameShort,
culture:r.cultureName,language:r.mqc,isConsumer:!y.AFrameworkApplication.CNg,showAppLauncher:CA.h(),showMeControl:CA.g(),hideUserName:y.AFrameworkApplication.rae,defaultDocumentTitleToLeft:y.AFrameworkApplication.ndi,assetsContainerOverride:this.ONm(),controls:this.Oom(),documentTitleAppProps:b?null:this.txi(),showDocumentTitleControl:!b,showWorkflowButton:!!this.gQf(),showChatControl:this.L6o(),showGoPremiumControl:CA.i(),showDiscoverPremiumButton:CA.f(),enableSearchControl:lg.a.atn(),onFlexPaneOpen:Object(F.a)(h,
h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(F.a)(h,h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.H4o(),testTraffic:y.AFrameworkApplication.J.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:this.onFirstRender,onFullyLoaded:this.onFullyLoaded,enableUpdatedRUMReporting:y.AFrameworkApplication.I4o()});!y.AFrameworkApplication.g3b||y.AFrameworkApplication.pEg?(r.userDisplayName=y.AFrameworkApplication.userName,r.emailAddress=y.AFrameworkApplication.J.jb("UserPrincipalName"),
r.userID=y.AFrameworkApplication.J.jb("Puid")||"",r.signOutLink=y.AFrameworkApplication.pEg):y.AFrameworkApplication.signInUrl&&(r.signInLink=y.AFrameworkApplication.signInUrl);lg.a.Ife()&&(h=this.CGi(),r.loadTellMeResources=h.loadTellMeResources,r.getTokenRequestDictionary=h.getTokenRequestDictionary,r.enableVanillaSearchBox=y.AFrameworkApplication.J.$("VanillaSearchUxInHeaderIsEnabled"),r.userRing=h.userRing);wx.jjn()&&(h=new wx,r.shellAuthProviderConfigPromise=Object(F.a)(h,h.ehm,"getAccountSwitchingConfig"));
this.GVk();this.evo(b);y.AFrameworkApplication.nd("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");return r}GVk(){y.AFrameworkApplication.J.$("SideLoadingIsEnabled")&&xl.a.get_instance().$k(16,()=>{appChrome.getHeaderApi().then(b=>{b.setCustomHeaderButtonBadgeCharacter("overrideSettingButtonId","\u25b6");b.setCustomHeaderButtonBadgeLabel("overrideSettingButtonId","Sideloading is active so javascript is coming from an unofficial source.");b.setCustomHeaderButtonBadgeColors("overrideSettingButtonId",
{badgeColor:"green",badgeHoverColor:"green",badgeFontColor:"white",badgeFontHoverColor:"white"});return null})})}CGi(){if(!this.pxg){const b=new lg.a;let h=y.AFrameworkApplication.J.jb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.pxg=Object.assign(new NF,{loadTellMeResources:b.CDn(),getTokenRequestDictionary:Object(F.a)(b,b.YPm,"getTokenRequestDict"),userRing:h})}return this.pxg}}Object(u.a)(PF,"ReactSharedHeaderPropsHelper",null,[1935]);class ID{constructor(){this.label=this.value=
null}}Object(u.a)(ID,"TextInfoSectionField",null,[]);var Oj=d(937),wK=d(1172);class Fw{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(u.a)(Fw,"CommandDefinition",null,[]);class QF{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(u.a)(QF,"CommandDefinitionMapping",null,[]);const pI=b=>Object.assign(new QF,{getCommandByExternalUxId:h=>{const r=b.getCommandByExternalUxId(h);return r?Object.assign(new Fw,
{commandId:parseInt(r.commandId),externalUxCommand:r.externalUxCommand}):Object.assign(new Fw,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(La.a.Ug),addCommandToMaps:Object(F.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(F.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(F.a)(b,b.addTabToMap,"addTabToMap")});var FL=d(1271);class xK{}Object(u.a)(xK,"RibbonInitState",null,[]);var yK=d(423),GL=d(1234);class qI{constructor(){}flatten(b){const h=[];for(const r of b)h.push.apply(h,
r);return h}}Object(u.a)(qI,"ReactAsyncDispatcher",null,[]);var HL=d(1656);class zK{constructor(b,h){this.TOk=b;this.Lrk=h}}Object(u.a)(zK,"ReactExecuteCommandContext",null,[]);class Eu{}Eu.Trigger="FontTrigger";Eu.Name="FontName";Eu.Action="FontAction";Eu.Level="FontLevel";Eu.IsPinned="FontIsPinned";Object(u.a)(Eu,"FontPickerLogProperties",null,[]);class rI{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb=null,Eb=null){this.Q1=null;this.TEh=!1;this.yRe=[];this.dzd=-1;this.rOd=!1;this.dQk=0;this.hFc=null;this.DAh=
!1;this.Iyd=null;this.Zth=!1;this.Nyp=(Sb,nc)=>{const Dc=Sb.launcherId;this.Uxc(Dc,nc)&&(nc=appChrome.selectors.getFlyoutAnchorMenuItems(Dc),this.hBc(nc,Dc,zg.g(Sb)))};this.Pzp=(Sb,nc)=>{const Dc=Sb.launcherId;this.Uxc(Dc,nc)&&(nc=zg.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(Dc):appChrome.selectors.getFlyoutAnchorMenuItems(Dc),this.hBc(nc,Dc,zg.g(Sb)))};this.CBp=(Sb,nc)=>{const Dc=Sb.launcherId;this.Uxc(Dc,nc)&&(nc=appChrome.selectors.getPreviewGalleryMenuItems(Dc),
this.hBc(nc,Dc,zg.g(Sb)))};this.tCp=(Sb,nc)=>{const Dc=Sb.launcherId;this.Uxc(Dc,nc)&&(nc=appChrome.selectors.getSplitButtonMenuItems(Dc),this.hBc(nc,Dc,zg.g(Sb)))};this.yCp=(Sb,nc)=>{const Dc=Sb.launcherId;this.Uxc(Dc,nc)&&(nc=appChrome.selectors.getStatefulSplitButtonMenuItems(Dc),this.hBc(nc,Dc,zg.g(Sb)))};this.tja=b;this.Kkb=h;this.i7e=Object(Ma.a)(1802,b);this.tl=r;this.Zb=A;M&&(this.Q1=new HL.a(M,A));this.tMk=ba;this.kwk=oa;this.yr=zb;this.ga=Ja;this.wFb={};this.Ga=jb;this.gTg=Eb;jb&&(jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",
!1)||jb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&el.a.instance.hif.CWR(()=>this.TEh=!0);jb&&(b=this.Ga.jb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({hv:this.hFc}=G.d(b));this.hFc||(this.hFc={})}get TLj(){return!!window.appChrome&&!!appChrome.selectors}uKj(){-1!==this.dzd&&window.clearTimeout(this.dzd);this.dzd=window.setTimeout(()=>{for(this.dzd=-1;0<this.yRe.length;){if(me.a.instance.iz){this.uKj();break}const b=this.yRe.shift();b&&this.executeCommand(b.TOk,b.Lrk)}},0)}executeCommand(b,
h){if(me.a.instance.iz){if(this.TEh){this.yRe.push(new zK(b,h));this.uKj();return}v.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,h.modelType,tb.a.toJSON(h.payload));if(this.Ga.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const r=this.tl.getCommandByExternalUxId(b),A=h.modelType;this.gTg&&this.gTg.XEn(b,h);r?this.D4l(b,
r,A,h):this.E4l(b,A,h);this.Upl(h);this.Aqp(h);this.MKn(b,h)}}E4l(b,h,r){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.Yli(r,b);break;case "ButtonModel":this.y4l(r,b)}}pBp(b,h,r,A,M){if(r.payload)switch(r.payload.type){case "CoauthorMenuPayload":b.MenuItemId=r.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;b.TerminalParentControlId=r.payload.terminalParentControlId;this.Ga&&this.Ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8213680_EnableUnDismissWhenClickingMenu")?
(h=!0,Mf.c(r.payload.dismissHostingSurfaceOnExecute)||(h=r.payload.dismissHostingSurfaceOnExecute),h&&this.G6()):this.G6();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;M=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;M=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=A;return M}qBp(b,h,r){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=
this.tl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.tl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":r.CommandId=h.payload.executedControl;r.ControlId=h.payload.executedControl;r.ParentControlId=h.payload.parentControl;r.CloseAllMenus=!0;this.G6();break;case "TellMeSearchResultChangePayload":r.Value=h.payload.searchText;break;case "SmartLookupPayload":r.CommandValueId=h.payload.selectionContextJson}return b}D4l(b,
h,r,A){var M=this.Peo(A,r),ba=h.commandId;const oa={},Ja={};switch(r){case "SplitButtonModel":if(this.N5c(A.payload,this.tCp,M))return;oa.MenuItemId=h.menuItemId;this.aBg(A,oa);break;case "StatefulSplitButtonModel":if(this.N5c(A.payload,this.yCp,M))return;r=A.payload.statefulData;M=A.payload.statefulMode;"color"===M?oa.Color=r:"icon"===M&&(r=this.tl.getCommandByExternalUxId(r))&&(oa.MenuItemId=r.menuItemId);break;case "FileMenu":oa.MenuItemId=h.menuItemId;oa.SourceControlId=b;A.payload&&"FileMenuPageSwitchPayload"===
A.payload.type&&this.NWm(ba,A.payload,b);break;case "TellMe":ba=this.qBp(ba,A,oa);oa.SourceControlId=b;oa.Location=A.payload.location;break;case "ButtonModel":A.payload&&"TabSwitchPayload"===A.payload.type?this.KYm(oa,A):ba=this.pBp(oa,h,A,b,ba);break;case "CompoundButtonModel":oa.MenuItemId=h.menuItemId;oa.CommandValueId=A.payload.commandValueId;oa.SourceControlId=b;this.aBg(A,oa);this.G6();break;case "ToggleButtonModel":case "InkButtonModel":oa.MenuItemId=h.menuItemId;oa.SourceControlId=b;this.aBg(A,
oa);this.G6();break;case "FontPickerModel":switch(A.payload.type){case "MenuOpenPayload":ba=this.tl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;oa[iz.a.FontPickerId]=A.payload.launcherId;break;case "MenuClosePayload":ba=this.tl.getCommandByExternalUxId("FontPickerMenuClose").commandId;oa[iz.a.FontPickerId]=A.payload.launcherId;break;case "FontPickerFontSelectedPayload":r=A.payload.font;M=null;"string"===typeof r?(M=Jm.FontUtils.GYa(r),oa.CommandValueId=M,M=Jm.FontUtils.KYd(M)):(r.data?
(oa.CommandValueId=r.data.fontToApply,oa.MenuItemId=r.data.themeIndex,oa[iz.a.Formatting]=r.data):oa.CommandValueId=r.name,M=r);oa.SourceControlId=b;oa[iz.a.RequestUpdateMru]=M;Ja[Eu.Name]=A.payload.nameToLog?A.payload.nameToLog:"string"===typeof r?Jm.FontUtils.pde(r)?"*"+r:Jm.FontUtils.SYf(r)?"[EF]":"[MF]":"";Ja[Eu.IsPinned]=A.payload.isPinned;Ja[Eu.Level]=A.payload.level;this.y6f();break;case "FontPickerFontInfoRequestedPayload":oa.CommandValueId=A.payload.font.name;oa[iz.a.Trigger]=A.payload.trigger;
Ja[Eu.Trigger]=A.payload.trigger;Ja[Eu.Name]=A.payload.nameToLog;this.y6f();break;case "FontPickerFontPinningPayload":r=A.payload.isPinned;oa.CommandValueId=A.payload.fontKey;oa[iz.a.IsPinned]=r;Ja[Eu.Name]=A.payload.nameToLog;Ja[Eu.Action]=r?"pin":"unpin";Ja[Eu.Level]=A.payload.level;this.y6f();break;default:return}break;case "ComboBoxModel":var jb=A.payload.type;switch(jb){case "MenuOpenPayload":case "MenuPopulatePayload":this.Uxc(A.payload.launcherId,M)&&(ba={},ba[A.payload.launcherId]=r,this.Kkb.whd(ba,
zg.g(A.payload)),this.wFb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":r=A.payload.newValue;if(!r)return;r.value?(oa[ka.a.Value]=r.value,oa[ka.a.IsFreeForm]=!0):(oa[ka.a.Value]=r.text,oa.MenuItemId=r.key,oa.CommandValueId=r.commandValueId);"ComboBoxPreviewPayload"===jb&&(ba=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ba=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(A.payload.type){case "ZeroTermContextMenuClosePayload":r=
tb.a.LR(A.payload);for(jb of r)oa[jb]=A.payload[jb];break;default:this.N5c(A.payload,this.Nyp,M),oa.launcherId=A.payload.launcherId}break;case "InkFlyoutAnchorModel":this.N5c(A.payload,this.Pzp,M);oa.launcherId=A.payload.launcherId;break;case "ColorPickerModel":switch(A.payload.type){case "ColorPickerPayload":oa[fo.Color]=A.payload.selectedColorId;oa.colorRGB=A.payload.color;break;case "ColorPickerPreviewPayload":ba=h.commandPreviewId;oa[fo.Color]=A.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ba=
h.commandRevertId;break;default:return}break;case "SpinButtonModel":oa[ki.a.Number]=A.payload.value;oa[ki.a.UnitType]=Cg.a.AUa(A.payload.unitType.toLowerCase());oa[ki.a.Text]=A.payload.reservedValue;break;case "SliderModel":oa[Hj.Value]=A.payload.value;break;case "InsertTableModel":oa[Cf.a.Rows]=A.payload.rows;oa[Cf.a.Columns]=A.payload.columns;break;case "CheckboxModel":oa[Ng.a.On]=A.payload.checked;oa.MenuItemId=h.menuItemId;oa.TerminalParentControlId=A.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.N5c(A.payload,
this.CBp,M)){oa.launcherId=A.payload.launcherId;break}this.Yli(A,b);return;case "DocumentTitleModel":switch(A.payload.type){case "DocumentTitleRenamePayload":oa.getNewDocumentTitle=A.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ba={};ba[A.payload.launcherId]=r;this.Kkb.whd(ba,zg.g(A.payload));this.wFb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":oa.MenuItemId=A.payload.url;this.NFn(A.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":oa.MenuItemId=
A.payload.assetId;oa.SourceControlId=b;y.AFrameworkApplication.J.$("BackstagePremiumTemplateExperienceEnabled")&&(oa.IsPremium=A.payload.isPremium||!1);this.OFn(A.payload.pageId);break;case "CoauthorGallery":oa.RenderTime=A.triggerTime;break;case "PeopleWell":oa.RenderTime=A.triggerTime;break;case "SyncStatus":oa.SourceControlId=b;break;case "InputBoxModel":oa.Text=A.payload.newValue;break;case "PersonaButtonModel":oa.CommandValueId=A.payload.commandValueId;this.SXm(A.payload);break;case "MultiActionButtonModel":oa.CommandValueId=
A.payload.commandValueId;oa.Href=A.payload.href;oa.SourceControlId=b;oa.Type=A.payload.type;oa.TerminalParentControlId=A.payload.terminalParentControlId;this.G6();break;default:return}ba&&!this.isShadowMenuOpen(A.payload)&&(A.payload&&"terminalParentControlId"in A.payload&&(oa.ParentMenuId=A.payload.terminalParentControlId),oa.CommandValueId||(oa.CommandValueId=oa.MenuItemId),h.legacyControlId&&(oa.LegacyId=h.legacyControlId),oa.SourceControlId||(oa.SqmControlId=b),this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&oa.launcherId&&(h=this.tl.getCommandByExternalUxId(oa.launcherId))&&(oa.launcherCommandId=parseInt(h.commandId)),A.payload&&!Mf.c(A.payload.PRIReadinessCheck)&&(oa.PRIReadinessCheck=A.payload.PRIReadinessCheck,this.DAh=!0),A.payload&&!Mf.c(A.payload.shouldTakeFocus)&&(oa[gk.a.P_a]=A.payload.shouldTakeFocus),h=this.Wef(A,oa),A.payload&&!Mf.c(A.payload.interactiveUid)&&(Ja.interactive_uid=A.payload.interactiveUid),Mf.c(A.triggerTime)||(Ja.TriggerTime=A.triggerTime),A.payload&&!Mf.c(A.payload.userActionKey)&&
(Ja.userActionKey=A.payload.userActionKey),this.pzg(Ja,A,b,ba),this.i7e.executeCommand(ba,oa,this.getSelectedTabId(),h,!0,()=>{this.T9f(oa,b)},Ja,zg.g(A.payload)))}pzg(b,h,r,A){if(this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&r&&A&&h.payload){const M=!Mf.c(h.payload.launcherId);r=this.CJj(this.kDm(M?h.payload.launcherId:r,A),A,!1);b.ControlId=r;const ba=h.payload.inputMethod,oa=h.payload.location;Mf.c(ba)||Mf.c(oa)||this.eFn(1===ba,
2===ba||3===ba||4===ba,M&&("Overflow"===oa||"ToolBarOverflow"===oa)||"TabSwitchPayload"===h.payload.type,r,oa)}this.Ga&&this.Ga.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.CJj(h.payload.terminalParentControlId,A,!0))}eFn(b,h,r,A,M){this.Iyd||(this.Iyd={});const ba=[];M=Rg.a.Uaa("UILocation",M,2);Array.add(ba,M);if(M=this.getSelectedTabId())M=Rg.a.Uaa("Tab",M,2),Array.add(ba,M);this.Iyd[A]||r||(this.Iyd[A]=
1,h?this.hcd("DistinctUserInitiatedTerminalCommand",ba):b&&this.hcd("DistinctUserInitiatedKeyboardCommand",ba));h?r?this.hcd("UserInitiatedNavigationalCommand",ba):this.hcd("UserInitiatedTerminalCommand",ba):b&&this.hcd("UserInitiatedKeyboardCommand",ba)}hcd(b,h){$b.b(b,null,0,!0,0,h)}CJj(b,h,r){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;v.ULS.sendTraceTag(510247689,207,15,r?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");
return"MalformedId"}kDm(b,h){h=parseInt(h);h=kd.ActionManager.lqf(h)||kd.ActionManager.qea(h)||"";return!Mf.c(h)&&h in this.hFc?this.hFc[h]:100<b.length?"":b}y6f(){this.yr&&this.yr.execute(b=>{b.i6f("ModernFontPickerExperience")})}Wef(b,h){let r=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(r=b.payload.inputMethod,h[gk.a.fz]=r);return r}T9f(b,h){const r=Object(Ma.a)(pd.AFrame,y.AFrameworkApplication.ta);if(this.Zb&&this.sTj(b)){if(!this.Zb.currentScope&&r){let A="null";if(b){const M=
b.Value;delete b.Value;A=tb.a.toJSON(b);Mf.c(M)||(b.Value=M)}v.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",h,A,r.Odb)}this.Zb.KEf()}(this.Zb&&this.Zb.currentScope&&this.Zb.currentScope.name!==pd.AFrame.Uua&&r&&this.Zb.currentScope.name!==r.Odb||this.sTj(b))&&this.Gvl(b)}sTj(b){return!!b&&!Mf.c(b[gk.a.P_a])&&b[gk.a.P_a]}Gvl(b){gk.a.fz in b&&1===b[gk.a.fz]&&Oj.ShyRibbon.vnb(1,
0)}KYm(b,h){zg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.G6();this.tja.An();if(this.tMk&&this.ga){const r={};r[Fr.a.bHg]=h.payload.tabId;this.ga.Pb(La.a.vld,2,r,this.QR(h));Mf.c(h.payload.inputMethod)||(this.ga.Ob(La.a.iGj,2),this.rOd||this.nap(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.tl.IOf(h);v.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.yr&&h){const r=h+"TabSwitchActivity";
this.yr.execute(A=>{A.i6f(r)})}}N5c(b,h,r){const A=b.type;return"MenuClosePayload"===A?!0:"MenuOpenPayload"===A?(h(b,r),!0):!1}SXm(b){b=b.type;"MenuOpenPayload"===b?y.AFrameworkApplication.Vqd=!0:"MenuClosePayload"===b&&(y.AFrameworkApplication.Vqd=!1)}Peo(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const r=b.payload.launcherId,A=this.tl.getCommandByExternalUxId(r);return A&&A.populationProps?((b=this.Kkb.ylg(A,h,b.payload))&&
r in this.wFb&&delete this.wFb[r],b):!1}getSelectedTabId(){return this.TLj?appChrome.selectors.getSelectedTabId():null}hBc(b,h,r){this.Kkb.whd(b,r);this.wFb[h]=new Date}Uxc(b,h){let r=!0;b in this.wFb&&(r=this.wFb[b].getTime()<this.tja.Qta.getTime());return r&&!h&&this.TLj}Yli(b,h){const r={};var A=b.payload.selectedGalleryId;const M=this.tl.getCommandByExternalUxId(A);if(M){r.SourceControlId=A;r.MenuItemId=M.menuItemId;r.SqmControlId=h;M.legacyControlId&&(r.LegacyId=M.legacyControlId);b.payload&&
!Mf.c(b.payload.shouldTakeFocus)&&(r[gk.a.P_a]=b.payload.shouldTakeFocus);this.eGm(b.payload,r);(A=this.QR(b))||(A={});this.pzg(A,b,h,M.commandId);const ba=this.Wef(b,r);this.i7e.executeCommand(M.commandId,r,this.getSelectedTabId(),ba,!0,()=>{this.T9f(r,h)},A,zg.g(b.payload))}}y4l(b,h){const r=this.tl.getCommandByExternalUxId(h);if(r){const A={};A.SourceControlId=h;A.MenuItemId=h;A.SqmControlId=h;b.payload&&!Mf.c(b.payload.shouldTakeFocus)&&(A[gk.a.P_a]=b.payload.shouldTakeFocus);let M=this.QR(b);
M||(M={});this.pzg(M,b,h,r.commandId);const ba=this.Wef(b,A);this.i7e.executeCommand(r.commandId,A,this.getSelectedTabId(),ba,!1,()=>{this.T9f(A,h)},M,zg.g(b.payload))}}eGm(b,h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}aBg(b,h){b.payload&&"toggled"in b.payload&&(h[Ng.a.On]=b.payload.toggled)}MKn(b,h){if("MenuOpen"===b){if(this.Q1&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.Q1.onMenuOpen()}else if("MenuClose"===b&&this.Q1)this.Q1.onMenuClose()}G6(){this.Q1&&
this.Q1.Ceg()}QR(b){let h=null;Mf.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}NWm(b,h,r){if(this.kwk&&this.ga){const A={};A[gu.a.gpe]=r;this.ga.Pb(La.a.uld,2,A)}this.hBc(h.pageControlIdMap,b,zg.g(h))}OFn(b){if(this.ga)switch(b){case "FileHomePage":this.ga.Ob(La.a.nGj,2);break;case "FileNewPage":this.ga.Ob(La.a.oGj,2)}}NFn(b){if(this.ga)switch(b){case "FileHomePage":this.ga.Ob(La.a.RFj,2);break;case "FileOpenPage":this.ga.Ob(La.a.SFj,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===
b.type&&b.isShadowRendering}nap(b){if(y.AFrameworkApplication.J.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.yr.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.rOd=!0;else{if(y.AFrameworkApplication.J.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.yr.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.dQk)){this.rOd=!0;return}y.AFrameworkApplication.J.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.Ob(La.a.a1b,2)&&(this.rOd=
!0)}}Upl(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.DAh&&appChrome.PRIToastManager.dismissToast()}Aqp(b){!this.Zth&&this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(b=zg.g(b.payload),31===b||14===b||15===b||2===b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=$a.a.instance.Ra(2);h&&h.execute(r=>{r.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.Zth=!0)}}Object(u.a)(rI,
"ReactExecuteCommandHandler",null,[]);class RF{constructor(){this.S2d=null}get IAb(){return 0}get Hbb(){return 0}get tMa(){return!1}WDa(){}U1j(){}L2(){return!1}pOj(){}T6(){return!1}rPa(b){return this.S2d&&this.S2d.SZa(b)?!0:!1}get Tna(){return!1}myb(){}Bde(){return!1}get LXd(){return null}set LXd(b){}bka(){}gfa(){}PPf(){return null}iVa(){}refresh(){}get controls(){return null}rvc(){return!1}Rnb(){}An(){}get EH(){return null}set EH(b){}btd(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(u.a)(RF,"ReactRibbonExternal",null,[640,606,641]);class ry{constructor(b,h,r,A){this.I_n=(M,ba)=>{if((M=Object(Ma.a)(pd.AFrame,y.AFrameworkApplication.ta))&&ba.ihj&&y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.kCa){const oa=appChrome.selectors.getShyState();oa.isActive&&ba.ihj.name===M.Odb&&Oj.ShyRibbon.vnb(oa.state,1)}};this.qIj=()=>4;this.pIj=()=>4;this.lIj=()=>{zg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.kCa&&
appChrome.selectors.getShyState().isActive&&Oj.ShyRibbon.vnb(1,0),this.Zb.Eg(pd.AFrame.Jo));return 4};this.z4n=M=>{M.Nb&&M.Nb.target&&"input"!==M.Nb.target.tagName.toLowerCase()&&M.Nb.preventDefault();return!1};this.Zb=b;this.ga=h;this.DKh=r;this.W$b=A}initialize(){this.ga.qa(La.a.gmd,xe.a.frame,this.qIj);this.ga.qa(La.a.fmd,xe.a.frame,this.pIj);this.ga.qa(La.a.yve,xe.a.frame,this.lIj);var b=vr.a.Hbe(this.W$b,null,this.DKh,!1);b.YL=!0;this.XYb(b,La.a.gmd,La.a.fmd);b.bindAction(kc.KeyInputManager.lc(rf.a.cgb,
0),La.a.yve);b=this.Zb.ie(pd.AFrame.Uua);b.YL=!0;this.XYb(b,La.a.f8a,La.a.f8a);ee.a.instance.nb(zd.a.lz,this.DKh,this.z4n);b=kp.a.instance;zg.a("enterKeytipMode")&&b.$Yo(this.W$b,()=>{appChrome.api.enterKeytipMode(!1)});zg.a("exitKeytipMode")&&b.WYo(this.W$b,()=>{appChrome.api.exitKeytipMode();Oj.ShyRibbon.vnb(1,0)});y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.kCa&&(b=Object(Ma.a)(rd.FocusManager,this.Zb))&&b.Y1k(this.I_n)}M$m(b){b=vr.a.Hbe(b,null,document.getElementById("WACToolbarContainer"),
!1);b.YL=!0;this.XYb(b,La.a.gmd,La.a.fmd)}XYb(b,h,r){const A=kc.KeyInputManager.lc(rf.a.wz,0),M=kc.KeyInputManager.lc(rf.a.wz,4);b.qt(A);b.qt(M);b.bindAction(A,h);b.bindAction(M,r)}dispose(){this.ga.Ey(La.a.gmd,xe.a.frame,this.qIj);this.ga.Ey(La.a.fmd,xe.a.frame,this.pIj);this.ga.Ey(La.a.yve,xe.a.frame,this.lIj)}}Object(u.a)(ry,"ReactRibbonFocusManager",null,[11]);class iu{constructor(b,h,r,A,M,ba,oa,Ja=null,jb=!0,zb=null,Eb=null){this.zib=this.nPd=this.uNe=this.tja=null;this.uEh=[];this.X$b=null;
this.Wno=()=>{y.AFrameworkApplication.J.xp(()=>{this.FWl()})};this.VHn=()=>{if(y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.Cs){var Sb=$a.a.instance.Ra(2);"SingleLine"===appChrome.selectors.getRibbonMode()?(Sb.execute(Dc=>{Dc.logActivity("SingleRibbonModeActivity",null)}),y.AFrameworkApplication.nd("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(Sb.execute(Dc=>{Dc.logActivity("MultiRibbonModeActivity",null)}),y.AFrameworkApplication.nd("69a7h198;dfd7j584"));
if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ScreenSizeActivity")){var nc=xd.a.zrb();Sb=xd.a.tX();nc=1550<nc?"Large":1050<nc?"Medium":"Small";Sb=850<Sb?"Large":675<Sb?"Medium":"Small";$b.a("ScreenBucket_W_"+nc+"_H_"+Sb);y.AFrameworkApplication.J&&y.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ScreenSizeAction")&&$b.c(this.JKm(nc,Sb))}}};this.IDg=()=>{const Sb=$a.a.instance.Ra(2);Sb&&Sb.execute(nc=>
{nc.logActivity("SingleLineToolBarOptOut",null)});return 32};this.AEn=()=>{this.ga.qa(La.a.jKg,xe.a.frame,Object(F.a)(this,this.jKg,"triggerModeSwitcherTUI"));this.ga.fb(La.a.IDg,xe.a.frame,this.IDg,96);const Sb=Qc.a.tfa(y.AFrameworkApplication.J.jb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const nc=$a.a.instance.Ra(2);nc&&(y.AFrameworkApplication.J.$("Fluent2StyleIsEnabled")?(nc.execute(Dc=>{Dc.logActivity("VNextStylesOn",null)}),nc.execute(Dc=>{Dc.logActivity("Fluent2StyleEnabledFPS",
"Fluent2StyleFloodgateSurveyIsEnabled")})):y.AFrameworkApplication.J.$("Fluent2StyleFGOnlyIsEnabled")&&Sb&&nc.execute(Dc=>{Dc.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)};this.Cyo=()=>{xl.a.get_instance().$k(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const Sb=appChrome.api.getRibbonSubComponentMappings();for(const Dc in Sb){var nc=Dc;const Zc=Sb[Dc];if(Zc)for(const Gd of Zc)y.AFrameworkApplication.va.V2(Gd)?appChrome.api.reportRibbonSubComponentBehaviorMapped(nc):
y.AFrameworkApplication.va.TYo(Gd,this.vJl(nc));else appChrome.api.reportRibbonSubComponentBehaviorMapped(nc)}};this.LSa=b;this.U0e=h;this.W$b=r;this.Zb=A;this.ga=M;this.tl=ba;this.tja=zb?zb:new Br(uu.instance,this.tl);this.vKc=oa;this.PCh=new RF;this.MSa=Ja;this.O8e=jb;new qI;this.Ohh=Eb;xl.a.get_instance().$k(7,Object(F.a)(this,this.t_o,"setRibbonPostInteractiveReady"));xl.a.get_instance().$k(7,this.VHn);xl.a.get_instance().$k(19,this.AEn);xl.a.get_instance().$k(7,this.Cyo);xl.a.get_instance().$k(7,
this.Wno)}initialize(b,h,r=null){this.O8e||this.vK(5);r?r.then(()=>{this.ZEj()}).catch(()=>v.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):yK.a.zrd(yK.a.zrd(di.Task.WAA(this.Y7i(b),this.X7i(iu.bsk)),()=>this.X7i(iu.rok)),()=>this.Y7i(h)).continueWith(()=>{this.ZEj()},11)}dispose(){this.aup();this.zib&&this.zib.Wgi();this.X$b&&this.X$b.dispose();for(const b of this.uEh)xl.a.get_instance().tsl(b);y.AFrameworkApplication.va.Ey(La.a.SGo,xe.a.frame,kd.ActionManager.$f)}X7i(b){return $a.a.instance.resolve(643).Wqc(y.AFrameworkApplication.rC(b,
2))}Y7i(b){return""===b?di.Task.j7(!0):$a.a.instance.resolve(643).Wqc(y.AFrameworkApplication.rC(b,3))}v$m(){(this.MSa||this.vKc)&&appChrome.api.dispatch(this.MJi());this.t1o();zg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(y.AFrameworkApplication.W8);this.tja.An()}ZEj(){this.v$m();this.O8e&&(appChrome.renderAppChrome(this.LSa,zg.e()),this.vK(10));this.PMh();this.qmf();this.O8e&&this.vK(5);this.QRi()}QRi(){this.Zb&&this.ga&&this.W$b&&(this.X$b=new ry(this.Zb,this.ga,this.LSa,this.W$b),
this.X$b.initialize())}get emd(){return this.PCh}setCommandDefinitionMapping(){if(zg.a("setCommandDefinitionMapping")){const b=pI(this.tl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.kCa&&zg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.ouc()})}PMh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(Ma.a)(Br,this.tja);
this.uNe=new rI(this.tja,b.lvc,this.tl,this.Zb,this.U0e,$a.a.instance.Oa(1073),$a.a.instance.Oa(1074),y.AFrameworkApplication.va,y.AFrameworkApplication.J,$a.a.instance.Ra(2),null);this.Udl();this.LVm()}Udl(){this.nPd=appChrome.api.bindCommandHandler((b,h)=>{this.uNe.executeCommand(b,h)})}aup(){this.nPd&&(this.nPd(),this.nPd=null)}t1o(){appChrome.api.initializeLogger(new Do.a)}JKa(){return this.tja?this.tja.JKa():[]}ouc(){vp.a.instance.ee(()=>{let b=null;vp.a.instance.ee(()=>{b=this.JKa()},"RB:GA");
b&&0<b.length&&(this.tja.Qta=new Date,vp.a.instance.ee(()=>{appChrome.api.dispatch(b)},"RB:DA"));this.zib&&vp.a.instance.ee(()=>{this.zib.Ttj()},"RB:J")},"RB:PFSU")}mtd(){this.tja.mtd()}IWb(){}VUk(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}MJi(){var b=y.AFrameworkApplication.J;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&
$a.a.instance.Ra(4).execute(r=>{r.isFeatureEnabled("ConnectedServices",!0).then(A=>{A&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.iyi());b=new FL.a(this.tl);this.MSa.iJ&&(GL.a.Qqp(this.MSa.iJ),h.push.apply(h,b.L4d(this.MSa.iJ)));if(this.MSa.N3j)for(const r of this.MSa.N3j)h.push(appChrome.actions.updateGallerySectionHiddenState(r.D4d,r.Mmq,r.krq));
h.push.apply(h,b.Nsi(this.MSa.R3j));return h}iyi(){const b=[];if(this.vKc&&this.vKc.iJ){const r=this.vKc.iJ;for(const A in r){var h=r[A];const M=this.tl.JJf(A);if(M)for(const ba of M)b.push(appChrome.actions.updateControlHiddenState(ba,h))}}return b}nPa(b){b&&this.tja.lvc.whd(b,0)}ylg(b){this.tja.lvc.ylg(this.tl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}FWl(){const b=y.AFrameworkApplication.J.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=y.AFrameworkApplication.J.appSettings;
h&&appChrome.api.dispatch(this.oCp(b,"Shared"===(h.SharingStatus||"")))}oCp(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}vK(b){xl.a.get_instance().vK(b);this.uEh.push(b)}t_o(){zg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new xK,{postRibbonInteractiveReady:!0})))}qmf(){this.vKc&&this.Ohh&&(this.zib=this.Ohh.ntf(),this.PCh.S2d=this.zib)}eAn(b,h){this.zib&&this.zib.x6i(b,h)}dwg(b,h,r){if(1===r)return 32;
this.VPj(!0);this.ouc();y.AFrameworkApplication.ta.Fe();return 32}ewg(b,h,r){if(1===r)return 32;this.VPj(!1);this.F_o();this.ouc();y.AFrameworkApplication.ta.Fe();return 32}jKg(b,h,r){if(1===r)return 32;(b=$a.a.instance.Ra(2))&&b.execute(A=>{A.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}F_o(){Qc.a.hOa(y.AFrameworkApplication.J.jb("IsSimplifiedRibbonOnCookieName"),"true",Qc.a.mMa)}VPj(b){Qc.a.hOa(y.AFrameworkApplication.J.jb("ReactRibbonMLRPreferenceCookieName"),b.toString(),Qc.a.mMa)}JKm(b,
h){return"Large"===b?"Large"===h?La.a.BOo:"Medium"===h?La.a.COo:La.a.DOo:"Medium"===b?"Large"===h?La.a.EOo:"Medium"===h?La.a.FOo:La.a.GOo:"Large"===h?La.a.HOo:"Medium"===h?La.a.IOo:La.a.JOo}vJl(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}LVm(){if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&zg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&
y.AFrameworkApplication.Ztc.aef){const b=y.AFrameworkApplication.Ztc.aef,h=y.AFrameworkApplication.Ztc.pMh;h.payload||(h.payload={});const r=h.payload.launcherId?h.payload.launcherId:b;iu.sIj.mb(r)?iu.sIj.K(r)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.uNe.executeCommand(b,h))}}}iu.bsk="common";iu.rok="appChrome";iu.sIj=new wK.a(Wa.a.j5c());Object(u.a)(iu,"ReactRibbonUser",null,[331,267,11]);class DA extends iu{constructor(b,
h,r,A,M,ba,oa,Ja,jb=null,zb=!0,Eb=null,Sb=null){super(b,h,A,M,ba,oa,Ja,jb,zb,Eb,Sb);this.gCd=null;this.cEb=r;this.cEb.execute(nc=>{this.gCd=nc});this.cEb.execute(nc=>{this.tja.EH=nc})}JKa(){return this.gCd?(this.gCd.clearCache(),super.JKa()):[]}IWb(b){if(!b)throw Error.argumentNull();this.cEb.execute(h=>{b.EH=h})}}Object(u.a)(DA,"ReactRibbonUser",iu,[]);var AK=d(980);class JD extends DA{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb=!0,Eb=null,Sb=null){super(h,b.Eaa,A,Ii.a.kva,M.focusManager,M.Qb,oa,Ja,jb,
zb,Eb,Sb);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.WUe=b;this.Zda=ba;M.d1a(()=>{this.WBp();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?xl.a.get_instance().$k(7,()=>{this.GRi()}):this.GRi()},null)}get aXi(){return!!y.AFrameworkApplication.J.appSettings.BootActivityNavigationId}GRi(){this.xHl();this.ntf();this.gvo()}WBp(){this.LSa.classList.add("FlexBoxLayout");this.WUe.zsa().classList.add("cui-exth");
this.WUe.zsa().classList.add("FlexBoxLayout");this.WUe.zsa().classList.add("ScrollableRibbon")}xHl(){y.AFrameworkApplication.W_||this.MLl()}MLl(){if(!y.AFrameworkApplication.W_){var b=(new FD(JD.rMk,this.Zda)).w3l(),h=vr.a.Hbe(Ii.a.BWa,null,b,!0);h.YL=!0;this.XYb(h,La.a.gmd,La.a.fmd);h.bindAction(kc.KeyInputManager.lc(rf.a.cgb,0),La.a.yve);Aw.a(1,()=>{this.dFo(b)})}}dFo(b){const h=new PF;appChrome.renderSharedHeader(b,h.zla()).then(this.cyf.bind(this))}NCj(){y.AFrameworkApplication.ta.Hb.q2i?appChrome.getHeaderApi().then(b=>
{document.getElementById(y.AFrameworkApplication.Jpb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new AK.a).cyf()}cyf(){this.aXi&&y.AFrameworkApplication.J.$("ImprovedDeepLinkLoadIsEnabled")?(xl.a.get_instance().$k(12,this.NCj.bind(this),11),v.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.NCj()}XYb(b,h,r){const A=kc.KeyInputManager.lc(rf.a.wz,0),M=kc.KeyInputManager.lc(rf.a.wz,4);b.qt(A);b.qt(M);b.bindAction(A,
h);b.bindAction(M,r)}ntf(){const b=!!this.MSa&&"FileMenu"in this.MSa.R3j;y.AFrameworkApplication.ta.Hb.FXa&&!b&&Aw.a(1,this.wEo.bind(this))}wEo(){const b=[];if(y.AFrameworkApplication.J.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new ID,{label:CommonUIStrings.L_DiagnosticsSessionId,value:y.AFrameworkApplication.userSessionId}),Object.assign(new ID,{label:CommonUIStrings.L_DiagnosticsBuild,value:y.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",
h))}b.push.apply(b,this.iyi());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}gvo(){this.ga.qa(La.a.m0a,mc.a.view,this.m0a.bind(this));this.ga.qa(La.a.dwg,mc.a.view,this.dwg.bind(this));this.ga.qa(La.a.ewg,mc.a.view,this.ewg.bind(this))}activateRibbonTab(b){this.VUk(b)}ouc(){xl.a.get_instance().isCompleted(7)&&this.gCd&&(db.a.mark(4893),dB.a.BBp(),super.ouc(),db.a.mark(4894))}m0a(b,h,r,A,M){if(2===M[gk.a.fz]){if(r=Object(Ma.a)(Yt.a,h))A=Object(Ma.a)(lH.a,
r.view);else return v.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,tb.a.join(M," ",":")),8;if(A&&""!==A.CL)Bl.a.dma(h)&&Bl.a.loc()||(this.Zb.Eg(A.CL),appChrome.selectors.getShyState().isActive&&Oj.ShyRibbon.vnb(0,1));else return v.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(r.view),
b,tb.a.join(M," ",":"),this.dym(r.view)),8}return 32}dym(b){return b?"is ContentEditableView: "+b.uk+" is Editing View: "+b.TBa+" is HtmlView: "+b.xab+" is InteractiveView: "+b.ue+" is NavigationPaneView: "+b.qpn+" is PageView: "+b.jj+" is WordNavigationPaneHeadingsView "+b.r2f:"null view"}}JD.rMk="WACRibbon";Object(u.a)(JD,"ReactRibbonUser",DA,[330,331,267,11]);class BK extends JD{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc=null,Zc,Gd){super(b,h,r,A,M,ba,oa,Ja,jb,!1,zb,Dc);this.l6k=()=>{this.yr&&
this.yr.execute(de=>{de.logActivity("WordShyRibbon",null)});return 32};this.S2o=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&"true"!==Qc.a.get(y.AFrameworkApplication.J.jb("ReactRibbonMLRPreferenceCookieName"))&&xl.a.get_instance().$k(20,()=>{this.yr.execute(de=>{de.logActivity("FloodgateFirstStart",null)})})};this.H9m=()=>{mg.a.instance.tf(Ph.a.X$m,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(de=>
{var he;this.MSa&&de.push.apply(de,this.MJi());(this.hFh||this.iFh)&&this.mlb&&de.push.apply(de,this.Llm());de.push(appChrome.actions.setControlCustomTooltip(mp.a.OAn,CommonUIStrings.l_LoopsLearnMoreTooltip));de.push(appChrome.actions.setControlCustomTooltip(mp.a.Erl,"Plan and manage tasks with to-do lists you can share and work on with others."));de.push(appChrome.actions.setControlCustomTooltip(mp.a.qkp,"Assign tasks, set due dates, and track in a table you can easily edit."));de.push(appChrome.actions.setControlCustomTooltip(mp.a.oeo,
"Make surveys to get quick feedback, schedule, and plan."));var fe=null===(he=y.AFrameworkApplication.J)||void 0===he?void 0:he.jb("ReactShyRibbonPreferenceCookieName");he=Qc.a.get(fe);this.R2o(he);this.S2o();de.push.apply(de,this.JKa());de.push(appChrome.actions.setControlBehaviorAttached(!0));const Yd=$a.a.instance.resolve(1075);he=Yd.Gxm();y.AFrameworkApplication.nd("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",
!1)&&(fe=appChrome.selectors.getModeSwitcherMode())&&fe!==he.activeMode&&v.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${he.activeMode}, Actual: ${fe}`);"Suggest"===he.activeMode||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===he.activeMode?appChrome.getUpdateAppModeAndTabsActions(he,!0).then(Td=>{appChrome.api.dispatch(de.concat(Td));Yd.vdj();this.WRi()}):(de.push(appChrome.actions.updateModeSwitcher(he)),
appChrome.api.dispatch(de),Yd.vdj(),this.WRi())})};this.mlb=Eb;this.hFh=Sb;this.iFh=nc;this.yr=$a.a.instance.Ra(2);this.Gb=Zc;this.jTe=Gd}W$m(){v.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");xl.a.get_instance().vK(5);const b=this.aXi&&y.AFrameworkApplication.J.$("ImprovedDeepLinkLoadIsEnabled")?12:10;xl.a.get_instance().$k(b,this.H9m,11);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.sZk()}sZk(){this.Gb.Yb(new wc.a(5,
1,0,()=>{this.jTe.execute(b=>{b.yZo()})}))}Llm(){const b=[];this.hFh&&(b.push(appChrome.actions.setButtonSecondaryText(mp.a.DZd,this.mlb.zTf)),b.push(appChrome.actions.setButtonSecondaryText(mp.a.$Xd,this.mlb.yTf)),b.push(appChrome.actions.setButtonSecondaryText(mp.a.Zgd,this.mlb.ATf)));this.iFh&&b.push(appChrome.actions.setButtonSecondaryText(mp.a.Xgd,this.mlb.a3m));return b}R2o(b){"true"===b?this.yr.execute(h=>{h.logActivity("OptInShyRibbonNormalScreenActivity",null)}):"false"!==b&&""!==b||!(1300>
window.innerWidth||700>window.innerHeight)||this.yr.execute(h=>{h.logActivity("NonOptInShyRibbonSmallScreenActivity",null)});document.addEventListener("ShyRibbonSmallScreenActivity",()=>{requestAnimationFrame(()=>setTimeout(()=>{var h;null===(h=document.getElementById("RibbonModeToggle"))||void 0===h?void 0:h.click()},0))},!1);y.AFrameworkApplication.va.fb(La.a.zRh,xe.a.frame,this.l6k,96)}WRi(){y.AFrameworkApplication.Ztc.$tp();this.PMh();this.qmf();this.QRi();xl.a.get_instance().vK(7);mg.a.instance.R$(Ph.a.sTc,
Ph.a.cwg,(new Date).getTime());y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&this.X$b&&this.X$b.M$m(cu.a.nWj)}nPa(b){if(b){const h=this.jzi();try{super.nPa(b)}finally{null===h||void 0===h?void 0:h.dispose()}}}JKa(){const b=this.jzi();try{return super.JKa()}finally{null===b||void 0===b?void 0:b.dispose()}}jzi(){var b;let h=void 0;const r=null===(b=df.a.ff)||void 0===b?void 0:b.Pl;r&&(h=new Qb.GraphTransaction(df.a.NXi()&&df.a.KZf?0:
2),h.set(r));return h}}Object(u.a)(BK,"ReactRibbonUser",JD,[]);class sI extends vx{constructor(b,h,r,A,M,ba,oa,Ja){super(b,h,r);this.VXe=y.AFrameworkApplication.J.$("PasteWithOptionsFromRibbon")&&X.a.L7;this.tl=M;this.I5e=ba;this.Gb=oa;this.jTe=Ja}PKl(b,h){const r=new BA(y.AFrameworkApplication.J,this.ga,this.Zb,this.VXe),A=new nz.a(r);return this.pLl(b,h,A,r)}pLl(b,h,r,A){var M=new MF(new Du(y.AFrameworkApplication.J,A),r);r=this.r$m(M);const ba={};M.Jyb(ba);M=!X.a.L7;const oa=X.a.Ur||X.a.yj;var Ja=
X.a.om;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(Ja=X.a.Di||Ja);Ja=new iI.a(Ja);b=new BK(b,h,WordEditorIntl.WordEditorStrings,this.cEb,A,b,this.tl,r,new Pp(ba),this.I5e,Ja,M,oa,new VB,this.Gb,this.jTe);b.W$m();return b}r$m(b){const h={};b.Und(h);b.ytd(h);return new ux(null,h,"jewelWordEditor")}}Object(u.a)(sI,"WordEditorRibbonUserFactory",vx,[]);class pz{constructor(b,h){this.DB=b;this.KHd=h}oVa(b,h,r,A=null,M=null){return this.KHd.bTj(b)?this.KHd.oVa(b,h,r,A,M):this.DB.oVa(b,
h,r,A,M)}SLa(b,h=null){return this.KHd.bTj(b)?this.KHd.SLa(b):this.DB.SLa(b,h)}}Object(u.a)(pz,"RootCuiUser",null,[365]);class CK extends pz{constructor(b,h){super(b,h)}clearCache(){this.DB.clearCache()}}Object(u.a)(CK,"WordGeneralCuiUser",pz,[364,365]);var Bq=d(1357);class jv{static getSelectedText(){const b=(new Zr.a).UNf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static F8d(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=C.a.bB(b,h)?h-1:h),b=b.length>h?b.substr(0,
h).trim()+"...":b);return b}}Object(u.a)(jv,"SearchUtils",null,[]);class qs extends TB{constructor(b,h,r){super(b,r);this.IK=h}KGf(b){const h=[];var r=$f.a.instance.gb.currentSelection;const A=!!this.IK&&this.IK.P$c(ub.a.iof.toString()),M=!!this.IK&&this.IK.P$c(ub.a.OYb.toString()),ba=!A&&!r.kXa&&qs.ceb.Odj(),oa=!(y.AFrameworkApplication.jv&&qs.xZi)&&(!!this.IK&&this.IK.P$c(La.a.xMa.toString())||!!gA.a.instance&&(3===gA.a.instance.mode||2===gA.a.instance.mode)),Ja=r.c2i()&&y.AFrameworkApplication.ta.Hb.I$c;
var jb=!1;if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1)){jb=!!r&&(r.Lw||2===r.length&&Le.a.rl(r.Wc));var zb=jv.getSelectedText();jb=jb&&0<zb.length&&60>zb.length}b=(zb=3===b||X.a.Di||y.AFrameworkApplication.sFf)&&qs.Lzf.i3(r,b);r=qs.xZi&&r&&1===r.length&&r.K(0).contextId===mc.a.Vc;zb&&h.push(this.tl.Fsa("ClipboardGroup")[0].externalUxGroupId);ba&&(h.push(this.tl.Fsa("TextFormattingGroup")[0].externalUxGroupId),
h.push(this.tl.Fsa("StylesGroup")[0].externalUxGroupId));jb&&h.push(this.tl.Fsa("DefineGroup")[0].externalUxGroupId);A&&h.push(this.tl.Fsa("PictureToolsGroup")[0].externalUxGroupId);M&&h.push(this.tl.Fsa("TableToolsGroup")[0].externalUxGroupId);Ja&&h.push(this.tl.Fsa("EquationToolsGroup")[0].externalUxGroupId);oa&&h.push(this.tl.Fsa("CommentGroup")[0].externalUxGroupId);r&&h.push(this.tl.Fsa("ContentAssemblyGroup")[0].externalUxGroupId);b&&h.push(this.tl.Fsa("ContextMenuGroup")[0].externalUxGroupId);
Bq.a.wWi&&qs.Ijn&&h.push(this.tl.Fsa("DesignerGroup")[0].externalUxGroupId);qs.dpn&&h.push(this.tl.Fsa("MiniTemplateGroup")[0].externalUxGroupId);return h}static get Lzf(){return null!=qs.yVg?qs.yVg:qs.yVg=$a.a.instance.resolve(1058)}static get ceb(){return null!=qs.S3g?qs.S3g:qs.S3g=$a.a.instance.resolve(123)}static H7c(b,h,r,A){b.Qdl(()=>qs.Tnb(h,r,A))}static Tnb(b,h,r){return new qs(b,h,r)}static get Ijn(){null===this.QWe&&(y.AFrameworkApplication.nd("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),
this.QWe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",!1):!1);return this.QWe}static get xZi(){null!==this.xXe||"Templatization"!==y.AFrameworkApplication.jv&&"ContentAssemblyEdit"!==y.AFrameworkApplication.jv||(y.AFrameworkApplication.nd("insertSnippetTreatment;insertSnippetControl"),this.xXe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertSnippetActionForCA",
!1):!1);return this.xXe}static get dpn(){null==this.LXe&&(y.AFrameworkApplication.nd("MiniTemplateV2ConsumerExp;MiniTemplateV2ConsumerExpCf"),this.LXe=y.AFrameworkApplication.J?y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateV2ForAppWelcomeExp",!1):!1);return this.LXe}}qs.QWe=null;qs.xXe=null;qs.LXe=null;Object(u.a)(qs,"WordReactFloatie",TB,[]);class Kn{constructor(){this.Cia=this.BQc=this.Z=null}get name(){return"WordEditor.UI"}init(){var b;this.Z.resolve(1076).Okg();
const h=df.a.NB.MJ,r=qa.StaticActiveAppFrame.za();qs.H7c(r,this.Z.resolve(731),h,this.Z.resolve(665));this.Cia=this.Z.Oa(30);const A=new hI(r,h,this.Z.Ra(710),this.Z.resolve(896)),M={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:M["floatie.gbFormatWithDesignerButton"]=
!1;break;case 2:M["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:M["floatie.gbUseSmartPasteButton"]=!1}A.H7c("PasteFloatieData",null,M);this.Z.resolve(1077).initialize();(new AA(r,h,this.Z.Ra(710),this.Z.resolve(1078))).H7c("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.Z.resolve(710);xl.a.get_instance().$k(7,()=>{this.BQc=this.Z.resolve(1079);this.BQc.Wb()})}dispose(){this.BQc&&(this.BQc.dispose(),this.BQc=null);this.Cia&&(this.Cia.dispose(),this.Cia=null)}uc(b){this.Z=
b;b.ia(1076,()=>new lG(b.resolve(447),b.resolve(813),y.AFrameworkApplication.va,y.AFrameworkApplication.J)).as(677).as(428).as(53).ha();let h=X.a.om;y.AFrameworkApplication.J.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=X.a.Di||h);b.ia(1086,()=>new iI.a(h));const r=X.a.Ur||X.a.yj,A=y.AFrameworkApplication.J.$("PasteWithOptionsFromContextMenu")&&(X.a.L7||r),M=y.AFrameworkApplication.J.$("CatchUpActivityIsEnabled");b.ia(922,()=>new Su($a.a.instance.resolve(346),$a.a.instance.resolve(735),new Fd.a)).ha();
b.ia(645,()=>new un(y.AFrameworkApplication.va,b.resolve(1080),b.resolve(43),y.AFrameworkApplication.J,b.resolve(180).instance,b.resolve(46).instance,M?b.Ra(858).instance:null,b.resolve(41),b.resolve(332),b.Oa(735),b.resolve(1081),b.resolve(1082),b.Ra(1083),b.Ra(4),b.Ra(1084),b.resolve(1085),b.resolve(866),b.resolve(930),A,r?b.resolve(1086):null,$a.a.instance.Ra(5),$a.a.instance.resolve(922),b.resolve(164),b.resolve(929),b.Oa(1087))).as(1058).ha();b.ia(123,()=>new gv).ha();b.ia(1077,()=>new Sj(y.AFrameworkApplication.J)).as(828).ha();
b.ia("WordEditor.UI.DialogFactory",()=>new BD).as(1063).as(1067).ha();b.ia("Common.NonCanvasCuiUser",()=>new Gk(rd.FocusManager.instance())).as(1088).ha();b.ia(1089,()=>new CK(b.resolve(710),b.resolve(1088))).ha();b.resolve(1089);b.ia(1079,()=>new Kv(qa.StaticActiveAppFrame.za().HFg,b.Ra(710),b.resolve(23),y.AFrameworkApplication.va,y.AFrameworkApplication.J,qa.StaticActiveAppFrame.za())).as(586).ha();const ba=b.resolve(1089);b.ia(1090,()=>new Br(uu.instance,b.resolve(665),ba)).ha();const oa=b.Ra(1089);
b.ia("WordEditor.UI.WordEditorRibbonUserFactory",()=>new sI(oa,y.AFrameworkApplication.va,rd.FocusManager.instance(),b.resolve(894),b.resolve(665),b.resolve(1090),y.AFrameworkApplication.oc,b.Ra(1091))).as(453).ha();b.ia("WordEditor.UI.ReactLanguageDialog",()=>new hv(b.resolve(1092),b.resolve(1093))).as(920);b.ia("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new nI(y.AFrameworkApplication.va)).as(1073).ha();b.ia("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new rt(y.AFrameworkApplication.va)).as(1074).ha();
b.ia("WordEditor.UI.RulerUser",()=>new pi).as(699);b.ia("WordEditor.UI.RulerContextMenu",()=>new Hs(y.AFrameworkApplication.va,$a.a.instance.Ra(6),kt.a.instance)).as(1027).ha();b.ia(731,()=>new eI(b.resolve(1090),b.resolve(665))).ha();b.ia(30,()=>new IF(b.resolve(731))).ha()}static main(){y.AFrameworkApplication.nd("5b6i5792;30d4f535");vi.instance.Eji();vi.instance.zAf();E.a.instance.Mc(new Kn,6)}}Object(u.a)(Kn,"WordEditorUIPackage",null,[0,1]);var no=window.ExternalContentFloatieData={name:"CommandUI",
attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",
attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",
QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},sy={};sy.pCc=function(){function b(){return oa()&&(Zc()||3<=(Sb()?Gd("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}
function r(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function A(Vf){Vf=(new RegExp(Vf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Oi=-1;null!=Vf&&2<=Vf.length&&(Oi=parseFloat(Vf[1]),isNaN(Oi)&&(Oi=-1));return Oi}function M(){DL||(DL=!0,EL=A("Windows Phone"));return 8<=EL}function ba(){return"function"==typeof navigator.msLaunchUri&&!r()&&!Dc()&&!Ja()}function oa(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Ja(){return 0<=window.navigator.userAgent.indexOf("Edge/")}
function jb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function zb(){return jb()?8==window.document.documentMode:!1}function Eb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Sb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function nc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Dc(){var Vf=window.navigator.userAgent.toLowerCase();return 0<=Vf.indexOf("android")&&
0<=Vf.indexOf("chrome")}function Zc(){return 3<=(Eb()?Gd("firefox/"):0)}function Gd(Vf){var Oi=window.navigator.userAgent.toLowerCase(),ik=Oi.indexOf(Vf);return 0<=ik?parseInt(Oi.substring(ik+Vf.length,Oi.length)):0}function de(Vf,Oi,ik,Mk,yo){if(Mk&&null!=Oi)Oi();else if(ba())navigator.msLaunchUri(Vf,Oi,ik);else if(!(nc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&oa())||Ja())fe(Vf,Oi,ik);else if(nc()&&yo)a:{try{window.open(Vf,
"_self")}catch(Cr){null!=ik&&ik();break a}null!=Oi&&Oi()}else he(Vf,Oi,ik)}function he(Vf,Oi,ik){var Mk=document.getElementById("OICLinkTag");null==Mk&&(Mk=document.createElement("a"),Mk.id="OICLinkTag",Mk.style.visibility="hidden",Mk.href="",0==(Ap.Options&fv.SupportsTopTargetNavigation)||Ap.NoBrowserModalDialogs?Mk.target="_blank":Mk.target="_top",document.body.appendChild(Mk),null!=Mk.addEventListener&&Mk.addEventListener("click",function(yo){null!=yo.stopPropagation&&yo.stopPropagation()},!1));
try{Mk.href=Vf,Mk.dispatchEvent(new MouseEvent("click"))}catch(yo){null!=ik&&ik();return}null!=Oi&&Oi()}function fe(Vf,Oi,ik){var Mk=document.getElementById("OICFrame");null==Mk&&(Mk=document.createElement("iframe"),Mk.className="ObjectInDialog",Mk.style.visibility="hidden",Mk.src="about:blank",document.body.appendChild(Mk),Mk.id="OICFrame");try{Mk.contentWindow.location.href=Vf}catch(yo){null!=ik&&ik();return}null!=Oi&&Oi()}function Yd(Vf){return 0!=(Vf.Options&fv.SkipProtocolHandler)||zb()}function Td(Vf){return Vf===
jz.ReadOnly||Vf===jz.ReadWrite}function wf(Vf,Oi,ik,Mk){var yo;try{var Cr=new ActiveXObject("SharePoint.OpenDocuments.4");return(yo=Cr.ViewDocument3(window.self,Vf,Oi,Mk))?(SB(kz.O14ActiveX),So.None):So.Failed}catch(kq){}if(fv.O14Only===(ik&fv.O14Only))return Ap.DescriptiveUnattemptedEnums?So.O14AttemptFailure:So.Unattempted;try{return Cr=new ActiveXObject("SharePoint.OpenDocuments.3"),(yo=Cr.ViewDocument3(window.self,Vf,Oi,Mk))?(SB(kz.O12ActiveX),So.None):So.Failed}catch(kq){}if(fv.O12UpOnly===(ik&
fv.O12UpOnly))return Ap.DescriptiveUnattemptedEnums?So.O12UpOnlyFail:So.Unattempted;try{return Cr=new ActiveXObject("SharePoint.OpenDocuments.2"),(yo=Td(Oi)?Cr.ViewDocument2(window.self,Vf,Mk):Cr.EditDocument2(window.self,Vf,Mk))?(SB(kz.O11ActiveX),So.None):So.Failed}catch(kq){}return Ap.DescriptiveUnattemptedEnums?So.ActiveXUnattempted:So.Unattempted}function Lf(Vf,Oi,ik,Mk,yo){Vf==zq.Visio&&ik==jz.ReadWrite&&(ik=jz.WriteOnly);Mk=Mk||r()&&!M();if(!Mk){Mk="";if(Vf==zq.PowerPoint){Vf=Mk;Mk=Ap.DocumentExtension;
ik=Td(ik);var Cr=new Set([".pot",".potm",".potx"]),kq=new Set([".pps",".ppsm",".ppsx"]);ik=ik&&Cr.has(Mk)?"nft|ofc|":ik&&kq.has(Mk)?"ofv|ofs|t|":!ik&&kq.has(Mk)?"ofe|ofs|t|":ik?"ofv|ofc|":"ofe|";ik=Vf+ik}else ik=Td(ik)?Mk+"ofv|ofc|":Mk+"ofe|";Vf=Ap.SessionOrigin?"or|"+Ap.SessionOrigin+"|":"";Vf+=Ap.ClickTime?"ct|"+Ap.ClickTime+"|":"";Vf+=Ap.CorrelationId?"cid|"+Ap.CorrelationId+"|":"";Mk=ik+Bi(Vf);yo+=Bi(Mk+"u|")}yo+=Bi(Oi);Oi=window.location.href;ik=Oi.toLowerCase().indexOf("&wdlor=");-1!=ik?(ik+=
7,Vf=Oi.indexOf("&",ik),Oi=-1==Vf?Oi.substr(ik):Oi.substring(ik,Vf)):Oi=void 0;if(null!=Oi&&"undefined"!=typeof Oi){ik="";try{ik=decodeURIComponent(Oi)}catch(FF){}0<ik.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(ik)&&(yo=yo+"|f|"+ik)}return yo}function ii(Vf,Oi,ik,Mk,yo,Cr){var kq=AL(Vf);if(null==kq)return vA(Ap.DescriptiveUnattemptedEnums?So.ProtocolHandlerIsNull:So.Unattempted,Ap.Application),!1;Vf=Lf(Vf,Oi,ik,Mk,kq);de(Vf,Ml,hk,yo,Cr);return!0}function Bi(Vf){if(oa()&&
nc()){var Oi="";try{Oi=decodeURI(Vf)}catch(ik){}if(Oi==Vf)return encodeURI(Vf)}return Vf}function Ml(){SB(kz.ProtocolHandler)}function hk(){Ap.Options|=fv.SkipProtocolHandler;oK(Ap,yD,EF)}function Tn(){null!=fI&&fI(kz.RoamingProtocolHandler)}function rx(){null!=sK&&sK(So.ControlNeeded)}function sx(){var Vf=document.getElementById("npSharePointPlugin");if(null==Vf){Vf="application/x-sharepoint";oa()&&3<=(Sb()?Gd("version/"):0)&&RB("application/x-sharepoint-webkit",!0)&&(Vf="application/x-sharepoint-webkit");
if(!RB(Vf,!0))if(oa()&&RB("application/officelive",!0))Vf="application/officelive";else return null;var Oi=document.createElement("object");Oi.id="npSharePointPlugin";Oi.type=Vf;Oi.style.width="0px";Oi.style.height="0px";Oi.style.setProperty("visibility","hidden","");document.body.appendChild(Oi);Vf=document.getElementById("npSharePointPlugin")}return Vf}function RB(Vf,Oi){var ik=window.navigator.mimeTypes;if(null==ik)return!1;Vf=ik[Vf];return!Vf||Oi&&!Vf.enabledPlugin?!1:!0}function CF(Vf){try{if(null!=
new ActiveXObject(Vf))return!0}catch(Oi){}return!1}function nK(Vf){switch(Vf){case zq.OneNote:return"OneNote.Notebook";default:return""}}function AL(Vf){if(Vf!=zq.OneNote&&r()&&!M())return"office:";switch(Vf){case zq.Excel:return"ms-excel:";case zq.OneNote:return"onenote:";case zq.PowerPoint:return"ms-powerpoint:";case zq.Visio:return"ms-visio:";case zq.Word:return"ms-word:";case zq.Project:return"ms-project:";case zq.Publisher:return"ms-publisher:";case zq.Infopath:return"ms-infopath:";case zq.Access:return"ms-access:";
default:return""}}function BL(Vf){switch(Vf){case zq.Excel:return"root\\office15\\excel.exe";case zq.PowerPoint:return"root\\office15\\powerpnt.exe";case zq.Visio:return"root\\office15\\visio.exe";case zq.Word:return"root\\office15\\winword.exe";case zq.Project:return"root\\office15\\winproj.exe";case zq.Publisher:return"root\\office15\\mspub.exe";case zq.Infopath:return"root\\office15\\infopath.exe";case zq.Access:return"root\\office15\\msaccess.exe";default:return null}}function oK(Vf,Oi,ik){Ap=
Vf;yD=Oi;EF=ik;if(Vf.DocumentUrl){var Mk=ik=Oi=Vf.DocumentUrl;try{Mk=decodeURIComponent(Vf.DocumentUrl)}catch(GF){}try{ik=encodeURI(Vf.DocumentUrl)}catch(GF){}Oi=Oi+""+Vf.CorrelationIdForWinClient;Mk+=Vf.CorrelationIdForWinClient;ik+=Vf.CorrelationIdForWinClient;Vf.Mode===jz.ReadWrite&&fv.CheckoutRequired===(Vf.Options&fv.CheckoutRequired)&&(Vf.Mode=jz.ForceCheckout);fv.HostIsEditOnly===(Vf.Options&fv.HostIsEditOnly)&&(Vf.Mode=jz.WriteOnly);if(Yd(Vf)?0:oa()&&(Vf.Application==zq.OneNote||RB("application/x-sharepoint-protocolhandler",
!1)||RB("application/x-sharepoint-webkit-protocolhandler",!1))||ba()||Dc()||!(b()||Zc()||"ActiveXObject"in window&&!r()||nc())||15<=DF())ii(Vf.Application,Vf.EncodeUrl?ik:Oi,Vf.Mode,Vf.Application==zq.OneNote,Vf.SilentExternalHandler,Vf.NavigateUsingWindowOpen);else{var yo;if(yo=zb())a:{var Cr=Vf.EncodeUrl?Oi:Mk,kq=Vf.Mode,FF=nK(Vf.Application);try{yo=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Cr,kq,FF);break a}catch(GF){}yo=!1}if(yo)SB(kz.O15ActiveX);else{if(b()||
Zc()){var Ds=Vf.EncodeUrl?Oi:Mk;Mk=Vf.Mode;yo=nK(Vf.Application);Cr=sx();if(null==Cr)Ds=Ap.DescriptiveUnattemptedEnums?So.PluginIsNull:So.Unattempted;else{kq=!1;try{kq=Cr.ViewDocument3(window.self,Ds,Mk,yo)}catch(GF){}if(!kq)try{kq=Td(Mk)?Cr.ViewDocument2(window.self,Ds,yo):Cr.EditDocument2(window.self,Ds,yo)}catch(GF){}kq?(SB(kz.NpapiPlugin),Ds=So.None):Ds=So.Failed}}else{try{Ds=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Ds&&Ds.SaveSSOCreds()}catch(GF){}Ds=wf(Vf.EncodeUrl?Oi:Mk,Vf.Mode,Vf.Options,
nK(Vf.Application))}if(Ds!=So.None){if(Mk=Vf.CouldUseRoamingApps)tK||(tK=!0,uK=A("Windows NT")),Mk=6.1<=uK&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(jb()||Zc()||nc());if(Mk&&Vf.Application!=zq.OneNote){if(!sy.pCc.lOp()){vA(So.ControlNeeded,Ap.Application);return}if(Vf.RoamingAppsLauncher){"undefined"==typeof Vf.RoamingAppsLauncher||null==Vf.RoamingAppsLauncher?vA(Ap.DescriptiveUnattemptedEnums?So.RoamingLauncherIsNull:So.Unattempted,Ap.Application):"undefined"==typeof Vf.RoamingBitsUrl||
null==Vf.RoamingBitsUrl?sy.pCc.EQp(Vf.DocumentUrl,Vf.RoamingAppsLauncher,Vf.Application,Vf.ApplicationParameters,yD,EF):sy.pCc.Fhk(Vf.DocumentUrl,Vf.RoamingAppsLauncher,Vf.RoamingApplicationExe,Vf.ApplicationParameters,Vf.RoamingPlatform,Vf.RoamingBitsUrl,yD,EF);return}if(!Vf.ContinueIfLauncherIsNull){vA(So.LauncherNeeded,Ap.Application);return}}fv.NoProtocolHandlerFallback==(Vf.Options&fv.NoProtocolHandlerFallback)||Yd(Vf)||jb()||oa()&&!(Ap.DescriptiveUnattemptedEnums?Ds>=So.O14Unattempted&&Ds<=
So.DocumentUrlIsNull:Ds==So.Unattempted)?vA(Ds,Ap.Application):ii(Vf.Application,Vf.EncodeUrl?ik:Oi,Vf.Mode,Vf.Application==zq.OneNote,Vf.SilentExternalHandler,Vf.NavigateUsingWindowOpen)}}}}else vA(Ap.DescriptiveUnattemptedEnums?So.DocumentUrlIsNull:So.Unattempted,Ap.Application)}function SB(Vf){null!=yD&&yD(Vf)}function vA(Vf,Oi){"undefined"==typeof Oi&&(Oi=null);null!=EF&&EF(Vf,Oi)}function DF(){var Vf=0;if(b()||Zc()||nc()){var Oi=sx();try{null!=Oi&&(Vf=Oi.GetOfficeVersion())}catch(ik){}}else CF("SharePoint.OpenDocuments.5")?
Vf=15:CF("SharePoint.OpenDocuments.4")?Vf=14:CF("SharePoint.OpenDocuments.3")?Vf=12:CF("SharePoint.OpenDocuments.2")&&(Vf=11);return Vf}function pK(){return oa()&&(RB("application/x-sharepoint",!0)||RB("application/x-sharepoint-webkit",!0))}var qK="",CL="",rK="",yD,EF,fI,sK,Ap,tK,uK,DL,EL,jz={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},fv={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
So={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},kz={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},zq={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:jz,OpenDocumentOptions:fv,OpenDocumentFailureType:So,OpenDocumentControl:kz,OfficeApplication:zq,EditDocumentInClient:oK,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=zq.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:DF,IsO14MacPluginInstalled:pK,OfferOfficeInDialog:function(){return h()&&11>=DF()},OfferOfficeNoIntrusive:function(){return h()&&15>DF()},OfferMacOffice:function(){return oa()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!pK()},InstallRoamingControl:function(){Eb()?
window.InstallTrigger.install({Office:{URL:CL}}):fe(rK,null,null)},CanUseRoamingControl:function(){if(ba())return!0;if(nc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Eb()){var Vf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Vf);var Oi=document.createEvent("Events");Oi.initEvent("RoamingOfficeInstalled",!0,!1);Vf.dispatchEvent(Oi);return!!Vf.getAttribute("installed")}if(jb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(ik){}return!1},
InitUrls:function(Vf,Oi,ik){qK=Vf;CL=ik;rK=Oi},LaunchRoamingApps:function(Vf,Oi,ik,Mk,yo,Cr){sy.pCc.Fhk(Vf,Oi,BL(ik),Mk,"x86",qK,yo,Cr)},LaunchRoamingApps2:function(Vf,Oi,ik,Mk,yo,Cr,kq,FF){var Ds="";null!=Mk&&(Ds+=" "+Mk);null!=Vf&&(Ds+=' "'+Vf+'"');if(ba()||nc())fI=kq,sK=FF,kq='office: "'+(Cr+'" "')+(ik+'" "ROAMING"'),kq+=' "'+Oi+'"',kq+=' "'+yo+'"',kq+=" "+Ds,de(kq,Tn,rx,!1,!1);else if(Eb())Vf=document.createElement("RoamingExtensionElement"),Vf.setAttribute("cabUrl",Cr),Vf.setAttribute("app",
ik),Vf.setAttribute("licensingEntitlements",Oi),Vf.setAttribute("platform",yo),Vf.setAttribute("args",Ds),document.documentElement.appendChild(Vf),Oi=document.createEvent("Events"),Oi.initEvent("RoamingOfficeLaunch",!0,!1),Vf.dispatchEvent(Oi),null!=kq&&kq(kz.RoamingFFExtension);else if(jb()){if(Vf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Vf)try{Vf.HrConfigureSingle(Cr,ik,Oi,yo,Ds),null!=kq&&kq(kz.RoamingActiveX)}catch(GF){}}else null!=FF&&FF(So.Failed)},ShouldShowDialog:function(){return!r()},
NavigateToUrlUsingClickingOnATag:he,OpenDocumentWithProtocolHandler:ii,OpenDocumentWithProtocolHandlerNoCallBack:function(Vf,Oi,ik,Mk){var yo=AL(Vf);if(null==yo)return vA(Ap.DescriptiveUnattemptedEnums?So.ProtocolHandlerNoCallbackIsNull:So.Unattempted,Ap.Application),!1;Vf=Lf(Vf,Oi,ik,Mk,yo);de(Vf,null,null,!1,!1);return!0}}}();sy.ClientUtils=sy.pCc;var gP=d(1371);class IL{constructor(b,h,r){this.C6n=(A,M,ba,oa,Ja)=>{if(1===ba)return 32;Ja?(A=Ja.SourceControlId,"btnjTryMacOfficeForWordEditor"===A?
Te.a.Cn(Fa.a.z9a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===A&&Te.a.Cn(Fa.a.z9a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.z6i();return 32};this.lpj=(A,M,ba)=>{if(1===ba)return 32;switch(A){case La.a.G4j:Te.a.Cn(Fa.a.z9a(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case La.a.F4j:Te.a.Cn(Fa.a.z9a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};this.ga=b;this.nCk=h;this.k$=r}Wb(){this.ga.qa(La.a.ssp,
xe.a.frame,this.C6n);this.ga.qa(La.a.G4j,xe.a.frame,this.lpj);this.ga.qa(La.a.F4j,xe.a.frame,this.lpj)}z6i(){Te.a.Cn(IL.eKn,"_blank",void 0,"LaunchMacTrialWindow")}get ipd(){return this.nCk&&X.a.om&&!X.a.i0f&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get L5o(){const b=this.ipd;b||y.AFrameworkApplication.En.ZTo();return b}get K5o(){return this.ipd}static get eKn(){return Fa.a.Xaa("522401")}}Object(u.a)(IL,"MacOfficeOffer",null,[1948]);class JL{constructor(b,h,r){this.D6n=(A,M,ba,oa,Ja)=>{if(this.EPd&&
1===ba)return this.isFreemiumUpsellEnabled&&this.jpd?32:8;2===ba&&(Ja?(A=Ja.SourceControlId,"btnjTryOfficeForWordEditor"===A?Te.a.Cn(Fa.a.z9a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===A?Te.a.Cn(Fa.a.z9a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.G3f()):this.G3f());return 32};this.IKg=(A,M,ba,oa,Ja)=>{if(this.EPd&&1===ba)return this.isFreemiumUpsellEnabled&&this.jpd?32:8;2===ba&&(Ja?(A=Ja.SourceControlId,Te.a.Cn(Fa.a.Xaa("862405")+this.cGm(A),
"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Te.a.Cn(Fa.a.Xaa("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};this.L4j=(A,M,ba)=>{if(this.EPd&&1===ba)return this.isFreemiumUpsellEnabled&&this.jpd?32:8;if(2===ba)switch(A){case La.a.K4j:Te.a.Cn(Fa.a.z9a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case La.a.J4j:Te.a.Cn(Fa.a.z9a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};this.ga=b;this.uCk=h;this.HK=null;(this.EPd=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))&&$a.a.instance.Ra(4).execute(A=>{this.HK=A});this.k$=r}Wb(){this.ga.qa(La.a.Esp,xe.a.frame,this.D6n);this.ga.qa(La.a.IKg,xe.a.frame,this.IKg);this.ga.qa(La.a.K4j,xe.a.frame,this.L4j);this.ga.qa(La.a.J4j,xe.a.frame,this.L4j)}get $Vn(){return this.jpd}get ZVn(){return this.jpd&&MSOJS.ClientUtils.OfferOfficeInDialog()}get jpd(){return this.uCk&&!X.a.om}get isFreemiumUpsellEnabled(){let b=!1;this.HK&&(b=this.HK.isFreemiumUpsellEnabled());return b}G3f(b=null){let h=0;b&&(h=b);Te.a.Cn(JL.vzm(h),"_blank",
void 0,"LaunchOfficeOffer")}cGm(b){let h=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=
8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;
break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static vzm(b){if(X.a.Di)switch(b){case 1:return Fa.a.Xaa("393806");case 2:return Fa.a.Xaa("393810");case 3:return Fa.a.Xaa("393809");case 5:return Fa.a.Xaa("393805")}else if(X.a.CI)switch(b){case 1:return Fa.a.Xaa("521979");case 3:return Fa.a.Xaa("521980");case 5:return Fa.a.Xaa("521978");
case 2:return Fa.a.Xaa("522490")}else{if(2===b)return Fa.a.Xaa("517778");if(1===b)return Fa.a.z9a(30)}return Fa.a.Xaa("522402")}}Object(u.a)(JL,"OfficeTrialExperience",null,[1947]);class uO{uc(b){b.register(JL,"Common.App.OpenInClient.OfficeTrialExperience").as(120).ha().Sd(()=>new JL(y.AFrameworkApplication.va,y.AFrameworkApplication.P_f,y.AFrameworkApplication.lcid));b.register(IL,"Common.App.OpenInClient.MacOfficeOffer").as(1069).ha().Sd(()=>new IL(y.AFrameworkApplication.va,y.AFrameworkApplication.q_i,
y.AFrameworkApplication.lcid))}}Object(u.a)(uO,"OpenInClientConfiguration",null,[1]);class vO{constructor(b=!1,h=!1,r=!1,A=!1,M=!0,ba=!1,oa=!0,Ja=!0,jb=!0,zb=!1,Eb=!1,Sb=!1,nc=!1,Dc=!1,Zc=!1,Gd=!1,de=!1,he=!1,fe=null,Yd=null,Td=null,wf=null,Lf=null,ii=null,Bi=null,Ml=null,hk=null){this.Xnc=!1;this.oJk=b;this.tJk=h;this.TNk=r;this.RNk=A;this.MNk=M;this.NNk=ba;this.PNk=oa;this.QNk=Ja;this.ONk=jb;this.dOk=zb;this.xOk=Eb;this.cOk=Sb;this.PPk=nc;this.XNk=Dc;this.yAk=Zc;this.pOk=Gd;this.yOk=de;this.Tqk=
he;this.VNk=fe;this.bOk=Yd;this.SNk=Lf;this.$Nk=Td;this.UNk=wf;this.ZNk=ii;this.aOk=Bi;this.WNk=Ml;this.YNk=hk}get wsj(){return this.oJk}get bco(){return this.tJk}get YSj(){return this.TNk}get XSj(){return this.RNk}get V4o(){return this.MNk}get W4o(){return this.NNk}get Y4o(){return this.PNk}get Z4o(){return this.QNk}get X4o(){return this.ONk}get Syb(){return this.XNk}get Dan(){return this.yAk}get GTj(){return this.pOk}get gUj(){return this.yOk}get Anl(){return this.Tqk}get aTj(){return this.dOk}get h7o(){return this.xOk}get h5o(){return this.cOk}get Ehp(){return this.PPk}get ZSj(){return this.VNk||
Object(F.a)(this,this.ewc,"returnFalse")}get g5o(){return this.bOk||Object(F.a)(this,this.ewc,"returnFalse")}get f5o(){return this.$Nk||Object(F.a)(this,this.Nvg,"returnTrue")}get a5o(){return this.UNk||Object(F.a)(this,this.Nvg,"returnTrue")}get $4o(){return this.SNk||Object(F.a)(this,this.ewc,"returnFalse")}get e5o(){return this.ZNk||Object(F.a)(this,this.Nvg,"returnTrue")}get $Sj(){return this.aOk||Object(F.a)(this,this.ewc,"returnFalse")}get b5o(){return this.WNk||Object(F.a)(this,this.ewc,"returnFalse")}get d5o(){return this.YNk||
Object(F.a)(this,this.ewc,"returnFalse")}Nvg(){return!0}ewc(){return!1}}Object(u.a)(vO,"HtmlTranslatorSettings",null,[317]);class qz{constructor(b,h,r,A,M,ba,oa){this.sg=b;this.Bg=h;this.e_=r;this.JCf=A;this.Oj=M;this.Pd=ba;this.OF=oa}Ubn(b,h){var r;b=h.view;h=h.Ok;if(!h||!this.sg.XXi(h,!0)||this.JCf&&this.JCf.instance&&this.JCf.instance.KX(h))return 2;var A=qz.Veb?!qz.l3.ZBa(h):!0;this.e_&&A&&this.e_.RAc(h.node,rf.a.Tu,h.cpBegin);A=h.node;(null===(r=this.OF)||void 0===r?0:r.replaceText)&&this.OF.Woc(A)?
(r=A.ra.i8a(h.cpBegin),this.OF.replaceText(A,r,r,mk.a.Ebd)):this.Bg.Tla(h,M=>new mk.a(M));if(this.Pd.Ag){r=new Qb.GraphTransaction(15);try{r.Ab(h.node),this.Oj.Hna(h.node,h.cpBegin,h.cpBegin+1,1)}finally{r&&r.dispose()}}A=h.node;r=h.cpEnd+1;" "===Ed.ParagraphReader.text(A).charAt(r)&&(A=vc.a.createTextRange(A,r,r+1),this.Bg.Ue(A,"\u00a0"));h=vc.a.Tc(h.node,r);b.lb.Kc(sc.SelectionFactory.Yo(h));return 32}static get l3(){return null!=qz.yYg?qz.yYg:qz.yYg=$a.a.instance.resolve(242)}static get Veb(){null==
qz.nqa&&(qz.nqa=y.AFrameworkApplication.J?y.AFrameworkApplication.J.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return qz.nqa}}qz.nqa=null;Object(u.a)(qz,"InsertLineBreakStrategy",null,[]);class kv{static get Of(){return null!=kv.Z1g?kv.Z1g:kv.Z1g=$a.a.instance.resolve(16)}static get Oj(){return null!=kv.Q5g?kv.Q5g:kv.Q5g=$a.a.instance.resolve(39).instance}static get Pd(){return null!=kv.t6g?kv.t6g:kv.t6g=$a.a.instance.resolve(46).instance}static ucn(b,h,r,A,M){if(M&&M.hasProperty(Bd.a.targetObject)){var ba=
h.view.qd.Ic.Eb(M.getValue(Bd.a.targetObject));ba=vc.a.create(ba)}else ba=Object(zl.a)().PW(h.Ok,11);if(!ba)return 8;b=y.AFrameworkApplication.va.Pf(ba,b,r,!0,A,M);if(32===b&&2===r){if(!h.view.ue)return 2;h=h.view;A=h.lb.Ng;if(A=Object(zl.a)().PW(A,11)){r=new sn.a;r.set(A.node);r.Ld();if(M&&M.hasProperty(Bd.a.targetObject))for(M=M.wf(Bd.a.targetObject);!r.currentNode.id.equals(M)&&r.rc()&&(Ab.OutlineElementNavigator.ke(r),11===r.nf););Ab.OutlineElementNavigator.N3(r,!1,!1);M=Le.a.ZJa(r,!0);M=Ed.ParagraphReader.Au(M)?
sc.SelectionFactory.ve(M,0):sc.SelectionFactory.Ir(M);h.lb.Kc(M)}}return b}static Zbe(b,h,r,A,M){b=b===ub.a.d8c;h=h.node;if(M&&M.hasProperty(Bd.a.targetObject)&&!h.id.equals(M.wf(Bd.a.targetObject)))return 2;if(1===r)return 32;r=new zc.a;r.set(h);r.vb(10);kv.Of.gz(r,b,!0);kv.Pd.Ag&&(r=Ab.OutlineElementNavigator.Me(r),kv.Oj.u0b(r,1));return 32}}Object(u.a)(kv,"InsertOutlineElementStrategy",null,[]);class SF{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){this.WSi=(Sb,nc,Dc)=>{var Zc,Gd;if(null===(Zc=this.xda)||
void 0===Zc?0:Zc.tEa)return this.xda.tEa(Dc,nc.cpBegin,{Fb:nc.Fb,Tb:nc.Tb});Zc=!nc.cpBegin;Dc=nc.cpBegin===Ed.ParagraphReader.textLength(Dc);const de=!(null===(Gd=Jf.a.vd())||void 0===Gd||!Gd.wn);let he=!0;de&&Zc&&!Dc?(he=!1,Gd=new zc.a,Gd.kd(Sb),Gd.Ld(),this.Rh.gz(Gd,!0,!1)):Gd=this.Rh.eta(Sb);this.Rh.Jca(Sb,Gd,nc,!1,!0,he,!1,!0);!de||Zc||Dc||(Sb=Object(zl.a)().G5d(nc),Jf.a.vd().Fk.NG(Sb));return Gd};this.j1=h;this.uvk=b;this.wB=ba;this.CEk=M;this.Rh=r;this.qtk=A;this.Al=oa;this.ib=Ja;this.JG=jb;
this.AFc=zb;this.xda=Eb}MSn(b,h,r,A,M){if(!h.view.ue)return 2;h=h.view;let ba=null;h.jj&&(ba=h);const oa=h.lb.Ng;var Ja=!0;let jb=!1,zb=null;if(!oa)return 2;const Eb=new Qb.GraphTransaction(15);Eb.Ab(h.qd);let Sb=null;2===r&&(Sb=new sn.a,Sb.set(oa.node),Sb.Ld(),zb=new xC.a(Sb),Ab.OutlineElementNavigator.ke(Sb),Ja=Ua.a.isEmpty(Sb,!1),{qTj:Ja,ack:jb}=this.qtk.rTj(Sb,Ja,rv.a.DQb,-1,oa));b=y.AFrameworkApplication.va.Pf(oa,b,r,!1,A,M);Ja&&32===b&&2===r&&(jb||Ab.OutlineElementNavigator.vMa(Sb,!1,!Le.a.qf(oa),
!1),jb&&zb&&zb.restore(Sb),this.wB.freeze(),(r=sc.SelectionFactory.vp(Sb.currentNode,!0))||v.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.lb.Kc(r),this.wB.MOa(),this.uvk.rh.BI());ba&&(Ja||ba.n4(),ba.Ke&&ba.LX&&(ba.Ke.wK=!0));ls.GrippersManager.instance.O2b(1);Eb.dispose();return b}GE(b,h,r){b=!1;if(je.a.K7(h)||je.a.bab(h))h=this.GCl(h),b=!0;const A=h;if((h=Le.a.qf(h))&&this.Al.Ph&&!this.Al.ypn(A))return 2;if(1===r)return 32;const M=A.node,ba=new zc.a;ba.set(M);
ba.Ld();Ab.OutlineElementNavigator.ke(ba);r=new Qb.GraphTransaction(15);r.pu(ba);h?(this.AFc.instance&&this.AFc.instance.bPa(A),Ed.ParagraphReader.Vb(M)&&A.cpBegin===Ed.ParagraphReader.textLength(M)&&bm.m(A)&&9===Ed.ParagraphReader.XAa(M)&&this.wB.DDl(A),mf.ListItemReader.Dg(ba)?this.CEk.execute(ba,A,M,this.WSi):this.WSi(ba,A,M),this.j1&&this.j1.RAc(M,rf.a.Tu,A.cpBegin),b&&(Ab.OutlineElementNavigator.at(ba,!1,!1),b=ba.Ub(2),(b=this.JG.ve(b,0))&&this.ib.Kc(b))):this.Rh.gz(ba,!0,!0);r.dispose();qa.StaticActiveAppFrame.za()&&
qa.StaticActiveAppFrame.za().Fe();return 32}GCl(b){if(je.a.K7(b))var h=vc.a.Tc(b.node,b.cpBegin);else{h=Ed.ParagraphReader.n_(b.node);var r=h.properties.wf(Rc.a.Mq);b=b.node.properties.getValue(Rc.a.runId);r=SF.KIf(b,r,h.ra);h=vc.a.Tc(h,r)}return h}static TDf(b,h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}static KIf(b,h,r){let A=0;b=SF.TDf(b,h);let M=0;if(b===h.length)M=r.length-1;else for(;M<r.length;){h=r.K(M);if(h.formatting&&h.formatting.te===b)break;M++}M<r.length&&(A=r.K(M).cp);return A}}
Object(u.a)(SF,"NewLineStrategy",null,[]);class Lv{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc,Gd){this.In=null;this.Dqa=b;this.PAd=oa;this.DHd=new SF(this,h,r,A,M,ba,Ja,Eb,Sb,Zc,Gd);this.dnh=new qz(Ja,jb,h,zb,nc,Dc,Gd)}get rh(){return this.In||(this.In=this.Dqa())}Wb(){const b=y.AFrameworkApplication.va,h=Object(F.a)(this.DHd,this.DHd.GE,"newLine");b.fb(ub.a.enter,mc.a.view,Object(F.a)(this.PAd.value,this.PAd.value.J3l,"enterView"),1124);b.fb(ub.a.ySj,mc.a.view,Object(F.a)(this.PAd.value,
this.PAd.value.G3o,"shiftEnterView"),1124);b.qa(ub.a.GE,mc.a.view,Object(F.a)(this.DHd,this.DHd.MSn,"newLineView"));b.qa(ub.a.GE,mc.a.Vc,h);b.qa(ub.a.GE,mc.a.image,h);b.qa(ub.a.GE,mc.a.Fd,h);b.qa(ub.a.GE,mc.a.V$,h);b.qa(ub.a.GE,mc.a.qpb,h);b.qa(ub.a.GE,mc.a.P7c,h);b.qa(ub.a.GE,mc.a.paragraph,h);b.qa(ub.a.GE,mc.a.cK,h);b.qa(ub.a.GE,mc.a.kPa,h);b.Pc(ub.a.GE,1124);b.fb(ub.a.$7c,mc.a.view,Object(F.a)(this.dnh,this.dnh.Ubn,"insertLineBreakView"),1028);b.qa(ub.a.d8c,mc.a.view,kv.ucn);b.qa(ub.a.d8c,mc.a.oS,
kv.Zbe);b.Pc(ub.a.d8c,1092)}static get instance(){return null!=Lv.AZg?Lv.AZg:Lv.AZg=Lv.Sm()}static Sm(){return new Lv(()=>$a.a.instance.resolve(50),$a.a.instance.Oa(70),$a.a.instance.resolve(16),$a.a.instance.resolve(1094),$a.a.instance.resolve(1095),$a.a.instance.resolve(106),$a.a.instance.rf(1096),ve.a.instance,$a.a.instance.resolve(323),$a.a.instance.Ra(51),$f.a.instance,$a.a.instance.resolve(870),$a.a.instance.resolve(39).instance,$a.a.instance.resolve(46).instance,$a.a.instance.Ra(87),$a.a.instance.resolve(86))}}
Object(u.a)(Lv,"EnterActor",null,[]);var tI=d(1274),KL=d(586);class Ak{static get sl(){return null!=Ak.I2g?Ak.I2g:Ak.I2g=$a.a.instance.resolve(349)}static get S8(){return null!=Ak.q4g?Ak.q4g:Ak.q4g=$a.a.instance.Oa(827)}static get szb(){return null!=Ak.B4g?Ak.B4g:Ak.B4g=$a.a.instance.Oa(8)}static get rbb(){return null!=Ak.V0g?Ak.V0g:Ak.V0g=$a.a.instance.Oa(385)}static get Oj(){return null!=Ak.Y5g?Ak.Y5g:Ak.Y5g=$a.a.instance.Oa(382)}static get Pd(){return null!=Ak.y6g?Ak.y6g:Ak.y6g=$a.a.instance.Oa(263)}static Wb(){const b=
y.AFrameworkApplication.va;b.qa(ub.a.q4f,mc.a.view,Sn.a.yx);b.Pc(ub.a.q4f,1028);b.qa(ub.a.bF,mc.a.view,Sn.a.yx);b.qa(ub.a.bF,mc.a.paragraph,Ak.NSd);b.Pc(ub.a.bF,1036);b.qa(ub.a.lxc,mc.a.paragraph,Ak.K8k);b.qa(ub.a.lxc,mc.a.view,Sn.a.yx);b.Pc(ub.a.lxc,1036);b.qa(ub.a.Wnd,mc.a.paragraph,Ak.Nif);b.qa(ub.a.Wnd,mc.a.view,Sn.a.yx);b.qa(ub.a.Lod,mc.a.paragraph,Ak.ijf);b.qa(ub.a.Lod,mc.a.view,Sn.a.yx);b.qa(ub.a.Vnd,mc.a.paragraph,Ak.Mif);b.qa(ub.a.Vnd,mc.a.view,Sn.a.yx);b.qa(ub.a.Dff,mc.a.view,Ak.c4k);b.Pc(ub.a.Dff,
1036);b.qa(ub.a.Osg,mc.a.view,Ak.dEo);b.Pc(ub.a.Osg,1036);b.qa(ub.a.Cff,mc.a.view,Ak.b4k);b.Pc(ub.a.Cff,1036);b.qa(ub.a.Nsg,mc.a.view,Ak.cEo);b.Pc(ub.a.Nsg,1036);b.qa(ub.a.J_a,mc.a.view,Sn.a.yx);b.qa(ub.a.J_a,mc.a.paragraph,Ak.NSd);b.Pc(ub.a.J_a,1036);b.qa(ub.a.I_a,mc.a.view,Sn.a.yx);b.qa(ub.a.I_a,mc.a.paragraph,Ak.NSd);b.Pc(ub.a.I_a,1036);b.qa(ub.a.JAe,mc.a.view,Ak.IAe);b.qa(ub.a.JAe,mc.a.paragraph,Ak.IAe);b.Pc(ub.a.JAe,1028);b.qa(ub.a.YEg,mc.a.view,Ak.IAe);b.qa(ub.a.YEg,mc.a.paragraph,Ak.IAe);b.Pc(ub.a.YEg,
1028);b.qa(ub.a.BAe,mc.a.view,Sn.a.yx);b.qa(ub.a.BAe,mc.a.paragraph,Ak.GTh);b.Pc(ub.a.BAe,1028);b.qa(ub.a.AAe,mc.a.view,Sn.a.yx);b.qa(ub.a.AAe,mc.a.paragraph,Ak.GTh);b.Pc(ub.a.AAe,1028)}static GTh(b,h,r,A,M){if(1===r)return 32;b===ub.a.BAe?b=ub.a.J_a:b===ub.a.AAe&&(b=ub.a.I_a);return Ak.NSd(b,h,r,A,Ak.Cbo(M))}static Cbo(b){var h=b.indexOf(",");const r=b.substring(0,h);b=b.substring(h+1,b.length);h=new tI.a;h.value=parseFloat(r);h.unit=parseInt(b);return h}static IAe(b,h,r,A,M){if(2===r){h=M[ki.a.Text];
r=M[ki.a.Number];M=M.Increment;A=new tI.a;let ba=!1;""===h||M&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(A.value=0,A.unit=df.a.ILa?2:4,ba=!0):r||M||(A.value=0,A.unit=1,ba=!0);ba&&(y.AFrameworkApplication.va.Pb(b===ub.a.JAe?ub.a.J_a:ub.a.I_a,2,A),qa.StaticActiveAppFrame.za().Fe())}return 32}static NSd(b,h,r,A,M){if(!({Oz:r}=Sn.a.hCg(r,h)).returnValue)return r;h=h.node;switch(b){case ub.a.bF:Ak.sl.bF(h,new KL.a(2,M));break;case ub.a.J_a:b=new KL.a(M.unit,M.value);Ak.sl.jyb(h,b);break;case ub.a.I_a:b=
new KL.a(M.unit,M.value),Ak.sl.iyb(h,b)}A&&Lq.a.Tzb&&(A.Ft|=Lq.a.Nqb(h));return 32}static c4k(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=Ak.LHi(h);if(!b)return v.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ka(Rc.a.Uj,240)/20)?b:Ak.$Pl;Ak.S8.wha(1,b,4);return 32}static dEo(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");Ak.S8.wha(1,
0,4);return 32}static b4k(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=Ak.LHi(h);if(!b)return v.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ka(Rc.a.ua,240)/20;Ak.S8.wha(0,b?b:12,4);return 32}static cEo(b,h,r){if(1===r)return 32;v.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Ak.S8.wha(0,0,4);return 32}static Nif(b,h,r,A,M){if(2==r){if("boolean"!==typeof M)return 16;
b=h.node;h=b.UA();Ak.sl.Nif(b,M);h&&Ak.Oj.fQ(b,h,Ak.Pd.Ag)}return 32}static ijf(b,h,r,A,M){if(2==r){if("boolean"!==typeof M)return 16;b=h.node;h=b.UA();Ak.sl.ijf(b,M);h&&Ak.Oj.fQ(b,h,Ak.Pd.Ag)}return 32}static Mif(b,h,r,A,M){if(2==r){if("boolean"!==typeof M)return 16;b=h.node;h=b.UA();Ak.sl.Mif(b,M);h&&Ak.Oj.fQ(b,h,Ak.Pd.Ag)}return 32}static K8k(b,h,r,A,M){if(2==r){if("boolean"!==typeof M)return 16;b=new Map;b.set("Value",M.toString());za.Health.instance.recordKpiUsage(fk.a.ibb.Enp,0,fk.a.$B,b);h=
h.node;b=h.UA();h.hasProperty(Rc.a.ny)&&h.removeProperty(Rc.a.ny);Ak.rbb.N5d(h)!==M&&h.setValue(Rc.a.ny,M);(M=Ak.rbb.Ekc(h,!0))&&M.fm(4,!0);(M=Ak.rbb.Ekc(h,!1))&&M.fm(4,!0);b&&Ak.Oj.fQ(h,b,Ak.Pd.Ag)}return 32}static LHi(b){b=b.view;return b.ue&&(b=b.lb)&&b.gb.currentSelection?Ak.szb.Hq(b.gb.currentSelection.Qa.node):null}}Ak.$Pl=12;Object(u.a)(Ak,"SpacingActor",null,[]);var FM=d(900);class WB{process(){}}Object(u.a)(WB,"NoOpFormattingViewOperationFinishedStageProcessor",null,[1627]);class GM{constructor(b){this.Je=
b}EWo(b,h){b&&h&&h.cache&&(this.Je.uha(b,h.cache.wI),this.Je.uC(b,h.cache.fontSize))}tQb(){return null}fWa(){return null}nlc(){return null}qX(){return null}}Object(u.a)(GM,"FormattingStewardBridge",null,[1628]);class HM{uc(b){b.ia(924,()=>new WB).ha();b.ia(690,()=>new GM(b.resolve(101))).ha()}}Object(u.a)(HM,"WoncaActorsConfiguration",null,[1]);class IM{constructor(b,h,r,A,M,ba,oa,Ja){this.ga=b;this.hqk=h;this.gqk=r;this.I$g=A;this.rJk=M;this.mJd=ba;this.vJk=oa;this.wJk=Ja}get Qb(){return this.ga}bgl(b){this.Qb.Rua(b,
this.hqk,null,null)}$fl(b){this.Qb.Rua(b,this.gqk,null,null)}C6(b,h,r){r?this.Qb.Rua(b,this.I$g,h,null):this.Qb.Pb(this.I$g,2,h)}eco(b,h){this.Qb.Rua(b,this.mJd,h,null)}b4(b,h){this.Qb.Rua(b,this.vJk,h,null)}Dwb(b,h){this.Qb.Rua(b,this.wJk,h,null)}kkg(b,h=!1){const r=new ji.DictionaryPropertySet;r.setValue(Bd.a.hY,b);r.setValue(Bd.a.Rsj,!0);r.setValue(Bd.a.nab,h);this.Qb.Pb(this.rJk,2,r)}}Object(u.a)(IM,"ClipboardCommands",null,[1620]);class JM{}Object(u.a)(JM,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",
null,[1619]);class KM{constructor(b){this.ga=b}get Qb(){return this.ga}EPj(b,h,r){let A=0;b?1===b&&(A=ub.a.J$a):A=ub.a.I$a;b=new nD.a;b.unit=r;b.value=h;this.Qb.Pb(A,2,b)}pye(b,h,r){let A=0;1===b?A=ub.a.m0b:2===b?A=ub.a.Fyb:b||(A=ub.a.n0b);b=new nD.a;b.unit=r;b.value=h;this.Qb.Pb(A,2,b)}}Object(u.a)(KM,"IndentationCommands",null,[1612]);var DK;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.l7p=4]="inner";b[b.outer=
5]="outer";b[b.both=6]="both";b[b.S_p=7]="distribute";b[b.margin=8]="margin";b[b.M5p=9]="highKashida";b[b.T9p=10]="lowKashida";b[b.r$p=11]="mediumKashida";b[b.xgq=12]="numTab";b[b.Bqq=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(DK||(DK={}));Object(u.b)("Justification",DK);class LM{constructor(b){this.MRa={};this.ga=b;this.R7m()}get Qb(){return this.ga}HH(b){b=this.MRa[DK[b]];void 0!==b&&null!==b&&this.Qb.Ob(b,2)}R7m(){this.MRa.left=ub.a.V7;this.MRa.center=ub.a.iaa;this.MRa.right=
ub.a.D8;this.MRa.both=ub.a.nKa;this.MRa.lowKashida=ub.a.sUb;this.MRa.mediumKashida=ub.a.sUb;this.MRa.highKashida=ub.a.sUb;this.MRa.distribute=ub.a.FZc;this.MRa.thaiDistribute=ub.a.Eod}}Object(u.a)(LM,"JustificationCommands",null,[1611]);class MM{constructor(b){this.ga=b}bF(b){this.ga.Pb(ub.a.bF,2,b)}lxc(b){this.ga.Pb(ub.a.lxc,2,b)}Wnd(b){this.ga.Pb(ub.a.Wnd,2,b)}Lod(b){this.ga.Pb(ub.a.Lod,2,b)}Vnd(b){this.ga.Pb(ub.a.Vnd,2,b)}wha(b,h,r){this.ga.Pb(b?ub.a.J_a:ub.a.I_a,2,Object.assign(new tI.a,{value:h,
unit:r}))}}Object(u.a)(MM,"SpacingCommands",null,[1609]);class LL{constructor(b,h,r){this.Qb=b;this.g_c=h;this.I_l=r;this.I7n=(A,M,ba)=>{if(1===ba)return this.g_c.q2?32:8;this.g_c.qDn();this.I_l().b9o(this.g_c.Orm());return 32}}Wb(){this.Qb.fb(ub.a.mwb,mc.a.application,this.I7n,1028)}}Object(u.a)(LL,"EditorSettingsUIActor",null,[]);class jG extends ug.a{constructor(b,h){super(!1,!1,!0);this.K_l=b;this.bYa=h;this.J_l=r=>{1!==r?v.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):
(this.K_l.Awp(),v.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}async b9o(b){const h=await this.bYa.TUb;b={["id"]:"SettingsDialog",["uiLanguage"]:y.AFrameworkApplication.uiCulture,["selectedLanguage"]:Ag.a.Hg(y.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.Aad,["editorSettings"]:b};this.gi(Box4Intl.Box4Strings.l_EditorSettings,this.J_l,b);v.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(u.a)(jG,"EditorSettingsDialog",ug.a,
[]);var yx=d(237);class KD{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){var Dc;this.VGb=this.kjc=this.NEc=null;this.u9e=0;this.OZd=null;this.zWe=!1;this.sa=new Fd.a;this.hee=!1;this.wFf=null===(Dc=y.AFrameworkApplication.J)||void 0===Dc?void 0:Dc.getBooleanFeatureGate("Microsoft.Office.WordOnline.FormatPainterStylesBugFixIsEnabled",!1);this.hw=b;this.wB=h;this.Je=r;this.Dv=A;this.hb=M;this.Qd=ba;this.Al=oa;this.Cd=Ja;this.Xd=jb;this.oq=zb;this.OZ=Eb;this.hy=Sb;this.Ip=nc}get v1l(){return this.Cd?
this.Cd.isFeatureEnabled(34):!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("Box4EndOfParagraphFormattingIsEnabled")}get yFf(){return null!=this.sXg?this.sXg:this.sXg=$a.a.instance.resolve(719)}get JU(){return this.zWe}set JU(b){this.zWe!==b&&(this.zWe=this.hee=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}j1k(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}Atj(b){const h=b.Qa;v.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);
this.reset();y.AFrameworkApplication.nd("FormatPainterStylesBugFix;FormatPainterStylesBugFixCf");this.wFf&&(this.OZd=xa.FormattingReader.j$a(h.node));var r=h.node;b=this.I_i(b);if(this.yFf.S5o(h.contextId,b))try{y.AFrameworkApplication.nd("c8cgd193;5b834819"),this.VGb=this.hb.R9a(r)}catch(A){throw v.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",A.message),A;}this.kjc=this.hy.Hq(r);r=xa.FormattingReader.Us(h);r.uo&&(this.NEc=Object(Ma.a)(PE.a,r.uo.clone()));y.AFrameworkApplication.nd("FormatPainterStylesBugFix;FormatPainterStylesBugFixCf");
this.wFf&&(this.kjc.getValue(ze.a.fontColor)||this.OZd.setValue(ze.a.fontColor,Yl.a.auto));this.u9e=b?mc.a.paragraph:h.contextId}bTh(b){if(b){const r=this.I_i(b);for(let A=0;A<b.length;A++){const M=b.K(A);if(null===M||void 0===M?0:M.Cl)this.DKb(M,r);else if(0==(null===M||void 0===M?void 0:M.length))v.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",M);else if(M)for(let ba=0;ba<M.length;ba++){var h=M.getContext(ba);if(null===h||void 0===h?0:h.Uw){if(h)for(let oa=
0;oa<h.length;oa++)M.addContext(h.getContext(oa))}else(null===h||void 0===h?0:h.Cl)?this.DKb(h,r):v.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}eTh(b,h){if(h){var r=b.node,A=r.ra.last,M=this.Qd.u8a(r),ba=M.Mf(M.Jb);this.fTh(M,h,null,null);this.oq.T_b(r,A,b.cpBegin,b.cpEnd,ba,M,this.Xd.Ag)}}X8k(b,h,r,A){if(h||r)0<bm.g(b).length&&v.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.OZ.LW(b,M=>{this.fTh(M,
h,r,A)})}fTh(b,h,r,A){this.Je.lra(b);y.AFrameworkApplication.nd("FormatPainterStylesBugFix;FormatPainterStylesBugFixCf");this.wFf&&this.At(b,A);b.uo&&b.uo.removeProperty(ze.a.highlight);this.Je.apf(b);r&&(r=r.clone(),r.Vf(...Or.a.bba()),this.At(b,r.Yi()));this.At(b,h)}At(b,h){if(h){var r=b.paragraph.Ic;if(r){var A=b.uo;A=A?Object(Ma.a)(Qp.a,A.clone()):PE.a.vUa(rn.a.zwb);for(const oa of h.fk())if(oa!==Rc.a.Hw&&oa!==Rc.a.S2&&oa!==ze.a.DE&&oa!==ze.a.sba&&oa!==Rc.a.ftb&&oa!==ze.a.iK&&oa!==Rc.a.kbb&&oa!==
Rc.a.noProof){if(oa===Yf.a.Jw){var M=h.ka(Yf.a.Jw,P.a.nil);if(M!==P.a.nil)if(M=this.hy.xo().Cla(M,r)){var ba=this.hy.LL(M);if(ba===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(M=this.hy.MF(b.paragraph),zi.a.Jg.xn?(ba=M.mv().fBa(ba),M=M.mh(this.hy.Be(ba))):M=M.MKa(ba),M){A.Mza(M.Yi(),...Or.a.bba());continue}else v.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else v.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}A.setValue(oa,
h.wf(oa))}A.VLa?h=r.WP(A,!0):(r.nu(A),h=A);b.Lk=h.id}}}I_i(b){return!b.Lw&&b.Wc.contextId!==mc.a.Yc}reset(){this.VGb=this.kjc=this.OZd=this.NEc=null;this.u9e=mc.a.none}DKb(b,h){if(b.contextId===mc.a.Vc||b.contextId===mc.a.Fd)var r=this.Al.qba(b);else if(b.contextId===mc.a.paragraph)r=this.Al.jfe(b);else if(b.contextId===mc.a.Yc)r=this.Al.Pde(b);else{v.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}v.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",
b.contextId);if(r)v.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{r=Object(Ma.a)(Pn.AParagraphNode,b.node);var A=!1;r&&(A=b.contextId===mc.a.Fd&&!!r&&!b.cpBegin&&b.cpEnd===this.hb.textLength(r));if(h=this.yFf.S3o(this.u9e,b.contextId,h,A))try{Ed.ParagraphReader.Vb(r)?(this.kjc&&this.hw.gQ(this.kjc,r,!0),this.Dv.xTh(r,this.VGb)):v.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(M){throw v.ULS.sendTraceTag(22832065,
354,10,"ApplyParagraphProperties error: {0}",M.message),M;}A=b;b.contextId===mc.a.paragraph?A=vc.a.createTextRange(r,0,Ed.ParagraphReader.textLength(r)):b.contextId===mc.a.Vc&&(A=this.wB.ZNf(b),A=$f.a.RMb(A));if(A&&A.contextId===mc.a.Fd){const M=this.Ip.q8d(A);M&&(A=M);try{this.X8k(A,this.NEc,h?null:this.kjc,h?null:this.OZd)}catch(ba){throw v.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",ba.message),ba;}}if(b.contextId===mc.a.paragraph||b.contextId===mc.a.Yc)h=new zc.a,
h.set(r),h.Ld(),h.fd(11),A=mf.ListItemReader.Dg(h),r=!Ed.ParagraphReader.textLength(r),v.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",A,r),A?(r=mf.ListItemReader.s7(h),mf.ListItemReader.isListItem(r)&&this.eTh(b,this.NEc)):this.v1l&&this.eTh(b,this.NEc)}}}Object(u.a)(KD,"FormatPainter",null,[1567]);var vM=d(116);class Wk{constructor(b,h,r,A,M,ba,oa,Ja=!1,jb,zb,Eb){this.fFd=!1;this.YSe=new Px.a;this.RWm=()=>{this.gW.JU=!1;return 32};this.SWm=(Sb,nc,Dc)=>{Sb=
!1;if(nc=this.wA.cla){switch(nc.contextId){case mc.a.Fd:case mc.a.paragraph:case mc.a.Yc:case mc.a.Vc:Sb=!0}Sb&&Le.a.gm(nc)&&bm.b(nc)&&(this.yd.$b(Uf.a.Vn,{["Reason"]:Ff.a.OWc}),Sb=!1);Sb&&Ed.ParagraphReader.IX(nc)&&(this.yd.$b(Uf.a.Vn,{["Reason"]:Ff.a.cR}),Sb=!1)}if(1===Dc||!Sb)return Sb?32:8;6!==this.ga.pE?(this.gW.JU?v.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(v.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.gW.Atj(this.wA.currentSelection),
this.fFd||(this.ii.c6a(this.r7j),(Dc=this.ii.kb.Fw)&&Dc.jj&&Dc.uPh(this.q7j),this.fFd=!0)),this.gW.JU=!this.gW.JU):(v.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.gW.Atj(this.wA.currentSelection),this.gW.JU=!1);return 32};this.QWm=(Sb,nc,Dc,Zc,Gd)=>{if(6===this.ga.pE||this.gW.JU){v.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.pE);Sb=this.ii.$r.Xf("UserAction","FormatPainterApply");if(Wk.qc&&Wk.qc.zE(107)){Gd=
Gd?Gd.KeepBrushActive:!1;Dc=null;this.wA.currentSelection&&2===this.wA.currentSelection.trigger&&(Gd=Gd||this.gW.hee,this.gW.hee&&Le.a.Fm(this.wA.currentSelection)&&(Dc=Le.a.c7(this.wA.currentSelection.Qa,!1)))&&(Dc.trigger=2);this.gW.hee=!1;if(Gd||2!==this.wA.currentSelection.trigger)nc=new Qb.GraphTransaction(15),Dc&&Dc.Qa?(nc.set(Dc.Qa.node.qk),this.ib.Kc(Dc)):nc.set(this.wA.VOb.qk),Dc=sc.SelectionFactory.Yo(this.ib.Ng),this.gW.bTh(Dc),nc.dispose();this.gW.JU=Gd}else Gd=new Qb.GraphTransaction(15),
Gd.set(this.wA.VOb.qk),nc=sc.SelectionFactory.Yo(this.ib.Ng),this.gW.bTh(nc),this.gW.JU=!1,Gd.dispose();Sb.stop()}return 32};this.r7j=()=>{this.toe(this.gW.JU)};this.q7j=()=>{this.toe(this.gW.JU)};this.ii=b;this.Zb=h;this.ga=r;this.yd=A;this.wA=M;this.gW=ba;this.ib=oa;this.GBk=Ja;this.sA=jb;this.Ny=zb;this.wtk=Eb}get Qih(){return X.a.hu||X.a.Efe?"url("+this.Oyi()+"), pointer":'url("'+this.Oyi()+'"), pointer'}Oyi(){return this.Ny?this.sA.RAa(Li.a.li("FormatPainterText.cur"),Li.a.li("FormatPainterTextDarkMode.cur"),
new vM.a(zm.a.BR())):Li.a.li("FormatPainterText.cur")}Wb(){const b=this.Zb.ie(Ii.a.GF);b.bindAction(kc.KeyInputManager.lc(rf.a.cgb,0),ub.a.xFf);b.bindAction(kc.KeyInputManager.lc(rf.a.nBb,6),ub.a.v4d);this.GBk||b.bindAction(kc.KeyInputManager.lc(rf.a.qBb,6),ub.a.W8a);this.ga.fb(ub.a.v4d,mc.a.view,this.SWm,1028);this.ga.fb(ub.a.W8a,mc.a.view,this.QWm,1028);this.ga.fb(ub.a.xFf,mc.a.view,this.RWm,1028);this.gW.j1k(()=>{this.dNg(this.gW.JU)});this.Ny&&this.wtk.FRd(()=>{this.toe(this.gW.JU)})}dNg(b){const h=
this.ii.$r.Xf("UserAction","FormatPainterUpdateCursor");this.toe(b);this.ii.Fe();h.stop()}p7j(b,h){for(let r=0;r<b.length;r++)this.o7j(b[r],h);(b=this.ii.kb.Fw)&&b.ue&&this.o7j(b.Oh.editingElement,h)}o7j(b,h){b.style.cursor=h?this.Qih:""}toe(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const r=h[h.length-2].style.cursor===this.Qih;if(this.ii.kb.isEditingAllowed||this.ii.kb.bA){if(b&&!r||!b&&r)this.p7j(h,b),this.M7j(b);b||!this.fFd||this.YSe.count||(this.ii.eEj(this.r7j),
(b=this.ii.kb.Fw)&&b.jj&&b.ZCo(this.q7j),this.fFd=!1)}else r&&(this.p7j(h,!1),this.M7j(!1))}}M7j(b){const h=this.ii.kb.Fw;h&&(b?this.YSe.add(h.qd.Gk):this.YSe.remove(h.qd.Gk))}static get qc(){return null!=Wk.lWg?Wk.lWg:Wk.lWg=$a.a.instance.Oa(23)}}Object(u.a)(Wk,"FormatPainterActor",null,[]);class Hw{constructor(b,h,r){this.ao=r}J3l(b,h,r,A,M){var ba;if(!({ne:r,selected:ba,Oz:jb,P9c:Ja}=this.ATj(h,r,!1)).returnValue)return jb;db.a.mark(5013);var oa=Hw.Nw.XO(ba);for(let zb=0;zb<oa.length;++zb){if(!oa[zb].isValid)continue;
const Eb=oa[zb].iterator;Eb.yq();if(Lj.OutlineReader.zy(Eb))return this.jli(r,Eb)}var Ja=Ja?ub.a.$7c:this.qsm();if(ba.Uw||Le.a.gm(ba)||Ed.ParagraphReader.kn(ba)&&!Le.a.nba(ba)){if(Hw.qc&&Hw.qc.isFeatureEnabled(21)&&Object(zl.a)().hEg(ba).returnValue)return 8;var jb=this.kli(h,r,b,A,M,Ja)}else if(Le.a.rl(ba))jb=this.ili(h,r,b,A,M,Ja);else if(Le.a.qf(ba)){jb=new zc.a;jb.set(ba.node);jb.vb(10);oa=Oc.a.VA(ba,!1);if(0<oa.length){if(!oa[0].hyperlink)return v.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
oa[0].cpBegin,oa[0].cpEnd),8;df.a.Yic(oa[0].hyperlink.url);return 32}Xh.TableCellReader.v3(jb)&&(bi.returnToContainingCell(jb),Xh.TableCellReader.cma(jb)&&(oa=new zc.a,oa.kd(jb),bi.returnToContainingRow(oa),Lj.OutlineReader.aB(jb,ba,!1)&&Cn.a.uYi(oa)&&0>=ba.Fb&&(Ja=ub.a.d8c,bi.returnToContainingTable(jb),Ab.OutlineElementNavigator.ke(jb),M||(M=new ji.DictionaryPropertySet),M.Zg(Bd.a.targetObject,jb.currentNode.id))));jb=this.lli(h,r,b,A,M,Ja)}else Le.a.nba(ba)&&(jb=y.AFrameworkApplication.va.Pf(h,
ub.a.GE,2,!1,A,M));db.a.mark(5014);return jb}ATj(b,h,r){let A=null,M=null,ba=!1;if(1===h)return{returnValue:!1,ne:A,selected:M,Oz:32,P9c:ba};if(!b.view.ue)return{returnValue:!1,ne:A,selected:M,Oz:2,P9c:ba};A=b.view;M=A.lb.Ng;return!M||!Hw.sg.XXi(M,r)||Hw.sg.gma(M,oa=>ba=oa)&&!ba?{returnValue:!1,ne:A,selected:M,Oz:2,P9c:ba}:this.ao&&this.ao.instance&&this.ao.instance.KX(M)?{returnValue:!1,ne:A,selected:M,Oz:4,P9c:ba}:{returnValue:!0,ne:A,selected:M,Oz:2,P9c:ba}}G3o(b,h,r,A,M){let ba,oa;if(!({ne:r,
selected:ba,Oz:oa}=this.ATj(h,r,!0)).returnValue)return oa;const Ja=Hw.Nw.XO(ba);for(let jb=0;jb<Ja.length;++jb){if(!Ja[jb].isValid)continue;const zb=Ja[jb].iterator;zb.yq();if(Lj.OutlineReader.zy(zb))return this.jli(r,zb)}ba.Uw||Le.a.gm(ba)?oa=this.kli(h,r,b,A,M,ub.a.$7c):Le.a.rl(ba)?oa=this.ili(h,r,b,A,M,ub.a.$7c):Le.a.qf(ba)?oa=this.lli(h,r,b,A,M,ub.a.$7c):Le.a.nba(ba)&&(oa=y.AFrameworkApplication.va.Pf(h,ub.a.GE,2,!1,A,M));return oa}jli(b,h){b.lb.Kc(sc.SelectionFactory.vp(h.currentNode,!1));return 32}kli(b,
h,r,A,M,ba){const oa=new Qb.GraphTransaction(15);oa.Ei=r;oa.Ab(h.qd);h=new ji.DictionaryPropertySet;h.setValue(Bd.a.KZc,!0);h=y.AFrameworkApplication.va.Pf(b,ub.a.RJ,2,!0,A,h);32===h&&(h=y.AFrameworkApplication.va.Pf(b,ba,2,!1,A,M));oa.dispose();return h}ili(b,h,r,A,M,ba){const oa=new Qb.GraphTransaction(15);oa.Ei=r;oa.Ab(h.qd);h.lb.Kc(Le.a.yk(h.lb.gb.K(0),!1,!1));b=y.AFrameworkApplication.va.Pf(b,ba,2,!1,A,M);oa.dispose();return b}lli(b,h,r,A,M,ba){const oa=new Qb.GraphTransaction(15,r);oa.Ei=r;
oa.Ab(h.qd);b=y.AFrameworkApplication.va.Pf(b,ba,2,!1,A,M);oa.dispose();return b}static get Nw(){return Object(zl.a)()}static get sg(){return ve.a.instance}static get qc(){return null!=Hw.hWg?Hw.hWg:Hw.hWg=$a.a.instance.Oa(23)}}Object(u.a)(Hw,"AEnterViewStrategy",null,[1634]);class uI extends Hw{constructor(b,h,r){super(b,h,r)}qsm(){return ub.a.GE}}Object(u.a)(uI,"EnterViewStrategy",Hw,[]);class ML{constructor(b){this.Tm=this.transaction=null;this.ne=b;this.aXc=this.jp=0}}Object(u.a)(ML,"SelectAllArguments",
null,[]);class EA{constructor(b,h,r){this.a$n=b;this.IAn=h;this.fp=r;this.y5l=(A,M,ba)=>M.view.jj?this.B8a(M,ba,this.fYj):this.IPo(M,ba);this.iid=(A,M)=>M.jp?1===M.jp?(M.ne.lb.wod(M.Tm,A),M.jp=2,!0):2===M.jp?(M.ne.lb.gb.I7a=M.Tm.I7a,this.rh.BI(),M.transaction.ZNa(A),M.jp=3,M.transaction.dispose(),db.a.mark(5799),!0):!1:(M.transaction=this.fp.Lc(2),M.transaction.Ab(M.ne.qd),M.jp=1,!0);this.IPo=(A,M)=>{if(1===M)return 32;if(!A.view.ue)return 2;A=A.view;return A.lb&&A.lb.gb&&A.lb.gb.currentSelection?
this.fYj(A).Pfa?1:32:8};this.fYj=A=>{A.jj&&v.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");A=new ft.a(null,this.gko,new ML(A));A.sm("SelectAllInOutline");A.run();return A};this.gko=(A,M)=>{if(!M.jp)return M.Tm=sc.SelectionFactory.JPo(M.ne.lb.gb.currentSelection),M.transaction=this.fp.Lc(2),M.transaction.Ab(M.ne.qd),M.jp=1,!0;if(1===M.jp){if(!M.aXc)return M.ne.lb.Kc(M.Tm.K(0),A),++M.aXc,!0;if(M.aXc<M.Tm.length)return M.ne.lb.q_k(M.Tm.K(M.aXc),A),++M.aXc,!0;M.jp=2}return 2===M.jp?
(M.ne.lb.gb.I7a=M.Tm.I7a,this.rh.BI(),M.transaction.ZNa(A),M.jp=3,M.transaction.dispose(),!0):!1}}get rh(){return this.IAn.value}Wb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.pEa,xe.a.frame,EA.xUj);b.qa(ub.a.PBg,xe.a.frame,EA.xUj);b.fb(ub.a.B8a,mc.a.view,this.y5l,2);b.fb(ub.a.h6a,mc.a.view,pd.AFrame.Ug,100);b.fb(ub.a.Y9f,mc.a.view,EA.Y9f,4)}B8a(b,h,r){if(1===h)return 32;if(!b.view.ue)return 2;h=b.view;if(!h.lb)return 8;const A=h.lb.gb;if(!A||!A.length)return 8;db.a.mark(5798);qa.StaticActiveAppFrame.za().kb.isEditingAllowed||
qa.StaticActiveAppFrame.za().kb.bA||h.jj?b=Le.a.hMf(A):(rd.FocusManager.instance().aF(pd.AFrame.Jo),b=sc.SelectionFactory.YKj(h.qd));if(!b)return 8;A.I7a||v.ULS.sendTraceTag(39098305,324,50,"Progress selection start");r&&this.a$n.FTb(Le.a.Jwi(b))?r=r(h):(r=new ML(h),r.Tm=b,r=new ft.a(null,this.iid,r),r.sm("ExpandSelection"),r.run());return r.Pfa?1:32}static get ceb(){return null!=EA.R3g?EA.R3g:EA.R3g=$a.a.instance.resolve(123)}static Y9f(b,h,r){if(1===r)return 32;if(!h.view.ue)return 8;b=h.view;h=
sc.SelectionFactory.vp(b.root.graphNode,!0);if(!h)return 8;b.lb.Kc(h);return 32}static xUj(){var b=qa.StaticActiveAppFrame.za().kb.Fw;if(!b.ue)return 2;if(b.ue&&1!==qa.StaticActiveAppFrame.za().state){db.a.mark(4668);var h=b.lb.gb.currentSelection;if(!h&&y.AFrameworkApplication.J.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=Le.a.dra(h);let r=h.x,A=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)r=b.x,A=b.y;
EA.ceb.pEa(new Sys.UI.Point(r,A),1);db.a.mark(4669)}return 32}}Object(u.a)(EA,"SelectAllHandlers",null,[1610]);class NM{uxe(){}}Object(u.a)(NM,"FontNameFormattingStrategyNoop",null,[1618]);var qO=d(1034);class FA{constructor(b,h,r,A,M,ba){this.AWh=this.DWh=null;this.ft=b;this.zWh=h;this.Kel=r;this.Tel=A;this.DWh=M;this.AWh=ba}}Object(u.a)(FA,"BookmarkHighlightContext",null,[]);class vI extends Eq.a{constructor(){super()}get Mfa(){return!0}get csb(){return 5}get z$a(){if(null!=this.I5)return this.I5;
this.I5=[];this.I5.push(new fq.a(Np.a.HTd,Np.a.HTd));this.I5.push(new fq.a(Np.a.dlf,Np.a.dlf));this.I5.push(new fq.a(Np.a.pUc,Np.a.pUc));return this.I5}RMa(b,h){this.Mfa&&vp.a.instance.ee(()=>{const r=this.As.iJa;var A=this.As.cbd;if(r)if(5===r.type){A=r.fC;if(r.jM&&r.jM.ft.includes(b))for(const M of h.pNa("*"))this.As.XZa(M);A&&A.ft.includes(b)&&this.yyb(h,r.action,A,b)}else A&&5===A.type&&3===r.action&&A.fC.ft.includes(b)&&this.yyb(h,0,A.fC,b)},"BHA:OPHC")}NXa(b){return Object(Za.a)(FA,b)}S9a(b,
h){if(b)for(const r of b.ft)h.add(r)}yyb(b,h,r,A){0===h&&b.htmlElement&&vp.a.instance.ee(()=>{const M=b.pNa("*"),ba=M.length,oa=Np.a.HTd;var Ja=A.id===r.DWh,jb=A.id===r.AWh;let zb=!1;var Eb=0,Sb=[];const nc=Array(ba);for(let Gd=0;Gd<ba;Gd++){var Dc=M[Gd];const de=as.a(Dc);nc[Gd]=de;const he=Dc.classList;if(0!=nc[Gd]){const fe=!he.contains(Np.a.uI),Yd=Tj.a.Eb(Dc,Np.a.XKb);Yd&&Sb.push(...Yd);if(Ja){let Td;if((Td=Tj.a.Eb(Dc,Np.a.JTd))&&Yd&&1===Td.length&&1===Yd.length&&Td[0].equals(Yd[0]))continue;Td&&
(Eb+=Td.length,1===de?he.add(Np.a.dlf):he.add(oa));if(Yd)for(const wf of Yd)this.dde(r,wf)&&(Eb--,zb&&he.add(Np.a.pUc));0!==Eb&&fe&&he.add(oa)}if(!Ja&&!jb&&r.Tel.has(A.id))if((Dc=Tj.a.Eb(Dc,Np.a.XKb))&&zb){he.add(oa);for(const Td of Dc)if(this.dde(r,Td)){he.add(Np.a.pUc);break}}else fe&&he.add(oa)}zb=!he.contains(Np.a.p8a)}if(jb&&!Ja){Ja=new Set;for(var Zc of Sb)this.dde(r,Zc)&&Ja.add(Zc);zb=!1;for(Sb=0;0!==Ja.size&&Sb<ba;Sb++){Eb=M[Sb];Zc=Eb.classList;if(0!=nc[Sb])if(jb=!1,Eb=Tj.a.Eb(Eb,Np.a.XKb)){for(const Gd of Eb)this.dde(r,
Gd)&&(Ja.delete(Gd),jb=!0);0!==Ja.size&&Zc.add(oa);zb&&jb&&Zc.add(Np.a.pUc)}else Zc.contains(Np.a.uI)||Zc.add(oa);zb=!Zc.contains(Np.a.p8a)}}},"BHA:SPH")}dde(b,h){for(const r of b.Kel)if(h.equals(r))return!0;return!1}}Object(u.a)(vI,"BookmarkHighlightActor",Eq.a,[571]);var kG=d(1898),wI;(function(b){b[b.u8p=0]="jsonToDocumentXml";b[b.QYl=1]="documentXmlToJson";b[b.RYl=2]="documentXmlToThemeJson";b[b.Vrq=3]="unsupported"})(wI||(wI={}));Object(u.b)("GraphicsEditorConversionRequestType",wI);var OM=d(1631);
class NL{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){this.Gf=b;this.FG=h;this.hb=M;this.VY=ba;this.Ik=oa;this.Zd=Ja;this.Cd=zb;this.Ga=jb}ayg(b,h,r,A){const M=b.bMh(h);if(M){var ba=Object(Za.a)(OM.a,b),oa=this.Zd.Xf("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",ba,r)),Ja=h.Ok.node,jb=()=>{r||this.cBo(h.Ok,M.getId())};ba=NL.PXh();A=this.mYh(M.getId().toString(),Ja,A,r);try{b.oSh(A,h)}catch(zb){v.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+
zb.message);this.vq(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.Gf.Xj(ba,2,A.toString(),{},!0,0,zb=>{v.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.btc(zb,M,()=>{this.vq(b.K8d())},jb,Ja,h,oa)},zb=>{const Eb=415===zb.data.He;let Sb="";zb&&zb.data&&zb.data.wi&&"X-CorrelationId"in zb.data.wi&&zb.data.wi["X-CorrelationId"]&&(Sb=zb.data.wi["X-CorrelationId"]);b.hV(`Graphics editor request failed. HttpStatus [${zb.data.He}], ResponseData [${zb.data.Ee}], CorrelationId [${Sb}]`,
M,Ja,jb,()=>{this.vq(Eb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.K8d())},oa,Eb)},null)}else this.vq(b.K8d())}pRo(b,h,r){return new Promise((A,M)=>{var ba=b.Ok,oa=null;oa=hl.a.B_f(ba)?ba.getContext(0).node:ba.node;ba=NL.PXh();oa=this.mYh(h.toString(),oa,r,!1);oa.Ae(kG.a.nsf,wI.RYl.toString());this.Gf.Xj(ba,2,oa.toString(),{},!0,0,Ja=>{v.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");A(Ja.data.Ee)},
Ja=>{v.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Ja.data.He}, ResponseData ${Ja.data.Ee}`);this.vq(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);M(null)},null)})}mYh(b,h,r,A){const M=h.Lj(),ba=new gb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");y.AFrameworkApplication.Oja(ba);ba.Ae(kG.a.jBe,this.qnn(h)?"true":"false");ba.Ae(uj.a.nodeId,b);ba.Ae(uj.a.cellId,M.kl.toString());ba.Ae(uj.a.fileId,
M.Fq);ba.Ae(uj.a.s_,r.toString());ba.Ae(kG.a.i5l,A?"true":"false");if(b=!!this.Cd&&this.Cd.isFeatureEnabled(42)){ba.Ae(ui.a.Etj,b.toString());if(b=this.Cd.isFeatureEnabled(82))ba.Ae(ui.a.ydo,b.toString()),ba.Ae(ui.a.g5m,"true");this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&ba.Ae(ui.a.Ido,"true")}ba.Ae(ui.a.MVh,"true");Wm.a.instance.nKb(ba);return ba}qnn(b){if(!this.FG)return!1;b=this.FG.Nu(b);return!!b&&b.wf(Rc.a.p1f)}cBo(b,h){b.cpBegin===b.cpEnd-1&&this.Ik.Avc(b.node,
h,this.hb,this.VY)}vq(b){const h=new kh.StandardDialog;h.Ed=0;h.Iy(se.a.szf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);qa.StaticActiveAppFrame.za().Fe()}static PXh(){const b=new gb.QueryStringBuilder("WordGraphicsEditorHandler.ashx");y.AFrameworkApplication.Oja(b);return b.toString()}}Object(u.a)(NL,"GraphicsEditorRequestManager",null,[569]);class wO extends my{constructor(b,h,r){super(b,h,r);this.UWa=ub.a.XR}T$a(b){null!=
b&&0<b.length&&this.Qb.Pb(this.UWa,2,b[0])}Fek(b,h,r,A){const M=Ag.a.Hg(y.AFrameworkApplication.lcid).name;b=String.format(b,y.AFrameworkApplication.lcid,M,y.AFrameworkApplication.buildVersion,h,px.cJe,r);b+="&flipgrid=1&ted=1";y.AFrameworkApplication.nd("wwa11yq3;wwa11yq3cf");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.OnlineMediaAccessibilityChangesEnabled",!1)&&(b+="&resize_picker=1");A&&this.E2i()&&(A=new gb.QueryStringBuilder(b),A.gL("stream2","1"),y.AFrameworkApplication.J.$("GetCustomHeaderEnabled")&&
A.gL("enablegetcustomheader","1"),b=A.toString());return b}E2i(){y.AFrameworkApplication.nd("EnableStream2VideosInsertion;EnableStream2VideosInsertioncf");y.AFrameworkApplication.nd("EnableStream2Videos;EnableStream2Videoscf");return y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2VideosInsertion",!1)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)?!0:!1}}Object(u.a)(wO,"InsertHubbleMediaHelper",
my,[]);class PM{constructor(b,h,r,A,M,ba,oa,Ja,jb){this.xFd=!1;this.ga=b;this.Ga=h;this.ODd=r;this.M1=A;this.YAd=M;this.Al=ba;this.opk=Ja;this.vok=oa;this.tl=jb;this.M1.E2i()&&oa.isFeatureEnabled("OmgStreamTwo",!1).then(zb=>{this.xFd=zb;this.xFd||(this.EGh=oa.Yua("OmgStreamTwo",Eb=>{this.xFd=Eb.isEnabled}))})}dispose(){this.EGh&&this.vok.CZb("OmgStreamTwo",this.EGh)}Wb(){const b=this.f8n.bind(this);this.ga.fb(Hc.a.sig,mc.a.Vc,b,1028);const h=this.mcn.bind(this);this.ga.fb(Hc.a.hWf,mc.a.Vc,h,1028);
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoFromRibbonIfDisabled",!1)&&(this.j4(Hc.a.sig,b),this.j4(Hc.a.hWf,h))}j4(b,h){this.ga.j4("word_insertOnlineVideos",!0,b,mc.a.Vc,h,r=>{qa.StaticActiveAppFrame.za()&&this.tl&&qa.StaticActiveAppFrame.za().I2b(r,this.tl.Mqb)})}mcn(b,h,r,A,M){if(1!==r){if(null==M)return 16;if(!h.Cl||!Le.a.qf(h))return 2;b=this.bsm(M);M=M.OriginalUrl;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.YAd.gRg(b,h,M)}return 32}Vkk(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=$a.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}bsm(b){const h=new IB;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}f8n(b,h,r){var A,M;if(1!==r)h=C.a.XT(this.Ga.jb("UserId")).toString(),
h=this.M1.Fek(this.Ga.appSettings.InsertVideoHubbleEndpoint,hb.a.create().toString(),h,this.xFd),this.M1.UWa=Hc.a.hWf,h=this.ODd.J3c(h,!0),h.correlationId=hb.a.create(),h.iua=5,h.Hze(null,this.M1,this.opk),ca.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new fa.a,{name:"ActionId",int64:b})]})),this.Vkk();else if(!(h&&h.node&&uF.a(h.node))||(null===(A=this.Al)||void 0===A?0:A.F2(h))||(null===(M=this.Al)||void 0===M?0:M.gma(h)))return 2;
return 32}}Object(u.a)(PM,"OnlineMediaActor",null,[]);const wM={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};
class GA extends MB{constructor(b,h,r,A=null,M=!1){super(b,h,r,A,M);this.MIc=null;this.wfg=()=>{this.Hz&&(v.ULS.sendTraceTag(509092503,352,50,`onGetCustomHeaders : Token available: ${!!GA.AHa} time: ${(new Date).getTime()-this.ki}`),this.Hz.sendMessage(K.a.TNj,{["CustomHeaders"]:GA.AHa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}k2c(){const b={};b.insertMediaServiceEndpoint=this.PDd;b.iFrameId="mediaiframe";return b}async Hze(b,h,r){r&&(this.ki=(new Date).getTime(),
Date.now()>GA.sIh&&await this.refreshToken(r));this.v6b=b;this.MIc=h;this.EHc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.k2c(),["componentIsVisibleCallback"]:this.Nik.bind(this)};this.gi(this.v6b,null,b)}Nik(){this.H3=this.bkc(this.Ej("mediaiframe"));let b=this.PDd;if(y.AFrameworkApplication.J.$("NewInsertMediaServiceEndpoint")){const h=new URL(b),r=wM[h.protocol+"//"+h.host];r?b=r:v.ULS.sendTraceTag(508937025,352,10,`Target URL: ${h.host} not found`)}this.Hz=this.LJd.getInstance(this.H3.contentWindow,
b);this.Hz.Yr(K.a.HNh,h=>{this.ljj(h,this.MIc.T$a.bind(this.MIc))});this.Hz.Yr(K.a.insert,h=>{this.Wme(h,this.MIc.T$a.bind(this.MIc))});this.Hz.Yr(K.a.dOh,this.Bmj.bind(this));this.Hz.Yr(K.a.Lwi,this.wfg.bind(this));this.Hz.Yr(K.a.getSessionId,this.qlj.bind(this));this.Hz.Yr(K.a.tui,this.plj.bind(this));this.Hz.Yr(K.a.IUd,this.Yjj.bind(this));this.fyb(3)}fyb(b){const h=[];h.push(Object.assign(new fa.a,{name:"DialogResult",string:rD[b]}));h.push(Object.assign(new fa.a,{name:"DialogMode",string:this.bCi()}));
h.push(Object.assign(new fa.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new fa.a,{name:"Provider",string:hz[this.iua]||"Unknown"}));ca.a.sendTelemetryEvent(Object.assign(new ja.a,{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){try{const h=await b.GV("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");h.IsSuccess&&(GA.sIh=h.Telemetry.expiresOn?1E3*(h.Telemetry.expiresOn-10):0,GA.AHa=h.Token);v.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!GA.AHa} time: ${(new Date).getTime()-
this.ki}`)}catch(h){v.ULS.sendTraceTag(508954306,352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-this.ki} error: ${h} `)}}}GA.sIh=0;Object(u.a)(GA,"OnlineMediaDialog",MB,[]);class QM{constructor(b,h){this.eWe=b;this.M1=h}J3c(b,h=!1){return new GA(b,this.eWe,this.M1,null,h)}getInstance(){throw Error.notImplemented();}}Object(u.a)(QM,"OnlineMediaDialogFactory",null,[570]);class RM extends Ey{constructor(){super(1,3);this.pO=$a.a.instance.resolve(731);
this.E0j=!1}Ieb(){y.AFrameworkApplication.va.Ob(Hc.a.hyc,2)}u1d(){this.Hpi&&!this.Dw&&(this.Dw=this.cRa())}f2d(){if(this.Dw&&this.Dw.isVisible){var b=Object(Ma.a)(Hl.a,this.Dw.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.oy(b.Sqb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)v.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&
h.bottom<window.innerHeight&&(h=b.getAttribute(Pe.a.WSd)||"",Pe.a.WO===h&&b.click())}}t3(){return this.pO.t3}}Object(u.a)(RM,"ExternalContentFloatieManager",Ey,[]);class gr{constructor(){gr.g$m()}get Xb(){return null!=this.t7g?this.t7g:this.t7g=$a.a.instance.resolve(8)}get key(){return"FORMATTING_PARAGRAPH"}get Jv(){return null}s2b(b){var h=null;if(!Ed.ParagraphReader.Eh(b))return{returnValue:!1,Sea:h};if((b=this.Xb.Hq(b.currentNode))&&2===this.Xb.NF(b)){const r=this.Xb.Be(b);gr.GT.contains(r)&&(h=
this.Xb.LL(b),h=Object.assign(new OA.a,{fG:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,Sea:h}}Oqb(b,h){let r=null;h&&b.contentId.equals(h.contentId)||(r=b.contentObject);return r}static g$m(){gr.GT=new Xo.a;gr.GT.add(Jl.StyleReader.styleIdHeading1);gr.GT.add(Jl.StyleReader.styleIdHeading2);gr.GT.add(Jl.StyleReader.styleIdHeading3);gr.GT.add(Jl.StyleReader.q1b);gr.GT.add(Jl.StyleReader.Iqd);gr.GT.add(Jl.StyleReader.Jqd);gr.GT.add(Jl.StyleReader.nBe);gr.GT.add(Jl.StyleReader.mBe);
gr.GT.add(Jl.StyleReader.wordStyleIdHeading1);gr.GT.add(Jl.StyleReader.wordStyleIdHeading2);gr.GT.add(Jl.StyleReader.wordStyleIdHeading3);gr.GT.add(Jl.StyleReader.UBc);gr.GT.add(Jl.StyleReader.VBc);gr.GT.add(Jl.StyleReader.WBc);gr.GT.add(Jl.StyleReader.Eud);gr.GT.add(Jl.StyleReader.Fud);gr.GT.add(Jl.StyleReader.Gud);gr.GT.add(Jl.StyleReader.$Ab);gr.GT.add(Jl.StyleReader.Hud)}}gr.GT=null;Object(u.a)(gr,"ParagraphStyleDetailsProvider",null,[135,136]);class SM{constructor(b,h,r,A){this.hRa=b;this.eEk=
h;this.nEk=r;this.oEk=A}jrg(){this.hRa.execute(b=>{b.uZb(this.eEk.value);b.uZb(new gr);b.uZb(this.oEk.value);b.nY(this.nEk.value)})}}Object(u.a)(SM,"AccessibilityActor",null,[]);class TM{constructor(b,h,r){this.Ai=null;this.wpd=(A,M,ba)=>{if(1===ba)return 32;this.Ai=this.DGc.value.oEl(this.Zb);if(!this.Ai)return v.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.Ai.U_a();return 32};this.FLh=A=>this.Ai?this.Ai.HYm(A):2;this.ga=b;this.DGc=h;this.Zb=r}Wb(){if(y.AFrameworkApplication.J.$("UIDiscoverabilityEnabled")){var b=
kc.KeyInputManager.lc(rf.a.mBb,5);this.Zb.ie(pd.AFrame.Jo).qt(b);this.Zb.ie(pd.AFrame.Kq).bindAction(b,La.a.wpd);this.ga.qa(La.a.wpd,xe.a.frame,this.wpd);this.ga.qa(La.a.kSc,xe.a.frame,this.FLh);this.ga.qa(La.a.jSc,xe.a.frame,this.FLh)}}}Object(u.a)(TM,"AccessibilityHelpDialogActor",null,[]);var UM=d(1033),XB=d(1286);class TF{constructor(b,h){this.Syk=b.fc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.fnk=UM.a.jH(26,5,new XB.a)}J0(){this.ga.J0(this)}j8(){}h8(b){const h=+b.endTime-+b.startTime;
if(h>this.Syk){let r="";switch(b.behavior){case 1:r="E";break;case 2:r="X";break;case 3:r="A"}(b=kd.ActionManager.qea(b.actionId))&&b.length||(b="UnknownAction");this.fnk.track(h,b+"_"+r)}}}Object(u.a)(TF,"ActionHangDetector",null,[170]);var YB=d(2164);class VM extends Ic{constructor(b,h=null){super(b,void 0,y.AFrameworkApplication.Y7a,new Mb(b,!1),void 0,void 0,h)}get Ubb(){return this.Ode?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get Kqc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get Mbd(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get nYc(){return y.AFrameworkApplication.Y7a?
"UIFontDialogTextLarge":null}get Ode(){return"VersionHistory"===this.g_h?!1:!y.AFrameworkApplication.ta.Hb.isBusinessUser&&!y.AFrameworkApplication.ta.Hb.isEduUser}qie(){v.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}t6f(){v.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}kcd(){v.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");y.AFrameworkApplication.va.Ob(La.a.gii,2)}}Object(u.a)(VM,"DownloadACopyDialog",Ic,[]);var EK;(function(b){b[b.Unknown=
0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.$Rp=7]="Publisher";b[b.pQp=8]="Infopath";b[b.zNp=9]="Access"})(EK||(EK={}));Object(u.b)("OfficeApplication",EK);var FK;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.uUp=2]="WriteOnly";b[b.QPp=3]="ForceCheckout";b[b.tUp=4]="WriteLocalCopy";b[b.zRp=5]="OpenInBrowser"})(FK||(FK={}));Object(u.b)("OpenDocumentMode",FK);
class WM extends ug.a{constructor(){super(!1,!1,!0)}Doe(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};
h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.gi("Send feedback to Microsoft",this.bZo.bind(this),b);return new Promise(r=>{this.hHk=r})}bZo(b,h){1===b&&this.Pha(h.selectedReason)}dispose(){super.dispose();this.hHk()}Pha(b){const h={},r={},A={},M={},ba={};h.appId=2155;h.manifestType="Fps";
h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=hb.a.create().toString();ba.reason=b;const oa={},Ja={numberOfOptions:5};Ja.selectedRating=b;oa.rating=[Ja];M.surveySpecificData=JSON.stringify(oa);A.extendedManifestData=JSON.stringify(M);h.application=A;ba.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=ba;h.telemetry=this.tLb();h.web=this.DUc();r["Content-Type"]="application/json";this.sNa(JSON.stringify(h),r)}rea(b,h,r,A){h&&b&&A&&r&&A in h&&(b[r]=
h[A])}tLb(){const b=y.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=y.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.rea(h,b,"audienceGroup","AudienceGroup");this.rea(h,b,"osBuild","OsVersion");this.rea(h,b,"platform","Platform");this.rea(h,b,"processSessionId","WACSessionID");return h}DUc(){const b=y.AFrameworkApplication.sessionStartInfoSettings,h={};this.rea(h,b,"browser","Browser");this.rea(h,b,"browserVersion","BrowserVersion");this.rea(h,b,"dataCenter",
"WACDatacenter");return h}sNa(b,h,r=0){let A=0;3<r||(1===r?A=200:1<r&&(A=200+500*(r-1)),y.AFrameworkApplication.oc.Yb(new wc.a(2,1,A,()=>{y.AFrameworkApplication.Ge.Xj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{v.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.sNa(b,h,r+1);v.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",r)},null)})))}}Object(u.a)(WM,"WordOpenInClientFeedbackDialog",
ug.a,[]);var ZB=d(1345),XM=d(2159);const LD=b=>{for(let h=0;h<b.children.length;h++){const r=b.children[h];r.style.position="relative";r.style.top=(r.parentNode.offsetHeight-r.offsetHeight)/2+"px"}},GK=b=>b.Nb.keyCode===rf.a.Tu||b.Nb.keyCode===rf.a.W0a?(b.Ef.click(),!0):!1,UF=(b,h,r,A,M,ba,oa)=>{const Ja=document.createElement("a");Ja.className="ProtocolLaunchingDialogButtonAnchor";Ja.className+=" OICDialog";Ja.id=b;Ja.setAttribute(Pe.a.Sh,Pe.a.X$);Ja.style.padding="0";Ja.style.margin="0";A&&YM(M,
h,r,A,Ja);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=M;Ja.appendChild(b);Ja.tabIndex=0;ba&&Nc.a.instance.nb(zd.a.click,Ja,ba);oa&&kc.KeyInputManager.instance.nb(zd.a.hi,Ja,oa);return Ja},YM=(b,h,r,A,M)=>{var ba=document.createElement("img");ba.alt=b;ba.className=ag.getImageClassWithCluster(r,A);ba.src=h;ba.setAttribute(Pe.a.Sh,Pe.a.FA);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(ba);ba=document.createElement("span");
ba.className="ProtocolLaunchingDialogIconContainer";ba.appendChild(b);M.appendChild(ba)};class HK{static get lh(){return ug.a.ry(HK.Qn,CommonUIStrings.l_OICLaunchDialogTitle)}}HK.Qn="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(u.a)(HK,"OICLaunchDialogHtml",null,[]);class ZM extends ug.a{constructor(b){super();this.T4b=this.$Bb=null;this.cW=!1;this.Pnj=()=>{this.hide();this.Do.Vvc();return!0};this.Vnj=()=>{v.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();y.AFrameworkApplication.va.Ob(La.a.b_b,2);return!0};this.oWn=()=>{this.Do.Vvc()};this.Do=b;this.lh=HK.lh;this.Ed=5;this.Pg="OICLaunchDialog";this.showDialog("",this.oWn);this.VOj();this.H8("ProtocolLaunchingDialogTitle");4!==y.AFrameworkApplication.ta.Hb.cVa&&
(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.q4(this.$Bb);v.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Pba(){this.$Bb=UF("BtnRichClient",this.Do.jhc,this.Do.Mmc,this.Do.DUf,CommonUIStrings.l_OICLaunchRichClient,this.Vnj,GK);document.getElementById("OICLaunchRichClient").appendChild(this.$Bb);LD(this.$Bb);this.T4b=UF("BtnReturn",this.Do.jhc,
this.Do.Mmc,this.Do.vQi,CommonUIStrings.l_OICReturnToOnlineClient,this.Pnj,GK);document.getElementById("OICReturnToApp").appendChild(this.T4b);LD(this.T4b)}dispose(){this.cW||(this.$Bb&&(Nc.a.instance.xc(zd.a.click,this.$Bb,this.Vnj),kc.KeyInputManager.instance.xc(zd.a.hi,this.$Bb,GK)),this.T4b&&(Nc.a.instance.xc(zd.a.click,this.T4b,this.Pnj),kc.KeyInputManager.instance.xc(zd.a.hi,this.T4b,GK)),super.dispose(),this.cW=!0)}}Object(u.a)(ZM,"OICLaunchDialog",ug.a,[]);class VF{static get lh(){return 0!==
y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.Excel.PromoteOpenInDesktop",0)?ug.a.ry(VF.tUl,CommonUIStrings.l_OICDialogTitle):ug.a.ry(VF.Qn,CommonUIStrings.l_OICDialogTitle)}}VF.Qn="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
VF.tUl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'></div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonDownloadClientApp'> <div id='ProtocolHandlerDialogDownloadClientApp' class='UIFontDialogButton WACGlyph'></div> </div> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br /> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(u.a)(VF,"ProtocolLaunchingDialogV2Html",null,[]);class xO extends ug.a{constructor(b){super();this.R4b=this.S4b=this.z1a=null;this.cW=!1;this.hhb=null;this.$kj=h=>this.bme(h,0);this.Qkj=h=>this.bme(h,3);this.slj=h=>this.bme(h,2);this.Onj=h=>this.bme(h,1);this.Xkj=()=>{this.hide();4===y.AFrameworkApplication.ta.Hb.cVa?(v.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Do.Vvc()):(v.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Do.G5c());
return!0};this.Pkj=()=>{v.ULS.sendTraceTag(0,211,50,"Open download client app page");return!0};this.Ime=()=>{v.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0};this.Hne=()=>{v.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";y.AFrameworkApplication.va.Ob(La.a.b_b,2);return!0};this.cog=()=>{this.Do.Vvc()};this.Do=b;this.lh=VF.lh;this.Ed=5;this.Pg="ProtocolLaunchingDialog";this.dGc="OICRetryDialog";y.AFrameworkApplication.oc.Vrb&&
y.AFrameworkApplication.oc.restart();y.AFrameworkApplication.oc.Yb(new wc.a(2,1,5E3,()=>{this.qip()},101));this.showDialog("",this.cog);this.VOj();this.H8("Issues");this.$pi();v.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Pba(){const b=document.getElementById("Issues");if(b){YM("",this.Do.jhc,this.Do.Mmc,this.Do.DUf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.Do.Opj?
CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);LD(b);b.style.display="none"}0!==y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.Excel.PromoteOpenInDesktop",0)&&(this.R4b=UF("DownloadClientApp",this.Do.jhc,this.Do.Mmc,"",CommonUIStrings.l_OICDialogSectionDownloadClientApp,this.Pkj,this.Qkj),document.getElementById("ProtocolHandlerDialogDownloadClientApp").appendChild(this.R4b),LD(this.R4b));y.AFrameworkApplication.ta.Hb.bLi?(this.S4b=
UF("GiveFeedback",this.Do.jhc,this.Do.Mmc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,this.Ime,this.slj),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.S4b),LD(this.S4b)):document.getElementById("ButtonGiveFeedback").style.display="none";0===y.AFrameworkApplication.ta.Hb.cVa||y.AFrameworkApplication.sVl?document.getElementById("ButtonEdit").style.display="none":(this.z1a=UF("Edit",this.Do.jhc,this.Do.Mmc,"",2===y.AFrameworkApplication.ta.Hb.Uk?4===y.AFrameworkApplication.ta.Hb.cVa?
CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===y.AFrameworkApplication.ta.Hb.cVa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,this.Xkj,this.$kj),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.z1a),LD(this.z1a));0===y.AFrameworkApplication.ta.Hb.cVa&&!y.AFrameworkApplication.P_f&&b&&(b.style.display="none")}aqi(){return this.hhb?(this.q4(this.hhb),!0):!1}$pi(){return this.z1a?(this.q4(this.z1a),!0):!1}bme(b,
h){let r=!1;if(b.Nb.keyCode===rf.a.Tu||b.Nb.keyCode===rf.a.W0a)b.Ef.click(),r=!0;else if(b.Nb.keyCode===Sys.UI.Key.down||b.Nb.keyCode===Sys.UI.Key.up)switch(h){case 1:r=this.$pi();break;case 0:r=this.aqi()}return r}bgg(){Ln.Redirect.showHelp("OICFailure");return!0}qip(){var b=document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!b.children.length&&(this.hhb=UF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,this.Hne,this.Onj),b.appendChild(this.hhb),LD(this.hhb),this.z1a||this.aqi())}}dispose(){this.cW||(this.z1a&&(Nc.a.instance.xc(zd.a.click,this.z1a,this.Xkj),kc.KeyInputManager.instance.xc(zd.a.hi,this.z1a,this.$kj)),this.R4b&&(Nc.a.instance.xc(zd.a.click,this.R4b,this.Pkj),kc.KeyInputManager.instance.xc(zd.a.hi,this.R4b,this.Qkj)),this.S4b&&(Nc.a.instance.xc(zd.a.click,this.S4b,this.Ime),kc.KeyInputManager.instance.xc(zd.a.hi,
this.S4b,this.slj)),this.hhb&&(Nc.a.instance.xc(zd.a.click,this.hhb,this.Hne),kc.KeyInputManager.instance.xc(zd.a.hi,this.hhb,this.Onj)),super.dispose(),this.cW=!0)}}Object(u.a)(xO,"ProtocolLaunchingDialog",ug.a,[]);class IK extends kh.StandardDialog{constructor(b){super();this.Ime=h=>{v.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.elj(h)};this.Hne=()=>{v.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");y.AFrameworkApplication.va.Ob(La.a.b_b,2)};this.cog=h=>{IK.lNi?3===
h?this.PHj():2===h||0===h?this.G7h():1===h&&this.ffc():2===h?this.PHj():(1===h||0===h)&&this.G7h()};this.Do=b;this.Pg="ProtocolLaunchingDialog";y.AFrameworkApplication.oc.Vrb&&y.AFrameworkApplication.oc.restart();y.AFrameworkApplication.ta.Hb.bLi&&this.tXk(this.Ime);IK.lNi?(this.Ed=12,this.Qe(1,CommonUIStrings.l_CloseFile),this.Qe(2,CommonUIStrings.l_OICDialogContinueHere),this.Qe(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Ed=4,this.Qe(1,CommonUIStrings.l_OICDialogContinueHere),this.Qe(2,CommonUIStrings.l_OICDialogLaunchAgain));
this.evb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Do.Opj?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,this.cog,null)}ffc(){v.ULS.sendTraceTag(577783557,211,50,"Closing the document");y.AFrameworkApplication.va.Pb(La.a.close,2,Yk.a)}PHj(){v.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(this.Hne,0)}G7h(){4===y.AFrameworkApplication.ta.Hb.cVa||y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&
1===y.AFrameworkApplication.ta.mode?(v.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Do.Vvc()):(v.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Do.G5c())}static get lNi(){return y.AFrameworkApplication.J.$("OICDialogThreeActions")&&32===y.AFrameworkApplication.va.Ob(La.a.close,1)}}Object(u.a)(IK,"StandardProtocolLaunchingDialog",kh.StandardDialog,[]);class $M{}Object(u.a)($M,"EditDocumentInClientParams",null,[]);class OL{static Dii(b,h,r,
A,M,ba,oa=!1,Ja=!1,jb="",zb=!1,Eb=!1,Sb=!1,nc="",Dc="",Zc="",Gd=""){const de=new $M;de.DocumentUrl=b;de.DocumentExtension=Gd;de.Mode=h;de.Options=r;de.Application=A;de.SilentExternalHandler=oa;de.EncodeUrl=Ja;de.CorrelationIdForWinClient=jb;de.NavigateUsingWindowOpen=zb;de.DescriptiveUnattemptedEnums=Eb;de.NoBrowserModalDialogs=Sb;de.SessionOrigin=nc;de.CorrelationId=Dc;de.ClickTime=Zc;MSOJS.ClientUtils.EditDocumentInClient(de,M,ba)}}Object(u.a)(OL,"ClientUtils",null,[]);var xM=d(548),PL=d(941);class zx{constructor(b){this.m4a=
this.$Gc=this.ZEc=null;this.hIc=!1;this.uQe=this.h0e=this.Kwh=null;this.Sxd=this.rA=this.pMd="";this.application=this.QC=0;this.Zhp=this.MGg=!1;this.yKo=(h,r,A)=>r.contextId!==xe.a.frame?2:1===A?32:this.b_b();this.Wij=()=>{this.Ipf()};this.Xij=()=>{this.Vvc()};this.Tlj=()=>{this.t6i()};this.L4m=()=>this.hgi(!0);this.JEp=b&&y.AFrameworkApplication.J.$("OICLaunchDialogIsEnabled");y.AFrameworkApplication.va.V2(La.a.b_b)||y.AFrameworkApplication.va.qa(La.a.b_b,xe.a.frame,this.yKo);this.bWj=!!y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.$("SilentExternalHandler")}get Opj(){return this.QC}V0o(b,h="",r=""){this.rA=r||hb.a.create().toString();this.pMd=h||xM.a.WCi();this.Sxd=b}get options(){let b=0;y.AFrameworkApplication.FHo&&(b|=1);y.AFrameworkApplication.Wpj&&(b|=4);this.Thp()&&(b|=64);return b}Thp(){return!(2===this.application&&y.AFrameworkApplication.J.$("IsEmbeddedScenario"))}get jhc(){return y.AFrameworkApplication.Vs}get Mmc(){return y.AFrameworkApplication.Nfa}get vQi(){return""}get DUf(){return""}get Yhp(){return y.AFrameworkApplication.J.$("OneNoteMobileViewerIsEnabled")}get Nlp(){return this.Kwh||
(this.Kwh=$a.a.instance.resolve(120))}Ipf(){this.MGg||this.A4l()}Vvc(){this.Zhp||this.hmi()}pzj(b){return this.JEp&&X.a.Di?(new ZM(this),32):this.E5h(b)}E5h(b){const h=({mAb:b}=this.Lzn(b)).returnValue;v.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}Dc(b,h,r,A,M,ba,oa=""){this.ZEc=b;this.uQe=oa;this.$Gc=h;this.m4a=ba;this.application=r;this.QC=A;return y.AFrameworkApplication.nii?(this.t6i(),32):y.AFrameworkApplication.Vta&&!y.AFrameworkApplication.iPi?(y.AFrameworkApplication.WDg(),
8):this.WVh(M)}get nWn(){return!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}b_b(){this.nWn&&this.CEn();return this.E5h(this.hIc)}iMj(){const b=new PL.a(K.a.bY);b.Values["ui-language"]=y.AFrameworkApplication.lcid.toString();b.Values[dv.a.hci]=y.AFrameworkApplication.userSessionId;return this.m4a.value.send(b)?32:8}CEn(){za.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],
!1,!1,!1,!1,Object.assign(new bb.a,{inStaging:!1}))}gSo(b){const h=new PL.a(K.a.LHp);h.Values["ui-language"]=y.AFrameworkApplication.lcid.toString();h.Values[dv.a.hci]=y.AFrameworkApplication.userSessionId;h.Values[H.a.KHp]=b;this.m4a.value.send(h)}Lzn(b){this.hIc=b;this.gSo(5===this.QC?zx.P7n:zx.V7n);return 5===this.QC?this.Kzn():this.Ozn()}Kzn(){this.D6i();return{returnValue:32,mAb:"HostEditUrl,"}}Ozn(){let b;var h=b="";y.AFrameworkApplication.HOh&&(h="|f|"+y.AFrameworkApplication.userSessionId);
const r=y.AFrameworkApplication.J.$("IsAssignmentMode")&&y.AFrameworkApplication.J.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||y.AFrameworkApplication.vad||X.a.LXa,A=y.AFrameworkApplication.J.$("UnattemptedEnumIsEnabled"),M=y.AFrameworkApplication.J.$("NoBrowserModalDialogs");var ba=y.AFrameworkApplication.va.QR(3588168074);ba&&this.V0o(ba.epochClickTime,ba.sessionOrigin,ba.correlationId);this.kaj();if(y.AFrameworkApplication.Suj){b+="NewOrder,";ba=8;this.m4a&&this.m4a.value&&this.m4a.value.isEnabled()&&
y.AFrameworkApplication.Z2b&&(b+="Post,",ba=this.iMj());if(32===ba)return{returnValue:ba,mAb:b};v.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return y.AFrameworkApplication.Ht.Xba?(v.ULS.shipAssertTag(5566816,211,!!y.AFrameworkApplication.Ht.Xba),b+="HostUrl,",{returnValue:y.AFrameworkApplication.ta.ZX(!0,y.AFrameworkApplication.Ht.Xba),mAb:b}):this.ZEc?(v.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",y.AFrameworkApplication.userSessionId),
b+="DocUrl,",OL.Dii(this.ZEc,this.QC,this.options,this.application,Object(F.a)(this,this.Zkj,"onEditInClientSuccess"),Object(F.a)(this,this.Ykj,"onEditInClientFailure"),this.bWj,y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled"),h,r,A,M,this.pMd,this.rA,this.Sxd,this.uQe),{returnValue:32,mAb:b}):{returnValue:8,mAb:b}}b+="OldOrder,";if(!this.ZEc&&y.AFrameworkApplication.Ht.Xba)return this.m4a&&this.m4a.value&&this.m4a.value.isEnabled()&&y.AFrameworkApplication.Z2b?(b+="Post,",h=this.iMj()):(v.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(v.ULS.shipAssertTag(22595484,211,!!y.AFrameworkApplication.Ht.Xba),b+="HostUrl,",{returnValue:y.AFrameworkApplication.ta.ZX(!0,y.AFrameworkApplication.Ht.Xba),mAb:b}):{returnValue:h,mAb:b};v.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",y.AFrameworkApplication.userSessionId);b+="DocUrl,";OL.Dii(this.ZEc,this.QC,this.options,this.application,Object(F.a)(this,this.Zkj,"onEditInClientSuccess"),
Object(F.a)(this,this.Ykj,"onEditInClientFailure"),this.bWj,y.AFrameworkApplication.J.$("OICEncodeUrlIsEnabled"),h,r,A,M,this.pMd,this.rA,this.Sxd,this.uQe);return{returnValue:32,mAb:b}}FGo(b){y.AFrameworkApplication.En.setDw(8981,b)}Zkj(b){this.FGo(b);v.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.Yhp||this.D6i(),this.kaj()):this.MGg||this.Ipf()}Ykj(b,h=0){v.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",
b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const r=!!this.$Gc&&!this.hIc;let A=0;1===b&&(A=2);6<=b&&13>=b&&(A=1,1===h&&(this.MGg=!0));this.Nlp.ZVn?(v.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",A),XM.a.instance.uJl(this.hIc?this.Wij:this.Xij,r?this.Tlj:null,this.hgi(!1)?this.L4m:null,A,h)):(v.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",A),XM.a.instance.sJl(this.hIc?this.Wij:this.Xij,r?this.Tlj:null,
A))}}kaj(){try{const b=[Object.assign(new fa.a,{name:"CorrelationId",string:this.rA}),Object.assign(new fa.a,{name:"SessionOrigin",string:this.pMd}),Object.assign(new fa.a,{name:"ClickTime",string:this.Sxd}),Object.assign(new fa.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];$b.a("OpenInClientCompleted",!0,0,b)}catch(b){v.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}D6i(){y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.sH&&y.AFrameworkApplication.J.$("StandardProtocolDialogIsEnabled")?
new IK(this):new xO(this)}hgi(b){const h=(X.a.K9c||X.a.hu)&&!!y.AFrameworkApplication.E_d;h&&b&&(Te.a.Cn(y.AFrameworkApplication.E_d,"_blank",void 0,"OpenInClient"),this.Ipf());return h}}zx.V7n="OpenInDesktop";zx.P7n="OpenInBrowser";Object(u.a)(zx,"AOpenInClientOperation",null,[]);class NI extends zx{constructor(b,h,r=!1){super(r);this.aAk=b;this.$zk=h}get vQi(){return this.$zk}get DUf(){return this.aAk}A4l(){y.AFrameworkApplication.va.Pb(La.a.close,2,Yk.a)}hmi(){}WVh(b){return this.pzj(b)}t6i(){v.ULS.shipAssertTag(5566817,
211,!!this.$Gc);y.AFrameworkApplication.$fa?y.AFrameworkApplication.ta.ZX(!0,this.$Gc):Te.a.Cn(this.$Gc,void 0,void 0,"LaunchDownload")}G5c(){y.AFrameworkApplication.ta.Hb.G5c()}}Object(u.a)(NI,"OpenInClientOperation",zx,[]);class hL extends NI{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.zzo=b=>{v.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");df.a.Lna?df.a.Fk.ukd(!1,"OpenInWordOperation").then(()=>{this.tig(b)}).catch(()=>{this.f$i(b,
-1)}):df.a.EV.jD(this.tig,this.f$i,b)};this.f$i=b=>{v.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new kh.StandardDialog;h.Ed=0;h.Iy(se.a.Iup,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.aEn:this.bEn)};this.aEn=()=>{y.AFrameworkApplication.va.Pb(La.a.close,2,Yk.c)};this.bEn=()=>{qa.StaticActiveAppFrame.za().x8(null)};this.tig=b=>{y.AFrameworkApplication.Vqd=!0;v.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",
b);this.pzj(b)}}Ddl(b){df.a.ff.ecb.Rmc||Jf.a.vd().xC.Mo?(v.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.tig(b)):Yu.a.sU(ZB.a.aqj,!0,this.zzo,null,b)}WVh(b){this.Ddl(b);return 32}hmi(){qa.StaticActiveAppFrame.za().x8(null)}}Object(u.a)(hL,"OpenInWordOperation",NI,[]);const iL=(b,h)=>{v.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[Ng.a.On]=cm.PageReader.instance.tw(h);cm.PageReader.instance.tw(h)?b[Ng.a.Description]=
WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[Ng.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},yO=(b,h,r,A,M)=>{if(!qa.StaticActiveAppFrame.za()||!qa.StaticActiveAppFrame.za().kb||!y.AFrameworkApplication.Ln.zqb)return 8;h=qa.StaticActiveAppFrame.za().kb.ed;if(!h)return 8;if(b===ub.a.rre&&2===r){b=new Qb.GraphTransaction(15);try{b.Ab(h),cm.PageReader.instance.Onp(h)}finally{b&&b.dispose()}iL(M,h)}return 32},zO=(b,h,r,A,M)=>{if(!qa.StaticActiveAppFrame.za()||!qa.StaticActiveAppFrame.za().kb)return 8;
b=qa.StaticActiveAppFrame.za().kb.ed;if(!b)return 8;M[Ng.a.Alt]=y.AFrameworkApplication.Ln.zqb?"":CommonUIStrings.l_ProtectDocumentToolTip;iL(M,b);return 32};var AO=d(1083);class jL extends YB.a{constructor(b,h){super(b,h);this.brh=this.arh=this.Uph=!1;this.hTc=new qb.a("docx doc docm dot dotx odt dotm".split(" "));this.$cd=100;this.zmj=(r,A,M,ba,oa)=>{var Ja;if(A.contextId!==xe.a.frame)return 2;if(!(df.a.VVc||y.AFrameworkApplication.Ht.Xba||y.AFrameworkApplication.Z2b||this.Uph))return v.ULS.sendTraceTag(50857163,
211,15,"OIC entry is hidden"),this.Uph=!0,8;if(1===M)return fc.SessionStatusManager.instance.Nk?8:32;let jb=!1;void 0!==oa&&null!==oa&&(jb=oa);if(null===(Ja=y.AFrameworkApplication.J)||void 0===Ja?0:Ja.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",!1))(new WM).Doe().then(()=>this.qXb(r,jb));else return this.qXb(r,jb);return 32};this.CFe=(r,A,M)=>{if(1==M){if(!AO.a.zXe)return this.arh||(v.ULS.sendTraceTag(508703937,231,50,"Open files from PC is shown as disabled"),this.arh=
!0),64;if(!y.AFrameworkApplication.Ge.rud)return this.brh||(v.ULS.sendTraceTag(508598026,231,50,"Open files from PC is shown as disabled due to empty token"),this.brh=!0),64}else if(2==M)return $b.a("OpenFileFromPC"),(r=this.lLl())?this.T9o(M,r):2;return 32};this.yXl=r=>{this.qFn();if(!y.AFrameworkApplication.vad&&y.AFrameworkApplication.ta.Hb.$Bg(La.a.dfa.toString()))this.dEa(!0,K.a.download,!0,{});else if(y.AFrameworkApplication.J.$("WordEditorDownloadACopyUiIsEnabled")){let A=y.AFrameworkApplication.ZNb,
M=null;r&&(r.FileDownloadUrl&&(A=r.FileDownloadUrl.toString()),r.CallSource&&(M=r.CallSource.toString()));new VM(A,M)}else super.dfa(0,null,2,null,null)};this.Yll=r=>{super.workflow(0,null,2,null,r)};this.X5=$a.a.instance.Ra(2)}get XVf(){this.cnh||(this.cnh=$a.a.instance.resolve(1097));return this.cnh}Wb(){super.Wb();this.ga.qa(ub.a.bY,xe.a.frame,this.zmj);this.ga.Pc(ub.a.bY,12288);var b=this.ga;b.fb(ub.a.rre,mc.a.application,yO,4);b.fb(ub.a.kpg,mc.a.application,zO,96);this.ga.qa(La.a.mig,xe.a.frame,
this.zmj);this.ga.qa(ub.a.x$j,mc.a.view,this.CFe);this.ga.qa(ub.a.y$j,mc.a.view,this.CFe)}qXb(b,h){v.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new hL).Dc(df.a.VVc,y.AFrameworkApplication.ZNb,EK.Word,b===La.a.mig?FK.OpenInBrowser:FK.WriteOnly,h,new Pf.a(()=>this.Y_))}tTd(b){return Ej.a.instance.zIa()?!0:qa.StaticActiveAppFrame.za().GJj(ZB.a.ffc,Wr.a.Uul,b)}lLl(){return()=>{window.addEventListener("fileUploadedSuccessfully",this.Eqp,{once:!0});this.XVf.tYo(this.$cd);
this.XVf.xTo(this.hTc);this.XVf.showDialog()}}T9o(b,h){return 2===b?(h(),32):2}Eqp(){window.addEventListener("focus",()=>{const b=$a.a.instance.Ra(2);null!=b&&b.execute(h=>{$b.a("triggerUploadFileFeatureSurvey");h.logActivity("UploadFileFeatureSurvey","UploadFileFloodgateSurveyIsEnabled")})},{once:!0})}dfa(b,h,r,A,M){if(2===r){if(!y.AFrameworkApplication.ZNb&&!y.AFrameworkApplication.ta.Hb.$Bg(La.a.dfa.toString()))return 8;Yu.a.sU(ZB.a.dfa,!0,this.yXl,null,M);return 32}return super.dfa(b,h,r,A,M)}qFn(){y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",
!1)&&null!=this.X5&&this.X5.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,r,A,M){return 2===r?(Yu.a.sU(ZB.a.workflow,!0,this.Yll,null,M),32):super.workflow(b,h,r,A,M)}}Object(u.a)(jL,"AppFrameCommandUIActor",YB.a,[]);class aN extends kh.StandardDialog{constructor(){super();this.Ed=0;this.evb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",
CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(u.a)(aN,"WheresTheSaveButtonDialog",kh.StandardDialog,[]);const JK=(b,h,r)=>{if(1===r)return 32;new aN;return 32};var QL=d(550),bN=d(1361);class Mv extends gl.a{constructor(b,h,r,A,M=null){super();this.C3=M;this.Vpk=56;this.WNc="px";this.SDc="aria-label";this.XPa="BookmarkIndicator";this.qlh="HighlightBookmarkedContent";this.mzk="HighlightBookmark";this.I2a="wwaengidc";this.Vel="Bookmark_24";this.hb=b;this.Fg=h;this.mZ=r;(this.xB=
A)&&this.xB.CRd(this.FD.bind(this))}i4o(b){if(b.Mj){for(const h of b.og.Dj)if(this.KSj(h))return!0;return!1}return this.KSj(b.htmlElement)}Q_a(b){let h=!1;vp.a.instance.ee(()=>{h=this.i4o(b)},"BIA:SCIVE");return h}KSj(b){return Mv.V8e?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}DUa(b){const h=[];vp.a.instance.ee(()=>{const r=b.J6a(0,this.Vpk,this.zoom);h.push(this.Wea(b.V3,r,b.IBc[0].y-b.B7[0].y))},"BIA:CIs");return h}Wea(b,h,
r){const A=b.Jh.ownerDocument,M=Hm.a.createElement(A,io.a.div);M.className=Mv.Ypk;Mv.w$g;M.style.left=h+this.WNc;M.style.top=r+this.WNc;h=Hm.a.createElement(A,io.a.div);zg.a("renderIcon")&&appChrome.api.renderIcon(this.Vel,h);h.setAttribute("role","img");h.setAttribute("alt","Bookmark");h.title="Bookmark";h.setAttribute(this.SDc,"Bookmark");M.appendChild(h);b={context:new FA([],M,new Set,new Set,null,null),ydg:b,container:M};this.Fg.YI(zd.a.click,M,this.sua.bind(this),b);return M}TVd(){const b=Object.assign(new Qm.a,
{action:1,type:5,fC:null,jM:this.zia});this.zia=null;this.mZ.GH(b)}FD(b,h){this.zia&&(h.x8a.Ef.classList.contains("BookmarkHighlightSelected")||this.TVd())}sua(b){this.rdb(this.qlh,this.mzk);if(null==b){var h=new Map;h.set("Source",this.XPa);h=Object.assign(new bb.a,{additionalValues:h});za.Health.instance.recordKpiFailure(this.qlh,"Unable to highlight bookmarked content",!1,!0,h);return!1}h=b.zq.context;if(Mv.Uab(h,this.zia))return!0;h=this.yKf(b.zq.ydg,h,b.zq.container);b=Object.assign(new Qm.a,
{action:0,type:5,fC:h,jM:this.zia});this.zia=h;this.mZ.GH(b);return!0}yKf(b,h,r){h={BWh:new Set,AXb:new Set,EWh:null,clf:null};const A=this.hb.Nv(b.Cb,!0,!1),M=[];if(A)for(const ba of A)M.push(ba);this.nZk(b,h,M);h=new FA(M,r,h.BWh,h.AXb,h.EWh,h.clf);this.zia&&this.zia.ft===M&&(r.className+=String.format(" {0}",Mv.Upk),this.zia=h);return h}nZk(b,h,r){var A;if(b.Mj){var M=new Set;for(const oa of b.og.Dj)oa.querySelectorAll("*").forEach(M.add,M);b=Array.from(M.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),
0);let ba=[];h.AXb.add(r[0].id);h.EWh=r[0].id;h.clf=r[0].id;b.forEach(oa=>{const Ja=Tj.a.Eb(oa,Np.a.JTd);if(Ja)for(const jb of Ja)ba.push(jb),h.BWh.add(jb);if(!ba.length)return!0;oa=Tj.a.Eb(oa,Np.a.XKb);if(!oa)return!0;ba=bN.a.yvc(ba,oa)});for(b=this.hb.mg(r[r.length-1],!1,!0);ba.length&&b;)h.AXb.add(b.id),h.clf=b.id,r.push(b),M=this.C3.value.Wl(b),M=null===(A=null===M||void 0===M?void 0:M.htmlElement)||void 0===A?void 0:A.querySelectorAll("."+Np.a.blf),null===M||void 0===M?void 0:M.forEach(oa=>{(oa=
Tj.a.Eb(oa,Np.a.XKb))&&(ba=bN.a.yvc(ba,oa))}),b=this.hb.mg(b,!1,!0)}rdb(b,h){const r=new Map;r.set("Source",this.XPa);r.set("Action",h);za.Health.instance.recordKpiUsage(b,0,this.I2a,r)}static Uab(b,h){return!!h&&!!b&&b.zWh===h.zWh}}Mv.Upk="WordBookmarkIndicatorContainerSelected";Mv.V8e=!0;Mv.w$g="WordBookmarkIndicatorContainer";Mv.Ypk="WordBookmarkSvgIndicatorContainer";Object(u.a)(Mv,"BookmarkIndicatorActor",gl.a,[385]);class cN{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb=null,Eb=null,Sb=null,nc=null,
Dc=null,Zc=null,Gd=null){var de,he;this.Ria="_";this.U2a="OLE_LINK";this.hxd=(null===(de=y.AFrameworkApplication.J)||void 0===de?0:de.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLocalizedBookmarkName",!1))?WordEditorIntl.WordEditorStrings.L_Bookmark:"Bookmark";this.wpk=(null===(he=y.AFrameworkApplication.J)||void 0===he?0:he.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLocalizedBookmarkName",!1))?new RegExp("^"+this.hxd+"\\d+$","i"):/^BOOKMARK\d+$/i;this.XPa="BookmarkRibbonOptions";
this.Spk="BookmarkFloatieOptions";this.fdh="CreateBookmarkOnRange";this.gdh="CreateBookmarkOnView";this.edh="CreateBookmarkOnIP";this.zOe="CreateBookmark";this.I2a="wwaengidc";this.sFh="ShowHideBookmarksOnDocument";this.veh="DeleteBookmark";this.Ttk="DeleteBookmarkAction";this.DOk="ShowHideBookmarks";this.rFh="ShowBookmarksFloatie";this.AOk="ShowBookmarksFloatieAction";this.$fh="EditBookmark";this.Tuk="EditBookmarkAction";this.flf="BookmarksUsage";this.Xel="InsertTabSwitchActivity";this.Ycn="Insert";
this.j4b=b;this.ga=h;this.ib=r;this.Gp=A;this.Ez=M;this.g$=ba;this.Qc=oa;this.pO=Ja;this.yr=Eb;this.v$g=jb;this.Pe=zb;this.N9=Dc;this.Eo=Sb;this.od=nc;this.QV=Zc;this.Al=Gd}get tv(){return this.Ez.value}Wb(){this.ga.qa(Hc.a.CUa,mc.a.view,this.CUa.bind(this));this.ga.fb(La.a.m0a,mc.a.application,this.Cqp.bind(this),96);this.ga.qa(Hc.a.CUa,mc.a.Fd,this.gFl.bind(this));this.ga.qa(Hc.a.CUa,mc.a.Vc,this.fFl.bind(this));this.ga.qa(Hc.a.deleteBookmark,mc.a.view,this.deleteBookmark.bind(this));this.ga.qa(Hc.a.Fzf,
mc.a.view,this.h_l.bind(this));this.ga.fb(Hc.a.oUj,mc.a.view,this.J9o.bind(this),1028);this.ga.fb(Hc.a.xre,mc.a.application,this.xre.bind(this),96);this.ga.fb(Hc.a.wze,mc.a.Vc,this.wze.bind(this),1028);this.ga.fb(ub.a.Hhe,mc.a.view,this.Hhe.bind(this),1028);this.ga.fb(Hc.a.xae,mc.a.view,this.xae.bind(this),1028);this.ga.Pc(Hc.a.CUa,1028)}Cqp(b,h,r,A,M){return M&&M.NewContextId===this.Ycn?(this.fie(this.Xel),32):2}CUa(b,h,r,A,M){var ba,oa;b=this.ib.Ng;if(!b||b.contextId===mc.a.V$)return 2;if(1===r)return Bl.a.dma(h)||
(null===(ba=this.Al)||void 0===ba?0:ba.F2(b))||(null===(oa=this.Al)||void 0===oa?0:oa.gma(b))?8:32;h=this.ib.gb.currentSelection;if(!h||this.Pe.Fm(h))return 2;this.vcd(M,"User is trying to create bookmark from UILocation : {0}");this.rdb(this.gdh,this.zOe);if(h&&this.Gp.vef(this.Dqb(),h))return this.fie(this.flf),32;M=new Map;M.set("Source",this.XPa);M=Object.assign(new bb.a,{additionalValues:M});za.Health.instance.recordKpiFailure(this.gdh,"Unable to create bookmark",!1,!0,M);return 8}gFl(b,h,r,
A,M){if(1===r)return 32;if(mc.a.Fd!==h.contextId)return 8;this.vcd(M,"User is trying to create bookmark from UILocation : {0}");b=this.ib.gb.currentSelection;if(!b)return 2;this.rdb(this.fdh,this.zOe);if(this.Gp.vef(this.Dqb(),b))return this.fie(this.flf),32;b=new Map;b.set("Source",this.XPa);b=Object.assign(new bb.a,{additionalValues:b});za.Health.instance.recordKpiFailure(this.fdh,"Unable to create bookmark for range",!1,!0,b);return 8}fFl(b,h,r,A,M){if(1===r)return 32;if(mc.a.Vc!==h.contextId)return 8;
this.vcd(M,"User is trying to create bookmark from UILocation : {0}");b=this.ib.gb.currentSelection;if(!b)return 2;this.Pe.Fm(b)&&(h=b.Qa,this.Pe.Ttb(h)?(b=this.Pe.c7(h,!1),b||(v.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Pe.c7(h,!0))):v.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.rdb(this.edh,this.zOe);if(this.Gp.vef(this.Dqb(),b))return this.fie(this.flf),32;b=new Map;b.set("Source",this.XPa);
b=Object.assign(new bb.a,{additionalValues:b});za.Health.instance.recordKpiFailure(this.edh,"Unable to create bookmark for IP",!1,!0,b);return 8}xre(b,h,r,A,M){1===r&&32;M[Ng.a.On]=Mv.V8e;return 32}J9o(b,h,r,A,M){if(1===r)return 32;this.rdb(this.sFh,this.DOk);(b=M[Ng.a.On])||v.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");Mv.V8e=b;b=Object(fn.a)().BU(this.tv);if(null!==b)return this.Gjd(b),this.j4b.lJ({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",
this.XPa);b=Object.assign(new bb.a,{additionalValues:b});za.Health.instance.recordKpiFailure(this.sFh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,r,A,M){b=this.ib.gb.currentSelection;if(!b)return 2;b=b.Qa;b=this.Gp.l6d(b.node,b.cpBegin);if(1===r)return b?32:8;this.vcd(M,"User is trying to delete bookmark from UILocation : {0}");this.pO.t3&&(v.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.pO.dismissFloatie());this.rdb(this.veh,this.Ttk);
b||v.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.Gp.iCj(b.id))return this.v$g&&this.v$g.TVd(),32;r=new Map;r.set("Source",this.XPa);r=Object.assign(new bb.a,{additionalValues:r});za.Health.instance.recordKpiFailure(this.veh,"Unable to delete bookmark",!1,!0,r);return 8}h_l(b,h,r,A,M){b=this.ib.gb.currentSelection;if(!b)return 2;b=b.Qa;b=this.Gp.l6d(b.node,b.cpBegin);if(1===r)return b?32:8;this.vcd(M,"User is trying to edit bookmark from UILocation : {0}");
this.pO.t3&&(v.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.pO.dismissFloatie());this.rdb(this.$fh,this.Tuk);b||v.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.N9.value.i_l(h,b,this.Gp),32;h=new Map;h.set("Source",this.XPa);h=Object.assign(new bb.a,{additionalValues:h});za.Health.instance.recordKpiFailure(this.$fh,"Unable to edit bookmark",!1,!0,h);return 8}vcd(b,h){b&&b.UILocation&&v.ULS.sendTraceTag(540386525,
3029,50,h,b.UILocation)}wze(b,h,r,A,M){1===r&&32;this.rdb(this.rFh,this.AOk);if(h.contextId===mc.a.Vc)return b=Array(1),b.push("Bookmarks"),this.pO.showFloatie(M.location,b,1),32;M=new Map;M.set("Source",this.Spk);M=Object.assign(new bb.a,{additionalValues:M});za.Health.instance.recordKpiFailure(this.rFh,"Unable to show bookmark floatie",!1,!0,M);return 8}Hhe(b,h,r,A,M){let ba;return 1===r?(vp.a.instance.ee(()=>{ba=this.ga.Pf(h,ub.a.XR,r,!0,A,M);32!==ba&&(ba=this.ga.Pf(h,Hc.a.CUa,r,!0,A,M))},"BA:LFE"),
ba):8}xae(b,h,r){var A;if(1===r)return 32;if(b=this.ib.gb.currentSelection){b=b.Qa.node;if(h=this.Imi(b))return h.click(),32;v.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.Gp.l6d(b,0)){b=this.QV.bnb.get(null===(A=b.id)||void 0===A?void 0:A.toString());A=Object(fn.a)().BU(this.tv).Ic.Eb(b);if(A=this.Imi(A))return A.click(),32;v.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else v.ULS.sendTraceTag(539523267,
3029,50,"No bookmark found enclosing the content.")}return 2}Imi(b){let h;b=this.Eo.Cm(b).Wl(this.od.Ad.sc);b.yab&&(b=b.htmlElement.querySelectorAll("div."+Mv.w$g),0<b.length&&(h=b[0]));return h}Gjd(b){const h=QL.b(b);if(h){var r=this.Qc.Lc(2);try{for(r.Ab(b);h.moveNext();){if(!Ed.ParagraphReader.Eh(h.iterator))continue;const A=h.currentNode;this.aZl(A)&&this.g$.NSb(A,!0)}}finally{r&&r.dispose()}}}aZl(b){var h;for(let A=0;A<b.ra.length;A++){const M=b.ra.K(A);if(null!=M.ei)for(let ba=0;ba<M.ei.length;ba++){var r=
M.ei.K(ba);if(null!=r){r=b.Ic.Eb(r.Ao).ka(Rc.a.zu,"");const oa=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.$("HideBookMarkStartingWithOleLink");if(!(C.a.Uf(r)||r.startsWith(this.Ria)||oa&&r.startsWith(this.U2a)))return!0}}}}Dqb(){var b=this.Gp.Q4d(!1);const h=[];for(let r=0;r<b.count;r++){const A=b.K(r).ka(Rc.a.zu,"");this.wpk.test(A)&&h.push(A)}return 0<h.length?(h.sort((r,A)=>r.localeCompare(A,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.hxd.length)),this.hxd+(b+1)):
this.hxd+1}rdb(b,h){const r=new Map;r.set("Source",this.XPa);r.set("Action",h);za.Health.instance.recordKpiUsage(b,0,this.I2a,r)}fie(b){this.yr&&this.yr.execute(h=>{h.logActivity(b,null)})}}Object(u.a)(cN,"BookmarkActor",null,[]);class dN{constructor(b,h,r){this.Qb=b;this.qUl=h;this.ig=r;this.jqf=this.jqf.bind(this)}Wb(){this.Qb.qa(Hc.a.C3f,mc.a.view,this.jqf)}jqf(b,h,r,A,M){return 1===r?32:(b=this.ig.aba(h.Ok))?(M=3===M.fz,this.qUl.value.F9h(this.kIm(b),this.$Rm(b),M),32):2}kIm(b){const h=new ji.DictionaryPropertySet;
h.setValue(le.a.ZG,this.ig.Dh(b));h.setValue(le.a.iI,this.ig.Saa(b));h.setValue(le.a.rra,this.ig.Lqb(b));h.setValue(le.a.separator,this.ig.X8d(b));return h}$Rm(b){const h=new ji.DictionaryPropertySet;h.setValue(Rc.a.marginLeft,this.ig.vN(b));h.setValue(Rc.a.marginRight,this.ig.wN(b));h.setValue(Rc.a.Bp,this.ig.Mv(b));return h}}Object(u.a)(dN,"ColumnsDialogActor",null,[]);var eN=d(866);class HA{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){this.jq=b;this.Nia=h;this.Je=r;this.vr=A;this.Xm=M;this.Qd=ba;this.Qc=
oa;this.xe=Ja;this.ga=jb;this.HBk=zb;this.ysk=Eb}get yYf(){return this.HBk}Wb(){this.ga.fb(ub.a.ypd,mc.a.view,this.kbn.bind(this),96);this.ga.fb(ub.a.Bkd,mc.a.view,this.Bkd.bind(this),4);this.ga.fb(ub.a.GSd,mc.a.view,this.GSd.bind(this),1028)}GSd(b,h,r,A,M){if(!os.a.Srf)return 8;b=M.FormattingActionId;M=M.FormattingActionData;if(!h.view||!h.view.ue)return 2;h=h.view;if(!(b&&M&&h.lb&&h.lb.gb.currentSelection))return 8;h=this.Xm.awi(h.lb.gb.currentSelection.toArray());for(const ba of h){h=ba.ka(Rc.a.Mw,
0);r=this.jq.getById(h);if(!r)return v.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.ysk.Rxp(r,b,M))return v.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+h+"' failed to update formatting."),8}return 32}kbn(b,h,r,A,M){h=this.jq.getById(M);if(!h)return 8;r=h.Wd;if(!r)return 8;if(os.a.Xec&&8===h.type||r.ka(Rc.a.raa,!1))return 2;A=this.jq.pom(h);if(!A)return 8;M=this.Qc.Lc(7);M.Ab(A.node);if(!this.yYf)return(b=h.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),
this.Qd.Ue(A,b),os.a.kga?this.Xm.GKb(h,!0):this.GKb(h),r.setValue(Rc.a.raa,!0),M.dispose(),32;const ba=new ji.DictionaryPropertySet;ba.setValue(Bd.a.a$d,A);var oa=r.ka(Rc.a.xUa,"");oa=this.Nia.lKi(oa);if(!oa)return this.vr.Ue(A,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,b),os.a.kga?this.Xm.GKb(h,!0):this.GKb(h),r.setValue(Rc.a.raa,!0),M.dispose(),32;ba.setValue(Bd.a.n5c,oa);if(1<oa.length&&!h.zg)return M.dispose(),8;os.a.kga?this.ga.Pb(ub.a.Hpd,2,{n5c:oa,a$d:A,placeholderText:h.placeholderText}):
this.BDl(ba);r.setValue(Rc.a.raa,!0);M.dispose();return 32}Bkd(b,h,r){b=h.view.ue?h.view:null;if(!b||!b.lb)return 8;const [A,M]=this.uLm(b.lb.gb);if(0===A.length)return 8;if(1===r){for(var ba of A){var oa=M.get(ba.parentId);if(this.EWi(ba,oa))return 32}return 8}if(2===r){r=this.qcp(A,M);ba=this.Qc.Lc(15);ba.Ab(b.qd);for(oa of r)r=M.get(oa.parentId),this.EWi(oa,r)&&this.jq.yZb(oa.id);ba.dispose();Object(eN.l)()&&Object(eN.o)("RemoveContentControl");return 32}return 2}uLm(b){var h,r,A=[];for(const ba of b)A.push(...(null!==
(h=this.Xm.ysa(ba.Qa,ba.Wc,1))&&void 0!==h?h:[]));if(0===A.length)return[A,new Map];h=[];for(const ba of b)h.push(...(null!==(r=this.Xm.ysa(ba.Qa,ba.Wc,3))&&void 0!==r?r:[]));b=new Map(A.map(ba=>[ba.id,ba]));if(0===h.length)return[A,b];const M=new Map(h.map(ba=>[ba.id,ba]));A=A.filter(ba=>!M.has(ba.id));b=new Map([...b,...M]);return 0==A.length?[[h[0]],b]:[A,b]}GKb(b){const h=this.vr.Nkc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.xe.MF(b.start.node).mh(As.a.blg))this.Je.lra(h.formatting),
this.Je.Aeb(h.formatting,b)}else v.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}BDl(b){this.ga.Pb(ub.a.Hpd,2,b)}EWi(b,h){return b.$la&&b.fsn&&(!h||h.isEditable)}qcp(b,h){const r=(A,M)=>null==A||null==M||A.id===M.id?!1:A.id===M.parentId||r(h.get(A.parentId),M);return b.slice().sort((A,M)=>r(A,M)?1:r(M,A)?-1:0)}}Object(u.a)(HA,"ContentControlActor",null,[]);var ty=d(1060);class RL extends ug.a{constructor(b,h,r){super(!1,!1,!0);this.dth=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,
ty.a.Ehf,ty.a.Dhf,ty.a.Fhf];this.Jok=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,ty.a.C5k,ty.a.B5k,ty.a.E5k];this.R8g=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.fyc=()=>{new RL(this.ga,this.Q$e,this.oGc)};this.Dxm=()=>{const A=[];for(const M of this.Q$e)A.push(this.h9(M));return A};this.xCp=A=>{const M=new Set;this.Jia="";for(const ba of A)if(""!==ba.position){const oa=this.$Ci(ba.position);
if(0>oa||22<oa){this.Jia=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(M.has(oa)){this.Jia=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.mnp(ba)),M.add(oa)}else{this.Jia=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.Jia&&(this._tabStops=[],this.Q$e=A)};this.aOl=(A,M)=>{try{if(1===A){if(""!==this.Jia)throw Error.create(this.Jia);M.DefaultTabStop&&(this.oGc=ty.a.pwg(M.DefaultTabStop),this.ZFp(this.oGc));
if(32!==this.ga.Pb(Hc.a.C2b,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Cg.a.uD(this.oGc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(ba){this.aOa(ba.message,this.fyc)}};this.ga=b;this.Q$e=h;this._tabStops=[];this.oGc=r;this.Jia="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.k2c()};this.gi(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.aOl,b)}h9(b){return{["position"]:b.position,["alignment"]:b.alignment,["leader"]:b.leader}}$Ci(b){return Math.floor(100*
parseFloat(b))/100}mnp(b){return new nB.a(Cg.a.uD(this.$Ci(b.position)),ty.a.hOm(b.alignment),ty.a.fOm(b.leader),1)}ZFp(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Pb(ub.a.oNa,2,h)){var r=h.marginLeft;const A=Rh.a.sj(h.marginRight,0);r=Rh.a.sj(r,0);h=Rh.a.sj(h.Bp,0);if(Rh.a.Pla(b,0,!1)>=h-A-r)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}k2c(){return{["getInitState"]:this.Dxm,
["updateState"]:this.xCp,["validPositions"]:this.wHi(0,"Position"),["validAlignments"]:this.wvi(this.R8g,this.R8g,null,"Alignment"),["validLeaders"]:this.wvi(this.dth,this.dth,this.Jok,"Leader"),["defaultTabStopSpinButtonProps"]:this.wHi(.01,"DefaultTabStops"),["defaultTabStopLength"]:this.oGc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,
["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}wHi(b,h){return{["type"]:"AppSpinButtonProps",
["id"]:"CustomTabDialogSpinButtonPosition",["label"]:h,["unitType"]:"Inch",["validUnits"]:[qp("Inch",3,b,22,.1)],["numberFormatInfo"]:rk()}}wvi(b,h,r,A){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:A,["options"]:nv(b,h,r)}}}Object(u.a)(RL,"CustomTabDialog",ug.a,[]);class fN{constructor(b,h,r){this.Orc=(A,M,ba,oa,Ja)=>{if(2!==ba)return 8;if(!Ja)return 16;A=Ja.tabStop;Ja=Ja.value;if(!A)return 16;$b.c(Hc.a.Orc);Ja=new nB.a(Ja,A.Qha,A.Uta,A.cHg);M=M.node;this.RFa.xdb(M,
A);this.RFa.Sbe(M,Ja);return 32};this.Jnd=(A,M,ba,oa,Ja)=>{if(2===ba){if(!Ja)return 16;this.RFa.Sbe(M.node,Ja);return 32}return 8};this.AYb=(A,M,ba,oa,Ja)=>{A=this.RFa.jzj(M.node);if(!("customTabs"in Ja))return Ja.customTabs=A,32;M=Ja.customTabs;if(!M||0>=M.length||!A||0>=A.length)return Ja.customTabs=null,32;ba=[];for(const jb of M)for(const zb of A)if(zb.BOa===jb.BOa&&zb.cHg===jb.cHg&&zb.Qha===jb.Qha){ba.push(jb);break}Ja.customTabs=ba;return 32};this.xdb=(A,M,ba,oa,Ja)=>{if(2===ba){if(!Ja)return 16;
$b.c(Hc.a.xdb);this.RFa.xdb(M.node,Ja);return 32}return 8};this.zZb=(A,M)=>{this.RFa.zZb(M.node);return 32};this.C2b=(A,M,ba,oa,Ja)=>{if(2===ba){if(!Ja)return 16;A=Ja.tabStops;ba=Ja.defaultTabStopLength;M=M.node;oa=!1;const jb=this.RFa.HFo(M,A);Ja.defaultTabStopLengthSaved||(oa=this.sT.kVo(M,ba),Ja.defaultTabStopLengthSaved=!0);jb&&$b.d(Hc.a.C2b,!0,void 0,void 0,void 0,void 0,[Object.assign(new fa.a,{name:"Custom Tab Stops Count",string:A.length.toString()})]);if(null==oa)return v.ULS.sendTraceTag(571479714,
3015,15,"Could not set Default Tab Stop Length."),16;oa&&(this.cld&&this.cld.EUi(),this.Pd.ev(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),$b.d(Hc.a.C2b,!0,void 0,void 0,void 0,void 0,[Object.assign(new fa.a,{name:"Default Tab Stop Length",string:ba.toString()})]));return 32}return 8};this.zUj=(A,M,ba)=>{if(2!==ba)return 8;A={};if(32!==this.ga.Pb(Hc.a.E_,2,A))return v.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;M={};if(32!==this.ga.Pb(ub.a.oNa,
2,M))return v.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;A=ty.a.pwg(Cg.a.pB(A.defaultTabStop));ba={};ba.defaultTabStopLength=A;ba.sectionPropertiesData=M;if(32!==this.ga.Pb(Hc.a.eOg,2,ba))return v.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!ba.isParagraphValid)return v.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.RFa.aOa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),
8;M={};if(32!==this.ga.Pb(Hc.a.AYb,2,M))return v.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(M=M.customTabs)||(M=[]);M=ty.a.gOm(M);new RL(this.ga,M,A);$b.c(Hc.a.fyc,!0);return 32};this.Pqn=(A,M,ba,oa,Ja)=>{if(2!==ba)return 8;if(!Ja)return 16;if(Ja.isParagraphValid)return 32;ba={};if(32!==this.ga.Pf(M,ub.a.ldb,2,!1,null,ba))return 16;A=Ja.sectionPropertiesData;M=Ja.defaultTabStopLength;var jb=ba.Iu;oa=jb.Sfa;jb=1===jb.specialIndentType?jb.$A:jb.$A-jb.Gha;const zb=A.marginLeft,
Eb=A.marginRight;ba.isRtl?(ba=Rh.a.sj(Math.max(Eb,Eb+oa),0),oa=Rh.a.sj(Math.max(zb,zb+jb),0)):(ba=Rh.a.sj(Math.max(zb,zb+jb),0),oa=Rh.a.sj(Math.max(Eb,Eb+oa),0));A=Rh.a.sj(A.Bp,0);M=Rh.a.Pla(M,0,!1);Ja.isParagraphValid=M<A-ba-oa;return 32};this.ga=b;this.RFa=h;this.sT=r}get Pd(){return null!=this.c6g?this.c6g:this.c6g=$a.a.instance.resolve(46).instance}get cld(){return null!=this.y3g?this.y3g:this.y3g=$a.a.instance.Oa(1098)}Wb(){const b=r=>wy.OutlineElementGeneralizer.gla(r.gb,!0),h=df.a.r0a.GXc(b,
!0);this.ga.qa(Hc.a.AYb,mc.a.view,df.a.r0a.GXc(b,!1));this.ga.fb(Hc.a.AYb,mc.a.paragraph,this.AYb,96);this.ga.qa(Hc.a.xdb,mc.a.view,h);this.ga.fb(Hc.a.xdb,mc.a.paragraph,this.xdb,96);this.ga.qa(Hc.a.zZb,mc.a.view,h);this.ga.fb(Hc.a.zZb,mc.a.paragraph,this.zZb,96);this.ga.qa(Hc.a.Jnd,mc.a.view,h);this.ga.fb(Hc.a.Jnd,mc.a.paragraph,this.Jnd,96);this.ga.qa(Hc.a.Orc,mc.a.view,h);this.ga.fb(Hc.a.Orc,mc.a.paragraph,this.Orc,96);this.ga.qa(Hc.a.C2b,mc.a.view,h);this.ga.fb(Hc.a.C2b,mc.a.paragraph,this.C2b,
96);this.ga.qa(Hc.a.eOg,mc.a.view,h);this.ga.fb(Hc.a.eOg,mc.a.paragraph,this.Pqn,96);this.ga.qa(Hc.a.fyc,mc.a.view,this.zUj);this.ga.qa(Hc.a.jTi,mc.a.view,this.zUj)}}Object(u.a)(fN,"CustomTabActor",null,[]);var gN=d(128),MD=d(619);class hN{constructor(b,h,r,A,M,ba,oa,Ja,jb){this.ga=b;this.SPd=r;this.F1a=(this.UPc=M)&&A;this.lp=ba;this.AW=oa;this.xtk=Ja;this.Ny=jb;this.Fok=h;this.zaj(!0);this.s$i(!0);y.AFrameworkApplication.JH(()=>{this.FWb()});this.F1a&&zg.a("dispatch")&&appChrome.api.dispatch(this.i_j([]))}Wb(){this.F1a&&
(this.ga.qa(Hc.a.Fnp,mc.a.view,this.qOl.bind(this)),this.ga.qa(Hc.a.Wod,mc.a.view,this.Wod.bind(this)),this.ga.fb(Hc.a.djd,mc.a.view,this.djd.bind(this),96));this.UPc&&(this.ga.qa(Hc.a.Xod,mc.a.view,this.Xod.bind(this)),this.ga.fb(Hc.a.pse,mc.a.view,this.pse.bind(this),96))}Sen(b){if(!this.w5o(b))return!1;const h=xn.a.instance.Lc(2);try{h.Ab(b.root);const r=zc.a.Za(b.root.graphNode),A=Uv.a.rq(r);for(;A.moveNext();){const M=Object(Ma.a)(gN.a,A.currentNode);M&&M.PL(b.sc,20,!0)}}finally{h&&h.dispose()}return!0}w5o(b){return b&&
b.root&&b.sw?b.jj||b.FZf||b.FYi||b.uk:!1}HHo(){let b=!1;this.SPd.forEach(h=>{this.Sen(h)&&(b=!0)});return b}Gnp(){v.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.lp.jP?"dark":"light");return this.lp.jP?MD.a.CSc(1):MD.a.uCj(1)}iJg(){const b=this.lp.E6;v.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.HHo()||(b?!MD.a.CSc(0):!MD.a.uCj(0)))return!1;this.xtk.Uoo(b);return!0}i_j(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.lp.jP));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.$Hi(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.lp.efb?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):v.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){v.ULS.sendTraceTag(527282835,3023,10,h)}return b}qOl(){return this.iJg()?
32:8}Xod(b,h,r){if(1===r)return 32;b=this.AW.Xf("UserAction","sharedUXDarkModeToggle");if(zg.a("toggleSharedUXDarkMode"))v.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),zg.a("isSharedUXDarkModeOn")?this.lp.jP=appChrome.api.isSharedUXDarkModeOn():this.lp.jP=!this.lp.jP,v.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.lp.jP);else return 8;appChrome.getHeaderApi().then(A=>{A.hasOwnProperty("refreshThemeOverride")&&
A.refreshThemeOverride()});this.Gnp()||v.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.F1a&&!this.lp.efb&&(this.iJg()||v.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");qa.StaticActiveAppFrame.za().lJ(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.lp.jP));this.F1a&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.lp.jP));b.stop();v.ULS.sendTraceTag(555885377,3023,50,"{0}",b.Hi);$b.b(this.lp.jP?"DarkModeOn":"DarkModeOff");return 32}Wod(b,h,r){if(1===r)return 32;b=this.AW.Xf("UserAction","sharedUXDarkModeSwitchBackground");v.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.lp.efb=!this.lp.efb;if(!this.iJg())return 8;h={};h.DarkModeSwitchBackground=this.Ny?"ButtonModel":"ToggleButtonModel";qa.StaticActiveAppFrame.za().lJ(h);b.stop();v.ULS.sendTraceTag(555885378,
3023,50,"{0}",b.Hi);v.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.lp.efb);$b.b(this.lp.efb?"DarkCanvasOff":"DarkCanvasOn");return 32}pse(b,h,r,A,M){if(1===r)return 32;if(!M)return 2;zg.a("isSharedUXDarkModeOn")&&(this.lp.jP=appChrome.api.isSharedUXDarkModeOn());M&&(M[Ng.a.On]=this.lp.jP);return 32}djd(b,h,r,A,M){if(1===r)return 32;if(!M)return 2;!this.Ny&&M&&(M[Ng.a.On]=this.lp.efb);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.lp.jP));
this.F1a&&this.i_j(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.$Hi(!1)));appChrome.api.dispatch(b);return 32}$Hi(b){const h={};this.lp.efb?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}FWb(){this.UPc&&this.zaj(!1);this.F1a&&this.s$i(!1)}zaj(b){var h;v.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",
b,this.lp.jP?"dark":"light",this.lp.sJa);b&&this.lp.jP!=(null===(h=this.Fok)||void 0===h?void 0:h.$("DarkModeIsOn"))&&v.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.lp.jP?"dark":"light",this.lp.sJa)}s$i(b){v.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.lp.E6?"dark":"light",this.lp.pOl)}}Object(u.a)(hN,"DarkModeActor",null,[]);class Ax{constructor(b){this.In=
null;this.Dqa=b}get PKb(){return null!=this.FTg?this.FTg:this.FTg=$a.a.instance.Oa(105)}get e_(){return null!=this.HTg?this.HTg:this.HTg=$a.a.instance.Oa(70)}get eY(){return null!=this.x2g?this.x2g:this.x2g=$a.a.instance.Oa(102)}get VN(){return null!=this.V1g?this.V1g:this.V1g=$a.a.instance.Oa(110)}get rh(){return this.In||(this.In=this.Dqa())}T6i(b,h,r){if(this.VN&&Ax.xj){var A=Object(zl.a)().gLf(h);b=A.node;Le.a.rl(A)&&(A=vc.a.Tc(b,Ed.ParagraphReader.textLength(b)));var M=xa.FormattingReader.language(xa.FormattingReader.Us(A));
A=zc.a.Za(r.qd);Object(fn.a)().uve(A);var ba=b=null;if(A)for(let oa=A.Ub(1);oa&&!ba;oa=A.Mi(1))Lj.OutlineReader.fCa(oa)&&(ba=oa);if(A&&!ba){if(!this.eY||!this.VN)return;b=new Qb.GraphTransaction(7);b.pu(A);ba=this.eY.LYd(A);this.VN.Vja(A,!0);M&&(Ab.OutlineElementNavigator.Me(A),A=vc.a.Tc(A.currentNode,0),Ax.xj.Lxe(xa.FormattingReader.Us(A),M))}M=sc.SelectionFactory.vp(ba,!0);r.lb.Kc(M);Le.a.qf(h)&&(r=zc.a.Za(h.node),r.yq(),to.OutlineNavigator.Mvg(r),this.PKb&&this.e_&&Lj.OutlineReader.aB(r,h,!0)&&
(h=this.PKb.BDf(h,-1,!1,rf.a.wz))&&this.e_.pKj(h));this.rh&&this.rh.BI();b&&b.dispose()}}static get xj(){return null!=Ax.GXg?Ax.GXg:Ax.GXg=$a.a.instance.Oa(101)}static get instance(){return null!=Ax.o_g?Ax.o_g:Ax.o_g=Ax.Sm()}static Sm(){return new Ax(()=>$a.a.instance.Oa(50))}}Object(u.a)(Ax,"TitleViewEditor",null,[]);class SL{Fwf(b,h,r){return 1===r?32:SL.NRl(h.node)}static NRl(b){const h=new zc.a;h.set(b);h.yq();b=new Qb.GraphTransaction(7);b.pu(h);h.Tg();b.dispose();return 32}}Object(u.a)(SL,"DeleteOutlineLevelContentStrategy",
null,[]);class hr{constructor(){this.Vtk=new SL;this.Fwf=(b,h,r,A,M)=>this.Vtk.Fwf(b,h,r,A,M)}Wb(b){const h=this.Mei.Pwf.bind(this.Mei),r=this.Fwf,A=this.Bei.SRl.bind(this.Bei);this.frg(b,h,r,A);b.qa(ub.a.backspace,mc.a.Vc,A);b.qa(ub.a.backspace,mc.a.Fd,A);b.qa(ub.a.backspace,mc.a.Yc,kd.ActionManager.nU);b.qa(ub.a.backspace,mc.a.outline,r);b.qa(ub.a.backspace,mc.a.view,h);b.Pc(ub.a.backspace,1124);b.qa(ub.a.fAa,mc.a.Vc,kd.ActionManager.nU);b.qa(ub.a.fAa,mc.a.Fd,A);b.qa(ub.a.fAa,mc.a.Yc,kd.ActionManager.nU);
b.qa(ub.a.fAa,mc.a.outline,r);b.qa(ub.a.fAa,mc.a.view,h);b.fb(ub.a.jZd,mc.a.view,h,1124);b.qa(ub.a.RJ,mc.a.Vc,A);b.qa(ub.a.RJ,mc.a.Fd,A);b.qa(ub.a.RJ,mc.a.Yc,kd.ActionManager.nU);b.qa(ub.a.RJ,mc.a.outline,r);b.qa(ub.a.RJ,mc.a.view,h);b.Pc(ub.a.RJ,1124);b.fb(ub.a.evf,mc.a.view,h,1124);b.fb(ub.a.Qra,mc.a.view,hr.Qra,1028)}frg(){}static get Of(){return null!=hr.Y1g?hr.Y1g:hr.Y1g=$a.a.instance.resolve(16)}static get eY(){return null!=hr.u2g?hr.u2g:hr.u2g=$a.a.instance.resolve(102)}static get VN(){return null!=
hr.U1g?hr.U1g:hr.U1g=$a.a.instance.resolve(110)}static get qc(){return null!=hr.IWg?hr.IWg:hr.IWg=$a.a.instance.Oa(23)}static Qra(b,h,r,A,M){A=h.view;if(!A.lb||!A.lb.gb.currentSelection||Le.a.Fm(A.lb.gb.currentSelection))return 8;if(1===r)return 32;r=A.lb.gb;const ba=r.currentSelection;var oa=ba.Qa,Ja=null,jb=!1;if(r.WL){if(oa.contextId===mc.a.outline&&1===r.length){for(b=zc.a.Za(oa.node);b.$d();)b.Tg();hr.VN.Vja(b,!0);Ab.OutlineElementNavigator.Me(b);b=sc.SelectionFactory.ve(b.currentNode,0);A.lb.Kc(b);
return 32}Ja=oa.node;var zb=null;if(qq.c(oa)){var Eb=Ja.Ce(A.sc);Eb&&(Eb=Eb.Gkq)&&0<=Eb.width&&0<=Eb.height&&(zb=new Mx.a(Rh.a.zn(Eb.x,0),Rh.a.zn(Eb.y,1)));zb||(zb=mv.a(Ja))}else zb=mv.a(oa.node);oa=zc.a.Za(oa.node);oa.yq();Object(fn.a)().uve(oa);Ja=hr.eY.LYd(oa);mv.b(Ja,zb.x,zb.y);hr.VN.Vja(oa,!0);Ja=sc.SelectionFactory.vp(Ja,!0)}else if(1===r.length){jb=r.last;oa=$f.a.RMb(jb);if(hr.qc&&hr.qc.isFeatureEnabled(21)&&Object(zl.a)().hEg(oa).returnValue)return 2;oa=jb.Wc;jb=!r.Ww&&!(null===(zb=r.currentSelection)||
void 0===zb?0:zb.abb)&&(Le.a.rl(oa)||Ed.ParagraphReader.kn(oa)||Le.a.nba(oa))}jb&&(jb=Le.a.yk(ba,!1,!1,void 0,!1),A.lb.Kc(jb),y.AFrameworkApplication.va.Pf(h,ub.a.GE,2,!1,null,M),Ja=A.lb.gb.currentSelection,A.lb.Kc(ba));M||(M=new ji.DictionaryPropertySet);M.setValue(Bd.a.KZc,!0);y.AFrameworkApplication.va.Pf(h,ub.a.RJ,2,!0,null,M);if(Ja&&Ja.Qa.isValid)return A.lb.Kc(Ja),32;r.WL&&Ax.instance.T6i(b,h.Ok,A);Le.a.Fm(A.lb.gb.currentSelection)||y.AFrameworkApplication.va.Pf(h,ub.a.GE,2,!1,null,M);return 32}static MRl(b,
h){if(1===h)return 32;h=new Qb.GraphTransaction(7);h.Ab(b);hr.Of.JDa(b);h.dispose();return 32}}Object(u.a)(hr,"ADeleteActor",null,[]);var iN=d(247),BO=d(697);class En{get sg(){return ve.a.instance}SRl(b,h,r,A,M){A=null===M||void 0===M?void 0:M.Ltd;if(1===r)return 32;var ba=b===ub.a.backspace;if(this.sg.Ph){if(this.sg.SYi(h)&&En.uka&&(r=h.clone(),r.Tb+=1,--r.Fb,this.sg.Bpc(r)))return En.uka.TBj([r]),32;if(this.sg.r_f(h,ba))return 2}if(En.wy()&&En.wy().instance&&En.wy().instance.KX(h))return 4;const oa=
h.node;var Ja=h.cpBegin;r=h.cpEnd;let jb=h.Fb,zb=h.Tb;const Eb=Ed.ParagraphReader.text(oa),Sb=Eb.length;let nc=!1;if(Ja===r){if(ba&&!Ja||!ba&&Ja===Sb)return 2;ba?({cp:Ja,returnValue:nc}=this.sg.pfj(oa,Ja),nc||({cp:Ja,ira:jb,returnValue:nc}=this.sg.ofj(h,Ja,jb)),nc||(Ja--,C.a.bB(Eb,Ja)&&Ja--),b=ub.a.pkf):({cp:r,returnValue:nc}=this.sg.HQn(oa,r),nc||({cp:r,ira:zb,returnValue:nc}=this.sg.GQn(h,r,zb)),nc||(r++,C.a.bB(Eb,r)&&r++),b=ub.a.Awf)}Ja=Ja===r?vc.a.Tc(oa,Ja):vc.a.createTextRange(oa,Ja,r);wr.a.Rpb&&
(Ja.ffa=h.ffa,Ja.dsa=h.dsa);nc&&this.sg.Ph&&(ba?Ja.Fb=jb:Ja.Tb=zb);if(!this.sg.Bpc(Ja))return 2;this.YJb(oa);h=new Qb.GraphTransaction(15);h.Ei=b;h.Ab(oa);ba=Object(Za.a)(BO.a,M)&&M.U8a;if(!En.Pd.Ag||ba||En.uIa.Lfe($f.a.instance.gb.currentSelection))this.Cei(Ja,A);else{ba=En.Pd.v6a();try{const Dc=En.ti.gqd(Ja);let Zc;if(({type:Zc}=Dc.N9d()).returnValue){const Gd=Object(Ma.a)(234,M);Gd&&Gd.ka(Fe.a.AYf,!1)?En.Pd.LXb=Zc:En.Pd.ev(Zc)}M=0;for(let Gd=Dc.length-1;0<=Gd;--Gd){let de;const he=({vge:de}=Dc.getContext(Gd)).returnValue;
de?(En.Rp.Bvb(he,null),M+=En.Oj.Iyb(he,2),En.Oj.oYd=r+M):this.Cei(he,A)}}finally{ba&&ba.dispose()}}h.dispose();return 32}YJb(){}static get Pd(){return null!=En.f6g?En.f6g:En.f6g=$a.a.instance.resolve(46).instance}static get Oj(){return null!=En.T5g?En.T5g:En.T5g=$a.a.instance.resolve(39).instance}static get ti(){return null!=En.A6g?En.A6g:En.A6g=$a.a.instance.resolve(180).instance}static get Rp(){return null!=En.vYg?En.vYg:En.vYg=$a.a.instance.resolve(82)}static wy(){return En.ao||(En.ao=$a.a.instance.Ra(51))}static get uka(){En.aEb||
(En.aEb=$a.a.instance.Ra(19));return En.aEb.instance}static get uIa(){return null!=En.UTg?En.UTg:En.UTg=$a.a.instance.resolve(289)}}En.ao=null;En.aEb=null;Object(u.a)(En,"ADeleteParagraphContentStrategy",null,[]);var jN=d(223);class IA extends En{constructor(){super()}get Bg(){return null!=this.$Tg?this.$Tg:this.$Tg=$a.a.instance.resolve(323)}get Er(){return null!=this.RTg?this.RTg:this.RTg=$a.a.instance.Ra(11)}get Nrc(){return null!=this.F1g?this.F1g:this.F1g=$a.a.instance.resolve(275)}get L6(){return null!=
this.yUg?this.yUg:this.yUg=$a.a.instance.resolve(20)}get pU(){return null!=this.VWg?this.VWg:this.VWg=$a.a.instance.resolve(88)}Cei(b,h){this.dRl(b,h)}E4k(b,h,r,A){this.Er.instance&&this.Er.instance.Ph&&(b.cpBegin===h.cpBegin?b.Fb=h.Fb:r&&(b.Fb=r.Ib&&r.Ib.length?0:-1),b.Tb=A)}YJb(b){Jf.a.YJb(b)}dRl(b,h){var r=b.node;const A=jN.b([new Nb.a(b.cpBegin,b.cpEnd)],this.aRm(b));var M=new fb.a,ba=[];IA.Qvl(r,A,M,ba);for(const oa of M.keys)1<M.K(oa)&&jJ.a.qjj(P.a.Af(oa));this.xAo(r,ba);this.Nrc.OVc(r);r=b.Tb;
M=!!this.Er.instance&&this.Er.instance.Ph;for(ba=A.length-1;0<=ba;ba--)r=this.deleteRange(b,A[ba],r,M,h)}aRm(b){const h=[],r=b.node;var A=bm.f(r,oa=>oa.ika);for(var M of A)A=M.Jb.cp,h.push(new Nb.a(A,A+1));M=[];wr.a.BL?this.pU&&(M=this.pU.PJf(r,b)):M=Ed.ParagraphReader.WVa(r);for(var ba of M)this.Kpn(ba,b)&&h.push(ba);ba=!!this.Er.instance&&this.Er.instance.pta;this.Er.instance&&this.Er.instance.Ph||!ba||!r.Pv||(IA.j7h&&IA.j7h.szo(b),this.L6&&h.push(...this.L6.cwi(r).toArray()));return jN.a(h)}Kpn(b,
h){return wr.a.BL?this.pU?!this.pU.hXi(b,h):!1:!b.mN||!IA.gZf(b,h)}xAo(b,h){const r=new qb.a;for(const A of h)for(h=0;h<A.length;){h=this.fAi(A,h,0);if(-1===h)break;let M=this.fAi(A,h+1,3);if(-1===M)break;if(A.K(h).mN)for(;M>=h;){const ba=A.K(M);r.add(ba.te);A.remove(ba);M--}h=M+1}b.qna(r)}fAi(b,h,r){for(;h<b.length;h++){const A=b.K(h);if(1===A.mr&&A.pe===r)return h}return-1}deleteRange(b,h,r,A,M){const ba=h.Dc,oa=h.end;h=null;A&&(h=b.node.ra.Ch(ba));ba<oa&&(A=vc.a.createTextRange(b.node,ba,oa),wr.a.Rpb&&
(A.ffa=b.ffa,A.dsa=b.dsa),this.E4k(A,b,h,r),this.Bg.Ue(A,"",void 0,void 0,ub.a.$Tc,!1,M));return r=h&&h.Ib&&h.Ib.length?h.Ib.length:-1}static get j7h(){return null!=IA.IUg?IA.IUg:IA.IUg=$a.a.instance.Oa(625)}static gZf(b,h){return b.Dc>=h.cpBegin&&b.end<=h.cpEnd}static Qvl(b,h,r,A){let M=0;b=b.ra;for(const ba of h)for(;M<b.length;){h=b.K(M);if(h.cp>=ba.Dc&&h.cp<ba.end&&(h.nc&&h.nc.HAl&&A.push(h.nc),h.ei))for(let oa=0;oa<h.ei.length;oa++){const Ja=h.ei.K(oa).Ao.toString();r.mb(Ja)?r.W(Ja,r.K(Ja)+1):
r.W(Ja,1)}++M}}}Object(u.a)(IA,"DeleteParagraphContentStrategy",En,[]);class TL{static get jJ(){return iN.a.instance}static mSl(b,h,r){if(1===r)return 32;b=h.node;return TL.jJ.zUd(b)?hr.MRl(b,r):32}}Object(u.a)(TL,"DeleteUnsupportedObjectStrategy",null,[]);var UL=d(842),CO=d(520);class kN{constructor(b,h,r,A,M){this.hHp=b;this.oca=r;this.td=A;this.actionId=h;this.Ltd=M}}Object(u.a)(kN,"DeleteActionData",null,[]);class qj{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){this.Dei=b;this.sg=h;this.jJ=r;this.Rp=
A;this.l3=M;this.Mg=ba;this.Srj=oa;this.Bg=Ja;this.Pd=jb;this.uIa=zb}jpp(b){return!Le.a.gm(b)&&!Le.a.Zfa(b)}HLm(b,h,r){var A;let M,ba,oa;if(!h&&b&&b.Lw&&(A=b.Qa)&&Le.a.qf(A)&&this.Mg.Vb(A.node)&&(M=A.node.ra.Ch(A.cpBegin))&&M.yn&&(ba=this.Fmm(M))&&ba.hyperlink.DI&&(oa=this.vLm(b,ba.cp)))return oa;if(!b)return null;if(A=this.htp(b,h))return A;if(!r)return b;h=Le.a.I8a(b,!h,{ZE:!1,Ju:!0,iH:!0,hJ:!0});return sc.SelectionFactory.Yy(b,h.Qa,!1)}Fmm(b){const h=b.paragraph.ra;let r=null;b=b.cp;for(let A=
0;A<h.length;A++){const M=h.K(A);if(M.cp>=b)break;M.yn&&(r=null);M.hyperlink&&(r=M)}return r}yLm(b,h){var r=b.Qa.node;if(h){if(h=Le.a.Y_a(b.Qa.node,b.Qa.cpBegin,!0),b=sc.SelectionFactory.Yy(b,vc.a.Tc(b.Qa.node,h),!1),r=r.ra.Ch(h),r.G7||r.i0)b.Qa.Fb=0}else if(h=Le.a.Y_a(b.Qa.node,b.Qa.cpBegin,!1),b=sc.SelectionFactory.Yy(b,vc.a.Tc(b.Qa.node,h),!1),r=r.ra.Ch(h),r.G7||r.i0)b.Qa.Fb=r.qz+r.BS;b.soc=!0;return b}htp(b,h){var r=b.Qa;let A=null;if(!b.Lw||!r||!Le.a.qf(r))return null;if(this.Mg.Vb(r.node)&&
(A=h?r.node.ra.Ch(r.cpBegin):r.node.ra.v9a(r.cpBegin-1))&&A.QU)return this.yLm(b,h);r=zc.a.Za(b.Qa.node);if(!r.vb(8))return null;Ab.OutlineElementNavigator.ke(r);let M=!1;const ba=[];if(h?A&&A.ri:0===b.Qa.cpBegin){do(b=h?Ab.OutlineElementNavigator.at(r,!0,!0,!1):Ab.OutlineElementNavigator.N3(r,!0,!0,!1))&&(null===b||void 0===b?0:b.QWa)?(ba.push(vc.a.create(Ab.OutlineElementNavigator.Me(r))),Ab.OutlineElementNavigator.ke(r)):M=!0;while(!M);if(0<ba.length)return h=new or.Selection(h?ba:ba.reverse(),
h),h.soc=!0,h}return null}vLm(b,h){var r=Le.a.bKa(b,{ZE:!1,Ju:!1,iH:!0,hJ:!0});if(!r||!r.Lw||r.Qa.node!==b.Qa.node)return null;r=r.Qa;if(r.cpBegin!==r.cpEnd)return null;const A=this.Mg.text(r.node);for(let M=r.cpBegin-1;M>=h;M--)if(!C.a.Xw(A.charCodeAt(M)))return sc.SelectionFactory.Yy(b,vc.a.Tc(r.node,M+1),!1);return sc.SelectionFactory.Yy(b,vc.a.Tc(r.node,h),!1)}Pwf(b,h,r,A,M){var ba,oa;if(1===r)return 32;(r=null===(oa=null===(ba=h.view)||void 0===ba?void 0:ba.lb)||void 0===oa?void 0:oa.Ng)&&Object(zl.a)().Zci(r).filter(Ed.ParagraphReader.IX).forEach(Ja=>
{var jb;return null===(jb=Ed.ParagraphReader.zKa(Ja.node))||void 0===jb?void 0:jb.zye("delete_selection")});oa=!1;b===ub.a.evf?(b=ub.a.RJ,oa=!0):b===ub.a.jZd?(b=ub.a.backspace,oa=!0):b===ub.a.fAa&&(h=new Yt.a(qa.StaticActiveAppFrame.za().kb.Jc));if(!h.view.ue)return 2;ls.GrippersManager.instance.mA(!1);ba=b===ub.a.RJ;r=kt.a.C6d(h);if(oa&&this.sg.Ph&&r&&Le.a.Fm(r)&&this.sg.r_f(r.Qa,!ba,!0))return 2;oa=this.HLm(r,ba,oa);return this.oSl(b,h,A,M,oa,ba)}oSl(b,h,r,A,M,ba){var oa;const Ja=h.view,jb=Ja.lb;
var zb=A,Eb=A;b===ub.a.fAa&&(Eb=zb=null,M=new or.Selection(A,!0));if(!M)return 32;const Sb=this.q4o(zb,ba);if(this.sg.Ph&&qj.uka&&1===jb.gb.length&&Le.a.Fm(M)&&M.Lw&&qj.uka.FPo(M.Qa,ba)||wr.a.BL&&qj.pU&&1===jb.gb.length&&Le.a.Fm(M)&&M.Lw&&qj.pU.GPo(M.Qa,ba))return 32;let nc;ba?db.a.mark(nc=5009):db.a.mark(nc=5011);zb=new Qb.GraphTransaction(15);zb.Ei=b;zb.Ab(Ja.qd);let Dc=null,Zc=({QNo:Dc}=this.Dom(b,A,jb,M,Dc)).returnValue;var Gd=null;({eAe:Gd}=Object(zl.a)().hEg(Zc)).returnValue&&(Zc=Gd);if(!Zc)return zb.dispose(),
32;Gd=!1;y.AFrameworkApplication.nd("b1jb9393;09icj321");if(null===(oa=y.AFrameworkApplication.J)||void 0===oa?0:oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))oa=Zc.node,Gd=null===oa||void 0===oa?void 0:oa.Pv;const de=new kN(h,b,r,Eb,Gd);Eb=null;this.sg.Ph&&qj.uka&&(Eb=Object(zl.a)().XO(Zc),qj.uka.TBj(Eb));wr.a.BL&&wr.a.W7a&&qj.pU&&1===jb.gb.length&&!Le.a.Fm(M)&&(Eb||(Eb=Object(zl.a)().XO(Zc)),qj.pU.wzo(Eb));this.Q2j(Zc);const he=this.Ssi(Zc,M,ba);let fe=null;
ba?fe=new UL.a(M):he&&(fe=new UL.a(he));let Yd=!1;Eb=qj.hl;if(Le.a.qf(Zc)){const Td=WE.a.Jkc(Ja.qd,Sb);Eb.ee(()=>{this.ZQl(h,r,A,Zc,ba,fe,M,Td,jb,Sb,de,he)},"DVS:DAIPC")}else this.Pd.Ag&&!this.uIa.Lfe(M)?(Eb.ee(()=>{this.ipp(b,Ja.qd,Zc,ba,M,jb,Sb,de,fe)},"DVS:TCDC"),Yd=!0):Eb.ee(()=>{Yd=this.ktj(b,Ja.qd,Zc,jb,Sb,de,fe,Dc)},"DVS:PUD");this.abm(jb);this.VGj(Zc);zb.dispose();db.a.mark(nc+1);return b===ub.a.fAa?Yd?32:8:32}ktj(b,h,r,A,M,ba,oa,Ja){h=WE.a.Jkc(h,M);this.jpp(r)&&h.Afb(r);b=qj.Bc.wq(b);b.properties.W("CountOfParagraphsDeleted",
this.Mg.Hsf(r).toString());r=this.CWl(r,A,M,h,ba,oa,Ja);b.end();return r}ipp(b,h,r,A,M,ba,oa,Ja,jb){var zb=0,Eb=null;const Sb=Object(zl.a)().XO(r),nc=Sb[Sb.length-1];if(nc.contextId===mc.a.paragraph||nc.contextId===mc.a.Yc){var Dc=zc.a.Za(nc.node);Dc.Ld();Ab.OutlineElementNavigator.ke(Dc);Ab.OutlineElementNavigator.at(Dc,!0,!1)&&(Eb=Ab.OutlineElementNavigator.Me(Dc))&&(zb=this.Mg.textLength(Eb))}else zb=this.Mg.textLength(nc.node)-nc.cpEnd;Dc=Object(Ma.a)(234,Ja.td);if(Dc=!!Dc&&Dc.ka(Fe.a.AYf,!1))this.itj(b,
h,r,ba,oa,Ja,jb,!1,Dc);else{Dc=this.Pd.v6a();try{this.itj(b,h,r,ba,oa,Ja,jb,!0)}finally{Dc&&Dc.dispose()}}if(M.soc)zb=this.Ssi(r,M,A),this.Mg.Vb(zb.Qa.node)&&$f.a.instance.Kc(zb);else{if(A){if(r.Uw){b=Sb.length-1;do M=Sb[b],b--;while(!M.node.isConnected&&0<=b)}else M=r;if(!this.Mg.Vb(M.node))return;switch(nc.contextId){case mc.a.paragraph:case mc.a.Yc:zb=Eb&&Eb.isConnected?0:zb;break;case mc.a.Vc:case mc.a.Fd:break;default:zb=0}zb=sc.SelectionFactory.ve(M.node,this.Mg.textLength(M.node)-zb);M.Jj===
zb.Qa.cpBegin&&(zb.Qa.Fb=M.Fb)}else{zb=M.Qa.node;if(!this.Mg.Vb(zb))return;Eb=M.Qa.contextId===mc.a.paragraph?0:M.Qa.contextId===mc.a.Yc?this.Mg.textLength(zb):M.Qa.cpBegin;zb=sc.SelectionFactory.ve(zb,Eb)}$f.a.instance.Kc(zb)}}itj(b,h,r,A,M,ba,oa,Ja,jb=!1){r=this.yfm(A,r);r=qj.ti.gqd(r);({type:Eb}=r.N9d()).returnValue&&Ja&&4!==Eb&&this.Pd.ev(Eb);for(Ja=r.length-1;0<=Ja;--Ja){var zb=void 0;var Eb=({vge:zb}=r.getContext(Ja)).returnValue;zb?(zb=jb&&Eb.contextId===mc.a.Yc&&Ja===r.length-1,this.Rp.Bvb(Eb,
2),zb||qj.Oj.Iyb(Eb,2)):this.ktj(b,h,Eb,A,M,ba,oa,null)}}yfm(b,h){if(Object(Za.a)(hl.a,h)){b=wy.OutlineElementGeneralizer.gla(b.gb,!0);for(let r=0;r<b.length;r++)if(b.getContext(r).contextId===mc.a.table)return b}return h}Dom(b,h,r,A,M){b===ub.a.fAa?(b=lt.a.dJa(h),M=CO.SelectionReferenceFactory.instance.VMb()):(M=null,b=1===r.gb.length?$f.a.RMb(A):r.Ng);return{returnValue:b,QNo:M}}mml(b){return!b.Cl||b.contextId!==mc.a.paragraph||!this.Mg.Vb(b.node)||this.Pd.Ag||this.sg.jfe(b)?!1:!0}Q2j(b){if(b.Uw)for(let h=
0;h<b.length;h++)this.Q2j(b.getContext(h));else this.mml(b)&&(b.node.AUd=!0)}VGj(b){if(b.Uw)for(let h=0;h<b.length;h++)this.VGj(b.getContext(h));else b.Cl&&(b=b.node)&&this.Mg.Vb(b)&&(b.AUd=!1)}Ssi(b,h,r){if(b.Cl&&Le.a.qf(b)&&!r){const A=b.node;let M=b.cpBegin,ba=-1;if(({cp:M}=this.sg.pfj(A,M)).returnValue)return sc.SelectionFactory.ve(A,M);if(({cp:M,ira:ba}=this.sg.ofj(b,M,ba)).returnValue)return h=sc.SelectionFactory.ve(A,M),h.Qa.Fb=ba,h.Qa.Tb=ba,h}h=Le.a.I8a(h,!r,{ZE:!h.soc||h.Lw,Ju:!1,iH:!1,hJ:!0,
tza:Le.a.Fm(h)});this.sg.Ph&&Le.a.gm(b)&&(h.Qa.Tb=h.Qa.Fb=r?b.Tb:b.Fb);return h}ZQl(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb){const nc=qj.hl;!Le.a.aB(A.node,A,M)||this.sg.Ph&&this.sg.SYi(A)?nc.ee(()=>{this.DRl(A,M,ba,oa,Ja,jb,zb,Eb)},"DVS:IPM"):nc.ee(()=>{const {response:Dc,w4:Zc}=this.CRl(b,h,r,A,M,oa,Ja,jb,Eb,Sb);qj.Jhj(Ja,32===Dc);Zc&&qj.gva(jb,ba)},"DVS:ISE")}sXm(b,h){h.td||(h.td=new ji.DictionaryPropertySet);h.td.setValue(Fe.a.Wta,"delete");h.td.setValue(Fe.a.xma,"backspace");var r=mf.ListItemReader.De?
b:b.qE;const A=qj.Nd.b3(r),M=Qs.zzn;if(null===M||void 0===M?0:M.esn(r,A)){h.td.setValue(Fe.a.xma,"backspace-autocorrect");r=M.A3j+" ";const ba=vc.a.Tc(b,0);this.Bg.Ue(ba,r);b=sc.SelectionFactory.ve(b,r.length);$f.a.instance.Kc(b);v.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",M.A3j)}return y.AFrameworkApplication.va.Pf(h.hHp,A.$z?ub.a.aO:ub.a.fF,2,!1,h.oca,h.td)}OWm(b,h,r,A,M){let ba=!1;0<this.Srj.Y2(b).Uu&&(M=y.AFrameworkApplication.va.Pf(h,ub.a.zvc,2,!1,r,A),ba=!0);
return{uX:ba,response:M}}VWm(b,h,r,A,M){let ba=!1;0<this.Srj.xI(b).Uu&&(M=y.AFrameworkApplication.va.Pf(h,ub.a.Gkd,2,!1,r,A),ba=!0);return{uX:ba,response:M}}bYm(b,h,r,A,M){let ba=!1;qj.ir.GLb(b)&&(M=y.AFrameworkApplication.va.Pf(h,ub.a.XI,2,!1,r,A),ba=!0);return{uX:ba,response:M}}yVm(b,h,r,A,M,ba,oa,Ja,jb,zb){const Eb=new sn.a;Eb.kd(h);let Sb=!1;if(Ab.OutlineElementNavigator.vMa(Eb,!1,!b,!1)){zb=!0;jb=32;Sb=!0;(new zc.a).kd(Eb);Ab.OutlineElementNavigator.Me(Eb);const Dc=Eb.currentNode;Ed.ParagraphReader.Hza(Dc)&&
Ed.ParagraphReader.zKa(Dc).zye("delete_ip");var nc=new zc.a;nc.set(oa);(nc=this.Mg.isEmpty(nc))&&M&&Le.a.nba(M.Qa)?(r.Afb(ba),Ab.OutlineElementNavigator.Me(h),qj.Of.JDa(h.currentNode)):Dc.RL?(r.Afb(ba),Ab.OutlineElementNavigator.ke(Eb),Eb.Tg()):b&&nc?this.sg.C0i(oa)&&!({w4:zb}=this.iwj(b,oa,Dc,M,zb)).returnValue&&(r.Afb(ba),qj.Ll.dha(h),this.Dei.Vgo(oa),h.Tg()):Hi.TableReader.isTable(Eb)?(r.Afb(ba),b&&(bi.moveToFirstRow(Eb),bi.moveToFirstColumn(Eb),to.OutlineNavigator.Mba(Eb),Ab.OutlineElementNavigator.Me(Eb),
Ja.Kc((new UL.a(sc.SelectionFactory.ve(Eb.currentNode,0))).restore())),jb=2,zb=!1):this.Mg.Vb(Dc)&&(1==this.Mg.textLength(Dc)&&(Ja=bm.e(Dc),1==Ja.length&&8==Ja[0].$h&&(Ja=vc.a.createTextRange(Dc,0,1),this.Bg.Ue(Ja,"",void 0,void 0,ub.a.$Tc))),({w4:zb}=this.iwj(b,oa,Dc,M,zb)).returnValue||(A.actionId==ub.a.backspace&&r.wAc(oa),this.Dei.$Ql(b,r,ba,h,oa,Eb)))}return{uX:Sb,response:jb,w4:zb}}iwj(b,h,r,A,M){if(this.Pd.Ag){if(qj.yUa){const ba=Object(Za.a)(Pn.AParagraphNode,r)?qj.yUa.kfe(r):!1,oa=Object(Za.a)(Pn.AParagraphNode,
h)?qj.yUa.kfe(h):!1;if(ba!==oa)return{returnValue:!1,w4:M}}b=b?h:r;if(!Object(Za.a)(Pn.AParagraphNode,b))return{returnValue:!1,w4:M};h=b.ra.last;r=y.AFrameworkApplication.userName;if(!h.Wi||h.Wi.authorName!==r)return qj.Oj.u0b(b,2),A&&($f.a.instance.Kc(A),M=!1),{returnValue:!0,w4:M}}return{returnValue:!1,w4:M}}kXm(b,h,r,A,M,ba,oa,Ja){Ua.a.Bln(h,b)||({response:oa,w4:Ja}=qj.wXl(r,A,b,ba,M,oa,Ja));return{uX:!1,response:oa,w4:Ja}}CRl(b,h,r,A,M,ba,oa,Ja,jb,zb){let Eb=!1,Sb=2;const nc=A.node;let Dc=void 0,
Zc=!1;const Gd=qj.hl;if(!M){if(mf.ListItemReader.De?mf.ListItemReader.isListItem(nc):nc.qE)return Gd.ee(()=>{Sb=this.sXm(nc,jb)},"DVS:HLOE"),{response:Sb,w4:Eb};Gd.ee(()=>{({response:Sb,uX:Zc}=this.OWm(nc,b,h,r,Sb))},"DVS:HIOD");if(Zc)return{response:Sb,w4:Eb};Gd.ee(()=>{({response:Sb,uX:Zc}=this.VWm(nc,b,h,r,Sb))},"DVS:HWPF");if(Zc)return{response:Sb,w4:Eb};Dc=this.OAi(nc);Gd.ee(()=>{({response:Sb,uX:Zc}=this.bYm(Dc,b,h,r,Sb))},"DVS:HPOB");if(Zc)return{response:Sb,w4:Eb}}null!==Dc&&void 0!==Dc?Dc:
Dc=this.OAi(nc);Gd.ee(()=>{({response:Sb,uX:Zc,w4:Eb}=this.yVm(M,Dc,oa,jb,zb,A,nc,Ja,Sb,Eb))},"DVS:HAOE");if(Zc)return{response:Sb,w4:Eb};Gd.ee(()=>{({response:Sb,uX:Zc,w4:Eb}=this.kXm(M,Dc,h,r,oa,ba,Sb,Eb))},"DVS:HFLOE");return{response:Sb,w4:Eb}}z4o(b){return Le.a.gm(b)||this.jJ.$3i(b)||Le.a.Zfa(b)}q4o(b,h){return b&&b.hasProperty(Bd.a.KZc)?!b.ka(Bd.a.KZc,!1):!h}static get Nd(){return null!=qj.l1g?qj.l1g:qj.l1g=$a.a.instance.resolve(10)}static get Ll(){return null!=qj.b1g?qj.b1g:qj.b1g=$a.a.instance.resolve(31)}static get Of(){return null!=
qj.f2g?qj.f2g:qj.f2g=$a.a.instance.resolve(16)}static get ir(){return rv.a.DQb}static get Oj(){return null!=qj.W5g?qj.W5g:qj.W5g=$a.a.instance.resolve(39).instance}static get ti(){return null!=qj.D6g?qj.D6g:qj.D6g=$a.a.instance.resolve(180).instance}static get Bc(){return Wg.a.instance}static get uka(){qj.aEb||(qj.aEb=$a.a.instance.Ra(19));return qj.aEb.instance}static get pU(){qj.ZFf||(qj.ZFf=$a.a.instance.Ra(88));return qj.ZFf.instance}static get yUa(){return null!=qj.LUg?qj.LUg:qj.LUg=$a.a.instance.Oa(13)}static get hl(){return vp.a.instance}abm(b){if(1===
b.gb.length&&(b=b.gb.K(0),Le.a.Fm(b))){var h=b.Qa;b=h.node;h=h.cpBegin;var r=this.Mg.text(b);h<r.length&&0<h&&" "===r.charAt(h-1)&&" "===r.charAt(h)&&this.Bg.Ue(vc.a.createTextRange(b,h-1,h),"\u00a0")}}Pcl(b,h){if(!h.hyperlink.stb){const r=new Qb.GraphTransaction(15);try{r.Ab(b.node),this.l3.rV(b,h)}finally{r&&r.dispose()}h.hyperlink.DI&&this.Pd.ev(2)}}static wXl(b,h,r,A,M,ba,oa){if(r=Le.a.I8a(A,!r,{ZE:!1,Ju:!1,iH:!1,hJ:!0})){A=sc.SelectionFactory.Yy(A,r.Qa);ba=32;for(r=0;r<A.length;++r){M.Afb(A.K(r));
const Ja=y.AFrameworkApplication.va.Pf(A.K(r),ub.a.RJ,2,!0,b,h);2!==Ja&&(ba=Ja)}32===ba&&(oa=!0)}return{response:ba,w4:oa}}CWl(b,h,r,A,M,ba,oa){let Ja=!1;this.A4o(b)?(Ja=qj.jyf(b,!0,h,r,A,M))&&qj.tPa(ba,h,oa):this.z4o(b)?(Ja=qj.jyf(b,!1,h,r,A,M))&&qj.tPa(ba,h,oa):(A.normalize(),qj.tPa(ba,h,oa));return Ja}static tPa(b,h,r){r&&r.gva()||qj.gva(h,b)}static jyf(b,h,r,A,M,ba){var oa;A||Lj.OutlineReader.CXa(b)||(r=qj.Hsd(r))&&M.J0o(r);y.AFrameworkApplication.nd("b1jb9393;09icj321");if(null===(oa=y.AFrameworkApplication.J)||
void 0===oa?0:oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))ba.td?ba.td.Ltd=ba.Ltd:ba.td={Ltd:ba.Ltd};oa=b instanceof hl.a?b.getContext(0).node:b.node;oa=qj.zEm(oa);b=32===y.AFrameworkApplication.va.Pf(b,ba.actionId,2,h,ba.oca,ba.td);qj.Jhj(M,b,oa);return b}static get xj(){return null!=qj.JXg?qj.JXg:qj.JXg=$a.a.instance.resolve(101)}static get szb(){return null!=qj.D4g?qj.D4g:qj.D4g=$a.a.instance.resolve(8)}static zEm(b){const h=new aj.a;if(b){let r=null;b=sc.SelectionFactory.vp(b,
!0);if(!b)v.ULS.sendTraceTag(509645905,315,10,"Unexpected null selection.");else for(let A=0;A<b.length;A++)if(xa.FormattingReader.Crf(b.K(A))){r=b.K(A);break}r&&((b=xa.FormattingReader.Us(r))&&b.cache&&b.cache.DE&&(b=b.Mf(null),qj.xj.z8(b)),b&&(h.formatting=b.Lk,h.languageId=xa.FormattingReader.language(b)),h.uoa=qj.szb.Hq(r.node))}return h}static Jhj(b,h,r){h?b.normalize(r):b.cancel()}static gva(b,h){h&&qj.hl.ee(()=>{const r=h.restore();r&&b.Kc(r)},"DVS:RS")}DRl(b,h,r,A,M,ba,oa,Ja){let jb;!h&&({hyperlink:jb}=
this.l3.Doc(b)).returnValue?(r=new UL.a(A),this.Pcl(b,jb),M.normalize(),qj.gva(ba,r)):qj.jyf(b,!1,ba,oa,M,Ja)&&(h&&this.Pd.Ag?(h=qj.Oj.oYd)?(ba.Kc(sc.SelectionFactory.ve(b.node,h)),qj.Oj.oYd=null):qj.gva(ba,r):qj.gva(ba,r))}A4o(b){return b.Uw||Lj.OutlineReader.CXa(b)||this.Mg.kn(b)}static Hsd(b){return(b=wy.OutlineElementGeneralizer.gla(b.gb,!0))&&1===b.length&&(b=b.getContext(0).node,Hi.TableReader.OU(b))?b:null}OAi(b){const h=new zc.a;h.set(b);h.Ld();Ab.OutlineElementNavigator.ke(h);return h}}qj.aEb=
null;qj.ZFf=null;Object(u.a)(qj,"ADeleteViewStrategy",null,[]);class ju{$Ql(b,h,r,A,M,ba){const oa=ba.currentNode;Ab.OutlineElementNavigator.ke(ba);b?(h.wAc(ba.currentNode),ju.sg.h_i(r,M,oa,!1)||ju.Of.merge(A,ba,!1,!1)):ju.sg.h_i(r,oa,M,!0)||ju.Of.merge(ba,A,!1,!1)}Vgo(b){b&&Ed.ParagraphReader.Vb(b)&&(dD.a.Akd(b),ju.Dzf.khf(b))}static get Of(){return null!=ju.b2g?ju.b2g:ju.b2g=$a.a.instance.resolve(16)}static get Dzf(){return null!=ju.vVg?ju.vVg:ju.vVg=$a.a.instance.resolve(1099)}static get sg(){return ve.a.instance}}
Object(u.a)(ju,"DeleteParagraphNodeStrategy",null,[589]);class rO extends qj{constructor(b,h,r,A,M,ba,oa,Ja,jb){super(new ju,b,h,r,A,M,ba,oa,Ja,jb)}}Object(u.a)(rO,"DeleteViewStrategy",qj,[]);class yM extends hr{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb){super();this.deleteParagraph=(nc,Dc)=>{nc=Dc.node;dD.a.Akd(nc);this.pAd.khf(nc);this.Gp&&this.Gp.instance&&this.Gp.instance.Nmj(nc);nc.Pv&&(this.Xm.rzo(nc,!this.Ph),this.Ph&&this.ijh.instance&&this.ijh.instance.e7j(nc));return 0};this.YQl=(nc,Dc,
Zc)=>{if(1===Zc)return 32;nc=qa.StaticActiveAppFrame.za().$r.Xf("ModelUpdate","DeleteAnchoredObject");Dc=Dc.node;Zc=new zc.a;Zc.set(Dc);Zc.vb(12);var Gd=Zc.Fp(12);if(ve.a.instance.p$c(Gd))return 2;Jf.a.YJb(Gd);Gd=new Qb.GraphTransaction(7);Gd.Ab(Dc);Zc.Tg();Gd.dispose();nc.stop();return 32};this.Wtk=new IA;this.Ytk=new rO(ve.a.instance,iN.a.instance,ba,oa,Ja,jb,zb,Eb,Sb);this.Xm=b;this.pIc=h;this.ijh=r;this.pAd=A;this.Gp=M}get Ph(){return this.pIc.instance?this.pIc.instance.Ph:!1}get Mei(){return this.Ytk}get Bei(){return this.Wtk}frg(b,
h,r,A){const M=TL.mSl,ba=this.YQl;b.qa(ub.a.backspace,mc.a.V$,ba);b.qa(ub.a.backspace,mc.a.kPa,M);b.qa(ub.a.RJ,mc.a.V$,ba);b.qa(ub.a.RJ,mc.a.kPa,M);b.qa(ub.a.backspace,mc.a.paragraph,this.deleteParagraph);b.qa(ub.a.RJ,mc.a.paragraph,this.deleteParagraph);b.qa(ub.a.fAa,mc.a.paragraph,this.deleteParagraph);b.Pc(ub.a.fAa,64);super.frg(b,h,r,A)}static YJb(b){var h;(null===(h=Jf.a.vd())||void 0===h?0:h.wn)&&Jf.a.vd().Fk.NG(b)}}Object(u.a)(yM,"DeleteActor",hr,[]);var KK=d(448);class LK{constructor(){this.Height=
this.Width=0}static construct(b,h){const r=new LK;r.Width=b;r.Height=h;return r}}Object(u.a)(LK,"ViewportInfo",null,[]);class VL extends mh.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}en(){return KK.a.mip}static construct(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){const Sb=new VL;Sb.ContractVersion=b;Sb.DocumentContent=h;Sb.EnhancementId=
r;Sb.World=A;Sb.ScalingFactor=M;Sb.DesktopViewportInfo=LK.construct(ba,oa);Sb.MobileViewportInfo=LK.construct(Ja,jb);Sb.MinParagraphCount=zb;Sb.ContentCulture=Eb;return Sb}}Object(u.a)(VL,"SwayPreviewRequest",mh.a,[]);var DO=d(596);class $B{static get lh(){y.AFrameworkApplication.nd("wwa11yq3;wwa11yq3cf");return ug.a.ry(df.a.instance&&df.a.instance.A4i?$B.uUl:$B.Qn,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,
$B.NMo,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}$B.NMo=Li.a.li("progress.gif");$B.Qn="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
$B.uUl="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(u.a)($B,"DigitalPrintDialogHtml",null,[]);class lv{constructor(b,h,r,A){this.fontFamily=b;this.vJo=h;this.fontWeight=r;this.fontStyle=A}}Object(u.a)(lv,"FontInfo",null,[]);class Rr{constructor(b,h,r,A){this.styleName=b;this.title=h;this.Zmp=r;this.d1m=A}}Object(u.a)(Rr,"StyleVisualInfo",null,[]);class ND extends ug.a{constructor(b,h,r,A,M=!0){super();this.Y9=this.Om=this.Kpa=this.P5=this.TCd=this.cHh=this.VNd=this.I$e=this.J$e=this.$9e=this.Yac=this.VSa=this.c6=this.qac=null;this.ucf=this.g6e=
!1;this.IBd=null;this.CYl=()=>{this.cKj(0)};this.BYl=(ba,oa)=>{this.cKj(oa)};this.dpj=ba=>{this.TAi(ba)===Sys.UI.Key.enter&&(this.rhg(ba),ba.preventDefault(),ba.stopPropagation())};this.nlj=ba=>{((ba=ba.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ba.id||ba.id===nf.a.owd)||X.a.Mt)&&this.VSa&&this.V_b(this.VSa)};this.olj=ba=>{const oa=this.TAi(ba);oa!==Sys.UI.Key.tab&&oa!==Sys.UI.Key.left&&oa!==Sys.UI.Key.right&&oa!==Sys.UI.Key.up&&oa!==Sys.UI.Key.down||this.GYm(oa)||(ba.preventDefault(),
ba.stopPropagation(),this.S_n(oa))};this.vfg=()=>{this.ucf||(this.ucf=!0,v.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),uf.a.removeHandler(this.c6,zd.a.scroll,this.vfg))};this.bgg=()=>{v.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.rhg=ba=>{ba.preventDefault();ba.stopPropagation();y.AFrameworkApplication.va.Ob(ub.a.fgi,2);ba.target?(ba="button"===ba.target.tagName.toLowerCase()?ba.target:ba.target.parentNode)&&ba.id!==this.qac&&(v.ULS.sendTraceTag(25231813,382,
50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.qac,ba.id),this.X0h(ba),this.Eai()):v.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.cVl=ba=>{const oa=(new Date).getTime()-this.Peh;mg.a.instance.tf(Ph.a.eVl,oa);ba?this.TRo():(v.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),y.AFrameworkApplication.va.Ob(ub.a.egi,2))};this.RRo=()=>
{this.dap();try{const ba=ND.Fhi.p6l(),oa=VL.construct(2,ba,this.qac,"VerticalWorld",.3,1366,600,330,280,20,ND.Fhi.Lhb.name);y.AFrameworkApplication.Ge.Xj(String.format("{0}/we/GetSwayPreview.ashx?{1}",df.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature),2,DO.b(oa),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.cio,this.yvj,oa)}catch(ba){v.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ba.message)}};this.cio=
ba=>{var oa=null;({group:oa}=Ck.a.N4(ba.data.Ee)).returnValue?(oa=oa.Responses[0],oa.Succeeded?(this.Cie(ba.data,Ph.a.nip),this.Enb(),this.MPj(this.I$e,oa.PreviewHtml),this.MPj(this.VNd,oa.PreviewHtmlMobile)):this.yvj(null)):v.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.yvj=()=>{this.eap();this.J$e.style.background="#E6E6E6";this.cHh.style.background="#E6E6E6"};this.lh=$B.lh;this.Pg="DigitalPrintDialog";v.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.IKk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.v6b=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.YPk=r;this.NHc=A;this.Qe(1,this.IKk);this.gi(this.v6b,this.cVl,null);this.q9m();this.Vgp();this.Peh=(new Date).getTime();M&&Yu.a.sU(ZB.a.Nxf,!1,this.CYl,this.BYl,null);this.F$m();this.P7m();this.XCn();this.R5f();this.OCn();this.Eai()}get HAa(){return this.IBd}cKj(b){if(!this.g6e){const h=
(new Date).getTime()-this.Peh;mg.a.instance.tf(Ph.a.dVl,h);b?v.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",xt.a[b])):v.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.D6a.disabled=!1}}q9m(){this.Yac=document.getElementById("digitalPrintStatusMessageDiv");this.$9e=document.getElementById("digitalPrintStatusMessageIconDiv");this.J$e=document.getElementById("swayDesktopPreviewWrapperDiv");
this.I$e=document.getElementById("swayDesktopPreviewHtmlHolder");this.VNd=document.getElementById("swayMobilePreviewHtmlHolder");this.cHh=document.getElementById("swayMobilePreviewWrapperDiv");this.c6=document.getElementById("swayGallery");this.c6.setAttribute("tabindex","0");uf.a.addHandler(this.c6,zd.a.scroll,this.vfg);this.c6.setAttribute(Pe.a.Sh,Pe.a.wUh);this.P5=document.getElementById("digitalPrintLearnMoreLink");this.P5.href="https://go.microsoft.com/fwlink/?linkid=871972";uf.a.addHandler(this.P5,
zd.a.click,this.bgg);this.Kpa=new qb.a;this.TCd=document.getElementById("homeWrapper");this.H8("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.NHc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}F$m(){this.Om=new qb.a;this.Om.add(new Rr("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.Om.add(new Rr("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Om.add(new Rr("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Om.add(new Rr("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.Om.add(new Rr("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.Om.add(new Rr("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Om.add(new Rr("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Om.add(new Rr("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Om.add(new Rr("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Om.add(new Rr("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Om.add(new Rr("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Om.add(new Rr("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Om.add(new Rr("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Om.add(new Rr("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Om.add(new Rr("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Om.add(new Rr("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Om.add(new Rr("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Om.add(new Rr("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Om.add(new Rr("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Om.add(new Rr("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Om.add(new Rr("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Om.add(new Rr("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}P7m(){this.Y9=
new qb.a;this.Y9.add(new lv("universc","universc","normal","normal"));this.Y9.add(new lv("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.Y9.add(new lv("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.Y9.add(new lv("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.Y9.add(new lv("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.Y9.add(new lv("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.Y9.add(new lv("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.Y9.add(new lv("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.Y9.add(new lv("ArialNova","ArialNova","normal","normal"));this.Y9.add(new lv("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.Y9.add(new lv("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.Y9.add(new lv("RockwellNova","RockwellNova","normal","normal"));
this.Y9.add(new lv("SabonNRegLT","SabonNRegLT","normal","normal"));this.Y9.add(new lv("DaytonaThin","DaytonaThin","100","normal"))}XCn(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const r of this.Y9)h+=String.format(this.YPk,r.fontFamily,r.vJo,r.fontWeight,r.fontStyle);b.innerText=h;this.TCd.appendChild(b)}OCn(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
Li.a.li("SwayPreviewFrame.svg")),r=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",Li.a.li("SwayPreviewFrameHC.svg"));b.innerText=h+r;X.a.Ur&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.TCd.appendChild(b)}TAi(b){return b?b.keyCode:window.event.keyCode}hide(){this.Urg();super.hide()}Urg(){if(this.c6&&!this.g6e){for(let b=0;b<this.Kpa.count;b++)uf.a.removeHandler(this.Kpa.K(b),
zd.a.click,this.rhg),uf.a.removeHandler(this.Kpa.K(b),zd.a.kj,this.dpj);uf.a.removeHandler(this.c6,zd.a.kj,this.olj);uf.a.removeHandler(this.c6,zd.a.focus,this.nlj);uf.a.removeHandler(this.P5,zd.a.click,this.bgg);this.ucf||uf.a.removeHandler(this.c6,zd.a.scroll,this.vfg);this.g6e=!0}}R5f(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",Li.a.Pfl());this.TCd.appendChild(b);for(const h of this.Om)this.Otf(this.c6,h);this.q4(this.c6);
this.X0h(this.c6.firstChild);this.c6.firstChild.focus();uf.a.addHandler(this.c6,zd.a.kj,this.olj);uf.a.addHandler(this.c6,zd.a.focus,this.nlj)}Otf(b,h){const r=document.createElement("button");r.className="swayGalleryItem swayClip136x90 swayImageBorderButton";r.setAttribute(Pe.a.Nmb,Pe.a.WO);r.setAttribute("title",h.title);r.setAttribute(Pe.a.Sh,Pe.a.zUh);r.id=h.styleName;b.appendChild(r);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=Li.a.li("swayPublish.png");b.setAttribute(Pe.a.Sh,Pe.a.FA);b.setAttribute("unselectable","on");b.setAttribute(Pe.a.EA,Pe.a.qq);b.id=h.styleName+"img";r.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.Zmp;b.setAttribute(Pe.a.EA,Pe.a.qq);b.setAttribute("unselectable","on");b.setAttribute(Pe.a.Sh,Pe.a.FA);r.appendChild(b);const A=document.createElement("label");A.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;A.className=h.d1m;A.setAttribute(Pe.a.EA,
Pe.a.qq);b.setAttribute("unselectable","on");A.setAttribute(Pe.a.Sh,Pe.a.FA);r.appendChild(A);uf.a.addHandler(r,zd.a.click,this.rhg);uf.a.addHandler(r,zd.a.kj,this.dpj);this.Kpa.add(r)}S_n(b){const h=this.HAa;this.zcm(b,h,!y.AFrameworkApplication.isRtl)||this.Bcm(b,h,!y.AFrameworkApplication.isRtl)||this.wcm(b,h)||this.xcm(b,h)}GYm(b){return b===Sys.UI.Key.tab?(this.HAa&&this.HAa!==this.VSa&&(this.HAa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.IBd=this.VSa),!0):!1}zcm(b,
h,r){return b===Sys.UI.Key.right&&r||b===Sys.UI.Key.left&&!r?(b=(b=h.nextSibling)||this.c6.firstChild,this.V_b(b),!0):!1}Bcm(b,h,r){return b===Sys.UI.Key.left&&r||b===Sys.UI.Key.right&&!r?(b=(b=h.previousSibling)||this.c6.lastChild,this.V_b(b),!0):!1}wcm(b,h){return b===Sys.UI.Key.down?(b=this.Kpa.indexOf(h),h=b+2,h<this.Kpa.count?(b=this.Kpa.K(h))&&this.V_b(b):(h=b%2+1,h=2<=h?0:h,(b=this.Kpa.K(h))&&this.V_b(b)),!0):!1}xcm(b,h){b===Sys.UI.Key.up&&(b=this.Kpa.indexOf(h),h=b-2,0<=h?(b=this.Kpa.K(h))&&
this.V_b(b):(h=b?20+b-1:this.Kpa.count-1,(b=this.Kpa.K(h))&&this.V_b(b)))}V_b(b){this.HAa&&this.HAa.id!==this.VSa.id&&(this.HAa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.IBd=b;this.HAa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.HAa.focus()}Vgp(){this.D6a.className="WACDialogButtonNormal swayPrintToWebButton";this.D6a.setAttribute("tabindex","0");this.sB.className="WACDialogButtonNormal swayCancelButton";
this.sB.setAttribute("tabindex","0");this.D6a.disabled=!0}X0h(b){this.HAa&&(this.HAa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.VSa&&(this.VSa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.VSa.setAttribute(Pe.a.Nmb,Pe.a.WO));this.qac=b.id;this.VSa=b;this.VSa.setAttribute(Pe.a.Nmb,Pe.a.qq);this.IBd=b;this.HAa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}Eai(){me.a.instance.Yb(new wc.a(2,
1,50,this.RRo))}MPj(b,h){b.innerHTML=h}TRo(){v.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.qac));y.AFrameworkApplication.va.Ob(ub.a.ggi,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",df.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature,y.AFrameworkApplication.userSessionId,this.qac);Te.a.openWindow(4,b)}Cie(b,h){mg.a.instance.tf(h,+b.bP-+b.rH)}eap(){var b=WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;
this.Enb();this.Yac.innerText=b;this.Yac.style.display="block"}dap(){this.Enb();this.$9e.style.display="block";this.Yac.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.Yac.style.display="block"}Enb(){this.J$e.style.background="";this.VNd.style.background="";xd.a.ZT(this.I$e);xd.a.ZT(this.VNd);this.Yac.style.display="none";this.$9e.style.display="none"}static get Fhi(){return null!=ND.rVg?ND.rVg:ND.rVg=$a.a.instance.Oa(1100)}}Object(u.a)(ND,"DigitalPrintDialog",ug.a,
[]);class XL{constructor(b,h){this._context=this.ul=null;this.LMe=0;this.Qxd=!1;this.TFh=null;this.Nxf=(r,A,M,ba,oa)=>{if(1===M)return y.AFrameworkApplication.BH?8:32;this.TFh=oa.SourceControlId;if(y.AFrameworkApplication.J.$("IsAnonymousUser"))return v.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),this.lyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=A;if(XL.cpn())return v.ULS.sendTraceTag(34373828,
382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.ltf(),32;switch(this.LMe){case 1:v.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.ltf();break;case 2:v.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");this.lyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.Qxd=
!1,this.ul=(new ep.a).create(),this.ul.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.ul.rM(CommonUIStrings.l_DefaultDialogTitle,this.frl,null),y.AFrameworkApplication.Ge.Xj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",df.a.webServiceBase,y.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.hrl,this.grl,null)}return 32};this.frl=()=>{this.Qxd=!0;v.ULS.sendTraceTag(34373831,382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};
this.hrl=r=>{if(!this.Qxd){this.ul.close();var A=null;this.Cie(r.data,Ph.a.lip);({group:A}=Ck.a.N4(r.data.Ee)).returnValue?(r=A.Responses[0],v.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",r.HasLicense,r.Succeeded),r.Succeeded?(this.LMe=r.HasLicense?1:2,2===this.LMe?this.lyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):this.ltf()):this.lyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):
(v.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.lyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.grl=r=>{this.Qxd||(this.ul.close(),v.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.Cie(r.data,Ph.a.kip),this.lyc(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};this.ga=b;this.N9=h}Wb(){y.AFrameworkApplication.I0?
v.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&y.AFrameworkApplication.J.$("DisablePrint")?v.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.fb(ub.a.tZc,mc.a.view,this.Nxf,4),this.ga.fb(ub.a.fgi,mc.a.view,kd.ActionManager.nU,4),this.ga.fb(ub.a.ggi,mc.a.view,kd.ActionManager.nU,4),this.ga.fb(ub.a.egi,mc.a.view,kd.ActionManager.nU,4),
this.ga.fb(La.a.D_d,mc.a.view,kd.ActionManager.nU,4))}ltf(){v.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.TFh);new ND(this._context,this.ga,y.AFrameworkApplication.J.jb("SwayFontDownloadUrlTemplate"),y.AFrameworkApplication.J.jb("FileSource"))}lyc(b){const h=new kh.StandardDialog;h.Ed=0;h.Nna(CommonUIStrings.l_DefaultDialogTitle,b,null)}Cie(b,h){mg.a.instance.tf(h,+b.bP-+b.rH)}static cpn(){return"OneDriveWOPI"===
y.AFrameworkApplication.J.jb("FileSource")}}Object(u.a)(XL,"DigitalPrintActor",null,[]);class MK{constructor(){this.YIh=null}yaj(){v.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}V4j(b){if(!b)return v.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.k4i(b.errorDetails))return!1;this.YIh=Object(Ma.a)(vn.a,b.errorDetails).typeId;return!0}gpd(b){return this.k4i(b)?Object(Ma.a)(vn.a,b).typeId===this.YIh:!1}k4i(b){if(!b)return v.ULS.sendTraceTag(25007843,
375,15,"No ErrorDetails found"),!1;b=Object(Ma.a)(vn.a,b);return b?b.token&&b.typeId?!0:(v.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(v.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(u.a)(MK,"DoNotCheckThisCritiqueTypeStrategy",null,[563]);class NK extends ug.a{constructor(b,h,r){super(!1,!1,!0);this.Qb=b;this.nsa=r;this.Guk="DocumentChoiceGroup";this.qgh="EmbededContent";this.Vlh="HyperLink";this.RZe=r.Dhb;b={["id"]:"ExternalContentDefaultSettingsDialog",
["bodyControls"]:this.k2c()};this.bqk=this.W5l.bind(this);this.Qe(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.gi(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.bqk,b)}k2c(){const b=Array(2);b[0]={["key"]:this.qgh,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.Vlh,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};const h={};h.documentChoiceGroupProps=
{["id"]:this.Guk,["defaultSelectedKey"]:this.RZe?this.qgh:this.Vlh,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}W5l(b,h){1===b?(this.RZe!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?Hc.a.sVa:Hc.a.Ipb,this.Qb.Ob(b,2),this.RZe=h.isExternalContentSelected,ca.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new fa.a,{name:"ActionId",int64:b})]}))),this.nsa.mNo(h.isExternalContentSelected)):0===b&&v.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}Object(u.a)(NK,
"ExternalContentDefaultSettingsDialog",ug.a,[]);class Gr{constructor(b,h,r,A,M){this.pO=$a.a.instance.resolve(731);this.aCb=Ng.a.On;this.hyc=()=>{const ba=Array(1);ba.push("ExternalContent");var oa=$a.a.instance.resolve(1101).XVa();oa=Object.assign(new yz.a,{x:oa.x,y:oa.y});this.pO.showFloatie(oa,ba,1);return 32};this.ORb=()=>{this.pO.t3&&this.pO.dismissFloatie();return 32};this.vxj=(ba,oa,Ja,jb,zb)=>{if(oa="object"===typeof zb?zb:null)ba===Hc.a.Eog?(ba=Gr.s3a!==Hc.a.sVa&&Gr.s3a!==Hc.a.Ipb,oa[this.aCb]=
Gr.s3a===Hc.a.sVa||ba):ba===Hc.a.Fog&&(oa[this.aCb]=Gr.s3a===Hc.a.Ipb);return 32};this.zmi=(ba,oa,Ja)=>{1!==Ja&&(ba===Hc.a.Ipb&&Gr.s3a!==Hc.a.Ipb?(v.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.In.undo()&&(oa=new Ly.a(1,y.AFrameworkApplication.isRtl),oa.$gd="ExternalContent",Gr.Hpb.Ajd(oa))):ba===Hc.a.sVa&&Gr.s3a!==Hc.a.sVa&&(v.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1),this.jhh.Uyj()),Gr.s3a=ba);ca.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new fa.a,{name:"behavior",string:Ja.toString()}),Object.assign(new fa.a,{name:"ActionId",int64:ba})]}));return 32};this.ga=b;this.In=h;this.jhh=A;this.bBk=M;this.aqk=this.X5l.bind(this);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.jhh.OAj(()=>{this.reset()})}Wb(){this.ga.fb(Hc.a.Eog,
mc.a.view,this.vxj,97);this.ga.fb(Hc.a.Fog,mc.a.view,this.vxj,97);this.ga.fb(Hc.a.ymi,mc.a.view,this.aqk,1028);this.ga.fb(Hc.a.sVa,mc.a.view,this.zmi,1028);this.ga.fb(Hc.a.Ipb,mc.a.view,this.zmi,1028);this.bBk||(this.ga.fb(Hc.a.hyc,mc.a.view,this.hyc,96),this.ga.fb(Hc.a.ORb,mc.a.view,this.ORb,96))}m9o(b){new NK(this.ga,b,Gr.nsa)}X5l(b,h,r){1!==r&&this.m9o(Gr.s3a);return 32}static get Hpb(){return null!=Gr.NVg?Gr.NVg:Gr.NVg=$a.a.instance.resolve(211)}static get nsa(){Gr.gGa||(Gr.gGa=$a.a.instance.resolve(1020));
return Gr.gGa}reset(){Gr.s3a=null!=Gr.nsa?Gr.nsa.Dhb?Hc.a.sVa:Hc.a.Ipb:Hc.a.sVa}}Gr.s3a=Hc.a.sVa;Gr.gGa=null;Object(u.a)(Gr,"ExternalContentActor",null,[]);class OD extends Bz{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){super(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb);this.z8c=nc;this.W1d=!1;this.unh=null}dkd(){this.W1d||(super.dkd(),this.W1d=!0)}IEe(){this.W1d&&(super.IEe(),OD.Hii&&this.unh&&OD.Hii.removeHandler(BB.a.$Ha,this.unh),this.W1d=!1)}D2b(){if(this.z8c){this.Jza.t3&&this.Jza.dismissFloatie();const b=
new Ly.a(0,y.AFrameworkApplication.isRtl);b.location=this.Tcb.XVa();this.showFloatie(null,b)}else this.Jza.t3&&y.AFrameworkApplication.va.Ob(Hc.a.ORb,2),y.AFrameworkApplication.va.Ob(Hc.a.hyc,2);this.Gpc=!1}dismissFloatie(b){!this.EXe&&(b&&(this.Tcb.RWf(),this.X5j()),this.Jza.t3||this.IRa)&&(this.IRa=!b,this.IEe(),this.z8c?this.Jza.dismissFloatie():y.AFrameworkApplication.va.Ob(Hc.a.ORb,2))}showFloatie(b,h){h||(h=new Ly.a(0,y.AFrameworkApplication.isRtl));h.location||(h.location=this.Tcb.XVa());if(!h.location)return!1;
this.IRa&&(this.IRa=!1,this.dkd());this.z8c?(b=Array(1),b.push("ExternalContent"),this.Jza.showFloatie(this.Tcb.XVa(),b,1)):y.AFrameworkApplication.va.Ob(Hc.a.hyc,2);return!0}GYc(){if(!this.Gpc){const b=new wc.a(3,1,this.Pci,()=>{this.D2b()},196);me.a.instance.Yb(b);this.Gpc=!0}}rna(){this.z8c?this.Jza.t3&&this.Jza.dismissFloatie():y.AFrameworkApplication.va.Ob(Hc.a.ORb,2);this.GYc()}x_b(){this.z8c?this.Jza.t3&&this.Jza.dismissFloatie():y.AFrameworkApplication.va.Ob(Hc.a.ORb,2);this.GYc()}static get Hii(){return null!=
OD.xVg?OD.xVg:OD.xVg=$a.a.instance.resolve(223)}}Object(u.a)(OD,"ExternalContentFloatieEventManager",Bz,[]);class aC extends Vx{constructor(b,h,r,A,M){super(b,h,r,A,M)}JZh(){if(!this.ib||!this.ib.gb||!this.ib.gb.currentSelection)return v.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.ib.gb.currentSelection.Qa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h&&!r.RL){do r=this.ZEi(r);while(r&&!r.RL&&Object(Za.a)(Pn.AParagraphNode,
r)&&!r.characterData.trim().length)}let A="";const M=Object(Ma.a)(Pn.AParagraphNode,r);M&&(A=M.characterData.length===b.cpBegin||h?M.characterData.trimEnd():M.characterData.substring(0,b.cpBegin).trimEnd());h=M?A.length:b.cpBegin;b=Object.assign(new ax,{lDa:Object(Ma.a)(221,(M?Object(Ma.a)(221,M):Object(Ma.a)(221,r))||b.node),Xtc:h});return this.cKf(b)}Kzi(b,h){let r=null;const A=Object(Ma.a)(326,b.lDa.Wl(h.sc));if(!A)return null;if(Object(Za.a)(Pn.AParagraphNode,b.lDa)){const M=Object(Ma.a)(Pn.AParagraphNode,
b.lDa);if(M.eU){if(b=Object(Ma.a)(vz.a,Ed.ParagraphReader.zKa(M)))(b=Object(Ma.a)(326,b.Wl(h.sc)))&&(r=b.getBounds()),r&&(r.height+=aC.Ipi,r.width-=aC.Qbm);return r}h=Object(Ma.a)(163,A);if(!h)return null;try{if(r=this.yya.t2(b.Xtc,h,0<b.Xtc,!1,!1,!1))r.height+=aC.Ipi}catch(ba){v.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",ba),r=null}}r||(r=A.getBounds());return r}}aC.Ipi=65;aC.Qbm=100;Object(u.a)(aC,"ExternalContentFloatiePositionProvider",
Vx,[]);class bC{constructor(b,h,r,A,M,ba){this.Que=(oa,Ja,jb)=>{if(1===jb)return y.AFrameworkApplication.I0||y.AFrameworkApplication.BH||y.AFrameworkApplication.wta||fc.SessionStatusManager.instance.Nk?8:32;if(oa===ub.a.print)oa=1;else if(oa===Hc.a.UZc)oa=0;else if(oa===Hc.a.t0d)oa=3;else if(oa===Hc.a.s0d)oa=2;else return 8;return this.XMo(oa)};this.ga=b;this.N9=h;this.k7b=r;this.puk=A;this.cfh=M;this.qqk=ba}Wb(){var b;y.AFrameworkApplication.J.$("DisablePrintBasedOnPolicy")&&this.puk||y.AFrameworkApplication.BH?
(document.body.classList.add("WACStopPrinting"),""!==this.cfh&&this.qqk.P9o(this.cfh)):(this.ga.qa(ub.a.print,mc.a.application,this.Que),this.ga.qa(Hc.a.UZc,mc.a.application,this.Que),(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1))&&this.ga.qa(Hc.a.t0d,mc.a.application,this.Que),this.ga.qa(Hc.a.s0d,mc.a.application,this.Que))}XMo(b){const h=y.AFrameworkApplication.rootQuerySignature;if(!h||""===h||Jf.a.vd()&&
Jf.a.vd().xC.Mo)return 8;this.k7b.fde=!1;this.k7b.Jbk.start();Yu.a.sU(ZB.a.eCl,!0,Object(F.a)(this.k7b,this.k7b.jHo,"requestFileDownload"),Object(F.a)(this.k7b,this.k7b.SWb,"onForceSaveFailed"),b);return 32}}Object(u.a)(bC,"FileDownloadActor",null,[]);class lN extends ld{constructor(b,h=null,r=null){super(b,!0,h,!1,void 0,r)}get dUf(){return null}get Ubb(){return this.Dde?CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText_EditPermissions:y.AFrameworkApplication.Y7a?CommonUIStrings.l_DownLoadACopyDialogMessage:
CommonUIStrings.l_PrintDialogDocumentIsPrinting}get Kqc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get WRd(){return null}get Dde(){return"VersionHistory"===this.g_h?!1:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfCopyLinkEnabled",!1)}qie(){v.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");y.AFrameworkApplication.tga("tcopypdf;ccopypdf")}}Object(u.a)(lN,"DownloadAsPdfDialog",
ld,[]);class Es{constructor(){this._url=this.yw=null;this.O4a=this.N4a=0;this.Vlb=!1;this.jMa=()=>{y.AFrameworkApplication.Ge.Xj(this._url,1,null,null,!0,2,this.zcb,this.hV,null)};this.zcb=b=>{Es.Fld();const h=b.data.sna;let r=null;if(h)try{r=h.selectSingleNode("/docdata/status")}catch(A){}r&&("InProgress"===r.text&&22>this.N4a++||"ServiceBusy"===r.text&&3>this.O4a++)?this.KNa(1E3*(this.N4a+this.O4a)):this.yw(!0,r?r.text:null,b.data)};this.hV=b=>{this.Vlb?(Es.gHa||(Es.Cjb=new Date,Es.gHa=!0,Es.xW=
1),18E4>(new Date).getTime()-Es.Cjb.getTime()?this.Fxb(4<=Es.xW?2E4:1E3):this.l$a(b.data)):4>Es.xW?this.Fxb(2E3):this.l$a(b.data)}}send(b,h,r){this._url=b;this.yw=h;this.Vlb=r;this.jMa(null)}KNa(b){b=new wc.a(2,1,b,this.jMa);y.AFrameworkApplication.oc.Yb(b)}Fxb(b){this.KNa(b);Es.xW++}l$a(b){this.yw(!1,null,b)}static Daa(b,h){(new Es).send(b,h,!1)}static Fld(){Es.gHa=!1;Es.xW=0}}Es.Cjb=null;Es.gHa=!1;Es.xW=0;Object(u.a)(Es,"ClientRequestWithRetry",null,[]);class WF extends Ic{constructor(b){super(b,
void 0,y.AFrameworkApplication.Y7a)}get Ubb(){return WF.Vpn?WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady.replace("{0}",""):WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}static get Vpn(){if(null!=WF.a0g)var b=WF.a0g;else{var h;y.AFrameworkApplication.nd("32d51153;h1018576");b=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.OdtDialogDownloadLinkRemovalEnabled",!1);b=WF.a0g=b}return b}get Kqc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get Mbd(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get nYc(){return y.AFrameworkApplication.Y7a?
"UIFontDialogTextLarge":null}qie(){v.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}t6f(){v.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}kcd(){v.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get sbd(){return Hx.Gij}get Cub(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get mej(){return!y.AFrameworkApplication.Y7a}}Object(u.a)(WF,"DownloadAsOdtDialog",Ic,[]);class mN{constructor(b,h){this.yib=this.L5a=
null;this.rii="downloadpdf";this.vZl="downloadpdfwithoutcomments";this.Gvj="printpdf";this.Fij="odt";this.Neb=r=>{1===qa.StaticActiveAppFrame.za().state||this.L5a||(this.L5a=(new ep.a).create(),r=r.em,this.DEn(r),1===r?this.L5a.message=this.hDb.mU.isEnabled?y.AFrameworkApplication.Y7a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:0===r||3===r?this.L5a.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait:
2===r&&(this.L5a.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait),this.L5a.rM(CommonUIStrings.l_DefaultDialogTitle,this.cancelButton,null))};this.cancelButton=()=>{this.fde=!0};this.Rba=(r,A,M)=>{this.OFg("Success. Save and Conversion Complete.");M=new gb.QueryStringBuilder(M.request.get_url());y.AFrameworkApplication.Oja(M);M=M.toString();const ba=this.BHo(M);this.Wra(ba);2!==ba&&this.hDb.Kio();if(!r||A)this.N8(ba);else if(this.fde)this.fde=!1,this.yib=null;else{this.yib&&y.AFrameworkApplication.oc.uf(this.yib);
this.yib=null;if(0===ba||3===ba){A=new fa.a;A.name="IsLabeled";const oa=y.AFrameworkApplication.J.jb("AppliedPolicyId");A.bool=!!(oa&&0<oa.length);$b.a("PdfProtectionUsage",r,void 0,[A])}this.KWl(M,ba)}};this.fde=!1;this.hDb=b;this.Jbk=h.rYa("UserAction","WordEditorForceSaveAndPrint")}Wra(b){this.L5a&&(this.NEn(b),this.L5a.close(),this.L5a=null)}N8(b){if(1!==qa.StaticActiveAppFrame.za().state){this.IFn(b);const h=new kh.StandardDialog;h.Ed=0;h.Qe(1,CommonUIStrings.l_DialogClose);h.Iy(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:
WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}yNf(b){switch(b){case 0:return this.CXi?this.vZl:this.rii;case 3:return this.rii;case 1:return this.Gvj;case 2:return this.Fij;default:return v.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),this.Gvj}}jHo(b){var h=y.AFrameworkApplication.rootQuerySignature;h&&""!==h?(h="WordViewer/request."+this.CCf(b)+"?"+h+"&type="+this.yNf(b)+"&rndm="+hb.a.create(),1===b&&this.hDb.e8o()&&(h+="&useNamedAction=1"),y.AFrameworkApplication.J&&
y.AFrameworkApplication.J.$("CustomFontReadModePDFIsEnabled")&&Jm.FontUtils.Pye()&&(1===b||!b)&&(0<Jm.FontUtils.xci&&(h+="&cfcVer="+Jm.FontUtils.xci),Jm.FontUtils.wci&&(h+="&cfcUrl="+encodeURI(Jm.FontUtils.wci)),Jm.FontUtils.yci&&(h+="&cfcEncData="+encodeURIComponent(Jm.FontUtils.yci)),Jm.FontUtils.vci&&(h+="&cfcBaseUrl="+encodeURI(Jm.FontUtils.vci))),Es.Daa(h,this.Rba),this.yib||(this.yib=new wc.a(2,1,500,this.Neb),this.yib.em=b,y.AFrameworkApplication.oc.Yb(this.yib))):(this.OFg("failed. QuerySignature is empty."),
this.N8(b))}CCf(b){return 2===b?"odt":"pdf"}SWb(){this.OFg("Failed. force save failed.")}BHo(b){if(0<b.indexOf("&type=downloadpdf")&&this.CXi)return 0<b.indexOf("&type=downloadpdfwithoutcomments")?0:3;if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;v.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}OFg(b){v.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",
b);this.Jbk.stop()}KWl(b,h){const r=new qb.a;r.add("access_token");r.add("access_token_ttl");1!==qa.StaticActiveAppFrame.za().state&&(1===h?this.hDb.E$o(b,r):0===h||3===h?new lN(b):2===h&&new WF(b))}dispose(){}DEn(b){switch(b){case 0:v.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 3:v.ULS.sendTraceTag(0,203,50,"Download Attempt: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:v.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");
break;default:v.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}NEn(b){switch(b){case 0:v.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 3:v.ULS.sendTraceTag(0,203,50,"Download Cancelled: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:v.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:v.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}IFn(b){switch(b){case 0:v.ULS.sendTraceTag(38114818,
203,15,"Download Failed: Pdf");break;case 3:v.ULS.sendTraceTag(0,203,15,"Download Failed: Pdf with Comments");break;case 2:v.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:v.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:v.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}get CXi(){if(null!=this.G_g)var b=this.G_g;else{var h;y.AFrameworkApplication.nd("b62ed219;f72gc351");b=this.G_g=null===(h=y.AFrameworkApplication.J)||void 0===h?void 0:
h.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1)}return b}}Object(u.a)(mN,"FileDownloadManager",null,[]);class PD{get key(){return"LIST"}get Jv(){return Box4Intl.Box4Strings.l_ListContentTitle}s2b(b){let h=null;const r=PD.Nd.Tw(b);if(!r)return{returnValue:!1,Sea:h};b=this.Dzm(b,r);h=Object.assign(new OA.a,{fG:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,Sea:h}}Oqb(b,h){b=b.contentObject;const r=this.kym(b.jz),A=new dc.a;h?(h=h.contentObject,
h.level!==b.level?(A.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),A.add(r)):h.id.equals(b.id)&&h.jz.listType===b.jz.listType||A.add(r)):(A.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),A.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),A.add(r));return A.toArray().join(" ")}kym(b){let h="";const r=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Jx);else if(1===b.listType)switch(r){case 1:h=
this.sYh;break;case 2:h=this.gjl;break;case 3:h=this.hjl;break;default:h=this.sYh}return h}static get Nd(){return null!=PD.i1g?PD.i1g:PD.i1g=$a.a.instance.resolve(10)}}Object(u.a)(PD,"ListDetailsProvider",null,[135,136]);class nN{constructor(){this.jz=this.listId=this.id=null;this.level=0}}Object(u.a)(nN,"ListItemInfo",null,[]);class OK extends PD{constructor(b){super();this.V9=b}get sYh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get gjl(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get hjl(){return WoncaIntl.WoncaStrings.L_BulletStyle3}Dzm(b,
h){const r=this.V9.yE(b);return Object.assign(new nN,{id:b.currentNode.id,listId:new P.a(hb.a.nil,r.listID),jz:h,level:r.level+1})}}Object(u.a)(OK,"FlatListDetailsProvider",PD,[]);class oN{constructor(b,h){this.ga=b;this.kg=h}get Xb(){return null!=this.p7g?this.p7g:this.p7g=$a.a.instance.Oa(8)}Wb(){}}Object(u.a)(oN,"FormattingActor",null,[]);var EO=d(1120),Nv=d(294),FO=d(1714);class pN{constructor(b,h,r,A,M,ba,oa,Ja){this.Db=b;this.vNk=h;this.Qc=r;this.oEb=A;this.lq=M;this.Ga=ba;this.Cd=oa;this.eCk=
Ja}btc(b,h,r,A,M,ba,oa){v.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:oa.Hi});this.oEb.then(()=>{this.vNk(b.data.Ee);v.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:oa.Hi});oa.stop()})}hV(b,h,r,A,M,ba,oa){ba.stop();M();oa?(this.Zco(h,r),v.ULS.sendTraceTag(574377989,3001,15,"{0}",{["message"]:b,
["id"]:je.a.D9a(h.Db)})):v.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:je.a.D9a(h.Db)})}oSh(b,h){b.Ae(kG.a.nsf,wI.QYl.toString());if(this.Cd&&this.Cd.isFeatureEnabled(42)){var r=this.lq.Tn(h.Ok);r=this.lq.Ak(r);b.Ae(ui.a.ht,Nv.a[r]);5===r&&this.a8k(b,h)}this.eCk&&b.Ae(ui.a.fbe,"true")}bMh(){return new FO.a(this.Db.id,this.Db)}K8d(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}Zco(b,h){const r=this.Qc.Lc(7,ub.a.PUm);r.Ab(h);b.Db.setValue(Rc.a.M6h,!0);r.dispose()}a8k(b,
h){var r=h.Ok;h=this.lq.Tn(r);var A=r.node;const M=(r=this.lq.IKa(h,A.Ic,!1))?this.lq.BKa(r):"";if(""===M)throw v.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");A=(A=this.lq.IKa(h,A.Ic,!0))?this.lq.BKa(A):"";b.Ae(ui.a.utc,M);b.Ae(ui.a.Nbk,A);r=r.ka(Yf.a.Hni,"");""!==r&&b.Ae(ui.a.extension,r);b.Ae(ui.a.width,this.lq.cC(h).toString());b.Ae(ui.a.height,this.lq.nD(h).toString());b.Ae(ui.a.qhd,this.lq.nrb(h).toString());
r=this.Ga.$("WordEditorImageCropIsEnabled");b.Ae(ui.a.Kbi,r.toString());r&&(r=this.lq.yfa(h),b.Ae(ui.a.top,r.top.toString()),b.Ae(ui.a.bottom,r.bottom.toString()),b.Ae(ui.a.left,r.left.toString()),b.Ae(ui.a.right,r.right.toString()));r=this.Ga.$("WordEditorImageRotateIsEnabled");b.Ae(ui.a.SIj,r.toString());r&&(b.Ae(ui.a.angle,this.lq.Z2(h).toString()),h=this.lq.Gsa(h),b.Ae(ui.a.flipH,h.$pb?"true":"false"),b.Ae(ui.a.flipV,h.dKa?"true":"false"));b.Ae(ui.a.lji,"true")}}Object(u.a)(pN,"GraphicsEditorDocumentXmlToJsonRequestHelper",
null,[574]);class qN{constructor(){this.jRa=null}Sdl(b){this.jRa=b}teardown(){null!=this.jRa&&(this.jRa.teardown(),this.jRa=null);this.a5e=null}getGraphicData(){return this.jRa?this.jRa.getGraphicData():null}Bzo(){null!=this.a5e&&this.setGraphicData(this.a5e)}setGraphicData(b){this.a5e=b;if(this.jRa)try{this.jRa.setGraphicData(b)}catch(h){v.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",h.toString())}else v.ULS.sendTraceTag(575522529,
3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.jRa?this.jRa.hasEdits():!1}}Object(u.a)(qN,"GraphicsEditorGC2HostUser",null,[575]);var QD=d(1715),GO=d(1065),HO=d(1254),IO=d(791),rN=d(1344),JO=d(1064);class sN{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(u.a)(sN,"GC2ScriptLoader",null,[]);class YL{constructor(b,h,r){this.kNe=b;this._context=h;this.KSa=r}closeEditor(){this.kNe&&
(this.kNe(),this.kNe=null)}logActivity(b,h,r,A){$b.a(b,h,r,A)}logTrace(b,h,r,A){v.ULS.sendTraceTag(575522531,3001,YL.fJn(h),A)}isEnabled(b){const h=y.AFrameworkApplication.J;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",
!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${$a.a.instance.resolve(403).R8a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=Jm.FontUtils.lGf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(r=>"premium"!==r.fontType),mruList:b.mruList,
previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return za.Health.instance}getFonts(b){const h=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),r=h?"msofp_hier":"msofp",A=`${$a.a.instance.resolve(403).R8a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(r,A);Jm.FontUtils.JMh();Jm.FontUtils.jNh({});b=Jm.FontUtils.kGf(()=>!1,(M,ba)=>ba).MenuSectionList;h&&0<b.length&&(b.pop(),b.push(this.cAl()));return b}cAl(){const b=Jm.FontUtils.lGf(()=>
!1,()=>"").fonts.map((h,r)=>{const A=h.name;h=h.displayName;const M=Jm.FontUtils.Jta(A);return Object.assign(new Jv.a,{MenuItemId:Jm.FontUtils.UKj+r,CommandValueId:A,LabelText:h||A,Styles:{["optionText"]:{["fontFamily"]:h&&!M?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:A})});return Object.assign(new xh.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=this._context.Ok;var r=je.a.Tn(h);if(this.Wmn(r,
h,b)&&(r=je.a.m9(r,Bd.a.o8,""),r.length))return Promise.resolve(r);r=new gb.QueryStringBuilder("/we/GetImage.ashx?");r.gKb(h.node.Lj().Fq);r.Ae(ui.a.FZd,b);y.AFrameworkApplication.Oja(r);r.Ae(uj.a.VAb,"1");Wm.a.instance.nKb(r);r.Ae(ui.a.Lci,"true");const A=r.toString();return new Promise((M,ba)=>{this.KSa.Xj(A,1,null,null,!1,2,oa=>{M(oa.data.Ee)},oa=>{ba(oa.data.He.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=Li.a.li("progress.gif");b.PictureInvalid=Li.a.li("CancelRequest.32x32x32.png");
return b}getTheme(){const b=Object(fn.a)().Nu(this._context.view.qd).properties.ka(Rc.a.SCe,"");return 0===b.length?[]:b.split(" ").map(h=>df.a.nUa[h])}static fJn(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}Wmn(b,h,r){const A=h.node.Ic;h=je.a.P7d(b,A,!1);b=je.a.P7d(b,A,!0);return r===h||r===b}}Object(u.a)(YL,"GraphicsEditorApp",null,[586]);class uk extends ug.a{constructor(b,h,r,A,M){super(!1,!1,!0);this.closeEditor=()=>{this.u7h();
this.dispose()};this.Tra=ba=>{this.u7h(2===ba)};this.Pib=b;this.Lyk=h;this.nmh=r;this._context=A;this.KSa=M}F9o(b){return new Promise((h,r)=>{this.gi(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.Tra,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(A,M)=>this.ZKb(A,M,b),["onload"]:A=>{this.onLoad(A,h,r)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>
{this.Pib.Bzo()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,r){b?(this.Pib.Sdl(b),h(b)):(v.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),r(null))}ZKb(b,h,r){b=y.AFrameworkApplication.J;const A=JO.a();A.loadScriptWithRetryHandler=h;const M=new YL(this.closeEditor,this._context,this.KSa),ba={["bootConfig"]:Object.assign(new HO.a,{scriptBaseUrl:Gw.AppChromeOverrideUtilities.isEnabled?Gw.AppChromeOverrideUtilities.C7d(y.AFrameworkApplication.lcid):
y.AFrameworkApplication.W8+y.AFrameworkApplication.lcid+"/",isMLRRibbonMode:y.AFrameworkApplication.ta.Hb.Vxc,isCombinedBundleEnabled:y.AFrameworkApplication.J.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new sN(new GO.DynamicScriptLoader(A)),["publicPath"]:y.AFrameworkApplication.W8,["appSettings"]:b.appSettings,["logger"]:new Do.a,["featureGateManager"]:Object.assign(new IO.a,{getBooleanFeatureGate:Object(F.a)(b,b.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(F.a)(b,
b.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(F.a)(b,b.getStringFeatureGate,"getStringFeatureGate")}),["app"]:M,["resolveScript"]:(oa,Ja)=>rN.a.resolveScript(oa,Ja),["initialTabId"]:r};b.$("DynamicBundlesIsEnabled")&&(r="",y.AFrameworkApplication.J.$("AppChromeOverrideIsCombinedBundle")||y.AFrameworkApplication.J.$("IsCombinedBundleEnabled")||(r=b.$("IsWebpack5RibbonEnabled")?"wp5/":"exp/"),ba.dynamicBundlesPath=Gw.AppChromeOverrideUtilities.isEnabled?Gw.AppChromeOverrideUtilities.Ewc+
r:b.jb("StaticContentUrl")+r);return new Promise((oa,Ja)=>{h("gc2",y.AFrameworkApplication.rC("gc2.js",5),"anonymous",5,!1).then(()=>{oa(ba)}).catch(()=>{v.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Ja(null)})})}u7h(b){b=this.Pib.hasEdits()&&!b;this.Lyk(b?this.Pib.getGraphicData():null,!!this.nmh,this.nmh,b)}}Object(u.a)(uk,"ReactGraphicsEditorDialog",ug.a,[]);class cC{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc,Dc,Zc=!1){this.Tri=Zc;this.oEb=
this._context=null;this.G9o=(Gd,de,he,fe,Yd)=>{var Td,wf;const Lf=!!Yd&&Object(Za.a)(P.a,Yd);try{if(1===he){const Bi=de.view;return this.Ik.hka(de)&&Bi.features.CBe?32:8}this.BCk=4===(null===Yd||void 0===Yd?void 0:Yd.InputMethod)?!0:!1;Object(Zg.c)()&&(this.Tri||EO.a.Dpb(()=>{this.Tri=!0}));v.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${Lf}`);performance.mark("LaunchStart");this._context=de;const ii=new uk(this.Pib,this.Deg,Lf?Yd:null,de,this.Gf);Gd=null;if(Lf){const Bi=
null===(wf=null===(Td=de.view.lb)||void 0===Td?void 0:Td.gb)||void 0===wf?void 0:wf.currentSelection;if(null===Bi||void 0===Bi?0:Bi.HN)Gd="Draw"}this.oEb=ii.F9o(Gd).then(()=>{v.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${Lf}`)}).catch(()=>{this.Ogi()});if(!Lf){const Bi=Tn=>{this.oEb.then(()=>{this.qoj(Tn,!1)})};if(y.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return Bi(JSON.stringify({elements:[]})),
32;let Ml=null;Ml=Object(fn.a)().Nu(de.view.qd);const hk=Ml.properties.ka(Rc.a.Vri,"");if(0<hk.length)return Bi(hk),32;this.PTe.pRo(de,P.a.create(),hb.a.create()).then(Tn=>{const rx=this.Qc.Lc(0,ub.a.z5c);rx.Ab(Ml);Ml.setValue(Rc.a.Vri,Tn);rx.dispose();Bi(Tn);return null}).catch(Tn=>{v.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",Tn.toString(),Lf);this.Ogi()})}return 32}catch(ii){return v.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",
ii.toString(),Lf),8}};this.wWm=(Gd,de,he,fe,Yd)=>{var Td,wf;Gd=de.view;he=null===(wf=null===(Td=null===Gd||void 0===Gd?void 0:Gd.lb)||void 0===Td?void 0:Td.gb)||void 0===wf?void 0:wf.currentSelection;if(null===he||void 0===he||!he.kXa)return 8;if(!Gd.features.CBe)return 32;v.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.Eii(Yd,de);return 32};this.vWm=(Gd,de,he,fe,Yd)=>{var Td,wf,Lf=de.view;Lf=null===(wf=null===(Td=null===Lf||void 0===Lf?void 0:Lf.lb)||void 0===Td?
void 0:Td.gb)||void 0===wf?void 0:wf.currentSelection;return null!==Lf&&void 0!==Lf&&Lf.kXa?this.kMi(Gd,de,he,fe,Yd):8};this.kMi=(Gd,de,he)=>{if(1===he)return de.view.features.CBe?32:8;if(2===he){Gd=je.a.Tn(de.Ok);if(!Gd)return 2;v.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.Eii(Gd,de);return 32}return 2};this.qoj=(Gd,de=!0)=>{this.Pib.setGraphicData(Gd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Gd=performance.getEntriesByName("EditorLaunch");
v.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${de} Duration: ${Gd[Gd.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");performance.clearMeasures("EditorLaunch")};this.Deg=(Gd,de,he,fe)=>{var Yd;this.Pib.teardown();if(de&&this._context){var Td=this._context.view.lb.Ng,wf=Td.node;Td.Cl&&Ed.ParagraphReader.Vb(wf)&&(Td=null===(Yd=this.D$)||void 0===Yd?void 0:Yd.dC(wf),27==(null===Td||void 0===
Td?void 0:Td.role)&&v.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",fe,fe?" Everything deleted: "+(0==(null===Gd||void 0===Gd?void 0:Gd.json.length)):""))}if(fe)if(v.ULS.sendTraceTag(541714E3,3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Gd)if(fe=Gd.json,Yd=Gd.width,wf=Gd.height,fe.length||de)if(!fe.length&&de)if(de=this._context.Ok){de=de.node;if(je.a.kba(de)){if(!this.Ik.Vzo(de,new zc.a,ve.a.instance,yM.YJb)){v.ULS.sendTraceTag(588817116,
3001,10,"Failed to remove anchored image.");return}}else if(!this.Ik.Avc(de,he,this.hb,this.VY)){v.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}v.ULS.sendTraceTag(572363226,3001,50,"Graphic removed thru dialog.")}else v.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else Td=new QD.a(this._context,y.AFrameworkApplication.ta.EWa,!0,this.Ik,this.Ga,Object(fn.a)()),Gd=hb.a.create(),he=new OM.a(Td,fe,this.IM,this.In,Gd,xn.a.instance,
de,he,this.Ik,this.lq,Yd,wf,this.Ga,this.VY,this.Cd,Object(Zg.c)(),Object(Zg.b)()),this.PTe.ayg(he,this._context,de,Gd),this.cia(),this.BCk&&this.yqp();else v.ULS.sendTraceTag(541714001,3001,50,"Empty Json on new content creation when close dialog");else v.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else v.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ga=h;this.PTe=r;this.Ik=A;this.IM=M;this.In=ba;this.Pib=
new qN;this.Qc=Ja;this.hb=jb;this.VY=zb;this.lq=Eb;this.Cd=nc;this.Gf=Sb;this.D$=Dc}Wb(){let b=!0;this.Ga.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(b=this.Cd&&this.Cd.isFeatureEnabled(42));b&&!X.a.Mt&&(this.ga.fb(Hc.a.EQf,mc.a.view,this.G9o,4),this.ga.fb(ub.a.Izf,mc.a.view,this.wWm,4),this.ga.fb(Hc.a.Fii,mc.a.view,this.vWm,4),this.ga.fb(Hc.a.uhc,mc.a.view,this.kMi,4))}Ogi(){const b=new kh.StandardDialog;b.Ed=0;b.Iy(se.a.szf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,
null);qa.StaticActiveAppFrame.za().Fe()}Eii(b,h){var r=b.ka(Fe.a.YP,1);const A=b.ka(Yf.a.c0,wb.a.finished);r&&A!==wb.a.vPa?b.ka(Rc.a.M6h,!1)?(h=new kh.StandardDialog,h.Ed=0,h.Iy(se.a.szf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),qa.StaticActiveAppFrame.za().Fe(),v.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:je.a.D9a(b)})):(this.ga.Pb(Hc.a.EQf,
2,b.id),this.oEb||(v.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.oEb=new Promise(M=>{M(null)})),r=hb.a.create(),b=new pN(b,this.qoj,xn.a.instance,this.oEb,this.lq,this.Ga,this.Cd,Object(Zg.d)(b)),this.PTe.ayg(b,h,!0,r)):v.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}cia(){const b=$a.a.instance.Ra(2);b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):v.ULS.sendTraceTag(572352085,
3001,10,"ISystemInitiatedFeedback was null")}yqp(){const b=$a.a.instance.Ra(2);b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):v.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(u.a)(cC,"GraphicsEditorActor",null,[]);var XF=d(530);class RD{constructor(b,h,r){this.I2a="wwaengidc";this.Wyd="CreateLinkForHeading";this.atk="CreateLinkForHeadingAction";this.jvk="\ufffc";this.u2a=b;this.ga=h;this.hb=r}Wb(){this.ga.qa(Hc.a.PXc,mc.a.paragraph,
this.suf.bind(this));this.ga.qa(Hc.a.PXc,mc.a.Fd,this.suf.bind(this));this.ga.qa(Hc.a.PXc,mc.a.Vc,this.suf.bind(this));this.ga.Pc(Hc.a.PXc,1028)}suf(b,h,r){b=h.node;if(1===r)return this.ZZi(b)?32:8;this.Cso(this.Wyd,this.atk);if(!this.ZZi(b))return v.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;r=b.getValue(Rc.a.Zc);if(!r)return v.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),r=new Map,r.set("Source",this.Wyd),
r=Object.assign(new bb.a,{additionalValues:r}),za.Health.instance.recordKpiFailure(this.Wyd,"Unable to create sharable link as paragraph id is missing",!1,!0,r),8;this.A$h(r);return 32}A$h(b){b=String.format('{{"{0}":"{1}"}}',XF.a.heading,b);this.ga.Pb(La.a.Maa,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}ZZi(b){return!this.hb.Vb(b)||this.hb.qoc(b)||this.hb.ntb(b)||b.Jq||""===b.characterData||b.characterData===this.jvk||!this.u2a.O6d(b)?!1:!0}Cso(b,h){const r=new Map;r.set("Source",
this.Wyd);r.set("Action",h);za.Health.instance.recordKpiUsage(b,0,this.I2a,r)}}Object(u.a)(RD,"HeadingsActor",null,[]);class SD{C6o(b){return Ed.ParagraphReader.Hza(this.fzi(b))}Ond(b,h,r){if(b=Ed.ParagraphReader.zKa(this.fzi(b)))h=b.Ce(h),Object(Za.a)(564,h)&&(du.m(b)?h.I0o(r):h.Ond())}fzi(b){return b&&b.Cl&&b?b.node:null}}Object(u.a)(SD,"IFrameFocusStrategy",null,[565]);class xI{constructor(b){this.AHa=null;this.mDd=b}yaj(){v.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}V4j(b){if(!b)return v.ULS.sendTraceTag(25007836,
375,15,"Error range is null"),!1;if(!b.errorDetails)return v.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return v.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.AHa=C.a.iDe(b.errorDetails.token,b.errorDetails.lcid);this.mDd.add(this.AHa,b.errorDetails.lcid);return!0}gpd(b){return b?b.token?C.a.iDe(b.token,b.lcid)===this.AHa:(v.ULS.sendTraceTag(25007840,375,15,
"ErrorDetails Token is null"),!1):(v.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(u.a)(xI,"IgnoreAllProofingErrorStrategy",null,[563]);var YF=d(1263),yI=d(572),ZF=d(373);class zI{constructor(b,h){this.filename=b;this.blob=h}}Object(u.a)(zI,"UploadBlobParameters",null,[]);class Bx extends Jk{constructor(b,h,r,A,M,ba,oa,Ja,jb=null){super(b,h,r,null,M,ba,Ja,!1);this.IDk="DragAndDrop";this.Mhh="FileName";this.Phh=0;this.FJh=null;this.Itd=this.Tob=!1;
this.Tfh=A;this.eAh=jb}get B$j(){return"DragDropInsertImage"}get cS(){return this.IDk}get fileExtension(){return this.Mhh}get fileSize(){return this.Phh}get C$j(){return this.FJh}Nqd(b){const h=new zI(this.Tfh.name,this.Tfh);b.zZj(h);this.FJh=b.Slb}DAa(b,h){this.eAh&&this.eAh();super.DAa(b,h)}cOg(b){const h=!!b&&this.qoa(b.name,null)&&this.dOg(b,null);b&&(this.Mhh=b.name,this.Phh=b.size);h||this.rie();return h}}Object(u.a)(Bx,"DragDropInsertImageUploader",Jk,[]);class Sr{constructor(b,h,r,A,M,ba,
oa){this.g7c=ba;this.yV=oa;this.vje=this.wje=this.Xje=this.Yje=0;this.ga=null;this.mzf=(Ja,jb,zb)=>{if(df.a.H_d)return 8;Ja=jb.node;return 1===zb?Ja?32:2:2===zb?(zb=je.a.Tn(jb),jb=je.a.j4c(zb,jb.node.Lj().ud,y.AFrameworkApplication.J,y.AFrameworkApplication.ta.EWa),CE(jb),32):2};this.Fcn=(Ja,jb,zb)=>{const Eb=this.Ik.hka(jb);if(2===zb&&Eb){if(ub.a.EX===Ja||ub.a.iVd===Ja)y.AFrameworkApplication.Vta?y.AFrameworkApplication.WDg():this.eKl(jb);return 32}return 1!==zb||ub.a.EX!==Ja&&ub.a.iVd!==Ja?2:Eb?
32:2};this.BSb=(Ja,jb,zb,Eb,Sb)=>this.Ik.hka(jb)?1===zb?32:this.Ik.nWf(jb,Sb)?32:2:2;this.Z_o=()=>{if(this.ib&&this.ib.gb&&this.ib.gb.currentSelection){const Ja=this.ib.gb.currentSelection.Qa;Ja&&this.ib.Kc(sc.SelectionFactory.ve(Ja.node,Ja.cpBegin))}};this.NZl=(Ja,jb,zb,Eb,Sb)=>{v.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");if((Ja=Sb.DataTransfer)&&Ja.files&&0<Ja.files.length){v.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Ja.files.length));for(zb=0;zb<
Ja.files.length;zb++)Eb=Ja.files[zb],0<=C.a.xh(Eb.type).indexOf("image")&&this.Nbn(Eb,jb)&&(Eb=this.ib.gb.currentSelection.Qa,this.ib.Kc(sc.SelectionFactory.ve(Eb.node,Eb.cpBegin+1)));this.HPa();return 32}v.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.Gdo=(Ja,jb,zb,Eb,Sb)=>{if(2===zb)return y.AFrameworkApplication.va.Pf(jb.Ok,Ja,zb,!0,Eb,Sb);if(!jb.view.ue)return 8;Ja=jb.view;if(!Ja.lb)return 8;Ja=Ja.lb.Ng;Ja=Object(zl.a)().XO(Ja);return 1===Ja.length&&
this.YQ(Ja[0])?(this.zHn(),32):8};this.mVm=(Ja,jb,zb)=>{if(!this.YQ(jb))return 8;const Eb=je.a.Tn(jb),Sb=je.a.cC(Eb),nc=je.a.nD(Eb);Ja=Ja===ub.a.q$d;v.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Ja});if(1===zb)return this.rj.E7||je.a.Cab(Eb)?2:Ja&&Sb<this.wje&&nc<this.vje||!Ja&&Sb>this.Yje&&nc>this.Xje?32:2;zb=Ja?1.1:.9;this.setSize(Eb,jb,Sb*zb,nc*zb,!0);return 32};this.Puc=(Ja,jb,zb,Eb,Sb)=>{if(!this.Xqa(jb))return 8;Ja=je.a.Tn(jb);jb=je.a.eWa(Ja);zb=je.a.dWa(Ja);if(0>=jb||
0>=zb)return 2;Ja=je.a.cC(Ja)/jb*100;Sb.setValue(Bd.a.m7c,Ja);return 32};this.Lmc=(Ja,jb,zb,Eb,Sb)=>{if(!this.Xqa(jb))return 8;Ja=je.a.Tn(jb);if(1===zb)return this.rj.E7||je.a.Cab(Ja)?2:32;v.ULS.sendTraceTag(20459937,322,50,"Change image scale.");zb=Sb.ka(Bd.a.m7c,-1)/100;Eb=Sb.ka(Bd.a.pQi,!1);const nc=Sb.ka(Bd.a.zUf,!0);Sb=Sb.ka(Bd.a.AUf,!0);if(0>=zb)return Sr.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.Qsb}),2;const Dc=je.a.eWa(Ja),Zc=je.a.dWa(Ja),Gd=je.a.cC(Ja),de=je.a.nD(Ja);if(0>=Dc||0>=Zc)return Sr.Bc.$b(Uf.a.Q4,
{["Reason"]:Ff.a.Qsb}),2;Eb?(Eb=nc?zb*Gd:Gd,zb=Sb?zb*de:de):(Eb=nc?zb*Dc:Gd,zb=Sb?zb*Zc:de);this.setSize(Ja,jb,Eb,zb);Jf.a.vd().wn&&Jf.a.vd().Fk.NG(jb.node);this.HPa();return 32};this.FYb=(Ja,jb,zb,Eb,Sb)=>{if(!this.YQ(jb))return 8;Ja=je.a.Tn(jb);Ja=je.a.nD(Ja);if(0>=Ja)return 2;Sb.setValue(Bd.a.bLa,Ja);return 32};this.bLa=(Ja,jb,zb,Eb,Sb)=>{if(!this.Xqa(jb))return 8;Ja=je.a.Tn(jb);if(1===zb)return this.rj.E7||je.a.Cab(Ja)?2:32;v.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");zb=
Sb.ka(Bd.a.bLa,0);Sb=je.a.Bab(Ja);if(0>=zb)return Sr.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.Qsb}),2;Eb=je.a.eWa(Ja);const nc=je.a.dWa(Ja),Dc=je.a.cC(Ja);var Zc=je.a.nD(Ja);Zc=Dc/Zc;if(0>=Eb||0>=nc)if(Sr.Bc.$b(Uf.a.Q4,{["Reason"]:Ff.a.Qsb}),this.zTj(Ja))return 2;this.setSize(Ja,jb,Sb?zb*Zc:Dc,zb);Jf.a.vd().wn&&Jf.a.vd().Fk.NG(jb.node);qa.StaticActiveAppFrame.za().Fe();return 32};this.GYb=(Ja,jb,zb,Eb,Sb)=>{if(!this.YQ(jb))return 8;Ja=je.a.Tn(jb);Ja=je.a.cC(Ja);if(0>=Ja)return 2;Sb.setValue(Bd.a.cLa,Ja);return 32};
this.cLa=(Ja,jb,zb,Eb,Sb)=>{if(!this.Xqa(jb))return 8;Ja=je.a.Tn(jb);if(1===zb)return this.rj.E7||je.a.Cab(Ja)?2:32;v.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");zb=Sb.ka(Bd.a.cLa,0);Sb=je.a.Bab(Ja);if(0>=zb)return Sr.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.Qsb}),2;Eb=je.a.eWa(Ja);const nc=je.a.dWa(Ja);var Dc=je.a.cC(Ja);const Zc=je.a.nD(Ja);Dc=Zc/Dc;if(0>=Eb||0>=nc)if(Sr.Bc.$b(Uf.a.Q4,{["Reason"]:Ff.a.Qsb}),this.zTj(Ja))return 2;this.setSize(Ja,jb,zb,Sb?zb*Dc:Zc);Jf.a.vd().wn&&Jf.a.vd().Fk.NG(jb.node);
qa.StaticActiveAppFrame.za().Fe();return 32};this.IYb=(Ja,jb,zb,Eb,Sb)=>{if(!this.YQ(jb))return 8;Ja=je.a.Tn(jb);Ja=je.a.Bab(Ja);Sb.setValue(Bd.a.b0,Ja);return 32};this.b0=(Ja,jb,zb,Eb,Sb)=>{if(!this.YQ(jb))return 8;Ja=je.a.Tn(jb);if(1===zb&&this.rj.E7)return 2;Jf.a.vd().wn&&Jf.a.vd().Fk.NG(jb.node);Sb&&(jb=Sb.ka(Bd.a.b0,!0),v.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Ik.KOj(Ja,jb),qa.StaticActiveAppFrame.za().Fe());return 32};this.kdb=(Ja,jb,zb,Eb,Sb)=>{if(!this.YQ(jb))return 8;
Ja=je.a.Tn(jb);Ja=je.a.I_(Ja);Sb.setValue(Bd.a.lsb,Ja);return 32};this.lsb=(Ja,jb,zb,Eb,Sb)=>{if(!this.YQ(jb))return 8;if(1===zb)return this.rj.E7?2:32;if(Jf.a.vd().wn&&(Ja=jb.node.ka(Fe.a.jK,Bm.a.Mu),Ja!==Bm.a.Mu&&(Ja=Jf.a.vd().Fk.brb(Ja),ZF.a.getInstance().Deb(Ja))))return Sr.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.$G}),2;Ja=je.a.Tn(jb);Sb=Sb.ka(Bd.a.lsb,null);this.Ik.gXo(Ja,jb,Sb);v.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Pd.ev(13);return 32};this.jdb=(Ja,jb,zb,Eb,Sb)=>{if(!this.YQ(jb))return 8;
Ja=je.a.Tn(jb);Ja=je.a.$Va(Ja);Sb.setValue(Bd.a.a0,Ja);return 32};this.a0=(Ja,jb,zb,Eb,Sb)=>{if(!this.YQ(jb))return 8;if(1===zb)return this.rj.E7?2:32;if(Jf.a.vd().wn&&(Ja=jb.node.ka(Fe.a.jK,Bm.a.Mu),Ja!==Bm.a.Mu&&(Ja=Jf.a.vd().Fk.brb(Ja),ZF.a.getInstance().Deb(Ja))))return Sr.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.$G}),2;Ja=je.a.Tn(jb);Sb=Sb.ka(Bd.a.a0,null);this.Ik.fXo(Ja,jb,Sb);v.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Pd.ev(13);return 32};this.Zdb=(Ja,jb,zb)=>{var Eb,
Sb;if(1===zb)return 32;if(!jb.view.ue)return v.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Ja),8;jb=jb.view;zb=null===(Sb=null===(Eb=jb.lb)||void 0===Eb?void 0:Eb.gb)||void 0===Sb?void 0:Sb.K(0);if(!zb)return v.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Ja),8;Sb=zb.Qa;Eb=this.yV.Xf("UserAction",Ja.toString());let nc;Ja==ub.a.wxg?nc=this.g7c.Zdb(Sb,2):Ja==ub.a.zxg?(nc=this.g7c.Zdb(Sb,0),5==nc&&(nc=this.g7c.Zdb(Sb,2))):Ja==ub.a.Axg&&(nc=this.g7c.Zdb(Sb,
1),5==nc&&(nc=this.g7c.Zdb(Sb,3)));switch(nc){case 4:Sb=32;jb.n4();break;case 5:Sb=2;break;default:Sb=8}Eb.stop();v.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",nc,Eb.Hi,Ja);return Sb};this.Ik=b;this.ao=h;this.Pd=r;this.rh=A;this.ib=M;this.Yd=Xc.a.uq?Ik.a.getInstance(Sc.a):Ik.a.getInstance(Zi.a)}get rj(){return cm.PageReader.instance}get lfa(){return this.ao.instance}get Qb(){return this.ga}E$m(){this.Yje=Rh.a.zn(1,0);this.Xje=Rh.a.zn(1,1);this.wje=Rh.a.zn(1920,
0);this.vje=Rh.a.zn(1280,1)}Wb(b){this.ga=b;const h=this.Gdo,r=this.Fcn,A=this.BSb,M=this.mVm;b.fb(ub.a.EX,mc.a.view,r,1284);b.qa(ub.a.BSb,mc.a.Vc,A);b.qa(ub.a.wxg,mc.a.view,this.Zdb);b.qa(ub.a.zxg,mc.a.view,this.Zdb);b.qa(ub.a.Axg,mc.a.view,this.Zdb);b.qa(ub.a.BSb,mc.a.image,A);b.Pc(ub.a.BSb,1284);b.fb(ub.a.iVd,mc.a.view,r,1284);b.fb(ub.a.iof,mc.a.view,h,1028);this.xs(b,ub.a.q$d,M);this.xs(b,ub.a.jEg,M);this.xs(b,ub.a.Puc,this.Puc);this.xs(b,ub.a.FYb,this.FYb);this.xs(b,ub.a.GYb,this.GYb);this.xs(b,
ub.a.kdb,this.kdb);this.xs(b,ub.a.jdb,this.jdb);this.xs(b,ub.a.Lmc,this.Lmc);this.xs(b,ub.a.Cxe,this.bLa);this.xs(b,ub.a.Dxe,this.cLa);this.xs(b,ub.a.Snd,this.lsb);this.xs(b,ub.a.U_b,this.a0);this.xs(b,ub.a.IYb,this.IYb);this.xs(b,ub.a.b0,this.b0);this.xs(b,ub.a.mzf,this.mzf);b.fb(ub.a.vii,mc.a.view,this.NZl,4);b.Pc(ub.a.q$d,4);b.Pc(ub.a.jEg,4);b.Pc(ub.a.Puc,69);b.Pc(ub.a.FYb,69);b.Pc(ub.a.GYb,69);b.Pc(ub.a.IYb,69);b.Pc(ub.a.kdb,69);b.Pc(ub.a.jdb,69);b.Pc(ub.a.b0,4);b.Pc(ub.a.Lmc,4);b.Pc(ub.a.Cxe,
4);b.Pc(ub.a.Dxe,4);b.Pc(ub.a.Snd,4);b.Pc(ub.a.U_b,4);this.E$m()}xs(b,h,r){b.qa(h,mc.a.image,r);b.qa(h,mc.a.$Ob,r);b.qa(h,mc.a.Fd,r);b.qa(h,mc.a.V$,r)}eKl(b){new Jk(b,me.a.instance,y.AFrameworkApplication.J,null,this.rh,this.ga,new wk.b)}oGp(b){return this.rj.E7?(Sr.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(Sr.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.V6l}),!1):Sr.sg.F2(b)?(Sr.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.$G}),!1):this.lfa&&this.lfa.KX(b)?(Sr.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.C8a}),
!1):!0}bnn(b){const h=je.a.Tn(b);return h&&5===je.a.Ak(h)&&this.LXi(b,h)}LXi(b,h){(h=!je.a.tkc(h)&&!je.a.Dee(h))||Sr.Bc.$b(Uf.a.Vn,{["Reason"]:Ff.a.T6h});return h&&this.oGp(b)}Nbn(b,h){var r,A;h=new Bx(h,me.a.instance,y.AFrameworkApplication.J,b,this.rh,this.ga,this.ib,new wk.b,this.Z_o);if(h.cOg(b))Xc.a.uq?this.Yd.logKpiUsage({kpiName:Sc.d.OKa,kpiType:0}):(null===(A=y.AFrameworkApplication.J)||void 0===A?0:A.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Yd.logKpiUsage({kpiName:Zi.c.dLa,kpiType:0});
else return Xc.a.uq?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new bb.a,{extendedProperties:b}),this.Yd.logKpiFailure({kpiName:Sc.d.OKa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:Object(rh.c)(Sc.d.Olc)})):(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new bb.a,{extendedProperties:b}),this.Yd.logKpiFailure({kpiName:Zi.c.dLa,
errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:Zi.c.Jmc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):za.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),v.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new ei.a(document.body,Object(F.a)(h,h.lwb,"onUploadFrameInitialized"),Object(F.a)(h,
h.ooa,"uploadResponseReceived"),y.AFrameworkApplication.J,!1,void 0,tf.a(y.AFrameworkApplication.J));return!0}YQ(b){return this.bnn(b)}Xqa(b){const h=je.a.Tn(b);if(!h)return!1;const r=$a.a.instance.Oa(23),A=je.a.Ak(h);return 5===A||10===A||48===A||11===A||r&&r.isFeatureEnabled(42)&&4===A?this.LXi(b,h):!1}setSize(b,h,r,A,M=!1){Jf.a.vd().wn&&Jf.a.vd().Fk.NG(h.node);const ba=je.a.Bab(b);let oa=1;r>this.wje?oa=this.wje/r:r<this.Yje&&(oa=this.Yje/r);let Ja=1;A>this.vje?Ja=this.vje/A:A<this.Xje&&(Ja=this.Xje/
A);if(ba||M)oa=Math.min(oa,Ja),Ja=Math.min(oa,Ja);1!==oa&&(r*=oa);1!==Ja&&(A*=Ja);this.Nyf(b,h,r,A)}Nyf(b,h,r,A){this.Ik.k0o(b,h,r,A)}zHn(){v.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}HPa(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=$a.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}zTj(b){const h=je.a.eWa(b);b=je.a.dWa(b);
return 0>=h||0>=b}static get sg(){return ve.a.instance}static get Bc(){return Wg.a.instance}}Object(u.a)(Sr,"ImageActor",null,[]);var KO=d(828);class JA{constructor(b,h,r,A,M,ba){this.zI=b;this.graphNode=h;this.Ehc=r;this.TUm=A;this.IAa=M;this.Po=ba;this.fCd=new KO.a(this.Qp(),JA.qCc);if(Xc.a.uq||Xc.a.xV)this.Yd=Ik.a.getInstance(Sc.a)}Gra(b){this.XX("crop");this.Po.mY([7]);if(null===this.zI||void 0===this.Ehc||void 0===this.IAa)return this.AD("crop","Argument(s) invalid"),!1;const h=this.getGraphicData("crop");
if(void 0===h)return!1;const r=this.IAa.cTm();r.top=b.top;r.left=b.left;r.right=b.right;r.bottom=b.bottom;try{if(!this.GTc(r,h))return this.nVb("crop","Failed to apply and update"),this.AD("crop","Failed to apply and update"),!1}catch(A){return this.nVb("crop",A),this.AD("crop",A.stack?A.stack:A.message?A.message:A.toString()),!1}this.Po.lM([7]);this.O4();this.ncd("crop");return!0}rotate(b){this.XX("rotate");this.Po.mY([8]);if(null===this.zI||void 0===this.Ehc||void 0===this.IAa)return this.AD("rotate",
"Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");if(void 0===h)return!1;b-=this.zI.Wga.nGi();if(0!==b){const r=this.IAa.gTm();r.rotation=b;try{if(!this.GTc(r,h))return this.AD("rotate","Failed to apply and update"),!1}catch(A){return this.nVb("rotate",A),this.AD("rotate",A.stack?A.stack:A.message?A.message:A.toString()),!1}}this.Po.lM([8]);this.O4();this.ncd("rotate");return!0}flip(b,h){const r="flip"+(b?"H":"")+(h?"V":"");this.XX(r);this.Po.mY([9]);if(null===this.zI||void 0===this.Ehc||
void 0===this.IAa)return this.AD(r,"Argument(s) invalid"),!1;const A=this.getGraphicData(r);if(void 0===A)return!1;const M=this.IAa.dTm();M.flip=this.IAa.gum();M.flip.x=b;M.flip.y=h;try{if(!this.GTc(M,A))return this.AD(r,"Failed to apply and update"),!1}catch(ba){return this.nVb(r,ba),this.AD(r,ba.stack?ba.stack:ba.message?ba.message:ba.toString()),!1}this.Po.lM([9]);this.O4();this.ncd(r);return!0}hVd(b,h,r){const A="changePictureBorderProps"+(void 0!==b?"_Weight":"")+(void 0!==h?"_DashType":"")+
(void 0!==r?"_Color":"");this.XX(A);this.Po.mY([10]);if(null===this.zI||void 0===this.Ehc||void 0===this.IAa)return this.AD(A,"Argument(s) invalid"),!1;const M=this.getGraphicData(A);if(void 0===M)return!1;const ba=this.IAa.aTm();void 0!==b&&(ba.weight=b);void 0!==h&&(ba.lN=h);void 0!==r&&(ba.color=r);try{if(!this.GTc(ba,M))return this.nVb(A,"Failed to apply and update"),this.AD(A,"Failed to apply and update"),!1}catch(oa){return this.nVb(A,oa),this.AD(A,oa.stack?oa.stack:oa.message?oa.message:oa.toString()),
!1}this.Po.lM([10]);this.O4();this.ncd(A);return!0}resize(b,h){this.XX("resize");this.Po.mY([11]);if(null===this.zI||void 0===this.Ehc||void 0===this.IAa)return this.AD("resize","Argument(s) invalid"),!1;const r=this.getGraphicData("resize");if(void 0===r)return!1;let A=0;var M=0;({width:A,height:M}=je.a.C9a(this.zI));b/=A;h/=M;M=this.IAa.hTm();M.scale=this.IAa.uMm();M.scale.width=b;M.scale.height=h;try{if(!this.GTc(M,r))return this.AD("resize","Failed to apply and update"),!1}catch(ba){return this.nVb("resize",
ba),this.AD("resize",ba.stack?ba.stack:ba.message?ba.message:ba.toString()),!1}this.Po.lM([11]);this.O4();this.ncd("resize");return!0}static get qCc(){return $a.a.instance.Oa(96)}getGraphicData(b){try{const h=this.fCd.hPf();return this.zI.getGraphicData(h)}catch(h){this.AD(b,h.stack?h.stack:h.message?h.message:h.toString())}}GTc(b,h){this.Ehc.apply(b,h);b=this.zI.BPb(h);if(void 0===b)return!1;this.Twp(b);return!0}Twp(b){const h=new Qb.GraphTransaction(15);h.Ab(this.graphNode);this.zI.setValue(le.a.EN,
b.EN);this.TUm.tNo(b.Dmi,b.qCa,this.zI);h.dispose()}Qp(){return Object(fn.a)().Nu(this.graphNode)}XX(b){const h=this.eRg;h.cpb=b;v.ULS.sendTraceTag(509657553,322,50,"{0}",h)}AD(b,h){const r=this.eRg;r.message=h;r.cpb=b;v.ULS.sendTraceTag(509666444,322,15,"{0}",r)}get eRg(){return{["id"]:je.a.D9a(this.zI),["type"]:je.a.Ak(this.zI)}}ncd(b){Xc.a.uq&&this.Yd.logKpiSuccess({kpiName:Sc.d.m$d+Sc.b.E4d+b+Nv.a[je.a.Ak(this.zI)].toString()})}nVb(b,h){if(Xc.a.uq){const {width:r,height:A}=je.a.C9a(this.zI);h=
Object.assign(new bb.a,{extendedProperties:new Map([["Exception",h.message?h.message:h.toString()]])});h.extendedProperties.set("ErrorLevel","warning");this.Yd.logKpiFailure({kpiName:Sc.d.m$d+Sc.b.E4d+b+Nv.a[je.a.Ak(this.zI)].toString(),errorName:"DrawingResponseInvalid"+Object(rh.b)(A,r),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:h},optionalVeto:Object(rh.c)(Sc.d.KLi,h,null,!1)})}}O4(){if(Xc.a.xV){var b=this.Po.records;for(const [h,r]of Object.entries(b))b={additionalValues:Object.assign(new bb.a,
{durationMs:r}),hasImpliedUsage:!0},this.Yd.logKpiSuccess({kpiName:Sc.d.$tc+wk.a[h]+Nv.a[je.a.Ak(this.zI)].toString(),optionalProperties:b}),this.Po.Dvc(Number(h))}}}Object(u.a)(JA,"EditWithGC2Command",null,[]);class Dp{tNo(b,h,r){this.ZCn(b,h);this.wNo(r)}ZCn(b,h){this.TJ=Array(4);this.TJ[An.a.left]=b.Xzf;this.TJ[An.a.top]=b.Zzf;this.TJ[An.a.right]=b.Yzf;this.TJ[An.a.bottom]=b.Wzf;this.qVa=b.qVa;this.rVa=b.rVa;(this.qCa=h)&&this.zCl()}wNo(b){b.setValue(le.a.nBa,Math.round(this.qVa).toString());b.setValue(le.a.oBa,
Math.round(this.rVa).toString());const h=Array(4);this.TJ.forEach((r,A)=>{h[A]=Math.round(r).toString()});b.setValue(le.a.rWa,h);b.setValue(le.a.jab,this.qCa)}zCl(){this.jip();const b=this.qVa/2,h=this.rVa/2;this.qVa%2&&0===this.rVa%2?(--this.TJ[An.a.left],++this.TJ[An.a.top]):this.rVa%2&&0===this.qVa%2&&(++this.TJ[An.a.left],--this.TJ[An.a.top]);this.TJ[An.a.left]+=b-h;this.TJ[An.a.right]-=b-h;this.TJ[An.a.top]+=h-b;this.TJ[An.a.bottom]-=h-b}jip(){const b=this.qVa;this.qVa=this.rVa;this.rVa=b}}Object(u.a)(Dp,
"GraphicsExtents",null,[]);var ZL=d(1118),$L=d(1119),PK=d(529);class QK{constructor(){this.wIp={["PictureBorderWeightZeroPointTwoFive"]:.25,["PictureBorderWeightZeroPointFive"]:.5,["PictureBorderWeightZeroPointSevenFive"]:.75,["PictureBorderWeightOne"]:1,["PictureBorderWeightOnePointFive"]:1.5,["PictureBorderWeightTwoPointTwoFive"]:2.25,["PictureBorderWeightThree"]:3,["PictureBorderWeightFourPointFive"]:4.5};this.uOl={["PictureBorderStyleSolid"]:0,["PictureBorderStyleDash"]:7,["PictureBorderStyleRoundDot"]:8};
this.xdo={["background1"]:0,["text1"]:1,["background2"]:2,["text2"]:3,["accent1"]:4,["accent2"]:5,["accent3"]:6,["accent4"]:7,["accent5"]:8,["accent6"]:9};this.wdo={[0]:"background1",[1]:"text1",[2]:"background2",[3]:"text2",[4]:"accent1",[5]:"accent2",[6]:"accent3",[7]:"accent4",[8]:"accent5",[9]:"accent6"};this.Cdi={SNa:{Auc:1}};this.Fdi=.75;this.Ddi=0;this.Vlp=8;this.LTn=6}Anp(b,h){if(b){var r=this.SGm(b);h=h.Wga.m8d();b.On=void 0===r?!1:r===h}}znp(b,h){if(b){var r=this.yEi(b);h=h.Wga.TMf();b.On=
void 0===r||void 0===h?!1:r===h}}static $4c(b){return b.Wga.$4c()}DPm(b){var h=b.SNa;b=this.wdo[h.Auc];const r=h.HIa.Nie;h=h.HIa.Mie;let A,M;void 0!=r?A=r:void 0!=h&&(M=100-h);return{Auc:b,HIa:{sfb:A,Ixc:M}}}Cca(b,h,r){var A;const M=null===(A=w())||void 0===A?void 0:A.cJa();h=new JA(b,h,M,new Dp,z(),new wk.b);r=this.CEi(r);if(void 0===r)return!1;A=!!b.Wga.$4c();b=void 0!==b.Wga.TMf();return h.hVd(r,b?void 0:this.Ddi,A?void 0:this.Cdi)}CZo(b,h,r){var A;const M=null===(A=w())||void 0===A?void 0:A.cJa();
h=new JA(b,h,M,new Dp,z(),new wk.b);r=this.yEi(r);if(void 0===r)return!1;A=!!b.Wga.$4c();b=!!b.Wga.m8d();return h.hVd(b?void 0:this.Fdi,r,A?void 0:this.Cdi)}t4(b,h,r){var A;const M=null===(A=w())||void 0===A?void 0:A.cJa();A=new JA(b,h,M,new Dp,z(),new wk.b);h=this.PGm(r,h);if(void 0===h)return!1;r=!!b.Wga.m8d();b=void 0!==b.Wga.TMf();return A.hVd(r?void 0:this.Fdi,b?void 0:this.Ddi,h)}Cvc(b,h){var r;const A=null===(r=w())||void 0===r?void 0:r.cJa();return(new JA(b,h,A,new Dp,z(),new wk.b)).hVd()}PGm(b,
h){if(b.length===this.Vlp){b=parseInt(b,16)>>>24;h=Object(fn.a)().Nu(h);h=Ps.$rp(b-1,h);if(void 0===h){v.ULS.sendTraceTag(508692042,322,15,`getPictureBorderColorFromActionData: Could not find theme color info for color index ${b}`);return}b=this.xdo[h.PCe];if(void 0===b){v.ULS.sendTraceTag(508683782,322,15,`getPictureBorderColorFromActionData: Could not find preset scheme color for ${h.PCe}`);return}const r=void 0!==h.sfb?100-h.sfb:100-h.Ixc;return{SNa:{Auc:b,HIa:{Mie:r,Nie:void 0!==h.sfb?100-r:void 0}}}}if(b.length===
this.LTn)return{bmd:"#"+C.a.QJ(Yl.a.Umb(parseInt(b,16)),6)};v.ULS.sendTraceTag(508692041,322,15,"setPictureBorderColor: Invalid action data received.")}SGm(b){b=this.CEi(b);if(void 0!==b)return b=Rh.a.G0(b,0,!1),Rh.a.Zkg(b)}CEi(b){b=this.wIp[b.SourceControlId];void 0===b&&v.ULS.sendTraceTag(508692040,322,15,"getPictureBorderWeightFromActionDataInPoints: Invalid action data received.");return b}yEi(b){b=this.uOl[b.SourceControlId];void 0===b&&v.ULS.sendTraceTag(508692039,322,15,"getPictureBorderDashTypeFromActionData: Invalid action data received.");
return b}}Object(u.a)(QK,"Gc2PictureBorderHelper",null,[]);var tN=d(388),LO=d(438),MO=d(1349);class bp extends Sr{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){super(b,h,A,ba,oa,Ja,jb);this.auh=!1;this.mTe=this.Tda=null;this.Sx=(Eb,Sb,nc,Dc,Zc)=>{if(!this.YQ(Sb))return 8;if(1===nc)return this.rj.E7?2:32;Eb=parseInt(Zc);v.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+Eb);this.NLd.Zno(Sb,je.a.Tn(Sb),Eb);this.ecd(Sb);this.HPa();return 32};this.ave=(Eb,Sb,nc)=>{if(!this.YQ(Sb))return 8;v.ULS.sendTraceTag(593372311,
322,50,"Applying Style Reset");Eb=je.a.Tn(Sb);if(1===nc)return this.rj.E7?2:32;nc=je.a.F9a(Eb);nc===pr.a.Cdb?(nc=new Qb.GraphTransaction(15),nc.Ab(Sb.node),je.a.Pnc()?Eb.setValue(Rc.a.PXb,""):this.SM.HAo(Eb),nc.dispose(),this.MOc.create(Eb,Sb).Sx(eg.a.WGj),this.ecd(Sb)):nc===pr.a.yRh&&this.MOc.create(Eb,Sb).Sx(eg.a.WGj);return 32};this.XWm=(Eb,Sb,nc,Dc,Zc)=>{if(!this.YQ(Sb))return 8;Eb=je.a.Tn(Sb);if(1===nc)return this.rj.E7||je.a.xoc(Eb)?2:32;Zc&&(this.SM.Rrd(Eb,Sb),v.ULS.sendTraceTag(22381021,322,
50,"Toggled Image Crop Mode"),qa.StaticActiveAppFrame.za().Fe());this.HPa();return 32};this.YWm=(Eb,Sb,nc,Dc,Zc)=>{var Gd;if(!this.YQ(Sb))return 8;if(1===nc)return this.rj.E7?2:32;Eb=je.a.Tn(Sb);if(Zc){nc=je.a.hde(je.a.Tn(Sb));v.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+nc);Dc=Zc.ka(Bd.a.qsb,0);const he=Zc.ka(Bd.a.nsb,0),fe=Zc.ka(Bd.a.osb,0);Zc=Zc.ka(Bd.a.psb,0);var de=je.a.yfa(Eb);const Yd=de.bottom,Td=de.left,wf=de.right;if(Dc===de.top&&he===Yd&&fe===Td&&Zc===wf)return v.ULS.sendTraceTag(23070480,
322,50,"Cropping Properties were the same as before, no need to update."),32;if(Object(Zg.d)(Eb)&&(de=null===(Gd=w())||void 0===Gd?void 0:Gd.cJa(),(new JA(Eb,Sb.node,de,new Dp,z(),new wk.b)).Gra({top:.001*Dc,bottom:.001*he,left:.001*fe,right:.001*Zc})))return 32;nc?(new ZL.a(Eb,new $L.a,new wk.b)).TUo(Dc,he,fe,Zc,this.sZn,Sb):this.NLd.Ono(Sb,je.a.Tn(Sb),Dc,he,fe,Zc);this.ecd(Sb);qa.StaticActiveAppFrame.za().Fe()}return 32};this.y$d=(Eb,Sb,nc,Dc,Zc)=>{if(!this.YQ(Sb))return 8;Dc=je.a.Tn(Sb);if(1===
nc)return this.rj.E7||je.a.xoc(Dc)?2:32;if(Zc){v.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.SM.WBa()||this.SM.Rrd(Dc,Sb);switch(Eb){case Hc.a.c7c:Eb=Zc.ka(Bd.a.qsb,-1);nc=0;break;case Hc.a.$6c:Eb=Zc.ka(Bd.a.nsb,-1);nc=1;break;case Hc.a.a7c:Eb=Zc.ka(Bd.a.osb,-1);nc=2;break;case Hc.a.b7c:Eb=Zc.ka(Bd.a.psb,-1);nc=3;break;default:return 8}this.SM.Fzp(Eb,nc);this.ecd(Sb);qa.StaticActiveAppFrame.za().Fe()}return 32};this.$wb=(Eb,Sb,nc,Dc,Zc)=>
{if(!this.YQ(Sb))return 8;je.a.Tn(Sb);Zc&&(Eb=this.SM.WBa(),Zc.setValue(Bd.a.WBa,Eb));return 32};this.Ouc=(Eb,Sb,nc,Dc,Zc)=>{if(!this.YQ(Sb))return 8;Eb=je.a.Tn(Sb);if(Zc){if(this.SM.WBa())({top:Gd,bottom:nc,left:Eb,right:Sb}=this.SM.Fpm());else{Dc=Rh.a.xf(je.a.cC(Eb),0);var Gd=Rh.a.xf(je.a.nD(Eb),1);Sb=je.a.yfa(Eb);const de=Math.max(Sb.top,0);nc=Math.max(Sb.bottom,0);Eb=Math.max(Sb.left,0);Sb=Math.max(Sb.right,0);Dc=1E5*Dc/(1E5-(Eb+Sb));const he=1E5*Gd/(1E5-(de+nc));Gd=Math.floor(de*he/1E5);nc=Math.floor(nc*
he/1E5);Eb=Math.floor(Eb*Dc/1E5);Sb=Math.floor(Sb*Dc/1E5)}Zc.setValue(Bd.a.qsb,Gd);Zc.setValue(Bd.a.nsb,nc);Zc.setValue(Bd.a.osb,Eb);Zc.setValue(Bd.a.psb,Sb)}return 32};this.Rlc=(Eb,Sb,nc,Dc,Zc)=>{if(!this.YQ(Sb))return 8;if(1===nc){if(this.rj.E7)return 2;this.bJn();return 32}Eb=je.a.Tn(Sb);this.SM.WBa()&&this.SM.Rrd(Eb,Sb);Eb=Zc.ka(Bd.a.tOa,"");Zc=Zc.ka(Bd.a.ngb,0);v.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:Zc,["SourceControlId"]:Eb});switch(Zc){case 1:this.SM.d1o(Sb);
break;case 8:this.SM.yye(Sb,Qt.a.k1b,1);break;case 9:this.SM.yye(Sb,Qt.a.k1b,3);break;case 3:this.SM.yye(Sb,Qt.a.none,void 0,!0);break;case 4:this.SM.yye(Sb,Qt.a.none,void 0,!1)}this.HPa();qa.StaticActiveAppFrame.za().Fe();return 32};this.gvc=(Eb,Sb,nc,Dc,Zc)=>{if(!this.YQ(Sb))return 8;Eb=je.a.Tn(Sb);Sb=je.a.K7(Sb);nc=je.a.r3(Eb);Dc=je.a.xlc(Eb);Eb=je.a.Zy(Eb);return this.Mno(Sb,nc,Dc,Eb,Zc)?32:8};this.$Wm=(Eb,Sb,nc,Dc,Zc)=>{var Gd;if(!this.Xqa(Sb))return 8;Dc=je.a.Tn(Sb);if(1===nc)return fc.SessionStatusManager.instance.Nk?
8:this.rj.E7||je.a.yoc(Dc)?2:32;this.SM.WBa()&&this.SM.Rrd(Dc,Sb);if(Zc){const he=Zc.ka(Bd.a.j7c,0),fe=je.a.hde(Dc);v.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",he,fe);nc=je.a.Z2(Dc);var de=je.a.Gsa(Dc);let Yd=de.$pb;de=de.dKa;switch(he){case 0:nc=Zc.ka(Bd.a.CX,0);break;case 2:nc-=90;nc=rh.e(nc);break;case 1:nc+=90;nc=rh.e(nc);break;case 4:Yd=!Yd;break;case 3:de=!de;break;case 5:nc+=Zc.ka(Bd.a.CX,0),nc=rh.e(nc)}if(Object(Zg.d)(Dc))if(Zc=null===(Gd=w())||void 0===Gd?
void 0:Gd.cJa(),Gd=new JA(Dc,Sb.node,Zc,new Dp,z(),new wk.b),4===he){if(Gd.flip(!0,!1))return 32}else if(3===he){if(Gd.flip(!1,!0))return 32}else if(Gd.rotate(nc))return 32;fe?(new ZL.a(Dc,new $L.a,new wk.b)).A_o(nc,Yd,de,this.F4n,Sb):he?this.MOc.create(Dc,Sb).EZo(nc,Yd,de):(Gd=hb.a.create(),Zc=new Qb.GraphTransaction(15,ub.a.gba),Zc.Ab(Sb.node),this.SM.pXo(Dc,nc),this.NLd.Vno(Sb,je.a.Tn(Sb),nc,Gd),Zc.iMa(Gd,1),Zc.Ei=Eb,Zc.dispose());this.HPa();this.ecd(Sb);qa.StaticActiveAppFrame.za().Fe()}return 32};
this.HYb=(Eb,Sb,nc,Dc,Zc)=>{if(!this.YQ(Sb))return 8;Eb=je.a.Tn(Sb);Eb=je.a.Z2(Eb);if(0>Eb)return 2;Zc.setValue(Bd.a.CX,Eb);return 32};this.F4n=(Eb,Sb,nc,Dc)=>{if(Eb){const Zc=new Qb.GraphTransaction(15,ub.a.gba);Zc.Ab(Dc.node);Sb.setValue(Bd.a.KLb,JSON.stringify(nc));Sb.setValue(Bd.a.Hu,Eb);this.SM.Gxe(Sb,nc.rotationAngle,nc.omc,nc.FBc);this.sPb(Sb);Zc.dispose()}};this.m4n=(Eb,Sb,nc,Dc)=>{if(Eb){const Zc=new Qb.GraphTransaction(15);Zc.Ab(Dc.node);Sb.setValue(Bd.a.KLb,JSON.stringify(nc));Sb.setValue(Bd.a.Hu,
Eb);this.SM.mxe(Sb,nc.wEe,nc.Qsd);this.sPb(Sb);Zc.dispose()}};this.sZn=(Eb,Sb,nc,Dc)=>{if(Eb){const Zc=new Qb.GraphTransaction(15);Zc.Ab(Dc.node);Sb.setValue(Bd.a.KLb,JSON.stringify(nc));Sb.setValue(Bd.a.Hu,Eb);this.SM.jXo(Sb,Math.round(nc.hJa*PK.a.vob),Math.round(nc.eJa*PK.a.vob),Math.round(nc.fJa*PK.a.vob),Math.round(nc.gJa*PK.a.vob));this.sPb(Sb);Zc.dispose()}};this.Ehd=(Eb,Sb,nc,Dc,Zc)=>{if(!this.Xqa(Sb))return 8;if(1===nc)return 32;Eb=this.Qp(Sb);if(!Eb)return 8;nc=je.a.Tn(Sb);Object(Zg.d)(nc)?
(Sb=QK.$4c(nc),void 0===Sb?Sb=bp.nhd.sca="":void 0!==Sb.SNa?(Sb=(new QK).DPm(Sb),bp.nhd.sca=Sb,Sb=""):Sb=bp.nhd.sca=Sb.bmd):(Sb=this.Mp.xEi(zm.a.pX(Sb),nc),bp.nhd.sca=Sb);this.VP&&this.VP.iBc(Sb);Sb=bp.nhd.mqb(Eb,df.a.nUa);if(!Sb)return 8;Zc.MenuItems=Sb;return 32};this.t4=(Eb,Sb,nc,Dc,Zc)=>{if(!this.Xqa(Sb))return 8;Dc=je.a.Tn(Sb);if(Object(Zg.d)(Dc)){if(!je.a.Anf(Dc))return 2}else if(Dc&&je.a.aA(Dc))return 2;if(1===nc)return 32;if(2!==nc)return 2;if(!Zc)return v.ULS.sendTraceTag(571287758,322,10,
"SetPictureBorderColor: actionData null"),8;if(Object(Zg.d)(Dc)){if(!this.tjc.t4(Dc,Sb.node,Zc))return 8}else{nc=new Qb.GraphTransaction(15);nc.Ab(Sb.node);const Gd=bp.Zva.mka(Sb.node,Zc);this.Mp.t4(Dc,Zc,Sb,Gd);this.sPb(Dc);nc.dispose()}Eb==ub.a.ood&&this.VP.zTa(Zc);this.Vvd();this.HPa();return 32};this.S3=(Eb,Sb,nc)=>{if(!this.Xqa(Sb))return 8;if(1===nc)return 32;qa.StaticActiveAppFrame.za().dismissFloatie();bp.FFa=new Gs("PictureBorder",ub.a.ood);bp.FFa.Wyb(0);return 32};this.Cca=(Eb,Sb,nc,Dc,
Zc)=>{if(!this.Xqa(Sb))return 8;if(1===nc)return 32;Eb=je.a.Tn(Sb);if(Object(Zg.d)(Eb)){if(!je.a.Anf(Eb))return 2}else if(Eb&&je.a.aA(Eb))return 2;if(!Zc)return v.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;if(Object(Zg.d)(Eb)){if(!this.tjc.Cca(Eb,Sb.node,Zc))return 8}else nc=new Qb.GraphTransaction(15),nc.Ab(Sb.node),this.Mp.Cca(Eb,Zc,Sb),this.sPb(Eb),nc.dispose();this.Vvd();this.HPa();return 32};this.ueb=(Eb,Sb,nc,Dc,Zc)=>{if(!this.Xqa(Sb))return 8;if(1===nc)return 32;
Eb=je.a.Tn(Sb);if(Object(Zg.d)(Eb)){if(!je.a.Anf(Eb))return 2}else if(Eb&&je.a.aA(Eb))return 2;if(!Zc)return v.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;if(Object(Zg.d)(Eb)){if(!this.tjc.CZo(Eb,Sb.node,Zc))return 8}else nc=new Qb.GraphTransaction(15),nc.Ab(Sb.node),this.Mp.ueb(Eb,Zc,Sb),this.sPb(Eb),nc.dispose();this.Vvd();this.HPa();return 32};this.Cvc=(Eb,Sb,nc)=>{if(!this.Xqa(Sb))return 8;if(1===nc)return 32;Eb=je.a.Tn(Sb);if(Object(Zg.d)(Eb)){if(!this.tjc.Cvc(Eb,
Sb.node))return 8}else nc=new Qb.GraphTransaction(15),nc.Ab(Sb.node),je.a.$lc(Eb)&&(this.Mp.Cvc(Eb),this.sPb(Eb)),nc.dispose();this.Vvd();this.HPa();return 32};this.SM=b;this.MOc=r;this.NLd=M;bp.ii=zb;null===oa||void 0===oa?void 0:oa.BA(bp.Ull)}get VP(){return null!=this.u3g?this.u3g:this.u3g=$a.a.instance.Oa(790)}static Ull(){bp.Hdo()}get Mp(){this.Tda||(this.Tda=new tN.a);return this.Tda}get tjc(){this.mTe||(this.mTe=new QK);return this.mTe}Wb(b){super.Wb(b);this.xs(b,ub.a.Sx,this.Sx);b.Pc(ub.a.Sx,
4);this.xs(b,ub.a.ave,this.ave);this.xs(b,Hc.a.$Ge,this.Rlc);b.Pc(Hc.a.$Ge,4);this.xs(b,Hc.a.aHe,this.Rlc);this.xs(b,Hc.a.bHe,this.Rlc);this.xs(b,Hc.a.cHe,this.Rlc);this.xs(b,Hc.a.dHe,this.Rlc);this.xs(b,Hc.a.eHe,this.Rlc);this.xs(b,Hc.a.gvc,this.gvc);b.Pc(Hc.a.gvc,101);this.xs(b,Hc.a.Z6c,this.XWm);b.Pc(Hc.a.Z6c,4);this.xs(b,Hc.a.$wb,this.$wb);b.Pc(Hc.a.$wb,101);this.xs(b,Hc.a.iQi,this.YWm);this.xs(b,Hc.a.c7c,this.y$d);this.xs(b,Hc.a.$6c,this.y$d);this.xs(b,Hc.a.a7c,this.y$d);this.xs(b,Hc.a.b7c,this.y$d);
this.xs(b,Hc.a.Nid,this.Ouc);b.Pc(Hc.a.Nid,101);this.xs(b,Hc.a.Fre,this.Ouc);b.Pc(Hc.a.Fre,101);this.xs(b,Hc.a.Gre,this.Ouc);b.Pc(Hc.a.Gre,101);this.xs(b,Hc.a.Hre,this.Ouc);b.Pc(Hc.a.Hre,101);this.xs(b,ub.a.gba,this.$Wm);b.Pc(ub.a.gba,4);this.xs(b,ub.a.HYb,this.HYb);b.Pc(ub.a.HYb,101);this.xs(b,ub.a.Ehd,this.Ehd);b.Pc(ub.a.Ehd,4);this.xs(b,ub.a.t4,this.t4);b.Pc(ub.a.t4,4);this.xs(b,ub.a.ood,this.t4);b.Pc(ub.a.ood,4);this.xs(b,ub.a.pig,this.S3);b.Pc(ub.a.pig,4);this.xs(b,ub.a.uDa,this.uDa.bind(this));
b.Pc(ub.a.uDa,4);this.xs(b,ub.a.Cca,this.Cca);b.Pc(ub.a.Cca,4);this.xs(b,ub.a.JYb,this.JYb.bind(this));b.Pc(ub.a.JYb,4);this.xs(b,ub.a.ueb,this.ueb);b.Pc(ub.a.ueb,4);this.xs(b,ub.a.ucg,this.Cvc);b.Pc(ub.a.ucg,4)}Nyf(b,h,r,A){var M;v.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+je.a.hde(b));this.SM.WBa()&&this.SM.Rrd(b,h);if(Object(Zg.d)(b)){const ba=null===(M=w())||void 0===M?void 0:M.cJa();if((new JA(b,h.node,ba,new Dp,z(),new wk.b)).resize(r,A))return}je.a.aA(b)?(b=
hb.a.create(),M=new Qb.GraphTransaction(15),M.Ab(h.node),this.NLd.Uno(h,je.a.Tn(h),r,A,b),M.iMa(b,1),M.dispose()):je.a.$xc(b)?(new ZL.a(b,new $L.a,new wk.b)).i_o(r,A,this.m4n,h):(super.Nyf(b,h,r,A),this.Pd.ev(13))}YQ(b){if(!b.Cl)return!1;var h=b.node;return(h=Object(Zg.c)()?h instanceof Wt.a||h instanceof MO.a?h:null:Object(Ma.a)(Wt.a,h))&&du.n(h)?(Sr.Bc.$b(YF.a.Vn,{["Reason"]:yI.a.cR}),!1):super.YQ(b)}static Hdo(){bp.CGb||(bp.ii.d6a(bp.Nvb),bp.CGb=!0)}Mno(b,h,r,A,M){return M?(M.oZi=b,M.r3=h,M.Xzb=
r,M.Ix=A,M.ngb=bp.oTm(M),!0):!1}ecd(b){Jf.a.vd().wn&&Jf.a.vd().Fk.NG(b.node)}bJn(){this.auh||(v.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.auh=!0)}sPb(b){const h=LO.a.instance.QBf(b);this.SM.Exe(b,h[An.a.left],h[An.a.right],h[An.a.top],h[An.a.bottom])}Qp(b){return b.contextId===mc.a.view?cm.PageReader.instance.IQb(b):Object(fn.a)().Nu(b.node)}uDa(b,h,r,A,M){if(!this.Xqa(h))return 8;2===r&&(b=je.a.Tn(h),Object(Zg.d)(b)?this.tjc.Anp(M,b):this.Mp.Skk(M,b));return 32}JYb(b,h,r,A,M){if(!this.Xqa(h))return 8;
2===r&&(b=je.a.Tn(h),Object(Zg.d)(b)?this.tjc.znp(M,b):this.Mp.Rkk(M,b));return 32}Vvd(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=$a.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get Zva(){return null!=bp.H5g?bp.H5g:bp.H5g=Pk.a.instance}static get nhd(){bp.tJ||(bp.tJ=new Ps("PictureBorder"),bp.Vfa(bp.tJ));return bp.tJ}static oTm(b){if(b.oZi)b=
1;else switch(b.Xzb){case Qt.a.none:b=b.r3?3:4;break;case Qt.a.k1b:b=1===b.Ix?8:3===b.Ix?9:2;break;case Qt.a.g2j:b=5;break;case Qt.a.o1j:b=6;break;case Qt.a.i1j:b=7;break;default:b=0}return b}static Vfa(b){b.SG(3,ub.a.t4);b.SG(4,ub.a.t4);b.SG(5,ub.a.ood);b.SG(6,ub.a.t4);b.b6a(tn.a.instance,1)}}bp.CGb=!1;bp.tJ=null;bp.FFa=null;bp.Nvb=()=>{bp.ii.Hvc(bp.Nvb);bp.CGb=!1;if(zg.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,
"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else v.ULS.sendTraceTag(509445760,322,50,"appChrome is undefined")};Object(u.a)(bp,"ImageActor",Sr,[]);class Tm{static get sl(){return null!=Tm.L2g?Tm.L2g:Tm.L2g=$a.a.instance.resolve(349)}static get oC(){return null!=Tm.W2g?Tm.W2g:Tm.W2g=$a.a.instance.resolve(34)}static get Z3(){return Tm.sl.ir}static get rh(){return null!=Tm.I6g?Tm.I6g:Tm.I6g=$a.a.instance.resolve(50)}static Wb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.uYb,
mc.a.view,Sn.a.yx);b.qa(ub.a.uYb,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.uYb,1036);b.qa(ub.a.FNb,mc.a.view,Sn.a.yx);b.qa(ub.a.FNb,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.FNb,1036);b.qa(ub.a.Mob,mc.a.view,Sn.a.yx);b.qa(ub.a.Mob,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.Mob,1036);b.qa(ub.a.zvc,mc.a.view,Sn.a.yx);b.qa(ub.a.zvc,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.zvc,1036);b.qa(ub.a.Gkd,mc.a.view,Sn.a.yx);b.qa(ub.a.Gkd,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.Gkd,1036);b.qa(ub.a.J$a,mc.a.view,Sn.a.yx);b.qa(ub.a.J$a,mc.a.paragraph,Tm.Rqa);
b.Pc(ub.a.J$a,1036);b.qa(ub.a.vsb,mc.a.view,Sn.a.yx);b.qa(ub.a.vsb,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.vsb,1036);b.qa(ub.a.I$a,mc.a.view,Sn.a.yx);b.qa(ub.a.I$a,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.I$a,1036);b.qa(ub.a.Ixe,mc.a.view,Tm.HAe);b.qa(ub.a.Ixe,mc.a.paragraph,Tm.HAe);b.Pc(ub.a.Ixe,1028);b.qa(ub.a.Uzg,mc.a.view,Tm.HAe);b.qa(ub.a.Uzg,mc.a.paragraph,Tm.HAe);b.Pc(ub.a.Uzg,1028);b.qa(ub.a.m0b,mc.a.view,Sn.a.yx);b.qa(ub.a.m0b,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.m0b,1036);b.qa(ub.a.Fyb,mc.a.view,Sn.a.yx);
b.qa(ub.a.Fyb,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.Fyb,1036);b.qa(ub.a.n0b,mc.a.view,Sn.a.yx);b.qa(ub.a.n0b,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.n0b,1036);b.qa(ub.a.PEg,mc.a.view,Sn.a.yx);b.Pc(ub.a.PEg,1028);b.qa(ub.a.xod,mc.a.view,Sn.a.yx);b.qa(ub.a.xod,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.xod,1036);b.qa(ub.a.yod,mc.a.view,Sn.a.yx);b.qa(ub.a.yod,mc.a.paragraph,Tm.Rqa);b.Pc(ub.a.yod,1036)}static HAe(b,h,r,A,M){2===r&&""===M[ki.a.Text]&&(b=b===ub.a.Ixe?ub.a.J$a:ub.a.I$a,h=new nD.a,h.value=0,h.unit=df.a.ILa?2:
1,y.AFrameworkApplication.va.Pb(b,2,h),qa.StaticActiveAppFrame.za().Fe());return 32}static Rqa(b,h,r,A,M){if(!({Oz:r}=Sn.a.hCg(r,h)).returnValue)return r;h=h.node;switch(b){case ub.a.uYb:Tm.Z3.Ung(h,!0);break;case ub.a.FNb:Tm.Z3.Ung(h,!1);break;case ub.a.Mob:Tm.Z3.Mob(h);break;case ub.a.zvc:Tm.Z3.sha(h,0);break;case ub.a.Gkd:Tm.Z3.qyb(h,0);break;case ub.a.vsb:case ub.a.J$a:r=new zc.a;r.set(h);r.vb(11);let ba=M.value;M=M.unit;b===ub.a.vsb&&(ba=(new Iq.a(M,ba)).Uu+Tm.oC.xI(h).Uu,M=1);Tm.Z3.iEa(r,M,
ba);break;case ub.a.I$a:Tm.Z3.syb(h,M.unit,M.value);break;case ub.a.m0b:M?(b=(new Iq.a(M.unit,M.value)).Uu,Tm.Z3.sha(h,b)):Tm.oC.B6d(h).Uu||Tm.Z3.sha(h,Lj.OutlineReader.E_(h));break;case ub.a.Fyb:M?(b=(new Iq.a(M.unit,M.value)).Uu,Tm.Z3.qyb(h,b)):Tm.oC.xI(h).Uu||Tm.Z3.qyb(h,Lj.OutlineReader.E_(h));break;case ub.a.n0b:Tm.Z3.sha(h,0);break;case ub.a.xod:b=M;b=(new Iq.a(b.unit,b.value)).Uu;Tm.Z3.LAg(h,1,b);break;case ub.a.yod:b=M,b=(new Iq.a(b.unit,b.value)).Uu,Tm.Z3.LAg(h,2,b)}Tm.rh.BI();A&&Lq.a.Tzb&&
(A.Ft|=Lq.a.Nqb(h));return 32}}Object(u.a)(Tm,"IndentationActor",null,[]);var uN=d(387),NO=d(64),RK=d(426),OO=d(1022);class Cq{constructor(b){this.d4a=this.KHa=this.NMc=null;this.UKh=!1;this.Tqe=h=>{if(this.KHa)if(h===La.a.Sqe)rd.FocusManager.instance().getRegion(pd.AFrame.adb).Rrc();else if(h===La.a.Rqe)rd.FocusManager.instance().getRegion(pd.AFrame.adb).Prc();else return 2;else return 2;return 32};this._frame=b}Zep(){if(this.UKh)this.C6i();else{const b=vb.a.create(y.AFrameworkApplication.J.jb("WopiBootstrapUrl"));
b.n2((h,r)=>{r.succeeded?(this.UKh=!0,this.C6i()):v.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});pb.a.y_(b)}}C6i(){if(this.NMc)v.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.nwa;this.KHa=document.createElement("div");b.parentNode.insertBefore(this.KHa,b);this.d4a=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:y.AFrameworkApplication.J.jb("FileName"),reactRoot:this.KHa});this.d4a.setWebpackPublicPath(y.AFrameworkApplication.W8);
this.d4a.renderDocumentPanel()}}nym(b){const h={};h.Container=b;h.BootstrapperUrl=y.AFrameworkApplication.J.jb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.SAb;b={};b.HostName=y.AFrameworkApplication.J.jb("FileSource");b.HostSessionId=y.AFrameworkApplication.J.jb("HostSessionId");b.UserId=y.AFrameworkApplication.J.jb("UserId");b.DocumentClickTime=new Date(this._frame.fvb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=y.AFrameworkApplication.J.jb("FileName");b.FileGetUrl=
"";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.fvb;h.Diagnostics=b;b={};b.WopiSrc=y.AFrameworkApplication.J.jb("WopiSrc");b.AccessToken=y.AFrameworkApplication.J.jb("AccessToken");b.AccessTokenTtl=y.AFrameworkApplication.J.jb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=
r=>{Cq.XZ=r;this.d4a.setMaxPage(Cq.XZ.GetPageCount());this.d4a.setCurrentPage(Cq.XZ.GetCurrentPage());this.d4a.setPageControlVisible(!0);Cq.XZ.RegisterEventHandler("PageChanged",A=>{this.d4a.setCurrentPage(A.newPage)});Cq.XZ.RegisterEventHandler("BrowserEvent",A=>{27===A.keyCode?this.closeViewer():A.button&&1!==A.button||this.KHa.click()});r=this._frame.fvb-(new Date).getTime();v.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",r);this.Wb();rd.FocusManager.instance().WN(pd.AFrame.adb,
!0);this.buildFocusRegion();this.vNa(rd.FocusManager.instance().ie(pd.AFrame.adb));this.KHa.click()};h.FnOnInitializeFailure=(r,A)=>{v.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",r.toString(),A.toString());this.closeViewer()};return h}buildFocusRegion(){const b=rd.FocusManager.instance();var h=b.getRegion(pd.AFrame.adb);h=[2,3];const r=b.ie(pd.AFrame.adb),A=new He.DOMFocusListing(()=>this.KHa);A.cha=!0;for(const M of h)A.un(M);h=b.gra(()=>this.KHa,r,A);h.WZa();h.BP=!0;h.l7a=!0;A.oA(A.dla)}Wb(){y.AFrameworkApplication.va.qa(La.a.Sqe,
xe.a.frame,this.Tqe);y.AFrameworkApplication.va.qa(La.a.Rqe,xe.a.frame,this.Tqe)}vNa(b){b.qt(rd.FocusManager.instance().LZ);b.qt(rd.FocusManager.instance().MZ);b.bindAction(rd.FocusManager.instance().LZ,La.a.Sqe);b.bindAction(rd.FocusManager.instance().MZ,La.a.Rqe)}loadViewer(b){b=this.nym(b);this.NMc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.NMc.Complete(b.WopiInfo)}closeViewer(){rd.FocusManager.instance().oV(pd.AFrame.adb);Cq.XZ&&(Cq.XZ.Dispose(),Cq.XZ=null,y.AFrameworkApplication.va.Ey(La.a.Sqe,
xe.a.frame,this.Tqe),y.AFrameworkApplication.va.Ey(La.a.Rqe,xe.a.frame,this.Tqe));this.NMc&&(this.KHa.parentNode.removeChild(this.KHa),this.KHa=this.NMc=null)}printAction(){v.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");y.AFrameworkApplication.va.Ob(ub.a.print,2)}downloadPdfAction(){v.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");y.AFrameworkApplication.va.Ob(Hc.a.UZc,2)}downloadCopyAction(){v.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");
y.AFrameworkApplication.va.Ob(La.a.dfa,2)}zoomInAction(){if(Cq.XZ){let b=Cq.XZ.GetZoomLevel();b+=.2;Cq.XZ.SetZoomLevel(b)}}zoomOutAction(){if(Cq.XZ){let b=Cq.XZ.GetZoomLevel();b-=.2;Cq.XZ.SetZoomLevel(b)}}setPage(b){if(Cq.XZ){const h=Cq.XZ.GetPageCount();1>b?(Cq.XZ.SetCurrentPage(1),this.d4a.setCurrentPage(1)):1<=b&&b<=h?Cq.XZ.SetCurrentPage(b):(Cq.XZ.SetCurrentPage(h),this.d4a.setCurrentPage(h))}}static getInstance(b){Cq.Z4e||(Cq.Z4e=new Cq(b));return Cq.Z4e}}Cq.XZ=null;Cq.Z4e=null;Object(u.a)(Cq,
"PreviewPanelActor",null,[]);class oo{static get ibk(){return null!=oo.$6g?oo.$6g:oo.$6g=y.AFrameworkApplication.J.jb("ClassicViewModePreferenceCookieName")}static get Og(){return null!=oo.qUg?oo.qUg:oo.qUg=$a.a.instance.Oa(114)}static Wb(b,h){b.fb(ub.a.readingMode,xe.a.frame,oo.Kck,128);b.qa(ub.a.NBe,xe.a.frame,oo.Kck);oo.bL=h;b.qa(Hc.a.Pwe,xe.a.frame,oo.Pwe);b.fb(Hc.a.nse,xe.a.frame,oo.nse,96);b.qa(Hc.a.mbd,xe.a.frame,oo.mbd);b.fb(Hc.a.Ire,xe.a.frame,oo.Ire,96);oo.Og.Eic&&oo.bL.Zcc(oo.ysc)}static Kck(b,
h,r){if(h.contextId!==xe.a.frame)return 2;h=$l.a.Pm;switch(b){case ub.a.readingMode:if(!h.SAb)return 8;if(1===r)return fc.SessionStatusManager.instance.Nk?8:32;b=(new Date).getTime();el.a.instance.Vto(b);h.fvb=b;y.AFrameworkApplication.J.$("InAppDocumentPreviewIsEnabled")?Yu.a.sU(ZB.a.F9f,!0,oo.Dho,null,h):Yu.a.sU(ZB.a.F9f,!0,oo.Dgj,null,h);return 32;case ub.a.NBe:return 32;default:return 2}}static Dgj(b){RK.a()?oo.PRm(b):oo.k_j(b)}static PRm(b){const h={};h[H.a.KTf]=oo.ibk;y.AFrameworkApplication.DN().execute(r=>
{r.Gv(K.a.LTf);r.Yup(K.a.LTf);r.XE(K.a.LTf,A=>{oo.Bpl(A,b)});r.sendMessage(K.a.vwm,h)})}static Bpl(b,h){b.Values[H.a.KTf]===oo.ibk&&("true"===b.Values[H.a.wPi]?oo.k_j(h):(oo.oyp(),oo.vip()))}static oyp(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};y.AFrameworkApplication.nd("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):
appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static vip(){y.AFrameworkApplication.tw=!0;qa.StaticActiveAppFrame.za().Y8(1);qa.StaticActiveAppFrame.za().kb.Fw&&qa.StaticActiveAppFrame.za().kb.Fw.jj&&qa.StaticActiveAppFrame.za().kb.Fw.EVf();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&qa.StaticActiveAppFrame.za().Fe();OO.a.j3j(y.AFrameworkApplication.J)}static k_j(b){try{const h=new fb.a;let r,A;y.AFrameworkApplication.Fbk?
(r=df.a.hostUrl,A=3):(r=b.SAb,A=1);b.fvb&&h.add(y.AFrameworkApplication.G9f,b.fvb.toString());y.AFrameworkApplication.kYf&&h.add(y.AFrameworkApplication.lsf,"1");y.AFrameworkApplication.Fnf&&h.add(y.AFrameworkApplication.vAl,"1");h.add(uN.a.QNg,uN.a.userSessionData);h.add(y.AFrameworkApplication.Vqe,y.AFrameworkApplication.userSessionId);const M=y.AFrameworkApplication.J.jb(y.AFrameworkApplication.ewa);M&&h.add(y.AFrameworkApplication.u5j,M);v.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");
RK.b(y.AFrameworkApplication.J)?RK.d("view",h,RK.c):(r=Fa.a.fff(r,h),y.AFrameworkApplication.Fbk?Te.a.Cn(r,Te.a.owa(A),void 0,"AuthenticationLostDuringSession"):Te.a.openWindow(A,r,!1,void 0,NO.a.IEj))}catch(h){}}static Dho(b){v.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):$a.a.instance.resolve(78).$D.loadScript("previewPanel")).catch(()=>{v.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");
oo.Dgj(b)}).then(()=>{Cq.getInstance(b).Zep()})}static Pwe(b,h,r){if(1===r)return 32;oo.bL.QNj(1===oo.bL.Et?oo.Og.zub?3:0:1);qa.StaticActiveAppFrame.za().Fe();return 32}static nse(b,h,r,A,M){if(1===r)return 32;M[Ng.a.On]=1===oo.bL.Et;return 32}static mbd(b,h,r){if(1===r)return 32;oo.bL.QNj(2);qa.StaticActiveAppFrame.za().Fe();return 32}static ysc(b,h){2===h.AMa&&(b=qa.StaticActiveAppFrame.za(),b.Y8(1),b.Fe())}static Ire(b,h,r,A,M){if(!oo.Og.XJa)return 8;if(1===r)return 32;M[Ng.a.On]=2===oo.bL.Et;
return 32}}oo.bL=null;Object(u.a)(oo,"MainViewModeActor",null,[]);class vN{constructor(b,h,r){this.hLn=(A,M,ba,oa,Ja)=>1===ba?32:(A=this.vl.aba(M.Ok))?(Ja=3===Ja.fz,this.N9.value.V$h(this.lIm(A),this.hRb(A),Ja),32):2;this.ga=b;this.N9=h;this.vl=r}Wb(){this.ga.qa(Hc.a.F3f,mc.a.view,this.hLn);this.ga.fb(Hc.a.Mre,mc.a.view,Lm.d,96);this.ga.fb(Hc.a.Jre,mc.a.view,Lm.d,96);this.ga.fb(Hc.a.Kre,mc.a.view,Lm.d,96);this.ga.fb(Hc.a.Lre,mc.a.view,Lm.d,96);this.ga.qa(Hc.a.fgd,mc.a.view,Lm.c);this.ga.qa(Hc.a.egd,
mc.a.view,Lm.c);this.ga.qa(Hc.a.Goe,mc.a.view,Lm.c);this.ga.qa(Hc.a.Hoe,mc.a.view,Lm.c)}lIm(b){const h=new ji.DictionaryPropertySet;h.setValue(Rc.a.marginTop,this.vl.Jsa(b));h.setValue(Rc.a.marginBottom,this.vl.VAa(b));h.setValue(Rc.a.marginLeft,this.vl.vN(b));h.setValue(Rc.a.marginRight,this.vl.wN(b));return h}hRb(b){const h=new ji.DictionaryPropertySet;h.setValue(Rc.a.Bp,this.vl.Mv(b));h.setValue(Rc.a.vw,this.vl.qD(b));return h}}Object(u.a)(vN,"MarginsDialogActor",null,[]);class wN{constructor(b,
h,r,A,M,ba){this.ga=b;this.Xc=h;this.xj=r;this.OD=A;this.aRg=M;this.Of=ba;this.NZ={Nkk:["To- Do List"],Okk:["DD/MM/YYYY"],Pkk:["Add Subtitle here "],Qkk:["- Add Item here \u2705  ","- Is your item complete? \u274c "],qhk:["DD/MM/YYYY"],rhk:["Journal Entry"],shk:["Add Heading 1 Here"],thk:["- Reflect on your day  ","- What are you doing to take care of yourself?"],Ekk:["\u270f\ufe0f Task List  "],vek:["Brainstorming"],xek:["\ud83d\udc18 Question "],yek:["Add question for the group decision here.",
" "],zek:["\u2728 Background context "],Aek:["Add relevant context for the project or initiative you're making a decision on here."," "],Bek:["\ud83e\uddca Constraints"],Cek:["- Add a list of possible roadblocks and/or concerns here"," "],Dek:["\ud83e\udd14 Assumptions "],Eek:["- Add a list of things that you assume are true/untrue here"," "],wek:["\ud83c\udfd3 Compare ideas"]};this.TCc=new Qp.a;this.TCc.setValue(ze.a.bold,!1);this.TCc.setValue(ze.a.fontSize,76);this.TCc.setValue(ze.a.font,"Amasis MT Pro Regular");
this.TCc.setValue(ze.a.fontColor,0);this.UCc=new Qp.a;this.UCc.setValue(ze.a.bold,!1);this.UCc.setValue(ze.a.fontSize,42);this.UCc.setValue(ze.a.font,"Amasis MT Pro Regular");this.UCc.setValue(ze.a.fontColor,11304704);this.VCc=new Qp.a;this.VCc.setValue(ze.a.bold,!1);this.VCc.setValue(ze.a.fontSize,24);this.VCc.setValue(ze.a.font,"Trade Gothic Next Italic");this.VCc.setValue(ze.a.fontColor,0);this.WCc=new Qp.a;this.WCc.setValue(ze.a.bold,!1);this.WCc.setValue(ze.a.fontSize,24);this.WCc.setValue(ze.a.font,
"Trade Gothic Next");this.WCc.setValue(ze.a.fontColor,0);this.zCc=new Qp.a;this.zCc.setValue(ze.a.bold,!1);this.zCc.setValue(ze.a.fontSize,76);this.zCc.setValue(ze.a.font,"Sitka Banner");this.zCc.setValue(ze.a.fontColor,1338346);this.ACc=new Qp.a;this.ACc.setValue(ze.a.bold,!1);this.ACc.setValue(ze.a.fontSize,42);this.ACc.setValue(ze.a.font,"Sitka Heading");this.ACc.setValue(ze.a.fontColor,0);this.BCc=new Qp.a;this.BCc.setValue(ze.a.bold,!1);this.BCc.setValue(ze.a.fontSize,32);this.BCc.setValue(ze.a.font,
"Sitka Subheading");this.BCc.setValue(ze.a.fontColor,0);this.CCc=new Qp.a;this.CCc.setValue(ze.a.bold,!1);this.CCc.setValue(ze.a.fontSize,24);this.CCc.setValue(ze.a.font,"Sitka Text");this.CCc.setValue(ze.a.fontColor,0);this.XCc=new Qp.a;this.XCc.setValue(ze.a.bold,!1);this.XCc.setValue(ze.a.fontSize,40);this.XCc.setValue(ze.a.font,"Aptos Display");this.XCc.setValue(ze.a.fontColor,6375183);this.kCc=new Qp.a;this.kCc.setValue(ze.a.bold,!1);this.kCc.setValue(ze.a.fontSize,40);this.kCc.setValue(ze.a.font,
"Aptos Display");this.kCc.setValue(ze.a.fontColor,6375183);this.lCc=new Qp.a;this.lCc.setValue(ze.a.bold,!1);this.lCc.setValue(ze.a.fontSize,24);this.lCc.setValue(ze.a.font,"Segoe UI Emoji");this.lCc.setValue(ze.a.fontColor,6375183);this.mCc=new Qp.a;this.mCc.setValue(ze.a.bold,!1);this.mCc.setValue(ze.a.fontSize,24);this.mCc.setValue(ze.a.font,"Segoe UI Emoji");this.mCc.setValue(ze.a.fontColor,0)}Wb(){this.ga.fb(Hc.a.Iej,mc.a.Vc,this.B9k.bind(this),1028);this.ga.fb(Hc.a.E9f,mc.a.Vc,this.JSd.bind(this),
1028);this.ga.fb(Hc.a.C9f,mc.a.Vc,this.JSd.bind(this),1028);this.ga.fb(Hc.a.D9f,mc.a.Vc,this.JSd.bind(this),1028);this.ga.fb(Hc.a.B9f,mc.a.Vc,this.JSd.bind(this),1028)}B9k(){return null===this.Xc.instance?2:32}JSd(b,h,r){if(1===r)return 32;if(2===r){switch(b){case Hc.a.E9f:this.ndn(this.NZ.Nkk,this.NZ.Okk,this.NZ.Pkk,this.NZ.Qkk);break;case Hc.a.C9f:this.Rbn(this.NZ.qhk,this.NZ.rhk,this.NZ.shk,this.NZ.thk);break;case Hc.a.D9f:this.edn(this.NZ.Ekk);break;case Hc.a.B9f:this.$an(this.NZ.vek,this.NZ.xek,
this.NZ.yek,this.NZ.zek,this.NZ.Aek,this.NZ.Bek,this.NZ.Cek,this.NZ.Dek,this.NZ.Eek,this.NZ.wek)}return 32}return 2}Rbn(b,h,r,A){const M=new Qb.GraphTransaction(15);try{const ba=$f.a.instance.gb.currentSelection.Qa;let oa=ba.node,Ja;for(Ja=Be.a.Zo(ba.node);Ja.moveNext();){const nc=Ja.currentNode;if(Ed.ParagraphReader.vab(nc)&&Ed.ParagraphReader.Vb(nc)){oa=nc;break}}M.Ab(oa);const jb=this.Xc.instance.vF(b,oa,!0).toArray();this.khk(jb);const zb=this.Xc.instance.vF(h,oa,!0).toArray();this.lhk(zb);const Eb=
this.Xc.instance.vF(r,oa,!0).toArray();this.mhk(Eb);const Sb=this.Xc.instance.vF(A,oa,!0).toArray();this.nhk(Sb)}finally{M.dispose()}}khk(b){for(const h of b)b=h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.zCc)})}lhk(b){for(const h of b)b=h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.ACc)})}mhk(b){for(const h of b)b=h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.BCc)})}nhk(b){for(const h of b)b=h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.CCc)})}ndn(b,
h,r,A){const M=new Qb.GraphTransaction(15);try{const ba=$f.a.instance.gb.currentSelection.Qa;let oa=ba.node,Ja;for(Ja=Be.a.Zo(ba.node);Ja.moveNext();){const nc=Ja.currentNode;if(Ed.ParagraphReader.vab(nc)&&Ed.ParagraphReader.Vb(nc)){oa=nc;break}}M.Ab(oa);const jb=this.Xc.instance.vF(b,oa,!0).toArray();this.kkk(jb);const zb=this.Xc.instance.vF(h,oa,!0).toArray();this.lkk(zb);const Eb=this.Xc.instance.vF(r,oa,!0).toArray();this.mkk(Eb);const Sb=this.Xc.instance.vF(A,oa,!0).toArray();this.nkk(Sb)}finally{M.dispose()}}kkk(b){for(const h of b)b=
h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.TCc)})}lkk(b){for(const h of b)b=h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.UCc)})}mkk(b){for(const h of b)b=h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.VCc)})}nkk(b){for(const h of b)b=h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.WCc)})}edn(b){const h=new Qb.GraphTransaction(15);try{const r=$f.a.instance.gb.currentSelection.Qa;let A=r.node,M;for(M=Be.a.Zo(r.node);M.moveNext();){const zb=M.currentNode;
if(Ed.ParagraphReader.vab(zb)&&Ed.ParagraphReader.Vb(zb)){A=zb;break}}h.Ab(A);const ba=this.Xc.instance.vF(b,A,!0).toArray();this.tkk(ba);const oa=zc.a.Za(A);oa.vb(23);oa.fd(11);this.Of.gz(oa,!0,!1,null,!1,!1);const Ja=this.aRg.Vza(oa,4,3),jb=zc.a.Za(Ja);bi.moveToCell(jb,0,0);jb.currentNode.properties.setValue(ze.a.YG,16247258);jb.fd(14);bi.moveToCell(jb,0,1);jb.currentNode.properties.setValue(ze.a.YG,16247258);jb.fd(14);bi.moveToCell(jb,0,2);jb.currentNode.properties.setValue(ze.a.YG,16247258);jb.fd(14);
jb.Lo(0,-1);jb.Lo(0,-1);jb.Lo(0,-1);A=jb.Lo(0,-1);this.Xc.instance.vF(["Task"],A,!0).toArray();jb.fd(14);jb.Lo(0,-1);jb.Lo(1,-1);jb.Lo(0,-1);A=jb.Lo(0,-1);this.Xc.instance.vF(["Assigned to"],A,!0).toArray();jb.fd(14);jb.Lo(0,-1);jb.Lo(2,-1);jb.Lo(0,-1);A=jb.Lo(0,-1);this.Xc.instance.vF(["Due Date"],A,!0).toArray()}finally{h.dispose()}}tkk(b){for(const h of b)b=h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.XCc)})}$an(b,h,r,A,M,ba,oa,Ja,jb,zb){const Eb=new Qb.GraphTransaction(15);try{const Sb=
$f.a.instance.gb.currentSelection.Qa;let nc=Sb.node,Dc;for(Dc=Be.a.Zo(Sb.node);Dc.moveNext();){const Tn=Dc.currentNode;if(Ed.ParagraphReader.vab(Tn)&&Ed.ParagraphReader.Vb(Tn)){nc=Tn;break}}Eb.Ab(nc);const Zc=this.Xc.instance.vF(b,nc,!0).toArray();this.rek(Zc);const Gd=this.Xc.instance.vF(h,nc,!0).toArray();this.jCc(Gd);const de=this.Xc.instance.vF(r,nc,!0).toArray();this.gvd(de);const he=this.Xc.instance.vF(A,nc,!0).toArray();this.jCc(he);const fe=this.Xc.instance.vF(M,nc,!0).toArray();this.gvd(fe);
const Yd=this.Xc.instance.vF(ba,nc,!0).toArray();this.jCc(Yd);const Td=this.Xc.instance.vF(oa,nc,!0).toArray();this.gvd(Td);const wf=this.Xc.instance.vF(Ja,nc,!0).toArray();this.jCc(wf);const Lf=this.Xc.instance.vF(jb,nc,!0).toArray();this.gvd(Lf);const ii=this.Xc.instance.vF(zb,nc,!0).toArray();this.jCc(ii);const Bi=zc.a.Za(nc);Bi.vb(23);Bi.fd(11);this.Of.gz(Bi,!0,!1,null,!1,!1);const Ml=this.aRg.Vza(Bi,3,4),hk=zc.a.Za(Ml);hk.fd(14);hk.Lo(0,-1);hk.Lo(0,-1);hk.Lo(0,-1);nc=hk.Lo(0,-1);this.Xc.instance.vF(["Idea"],
nc,!0).toArray();hk.fd(14);hk.Lo(0,-1);hk.Lo(1,-1);hk.Lo(0,-1);nc=hk.Lo(0,-1);this.Xc.instance.vF(["Pros"],nc,!0).toArray();hk.fd(14);hk.Lo(0,-1);hk.Lo(2,-1);hk.Lo(0,-1);nc=hk.Lo(0,-1);this.Xc.instance.vF(["Cons"],nc,!0).toArray();hk.fd(14);hk.Lo(0,-1);hk.Lo(3,-1);hk.Lo(0,-1);nc=hk.Lo(0,-1);this.Xc.instance.vF(["Votes"],nc,!0).toArray()}finally{Eb.dispose()}}rek(b){for(const h of b)b=h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.kCc)})}jCc(b){for(const h of b)b=h.node,this.OD.tea(b,0,
b.rY.length,r=>{this.xj.yha(r,this.lCc)})}gvd(b){for(const h of b)b=h.node,this.OD.tea(b,0,b.rY.length,r=>{this.xj.yha(r,this.mCc)})}}Object(u.a)(wN,"MiniTemplateActor",null,[]);class aM{constructor(b){this.Srd=(h,r,A)=>{if(1===A)return 32;h=y.AFrameworkApplication.ta;if(!h)return 32;h.vTd();aM.nNo(h);return 32};this.ga=b}Wb(){this.ga.qa(Hc.a.Srd,mc.a.view,this.Srd)}static nNo(b){const h=y.AFrameworkApplication.J.jb("ModernUxExperimentPreferenceCookieName");var r=y.AFrameworkApplication.J.$("ModernUxExperimentDefaultOffIsEnabled");
r=Qc.a.tfa(h,!r);Qc.a.hOa(h,(!r).toString(),Qc.a.mMa);r?v.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):v.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");$b.d(Hc.a.Srd,!0,void 0,void 0,void 0,void 0,[Object.assign(new fa.a,{name:"ModernUxExperimentPreference",string:(!r).toString()})]);b.x8(null)}}Object(u.a)(aM,"ModernUxActor",null,[]);var PO=d(876),Tr=d(1793);class xN{constructor(b,h,r,A){this.vAe=Cg.a.uD(1)/6;this.MZo=(M,
ba,oa,Ja,jb)=>{if(1===oa)return 32;if(oa=this.ig.aba(ba.Ok)){if(0<=jb&&jb<Tr.a.e4.length){ba=new Qb.GraphTransaction(15);ba.Ab(oa);ba.Ei=M;M=Tr.a.e4[jb].MGd;Ja=Tr.a.e4[jb].KGd;const zb=Tr.a.e4[jb]._marginLeft;jb=Tr.a.e4[jb].LGd;this.ipe(M,Ja,this.ig.qD(oa))&&this.ipe(zb,jb,this.ig.Mv(oa))?(this.MG.qeb(oa,M),this.MG.oeb(oa,Ja),this.MG.Ena(oa,zb),this.MG.peb(oa,jb),this.Xd.ev(11)):this.aOa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);ba.dispose()}else return 2;return 32}v.ULS.sendTraceTag(520618525,
3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Ok);return 2};this.NZo=(M,ba,oa,Ja,jb)=>{if(1===oa)return 32;if(oa=this.ig.aba(ba.Ok)){if(0<=jb&&jb<Tr.a.Pua.length)ba=new Qb.GraphTransaction(15),ba.Ab(oa),ba.Ei=M,M=(Ja=this.ig.N9c(oa))?Tr.a.Pua[jb].a4a:Tr.a.Pua[jb].b4a,jb=Ja?Tr.a.Pua[jb].b4a:Tr.a.Pua[jb].a4a,this.ipe(this.ig.VAa(oa),this.ig.Jsa(oa),jb)&&this.ipe(this.ig.vN(oa),this.ig.wN(oa),M)?(this.MG.oAg(oa,M),this.MG.nAg(oa,jb),this.Xd.ev(11)):this.aOa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),
ba.dispose();else return 2;return 32}v.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Ok);return 2};this.dZo=(M,ba,oa,Ja,jb)=>{if(1===oa)return 32;if(oa=this.ig.aba(ba.Ok)){ba=this.ig.N9c(oa);Ja=new Qb.GraphTransaction(15);Ja.Ab(oa);Ja.Ei=M;this.MG.WOj(oa,jb);if(jb&&!ba||!jb&&ba){M=this.ig.Mv(oa);jb=this.ig.qD(oa);this.MG.oAg(oa,jb);this.MG.nAg(oa,M);M=this.ig.Jsa(oa);jb=this.ig.VAa(oa);const zb=this.ig.vN(oa),Eb=this.ig.wN(oa);ba?(this.MG.qeb(oa,y.AFrameworkApplication.isRtl?
zb:Eb),this.MG.oeb(oa,y.AFrameworkApplication.isRtl?Eb:zb),this.MG.Ena(oa,y.AFrameworkApplication.isRtl?jb:M),this.MG.peb(oa,y.AFrameworkApplication.isRtl?M:jb)):(this.MG.qeb(oa,y.AFrameworkApplication.isRtl?Eb:zb),this.MG.oeb(oa,y.AFrameworkApplication.isRtl?zb:Eb),this.MG.Ena(oa,y.AFrameworkApplication.isRtl?Math.abs(M):jb),this.MG.peb(oa,y.AFrameworkApplication.isRtl?jb:M));this.Xd.ev(11)}Ja.dispose();return 32}v.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ba.Ok);return 2};this.mde=(M,ba,oa)=>{if(1===oa)return 1===this.AG.Et?32:8};this.lyb=(M,ba,oa,Ja,jb)=>{if(1===oa)return 32;oa=this.ig.aba(ba.Ok);if(!oa)return v.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Ok),2;ba=new Qb.GraphTransaction(15);ba.Ab(oa);ba.Ei=M;M=Math.floor(this.ig.Mv(oa)/720);if(0>jb||jb>M)return 2;this.MG.O_b(oa,jb);this.cCd.execute(zb=>{zb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.gxe=(M,ba,oa,Ja,jb)=>
{if(1===oa)return 32;oa=this.ig.aba(ba.Ok);if(!oa)return v.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Ok),2;ba=new Qb.GraphTransaction(15);ba.Ab(oa);ba.Ei=M;M=jb[0];Ja=this.ig.Mv(oa);if(720>M||M>Ja)return 2;this.MG.jxc(oa,jb);this.cCd.execute(zb=>{zb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.fxe=(M,ba,oa,Ja,jb)=>{if(1===oa)return 32;oa=this.ig.aba(ba.Ok);if(!oa)return v.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ba.Ok),2;ba=new Qb.GraphTransaction(15);ba.Ab(oa);ba.Ei=M;M=this.ig.Mv(oa);Ja=this.ig.Dh(oa);if(0>jb||jb>(M-720*Ja)/(Ja-1))return 2;this.MG.AUo(oa,jb);this.cCd.execute(zb=>{zb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.exe=(M,ba,oa,Ja,jb)=>{if(1===oa)return 32;oa=this.ig.aba(ba.Ok);if(!oa)return v.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Ok),2;ba=new Qb.GraphTransaction(15);ba.Ab(oa);ba.Ei=M;if(null==jb)return 2;this.MG.c0o(oa,
jb);this.cCd.execute(zb=>{zb.logActivity("WordWebColumnsActivity",null)});ba.dispose();return 32};this.oNa=(M,ba,oa,Ja,jb)=>{let zb;try{zb=this.ig.aba(ba.Ok)}catch(Eb){return v.ULS.sendTraceTag(508339925,3009,50,"context.nextContext = {0}",ba.Ok),2}if(zb)return jb.marginTop=this.ig.Jsa(zb),jb.marginBottom=this.ig.VAa(zb),jb.marginLeft=this.ig.vN(zb),jb.marginRight=this.ig.wN(zb),jb.Bp=this.ig.Mv(zb),jb.vw=this.ig.qD(zb),jb.$Ba=this.ig.N9c(zb),jb.ZG=this.ig.Dh(zb),jb.rra=this.ig.Lqb(zb),jb.rwl=this.ig.X8d(zb),
jb.FVb=this.GAm(jb),jb.yXb=this.gFm(jb),jb.kWc=this.knm(jb),32;v.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Ok);return 2};this.Uxe=(M,ba,oa,Ja,jb)=>{if(1===oa)return 32;if(oa=this.ig.aba(ba.Ok)){ba=new Qb.GraphTransaction(15);ba.Ab(oa);switch(M){case ub.a.qeb:this.MG.qeb(oa,jb);break;case ub.a.oeb:this.MG.oeb(oa,jb);break;case ub.a.Ena:this.MG.Ena(oa,jb);break;case ub.a.peb:this.MG.peb(oa,jb)}this.Xd.ev(11);ba.dispose();return 32}v.ULS.sendTraceTag(520618518,
3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Ok);return 2};this.DPj=(M,ba,oa,Ja,jb)=>{if(1===oa)return 32;if(oa=this.ig.aba(ba.Ok)){ba=new Qb.GraphTransaction(15);ba.Ab(oa);let zb=Ja=0;switch(M){case ub.a.qAg:zb=jb;this.MG.oAg(oa,zb);Ja=this.ig.qD(oa);break;case ub.a.pAg:Ja=jb,this.MG.nAg(oa,Ja),zb=this.ig.Mv(oa)}this.MG.WOj(oa,Ja<zb);this.Xd.ev(11);ba.dispose();return 32}v.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",ba.Ok);return 2};
this.MG=b;this.Xd=h;this.AG=r;this.cCd=A}get ig(){return sr.a.instance}HAm(b){var h=df.a.w_f,r=h?1:3,A=y.AFrameworkApplication.numberFormat;let M=Tr.a.e4[b].MGd;var ba=Tr.a.e4[b].KGd;var oa=Tr.a.e4[b]._marginLeft;b=Tr.a.e4[b].LGd;M=h?Cg.a.G0a(M):Cg.a.pB(M);ba=h?Cg.a.G0a(ba):Cg.a.pB(ba);oa=h?Cg.a.G0a(oa):Cg.a.pB(oa);b=h?Cg.a.G0a(b):Cg.a.pB(b);h=C.a.lKa(M,r,A);ba=C.a.lKa(ba,r,A);oa=C.a.lKa(oa,r,A);r=C.a.lKa(b,r,A);A={};A.top=h;A.bottom=ba;A.left=oa;A.right=r;return A}fLn(b){const h=WordRibbonStrings.PageMarginsTop,
r=WordRibbonStrings.PageMarginsBottom,A=WordRibbonStrings.PageMarginsLeft,M=WordRibbonStrings.PageMarginsRight;b=this.HAm(b);return[[h,b.top,r,b.bottom],[A,b.left,M,b.right]]}Cgd(b){var h=df.a.w_f,r=h?1:3;const A=y.AFrameworkApplication.numberFormat;let M=Tr.a.Pua[b].a4a;b=Tr.a.Pua[b].b4a;M=h?Cg.a.G0a(M):Cg.a.pB(M);b=h?Cg.a.G0a(b):Cg.a.pB(b);h=C.a.lKa(b,r,A);r=C.a.lKa(M,r,A);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,r)}Wb(){const b=y.AFrameworkApplication.va;b.fb(ub.a.reb,
mc.a.view,this.MZo,4);b.fb(ub.a.F_a,mc.a.view,this.NZo,4);b.fb(ub.a.setOrientation,mc.a.view,this.dZo,4);b.fb(ub.a.oNa,mc.a.view,this.oNa,96);b.qa(ub.a.qeb,mc.a.view,this.Uxe);b.qa(ub.a.oeb,mc.a.view,this.Uxe);b.qa(ub.a.Ena,mc.a.view,this.Uxe);b.qa(ub.a.peb,mc.a.view,this.Uxe);b.qa(ub.a.qAg,mc.a.view,this.DPj);b.qa(ub.a.pAg,mc.a.view,this.DPj);b.fb(ub.a.mde,mc.a.view,this.mde,4);b.qa(ub.a.lyb,mc.a.view,this.lyb);b.qa(ub.a.gxe,mc.a.view,this.gxe);b.qa(ub.a.fxe,mc.a.view,this.fxe);b.qa(ub.a.exe,mc.a.view,
this.exe)}ipe(b,h,r){return r>=b+h+df.a.fFa}GAm(b){let h=5;for(let r=0;r<Tr.a.e4.length;r++)if(Tr.a.e4[r].MGd===b.marginTop&&Tr.a.e4[r].KGd===b.marginBottom&&Tr.a.e4[r]._marginLeft===b.marginLeft&&Tr.a.e4[r].LGd===b.marginRight){h=r;break}return h}gFm(b){let h=5;b=new PO.a(Math.min(b.Bp,b.vw),Math.max(b.Bp,b.vw));for(let r=0;r<Tr.a.Pua.length;r++)if(this.x$n(b,Tr.a.Pua[r])){h=r;break}return h}knm(b){let h=0;switch(b.ZG){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}x$n(b,h){return Lg.a.JVi(b.b4a,
Math.max(h.b4a-this.vAe,0),h.b4a+this.vAe)&&Lg.a.JVi(b.a4a,Math.max(h.a4a-this.vAe,0),h.a4a+this.vAe)}aOa(b){if(!nf.a.gP){const h=new kh.StandardDialog;h.Ed=0;h.AY(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(u.a)(xN,"PageActor",null,[559]);class bM{constructor(b){this.ga=b}get Qb(){return this.ga}Txe(b,h){let r=0;b?1===b?r=ub.a.Ena:2===b?r=ub.a.peb:3===b&&(r=ub.a.oeb):r=ub.a.qeb;this.Qb.Pb(r,2,h)}F_a(b,h){let r=0;1===b?r=ub.a.pAg:b||(r=ub.a.qAg);this.Qb.Pb(r,2,h)}dxe(b,h){let r=0;switch(b){case 0:r=
ub.a.lyb;break;case 1:r=ub.a.gxe;break;case 2:r=ub.a.fxe;break;case 3:r=ub.a.exe}this.Qb.Pb(r,2,h)}}Object(u.a)(bM,"PageCommands",null,[558]);class yN{constructor(b,h,r){this.w$n=(A,M,ba,oa,Ja)=>1===ba?32:(A=this.vl.aba(M.Ok))?(Ja=3===Ja.fz,this.N9.value.wai(this.mIm(A),this.hRb(A),Ja),32):2;this.ga=b;this.N9=h;this.vl=r}Wb(){this.ga.qa(Hc.a.H3f,mc.a.view,this.w$n);this.ga.fb(Hc.a.bse,mc.a.view,Lm.d,96);this.ga.fb(Hc.a.ase,mc.a.view,Lm.d,96);this.ga.qa(Hc.a.Koe,mc.a.view,Lm.c);this.ga.qa(Hc.a.Joe,
mc.a.view,Lm.c)}mIm(b){const h=new ji.DictionaryPropertySet;h.setValue(Rc.a.Bp,this.vl.Mv(b));h.setValue(Rc.a.vw,this.vl.qD(b));return h}hRb(b){const h=new ji.DictionaryPropertySet;h.setValue(Rc.a.marginTop,Math.abs(this.vl.Jsa(b)));h.setValue(Rc.a.marginBottom,Math.abs(this.vl.VAa(b)));h.setValue(Rc.a.marginLeft,this.vl.vN(b));h.setValue(Rc.a.marginRight,this.vl.wN(b));return h}}Object(u.a)(yN,"PaperSizeDialogActor",null,[]);class SK{constructor(b,h,r){this.ga=b;this.N9=h;this.qZ=r}Wb(){this.ga.fb(ub.a.xqc,
mc.a.view,this.kao.bind(this),1028);this.ga.qa(ub.a.xqc,mc.a.paragraph,this.iao.bind(this));this.ga.fb(ub.a.sno,mc.a.view,Lm.d,96);this.ga.fb(ub.a.tno,mc.a.view,Lm.d,96);this.ga.fb(ub.a.zmo,mc.a.view,Lm.d,96);this.ga.fb(ub.a.Amo,mc.a.view,Lm.d,96);this.ga.fb(ub.a.udp,mc.a.view,Lm.c,96);this.ga.fb(ub.a.tdp,mc.a.view,Lm.c,96);this.ga.fb(ub.a.m8n,mc.a.view,Lm.c,96);this.ga.fb(ub.a.n8n,mc.a.view,Lm.c,96);this.ga.fb(ub.a.$7n,mc.a.view,Lm.c,96);this.ga.fb(ub.a.rdp,mc.a.view,Lm.c,96);this.ga.fb(ub.a.a8n,
mc.a.view,Lm.c,96)}iao(b,h,r,A,M){if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.t4j(h);M=3===M.fz;this.N9.value.NYd(this.A4c(b),this.hRb(h),M);return 32}kao(b,h,r,A,M){b=h.view.lb;if(!b||SK.sg.Wnc(b.Ng))return 8;if(Object(zl.a)().bFa(Ed.ParagraphReader.IX,b.Ng))return SK.Bc.$b(Uf.a.Oe,{["Reason"]:Ff.a.cR}),8;if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;r=b.gb.currentSelection;h=this.t4j(h);M=3===M.fz;if(1===r.length&&Le.a.qf(r.K(0)))return r=r.K(0).node,this.N9.value.NYd(this.A4c(r),
this.hRb(h),M),32;b=[];for(A=0;A<r.length;A++){const ba=r.K(A);(!A&&Le.a.rl(ba)||Ed.ParagraphReader.kn(ba)||Le.a.gm(ba))&&b.push(ba.node)}if(!b.length)return 8;r=Array(b.length);for(A=0;A<b.length;A++)r[A]=this.A4c(b[A]);r=wC.APropertySet.FAi(r);this.N9.value.NYd(r,this.hRb(h),M);return 32}A4c(b){const h=new ji.DictionaryPropertySet;h.setValue(Bd.a.Ix,Ed.ParagraphReader.Zy(b));const r=this.qZ.fWa(b);var A=r.lineSpacing;h.setValue(Bd.a.sbb,A.unit);h.setValue(Bd.a.xa,A.value);A=r.beforeSpacing;h.setValue(Bd.a.Ltc,
A.unit);h.setValue(Bd.a.Mtc,A.value);A=r.afterSpacing;h.setValue(Bd.a.Jtc,A.unit);h.setValue(Bd.a.Ktc,A.value);h.setValue(Bd.a.Jgd,r.ny);h.setValue(le.a.keepWithNext,Ed.ParagraphReader.keepWithNext(b));h.setValue(le.a.widowControl,Ed.ParagraphReader.y3b(b));h.setValue(le.a.keepTogether,Ed.ParagraphReader.keepTogether(b));return h}static get sg(){return ve.a.instance}static get Bc(){return Wg.a.instance}}Object(u.a)(SK,"AParagraphDialogActor",null,[]);class QO extends SK{constructor(b,h,r,A,M){super(b,
h,r);this.vl=A;this.Xp=M}Wb(){super.Wb();this.ga.fb(ub.a.Dxj,mc.a.view,Lm.d,96);this.ga.fb(ub.a.Exj,mc.a.view,Lm.d,96);this.ga.fb(ub.a.Fmo,mc.a.view,Lm.d,96);this.ga.fb(ub.a.W6m,mc.a.view,Lm.c,96);this.ga.fb(ub.a.Y6m,mc.a.view,Lm.c,96);this.ga.fb(ub.a.pdp,mc.a.view,Lm.c,96);this.ga.fb(ub.a.qdp,mc.a.view,Lm.c,96);this.ga.fb(ub.a.i8n,mc.a.view,Lm.c,96);this.ga.fb(ub.a.p8n,mc.a.view,Lm.c,96);this.ga.fb(ub.a.o8n,mc.a.view,Lm.c,96);this.ga.fb(ub.a.vdp,mc.a.view,Lm.c,96);this.ga.fb(ub.a.uno,mc.a.view,Lm.d,
96);this.ga.fb(ub.a.vno,mc.a.view,Lm.d,96)}t4j(b){return this.vl.aba(b.Ok)}A4c(b){const h=super.A4c(b);var r=this.Xp.qX(b);const A=this.Xp.xI(b);h.setValue(Bd.a.aNa,1);h.setValue(Bd.a.bNa,r.Uu-A.Uu);r=this.Xp.Y9a(b);h.setValue(Bd.a.wwb,r.unit);h.setValue(Bd.a.xwb,r.value);b=this.Xp.nlc(b);b.specialIndentType&&(h.setValue(Bd.a.T8,b.specialIndentType),h.setValue(Bd.a.$_a,b.unit),h.setValue(Bd.a.a0a,b.value));return h}hRb(b){const h=new ji.DictionaryPropertySet;h.setValue(Rc.a.Bp,this.vl.Mv(b));h.setValue(Rc.a.vw,
this.vl.qD(b));h.setValue(Rc.a.marginTop,Math.abs(this.vl.Jsa(b)));h.setValue(Rc.a.marginBottom,Math.abs(this.vl.VAa(b)));h.setValue(Rc.a.marginLeft,this.vl.vN(b));h.setValue(Rc.a.marginRight,this.vl.wN(b));return h}}Object(u.a)(QO,"ParagraphDialogActor",SK,[]);class zN extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.TZi=h}}Object(u.a)(zN,"AfterPasteEventArgs",Sys.EventArgs,[]);class dC{constructor(b){this.JWe=null;this.YAd=b}get N3d(){return null!=this.bXg?this.bXg:this.bXg=$a.a.instance.resolve(1025)}get Ade(){this.JWe||
(this.JWe=!!y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$(Fk.a.dfi));return this.JWe}Vjo(b){if(b&&Ua.a.Qh(b.FAa)&&Ua.a.Qh(b.rub)){this.qko(b);var h=new sn.a;for(h.kd(b.FAa);h&&h.currentNode;){const r=this.j8d(h),A=Ed.ParagraphReader.Vb(r);A&&Ed.ParagraphReader.Xnb(r)&&this.Tjo(r);const M=h.currentNode.id===b.rub.currentNode.id;A&&this.Ade&&r.qk.nla(r.type).Mse(new zN(r,M));if(M)break;Ab.OutlineElementNavigator.at(h,!1,!1)}}}Tjo(b){v.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");
const h=b.Ytc;b=vc.a.Tc(b,0);fr.r9c(h)?this.N3d.Rpe(b,h):this.YAd.Rpe(b,h)}qko(b){if(b.FAa.currentNode&&b.rub.currentNode&&b.FAa.currentNode.id===b.rub.currentNode.id){const h=this.j8d(b.FAa);Ed.ParagraphReader.Vb(h)?this.Xjo(h,b.gco,b.fco):v.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}Xjo(b,h,r){v.ULS.shipAssertTag(590956771,307,0<=h);v.ULS.shipAssertTag(590958592,307,0<=r);var A=Ed.ParagraphReader.text(b);if(""!==A){var M=vc.a.createTextRange(b,
h,r);M=Oc.a.VA(M,!1);if(1===M.length){const ba=M[0];M=A.substring(h,r).trim();A=A.substring(ba.cpBegin,ba.cpEnd).trim();h=M===A;M=vc.a.createTextRange(b,ba.cpBegin,ba.cpEnd);if(ba.hyperlink&&h&&!Oc.a.PXa(A))b=ba.hyperlink.url;else if(h)b=A;else{v.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}fr.r9c(b)?this.N3d.SWa(M,b,!1):this.YAd.SWa(M,b,!1)}else v.ULS.sendTraceTag(590958597,
307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",M.length)}}j8d(b){const h=Ab.OutlineElementNavigator.Me(b);Ab.OutlineElementNavigator.ke(b);return h}}Object(u.a)(dC,"PastedContentsProcessorPostMergeAfterPaste",null,[557]);class AI extends Dz{constructor(b,h,r,A,M,ba,oa,Ja){super(A);this.J7e=7;this.wx=this.tHc=null;this.oVe=0;this.lVe=b;this.Al=h;this.qo=r;this.Zd=M;this.jnk=oa;this.w4a=
Ja;this.b6=this.Zd.rYa("UserAction","WordIgnoreAll")}zBg(b){this.lVe.yaj();this.tHc=this.qo.Bsa(b);this.w4a.dQi(this.tHc,null,!1);return this.lVe.V4j(this.tHc)?(this.b6.start(),this.wx=new Qb.GraphTransaction(15),this.wx.Ab(b.node),!0):!1}are(b){this.qYb(b.node);return!0}eid(b){this.qYb(b);return!0}bre(b){this.qYb(b.node)}SHg(b){this.wx.dispose();this.tHc.errorDetails.iAb(b.actionId);this.b6.stop();v.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",
this.oVe,this.b6.Hi,this.tHc.errorDetails.proofingType));return!0}Cyc(b,h){if(super.Cyc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}oFi(b){if(b&&b.type!==this.J7e){const h=zc.a.Za(b);return h.vb(this.J7e)?h.fd(this.J7e):b}return b}Ymn(b,h){return this.lVe.gpd(h.errorDetails)&&!this.Al.qba(vc.a.createTextRange(b,h.Dc,h.end))}qYb(b){if(b){var h=this.qo.p7(b,r=>this.Ymn(b,r));this.jnk?this.qo.oxb(b,h,!0):0<h.length&&(b.fm(4,!0),this.qo.tWb(b));this.oVe+=h.length}}}Object(u.a)(AI,
"IgnoreAllCallbackSteps",Dz,[]);class TK{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){this.Xid=(Dc,Zc,Gd,de,he)=>{if(1===Gd)return 32;Dc=this.YK.FKa(Zc.view.lb.Ng);if(Dc=Ag.a.Hg(Dc))he[al.a.LabelText]=Dc.displayName;return 32};this.Xsa=(Dc,Zc,Gd,de,he,fe)=>{const Yd=new AI(this.Pzk,this.Al,this.qo,this.Pe,this.Zd,this.EZ,0,this.w4a);return new bB(Dc,Zc,Gd,de,he,fe,Yd,this.ga,this.ib,this.Pe,"IgnoreAllOperation")};this.PNb=(Dc,Zc,Gd,de,he,fe)=>{const Yd=new AI(this.Cuk,this.Al,this.qo,this.Pe,this.Zd,
this.EZ,1,this.w4a);return new bB(Dc,Zc,Gd,de,he,fe,Yd,this.ga,this.ib,this.Pe,"DoNotCheckThisCritiqueType")};this.ga=b;this.Al=h;this.ib=r;this.Pe=A;this.qo=M;this.YK=ba;this.Zd=oa;this.Pzk=Ja;this.Cuk=jb;this.w8b=zb.C$c;this.EZ=zb;this.w4a=Eb;this.tXe=Sb;this.Ygb=nc}Wb(){this.tXe&&(Su.xD()?this.ga.fb(ub.a.Xsa,mc.a.Vc,this.i5m.bind(this),1028):this.ga.HW(ub.a.Xsa,mc.a.view,this.Xsa,1028));this.w8b&&this.ga.HW(ub.a.PNb,mc.a.view,this.PNb,1028);this.ga.fb(Hc.a.Xid,mc.a.view,this.Xid,96)}i5m(b,h,r,
A,M){if(1===r)return 32;v.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.Ygb.ORf(M?M:h,null,tq.b.IgnoreAll);return 32}}Object(u.a)(TK,"ProofingActor",null,[]);var uy=d(1713);class eC{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){this.Do=this.RSa=this.xNd=this.yNd=null;this.pG=this.Zu=this.vs=0;this.Gib=this.Fib=!1;this.gea=this.Q5b=this.P5b=this.O5b=this.R5b=0;this.xMd=null;this.tia=this.GZ=this.zr=this.lT=0;this.Km=null;this.a3a=0;this.bhg=Eb=>{var Sb;if(Xc.a.uq){var nc=Object.assign(new bb.a,
{extendedProperties:new Map});nc.extendedProperties.set("status",Eb.data.status.toString());nc.extendedProperties.set("httpStatus",Eb.data.He.toString());this.C$i("GraphicSwordRequestFailed",this.a3a,nc)}else 5===this.a3a&&(nc=Object.assign(new bb.a,{extendedProperties:new Map}),nc.extendedProperties.set("status",Eb.data.status.toString()),nc.extendedProperties.set("httpStatus",Eb.data.He.toString()),(null===(Sb=y.AFrameworkApplication.J)||void 0===Sb?0:Sb.$("ShouldLogPicturesExtendedHealthKpis"))?
(Sb={name:Zi.c.$ae,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:nc},nc.extendedProperties.set("ErrorLevel","warning"),this.Yd.logKpiFailure({kpiName:Zi.c.Hmc,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:nc},optionalVeto:Sb})):za.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,nc));v.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",
{["Status"]:Eb.data.status,["HttpStatus"]:Eb.data.He,["Id"]:Eb.data.id,["ResponseData"]:Eb.data.Ee},Nv.a[this.a3a]);this.vve()};this.Ik=r;this.wSa=zb;this._image=b;this._context=h;this.qFd=!1;(b=Object(fn.a)().Nu(h.node))&&b.wf(Rc.a.p1f)&&(this.qFd=!0);this.nJc=A.$("ImageDataURLPresentationIsEnabled");this.VJk=A.$("WordOartPostRequestIsEnabled");this.Ga=A;this.ns=M;this.Zd=ba;this.Xd=oa;this.In=Ja;this.IM=jb;this.Yd=Ik.a.getInstance(Zi.a);this.Q9m();this.Gne=this.btc.bind(this)}Q9m(){this.Do="";this.vs=
je.a.cC(this._image);this.Zu=je.a.nD(this._image);this.gea=je.a.nrb(this._image);this.pG=je.a.Z2(this._image);var b=je.a.Gsa(this._image);this.Fib=b.$pb;this.Gib=b.dKa;b=je.a.yfa(this._image);this.R5b=Math.max(b.top,0);this.O5b=Math.max(b.bottom,0);this.P5b=Math.max(b.left,0);this.Q5b=Math.max(b.right,0);this.Km=hb.a.nil;this.RSa=null;this.a3a=je.a.Ak(this._image)}bUd(b,h){return(new uy.a(this.ns,this.a3a,this.Ga,this.vs,this.Zu,this.pG,this.gea,this.R5b,this.O5b,this.P5b,this.Q5b,this.Fib,this.Gib,
this.qFd)).build(this._context.node,this._image,b,h)}resize(b,h){this.Do="Resize";this.UAe();db.a.mark(this.Xkc());this.vs=b;this.Zu=h;this.sendMessage(!1,this.Gne)}Sx(b){this.Do="Styles";this.UAe();db.a.mark(this.Xkc());this.gea=b;this.sendMessage(!1,this.Gne)}EZo(b,h,r){this.Do="Rotation";this.UAe();this.pG=b;this.Fib=h;this.Gib=r;this.sendMessage(!1,this.Gne)}DZo(b,h){this.Do="SwordRequestManager";this.UAe();this.RSa=b;this.pG=h.angle;this.vs=h.width;this.Zu=h.height;this.gea=h.styleId;this.R5b=
h.top;this.O5b=h.bottom;this.P5b=h.left;this.Q5b=h.right;this.Km=h.s_;this.sendMessage(!1,this.Gne)}sendMessage(b,h){this.wSa.mY([this.wSa.bLf(this.Do)]);if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var r=this.qob(r);const A=je.a.Msa(this._image,this.Ga,this.ns);A?Xc.a.Cyb(this._image,A,4):this._image.setValue(Fe.a.zVa,!0);r.dispose()}this.sYj(b);db.a.mark(this.Xkc());b=new gb.QueryStringBuilder(this.bUd(b,!0));this.nJc&&b.Ae(ui.a.Lci,"true");this.VJk?(r=new gb.QueryStringBuilder("WordOart.ashx"),
y.AFrameworkApplication.Ge.Xj(r.toString(),2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.bhg,null)):y.AFrameworkApplication.Ge.Xj(b.toString(),1,"",null,!0,0,h,this.bhg,null)}qob(b){b=this.Km&&this.Km!==hb.a.nil?new Qb.GraphTransaction(7,ub.a.gba):new Qb.GraphTransaction(15);b.Ab(this._context.node);return b}get Ggk(){const b=new Qb.GraphTransaction(3);b.Ab(this._context.node);return b}vve(){this.g1d();this.f1d();const b=this.Ggk;var h=je.a.pKa(this._image,
this._context.node.Ic,this.Ga,this.ns);this._image.setValue(Fe.a.zVa,!1);this._image.setValue(Bd.a.d7c,h);this._image.setValue(Bd.a.CX,-1);this._image.setValue(Fe.a.YP,1);h=je.a.Msa(this._image,this.Ga,this.ns);this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(Bd.a.kqe),this._image.removeProperty(Bd.a.jqe),h&&Xc.a.Cyb(this._image,h,3));b.dispose();eC.vq();this.RSa&&this.RSa()}sYj(b){this.Zd&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.yNd=
this.Zd.Xf("WebServiceCall",b))}g1d(){this.yNd&&(this.yNd.stop(),this.yNd=null)}UAe(){if(this.Zd){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.Do,Nv.a[this.a3a]);this.xNd=this.Zd.Xf("WebServiceCall",b)}}f1d(){this.xNd&&(this.xNd.stop(),this.xNd=null)}O4(){if(Xc.a.xV){var b=this.wSa.records;for(const [h,r]of Object.entries(b))b={additionalValues:Object.assign(new bb.a,{durationMs:r}),hasImpliedUsage:!0},this.Yd.logKpiSuccess({kpiName:Sc.d.$tc+wk.a[h]+Nv.a[this.a3a].toString(),
optionalProperties:b}),this.wSa.Dvc(Number(h))}}E$i(b){this.Yd.logKpiSuccess({kpiName:Sc.d.y5c+this.Do+Nv.a[b].toString()})}D$i(b,h){b=Object.assign(new bb.a,{extendedProperties:new Map([["Exception",b.message]])});this.C$i("GraphicResponseInvalid",h,b)}C$i(b,h,r){r.extendedProperties.set("ErrorLevel","warning");this.Yd.logKpiFailure({kpiName:Sc.d.y5c+this.Do+Nv.a[h].toString(),errorName:b+Object(rh.b)(this.Zu,this.vs),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:r},optionalVeto:Object(rh.c)(Sc.d.AQf,
r,null,!1)})}static vq(){const b=new kh.StandardDialog;b.Ed=0;b.Iy(se.a.Edo,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);qa.StaticActiveAppFrame.za()&&qa.StaticActiveAppFrame.za().Fe()}}Object(u.a)(eC,"RenderedImageEditOperation",null,[579]);var cM=d(207),BI=d(519);class RO extends eC{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){super(b,h,r,A,M,ba,oa,Ja,jb,zb);if(Xc.a.uq||Xc.a.xV)this.Yd=Ik.a.getInstance(Sc.a)}sendMessage(b,h){Object(cM.a)(()=>{let r;r=this.qob(r);
this._image.setValue(Fe.a.YP,0);r.dispose()});this.sYj(b);db.a.mark(this.Xkc());this.wSa.mY([13]);b=new gb.QueryStringBuilder("WordOart.ashx");this.omh=this.getUrl(!0,!1);b=new BI.a(b.toString(),2,this.getUrl(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");y.AFrameworkApplication.Ge.send(b).DDa(h,r=>{this.bhg(r)})}btc(b){try{const h=JSON.parse(b.data.INa);this.Kyk=h[ui.a.x5c];
this.yTk=h[ui.a.width];this.dzk=h[ui.a.height];this.$8g=h[ui.a.iTc];this.fHc=Array(4);this.fHc[An.a.left]=h[ui.a.hpb];this.fHc[An.a.right]=h[ui.a.ipb];this.fHc[An.a.top]=h[ui.a.jpb];this.fHc[An.a.bottom]=h[ui.a.gpb];this.Zqh=void 0!==h[ui.a.qCa]?"true"===h[ui.a.qCa].toLowerCase():null;Object(cM.a)(()=>{this.ntd();this._context.node.Lj().xg.jD(()=>{this.qam()},null,null)})}catch(h){Xc.a.uq&&(b=Object.assign(new bb.a,{extendedProperties:new Map([["Exception",h.message],["Operation",this.Do]])}),b.extendedProperties.set("ErrorLevel",
"warning"),this.Yd.logKpiFailure({kpiName:Sc.d.m$d+Sc.b.WJa+Nv.a[je.a.Ak(this._image)].toString(),errorName:"DrawingResponseInvalid"+Object(rh.b)(this.Zu,this.vs),optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:Object(rh.c)(Sc.d.KLi,b,null,!1)})),v.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",h.message,this.Do,je.a.Ak(this._image)),this.vve()}}Tme(){v.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}ntd(){let b;
b=this.qob(b);this._image.setValue(le.a.EN,this.Kyk);this.$8g&&this._image.setValue(le.a.mSd,this.$8g);this._image.setValue(le.a.nBa,this.yTk);this._image.setValue(le.a.oBa,this.dzk);this._image.setValue(le.a.rWa,this.fHc);this.Vzk&&this._image.setValue(Bd.a.dSb,this.Vzk);Xc.a.Cyb(this._image,this.omh,3);this._image.setValue(Rc.a.fpb,this.omh);this.Zqh?this._image.setValue(le.a.jab,this.Zqh):this._image.removeProperty(le.a.jab);this.gsl();b.dispose()}gsl(){this._image.removeProperty(Bd.a.Hu);this._image.removeProperty(Bd.a.CX);
this._image.removeProperty(Bd.a.kqe);this._image.removeProperty(Bd.a.jqe)}qam(){this.IM.$Na(this._context);if(this.Km&&this.Km!==hb.a.nil){const b=this._context.node.Lj(),h=new P.a(this.Km,1);this.In.rfc(b,h)}this.Xd.ev(13);Xc.a.uq&&this.Yd.logKpiSuccess({kpiName:Sc.d.m$d+Sc.b.WJa+Nv.a[je.a.Ak(this._image)].toString()});this.g1d();this.f1d();db.a.mark(this.t4c());this.wSa.lM([13]);this.O4();Object(cM.a)(()=>{let b;b=this.qob(b);this._image.setValue(Fe.a.YP,1);b.dispose()});this.RSa&&this.RSa()}getUrl(b,
h){b=new gb.QueryStringBuilder(this.bUd(b,h));b.Ae(ui.a.fbe,"true");return b.toString()}Xkc(){return 51511}t4c(){return 51512}}Object(u.a)(RO,"RenderedGraphicEditOperation",eC,[]);var AN=d(575);class SO extends eC{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){super(b,h,r,A,M,ba,oa,Ja,jb,Eb);this.hhh=null;this.Tme=Sb=>{const nc=this.bUd(!0,!1);let Dc;Dc=this.qob(Dc);this._image.setValue(Rc.a.jTc,this.xMd);var Zc=$a.a.instance.Oa(23);Xc.a.uq&&this.E$i(this.JHb);Zc&&Zc.isFeatureEnabled(42)&&this._image.setValue(Rc.a.k2d,
this.hhh);this.Ga.$("WordEditorImageRotateIsEnabled")&&this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Ik.Gxe(this._image,this.pG,this.Fib,this.Gib);const Gd=je.a.Msa(this._image,this.Ga,this.ns),de=()=>{Gd&&Xc.a.Cyb(this._image,Gd,3);Xc.a.Cyb(this._image,nc,3);this.Ik.Exe(this._image,Cg.a.tI(this.lT),Cg.a.tI(this.GZ),Cg.a.tI(this.zr),Cg.a.tI(this.tia));this._image.setValue(Rc.a.fpb,nc);je.a.aA(this._image)||this._image.setValue(Rc.a.eLa,pr.a.Cdb);this.Ik.mxe(this._image,this.vs,
this.Zu);this.Ga.$("WordEditorImageRotateIsEnabled")&&!this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Ik.Gxe(this._image,this.pG,this.Fib,this.Gib);2===Sb.data.status&&je.a.u3(Sb.data.Ee)&&(this._image.setValue(Bd.a.Hu,Sb.data.Ee),Sb.data.request&&this._image.setValue(Bd.a.dSb,Object(AN.a)("POST"===Sb.data.request.get_httpVerb()?Sb.data.request.get_body():Sb.data.request.get_url())));this.RSa&&this.RSa();this.IM.$Na(this._context);if(this.Km&&this.Km!==hb.a.nil){const he=this._context.node.Lj(),
fe=new P.a(this.Km,1);this.In.rfc(he,fe)}this.Xd.ev(13);this.g1d();this.f1d();db.a.mark(this.t4c());this.wSa.lM([this.wSa.bLf(this.Do)]);this.O4()};if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Km&&this.Km!==hb.a.nil&&(Zc=this._context.node.Lj())&&Zc.xg){Dc.dispose();Zc.xg.jD(()=>{let he;he=this.qob(he);de();he.dispose()},null,null);return}de();Dc.dispose()};if(Xc.a.uq||Xc.a.xV)this.Yd=Ik.a.getInstance(Sc.a);this.JHb=zb}Xkc(){return 51511}t4c(){return 51512}btc(b){try{var h=
JSON.parse(b.data.Ee);const M=Sys.Net.XMLDOM("string"===typeof h[ui.a.xRh]?h[ui.a.xRh]:null);this.xMd="string"===typeof h[ui.a.nSd]?h[ui.a.nSd]:null;const ba=$a.a.instance.Oa(23);ba&&ba.isFeatureEnabled(42)&&(this.hhh="string"===typeof h[ui.a.wic]?h[ui.a.wic]:null);X.a.Mt&&M.setProperty("SelectionNamespaces","xmlns:mc='"+eg.a.h6k+"'");const oa=M.selectSingleNode("/mc:AlternateContent");if(!oa)throw Kp.a.argument("Alternate content element could not be retrieved!");const Ja=oa.firstChild;if(!Ja)throw Kp.a.argument("Alternate content choice element could not be retrieved!");
const jb=Ja.firstChild;if(!jb)throw Kp.a.argument("Drawing element could not be retrieved!");var r=jb.firstChild;if(!r)throw Kp.a.argument("Inline element could not be retrieved!");h=b=null;const zb=RegExp("effectExtent"),Eb=RegExp("extent");for(const nc of r.childNodes)-1!==nc.nodeName.search(zb)&&(b=nc),-1!==nc.nodeName.search(Eb)&&(h=nc);if(!b||!h)throw Kp.a.argument("Effect extent or extent could not be retrieved!");this.lT=parseInt(b.selectSingleNode("@l").text);this.GZ=parseInt(b.selectSingleNode("@r").text);
this.zr=parseInt(b.selectSingleNode("@t").text);this.tia=parseInt(b.selectSingleNode("@b").text);const Sb=rh.e(this.pG);if(45<=Sb&&135>=Sb||225<=Sb&&315>=Sb){const nc=parseInt(h.selectSingleNode("@cx").text);var A=parseInt(h.selectSingleNode("@cy").text);r=nc/2;A/=2;this.lT-=r-A;this.GZ+=r-A;this.zr-=A-r;this.tia+=A-r}}catch(M){Xc.a.uq&&this.D$i(M,this.JHb);v.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",M.message,this.Do,Nv.a[this.JHb]);
this.vve();return}this.sendMessage(!0,this.Tme)}}Object(u.a)(SO,"RenderedDrawingEditOperation",eC,[]);class BN extends eC{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb){super(b,h,r,A,M,ba,oa,Ja,jb,Sb);this.Tda=null;this.Tme=nc=>{var Dc;const Zc=this.bUd(!0,!1);let Gd;Gd=this.qob(Gd);this._image.setValue(Rc.a.PXb,this.xMd);const de=je.a.Msa(this._image,this.Ga,this.ns);Xc.a.uq?this.E$i(this.JHb):(null===(Dc=y.AFrameworkApplication.J)||void 0===Dc?0:Dc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.Yd.logKpiSuccess({kpiName:Zi.c.Hmc});
const he=()=>{de&&Xc.a.Cyb(this._image,de,3);Xc.a.Cyb(this._image,Zc,3);this.Ik.Exe(this._image,Cg.a.tI(this.lT),Cg.a.tI(this.GZ),Cg.a.tI(this.zr),Cg.a.tI(this.tia));this._image.setValue(Rc.a.fpb,Zc);je.a.aA(this._image)||this._image.setValue(Rc.a.eLa,pr.a.Cdb);this._image.setValue(Rc.a.qhd,this.gea);this._image.setValue(Bd.a.c6m,-1);this.Cd.isFeatureEnabled(82)&&je.a.$lc(this._image)&&this.Mp.Cvc(this._image);this._image.setValue(Fe.a.zVa,!1);this.Ik.mxe(this._image,this.vs,this.Zu);this.Ga.$("WordEditorImageRotateIsEnabled")&&
this.Ik.Gxe(this._image,this.pG,this.Fib,this.Gib);this.Ga.$("WordEditorImageCropIsEnabled")&&this.Ik.Qzg(this._image,this.R5b,this.O5b,this.P5b,this.Q5b);2===nc.data.status&&je.a.u3(nc.data.Ee)&&(this._image.setValue(Bd.a.Hu,nc.data.Ee),nc.data.request&&this._image.setValue(Bd.a.dSb,Object(AN.a)("POST"===nc.data.request.get_httpVerb()?nc.data.request.get_body():nc.data.request.get_url())));this.RSa&&this.RSa();this.IM.$Na(this._context);if(this.Km&&this.Km!==hb.a.nil){const fe=this._context.node.Lj(),
Yd=new P.a(this.Km,1);this.In.rfc(fe,Yd)}this.Xd.ev(13);this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateCommandUIAfterSwordEdit",!1)&&qa.StaticActiveAppFrame.za().Fe();this.g1d();this.f1d();db.a.mark(this.t4c());this.wSa.lM([this.wSa.bLf(this.Do)]);this.O4()};if(this.Ga.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Km&&this.Km!==hb.a.nil&&(Dc=this._context.node.Lj())&&Dc.xg){Gd.dispose();Dc.xg.jD(()=>{let fe;fe=this.qob(fe);he();fe.dispose()},null,null);return}he();Gd.dispose()};
this.JHb=zb;this.Cd=Eb;if(Xc.a.uq||Xc.a.xV)this.Yd=Ik.a.getInstance(Sc.a)}Xkc(){return 7988}t4c(){return 7989}get Mp(){this.Tda||(this.Tda=new tN.a);return this.Tda}btc(b){var h;try{const r=b.data.sna;this.xMd=b.data.Ee;X.a.Mt&&r.setProperty("SelectionNamespaces","xmlns:pic='"+eg.a.Cdo+"'");const A=r.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.lT=parseInt(A.selectSingleNode("@l").text);this.GZ=parseInt(A.selectSingleNode("@r").text);this.zr=parseInt(A.selectSingleNode("@t").text);
this.tia=parseInt(A.selectSingleNode("@b").text)}catch(r){b=Object.assign(new bb.a,{extendedProperties:new Map});b.extendedProperties.set("exception",r.message);b.extendedProperties.set("operation",this.Do);Xc.a.uq?this.D$i(r,this.JHb):(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:Zi.c.$ae,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel",
"warning"),this.Yd.logKpiFailure({kpiName:Zi.c.Hmc,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):za.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);v.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",r.message,this.Do,Nv.a[this.JHb]);this.vve();return}this.sendMessage(!0,this.Tme)}}Object(u.a)(BN,"RenderedPictureEditOperation",
eC,[]);class TO{constructor(b,h,r,A,M,ba,oa,Ja){this.Ik=b;this.Ga=h;this.ns=r;this.Zd=A;this.Xd=M;this.In=ba;this.IM=oa;this.Cd=Ja}create(b,h){const r=je.a.Ak(b);return Object(Zg.d)(b)?new RO(b,h,this.Ik,this.Ga,this.ns,this.Zd,this.Xd,this.In,this.IM,new wk.b):10===r||11===r||48===r||4===r?new SO(b,h,this.Ik,this.Ga,this.ns,this.Zd,this.Xd,this.In,this.IM,r,new wk.b):5===r?new BN(b,h,this.Ik,this.Ga,this.ns,this.Zd,this.Xd,this.In,this.IM,r,this.Cd,new wk.b):null}}Object(u.a)(TO,"Factory",null,[556]);
class $F{constructor(){this.LZc=b=>{const h=window.performance.now(),r=zi.a.Qp();if(r){b=QL.a(b.em,r);b=Be.a.Bt(b,r);var A=0,M=new Qb.GraphTransaction(3);try{for(M.Ab(r);b.moveNext();){if(!Ed.ParagraphReader.Eh(b.iterator))continue;const ba=b.currentNode;this.Vhi(ba)&&(A++,ba.fm(4,!0));const oa=window.performance.now()-h;if(2500<A||100<oa){this.MHb=null;this.ojd(ba);break}}}finally{M&&M.dispose()}}else Tc.b(570450380,3018,10,"PageContentNode not found")};this.MHb=null}EUi(){const b=zi.a.Qp();this.Gjd(b);
this.ojd(null)}ojd(b){this.MHb&&(y.AFrameworkApplication.oc.uf(this.MHb),this.MHb=null);this.MHb=new wc.a(1,1,1,this.LZc,198);this.MHb.em=b;y.AFrameworkApplication.oc.Yb(this.MHb)}Gjd(b){const h=QL.b(b);if(h){var r=new Qb.GraphTransaction(3);try{for(r.Ab(b);h.moveNext();){if(!Ed.ParagraphReader.Eh(h.iterator))continue;const A=h.currentNode;this.Vhi(A)&&A.fm(4,!0)}}finally{r&&r.dispose()}}}Vhi(b){b=b.nJ;for(const h of b)if(h.yab)return 0<h.A1b;return!1}}Object(u.a)($F,"RenderParagraphsContainingTabs",
null,[]);class CN{constructor(b,h){this.bQe=!0;this.$Fc=null;this.dYl=()=>{this.$Fc=null;this.bQe=!0;this.SSa&&this.SSa.O0a(!Qf.a.sP())};this.Wfb=(r,A,M)=>{if(1===M)return 32;2===M&&(r=!1,Qf.a.sP()?this.bQe=!1:this.bQe?r=!0:this.dDp(),this.SSa&&this.SSa.O0a(r));return 32};this.ga=b;this.SSa=h}Wb(){this.ga.fb(La.a.Wfb,mc.a.application,this.Wfb,1124)}dDp(){this.$Fc?y.AFrameworkApplication.oc.uf(this.$Fc):this.$Fc=new wc.a(4,1,5E3,this.dYl);y.AFrameworkApplication.oc.Yb(this.$Fc)}}Object(u.a)(CN,"SaveStatusActor",
null,[]);var UK=d(661);class DN{get Twg(){return null!=this.L3g?this.L3g:this.L3g=$a.a.instance.Oa(656)}get QHo(){return this.PHo||(this.PHo=$a.a.instance.Oa(1104))}get Jg(){return null!=this.U4g?this.U4g:this.U4g=$a.a.instance.Oa(28)}constructor(b,h){this.HKb=(r,A,M)=>{r=zi.a.$Tb(A);if(1===M||r)return r?8:32;this.N9.value.WEl(A);return 32};this.TMb=(r,A,M)=>{r=zi.a.$Tb(A);if(1===M||r)return r?8:32;this.N9.value.gJl(A,this.ga);return 32};this.Mwf=(r,A,M)=>{r=zi.a.$Tb(A)||this.t4o();if(1===M||r)return r?
8:32;this.N9.value.Mwf(A);return 32};this.ga=b;this.N9=h}get Xb(){return null!=this.D7g?this.D7g:this.D7g=$a.a.instance.resolve(8)}Wb(){this.ga.fb(ub.a.HKb,mc.a.view,this.HKb,1028);this.ga.fb(ub.a.TMb,mc.a.view,this.TMb,4);this.ga.fb(ub.a.DNb,mc.a.view,this.Mwf,4);this.ga.fb(ub.a.Swg,mc.a.view,this.KNo.bind(this),4);this.ga.fb(ub.a.dvg,mc.a.view,this.evg.bind(this),4);this.ga.fb(ub.a.Hwf,mc.a.view,this.$Rl.bind(this),4)}KNo(b,h,r){b=zi.a.$Tb(h)||this.y4o();if(1===r||b)return b?8:32;this.Twg.JNo();
return 32}evg(b,h,r){b=zi.a.$Tb(h)||this.w4o();if(1===r||b)return b?8:32;this.QHo.evg();return 32}$Rl(b,h,r){b=zi.a.$Tb(h)||this.s4o();if(1===r||b)return b?8:32;this.N9.value.ZRl();return 32}s4o(){return"{}"===wA.a.OAb?!0:!1}w4o(){if(0==wA.a.EP.size)return!0;var b=wA.a.EP;const h=this.Xb.xo();let r=0;for(const A of b.values())b=h.mh(A),this.Xb.me(b,h)||r++;return 0==r?!0:!1}y4o(){var b=wA.a.OAb,h=wA.a.EP;const r=this.Xb.xo();if(0==h.size)return!0;if(!({hv:b}=G.d(b)).returnValue)return v.ULS.sendTraceTag(526979992,
3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const M of h.values()){h=r.mh(M);var A=b[M];if(null==A)return!1;if(A=zi.a.k9d(A)){if(h=zi.a.Z2c(h,r),zi.a.b$c(h,A))return!1}else v.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}t4o(){var b=zi.a.Qp();if(!b)return Tc.b(577368330,3018,15,"PageContentNode is null"),!0;b=this.Jg.xn?(new lu.WACStyleSet).lla(b):(new lu.WACStyleSet).$aa(b);
const h=b.Ow;for(let A=0;A<h;A++){let M;b instanceof lu.WACStyleSet?M=b.eBa(A):b instanceof UK.a&&(M=b.Bla(A));if(!this.Xb.isHidden(M)&&this.Xb.me(M,b)){var r=this.Xb.NF(M);if(2===r||1===r)if(!M.hasProperty(Rc.a.linkedStyle)||2===r)if(r=M.ka(Rc.a.nE,null),!(r&&0<r.length))return!1}}return!0}}Object(u.a)(DN,"StylesActor",null,[]);class aG{constructor(b){this.MBe=(h,r,A)=>{h=y.AFrameworkApplication.ta;if(1===A)return 1!==h.mode||fc.SessionStatusManager.instance.Nk?2:32;za.Health.instance.recordKpiUsage("SwitchToClassicViewMode",
0,aG.$B,null);const M={};M[H.a.KTf]=y.AFrameworkApplication.J.jb("ClassicViewModePreferenceCookieName");M[H.a.wPi]="true";y.AFrameworkApplication.DN().execute(ba=>{ba.sendMessage(K.a.ngp,M)});return y.AFrameworkApplication.va.Ob(ub.a.readingMode,2)};this.ga=b}Wb(){this.ga.qa(Hc.a.MBe,mc.a.view,this.MBe)}}aG.$B="wwaengidc";Object(u.a)(aG,"SwitchToClassicViewModeActor",null,[]);class EN{constructor(b,h,r,A,M,ba,oa,Ja,jb){this.angle=r;this.styleId=A;this.width=b;this.height=h;this.top=M;this.bottom=
ba;this.left=oa;this.right=Ja;this.s_=jb}}Object(u.a)(EN,"SWordData",null,[]);class VK{constructor(b,h){this.oo=this.L5=this.dr=null;this.A6e=this.G9b=!1;this.lT=this.GZ=this.tia=this.zr=this.gea=this.Zu=this.vs=this.pG=0;this.Km=null;this.Rba=()=>{this.A6e=!1;this.G9b&&this.F_c()};this.lq=b;this.MOc=h;this.PRi()}PRi(){this.GZ=this.lT=this.tia=this.zr=this.gea=this.Zu=this.vs=this.pG=-1;this.Km=hb.a.nil}F_c(){this.A6e||(this.zGp(),this.yKl(),this.G9b=!1)}yKl(){this.oo=new EN(this.vs,this.Zu,this.pG,
this.gea,this.zr,this.tia,this.lT,this.GZ,this.Km);this.MOc.create(this.L5,this.dr).DZo(this.Rba,this.oo);this.A6e=!0;let b;Object(Za.a)(2,this.L5)?b=Nv.a[je.a.Ak(this.L5)]:(v.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");v.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",
this.vs,this.Zu,this.pG,this.gea,this.zr,this.tia,this.lT,this.GZ,b);this.PRi()}zGp(){this.vs=-1!==this.vs?this.vs:this.L5.ka(Bd.a.cLa,-1);this.Zu=-1!==this.Zu?this.Zu:this.L5.ka(Bd.a.bLa,-1);this.vs=-1!==this.vs?this.vs:this.lq.cC(this.L5);this.Zu=-1!==this.Zu?this.Zu:this.lq.nD(this.L5);this.pG=-1!==this.pG?this.pG:this.lq.Z2(this.L5);this.gea=-1!==this.gea?this.gea:this.lq.nrb(this.L5);const b=this.lq.yfa(this.L5);this.zr=-1!==this.zr?this.zr:b.top;this.tia=-1!==this.tia?this.tia:b.bottom;this.lT=
-1!==this.lT?this.lT:b.left;this.GZ=-1!==this.GZ?this.GZ:b.right}Vno(b,h,r,A){this.dr=b;this.pG=r;this.G9b=!0;this.L5=h;this.Km=A;this.F_c()}Uno(b,h,r,A,M){this.dr=b;this.G9b=!0;this.L5=h;this.Km=M;this.L5.setValue(Bd.a.cLa,r);this.L5.setValue(Bd.a.bLa,A);this.F_c()}Zno(b,h,r){this.dr=b;this.G9b=!0;this.L5=h;this.gea=r;this.F_c()}Ono(b,h,r,A,M,ba){this.dr=b;this.zr=r;this.tia=A;this.lT=M;this.GZ=ba;this.G9b=!0;this.L5=h;h=b=0;({width:b,height:h}=this.lq.C9a(this.L5));this.vs=b-(M+ba)/1E5*b;this.Zu=
h-(r+A)/1E5*h;this.F_c()}}Object(u.a)(VK,"SWordRequestManager",null,[555]);class TD{constructor(b,h,r,A=null,M=null,ba=null,oa=null,Ja=null,jb=null,zb=null){this.In=null;this.dKh=!1;this.Sip=(Eb,Sb,nc,Dc,Zc)=>{if(1===nc)return 32;const Gd=Eb===ub.a.Mye;if(!Sb.view.ue)return 2;const de=Sb.view,he=de.lb,fe=he.Ng;if(!fe||TD.sg.F2(fe))return 2;if(this.ao&&this.ao.instance&&this.ao.instance.KX(fe))return 4;var Yd=null,Td=kd.ActionManager.MCa,wf=!1,Lf=Le.a.qf(fe);if(fe.Uw){if(he.gb.WL&&(Td=fe.getContext(0),
Yd=new zc.a,Yd.set(Td.node),Yd.yq(),Td=Gd?ub.a.Bxg:ub.a.twe),Td=this.N$e.rio(Td),Td===kd.ActionManager.MCa){var ii=Object(zl.a)().PW(fe,16);ii?(Gd&&(Td=ub.a.Qke),Yd=new zc.a,Yd.set(ii.node),Yd.Ld()):Td=Gd?ub.a.XI:ub.a.mR}}else if(fe.Cl)if(Yd=new zc.a,Yd.set(fe.node),Le.a.yv(Yd),Lj.OutlineReader.CXa(fe))Td=Gd?ub.a.Bxg:ub.a.twe;else{if(this.jVe&&this.jVe.C6o(fe))return this.jVe.Ond(fe,de.sc,Gd),32;je.a.cab(fe)?Td=Gd?ub.a.Axg:ub.a.zxg:(Td=Gd?this.N$e.EUm(Yd,fe,Td,Sb):this.N$e.DUm(Yd,fe,Td),Ua.a.Qh(Yd)&&
fe.contextId===mc.a.Vc&&(wf=Ua.a.aB(Yd,fe,!1)),ii=mf.ListItemReader.Dg(Yd)&&wf,Td!==kd.ActionManager.MCa||Xh.TableCellReader.lga(Yd)||ii||(this.dKh||(v.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.dKh=!0),y.AFrameworkApplication.va.Ob(ub.a.nSi,2),this.MSi(Sb)))}else return 2;if(!Gd&&Td===kd.ActionManager.MCa&&Xh.TableCellReader.lga(Yd))if(bi.returnToCell(Yd),Xh.TableCellReader.wXa(Yd)||Hi.TableReader.mZi(Yd)&&Xh.TableCellReader.f_f(Yd)){if(Td=this.UUk(),!Td)return 2}else Td=
ub.a.ygj;if(Td===kd.ActionManager.MCa)return 2;switch(Td){case ub.a.ygj:case ub.a.Qke:wf=Td===ub.a.Qke;Lf&&this.g5&&this.j1&&(Lf=this.g5.BDf(fe,-1,!0,rf.a.wz))&&this.j1.pKj(Lf);nc=32;bi.returnToCell(Yd);bi.moveToNextOrPreviousCell(Yd,wf)&&(Lf=!0,wf=!1,Lj.OutlineReader.ISf(Yd)||(to.OutlineNavigator.e$f(Yd,!1),Ab.OutlineElementNavigator.Me(Yd),Ed.ParagraphReader.Au(Yd.currentNode)&&(Lf=!1,Ed.ParagraphReader.textLength(Yd.currentNode)||(wf=!0)),wf||bi.returnToCell(Yd)),wf?Yd=sc.SelectionFactory.ve(Yd.currentNode,
0):(Yd=sc.SelectionFactory.Ir(Yd.currentNode),!Lf&&Le.a.rl(Yd.Wc)&&(Lf=Yd.toArray(),Array.removeAt(Lf,Lf.length-1),Yd=new or.Selection(Lf,Yd.Jf))),he.Kc(Yd));break;case ub.a.Bxg:case ub.a.twe:Td===ub.a.twe?to.OutlineNavigator.Cfj(Yd,!1):to.OutlineNavigator.Cfj(Yd,!0);he.Kc(sc.SelectionFactory.Ir(Yd.currentNode));nc=32;break;case ub.a.jqd:nc=y.AFrameworkApplication.va.Pf(Sb,Td,nc,!0,Dc,Zc);break;default:if(Yd=()=>{const Bi=new ji.DictionaryPropertySet;Bi.setValue(Fe.a.ybe,Eb===ub.a.Mye?"ShiftTab":
"tab");return Bi},nc=y.AFrameworkApplication.va.Pf(Sb,Td,nc,!0,Dc,Mh.F5f?Yd():Zc),!wf&&Lf&&(Td===ub.a.XI||Td===ub.a.mR)){const Bi=Le.a.dra(he.gb.currentSelection).y;df.a.tvc(()=>{this.KQn(he,de,Bi)})}}32===nc&&Sb.view.ue&&this.rh.BI();return nc};this.Dqa=b;this.N$e=h;this.ao=r;this.g5=A;this.j1=M;this.P$e=ba;this.VPa=oa;this.Cd=Ja;this.Qc=jb;this.jVe=zb}get rh(){return this.In||(this.In=this.Dqa())}Wb(){const b=y.AFrameworkApplication.va,h=this.Sip;b.fb(ub.a.tab,mc.a.view,h,1124);b.fb(ub.a.Mye,mc.a.view,
h,1124);b.qa(ub.a.nSi,mc.a.view,kd.ActionManager.$f)}KQn(b,h,r){if(b&&h){var A=b.gb.currentSelection;Le.a.dra(A).y<r?(h=Le.a.M0c(h,A,!1),h=Le.a.EAa(h,{ZE:!1,Ju:!1,iH:!1,hJ:!0})):h=Le.a.j3d(h,A,!1);b.Kc(h)}}UUk(){return ub.a.W$a}MSi(){}Odd(b,h,r){if(b&&h){var A=b.gb.currentSelection;Le.a.dra(A).y<r?(h=Le.a.M0c(h,A,!1),h=Le.a.EAa(h,{ZE:!1,Ju:!1,iH:!1,hJ:!0})):h=Le.a.EAa(A,{ZE:!1,Ju:!1,iH:!1,hJ:!0});b.Kc(h)}}static get sg(){return ve.a.instance}}Object(u.a)(TD,"TabActor",null,[]);class WK{constructor(b){this.tJc=
b}get ir(){return this.tJc}rio(b){return b}EUm(b,h,r,A){A=A.view;const M=A.lb.gb.currentSelection;if(Xh.TableCellReader.lga(b))return this.fZi(b,h)?ub.a.XI:ub.a.Qke;Ab.OutlineElementNavigator.ke(b);if(Le.a.qf(h))Ua.a.aB(b,h,!1)&&this.CTj(b)?r=ub.a.uYb:Le.a.Nfe(A,M)&&this.ir.GLb(b)?r=ub.a.XI:Le.a.Nfe(A,M)&&(r=ub.a.XI);else if(Le.a.gm(h)){if(!this.ir.GLb(b))return r;Le.a.ktb(h)?r=ub.a.XI:Le.a.w3i(h)&&(r=this.CTj(b)?ub.a.uYb:ub.a.XI)}else this.ir.GLb(b)&&(r=ub.a.XI);return r}DUm(b,h,r){if(Xh.TableCellReader.v3(b))return this.fZi(b,
h)?ub.a.mR:r;Ab.OutlineElementNavigator.ke(b);if(Le.a.qf(h))Ua.a.aB(b,h,!1)&&(!mf.ListItemReader.Dg(b)&&Ua.a.isEmpty(b,!1)?r=kd.ActionManager.MCa:this.r4o(b)?r=ub.a.Mob:this.NSj(b)?r=ub.a.FNb:this.ir.Bec(b)&&(r=ub.a.mR));else if(Le.a.gm(h)){if(!this.ir.Bec(b))return r;Le.a.ktb(h)?r=ub.a.mR:Le.a.w3i(h)&&(r=this.NSj(b)?ub.a.FNb:ub.a.mR)}else this.ir.Bec(b)&&(r=ub.a.mR);return r}CTj(b){return mf.ListItemReader.Dg(b)?!1:0<Ua.a.Y2(b)?!0:!1}NSj(b){if(mf.ListItemReader.Dg(b))return!1;const h=Ua.a.Y2(b);
b=Lj.OutlineReader.E_(b.currentNode);return h<b?!0:!1}r4o(b){return mf.ListItemReader.Dg(b)?!1:0<Ua.a.xI(b)?!0:!1}static Ts(){return new WK(rv.a.DQb)}fZi(b,h){if(this.Krn){const r=new zc.a;r.kd(b);Ab.OutlineElementNavigator.ke(r);if(mf.ListItemReader.Dg(r)&&Ua.a.aB(r,h,!1))return!0}return!1}get Krn(){var b;y.AFrameworkApplication.nd("egdi3422;7g6fa693");return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}
Object(u.a)(WK,"TabActorPromoteDemoteStrategy",null,[568]);class UD extends TD{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){super(b,h,r,A,M,ba,oa,Ja,jb,zb);this.sne=(Dc,Zc)=>{Dc=Zc.property;!this.cld||Dc!==Rc.a.Bp&&Dc!==Rc.a.marginLeft&&Dc!==Rc.a.marginRight||this.cld.EUi()};this.E_=(Dc,Zc,Gd,de,he)=>{Dc=Lj.OutlineReader.E_(this.LFm(Zc));he.defaultTabStop=Dc;return 32};this.J9b=Eb;this.ga=nc;this.YE();this.ga.qa(Hc.a.E_,mc.a.view,this.E_)}get cld(){return null!=this.x3g?this.x3g:this.x3g=$a.a.instance.Oa(1098)}YE(){this.J9b.Pl.jf(10).ro(this.sne)}MSi(b){const h=
b.view,r=h.lb;b=r.Ng;if(this.VPa&&this.Qc){var A=this.Qc.Lc(15);A.Ab(b.node);b.contextId===mc.a.Fd&&y.AFrameworkApplication.va.Ob(ub.a.RJ,2);this.VPa.ece(r.Ng);A.dispose();var M=Le.a.dra(r.gb.currentSelection).y;df.a.tvc(()=>{this.Odd(r,h,M)})}}LFm(b){return b.view.lb.gb.currentSelection.Qa.node}static get instance(){return null!=UD.j_g?UD.j_g:UD.j_g=UD.Sm()}static Sm(){return new UD(()=>$a.a.instance.resolve(50),WK.Ts(),$a.a.instance.Ra(51),$a.a.instance.resolve(105),$a.a.instance.resolve(70),$a.a.instance.Oa(116),
$a.a.instance.Oa(953),$a.a.instance.Oa(23),$a.a.instance.Oa(264),$a.a.instance.Oa(1105),df.a.ff,$a.a.instance.Oa(294),y.AFrameworkApplication.va)}}Object(u.a)(UD,"TabActor",TD,[]);class Fu{static get fv(){return null!=Fu.xTg?Fu.xTg:Fu.xTg=$a.a.instance.resolve(350)}static initialize(){dr.a.hpc=Fu.Msn;$f.a.instance.BA(Fu.Xll)}static Xll(){Fu.LJp()}static Msn(b){return!Hi.TableReader.onn(b)}static Nvb(){Fu.fv.Hvc(Fu.Nvb);Fu.CGb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&
0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static LJp(){var b,h,r;((null===(b=kt.a.instance.currentSelection)||void 0===b?0:b.XLa)||(null===(h=kt.a.instance.currentSelection)||void 0===h?0:h.Ww)||(null===(r=kt.a.instance.currentSelection)||void 0===r?0:r.abb))&&!Fu.CGb&&(Fu.fv.d6a(Fu.Nvb),Fu.CGb=!0)}}Fu.CGb=!1;Object(u.a)(Fu,"TableActor",null,[]);var bG=d(359),FN=d(669),XK=d(940);class Ci{static get Zva(){return null!=Ci.G5g?Ci.G5g:Ci.G5g=Pk.a.instance}static get Pd(){return null!=
Ci.k6g?Ci.k6g:Ci.k6g=$a.a.instance.Oa(46).instance}static get A_j(){Ci.tJ||(Ci.tJ=new Ps("TableBorder"),Ci.Vfa(Ci.tJ));return Ci.tJ}static get nB(){Ci.vya||(Ci.vya=$a.a.instance.Oa(875),Ci.vya.initialize());return Ci.vya}static Wb(){const b=y.AFrameworkApplication.va,h=df.a.r0a.GXc(r=>Ci.zfm(r));b.qa(ub.a.Bzb,mc.a.view,Ci.aeb);b.qa(ub.a.Bzb,mc.a.table,Ci.$db);b.Pc(ub.a.Bzb,4);b.qa(ub.a.hfb,mc.a.view,Ci.aeb);b.qa(ub.a.hfb,mc.a.table,Ci.$db);b.Pc(ub.a.hfb,4);b.qa(ub.a.ifb,mc.a.view,Ci.aeb);b.qa(ub.a.ifb,
mc.a.table,Ci.$db);b.Pc(ub.a.ifb,4);b.qa(ub.a.Gzb,mc.a.view,Ci.aeb);b.qa(ub.a.Gzb,mc.a.table,Ci.$db);b.Pc(ub.a.Gzb,4);b.qa(ub.a.Dzb,mc.a.view,Ci.aeb);b.qa(ub.a.Dzb,mc.a.table,Ci.$db);b.Pc(ub.a.Dzb,4);b.qa(ub.a.Ezb,mc.a.view,Ci.aeb);b.qa(ub.a.Ezb,mc.a.table,Ci.$db);b.Pc(ub.a.Ezb,4);b.qa(ub.a.Fzb,mc.a.view,Ci.aeb);b.qa(ub.a.Fzb,mc.a.table,Ci.$db);b.Pc(ub.a.Fzb,4);b.qa(ub.a.Czb,mc.a.view,Ci.aeb);b.qa(ub.a.Czb,mc.a.table,Ci.$db);b.Pc(ub.a.Czb,4);b.qa(ub.a.ETa,mc.a.view,Ci.aeb);b.qa(ub.a.ETa,mc.a.table,
Ci.$db);b.Pc(ub.a.ETa,4);b.qa(ub.a.Bqe,mc.a.view,Ci.Bqe);b.qa(ub.a.xha,mc.a.view,Ci.tye);b.qa(ub.a.xha,mc.a.D4,Ci.sye);b.qa(ub.a.xha,mc.a.T0,Ci.uye);b.Pc(ub.a.xha,4);b.qa(ub.a.xvb,mc.a.view,Ci.tye);b.qa(ub.a.xvb,mc.a.D4,Ci.sye);b.qa(ub.a.xvb,mc.a.T0,Ci.uye);b.Pc(ub.a.xvb,4);b.qa(ub.a.qig,mc.a.view,Ci.S3);b.Pc(ub.a.qig,4);b.qa(ub.a.xeb,mc.a.view,Ci.tye);b.qa(ub.a.xeb,mc.a.D4,Ci.sye);b.qa(ub.a.xeb,mc.a.T0,Ci.uye);b.Pc(ub.a.xeb,4);b.fb(ub.a.ruc,mc.a.view,Ci.ruc,1124);b.qa(ub.a.yeb,mc.a.view,Ci.tye);
b.qa(ub.a.yeb,mc.a.D4,Ci.sye);b.qa(ub.a.yeb,mc.a.T0,Ci.uye);b.Pc(ub.a.yeb,4);b.fb(ub.a.suc,mc.a.view,Ci.suc,1124);b.qa(ub.a.rNa,mc.a.view,h);b.qa(ub.a.rNa,mc.a.D4,Ci.rNa);b.qa(ub.a.rNa,mc.a.T0,Ci.rNa);b.Pc(ub.a.rNa,97)}static EM(){y.AFrameworkApplication.J&&y.AFrameworkApplication.J.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=$a.a.instance.Ra(2);b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}static aeb(b,
h,r,A){if(1===r)return 32;if(!h.view.ue)return 2;const M=h.view;if(!M.lb||!M.lb.gb)return 8;h=M.lb.gb;if(2===r){v.ULS.sendTraceTag(578027873,306,50,"Selecting table border using border gallery");if((r=sc.SelectionFactory.Hsd(h))&&Hi.TableReader.OU(r))return y.AFrameworkApplication.va.Pf(vc.a.create(r),b,2,!1,A,null);r=M.lb.Ng;if(!r)return 8;A=Object(zl.a)().wU(r,16);r=Object(zl.a)().PW(r,14);if(!r)return dr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],Ff.a.Rsb),8;if(!Ci.uKg(r.node,
A,h))return 8;b=XK.getTableCellBorderContext(Os.TableBorderSelectionCache.uca,Os.TableBorderSelectionCache.lWa(),b);if(!b||0>=b.length)return dr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],Ff.a.Rsb),8;Os.TableBorderSelectionCache.Myb(b);b=sc.SelectionFactory.XMb(b,!0);h=null;b&&(h=sc.SelectionFactory.Cka(b));if(!h||0>=h.currentSelection.length)return dr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],Ff.a.Rsb),8;$f.a.instance.P0(h)}return 32}static $db(b,
h,r){if(1===r)return 32;if(2!==r||14!==h.node.type)return 2;b=XK.getTableBorderContext(h.node,b);if(!b)return dr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],Ff.a.Rsb),8;b=sc.SelectionFactory.fgc(b,!0);h=null;b&&(h=sc.SelectionFactory.Cka(b));if(!h||0>=h.currentSelection.length)return dr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],Ff.a.Rsb),8;$f.a.instance.P0(h);return 32}static Bqe(b,h,r,A,M){if(1===r)return 32;b=h.contextId===mc.a.view?
cm.PageReader.instance.IQb(h):bG.a.CMf(h);if(!b)return 8;h=new Rj;r="";32===y.AFrameworkApplication.va.Pb(ub.a.rNa,2,h)&&h&&(r=h.borderColor);Ci.A_j.sca=r;b=Ci.A_j.mqb(b,df.a.nUa);if(!b)return 8;M.MenuItems=b;v.ULS.sendTraceTag(578027874,340,50,"Table border color dropdown menu is opened.");return 32}static tye(b,h,r,A,M){if(!Ci.nB)return 2;if(1===r)return 32;if(!h.view.ue)return 2;var ba=h.view;if(!ba.lb||!ba.lb.gb)return 8;h=ba.lb.gb;if(2===r){v.ULS.sendTraceTag(578027875,306,50,"Setting table border property for the command: {0} with action data {1}",
b,Ci.T1c(b,M));r=sc.SelectionFactory.f5j(h);if(!r){const oa=sc.SelectionFactory.Hsd(h);oa&&14===oa.type&&(r=Ai.TableNodeBorderContext.Dka(oa,4))}if(r)return y.AFrameworkApplication.va.Pf(r,b,2,!0,A,M);r=sc.SelectionFactory.QKg(h);if(!r||0>=r.length){r=ba.lb.Ng;if(!r)return 8;ba=Object(zl.a)().wU(r,16);r=Object(zl.a)().PW(r,14);if(!r||!Ci.uKg(r.node,ba,h))return 8;r=XK.getTableCellBorderContext(Os.TableBorderSelectionCache.uca,Os.TableBorderSelectionCache.lWa(),ub.a.ETa);if(!r||0>=r.length)return 8}ba=
lt.a.dJa(r);if(!ba)return 8;Ci.EM();h=new Qb.GraphTransaction(15);h.Ab(r[0].node);h.Ei=b;b=y.AFrameworkApplication.va.Pf(ba,b,2,!0,A,M);h.dispose();return b}return 32}static sye(b,h,r,A,M){if(!Ci.nB)return 2;if(1===r)return 32;if(2!==r||h.contextId!==mc.a.D4)return dr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],Ff.a.r2d),2;v.ULS.sendTraceTag(578027904,306,50,"Setting table border property for the table border for the command: {0} with action data {1}",b,Ci.T1c(b,M));
r=h.node;A=new ct;let ba=0;({B_j:A,property:ba}=Ci.dbi(r,b,M,A,ba));Ci.EM();M=!0;const oa=new Qb.GraphTransaction(15);oa.Ab(r);oa.Ei=b;if(M=Ci.nB.cUo(h,A,ba))b=new zc.a,b.set(r),bi.forEachCellInTable(b,Ja=>{Ja.currentNode.fm(4,!0);return!0});oa.dispose();M&&Ci.Pd&&Ci.Pd.ev(16);return M?32:(dr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],Ff.a.r2d),8)}static uye(b,h,r,A,M){if(!Ci.nB)return 2;if(1===r)return 32;if(2!==r||h.contextId!==mc.a.T0)return dr.a.recordQosError("TableBorderActionNoResponse",
["TableInteractionFailed"],Ff.a.r2d),2;v.ULS.sendTraceTag(578027905,306,50,"Setting table border property for the cell border for the command: {0} with action data {1}",b,Ci.T1c(b,M));r=h.node;A=new ct;let ba=0;({B_j:A,property:ba}=Ci.dbi(r,b,M,A,ba));(b=Ci.nB.ezg(zm.a.pX(h),h,A,ba))&&Ci.Pd&&Ci.Pd.ev(16);return b?32:(dr.a.recordQosError("TableBorderActionNoResponse",["TableInteractionFailed"],Ff.a.r2d),8)}static S3(b,h,r){if(1===r)return 32;qa.StaticActiveAppFrame.za().dismissFloatie();Ci.FFa=new Gs("TableBorder",
ub.a.xha);Ci.FFa.Wyb(0);return 32}static ruc(b,h,r,A,M){if(!Ci.nB)return 8;if(1===r)return 32;b=Ci.nB.oGf();M.MenuItems=b;return 32}static suc(b,h,r,A,M){if(!Ci.nB)return 8;if(1===r)return 32;b=Ci.nB.pGf();M.MenuItems=b;return 32}static rNa(b,h,r,A,M){if(!Ci.nB)return 2;if(!Le.a.iad(h)&&!Le.a.jad(h))return 8;b=Object(Ma.a)(Rj,M);if(!b)return 8;Le.a.iad(h)?Ci.nB.Cno(h,b):Ci.nB.$lo(h,b);return 32}static uKg(b,h,r){if(!b||14!==b.type)return v.ULS.sendTraceTag(578027906,306,15,"Table node must be present"),
!1;if(!h)return v.ULS.sendTraceTag(578027907,306,15,"Cell context must be present"),!1;if(r&&r.currentSelection&&r.currentSelection.Ve&&r.currentSelection.Ve.Qa&&r.currentSelection.Ve.Qa.contextId===mc.a.T0&&Os.TableBorderSelectionCache.lWa()&&0<Os.TableBorderSelectionCache.lWa().length)return!0;Os.TableBorderSelectionCache.L7c(b);r=Os.TableBorderSelectionCache.uca;for(let M=0;M<h.length;M++){if(h.getContext(M).contextId!==mc.a.hx)return!1;const ba=h.getContext(M).node;if(!Xh.TableCellReader.jr(ba)){var A=
new zc.a;A.set(ba);if(A.vb(14)&&bi.getContainingTable(A)===b){A.fd(14);A=Xh.TableCellReader.rKa(A,ba);if(!A)return!1;Array.add(Os.TableBorderSelectionCache.lWa(),new FN.a(ba,A.rowIndex,A.rp,ba.rowSpan,ba.colSpan));r.leftMostColumnSelected=Math.min(r.leftMostColumnSelected,A.rp);r.rightMostColumnSelected=Math.max(r.rightMostColumnSelected,A.rp);r.topMostRowSelected=Math.min(r.topMostRowSelected,A.rowIndex);r.bottomMostRowSelected=Math.max(r.bottomMostRowSelected,A.rowIndex)}}}Os.TableBorderSelectionCache.uca=
r;return!0}static Vfa(b){b.SG(3,ub.a.xha);b.SG(4,ub.a.xha);b.b6a(tn.a.instance,1)}static zfm(b){const h=b.gb;var r=sc.SelectionFactory.f5j(h);if(!r){const A=sc.SelectionFactory.Hsd(h);A&&14===A.type&&(r=Ai.TableNodeBorderContext.Dka(A,4))}if(r)return lt.a.dJa([r]);r=sc.SelectionFactory.QKg(h);if(!r||0>=r.length){r=b.Ng;if(!r)return null;b=Object(zl.a)().wU(r,16);r=Object(zl.a)().PW(r,14);if(!r||!Ci.uKg(r.node,b,h))return null;r=XK.getTableCellBorderContext(Os.TableBorderSelectionCache.uca,Os.TableBorderSelectionCache.lWa(),
ub.a.ETa);if(!r||0>=r.length)return null}return lt.a.dJa(r)}static dbi(b,h,r,A,M){switch(h){case ub.a.xha:A.color=Ci.Zva.mka(b,r);M=3;break;case ub.a.xvb:A.style="none";M=2;break;case ub.a.xeb:(b="object"===typeof r?r:null)&&"MenuItemId"in b&&(A.style=Ci.nB.fui(b.MenuItemId));M=2;break;case ub.a.yeb:(b="object"===typeof r?r:null)&&"MenuItemId"in b&&(A.weight=Ci.nB.gui(b.MenuItemId)),M=1}return{B_j:A,property:M}}static T1c(b,h){let r="";if(!h)return r;switch(b){case ub.a.xha:r=h;break;case ub.a.xvb:r=
"none";break;case ub.a.xeb:case ub.a.yeb:(b="object"===typeof h?h:null)&&"MenuItemId"in b&&(r=b.MenuItemId)}return r}}Ci.tJ=null;Ci.FFa=null;Ci.vya=null;Object(u.a)(Ci,"TableBorderActor",null,[]);class YK{jam(b,h,r,A){return b?this.J9l(h,r,A):this.kam(h,r,A)}Koi(b,h,r,A,M){return b?this.K$l(h,r,A,M):this.y$l(h,r,A,M)}v$l(b){let h=!1;var r=b.Jf?b.Ve.Wc:b.Ve.Qa;b=new zc.a;b.set(r.node);b.vb(14);r=null;Xh.TableCellReader.fga(b)?Xh.TableCellReader.vTb(b)||(h=!0,r=bi.moveToNextRow(b)):r=bi.moveToNextColumn(b);
return{returnValue:r,cRn:h}}F$l(b){var h=b.Jf?b.Ve.Wc:b.Ve.Qa;const r=new zc.a;r.set(h.node);r.vb(14);h=null;Xh.TableCellReader.cma(r)?Xh.TableCellReader.bma(r)||(h=new zc.a,h.set(b.qza.node),h.vb(14),b=Cn.a.It(h),Cn.a.It(r)>b?(bi.moveToPreviousRow(r),bi.moveToLastColumn(r),h=r.currentNode):h=bi.moveToPreviousRow(r)):h=bi.moveToPreviousColumn(r);return h}Voi(b,h){var r=b.Jf?b.Ve.Wc:b.Ve.Qa;b=new zc.a;b.set(r.node);b.vb(14);r=null;h?Xh.TableCellReader.bma(b)||(r=bi.moveToPreviousRow(b)):Xh.TableCellReader.vTb(b)||
(r=bi.moveToNextRow(b));return r}rUb(b,h,r){for(;Xh.TableCellReader.Lg(b);)if(h){if(r&&b.VBa(1)||!r&&b.aCa(1))return null;r?bi.moveToPreviousColumn(b):bi.moveToNextColumn(b)}else{if(Xh.TableCellReader.P7(b.currentNode)){const A=new zc.a;A.kd(b);if(this.rUb(A,!0,!0)||this.rUb(A,!0,!1)){b.kd(A);break}}else{if(!r&&bi.moveToControllingCell(b,2))break;if(r&&bi.moveToControllingCell(b))break}if(r&&Xh.TableCellReader.bma(b)||!r&&Xh.TableCellReader.vTb(b))return null;r?bi.moveToPreviousRow(b):bi.moveToNextRow(b)}return b.currentNode}Oic(b,
h){if(!Cn.a.isTableRow(b))return null;b=zc.a.Za(b.currentNode);b.vb(14);let r;const A=Hi.TableReader.yD(b.origin);do r=h?bi.moveToPreviousRow(b):bi.moveToNextRow(b);while(A&&r&&Cn.a.oXa(b));return r}lvb(b,h,r,A,M){let ba=null;Ab.OutlineElementNavigator.ke(b);const oa=Ua.a.isRtl(b.currentNode);if(r)if(bi.returnToCell(b),h=Xh.TableCellReader.fga(b),r=Xh.TableCellReader.cma(b),M||!oa&&r||oa&&A&&h)bi.returnToContainingRow(b),(A=this.Oic(b,!0))?ba=sc.SelectionFactory.vp(A,!h):M&&(Ab.OutlineElementNavigator.ke(b),
M=new sn.a,M.kd(b),(b=Ab.OutlineElementNavigator.N3(M,!1,!1))&&(ba=sc.SelectionFactory.vp(b,!1)));else{do oa?bi.moveToNextColumn(b):bi.moveToPreviousColumn(b);while(Xh.TableCellReader.Lg(b)&&!Xh.TableCellReader.bma(b));Xh.TableCellReader.Lg(b)||(ba=sc.SelectionFactory.vp(b.currentNode,!oa))}else Ua.a.aB(b,h,oa)||Le.a.qf(h)||bi.returnToCell(b),ba=sc.SelectionFactory.vp(b.currentNode,!oa);return ba}kvb(b,h,r,A,M){let ba=null;Ab.OutlineElementNavigator.ke(b);const oa=Ua.a.isRtl(b.currentNode);if(r)if(bi.returnToCell(b),
r=Xh.TableCellReader.fga(b),h=Xh.TableCellReader.cma(b),M||!oa&&A&&r||oa&&!A&&h)bi.returnToContainingRow(b),(A=this.Oic(b,!1))?ba=sc.SelectionFactory.vp(A,h):(Ab.OutlineElementNavigator.ke(b),A=new sn.a,A.kd(b),(b=Ab.OutlineElementNavigator.at(A,!1,!1))&&(ba=sc.SelectionFactory.vp(b,!0)));else{do oa?bi.moveToPreviousColumn(b):bi.moveToNextColumn(b);while(Xh.TableCellReader.Lg(b)&&!Xh.TableCellReader.fga(b));Xh.TableCellReader.Lg(b)||(ba=sc.SelectionFactory.vp(b.currentNode,oa))}else Ua.a.aB(b,h,!oa)||
Le.a.qf(h)||bi.returnToCell(b),ba=sc.SelectionFactory.vp(b.currentNode,oa);return ba}}Object(u.a)(YK,"ATableCellSelectionStrategy",null,[1621]);class ZK extends YK{constructor(){super()}y$l(b,h,r,A){let M=b.currentSelection,ba=null;if(b.Ww)if(h)if(2===M.Ve.Ima&&!M.Jf&&M.Ve.Wc.equals(M.qza))M=sc.SelectionFactory.Uai(M.qza.node,!1);else{var oa=({cRn:b}=this.v$l(M)).returnValue;oa&&(Xh.TableCellReader.jr(oa)&&(oa=zc.a.Za(oa),oa.vb(14),oa=!b&&this.rUb(oa,!0,!1)?oa.currentNode:b||bi.moveToNextRow(oa)?
this.rUb(oa,!1,!1):null),oa&&(ba=sc.SelectionFactory.Yo(lx.TableNodeContext.create(oa),M.Jf)))}else M=b.Sha,b=zc.a.Za(M.Ve.Wc.node),b.vb(14),Xh.TableCellReader.FLa(b.currentNode)&&bi.moveToLastGhostCell(b,2),(oa=bi.moveToNextColumn(b))?(b=Xh.TableCellReader.P7(oa),Xh.TableCellReader.jr(oa)&&!b&&(oa=zc.a.Za(oa),oa.vb(14),oa=bi.moveToControllingCell(oa)),b?M=sc.SelectionFactory.vp(M.Ve.Wc.node,!1):ba=sc.SelectionFactory.vp(oa,!0)):(oa=M.Ve.Wc.node,ba=sc.SelectionFactory.vp(oa,!1));else b=h&&M.Jf||!h&&
!M.Lta?M.Ve.Wc:M.Ve.Qa,Cn.a.sma(b.node)&&(b=zc.a.Za(b.node),(oa=this.Oic(b,!1))?ba=h?sc.SelectionFactory.Yo(lx.TableNodeContext.create(oa),M.Jf):sc.SelectionFactory.vp(oa,!0):M=Le.a.yk(sc.SelectionFactory.Ir(b.currentNode),!1,!0));return ba?ba:A?Le.a.Nic(M,!1,h,!0):Le.a.EAa(M,{ZE:!h,Ju:h,iH:r,hJ:!0})}K$l(b,h,r,A){let M=b.currentSelection;var ba=null;if(b.Ww)h?1===M.Ve.Ima&&M.Jf&&M.Ve.Qa.equals(M.qza)||(ba=this.F$l(M),(ba=this.Ioi(M,ba))||M.Jf&&(M=M.k1c())):(M=b.Sha,ba=sc.SelectionFactory.vp(M.Ve.Qa.node,
!0));else if(h){var oa=(M.Jf?M.Ve.Wc:M.Ve.Qa).node;b=zc.a.Za(oa);Le.a.yv(b);Cn.a.sma(oa)&&(M.Jf&&1===M.Ve.Ima&&M.Lta?(ba=Cn.a.SA(oa).toArray(),(ba=this.Ioi(M,0<=ba.length-2?ba[ba.length-2]:null))||M.Jf&&(M=M.k1c())):(oa=this.Oic(b,!0))?ba=sc.SelectionFactory.Yo(lx.TableNodeContext.create(oa),M.Jf):M=sc.SelectionFactory.vp(b.currentNode,!0))}else ba=Le.a.yk(M,!0,!1);return ba?ba:A?Le.a.Nic(M,!0,h,!0):Le.a.bKa(M,{ZE:!h,Ju:h,iH:r,hJ:!0})}Ioi(b,h){if(!h)return null;var r=h;Xh.TableCellReader.jr(h)&&(r=
zc.a.Za(h),r.vb(14),r=this.rUb(r,!0,!0)?r.currentNode:Xh.TableCellReader.f7(h));return r?sc.SelectionFactory.Yo(lx.TableNodeContext.create(r),b.Jf):null}kam(b,h,r){let A=h.currentSelection,M=null;if(h.Ww){var ba=h.q_>h.EOa;if(r)if(2===h.length&&1===h.Sha.Ve.Ima&&ba)A=Le.a.yk(A,!0,!1);else{if(h=this.Voi(A,!0))Xh.TableCellReader.jr(h)&&(h=zc.a.Za(h),h.vb(14),h=this.rUb(h,!1,!0)),h&&(M=sc.SelectionFactory.Yo(lx.TableNodeContext.create(h),A.Jf));M||A.Jf&&(A=A.k1c())}else ba&&(A=h.Sha)}else h=r&&A.Jf?
A.Ve.Wc:A.Ve.Qa,Cn.a.sma(h.node)&&(h=zc.a.Za(h.node),(ba=this.Oic(h,!0))?M=r?sc.SelectionFactory.Yo(lx.TableNodeContext.create(ba),A.Jf):sc.SelectionFactory.vp(ba,!0):r&&(A=sc.SelectionFactory.vp(h.currentNode,!0)));return M?M:Le.a.rob(b,A,!1,r,r)}J9l(b,h,r){let A=h.currentSelection,M=null;if(h.Ww){const ba=h.q_<h.EOa;if(r)if(2===h.length&&1===h.Sha.Ve.Ima&&ba)A=Le.a.yk(A,!1,!1);else{if(h=this.Voi(A,!1))Xh.TableCellReader.jr(h)&&(h=zc.a.Za(h),h.vb(14),h=this.rUb(h,!1,!1)),h&&(M=sc.SelectionFactory.Yo(lx.TableNodeContext.create(h),
A.Jf))}else ba&&(A=h.Sha)}else h=!r||A.Jf?A.Ve.Wc:A.Ve.Qa,Cn.a.sma(h.node)&&(h=zc.a.Za(h.node),(h=this.Oic(h,!1))&&(M=r?sc.SelectionFactory.Yo(lx.TableNodeContext.create(h),A.Jf):sc.SelectionFactory.vp(h,A.Lta)));return M?M:Le.a.rob(b,A,!0,r,r)}}Object(u.a)(ZK,"TableCellSelectionStrategy",YK,[]);class GN{constructor(b){this.rM=(h,r,A,M,ba)=>{if(1===A)return 32;h=(new ep.a).create();r="";switch(ba.DialogType){case "DirectPrintPreparingPDF":r=CommonUIStrings.l_DirectPrintPreparingPDF;ba=CommonUIStrings.l_DefaultDialogTitle;
break;default:ba=CommonUIStrings.l_DefaultDialogTitle}h.message=r;h.rM(ba,null,null);return 32};this.ga=b}Wb(){this.ga.fb(ub.a.rM,mc.a.view,this.rM,1028)}}Object(u.a)(GN,"UIAutomationActor",null,[]);class HN{constructor(b,h,r,A){this.hb=b;this.VPa=h;this.mEc=r;this.Z9=A}AKg(b,h,r){return this.mEc.xqn(h)?r?!0:b&&this.hb.Eh(b)?(b=this.Bx(b.currentNode),this.VPa.XSi(b),!0):!1:!1}$Rf(b,h){return this.mEc.c4l(b,h)}fSf(b){b&&this.hb.Eh(b)&&(b=this.Bx(b.currentNode),this.VPa.ece(b))}Bx(b){return vc.a.Bx(b)}Bca(b,
h,r){this.Z9.Esj&&this.mEc.FXi(r)&&(this.Z9.Bca(b,h),b.setValue(Bd.a.YXi,!0))}vyb(){}fee(b){return this.mEc.fee(b)}get ofe(){return this.mEc.ofe}bF(){}wha(){}pye(){}get ZTj(){return!1}}Object(u.a)(HN,"WordEditorPasteStewardBridge",null,[554]);class UO{constructor(b){this.sa=new Fd.a;this.EJj="WordFileSaveAsButtonClicked";this.NJp=()=>{this.sa.raiseEvent(this.EJj,null);return 32};this.ga=b}Wb(){y.AFrameworkApplication.J.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.qa(Hc.a.Eck,xe.a.frame,this.NJp)}e3k(b){this.sa.addHandler(this.EJj,
b)}}Object(u.a)(UO,"WordFileSaveAsActor",null,[]);class IN extends Xx{constructor(){super()}FTc(b,h,r,A,M,ba,oa){return Dq.a.buc(h,r,A,M,ba,oa)}}Object(u.a)(IN,"WordIndentationActorExtension",Xx,[]);class JN{constructor(b){this.eA=b;this.rxc=()=>32;this.Lee=(h,r,A)=>{if(1===A)return 1===this.eA.Et?32:8}}Wb(){const b=y.AFrameworkApplication.va;b.qa(ub.a.rxc,mc.a.view,this.rxc);b.qa(ub.a.Lee,mc.a.view,this.Lee)}}Object(u.a)(JN,"LineNumberingActor",null,[]);class KN extends ug.a{constructor(b){super(!1,
!1,!0);this.X2f=b;this.Twl=this.X2f.K3o}$9o(){const b=Box4Intl.Box4Strings.l_KeyboardShortcutsDialogTitle;this.Ed=null;const h={["id"]:"KeyboardShortcutsDialog",["bodyControls"]:{defaultCheckbox:!0,renderOverrideShortcutsSection:!0,prioritySection:"section2"},["shortcuts"]:this.Twl};this.gi(b,this.zhk.bind(this),h)}zhk(){}}Object(u.a)(KN,"KeyboardShortcutsDialog",ug.a,[]);class LN{constructor(){this.OEh=[];this.jLl()}get K3o(){return this.OEh}jLl(){this.HVk();this.CXk();this.PYk();this.d_k();this.p_k();
this.ZZk();this.rVk()}get Go(){return X.a.om?"\u2318":"Ctrl"}get xoa(){return X.a.om?"Option":"Alt"}get zTf(){return this.Go+"+X"}get yTf(){return this.Go+"+C"}get ATf(){return this.Go+"+V"}get z3m(){return this.Go+"+Z"}get c3m(){return this.Go+"+Y"}get n2m(){return this.Go+"+B"}get y2m(){return this.Go+"+I"}get y3m(){return this.Go+"+U"}get o2m(){return this.Go+"+K"}get Y2m(){return this.Go+"+/"}get B2m(){return this.Go+"+L"}get e3m(){return this.Go+"+R"}get p2m(){return this.Go+"+E"}get z2m(){return this.Go+
"+J"}get w2m(){return this.Go+"+>"}get r2m(){return this.Go+"+<"}get u3m(){return this.Go+"+X"}get t3m(){return this.Go+"+["}get v2m(){return this.Go+"+]"}get I2m(){return"\u2192"}get H2m(){return"\u2190"}get K2m(){return this.Go+"+\u2192"}get J2m(){return this.Go+"+\u2190"}get S2m(){return"\u2191"}get F2m(){return"\u2193"}get T2m(){return this.Go+"+\u2191"}get G2m(){return this.Go+"+\u2193"}get R2m(){return"Home"}get N2m(){return"End"}get P2m(){return"Fn+\u2191"}get O2m(){return"Fn+\u2193"}get Q2m(){return this.Go+
"+Home"}get M2m(){return this.Go+"+End"}get L2m(){return this.Go+"+F6"}get m2m(){return"Tab"}get E2m(){return"Tab"}get t2m(){return"Enter"}get q2m(){return this.Go+"+F3"}get i3m(){return"Shift+\u2192"}get h3m(){return"Shift+\u2190"}get k3m(){return"Shift+"+this.Go+"+\u2192"}get j3m(){return"Shift+"+this.Go+"+\u2190"}get p3m(){return"Shift+\u2191"}get f3m(){return"Shift+\u2193"}get q3m(){return"Shift+"+this.Go+"+\u2191"}get g3m(){return"Shift+"+this.Go+"+\u2193"}get o3m(){return"Shift+Home"}get m3m(){return"Shift+End"}get n3m(){return"Shift+"+
this.Go+"+Home"}get l3m(){return"Shift+"+this.Go+"+End"}get r3m(){return this.Go+"+A"}get x2m(){return this.Go+"+M"}get w3m(){return this.Go+"+Shift+E"}get k2m(){return this.Go+"+"+this.xoa+"+="}get d3m(){return this.Go+"+"+this.xoa+"+-"}get b3m(){return this.Go+"+"+this.xoa+"+9"}get V2m(){return this.Go+"+"+this.xoa+"+0"}get l2m(){return this.Go+"+Shift+A"}get C2m(){return this.Go+"+F6"}get D2m(){return this.Go+"+Shift+F6"}get u2m(){return Box4Intl.Box4Strings.l_PressShortcutsDialog+" "+this.xoa+
"+Q "+Box4Intl.Box4Strings.l_ThenEnterTheCommandShortcutsDialog}get s2m(){return this.xoa+"+Windows"}get x3m(){return this.Go+"+Shift+F10"}get X2m(){return this.Go+"+F8"}get W2m(){return this.Go+"+F9"}get s3m(){return this.xoa+"+F12"}get A2m(){return this.Go+"+"+this.xoa+"+F7"}get v3m(){return this.Go+"+Shift+Y"}get U2m(){return this.Go+"+"+this.xoa+"+G"}get Z2m(){return Box4Intl.Box4Strings.l_PressShortcutsDialog+" "+this.Go+"+"+this.xoa+"+Space "+Box4Intl.Box4Strings.l_WhenDialogIsOpenShortcutsDialog}get $2m(){return this.xoa+
"+\u2193"}HVk(){this.pl(Box4Intl.Box4Strings.L_Cut,this.zTf,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.L_Copy,this.yTf,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.L_Paste,this.ATf,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_UndoShortcutDialogDescription,this.z3m,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_RedoShortcutDialogDescription,
this.c3m,Box4Intl.Box4Strings.l_BasicEditingSectionInShortcutsDialog)}CXk(){this.pl(Box4Intl.Box4Strings.l_BoldShortcutDialogDescription,this.n2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_ItalicsShortcutDialogDescription,this.y2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_UnderlineShortcutDialogDescription,this.y3m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_BulletedListShortcutDialogDescription,
this.o2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_NumberedListShortcutDialogDescription,this.Y2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_AlignLeftShortcutDialogDescription,this.B2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_AlignRightShortcutDialogDescription,this.e3m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_AlignCenteredShortcutDialogDescription,
this.p2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_JustifyShortcutDialogDescription,this.z2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_IncreaseFontSizeShortcutDialogDescription,this.w2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_DecreaseFontSizeShortcutDialogDescription,this.r2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_StrikethroughShortcutDialogDescription,
this.u3m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_ShrinkFontSizeShortcutDialogDescription,this.t3m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_GrowFontSizeShortcutDialogDescription,this.v2m,Box4Intl.Box4Strings.l_FormattingSectionInShortcutsDialog)}PYk(){this.pl(Box4Intl.Box4Strings.l_MoveRightOneCharacterShortcutDialogDescription,this.I2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveLeftOneCharacterShortcutDialogDescription,
this.H2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveRightOneWordShortcutDialogDescription,this.K2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveLeftOneWordShortcutDialogDescription,this.J2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveUpOneLineShortcutDialogDescription,this.S2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveDownOneLineShortcutDialogDescription,
this.F2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveUpOneParagraphShortcutDialogDescription,this.T2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveDownOneParagraphShortcutDialogDescription,this.G2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveToStartOfLineShortcutDialogDescription,this.R2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveToEndOfLineShortcutDialogDescription,
this.N2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveToPreviousPageShortcutDialogDescription,this.P2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveToNextPageShortcutDialogDescription,this.O2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveToStartOfDocumentShortcutDialogDescription,this.Q2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveToEndOfDocumentShortcutDialogDescription,
this.M2m,Box4Intl.Box4Strings.l_NavigationSectionInShortcutsDialog)}d_k(){this.pl(Box4Intl.Box4Strings.l_MoveRibbonDocumentContentShortcutDialogDescription,this.L2m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_ActivateDifferentRibbonTabShortcutDialogDescription,this.m2m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveAmongRibbonCommandsShortcutDialogDescription,this.E2m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);
this.pl(Box4Intl.Box4Strings.l_ExecuteCurrentRibbonCommandShortcutDialogDescription,this.t2m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_CollapseExpandRibbonShortcutDialogDescription,this.q2m,Box4Intl.Box4Strings.l_RibbonNavigationSectionInShortcutsDialog)}p_k(){this.pl(Box4Intl.Box4Strings.l_SelectRightOneCharacterShortcutDialogDescription,this.i3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectLeftOneCharacterShortcutDialogDescription,
this.h3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectRightOneWordShortcutDialogDescription,this.k3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectLeftOneWordShortcutDialogDescription,this.j3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectUpOneLineShortcutDialogDescription,this.p3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectDownOneLineShortcutDialogDescription,
this.f3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectUpOneParagraphShortcutDialogDescription,this.q3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectDownOneParagraphShortcutDialogDescription,this.g3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectToStartOfLineShortcutDialogDescription,this.o3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectToEndOfLineShortcutDialogDescription,
this.m3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectToStartOfDocumentShortcutDialogDescription,this.n3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_SelectToEndOfDocumentShortcutDialogDescription,this.l3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_WholeDocumentShortcutDialogDescription,this.r3m,Box4Intl.Box4Strings.l_SelectionSectionInShortcutsDialog)}ZZk(){this.pl(Box4Intl.Box4Strings.l_InsertCommentShortcutDialogDescription,
this.x2m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_ToggleChangeTrackingShortcutShortcutDialogDescription,this.w3m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_AcceptChangeShortcutDialogDescription,this.k2m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_RejectChangeShortcutDialogDescription,this.d3m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_PreviousChangeShortcutDialogDescription,
this.b3m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_NextChangeShortcutDialogDescription,this.V2m,Box4Intl.Box4Strings.l_ReviewSectionInShortcutsDialog)}rVk(){this.pl(Box4Intl.Box4Strings.l_AccessibilityHelpShortcutDialogDescription,this.l2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_MoveAmongLandmarkRegionsShortcutDialogDescription,this.C2m+" "+Box4Intl.Box4Strings.l_OrStringShortcutsDialog+" "+this.D2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);
this.pl(Box4Intl.Box4Strings.l_GoToTellMeBoxShortcutDialogDescription,this.u2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_DisplayHideKeytipShortcutDialogDescription,this.s2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_ToggleTooltipShortcutDialogDescription,this.x3m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_NextFootNoteShortcutDialogDescription,this.X2m,
Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_NextEndNoteShortcutDialogDescription,this.W2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_ShowNextCommentShortcutDialogDescription,this.s3m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_LaunchAccessibilityCheckerShortcutDialogDescription,this.A2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_ToggleAnnouncementShortcutDialogDescription,
this.v3m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_NavigateFirstGraphicObjectShortcutDialogDescription,this.U2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_OpenDialogueMenuShortcutDialogDescription,this.Z2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog);this.pl(Box4Intl.Box4Strings.l_OpenSuggestionShortcutDialogDescription,this.$2m,Box4Intl.Box4Strings.l_AccessibilitySectionInShortcutsDialog)}pl(b,
h,r){this.OEh.push({description:b,shortcut:h,section:r,overrideBrowserShortcut:""})}}Object(u.a)(LN,"KeyboardShortcutsCollection",null,[]);class MN{constructor(b){this.Qb=this.Qb=b}Wb(){this.Qb.qa(Hc.a.m5i,mc.a.view,this.Pik.bind(this))}Pik(b,h,r){if(1===r)return 32;this.yyn=new LN;(new KN(this.yyn)).$9o();return 32}}Object(u.a)(MN,"KeyboardShortcutsDialogActor",null,[]);class CI{constructor(b,h,r,A,M){this.Qb=b;this.Zva=h;this.Ocb=r;this.dG=A;this.fp=M;this.FFa=this.tJ=null;this.fod=(ba,oa,Ja)=>
{if(1===Ja)return 32;const {paragraphs:jb,isInsideTable:zb}=this.v7(oa,!0);if(0===jb.length)return 8;if(zb)return this.Qb.Ob(ub.a.Bzb,Ja);oa=this.zPb(jb);Ja=this.fp.Lc(15);Ja.Ab(jb[0]);Ja.Ei=ba;for(const Eb of jb)this.Ocb.kyb(Eb,[1],oa);Ja.dispose();return 32};this.lod=(ba,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:jb,isInsideTable:zb}=this.v7(oa,!0);if(0===jb.length)return 8;if(zb)return this.Qb.Ob(ub.a.Gzb,Ja);oa=this.zPb(jb);Ja=this.fp.Lc(15);Ja.Ab(jb[0]);Ja.Ei=ba;for(const Eb of jb)this.Ocb.kyb(Eb,
[0],oa);Ja.dispose();return 32};this.hod=(ba,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:jb,isInsideTable:zb}=this.v7(oa,!0);if(0===jb.length)return 8;if(zb)return this.Qb.Ob(ub.a.hfb,Ja);oa=this.zPb(jb);Ja=this.fp.Lc(15);Ja.Ab(jb[0]);Ja.Ei=ba;for(const Eb of jb)this.Ocb.kyb(Eb,[2],oa);Ja.dispose();return 32};this.kod=(ba,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:jb,isInsideTable:zb}=this.v7(oa,!0);if(0===jb.length)return 8;if(zb)return this.Qb.Ob(ub.a.ifb,Ja);oa=this.zPb(jb);Ja=this.fp.Lc(15);
Ja.Ab(jb[0]);Ja.Ei=ba;for(const Eb of jb)this.Ocb.kyb(Eb,[3],oa);Ja.dispose();return 32};this.cod=(ba,oa,Ja)=>{const {paragraphs:jb,isInsideTable:zb}=this.v7(oa,!1);return 0===jb.length?8:1===Ja&&zb?32:1!==Ja||zb?zb?this.Qb.Ob(ub.a.Dzb,Ja):8:8};this.eod=(ba,oa,Ja)=>{const {paragraphs:jb,isInsideTable:zb}=this.v7(oa,!1);return 0===jb.length?8:1===Ja&&zb?32:1!==Ja||zb?zb?this.Qb.Ob(ub.a.Ezb,Ja):8:8};this.jod=(ba,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:jb,isInsideTable:zb}=this.v7(oa,!0);if(0===
jb.length)return 8;if(zb)return this.Qb.Ob(ub.a.Fzb,Ja);oa=this.zPb(jb);Ja=this.fp.Lc(15);Ja.Ab(jb[0]);Ja.Ei=ba;for(const Eb of jb)this.Ocb.kyb(Eb,[0,1,2,3],oa);Ja.dispose();return 32};this.god=(ba,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:jb,isInsideTable:zb}=this.v7(oa,!0);if(0===jb.length)return 8;if(zb)return this.Qb.Ob(ub.a.Czb,Ja);oa=this.zPb(jb);Ja=this.fp.Lc(15);Ja.Ab(jb[0]);Ja.Ei=ba;for(const Eb of jb)this.Ocb.kyb(Eb,[4],oa);Ja.dispose();return 32};this.bod=(ba,oa,Ja)=>{if(1===Ja)return 32;
const {paragraphs:jb,isInsideTable:zb}=this.v7(oa,!0);if(0===jb.length)return 8;if(zb)return this.Qb.Ob(ub.a.ETa,Ja);oa=this.zPb(jb);Ja=this.fp.Lc(15);Ja.Ab(jb[0]);Ja.Ei=ba;for(const Eb of jb)this.Ocb.kyb(Eb,[0,1,2,3,4],oa);Ja.dispose();return 32};this.iod=(ba,oa,Ja)=>{if(1===Ja)return 32;const {paragraphs:jb,isInsideTable:zb}=this.v7(oa,!0);if(0===jb.length)return 8;if(zb)return this.Qb.Ob(ub.a.xvb,Ja);oa=this.fp.Lc(15);oa.Ab(jb[0]);oa.Ei=ba;for(const Eb of jb)this.Ocb.wsl(Eb);oa.dispose();return 32};
this.xqe=(ba,oa,Ja,jb,zb)=>{if(1===Ja)return 32;ba=cm.PageReader.instance.IQb(oa);if(!ba)return 8;const {paragraphs:Eb,isInsideTable:Sb}=this.v7(oa,!1);Sb?(Ja=new Rj,this.Qb.Pf(oa,ub.a.rNa,2,!1,void 0,Ja),this.Bjg.sca=Ja.borderColor):(oa=this.FMf(Eb,!0),this.Bjg.sca=oa&&void 0!==oa.color?Yl.a.QB(oa.color):"");oa=this.Bjg.mqb(ba,df.a.nUa);if(!oa)return 8;zb.MenuItems=oa;return 32};this.fpg=(ba,oa,Ja,jb,zb)=>{if(1===Ja)return 32;if(!zb)return 0;const {paragraphs:Eb,isInsideTable:Sb}=this.v7(oa,!1);
Ja=this.FMf(Eb,!0);jb=new Rj;Sb&&this.Qb.Pf(oa,ub.a.rNa,2,!1,void 0,jb);if(!Ja&&!Sb)return zb[Ng.a.On]=!1,32;switch(ba){case Hc.a.ese:zb[Ng.a.On]=zb.MenuItemId===this.dG.Okm(Sb?jb.lineStyle:Ja.style);break;case Hc.a.fse:zb[Ng.a.On]=zb.MenuItemId===this.dG.Rkm(Sb?jb.Iqc:Ja.size);break;case Hc.a.dse:if(!Ja){zb[Ng.a.On]=!1;break}zb[Ng.a.On]=zb.MenuItemId===this.dG.Lkm(Ja.space);break;default:return 8}return 32};this.bye=(ba,oa,Ja,jb,zb)=>{const {paragraphs:Eb,isInsideTable:Sb}=this.v7(oa,!0);if(0===
Eb.length)return 8;if(1===Ja)return Sb&&ba===Hc.a.a0b?8:32;oa=this.T1c(ba,zb);if(Sb)switch(ba){case Hc.a.lEa:return this.Qb.Pb(ub.a.xha,Ja,oa);case Hc.a.b0b:return this.Qb.Pb(ub.a.xeb,Ja,zb);case Hc.a.c0b:return this.Qb.Pb(ub.a.yeb,Ja,zb);default:return 8}Ja=this.fp.Lc(15);Ja.Ab(Eb[0]);Ja.Ei=ba;for(const nc of Eb)if(zb=this.dG.o2c(nc),(jb=this.dG.Ijc(nc))&&zb&&0!==zb.length){switch(ba){case Hc.a.lEa:jb.color=this.Zva.mka(nc,oa);this.gbd.color=jb.color;break;case Hc.a.b0b:jb.style=this.dG.Nkm(oa);
this.gbd.style=jb.style;break;case Hc.a.c0b:jb.size=this.dG.Qkm(oa);this.gbd.size=jb.size;break;case Hc.a.a0b:jb.space=this.dG.Kkm(oa),this.gbd.space=jb.space}this.Ocb.kyb(nc,zb,jb)}Ja.dispose();return 32};this.ruc=(ba,oa,Ja,jb,zb)=>{if(!this.dG)return 8;if(1===Ja)return 32;ba=this.dG.oGf();zb.MenuItems=ba;return 32};this.suc=(ba,oa,Ja,jb,zb)=>{if(!this.dG)return 8;if(1===Ja)return 32;ba=this.dG.pGf();zb.MenuItems=ba;return 32};this.bfo=(ba,oa,Ja,jb,zb)=>{if(!this.dG)return 8;if(1===Ja)return 32;
ba=this.dG.Yfm();zb.MenuItems=ba;return 32};this.S3=(ba,oa,Ja)=>{if(1===Ja)return 32;qa.StaticActiveAppFrame.za().dismissFloatie();this.FFa=new Gs(CI.Mnb,Hc.a.lEa);this.FFa.Wyb(0);return 32};this.gbd=this.dG.dJf()}get Bjg(){this.tJ||(this.tJ=new Ps(CI.Mnb),this.Vfa());return this.tJ}Vfa(){this.tJ.SG(3,Hc.a.lEa);this.tJ.SG(4,Hc.a.lEa);this.tJ.b6a(tn.a.instance,1)}Wb(){this.Muo();this.Puo();this.Ouo()}Muo(){y.AFrameworkApplication.va;this.Qb.qa(Hc.a.fod,mc.a.view,this.fod);this.Qb.Pc(Hc.a.fod,4);this.Qb.qa(Hc.a.lod,
mc.a.view,this.lod);this.Qb.Pc(Hc.a.lod,4);this.Qb.qa(Hc.a.hod,mc.a.view,this.hod);this.Qb.Pc(Hc.a.hod,4);this.Qb.qa(Hc.a.kod,mc.a.view,this.kod);this.Qb.Pc(Hc.a.kod,4);this.Qb.qa(Hc.a.cod,mc.a.view,this.cod);this.Qb.Pc(Hc.a.cod,4);this.Qb.qa(Hc.a.eod,mc.a.view,this.eod);this.Qb.Pc(Hc.a.eod,4);this.Qb.qa(Hc.a.jod,mc.a.view,this.jod);this.Qb.Pc(Hc.a.jod,4);this.Qb.qa(Hc.a.god,mc.a.view,this.god);this.Qb.Pc(Hc.a.god,4);this.Qb.qa(Hc.a.bod,mc.a.view,this.bod);this.Qb.Pc(Hc.a.bod,4);this.Qb.qa(Hc.a.iod,
mc.a.view,this.iod);this.Qb.Pc(Hc.a.iod,4)}Puo(){this.Qb.qa(Hc.a.xqe,mc.a.view,this.xqe);this.Qb.qa(Hc.a.lEa,mc.a.view,this.bye);this.Qb.Pc(Hc.a.lEa,4);this.Qb.qa(Hc.a.ese,mc.a.view,this.fpg);this.Qb.qa(Hc.a.b0b,mc.a.view,this.bye);this.Qb.Pc(Hc.a.b0b,4);this.Qb.fb(Hc.a.juj,mc.a.view,this.ruc,1124);this.Qb.qa(Hc.a.fse,mc.a.view,this.fpg);this.Qb.qa(Hc.a.c0b,mc.a.view,this.bye);this.Qb.Pc(Hc.a.c0b,4);this.Qb.fb(Hc.a.kuj,mc.a.view,this.suc,1124);this.Qb.qa(Hc.a.dse,mc.a.view,this.fpg);this.Qb.qa(Hc.a.a0b,
mc.a.view,this.bye);this.Qb.Pc(Hc.a.a0b,4);this.Qb.fb(Hc.a.iuj,mc.a.view,this.bfo,1124)}Ouo(){this.Qb.qa(Hc.a.oig,mc.a.view,this.S3);this.Qb.Pc(Hc.a.oig,4)}v7(b,h){b=kt.a.C6d(b);const r=[];let A=!0;for(const M of b)Ed.ParagraphReader.Vb(M.node)&&(r.push(M.node),Ed.ParagraphReader.OX(M.node)||(A=!1));return!h||1!==r.length||A||b.Qa.contextId!==mc.a.Vc?{paragraphs:r,isInsideTable:A}:{paragraphs:this.eCm(r[0]),isInsideTable:!1}}eCm(b){const h=this.dG.Ijc(b),r=this.dG.o2c(b);if(0===r.length||!h)return[b];
const A=[];for(var M=Ed.ParagraphReader.mg(b,!0,!1,!1);M;){var ba=this.dG.Ijc(M),oa=this.dG.o2c(M);if(ba&&this.dG.ZTh(r,oa)&&this.dG.USd(h,ba))A.push(M);else break;M=Ed.ParagraphReader.mg(M,!0,!1,!1)}M=[];for(ba=Ed.ParagraphReader.mg(b,!1,!1,!1);ba;){oa=this.dG.Ijc(ba);const Ja=this.dG.o2c(ba);if(oa&&this.dG.ZTh(r,Ja)&&this.dG.USd(h,oa))M.push(ba);else break;ba=Ed.ParagraphReader.mg(ba,!1,!1,!1)}return[...A.reverse(),b,...M]}FMf(b,h=!1){if(0!==b.length){var r=this.dG.Ijc(b[0]);for(const A of b)if(b=
this.dG.Ijc(A),h)r=this.Mnm(r,b);else if(!this.dG.USd(r,b)){r=void 0;break}return r}}Mnm(b,h){if(b&&h)return{color:b.color===h.color?b.color:void 0,style:b.style===h.style?b.style:void 0,size:b.size===h.size?b.size:void 0,space:b.space===h.space?b.space:void 0}}T1c(b,h){var r="";if(!h)return r;switch(b){case Hc.a.lEa:r=(r="object"===typeof h?h:null)&&"Color"in r?r.Color:h;break;case Hc.a.b0b:case Hc.a.c0b:case Hc.a.a0b:(h="object"===typeof h?h:null)&&"MenuItemId"in h&&(r=h.MenuItemId)}return r}zPb(b){b=
this.FMf(b);b||(b=this.gbd);b||(b=this.dG.dJf());return b}}CI.Mnb="ParagraphBorder";Object(u.a)(CI,"ParagraphBorderActor",null,[]);var VO=d(764),WO=d(1137);class fC extends gl.a{constructor(b,h,r,A){super();this.Mvk="CommonControlChevronDown_12";this.Hrk="CommonControlChevronRight_12";this.SDc="aria-label";this.Z$b="role";this.$nk="alt";this.Oma=M=>{if(null===M)return!1;this.JEb.get(M.Ef).style.visibility="visible";return!0};this.Pma=M=>{if(null===M)return!1;this.JEb.get(M.Ef).style.visibility="collapse";
return!0};this.JEb=new Map;this.ml=b;this.Fg=h;this.od=r;this.Ivk=A}Q_a(b){b=this.aK(b);return WO.a.Ckn(b)}DUa(b){const h=[];h.push(this.Wea(b.V3));return h}Wea(b){var h;const r=this.aK(b),A=r.oMb;if(A){var M=b.Jh.ownerDocument,ba=Hm.a.createElement(M,io.a.div);ba.className=fC.Lvk;M=this.PHl(M,A.oTb);ba.appendChild(M);this.$Wf(ba,M,A.oTb);var oa=null===(h=this.od.Ke)||void 0===h?void 0:h.dOb;this.sqn(b.htmlElement,oa)?this.$Wf(oa,M,A.oTb):this.$Wf(b.htmlElement,M,A.oTb);this.Fg.YI(zd.a.click,M,this.sua.bind(this),
r);return ba}}PHl(b,h){const r=Hm.a.createElement(b,io.a.div);r.className=fC.Kvk;r.title=h?WordRibbonStrings.CollapsedHeadingExpandButtonTooltip:WordRibbonStrings.ExpandedHeadingCollapseButtonTooltip;r.style.visibility=h?"visible":"collapse";r.setAttribute(this.Z$b,"img");r.setAttribute(this.$nk,r.title);r.setAttribute(this.SDc,r.title);b=Hm.a.createElement(b,io.a.div);b.className=fC.Jvk;VO.a.renderIcon(h?this.Hrk:this.Mvk,b);r.appendChild(b);return r}$Wf(b,h,r){r?(this.nvp(b),this.JEb.delete(b)):
(this.JEb.set(b,h),this.Jwo(b))}Jwo(b){this.ml.nb(zd.a.hS,b,this.Oma);this.ml.nb(zd.a.cM,b,this.Pma)}nvp(b){this.ml.xc(zd.a.hS,b,this.Oma);this.ml.xc(zd.a.cM,b,this.Pma)}sua(b){if(null===b)return!1;this.Ivk.Nnp(b.zq);return!1}aK(b){return Ed.ParagraphReader.Nv(b.Cb,!0,!1).K(0)}sqn(b,h){b=Te.a.getElementBounds(b);h=Te.a.getElementBounds(h);return null===b||null===h||b.x>h.x+h.width||h.x>b.x+b.width||b.y>h.y+h.height||h.y>b.y+b.height?!1:!0}}fC.Lvk="WordExpandCollapseIndicatorContainer";fC.Kvk="WordExpandCollapseIconContainer";
fC.Jvk="WordExpandCollapseIcon";Object(u.a)(fC,"ExpandCollapseIndicatorActor",gl.a,[385]);class gC{constructor(b=gC.Hob){this.color=b}}gC.Hob=0;gC.IBo=Yl.a.auto;Object(u.a)(gC,"ParagraphShadingProperties",null,[]);class rz{constructor(b,h,r,A,M,ba){this.Qb=b;this.Zva=h;this.VP=r;this.Yrj=A;this.Bao=M;this.fp=ba;this.v4h=this.CWd=null;this.nfo=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;if(2===jb&&!Eb)return 8;oa=cm.PageReader.instance.IQb(Ja);if(!oa)return 8;Ja="";jb={};32===this.Qb.Pb(Hc.a.$id,2,jb)&&
(Ja=jb[rz.kDa]);this.Xrj.sca=Ja;this.VP.iBc(Ja);oa=this.Xrj.mqb(oa,df.a.nUa);if(!oa)return 8;Eb.MenuItems=oa;return 32};this.g0o=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;this.Qb.Pb(Hc.a.s4,2,Eb);this.VP.zTa(this.tvi(Eb))||v.ULS.sendTraceTag(508151187,340,50,"Color selected from Recent Colors section. Menu: {0}",rz.kDa);return 32};this.$id=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;const {paragraphs:Sb,isInsideTable:nc}=this.v7(Ja);if(0===Sb.length)return 32;if(nc){oa={};if(32===this.Qb.Pf(Ja,ub.a.Xwb,2,
void 0,zb,oa,void 0)){Ja=oa[rz.lol];if(!Ja)return 8;Eb[rz.kDa]=Yl.a.QB(Ja);return 32}return 8}Ja=this.YLm(Sb);if(!Ja)return 8;Eb[rz.kDa]=Ja;return 32};this.IAg=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;jb=this.tvi(Eb);if(!jb)return 8;const {paragraphs:Sb,isInsideTable:nc}=this.v7(Ja);if(0===Sb.length)return 32;Eb=(Eb="object"===typeof Eb?Eb:null)&&"SourceControlId"in Eb&&"AutomaticParagraphShadingColor"===Eb.SourceControlId;if(nc)return this.Qb.Pf(Ja,Eb?ub.a.X6a:ub.a.G8,2,void 0,zb,jb,void 0);Ja=this.fp.Lc(15);
Ja.Ab(Sb[0]);Ja.Ei=oa;for(const Dc of Sb)oa=new gC(Eb?Yl.a.auto:this.Zva.mka(Dc,jb)),this.Yrj.IAg(Dc,oa);Ja.dispose();return 32};this.S3=(oa,Ja,jb)=>{if(1===jb)return 32;qa.StaticActiveAppFrame.za().dismissFloatie();this.v4h=new Gs(rz.kDa,Hc.a.nod);this.v4h.Wyb(0);return 32};this.ipf=(oa,Ja,jb,zb,Eb)=>{if(1===jb)return 32;const {paragraphs:Sb,isInsideTable:nc}=this.v7(Ja);if(0===Sb.length)return 32;if(nc)return this.Qb.Pf(Ja,ub.a.X6a,2,void 0,zb,Eb,void 0);Ja=this.fp.Lc(15);Ja.Ab(Sb[0]);Ja.Ei=oa;
for(const Dc of Sb)this.Yrj.ipf(Dc);Ja.dispose();return 32}}Wb(){this.Qb.qa(Hc.a.s4,mc.a.view,this.IAg);this.Qb.Pc(Hc.a.s4,1028);this.Qb.qa(Hc.a.nod,mc.a.view,this.g0o);this.Qb.Pc(Hc.a.nod,1028);this.Qb.qa(Hc.a.$id,mc.a.view,this.$id);this.Qb.Pc(Hc.a.$id,1124);this.Qb.qa(Hc.a.cye,mc.a.view,this.S3);this.Qb.Pc(Hc.a.cye,1028);this.Qb.qa(Hc.a.dye,mc.a.view,this.ipf);this.Qb.Pc(Hc.a.dye,1028);this.Qb.qa(Hc.a.Klg,mc.a.view,this.nfo);this.Qb.Pc(Hc.a.Klg,1124)}get Xrj(){this.CWd||(this.CWd=new Ps(rz.kDa),
this.Vfa(this.CWd));return this.CWd}Vfa(b){b.SG(1,Hc.a.s4);b.SG(3,Hc.a.s4);b.SG(4,Hc.a.s4);b.SG(5,Hc.a.nod);b.SG(2,Hc.a.dye);b.SG(6,Hc.a.cye);b.b6a(tn.a.instance,1)}v7(b){b=kt.a.C6d(b);const h=[];let r=!0;for(const A of b)Ed.ParagraphReader.Vb(A.node)&&(h.push(A.node),Ed.ParagraphReader.OX(A.node)||(r=!1));return{paragraphs:h,isInsideTable:r}}tvi(b){if(!b)return"";const h="object"===typeof b?b:null;return h&&"Color"in h?h.Color:b}YLm(b){if(0===b.length)return"";const h=this.fHi(b[0]);for(const r of b)if(h!==
this.fHi(r))return"";return h}fHi(b){return(b=this.Bao.XLm(b))?Yl.a.QB(b.color):""}}rz.kDa="ParagraphShading";rz.lol="CellShading";Object(u.a)(rz,"ParagraphShadingActor",null,[]);class VD{constructor(){this.BId=this.aFd=null}get name(){return"WordEditor.Actors"}init(){var b;Object(Jb.a)().Ke.Mgc=!0;y.AFrameworkApplication.va.qa(Hc.a.BIp,xe.a.frame,JK);this.Z.resolve(1106).Wb(y.AFrameworkApplication.va);Lv.instance.Wb();Tm.Wb();oo.Wb(y.AFrameworkApplication.va,this.Z.resolve(76));Ak.Wb();UD.instance.Wb();
Ci.Wb();this.Z.resolve(1107).Wb(y.AFrameworkApplication.va);this.Z.resolve(1108).Wb();this.BId=this.Z.resolve(1109);this.BId.Wb();y.AFrameworkApplication.J.$("WordEditorFormatPainterIsEnabled")&&this.Z.resolve(1110).Wb();y.AFrameworkApplication.J.$("WordEditorAutoSaveImprovementIsEnabled")&&this.Z.resolve(1111).Wb();y.AFrameworkApplication.J.$("WritingStyleIsEnabled")&&y.AFrameworkApplication.J.$("WordWritingStylesDialogIsEnabled")&&(this.EZ.wfe=!0);y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.Z.resolve(1112).Wb();y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.Z.resolve(1113).Wb();this.Z.resolve(1114).Wb();this.Z.resolve(120).Wb();this.Z.resolve(1069).Wb();this.Z.resolve(1115).Wb();this.Z.resolve(1116).Wb();this.Z.resolve(1117).Wb();this.Z.resolve(1118).Wb();this.Z.resolve(1119).Wb();this.Z.resolve(1120).Wb();this.Z.resolve(1121).Wb();this.Z.resolve(1122).Wb();
Object(Ul.a)()&&this.Z.resolve(1123).Wb();this.Z.resolve(1124).Wb();this.Z.resolve(1125).Wb(y.AFrameworkApplication.va);this.Z.resolve(1126).Wb();this.Z.resolve(1127).Wb();this.Z.resolve(1128).Wb();this.Z.resolve(1129).Wb();this.Z.resolve(1130).Wb();this.Z.resolve(1014).Wb();const h=this.Z.resolve(355);h.yNa(this.Z.resolve(1131));FM.a.Qde&&h.yNa(this.Z.resolve(1132));this.Z.resolve(1133).Wb();this.Z.resolve(1134).jrg();this.Z.resolve(1135);this.Z.resolve(1136).Wb();this.Z.resolve(1137).Wb();this.Z.resolve(1138);
this.Z.resolve(1139).Wb();this.Z.resolve(789);this.Z.resolve(1140).J0();this.Z.resolve(1141).Wb();y.AFrameworkApplication.J.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.Nuo():this.Z.resolve(1142).Wb();this.mZ.vdb(this.Tpk);this.Z.resolve(930).GZm()&&qa.StaticActiveAppFrame.za().kb.lki();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateV2ForAppWelcomeExp",!1)&&this.Z.resolve(1143).Wb();qa.StaticActiveAppFrame.za().Fe();Fu.initialize();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",
!1)&&this.Z.resolve(1144).Wb();y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",!1)&&this.Z.resolve(1145).Wb();y.AFrameworkApplication.nd("KeyboardShortcutsDialog;KeyboardShortcutsDialogCf");(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeyboardShortcutsDialog",!1))&&this.Z.resolve(1146).Wb()}dispose(){this.BId&&this.BId.dispose()}Nuo(){this.Cd.Qr.isCompleted?this.Cd&&this.Cd.isFeatureEnabled(42)&&
this.Z.resolve(1142).Wb():this.Cd.Qr.continueWith(()=>{this.Cd&&this.Cd.isFeatureEnabled(42)&&(this.Z.resolve(1142).Wb(),qa.StaticActiveAppFrame.za().Fe())})}get Vqn(){if(null==this.aFd)if(this.Cd)if(this.Cd.Qr.isCompleted)this.aFd=this.Cd.isFeatureEnabled(2);else return!1;else this.aFd=!1;return this.aFd}uc(b){var h,r,A,M;this.Z=b;this.Cd=b.Oa(23);this.EZ=this.Z.resolve(41);this.EZ.C$c=y.AFrameworkApplication.J.$("WordProofingSecondaryContextualMenuIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",
!1);(new HM).uc(b);b.ia(171,()=>new IM(y.AFrameworkApplication.va,ub.a.gmf,ub.a.yUc,ub.a.C6,ub.a.jkg,ub.a.paste,ub.a.b4,ub.a.Dwb)).ha();b.ia(912,()=>{const ba=b.resolve(71);return new li(!0,ba.$("SplitHyperlinkFixWithEnterIsEnabled"))}).ha();b.ia(909,()=>{const ba=b.resolve(71),oa=Ja=>!Ja.Xnc;return new vO(ba.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,ba.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,Ja=>Ja.Xnc,()=>!1,oa,oa,oa,oa,void 0,
()=>this.Vqn,Ja=>!Ja.Xnc)}).ha();b.ia("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new HN(b.resolve(164),b.resolve(953),b.resolve(1147),b.resolve(493))).as(888).ha();b.ia("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new dC(b.resolve(1024),b.resolve(23))).as(885).ha();b.ia("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new JM).as(887).ha();b.ia(1065,()=>new KM(y.AFrameworkApplication.va)).ha();b.ia(1066,()=>new LM(y.AFrameworkApplication.va)).ha();
b.ia(827,()=>new MM(y.AFrameworkApplication.va)).ha();b.ia(1064,()=>new bM(y.AFrameworkApplication.va)).ha();b.ia(1119,()=>new DN(y.AFrameworkApplication.va,b.rf(1063))).ha();b.ia(1137,()=>new XL(y.AFrameworkApplication.va,b.rf(1063))).ha();b.ia(1148,()=>new mN(b.resolve(815),new gP.a)).ha();b.ia(1118,()=>new bC(y.AFrameworkApplication.va,b.rf(1063),b.resolve(1148),y.AFrameworkApplication.J.$("DisablePrint"),y.AFrameworkApplication.J.jb("IrmPolicyDescription"),b.resolve(677))).ha();b.ia(1120,()=>
new QO(y.AFrameworkApplication.va,b.rf(1067),b.resolve(1149),sr.a.instance,b.resolve(34))).ha();b.ia(1115,()=>new vN(y.AFrameworkApplication.va,b.rf(1063),sr.a.instance)).ha();b.ia(1117,()=>new dN(y.AFrameworkApplication.va,b.rf(1063),sr.a.instance)).ha();b.ia(1107,()=>new zu.a(b.Ra(2),qO.a.W2c())).as(1075).ha();b.ia(1116,()=>new yN(y.AFrameworkApplication.va,b.rf(1063),sr.a.instance)).ha();b.ia(1150,()=>new xI(b.resolve(652))).ha();b.register(MK,1151).ha();b.ia(1121,()=>new TK(y.AFrameworkApplication.va,
ve.a.instance,$a.a.instance.resolve(327),Ox.a.instance,$a.a.instance.resolve(43),$a.a.instance.resolve(332),$a.a.instance.resolve(38),$a.a.instance.resolve(1150),$a.a.instance.resolve(1151),this.EZ,$a.a.instance.resolve(344),y.AFrameworkApplication.J.$("WordEditorProofingIgnoreAll"),$a.a.instance.resolve(922))).ha();(y.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve(78).$D.loadScript("EditorSettingsManager")).then(()=>{const ba=b.resolve(1152);
ba.J7m();ba.init();b.ia(1154,()=>new LL(y.AFrameworkApplication.va,b.resolve(1152),()=>new jG(b.resolve(1152),b.resolve(1153)))).ha();y.AFrameworkApplication.J.$("WritingStyleIsEnabled")&&y.AFrameworkApplication.J.$("WordWritingStylesDialogIsEnabled")&&this.Z.resolve(1154).Wb()});b.ia(1122,()=>new xN($a.a.instance.resolve(1155),$a.a.instance.resolve(46).instance,$a.a.instance.resolve(76),$a.a.instance.Ra(2))).as(1062).ha();Object(Ul.a)()&&b.ia(1123,()=>new JN($a.a.instance.resolve(76))).ha();b.ia(1124,
()=>new hN(y.AFrameworkApplication.va,y.AFrameworkApplication.J,yx.a.Psa(),!!df.a.instance&&df.a.instance.ELa,!!df.a.instance&&df.a.instance.W$c,$a.a.instance.resolve(113),$a.a.instance.resolve(38),$a.a.instance.resolve(483),!!df.a.instance&&df.a.instance.Bta)).ha();b.ia(1156,()=>new OK(b.resolve(620)));b.ia(1134,()=>new SM(b.Ra(325),b.rf(1156),b.rf(1157),b.rf(1158))).ha();b.ia(1114,()=>new jL(y.AFrameworkApplication.va,b.Ra(7))).ha();b.ia(1125,()=>new bp(b.resolve(1022),b.Ra(51),b.resolve(1159),
b.resolve(46).instance,b.resolve(1135),b.resolve(50),b.resolve(327),b.resolve(1160),b.resolve(38),b.resolve(350),y.AFrameworkApplication.J)).as("Box4.Actors.ImageActor").ha();b.ia(1141,()=>new UO(y.AFrameworkApplication.va)).ha();b.ia(1159,()=>new TO(b.resolve(1022),y.AFrameworkApplication.J,y.AFrameworkApplication.ta.EWa,$a.a.instance.resolve(38),b.resolve(46).instance,b.resolve(50),b.resolve(394),b.resolve(23))).ha();b.ia(1106,()=>new yM($a.a.instance.resolve(625),$a.a.instance.Ra(11),$a.a.instance.Ra(205),
$a.a.instance.resolve(1099),$a.a.instance.Ra(457),$a.a.instance.resolve(82),$a.a.instance.resolve(242),$a.a.instance.resolve(164),$a.a.instance.resolve(34),$a.a.instance.resolve(323),$a.a.instance.resolve(46).instance,$a.a.instance.resolve(622))).ha();this.Z.ia("WordEditor.Actors.SWordRequestManager",()=>new VK(b.resolve(1161),b.resolve(1159),y.AFrameworkApplication.J)).as(1135).ha();b.ia("WordEditor.Actors.TableCellSelectionStrategy",()=>new ZK).as(49).ha();y.AFrameworkApplication.J.$("WordEditorFormatPainterIsEnabled")&&
b.ia("Box4.Actors.FormatPainter",()=>new KD(b.resolve(393),b.resolve(106),b.resolve(101),b.resolve(349),b.resolve(164),b.resolve(323),ve.a.instance,b.resolve(23),b.resolve(46).instance,b.resolve(39).instance,b.resolve(377),b.resolve(8),b.resolve(20))).as(95).ha();b.ia(1110,()=>new Wk(qa.StaticActiveAppFrame.za(),rd.FocusManager.instance(),y.AFrameworkApplication.va,Wg.a.instance,kt.a.instance,b.resolve(95),b.resolve(327),!0,b.resolve(96),!!df.a.instance&&df.a.instance.Bta,b.resolve(483))).ha();b.ia(1126,
()=>new oN(y.AFrameworkApplication.va,b.resolve(10))).ha();b.ia(1127,()=>new GN(y.AFrameworkApplication.va)).ha();b.ia(1111,()=>new CN(y.AFrameworkApplication.va,b.resolve(55))).ha();b.ia(1096,()=>new uI(b.Oa(70),b.rf(50),b.Ra(51))).ha();b.ia(936,()=>new EA(cm.PageReader.instance,b.rf(50),b.resolve(42))).ha();b.ia(1128,()=>new HA(b.resolve(956),b.resolve(990),b.resolve(101),b.resolve(994),b.resolve(625),b.resolve(323),b.resolve(42),b.resolve(8),y.AFrameworkApplication.va,y.AFrameworkApplication.J.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),
b.resolve(1162))).ha();b.ia(1133,()=>new TM(y.AFrameworkApplication.va,b.rf(1063),rd.FocusManager.instance())).ha();b.ia("Box4.Actors.FontNameFormattingStrategyNoop",()=>new NM).as(919).ha();b.ia("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new NL(y.AFrameworkApplication.Ge,Object(fn.a)(),b.resolve(323),b.resolve(42),b.resolve(164),b.resolve(386),b.resolve(1022),$a.a.instance.resolve(38),y.AFrameworkApplication.J,b.resolve(23))).as(1138).ha();b.ia(1142,()=>new cC(y.AFrameworkApplication.va,
y.AFrameworkApplication.J,b.resolve(1138),b.resolve(1022),b.resolve(394),b.resolve(50),b.resolve(323),b.resolve(42),b.resolve(164),b.resolve(386),b.resolve(1161),y.AFrameworkApplication.Ge,this.Cd,b.resolve(864))).ha();b.ia(1098,()=>new $F).ha();b.ia(1129,()=>new fN(y.AFrameworkApplication.va,b.resolve(952),b.resolve(110))).ha();b.ia(1014,()=>new RD(b.resolve(929),y.AFrameworkApplication.va,b.resolve(164))).ha();b.ia(1130,()=>new cN(qa.StaticActiveAppFrame.za(),y.AFrameworkApplication.va,$f.a.instance,
b.resolve(930),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.ed),this.Z.resolve(355),this.Z.resolve(42),this.Z.resolve(731),this.Z.resolve(1131),Ox.a.instance,this.Z.Ra(2),b.resolve(197),Object(Jb.a)(),this.Z.rf(1063),this.Z.resolve(381),ve.a.instance)).ha();b.ia(1131,()=>new Mv(b.resolve(164),Nc.a.instance,this.Z.resolve(373),b.resolve(186),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb.Jc))).ha();FM.a.Qde&&b.ia(1132,()=>new fC(ee.a.instance,Nc.a.instance,Object(Jb.a)(),b.resolve(1163))).ha();b.ia(1105,
()=>new SD).ha();b.ia(1101,()=>new aC($f.a.instance,b.resolve(18),Object(Jb.a)(),Te.a.getElementBounds,b.resolve(1078))).ha();b.ia(1108,()=>new Gr(y.AFrameworkApplication.va,b.resolve(50),y.AFrameworkApplication.J,b.resolve(1024),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).as(1108).ha();b.ia(1078,()=>new RM).as("Box4.UI.IFloatieManager").ha();b.ia(1140,()=>new TF(y.AFrameworkApplication.J,y.AFrameworkApplication.va)).as(1140).ha();
b.ia(789,()=>new OD(b.resolve(1078),b.resolve(211),Object(Jb.a)(),qv.a.instance(),y.AFrameworkApplication.ta,b.resolve(1101),b.resolve(71),b.resolve(897),df.a.ff.Pl.jf(12),b.resolve(201),b.resolve(731),b.resolve(26),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).ha();b.ia("Box4.Actors.WordIndentationActorExtension",()=>new IN).as(932).ha();y.AFrameworkApplication.J.$("SharedUXThemingIsEnabled")&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",
!1)&&b.ia(1112,()=>new aM(y.AFrameworkApplication.va)).ha();y.AFrameworkApplication.J.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ia(1113,()=>new aG(y.AFrameworkApplication.va)).ha();(new uO).uc(b);b.ia(1164,()=>new QM(b.resolve(1032),b.resolve(1037))).as(1164).ha();b.ia(1165,()=>new wO(y.AFrameworkApplication.va,b.resolve(1037),new wk.b)).ha();b.ia(1109,()=>new PM(y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.resolve(1164),b.resolve(1165),b.resolve(1024),ve.a.instance,b.resolve(4),
y.AFrameworkApplication.J.$("GetCustomHeaderEnabled")?$a.a.instance.resolve(725):void 0,y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoFromRibbonIfDisabled",!1)?b.resolve(665):void 0)).ha();(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateV2ForAppWelcomeExp",!1))&&b.ia(1143,()=>new wN(y.AFrameworkApplication.va,b.Ra(1166),b.resolve(101),b.resolve(377),b.resolve(32),b.resolve(16))).ha();
null!==(A=null===(r=y.AFrameworkApplication.J)||void 0===r?void 0:r.$("PageLoadStatsDialogIsEnabled"))&&void 0!==A&&A&&d.e(14).then(d.bind(null,2165)).then(ba=>{(new ba.PageLoadStatsActor(()=>b.resolve(586))).Wb()});this.Tpk=new vI;this.mZ=this.Z.resolve(373);y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1)&&this.Z.ia(1144,()=>new CI(y.AFrameworkApplication.va,Pk.a.instance,this.Z.resolve(1167),this.Z.resolve(1168),this.Z.resolve(42))).ha();
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",!1)&&this.Z.ia(1145,()=>new rz(y.AFrameworkApplication.va,Pk.a.instance,this.Z.resolve(790),this.Z.resolve(1169),this.Z.resolve(1170),this.Z.resolve(42))).ha();y.AFrameworkApplication.nd("KeyboardShortcutsDialog;KeyboardShortcutsDialogCf");(null===(M=y.AFrameworkApplication.J)||void 0===M?0:M.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeyboardShortcutsDialog",!1))&&b.ia(1146,()=>new MN(y.AFrameworkApplication.va)).ha()}static main(){E.a.instance.Mc(new VD)}}
Object(u.a)(VD,"WordEditorActorsPackage",null,[0,1]);class dM{constructor(b){this.KEd=!1;this.tlj=()=>{this.KEd=!0;this.xu.que(this.tlj)};this.xu=b;this.xu.wmb(this.tlj)}}Object(u.a)(dM,"GraphFullyConnectedGetter",null,[380]);class wg{constructor(){this.bth=Object.assign(new Ip.a,{})}KWk(b,h){let r;const A=b&1023;({value:r}=this.bth.Ec(A,0)).returnValue||wg.STm().contains(A)||v.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,A);r+=h;this.bth.W(A,r);return r}static STm(){wg.LNd||
(wg.LNd=new Pa.a,wg.pc(0),wg.pc(1),wg.pc(2),wg.pc(3),wg.pc(4),wg.pc(5),wg.pc(6),wg.pc(7),wg.pc(8),wg.pc(9),wg.pc(10),wg.pc(11),wg.pc(12),wg.pc(13),wg.pc(14),wg.pc(15),wg.pc(16),wg.pc(17),wg.pc(18),wg.pc(19),wg.pc(20),wg.pc(21),wg.pc(22),wg.pc(23),wg.pc(24),wg.pc(25),wg.pc(26),wg.pc(27),wg.pc(28),wg.pc(29),wg.pc(30),wg.pc(31),wg.pc(32),wg.pc(33),wg.pc(34),wg.pc(35),wg.pc(36),wg.pc(37),wg.pc(38),wg.pc(39),wg.pc(40),wg.pc(41),wg.pc(42),wg.pc(43),wg.pc(44),wg.pc(45),wg.pc(46),wg.pc(47),wg.pc(48),wg.pc(49),
wg.pc(50),wg.pc(51),wg.pc(52),wg.pc(53),wg.pc(54),wg.pc(55),wg.pc(56),wg.pc(57),wg.pc(58),wg.pc(59),wg.pc(60),wg.pc(61),wg.pc(62),wg.pc(63),wg.pc(64),wg.pc(65),wg.pc(66),wg.pc(67),wg.pc(68),wg.pc(69),wg.pc(70),wg.pc(71),wg.pc(72),wg.pc(73),wg.pc(74),wg.pc(75),wg.pc(76),wg.pc(77),wg.pc(78),wg.pc(79),wg.pc(80),wg.pc(81),wg.pc(82),wg.pc(83),wg.pc(84),wg.pc(85),wg.pc(86),wg.pc(87),wg.pc(88),wg.pc(89),wg.pc(90),wg.pc(91),wg.pc(92),wg.pc(93),wg.pc(94),wg.pc(95),wg.pc(96),wg.pc(97),wg.pc(98),wg.pc(99),wg.pc(100),
wg.pc(101),wg.pc(102),wg.pc(103),wg.pc(104),wg.pc(105),wg.pc(106),wg.pc(107),wg.pc(108),wg.pc(109),wg.pc(110),wg.pc(111),wg.pc(112),wg.pc(113),wg.pc(114),wg.pc(115),wg.pc(116),wg.pc(117),wg.pc(118),wg.pc(119),wg.pc(120),wg.pc(121),wg.pc(122),wg.pc(124),wg.pc(126),wg.pc(127),wg.pc(128),wg.pc(129),wg.pc(130),wg.pc(131),wg.pc(132),wg.pc(133),wg.pc(134),wg.pc(135),wg.pc(136),wg.pc(140),wg.pc(145),wg.pc(146),wg.pc(147));return wg.LNd}static pc(b){wg.LNd.add(b&1023)}}wg.LNd=null;Object(u.a)(wg,"LanguagePerParagraphModel",
null,[]);class XO{constructor(){this.dDg=!1;this.oVd=this.nVd=this.D3b=0;this.a4i=!0;this.uMp=0}}Object(u.a)(XO,"UpdateWordCountStateResult",null,[]);class NN extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(u.a)(NN,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class cG{constructor(){this.a1h=this.$0h=this.wordCount=-1;this.cOb=this.rXh=0;this.bOb=1;this.Trj=1033}}Object(u.a)(cG,"WordCountCache",null,[]);class ON extends Sys.EventArgs{constructor(b){super();this.state=
b}}Object(u.a)(ON,"WordCountChangedEventArg",Sys.EventArgs,[]);class DI{constructor(){this.QBc=this.yIa=0}}Object(u.a)(DI,"CharsCountResult",null,[]);class YO{constructor(){this.cp=0;this.SBc=null;this.kaa=this.laa=0}}Object(u.a)(YO,"TextChunkResult",null,[]);class ZO{constructor(){this.tck=this.laa=this.kaa=this.wordCount=0}}Object(u.a)(ZO,"WordCountStateForParagraph",null,[]);class PN{constructor(){this.Oca=this.OL=this.laa=this.kaa=this.mV=this.wordCount=0;this.currentNode=null;this.q_=-1;this.cp=
0;this.Ckg=[];this.bOb=this.cOb=this.C6a=this.xkg=this.ykg=0;this.EK=this.HYi=!1;this.dBb=new qb.a;this.lbb=new qb.a}}Object(u.a)(PN,"WordCountState",null,[]);class aq{constructor(b,h,r,A,M,ba){this.Bep=1E3;this.sa=new Fd.a;this.PJb=null;this.GJe=0;this.$wk="\ue000";this.VGc=!1;this.XOe=this.MOe=this.uzd=0;this.Bdh=this.Jdh=null;this.IOe=this.HOe=this.ROe=0;this.fYl=oa=>{this.PJb=null;this.Pyf(oa.em)};this.zJ=h;this.gvk=new RegExp(Pn.AParagraphNode.YB,"g");this.Nd=b;this.$i=A;this.hn=r;this.N5a=ba;
this.Y2a=M.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.$Mk=M.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.NGj()}get exn(){return!!this.PJb}get $Ua(){return this.VGc}set $Ua(b){this.VGc=b}get KQd(){return this.GJe}set KQd(b){this.GJe=b}get RXa(){return!this.GJe}get KA(){return this.uzd}get gNb(){return this.MOe}get kNb(){return this.XOe}get TNl(){return this.Jdh}get lvf(){return this.Bdh}get tYc(){return this.ROe}get rYc(){return this.HOe}get sYc(){return this.IOe}wmb(b){this.sa.addHandler(aq.JGe,
b)}que(b){this.sa.removeHandler(aq.JGe,b)}Rgf(b){this.sa.addHandler(aq.gPg,b)}YDo(b){this.sa.removeHandler(aq.gPg,b)}j_d(){this.i_d();this.NGj()}NGj(){this.ROe=this.IOe=this.HOe=this.XOe=this.MOe=this.uzd=-1}pwf(){this.YAe(this.Bep)}xqd(){const b=new PN;b.HYi=!0;this.i_d();this.Pyf(b)}YAe(b,h=null){this.RXa&&(this.exn&&(h=null,this.i_d()),h||(h=new PN),b=new wc.a(3,1,b,this.fYl,this.g0j),b.em=h,this.O0k(b))}i_d(){this.PJb&&(this.$i.uf(this.PJb),this.PJb=null)}q$j(b,h,r,A,M,ba=!0,oa=-1,Ja=-1,jb=-1,
zb=1033){const Eb=new XO;Eb.D3b=r;Eb.nVd=M;Eb.oVd=A;if(!b.cp&&h.xud&&ba&&!this.LFi(h))return aq.xDp(b,h.xud),Eb.a4i=!0,Eb;A=0<=Ja&&0<=jb?{xd:Ja,endCp:jb}:void 0;r=this.Ohm(h,A);A&&(Ja=A.xd,jb=A.endCp);r=0<=jb?r.substring(0,jb):r;jb=0<=Ja&&0<=jb?r.substring(Ja,jb):r;A=b.cp>=Ja?b.cp:Ja;M=b.Ckg||[];ba=0<b.ykg?b.ykg:0;let Sb=0<b.xkg?b.xkg:0,nc=[];b.EK=!1;do{this.N5a.update();if(!b.HYi&&(Eb.D3b+nc.length/2>aq.tJp||this.N5a.rvb())){let Gd;M=(Gd=M).concat.apply(Gd,nc);b.cp=A;b.Ckg=M;b.xkg=Sb;b.ykg=ba;b.q_=
oa;b.currentNode=h;this.YAe(aq.ZMp,b);Eb.dDg=!0;b.EK=!0;return Eb}if((!A||A===Ja)&&0<r.length&&A<r.length){M.push(AC.a.instance.fPf(r,A));var Dc=this.LFi(h);if(0<=oa&&!A&&Dc){b.wordCount+=1;Eb.D3b+=1;const Gd=this.Nd.b3(Dc);Dc=this.zJ.yed(Gd,Dc);Dc=aq.lYd(Dc);b.laa+=Dc.yIa+1;b.kaa+=Dc.yIa-Dc.QBc}}Dc=this.sKi(r,A,aq.Lrl);A=Dc.cp;let Zc;nc=(Zc=nc).concat.apply(Zc,Dc.SBc);ba+=Dc.laa;Sb+=Dc.kaa}while(-1!==A);b=this.FUk(b,M,nc,r,jb,Eb.D3b,Eb.nVd,Eb.oVd,h,-1===oa,zb);Eb.D3b=b.wordCount;Eb.nVd=b.kaa;Eb.oVd=
b.laa;Eb.uMp=b.tck;return Eb}rhi(b,h){const r=Ed.ParagraphReader.textLength(h,9);if(r){h=bm.e(h);var A=0;for(let M=0;M<h.length;M++)if(this.msb&&5===h[M].$h&&b.OL++,aq.W3o(h[M])){A++;break}h.length!==r?b.mV++:b.mV+=A}}MSj(b){this.KQd=this.v4o(b.C6a,b.wordCount)?1:0;return!!this.KQd}ypj(b){this.uzd=b.wordCount;this.MOe=b.OL;this.XOe=b.Oca;this.IOe=b.laa;this.HOe=b.kaa;this.ROe=b.mV;this.Jdh=b.dBb;this.Bdh=b.lbb;this.Myj(b)}Myj(b){this.sa.raiseEvent(aq.JGe,new ON(b))}Lyj(){this.sa.raiseEvent(aq.gPg,
new NN(!1))}v4o(b,h){if(X.a.Mt||X.a.hu||X.a.UF)return!1;(h/=2)||(h=1);return(h?b/h:0)>aq.vMn?!0:!1}get msb(){const b=!this.h8f||1===this.h8f&&this.$Mk;return this.Y2a&&b}sCi(b,h){let r=1033,A=0;b=h.fLf(b);h=new wg;for(let M=0;M<b.length;M++){const ba=h.KWk(b[M].lcid,b[M].end-b[M].Dc);A<ba&&(A=ba,r=b[M].lcid)}return r}FUk(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){var Sb;h=(Sb=h).concat.apply(Sb,r);r=AC.a.instance.uKi(h,A);b.wordCount+=r.wordCount;M=aq.lYd(M);Sb=M.yIa-M.QBc;const nc=M.yIa;b.kaa+=Sb;b.laa+=nc;ba+=
r.wordCount;oa+=M.yIa-M.QBc;Ja+=M.yIa;b.C6a+=r.C6a;const {e_l:Dc,zop:Zc}=aq.EUk(h,A);b.cOb+=Dc;b.bOb+=Zc;b.lbb.add(Eb);b.dBb.add(r.wordCount);zb&&aq.Xjl(nc,Sb,jb,r,Dc,Zc,Eb);b.cp=0;b.Ckg=[];b=new ZO;b.kaa=oa;b.laa=Ja;b.wordCount=ba;b.tck=r.wordCount;return b}Ohm(b,h){let r=this.LFo(b);r=Ed.ParagraphReader.Spb(b,9,r,h);return this.JAo(r)}LFo(b){var h=Ed.ParagraphReader.text(b);b=bm.e(b);if(0<b.length){h=h.split("");for(let A=0;A<b.length;++A){let M=!0;var r=!0;const ba=b[A];if(1===ba.$h)r=ba,r=22!==
r.kind&&2!==r.kind;else if(5===ba.$h)M=!1;else if(7===ba.$h||10===ba.$h)h[ba.Jb.cp]=this.$wk,M=!1;if(M){if(ba.Jb.cp>=h.length)return"";h[ba.Jb.cp]=r?" ":"C"}}h=h.join("")}return h}JAo(b){return b.replace(this.gvk,"")}sKi(b,h,r){const A=b.length-h<=r;var M=A?b.length:h+r;const ba=new YO;if(M<h)return ba.cp=-1,ba;ba.SBc=AC.a.instance.EHf(b,h,M);M=aq.lYd(b.substr(h,M));ba.laa=M.yIa;ba.kaa=M.yIa-M.QBc;if(!ba.SBc.length&&!A)return r===b.length-h?ba:this.sKi(b,h,b.length-h);ba.cp=A||!ba.SBc.length?-1:ba.SBc[ba.SBc.length-
1].cp;return ba}O0k(b){this.PJb=b;this.$i.Yb(this.PJb)}LFi(b){b=mf.ListItemReader.De?b:b.qE;if(mf.ListItemReader.isListItem(b)){const h=this.Nd.b3(b);if(null===h||void 0===h?0:h.$z)return b}return null}static W3o(b){return 11===b.$h}static xDp(b,h){b.wordCount+=h.wordCount;b.kaa+=h.$0h;b.laa+=h.a1h;b.C6a+=h.rXh;b.cOb+=h.cOb;b.bOb+=h.bOb;b.lbb.add(h.Trj);b.dBb.add(h.wordCount)}static Xjl(b,h,r,A,M,ba,oa){const Ja=new cG;Ja.wordCount=A.wordCount;Ja.a1h=b;Ja.$0h=h;Ja.rXh=A.C6a;Ja.cOb=M;Ja.bOb=ba;Ja.Trj=
oa;r.xud=Ja}static lYd(b){const h=b.length,r=new DI;for(let M=0;M<h;M++){var A=b.charCodeAt(M);r.yIa++;if(55296<=A&&56319>=A&&(A=M+1<h?b.charCodeAt(M+1):0,56320<=A&&57343>=A)){M++;continue}C.a.mga(b.charAt(M))&&r.QBc++}return r}static EUk(b,h){let r=0,A=0;for(let M=0;M<b.length;++M){const ba=b[M],oa=ba.gO;(3===oa||2===oa)&&ba.cp<h.length&&(++r,C.a.eoc(h.charCodeAt(ba.cp))&&++A)}return{e_l:A,zop:r}}}aq.JGe="wctek";aq.gPg="wcac";aq.ZMp=1;aq.Lrl=400;aq.tJp=90;aq.vMn=.1;Object(u.a)(aq,"WordCountManagerBase",
null,[413]);class eM extends aq{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){super(b,h,r,M,jb,zb);this.Fqi=this.aOd=this.iqa=null;this.uua=()=>{this.pwf()};this.ib=A;this.yd=oa;this.rHh=Ja;this.YK=Eb;this.ib.BA(this.uua);this.gYe=jb.$("ReadingTimeIsEnabled")}get g0j(){return 66}y$m(){if(this.iqa)return!0;if(!this.ib||!this.ib.gb)return this.yd&&(df.a.isClosing||y.AFrameworkApplication.Xl?this.yd.$b("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):
this.yd.$b("SelectionWordCountSelectionNullWhenAppAlive")),!1;const b=this.ib.gb.clone();this.iqa=b.jU(!0);if(!this.iqa||!this.iqa.nV())return this.i_d(),!1;this.rHh&&(this.aOd=this.rHh.create(h=>b.jU(h),this.hn));this.iqa.moveNext();return!0}get h8f(){return 1}GBl(b){return b===mc.a.Fd||b===mc.a.paragraph?!0:this.msb&&(b===mc.a.$Ob||b===mc.a.image||b===mc.a.V$)}Pyf(b){this.N5a.reset();if(this.y$m()){for(this.msb&&this.aOd&&(this.aOd.bYl(b,this.N5a)||this.YAe(1,b));this.iqa.current;){const A=-1===
b.q_?0:b.q_;let M=0;var h=this.iqa.current;if(!this.GBl(h.contextId)){this.iqa.moveNext();continue}if(this.msb&&je.a.cab(h)){b.OL++;this.iqa.moveNext();continue}if(!Ed.ParagraphReader.Vb(h.node)){this.iqa.moveNext();continue}const ba=h.node;if(this.$Ua&&this.Fqi&&this.Fqi.x9a(ba))this.iqa.moveNext();else{if(this.msb&&h.isValid){var r=zc.a.Za(ba);for(r.Ub(6);!r.Sr;)je.a.Lt(r.currentNode)&&b.OL++,r.Mi(6)}r=this.gYe?this.sCi(ba,this.YK):1033;h=this.q$j(b,ba,0,0,0,this.kee(h),A,h.cpBegin,h.cpEnd,r);if(h.a4i&&
(M+=1,100<M)){b.q_=A+1;this.YAe(1,b);return}if(h.dDg)return;this.rhi(b,ba);this.iqa.moveNext()}}this.aOd=this.iqa=null;this.MSj(b)?(this.uzd=-1,this.Lyj()):this.ypj(b)}}kee(b){let h=!1;b.contextId===mc.a.paragraph?h=!0:b.contextId===mc.a.Fd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(u.a)(eM,"SelectionWordCountManager",aq,[]);class Ov{constructor(b,h){this.o8b=!1;this.WIb=null;b&&h&&(this.kbc=b(!1),this.$c=h,this.kbc.moveNext())}bYl(b,h){if(!b||!this.kbc||!this.kbc.current)return!0;
do{const r=this.kbc.current;if(r.contextId===mc.a.Ru||r.contextId===mc.a.hx){for(this.WIb||this.I$m(r.node);this.WIb.moveNext();)if(14===this.WIb.currentNode.type&&b.Oca++,h.update(),h.rvb())return!1;this.gEl(r,b);this.WIb=null}this.kbc.moveNext()}while(this.kbc.current);return!0}gEl(b,h){const r=this.$c.lg(b.node);r.vb(14);b.contextId===mc.a.Ru&&(Cn.a.uYi(r)&&(this.o8b=!0),Cn.a.Jee(r)&&this.o8b&&(this.o8b=!1,h.Oca++));b.contextId===mc.a.hx&&(Xh.TableCellReader.m9c(r)&&(this.o8b=!0),Xh.TableCellReader.wXa(r)&&
this.o8b&&(this.o8b=!1,h.Oca++))}I$m(b){this.WIb=Be.a.Zo(b);14===b.type?this.WIb.Dp(Ov.F0c,b):this.WIb.Dp(Ov.F0c,null)}static F0c(b){return b.parentNode?!0:!1}}Object(u.a)(Ov,"TableCountSelectionTraverser",null,[412]);class Cx{constructor(b){this.Y2a=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.Y2a?new Ov(b,h):null}}Object(u.a)(Cx,"TableCountSelectionTraverserFactory",null,[379]);class fM extends aq{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb){super(b,h,r,M,jb,
zb);this.vJp=Sb=>{if(Sb.Sr)return!0;Sb=Sb.role;return 1===Sb||2===Sb||this.msb&&6===Sb||3===Sb||4===Sb||5===Sb||!this.$Ua&&(7===Sb||8===Sb)};this.ga=A;this.SIk=ba;this.ORk=oa;this.jdh=Ja;this.YK=Eb;this.ga.fb(Hc.a.rck,mc.a.application,kd.ActionManager.$f,64);this.ga.fb(Hc.a.sck,mc.a.application,kd.ActionManager.$f,64);this.gYe=jb.$("ReadingTimeIsEnabled")}get g0j(){return 63}get h8f(){return 0}Pyf(b){this.N5a.reset();b.EK=!1;var h=this.SIk();cm.PageReader.instance.FTb(h)||(this.j_d(),this.Lyj());
h=this.hn.Dsa(h,7,7).currentNode;var r=this.eIl(b.currentNode,h);h=this.ORk(r,h);h.Dp(this.vJp,null);let A=r=0;for(var M=0;h.moveNext();){if(h.currentNode&&(!mf.ListItemReader.De||!SE.a.Xee(h.currentNode))&&mf.ListItemReader.isListItem(h.currentNode)){var ba=this.Nd.b3(h.currentNode);if(ba.$z){var oa=mf.ListItemReader.De?h.currentNode:this.Nd.aWa(h.currentNode);if(oa&&(oa=oa.ra.last,(null===oa||void 0===oa?0:oa.ri)&&($l.a.P8&&oa.Wh||oa.QU)))continue;b.wordCount+=1;if(ba=this.zJ.yed(ba,h.currentNode))ba=
aq.lYd(ba),b.laa+=ba.yIa+1,b.kaa+=ba.yIa-ba.QBc;r+=1;A+=b.laa;M+=b.kaa}if(!mf.ListItemReader.De)continue}if(this.msb&&h.currentNode&&je.a.Lt(h.currentNode))b.OL++;else if(this.msb&&h.currentNode&&Hi.TableReader.OU(h.currentNode))b.Oca++;else if(h.currentNode&&Ed.ParagraphReader.Vb(h.currentNode)){ba=h.currentNode;oa=this.gYe?this.sCi(ba,this.YK):1033;M=this.q$j(b,ba,r,A,M,!0,-1,-1,-1,oa);if(M.dDg){b.EK=!0;return}this.rhi(b,ba);r=M.D3b;A=M.oVd;M=M.nVd}}this.MSj(b)?(this.j_d(),this.GGo(),this.Myj(b)):
this.ypj(b)}eIl(b,h){b?(b=this.jdh(b),b.vb(7)):b=this.jdh(h);return b}GGo(){switch(this.KQd){case 1:this.ga.Ob(Hc.a.rck,2);break;case 2:this.ga.Ob(Hc.a.sck,2)}}}Object(u.a)(fM,"TotalWordCountManager",aq,[]);class QN{constructor(){this.KLj=this.JLj=this.Pxg=this.LLj=this.r2j=this.s2j=this.p2j=this.q2j=0}get wij(){return this.Bkc(this.LLj,this.s2j,"WC")}get iVn(){return this.Bkc(this.JLj,this.p2j,"NumCharsNoSp")}get jVn(){return this.Bkc(this.Pxg,this.q2j,"NumCharsWithSp")}get oVn(){return this.Bkc(this.KLj,
this.r2j,"NumParagraphs")}Bkc(b,h,r){const A=this.bud(h,r).toLocaleString();return 0<this.Pxg?(b=this.fOg(b,h,r),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),A)):A}fOg(b,h,r){b=this.bud(b,r);return b>h?(v.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",r),h):b}bud(b,h){0>b&&v.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(u.a)(QN,"DocumentStats",null,[]);class $K{static jtf(b){return ug.a.ry($K.Qn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,
b.wij,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.iVn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.jVn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.oVn)}}$K.Qn="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(u.a)($K,"DocumentStatsDialogHtml",null,[]);class aL extends ug.a{constructor(b){super();this.cW=!1;this.JYl=()=>{};this.XH=b}$8o(){this.Pg="DocumentStatsDialog";this.lh=$K.jtf(this.XH);this.Ed=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.JYl);this.H8("DocumentStatsTable")}Pba(){}dispose(){this.cW||(super.dispose(),this.cW=!0)}}Object(u.a)(aL,"DocumentStatsDialog",ug.a,[]);class RN{constructor(b,h,r,A,M,ba,oa,Ja,jb){this.tGh=this.HIc=this.VGc=this.n8b=this.iZe=
!1;this.ntc=()=>{this.BFe()};this.Mga=()=>{this.BFe()};this.x0o=()=>{this.tGh=!0;return 32};this.zpg=()=>this.xu.RXa?32:8;this.njd=(zb,Eb,Sb,nc,Dc)=>{if(1===Sb)return this.xu.RXa?32:8;Dc[Ng.a.On]=this.p2f;return 32};this.jDe=(zb,Eb,Sb)=>{if(1===Sb)return this.xu.RXa?32:8;this.p2f?this.KVl():this.d1l();qa.StaticActiveAppFrame.za().lJ({ShowWordCount:"CheckboxModel"});return 32};this.syc=(zb,Eb,Sb)=>{if(1===Sb)return Bl.a.dma(Eb)?8:this.xu.RXa?32:8;if(this.tGh)return y.AFrameworkApplication.va.Ob(Hc.a.Coe,
2),32;zb=this.Zd.Xf("UserAction","Show Word Count Dialog");zb.start();this.xu.xqd();this.BT.xqd();this.xu.KA!==this.BT.KA?v.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):v.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Eb=this.vGl();(new aL(Eb)).$8o();zb.stop();return 32};this.Did=(zb,Eb,Sb,nc,Dc)=>{Dc||v.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===Sb)return 32;if(!this.xu.RXa)return Dc[al.a.Visible]=
!1,32;Dc[al.a.Visible]=!0;this.p2f?(zb=this.xu.KA,0>zb?zb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:zb?(Eb=this.BT?this.BT.KA:-1,zb=0<Eb?this.FLm(zb,Eb):String.format(1===zb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.Yve(zb))):zb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.Yve(zb))):zb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Dc[al.a.LabelText]=zb;return 32};
this.oOe=oa;this.pOe=ba;this.xu=b;this.BT=h;this.IIb=r;this.BPk=M;this.BT.Rgf(this.ntc);this.xu.Rgf(this.ntc);this.BT.wmb(this.Mga);this.xu.wmb(this.Mga);this.Zd=Ja;this.$Ua=A;this.Y2a=jb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get gwf(){return!X.a.M7}Wb(){const b=y.AFrameworkApplication.va;b.qa(Hc.a.jDe,mc.a.application,this.jDe);b.qa(Hc.a.syc,mc.a.view,this.syc);b.fb(Hc.a.njd,mc.a.application,this.njd,96);b.fb(Hc.a.Did,mc.a.application,this.Did,96);b.fb(Hc.a.zpg,mc.a.application,
this.zpg,96);b.qa(Hc.a.Cji,mc.a.application,this.x0o)}get $Ua(){return this.VGc}set $Ua(b){this.VGc=b;this.xu.$Ua=b;this.BT.$Ua=b}d1l(){this.xu.RXa&&(this.yRj(!0),this.BFe(),this.xu.xqd())}vGl(){const b=new QN;b.s2j=this.xu.KA;b.q2j=this.xu.sYc;b.p2j=this.xu.rYc;b.r2j=this.xu.tYc;b.LLj=this.BT.KA;b.JLj=this.BT.rYc;b.Pxg=this.BT.sYc;b.KLj=this.BT.tYc;return b}hsm(){return this.oOe("WACWordCountEnabled",this.gwf)}rxe(b){this.pOe("WACWordCountEnabled",b?"true":"false",Qc.a.mMa)}get p2f(){this.n8b||(this.iZe=
this.hsm(),this.n8b=!0);return this.iZe}yRj(b){this.rxe(b);this.iZe=b;this.n8b=!0}KVl(){this.xu.j_d();this.BT.j_d();this.yRj(!1);this.BFe()}get IH(){return null!=this.u4g?this.u4g:this.u4g=(()=>this.IIb())()}BFe(){this.HIc||(v.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.JMl()),this.HIc=!0);this.IH&&this.IH.sS(this.BPk)}JMl(){const b={["words"]:this.xu.KA,["charsWithSpaces"]:this.xu.sYc,["charsWithNoSpaces"]:this.xu.rYc,["paragraphs"]:this.xu.tYc};this.Y2a&&(b.images=this.xu.gNb,
b.tables=this.xu.kNb);return b}Yve(b){try{return b.toLocaleString()}catch(h){v.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}FLm(b,h){h>b&&(v.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.Yve(h),this.Yve(b))}}Object(u.a)(RN,"WordCountActor",
null,[]);class SN extends iw.a{constructor(b,h,r,A){super();this.UN=(M,ba)=>{if(ba.property===ze.a.Yn||ba.property===ze.a.Zn)M=ba.node,ba=$l.a.Pm.kb.Jc,ba.sw&&ba.qd&&ba.qd.Ic&&M.Ic&&M.Ic.id===ba.qd.Ic.id&&this.Tki(M)};this.Lmj=(M,ba)=>{this.Tki(ba.node)};this.h2n=(M,ba)=>{ba.property!==Bd.a.iC&&ba.property!==Rc.a.Yw||this.z0()};this.yme=()=>{this.z0()};this.a$=b;this.xu=h;this.Lm=r;this.Y2a=A.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}gB(){var b=this.Lm.jf(12);b.ro(this.UN);b.wt(this.Lmj);
b.ly(this.Lmj);b=this.Lm.jf(22);b.ro(this.h2n);b.wt(this.yme);b.ly(this.yme);this.Y2a&&this.pxo();this.a$.sva(this,7)}pxo(){var b=[19,14];for(const h of b)b=this.Lm.jf(h),b.wt(this.yme),b.ly(this.yme)}get index(){return 1}run(){this.xu.pwf()}Tki(b){b.xud=null;this.z0()}}Object(u.a)(SN,"WordCountAppEventCoordinator",iw.a,[]);class gM{}gM.GUk="AccurateWordCountButton";Object(u.a)(gM,"WordCountConstants",null,[]);class $O{constructor(b,h){this.xu=b;this.BT=h}getInstance(b){switch(b){case 1:return this.BT;
case 0:return this.xu;default:return this.xu}}}Object(u.a)($O,"WordCountManagerFactory",null,[363]);class TN{constructor(){this.Z=null}get name(){return"WordEditor.WordCount"}uc(b){this.Z=b;const h=this.Z.resolve(71);this.Z.ia(1171,()=>new Cx(h)).ha();this.Z.ia(1172,()=>{var r=new $r.a(10,Te.a.Le);const A=new fM(b.resolve(10),b.resolve(244),new zk.a,y.AFrameworkApplication.va,y.AFrameworkApplication.oc,()=>$l.a.Pm.kb.Jc.qd,Be.a.Bt,zc.a.Za,h,r,$a.a.instance.resolve(332));r=new eM($a.a.instance.resolve(10),
$a.a.instance.resolve(244),new zk.a,$f.a.instance,y.AFrameworkApplication.oc,OC.a.instance,Wg.a.instance,$a.a.instance.resolve(1171),h,r,$a.a.instance.resolve(332));return new $O(A,r)}).ha();this.Z.ia("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new dM(this.Z.resolve(1172).getInstance(0))).as(513).ha()}init(){const b=qa.StaticActiveAppFrame.za().kb;b.QBa?this.Kva():b.Sja(()=>{this.Kva()})}Kva(){if(df.a.ff){var b=df.a.ff.Pl;if(b){this.Z.resolve(513);var h=this.Z.resolve(1172).getInstance(0),
r=this.Z.resolve(1172).getInstance(1),A=$a.a.instance.resolve(71);(new RN(h,r,()=>$a.a.instance.Oa(586),this.grm(),gM.GUk,Qc.a.hOa,Qc.a.tfa,$a.a.instance.resolve(38),A)).Wb();(new SN(Ls.a.instance,h,b,A)).gB();h.pwf()}else v.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else v.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}grm(){var b=$l.a.Pm.kb;if(!b)return v.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.Jc;if(!b)return v.ULS.sendTraceTag(22611552,
324,10,""),!1;b=b.qd;return b?b.ka(Rc.a.$Ua,!1):(v.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){E.a.instance.Mc(new TN)}}Object(u.a)(TN,"PackageManager",null,[0,1]);var hM=d(2112);class UN{constructor(b){this.R7e=null;b.Ra(1173).execute(h=>{this.R7e=h})}aOj(b){this.R7e&&this.R7e.DKf().handleDocumentContentAugloopAnnotation(b)}}Object(u.a)(UN,"DocumentContentExtractionManager",null,[531]);class fi{}fi.jcp="mso_smartLookup";fi.channelId="SmartLookup";fi.icp="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";
fi.NWj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";fi.OWj="https://uci.cdn.office.net/mirrored/smartlookup/";fi.hcp="https://hedwigtestserver.blob.core.windows.net/builds/";fi.gcp="http://localhost:8080/";fi.Ypd="current";fi.MWj="next";fi.R$n=2;fi.Htc=1;fi.Itc=CommonUIStrings.L_SmartLookupPaneTitle;fi.ND="InsightsTaskPane";fi.MHg="InsightsTaskPaneData";fi.cUf="InsightsContentFrame";fi.width=400;fi.TOn="ApplicationPropertiesRequest";fi.dPn="SelectionRequest";fi.ZOn="PageRendered";fi.SOn=
"ApplicationProperties";fi.cPn="Selection";fi.fPn="Telemetry";fi.ePn="TakeFocus";fi.YOn="LostFocus";fi.VOn="Keyboard";fi.WOn="LegalAgreed";fi.qMp="WordWac";fi.l7n="OneNoteWAC";fi.Wjg="yes";fi.s0j="appCorrelationId";fi.Pkp="clientCorrelationId";fi.t0j="message";fi.$6i="Microsoft::Office::Insights::LegalAgreed";Object(u.a)(fi,"InsightsConstants",null,[]);var EI=d(1579);class dG{}Object(u.a)(dG,"ActivityContractInfo",null,[]);class Fs{}Object(u.a)(Fs,"BrowserPaneDataField",null,[]);class Dx{}Object(u.a)(Dx,
"BrowserPaneTelemetryEvent",null,[]);class Nl{static mB(b,h){const r=new Dx;r.eventName="Diagnostics";r.isActivity=!1;r.activityContract=Object.assign(new dG,{success:!0});const A=[],M=new Fs;M.name="Message";M.dataType=0;M.value=b;b=new Fs;b.name="Level";b.dataType=0;b.value=Nl.getLevelString(h);Array.add(A,M);Array.add(A,b);r.dataFields=A;Nl.sendTelemetryEvent(r)}static cMj(b,h){const r=new Dx;r.eventName=b;r.isActivity=!1;r.activityContract=Object.assign(new dG,{success:!0});b=[];const A=new Fs;
A.name="AppCorrelationId";A.dataType=0;A.value=h;Array.add(b,A);r.dataFields=b;Nl.sendTelemetryEvent(r)}static vRo(b,h,r,A,M,ba){const oa=new Dx;oa.eventName="LaunchPaneWithError";oa.isActivity=!1;oa.activityContract=Object.assign(new dG,{success:!0});const Ja=[],jb=new Fs;jb.name="IsNetworkConnected";jb.dataType=0;jb.value=b?"true":"false";b=new Fs;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new Fs;h.name="EntryPoint";h.dataType=0;h.value=r;r=new Fs;r.name="RuntimeVersion";
r.dataType=0;r.value=A;A=new Fs;A.name="IsFirstRelease";A.dataType=1;A.value=M?"true":"false";M=new Fs;M.name="IsZeroTerm";M.dataType=1;M.value=ba?"true":"false";ba=new Fs;ba.name="IsClientSideRendering";ba.dataType=1;ba.value="false";Array.add(Ja,jb);Array.add(Ja,h);Array.add(Ja,b);Array.add(Ja,r);Array.add(Ja,A);Array.add(Ja,M);Array.add(Ja,ba);oa.dataFields=Ja;Nl.sendTelemetryEvent(oa)}static Txg(b,h,r){const A=new Dx;A.eventName="CDNDownloadLatency";A.isActivity=!0;A.activityContract=Object.assign(new dG,
{duration:r,success:!0});r=[];const M=new Fs;M.name="CDNHostname";M.dataType=0;M.value=b;b=new Fs;b.name="Filename";b.dataType=0;b.value=h;Array.add(r,M);Array.add(r,b);A.dataFields=r;Nl.sendTelemetryEvent(A,1)}static Rwc(b,h,r,A,M,ba,oa,Ja){const jb=new Dx;jb.eventName="LaunchPane";jb.isActivity=!0;jb.activityContract=Object.assign(new dG,{duration:h,success:!0});h=[];const zb=new Fs;zb.name="AppCorrelationId";zb.dataType=0;zb.value=b;b=new Fs;b.name="EntryPoint";b.dataType=0;b.value=r;r=new Fs;
r.name="IsServerSideRendering";r.dataType=1;r.value="true";const Eb=new Fs;Eb.name="UxVersion";Eb.dataType=0;Eb.value=A;A=new Fs;A.name="FeatureGates";A.dataType=0;A.value=M;M=new Fs;M.name="IsFirstRelease";M.dataType=1;M.value=ba?"true":"false";ba=new Fs;ba.name="IsZeroTerm";ba.dataType=1;ba.value=oa?"true":"false";oa=new Fs;oa.name="IsClientSideRendering";oa.dataType=1;oa.value=Ja?"true":"false";Array.add(h,zb);Array.add(h,b);Array.add(h,r);Array.add(h,Eb);Array.add(h,A);Array.add(h,M);Array.add(h,
ba);Array.add(h,oa);jb.dataFields=h;Nl.sendTelemetryEvent(jb)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)Nl.KFn(b.eventName);else{var r=-1<b.eventName.indexOf(Nl.r0j)?b.eventName:Nl.r0j+b.eventName,A=Nl.iqm(b.dataFields);b.isActivity?(b=Object.assign(new Dh.a,{name:r,samplingPolicy:h,dataFields:A,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),ca.a.sendActivityEvent(b)):(b=Object.assign(new ja.a,{name:r,samplingPolicy:h,dataFields:A}),ca.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";
case 15:return"Warning";default:return"Info"}}static iqm(b){const h=[];if(b&&0<b.length)for(const r of b)(b=Rg.a.Uaa(r.name,r.value,Nl.bDl(r.dataType)))&&Array.add(h,b);return h}static bDl(b){switch(b){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}static KFn(b){const h=$a.a.instance.Oa(2);h?h.logActivity(b,null):v.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Nl.r0j="Office.Insights.SmartLookup.";Object(u.a)(Nl,"TelemetryUtils",
null,[]);var FI;(function(b){b[b.other=0]="other";b[b.Dmq=1]="searchBoxSearch";b[b.xmq=2]="searchBoxDictionary";b[b.Cmq=3]="searchBoxQuickAnswer";b[b.Yoq=4]="smartLookupRibbon";b[b.Xoq=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.F_p=7]="dictionary";b[b.web=8]="web";b[b.Tiq=9]="pictures";b[b.files=10]="files";b[b.bXp=11]="bookmarks";b[b.gmc=12]="help";b[b.MXp=13]="chartRecommendation";b[b.B9p=14]="linkSkill";b[b.zmq=15]="searchBoxFindInDocument";b[b.ymq=16]="searchBoxEntity";b[b.Fmq=17]=
"searchSkill";b[b.hZp=18]="controlF";b[b.xlq=19]="ribbonFindButton";b[b.slq=20]="reuseSlides";b[b.data=21]="data";b[b.WYp=22]="contextMenuDictionary";b[b.ZYp=23]="contextMenuSearchSuggestion";b[b.bZp=24]="contextMenuSynonyms";b[b.YYp=25]="contextMenuSearchBoxSearch";b[b.Emq=26]="searchBoxSearchZeroTerm";b[b.$Yp=27]="contextMenuSearchZeroTerm";b[b.jgq=28]="note";b[b.Woq=29]="smartLookupAutoLaunch";b[b.aZp=30]="contextMenuSmartLookupInSubMenu";b[b.XZp=31]="dataDisambiguate";b[b.A9p=32]="linkFiles";
b[b.Bmq=33]="searchBoxNoteL2";b[b.XYp=34]="contextMenuLaunchL2Document";b[b.XUp=35]="actionAI";b[b.Eiq=36]="pasteAsNewSlide";b[b.Roq=37]="slidesCompression";b[b.Amq=38]="searchBoxGenerateDeck";b[b.djq=39]="powerPointCopilot";b[b.$pq=40]="tellMeService";b[b.njq=99]="prefetch"})(FI||(FI={}));Object(u.b)("EntryPoint",FI);var Ys=d(1471),Pv=d(1489);class ku{static g0(b,h,r,A,M,ba){if(1===r)return fc.SessionStatusManager.instance.cB?32:8;if(M.value.A7o())return Nl.mB("Skipping Serplet launch",10),32;h=
ba;if(!h)return 8;b=ku.wPb();if(r=h.CommandValueId)try{h=G.a(r)}catch(oa){return v.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",r),8}r=h;h.selection||(h.neighborhood?r=Object.assign(new Ys.a,{selection:h}):(h=M.value.gQb(),r.selection=Object.assign(new Pv.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));r.selection.clientDetectedLanguage=M.value.vAi();return ku.nic(ba,null,r,b,0,M)}static nic(b,h,r,
A,M,ba){const oa={};oa.controlId=b?b.SourceControlId:"shortcut";r&&(oa.entryPoint=FI[r.entryPoint]);v.ULS.sendTraceTag(594044172,1303,50,ku.mX("Show insights",A,oa));h?ba.value.X9o(h,A,M):r&&(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?ba.value.n8o(r,A):ba.value.Y9o(r,A,M));return 32}static mX(b,h,r=null){b={["appCorrelationId"]:h,["message"]:b};if(r)for(const A in r)b[A]=r[A];return G.c(b)}static wPb(){return hb.a.create().toString()}}Object(u.a)(ku,
"InvokingPaneUtils",null,[]);class VN{}Object(u.a)(VN,"LaunchDataInDoc",null,[]);class pl{}Object(u.a)(pl,"LaunchDataPasteAsSlide",null,[]);class WN{}Object(u.a)(WN,"LaunchDataSlidesCompression",null,[]);var st=d(1456);class eG{constructor(b,h,r,A,M,ba,oa,Ja,jb){this.XGc=this.ZCd=this.mx=null;this.wQb=zb=>{this.mx||3!==zb.state||(this.mx=zb,this.ZCd=this.mx.Tga)};this.dE=b;this.ga=h||y.AFrameworkApplication.va;this.kq=r;this.Zb=A;this.sqh=Ja;this.IMc=M;this.Ga=ba;this.Gb=oa;this.B9m();this.Q2a=new Pf.a(()=>
new Eg.a(jb.value,this.wQb))}Wb(){this.ga.qa(La.a.tdn,xe.a.frame,Object(F.a)(this,this.V9o,"showInsights"));this.ga.qa(La.a.udn,xe.a.frame,Object(F.a)(this,this.W9o,"showInsightsForTellMe"));this.ga.qa(La.a.definitions,xe.a.frame,Object(F.a)(this,this.Q8o,"showDefinitions"));this.ga.qa(La.a.mwf,xe.a.frame,Object(F.a)(this,this.R8o,"showDefinitionsForTellMe"));this.ga.qa(La.a.DDg,xe.a.frame,Object(F.a)(this,this.DDg,"showInsightsForSuggestion"));this.sqh&&(this.ga.qa(La.a.jba,xe.a.frame,Object(F.a)(this,
this.g0,"invokeSmartLookupPane")),this.ga.qa(La.a.x8c,xe.a.frame,Object(F.a)(this,this.x8c,"invokeInDocSerplet")),this.ga.qa(La.a.Mce,xe.a.frame,Object(F.a)(this,this.Mce,"invokeSerpletRibbon")),this.ga.qa(La.a.y8c,xe.a.frame,Object(F.a)(this,this.y8c,"invokeSerpletContextMenu")),this.ga.qa(La.a.rXf,xe.a.frame,Object(F.a)(this,this.rXf,"invokeSerpletTellMeZeroTerm")),this.ga.qa(La.a.qXf,xe.a.frame,Object(F.a)(this,this.qXf,"invokeSerpletTellMeNotes")),this.ga.qa(La.a.Ice,xe.a.frame,Object(F.a)(this,
this.Ice,"invokeImageSerpletContextMenu")),this.ga.qa(La.a.Nce,xe.a.frame,Object(F.a)(this,this.Nce,"invokeSynonymsSerpletContextMenu")),this.ga.qa(La.a.Hce,xe.a.frame,Object(F.a)(this,this.Hce,"invokeDictionarySerpletContextMenu")),this.ga.qa(La.a.Pce,xe.a.frame,Object(F.a)(this,this.Pce,"invokeZeroTermSerpletContextMenu")),this.ga.qa(La.a.Gce,xe.a.frame,Object(F.a)(this,this.Gce,"invokeDefinitionSearchFromFloatie")),this.ga.qa(La.a.Lce,xe.a.frame,Object(F.a)(this,this.Lce,"invokeSerpletBrowseFiles")),
this.ga.qa(La.a.Jce,xe.a.frame,Object(F.a)(this,this.Jce,"invokeInDocSerpletWithLaunchData")),this.ga.qa(La.a.Ase,xe.a.frame,Object(F.a)(this,this.Ase,"queryToggleSerplet")),this.ga.qa(La.a.Hxe,xe.a.frame,Object(F.a)(this,this.Hxe,"setInDocSearchParameter")),this.ga.qa(La.a.pXf,xe.a.frame,Object(F.a)(this,this.pXf,"invokeSerpletSlidesCompression")),this.ga.qa(La.a.oXf,xe.a.frame,Object(F.a)(this,this.oXf,"invokeSerpletPasteAsNewSlide")),y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",
!1)&&(this.ga.qa(La.a.TUi,xe.a.frame,Object(F.a)(this,this.tfn,"invokeSmartLookupPaneConversations")),this.ga.qa(La.a.Fce,xe.a.frame,Object(F.a)(this,this.Fce,"invokeAutoLaunchSearchRequest"))),this.Uvo().continueWith(()=>{y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Fe(!0)}))}sNh(){this.ga.fb(La.a.yLa,xe.a.frame,Object(F.a)(this,this.yLa,"invokeFilesSerplet"),4);this.ga.fb(La.a.jXf,xe.a.frame,Object(F.a)(this,this.yLa,"invokeFilesSerplet"),4);this.ga.fb(La.a.NUi,xe.a.frame,Object(F.a)(this,
this.hfn,"invokeLinkFilesSerplet"),4);if(this.Ga.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ga.$("SmartLookupTokenPrefetchIsEnabled")){const b=wc.a.Aaa(0,Object(F.a)(this,this.Tuj,"prefetchToken"),0,177);this.Gb.Yb(b)}}Pff(){zg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.qa(La.a.yLa,xe.a.frame,Object(F.a)(this,this.kXf,"invokeFilesSerpletUnavailable")),this.ga.qa(La.a.jXf,xe.a.frame,Object(F.a)(this,this.kXf,
"invokeFilesSerpletUnavailable")),this.ga.qa(La.a.NUi,xe.a.frame,Object(F.a)(this,this.kXf,"invokeFilesSerpletUnavailable")))}Tuj(b){v.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.NAc().then(h=>{let r=1;if(h)v.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.wyg("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Ga.fc("SmartLookupTokenRenewalWaitDurationInMinutes",
30);else{v.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.wyg("SmartLookupFiles: Token prefetch failed",!1);r=parseInt(b.data||"1");if(r>this.Ga.fc("SmartLookupTokenRenewalRetryThreshold",5)){v.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.wyg("SmartLookupFiles: Token prefetch max retry count reached",!1);return}h=6E4*this.Ga.fc("SmartLookupTokenRetryWaitDurationInMinutes",10);r++}h=new wc.a(3,1,h,Object(F.a)(this,
this.Tuj,"prefetchToken"),177);h.data=r.toString();this.Gb.Yb(h)})}wyg(b="",h=!1){this.IMc.execute(r=>{r&&r.Pwc("PrefetchToken",h,0,"SmartLookup",b)})}NAc(){return this.IMc?new Promise(b=>{this.IMc.execute(h=>{if(h){var r=Date.now();h.getToken("SmartLookup",this.Ga.jb("SmartLookupShredderServiceEndpoint")).then(A=>{b(!!A&&0<A.length);h.Pwc("TryGetTokenInternal",!!A&&0<A.length,Date.now()-r,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}Uvo(){const b=new fh.a;if(this.Ga.$("BrowserSupportsInsightsPaneSSO"))this.sNh(),
b.hg(!0);else{if(!this.IMc)return v.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.hg(!1),this.Pff(),b.task;this.IMc.execute(h=>{h?h.getToken("SmartLookup",this.Ga.jb("SmartLookupShredderServiceEndpoint")).then(r=>{v.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!r&&0<r.length);r&&0<r.length?(this.sNh(),b.hg(!0)):this.Pff()}):(v.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),b.hg(!1),this.Pff())})}return b.task}V9o(b,h,r,A,M){if(1===r)return y.AFrameworkApplication.ta&&
y.AFrameworkApplication.J.$("OneNoteDelayLoadContextActivationManager")&&!y.AFrameworkApplication.bXc?8:this.dE.value.BZi()?32:8;b=ku.wPb();h=this.dE.value.gQb();return this.sqh?(h=Object.assign(new Pv.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new Ys.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new st.a,{landingTab:"All"})}),ku.nic(M,null,h,b,0,this.dE)):ku.nic(M,h,null,b,0,this.dE)}Q8o(b,h,r,A,M){if(1===r)return this.dE.value.BZi()?
32:8;b=ku.wPb();h=this.dE.value.gQb();return ku.nic(M,h,null,b,1,this.dE)}W9o(b,h,r,A,M){return 1===r?32:this.imi(M,0)}R8o(b,h,r,A,M){return 1===r?32:this.imi(M,1)}imi(b,h){const r=ku.wPb(),A=b.CommandValueId;let M;try{M=G.a(A)}catch(ba){return v.ULS.sendTraceTag(6295941,1303,15,ku.mX(String.format("Insights parameters [{0}] is not in proper format.",A),r)),8}return ku.nic(b,M,null,r,h,this.dE)}DDg(b,h,r,A,M){if(1===r)return 32;if(!M)return 8;b=M.query?M.query:"";h=ku.wPb();r=new EI.a;r.neighborhood=
b;r.mentionStart=0;r.mentionLength=b.length;return ku.nic(M,r,null,h,0,this.dE)}hfn(b,h,r,A){if(1===r)return fc.SessionStatusManager.instance.cB?32:8;const M=y.AFrameworkApplication.J.$("InsertFileLinkSerpletIsEnabled"),ba=this.dE.value.G9a();return this.g0(b,h,r,A,Object.assign(new Ys.a,{selection:Object.assign(new Pv.a,{neighborhood:ba.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new st.a,{landingTab:"File"}),entryPoint:M?32:10}))}yLa(b,h,r,A){if(1===r)return fc.SessionStatusManager.instance.cB?
32:8;const M=y.AFrameworkApplication.J.$("InvokeReuseSlidesSerpletIsEnabled"),ba=this.dE.value.G9a();return this.g0(b,h,r,A,Object.assign(new Ys.a,{selection:Object.assign(new Pv.a,{neighborhood:ba.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new st.a,{landingTab:M?"Slide":"File"}),entryPoint:M?20:10}))}kXf(){return 2}x8c(b,h,r,A,M){if(1===r)return fc.SessionStatusManager.instance.Nk?8:32;const ba=this.dE.value.G9a();M=void 0===M||null===M?18:19;return this.g0(b,h,r,A,Object.assign(new Ys.a,
{selection:Object.assign(new Pv.a,{neighborhood:ba.neighborhood,mentionStart:ba.mentionStart,mentionLength:ba.mentionLength}),launchData:Object.assign(new st.a,{landingTab:"Indoc"}),entryPoint:M}))}Jce(b,h,r,A,M){M=M.CommandValueId;if(!M||M&&this.XGc&&M.query===this.XGc.query&&M.matchCase===this.XGc.matchCase&&M.matchWholeWordOnly===this.XGc.matchWholeWordOnly)return 32;const ba=this.dE.value.G9a();return this.g0(b,h,r,A,Object.assign(new Ys.a,{selection:Object.assign(new Pv.a,{neighborhood:ba.neighborhood,
mentionStart:ba.mentionStart,mentionLength:ba.mentionLength}),launchData:Object.assign(new st.a,{landingTab:"Indoc",data:Object.assign(new VN,{type:4,query:M.query,matchCase:M.matchCase,matchWholeWord:M.matchWholeWordOnly})}),entryPoint:18}))}Ase(b,h,r,A,M){M&&(M[Ng.a.On]=this.dE.value.GTb);return 32}Hxe(b,h,r,A,M){if(b=M.CommandValueId)this.XGc=b;return 32}tfn(b,h,r){if(1===r)return fc.SessionStatusManager.instance.cB?32:8;b=this.dE.value.G9a();b=Object.assign(new Ys.a,{selection:Object.assign(new Pv.a,
{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new st.a,{landingTab:"All"})});this.dE.value.qhe(b);return 32}Fce(b,h,r){if(1===r)return fc.SessionStatusManager.instance.cB?32:8;b=this.dE.value.G9a();b=Object.assign(new Ys.a,{selection:Object.assign(new Pv.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new st.a,{landingTab:"All",data:y.AFrameworkApplication.ZNb})});
h=ku.wPb();this.dE.value.H_b(b,h);return 32}Mce(b,h,r,A){if(1===r)return fc.SessionStatusManager.instance.cB?32:8;const M=this.dE.value.xAi();return this.g0(b,h,r,A,Object.assign(new Ys.a,{selection:Object.assign(new Pv.a,{neighborhood:M.neighborhood,mentionStart:M.mentionStart,mentionLength:M.mentionLength}),entryPoint:4,launchData:Object.assign(new st.a,{landingTab:"All"})}))}y8c(b,h,r,A){return this.g0(b,h,r,A,Object.assign(new Ys.a,{entryPoint:5,launchData:Object.assign(new st.a,{landingTab:"All"})}))}rXf(b,
h,r,A){if(1===r)return fc.SessionStatusManager.instance.cB?32:8;const M=this.dE.value.G9a();return this.g0(b,h,r,A,Object.assign(new Ys.a,{selection:Object.assign(new Pv.a,{neighborhood:M.neighborhood,mentionStart:M.mentionStart,mentionLength:0}),launchData:Object.assign(new st.a,{landingTab:"All"}),entryPoint:26}))}Hce(b,h,r,A){return 1===r?(b=this.dE.value.gQb())&&0<b.mentionLength?32:8:this.g0(b,h,r,A,Object.assign(new Ys.a,{entryPoint:22,launchData:Object.assign(new st.a,{landingTab:"All"})}))}Gce(b,
h,r,A){return 1===r?(b=this.dE.value.gQb())&&0<b.mentionLength?32:8:this.g0(b,h,r,A,Object.assign(new Ys.a,{entryPoint:7,launchData:Object.assign(new st.a,{landingTab:"All"})}))}Ice(b,h,r,A){return this.g0(b,h,r,A,Object.assign(new Ys.a,{launchData:Object.assign(new st.a,{landingTab:"Image"}),entryPoint:9}))}Nce(b,h,r,A){return this.g0(b,h,r,A,Object.assign(new Ys.a,{launchData:Object.assign(new st.a,{landingTab:"All"}),entryPoint:24}))}qXf(b,h,r,A){return this.g0(b,h,r,A,Object.assign(new Ys.a,{launchData:Object.assign(new st.a,
{landingTab:"Notes"}),entryPoint:33}))}Pce(b,h,r,A){if(1===r)return fc.SessionStatusManager.instance.cB?32:8;const M=this.dE.value.G9a();return this.g0(b,h,r,A,Object.assign(new Ys.a,{selection:Object.assign(new Pv.a,{neighborhood:M.neighborhood,mentionStart:M.mentionStart,mentionLength:0}),launchData:Object.assign(new st.a,{landingTab:"All"}),entryPoint:27}))}pXf(b,h,r,A,M){if(!M)return 8;const ba=M.url;M=M.selectedSlideIDs;return this.g0(b,h,r,A,Object.assign(new Ys.a,{launchData:Object.assign(new st.a,
{landingTab:"All",data:Object.assign(new WN,{type:6,url:ba,selectedSlideIDs:M})}),entryPoint:37}))}oXf(b,h,r,A,M){if(!M)return 8;const ba=M.Selection;M=M.CurrentDocTitle;return this.g0(b,h,r,A,Object.assign(new Ys.a,{launchData:Object.assign(new st.a,{landingTab:"All",data:Object.assign(new pl,{type:5,selection:ba,currentDocTitle:M})}),entryPoint:36}))}g0(b,h,r,A,M){return ku.g0(b,h,r,A,this.dE,M)}Lce(b,h,r){if(1===r)return 32;this.mx||this.Q2a.value.NR("Browse File from Search pane",!0);if(!this.ZCd||
""===this.ZCd)return v.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Te.a.Cn(this.ZCd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}B9m(){const b=this.Zb.ie(fi.ND);b.parent=pd.AFrame.Kq;b.Pja(Object(F.a)(this,this.Qwc,"sendIFrameTakeFocusMessage"));this.kq.IW(fi.ND)}Qwc(){document.activeElement.blur();y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.Ntb||(this.dE.value.iWo(),this.dE.value.tRo())}dispose(){this.dE.value&&this.dE.value.dispose()}}
Object(u.a)(eG,"InsightsActor",null,[11]);const bL=b=>{b=b.split("-");return b[b.length-1]},hP=()=>{var b=cL();if(b)return Promise.resolve(b);b=KA().replace("SearchWeb","searchweb");b=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+fi.MWj+"/":b+fi.Ypd+"/";b+="version.json";if(X.a.tta)return XN(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?
(Nl.mB("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(r=>r.json()).catch(()=>{Nl.mB("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(r=>{r=G.b(JSON.stringify(r));return r.version?r.version:""},r=>{Nl.mB("InsightsUtils - Failed to deserialize version: "+r.toString(),10);v.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+r.toString());
return""}).then(r=>r)}catch(h){return Nl.mB("InsightsUtils - Failed to download version.json: "+h.toString(),10),v.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},XN=b=>{const h=y.AFrameworkApplication.Ge;return new Promise(r=>{const A=new BI.a(b,1,null,null,!0,2,null);h.send(A).DDa(M=>{M&&M.data?M.data.Ee||(Nl.mB("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+M.data.He,
10),r("")):(Nl.mB("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),r(""));try{const ba=G.b(M.data.Ee);ba.version&&r(ba.version)}catch(ba){Nl.mB("InsightsUtils - Failed to deserialize version: "+ba.toString(),10),r("")}},M=>{M&&M.data?Nl.mB("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+M.data.He,10):Nl.mB("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);r("")})})},
iM=()=>y.AFrameworkApplication.J.$("SmartLookupEnableLocalOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),hC=()=>{const b=KA();return iM()||y.AFrameworkApplication.J.jb("SmartLookupPRClientVersion")?b+cL()+"/":y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?b+fi.MWj:b+fi.Ypd},cL=()=>iM()?"dev":y.AFrameworkApplication.J.jb("SmartLookupPRClientVersion")?y.AFrameworkApplication.J.jb("SmartLookupPRClientVersion").split("/")[1]:
y.AFrameworkApplication.J.jb("SmartLookupClientVersion"),jM=b=>{var h=3===y.AFrameworkApplication.ta.Hb.Uk?"wordwac":2===y.AFrameworkApplication.ta.Hb.Uk?"pptwac":"excelwac";var r=Ag.a.Hg(y.AFrameworkApplication.lcid);const A=r?r.name:"en-us";r=KA();const M=Ex();h="main_ssr_wac.html?appName="+h+"&culture="+A;return"LOCAL"===M?r+h:r+((""!==b?b:fi.Ypd)+"/")+h},iP=b=>KA()+(""!==b?b:fi.Ypd)+"/scripts/microsoft.office.smartlookup.host.runtime.js",KA=()=>{switch(Ex()){case "LOCAL":return fi.gcp;case "PR":const b=
y.AFrameworkApplication.J.jb("SmartLookupPRClientVersion").split("/");return fi.hcp+b[0]+"/";case "INT":return fi.icp;case "EDOG":return fi.NWj;default:return fi.OWj}},YN=()=>{if(!y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(Ex()){case "EDOG":return fi.NWj;case "PROD":return fi.OWj;default:return""}},Ex=()=>{if(y.AFrameworkApplication.J.$("SmartLookupEnableEdogSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",
!1))return"EDOG";if(y.AFrameworkApplication.J.$("SmartLookupEnableProdSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(y.AFrameworkApplication.J.$("SmartLookupEnableIntSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(y.AFrameworkApplication.J.jb("SmartLookupPRClientVersion")&&
y.AFrameworkApplication.J.jb("SmartLookupPRIntentSvc"))return"PR";if(iM())return"LOCAL";switch(Object(Ma.a)(String,y.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(y.AFrameworkApplication.J&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let b=y.AFrameworkApplication.J.jb("UserPrincipalName");b=C.a.xh(b);const h=y.AFrameworkApplication.J.my("SmartLookupINTEnabledForSKITeam")?y.AFrameworkApplication.J.pD("SmartLookupINTEnabledForSKITeam"):
[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},ZN=()=>{let b;b=y.AFrameworkApplication.J.$("IntentSvcEnableEdogSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":y.AFrameworkApplication.J.$("IntentSvcEnableProdSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",
!1)?"PROD":y.AFrameworkApplication.J.$("IntentSvcEnableIntSourceLocationOverride")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":Ex();const h=y.AFrameworkApplication.J.jb("IntentServiceEndpoint"),r=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";
case "PR":return y.AFrameworkApplication.J.jb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(r?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(r?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},vy=()=>{const b=
Ex(),h=y.AFrameworkApplication.J.jb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class $N{sendTelemetryEvent(b){Nl.sendTelemetryEvent(b)}}Object(u.a)($N,"OtelTelemetrySink",null,[553]);class aO{}Object(u.a)(aO,"ApplicationProperties",
null,[]);class GI{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(u.a)(GI,"CurrentDocumentProperties",null,[]);class sz{}Object(u.a)(sz,"EnterpriseUserInfo",null,[]);class fG{}Object(u.a)(fG,"FeatureGates",null,[]);class kM{constructor(b,h){this.uw=this.qj=null;this.RPa="Search";this.Tbj=!0;this.DJb=h;this.Bv=b;this.Bv.execute(r=>{r.isFeatureEnabled("mso_sendASmile",!0).then(A=>{this.Tbj=A}).catch(A=>{Nl.mB("SearchHelper - Failed to check if Feedback feature is enabled: "+
A.toString(),15)})});b=ZN();h=y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentSearch")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")){this.uw={};const r=this.NLm();if(r&&0<r.length)for(let A=0;A<r.length;A++){const M=r[A],ba=this.fMm(M);switch(ba.toLowerCase()){case "true":this.uw[M]=!0;break;case "false":this.uw[M]=!1;break;default:this.uw[M]=ba}}this.uw.EnableInDocumentSearch=
h;this.uw.EnableInDocumentSearchReplace=!0;this.uw.EnableInDocumentParamLocalSearch=!0;this.uw.EnableInDocumentQuerySuggest=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuerySuggest")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.uw.EnableInDocumentQuestionGeneration=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuestionGeneration")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1);this.uw.EnableInDocumentExperiment1=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.uw.EnableInDocumentExperiment2=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.uw.EnableInDocumentExperiment3=
h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment3")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.uw.EnableZeroTermAutoRefresh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.uw.EnableTap3SZeroTerm=y.AFrameworkApplication.J.$("SmartLookupEnableTap3SZeroTerm")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.uw.EnableLocalSearch=!0;this.uw.EnableInDocumentStickyFilters=!0;this.uw.IntentServiceEndpoint=b;this.uw.EnablePDFShredding=y.AFrameworkApplication.J.$("SmartLookupEnableSharepointPDFIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.uw.FilterNonPPTFilesForReuseSlides=y.AFrameworkApplication.J.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.uw.UXBundleVersion=cL();this.uw.SmartLookupServicePath=hC();this.uw.EnableAcronymSearch=
!0;this.uw.UseAltAnswerEndpoint1=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.uw.UseAltAnswerEndpoint2=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.uw.UseAltAnswerEndpoint3=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint3")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.uw.UseNextUXVersion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.uw.IgnoreNeighborhoodContext=y.AFrameworkApplication.J.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.uw.ShowDebugInfo="INT"===Ex();this.uw.DebugCommands=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.uw.ChangeGates=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.uw.QnaInMixSection=!0;this.uw.EnableNoteSearch=y.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.uw.EnableWikiL2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.uw.EnableFilteringOutRedundantKPE=
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.uw.EnableZeroTermEntitySuggestion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.uw.RankingModels=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.uw.EnableClientSideRendering=!0}else this.qj=new fG,this.qj.EnableInDocumentSearch=h,this.qj.EnableInDocumentSearchReplace=
!0,this.qj.EnableInDocumentParamLocalSearch=!0,this.qj.EnableInDocumentQuerySuggest=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuerySuggest")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.qj.EnableInDocumentQuestionGeneration=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentQuestionGeneration")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.qj.EnableInDocumentExperiment1=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.qj.EnableInDocumentExperiment2=h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.qj.EnableInDocumentExperiment3=
h&&y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentExperiment3")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.qj.EnableZeroTermAutoRefresh=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.qj.EnableTap3SZeroTerm=y.AFrameworkApplication.J.$("SmartLookupEnableTap3SZeroTerm")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.qj.EnableLocalSearch=!0,this.qj.EnableInDocumentStickyFilters=!0,this.qj.IntentServiceEndpoint=b,this.qj.EnablePDFShredding=y.AFrameworkApplication.J.$("SmartLookupEnableSharepointPDFIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.qj.FilterNonPPTFilesForReuseSlides=y.AFrameworkApplication.J.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.qj.UXBundleVersion=cL(),this.qj.SmartLookupServicePath=hC(),this.qj.EnableAcronymSearch=
!0,this.qj.UseAltAnswerEndpoint1=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint1")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.qj.UseAltAnswerEndpoint2=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint2")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.qj.UseAltAnswerEndpoint3=y.AFrameworkApplication.J.$("SmartLookupUseAltAnswerEndpoint3")||
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.qj.UseNextUXVersion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.qj.IgnoreNeighborhoodContext=y.AFrameworkApplication.J.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.qj.ShowDebugInfo="INT"===Ex(),this.qj.DebugCommands=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.qj.ChangeGates=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.qj.QnaInMixSection=!0,this.qj.EnableNoteSearch=y.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.qj.EnableWikiL2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.qj.EnableFilteringOutRedundantKPE=
y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.qj.EnableZeroTermEntitySuggestion=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.qj.RankingModels=y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.qj.EnableClientSideRendering=!0,this.qj.SharedSerpletFeatureGate1=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.qj.SharedSerpletFeatureGate2=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.qj.SharedSerpletFeatureGate3=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.qj.SharedSerpletFeatureGate4=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.qj.SharedSerpletFeatureGate5=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.qj.SharedSerpletFeatureGate6=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.qj.SharedSerpletFeatureGate7=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.qj.SharedSerpletFeatureGate8=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.qj.SharedSerpletFeatureGate9=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.qj.SharedSerpletFeatureGate10=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.qj.SharedSerpletFeatureGate11=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.qj.SharedSerpletFeatureGate12=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.qj.SharedSerpletFeatureGate13=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.qj.SharedSerpletFeatureGate14=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.qj.SharedSerpletFeatureGate15=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.qj.SharedSerpletFeatureGate16=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.qj.SharedSerpletFeatureGate17=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.qj.SharedSerpletFeatureGate18=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.qj.SharedSerpletFeatureGate19=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.qj.SharedSerpletFeatureGate20=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.qj.SharedSerpletFeatureGate21=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.qj.SharedSerpletFeatureGate22=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.qj.SharedSerpletFeatureGate23=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.qj.SharedSerpletFeatureGate24=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.qj.SharedSerpletFeatureGate25=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.qj.SharedSerpletFeatureGate26=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.qj.SharedSerpletFeatureGate27=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.qj.SharedSerpletFeatureGate28=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.qj.SharedSerpletFeatureGate29=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.qj.SharedSerpletFeatureGate30=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.qj.SharedSerpletFeatureGate31=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.qj.SharedSerpletFeatureGate32=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.qj.SharedSerpletFeatureGate33=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.qj.SharedSerpletFeatureGate34=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.qj.SharedSerpletFeatureGate35=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.qj.SharedSerpletFeatureGate36=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.qj.SharedSerpletFeatureGate37=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.qj.SharedSerpletFeatureGate38=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.qj.SharedSerpletFeatureGate39=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.qj.SharedSerpletFeatureGate40=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.ALc=$a.a.instance.resolve(1174);this.Vub=kM.isEnterpriseUser();
this.oYa=y.AFrameworkApplication.J.jb("SmartLookupShredderServiceEndpoint");this.Y7f=Fa.a.yU(y.AFrameworkApplication.J.jb("AppCatalogUrl")||"");this.aKn=y.AFrameworkApplication.J.jb("UserPrincipalName");this.Vub&&this.jHi()}fMm(b){return y.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}NLm(){const b=y.AFrameworkApplication.J.O8a,h=y.AFrameworkApplication.J.pD("SmartLookupFlightKeywordList"),r=[];if(b&&h&&0<h.length)for(const M in b){var A={key:M,value:b[M]};A=
A&&A.key?A.key:"";for(let ba=0;ba<h.length;ba++)if(-1<A.toLowerCase().indexOf(h[ba].toLowerCase())){const oa=A.split(".");oa&&4===oa.length&&Array.add(r,oa[oa.length-1])}}return r}hOf(b,h,r,A){return new Promise(M=>{this.aun().then(ba=>{const oa=new aO;oa.anid="";oa.applicationName=3===y.AFrameworkApplication.ta.Hb.Uk?"WORD":"POWERPNT";oa.applicationVersion=y.AFrameworkApplication.buildVersion;oa.appCorrelationId=b?b:ku.wPb();oa.themePlatform="web";oa.lcid=y.AFrameworkApplication.lcid;oa.launchUtcTime=
(new Date).toUTCString();y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")?oa.featureGates=G.c(this.uw):oa.featureGates=G.c(this.qj);var Ja=Ag.a.Hg(y.AFrameworkApplication.lcid);Ja=Ja?Ja.name:null;oa.market=bL(Ja);oa.uiLanguage=Ja;oa.sessionId=y.AFrameworkApplication.userSessionId;oa.themeId=r;oa.parentalControl="yes";oa.processorOnlyMode=ba;oa.isEditingAllowed=h.isEditingAllowed();oa.isFeedbackEnabled=this.Tbj;oa.isClientSideRendering=18===A||19===A||15===A;oa.disableClipboard=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",
!1)&&y.AFrameworkApplication.BH&&!y.AFrameworkApplication.lOb;oa.accessToken=this.Vub?this.jHi():"";ba=new sz;ba.CountryCode=bL(Ja);ba.ServiceEndpoint=this.oYa;ba.IsGoLocal=y.AFrameworkApplication.J.$("IsGoLocalEnvironment");ba.IsEnabled=this.Vub;ba.IsEnterpriseEnabled=this.Vub;ba.TenantRoot=this.Y7f;ba.Upn=this.aKn;Ja=Ex();ba.IsEUDB="PROD"===Ja&&""!==y.AFrameworkApplication.J.jb("IntentServiceEndpoint");oa.enterpriseUserInfo=ba;ba=new GI;ba.filePath=y.AFrameworkApplication.J.jb("EditDocInClientUrl");
ba.docName=y.AFrameworkApplication.J.jb("FileName");ba.author=99!==A?h.author():null;ba.createdDate=99!==A?h.createdDate():null;oa.currentDocument=ba;M(oa)})})}aun(){return new Promise(b=>{this.Bv?this.Bv.execute(h=>{h.isFeatureEnabled(fi.jcp,!0).then(r=>{b(!r)}).catch(r=>{Nl.mB("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+r.toString(),10);b(!0)})}):b(!0)})}Ico(b){this.ALc&&this.Vub&&this.G9d(this.oYa).then(h=>{b(h)})}jHi(){return"Dev Box"===y.AFrameworkApplication.J.jb("StatusBarEnvironmentNameToUse")&&
void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.ALc?this.ALc.WPm(this.RPa,this.oYa):""}G9d(b){return"Dev Box"===y.AFrameworkApplication.J.jb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>{h(window.SearchPaneShredderTokenOverride)}):this.ALc?this.ALc.getToken(this.RPa,b):Promise.resolve("")}L4c(){return this.DJb?
this.DJb.getVersion():""}$sm(){return y.AFrameworkApplication.J.$("SmartLookupFeatureGateV2")?G.c(this.uw):G.c(this.qj)}static isEnterpriseUser(){const b=y.AFrameworkApplication.J.jb("SovereignEnvironmentName"),h=y.AFrameworkApplication.J.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(u.a)(kM,"SearchHelper",null,[532]);class gG{constructor(){gG._instance=""}getVersion(){return gG._instance}J1o(b){gG._instance=b}}gG._instance=null;Object(u.a)(gG,"SmartLookupVersion",null,[]);
class bO{}Object(u.a)(bO,"ConfigurationProvider",null,[]);class WD{constructor(b){WD._instance=b}DKf(){return WD._instance}}WD._instance=null;Object(u.a)(WD,"SearchHostRuntime",null,[]);class HI{constructor(){this.Via=this.p4b=this.Z=null}get name(){return"Common.App.Insights"}uc(b){this.Z=b;const h=Nf.a.iq($a.a.instance.Ra(806)),r=y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")||y.AFrameworkApplication.J.$("SmartLookupIsEnabled");b.register(eG,1177).ha().Sd(()=>new eG(b.rf(1175),y.AFrameworkApplication.va,
kp.a.instance,rd.FocusManager.instance(),b.Ra(1174),y.AFrameworkApplication.J,me.a.instance,r,new Pf.a(()=>h.result)));b.register(531,1183).ha().Sd(()=>new UN(b));r&&(b.register(gG,1176).ha().Sd(()=>new gG),b.register(532,1178).ha().Sd(()=>new kM($a.a.instance.Ra(4),b.Oa(1176))))}init(){y.AFrameworkApplication.m3&&(this.p4b=this.Z.Oa(1177),this.p4b.Wb())}yuo(){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",!1)){var b=y.AFrameworkApplication.J.jb("SmartLookupShredderServiceEndpoint");
this.Z.resolve(1178).G9d(b).then(h=>{var r={};r.Authorization="Bearer "+h;h=vy();const A=y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);r=new BI.a(h+("?isTelemetryOnly="+A),1,null,r,!0,2,null);y.AFrameworkApplication.Ge.send(r).DDa(()=>{Nl.mB("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+A,50)},M=>{Nl.mB("InsightsPackage - Failed to send refreshmemory API request. Error: "+M.toString(),
10)})})}}xZl(){this.aen();this.yuo()}aen(){hP().then(b=>{if(""!==b){const h=this.Z.Oa(1176);h&&h.J1o(b)}this.w0d();this.p4b=this.Z.resolve(1177);b=iP(b);b=vb.a.create(b);b.n2((h,r)=>{r.succeeded?this.J2o()&&this.prefetchZeroTerm():Nl.mB("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+r.hG,10);this.p4b.Wb()});pb.a.y_(b)})}J2o(){const b=Object.assign(new bO,{channelId:fi.channelId,approvedOriginPattern:iM()?"^(http)?://(localhost:8080)$":y.AFrameworkApplication.J.jb("SmartLookupApprovedOriginPattern")});
var h=this.Z.resolve(1179);const r=this.Z.resolve(1180),A=this.Z.resolve(1181),M=new qb.a;h&&M.add(h);r&&M.add(r);A&&M.add(A);h=ZN();try{const ba=new $N,oa=SmartLookupHostRuntime.setup(b,M.toArray(),!0,h,ba);this.Z.register(WD,1173).ha().Sd(()=>new WD(oa));return!0}catch(ba){return Nl.mB("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ba,10),!1}}prefetchZeroTerm(){if(y.AFrameworkApplication.J.$("SmartLookupEnableInDocumentSearch")||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)){var b=$a.a.instance.Oa(1173);if(b){const h=this.Z.resolve(1178),r=this.Z.resolve(1182);h.hOf(null,r,0,99).then(A=>{b.DKf().prefetchZeroTerm(A,y.AFrameworkApplication.userSessionId,hC(),!0,"Indoc",null)})}else Nl.mB("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}w0d(){var b=this.Z.resolve(1178);const h=jM(b.L4c());b=b.L4c();b=KA()+(""!==b?b:fi.Ypd)+"/scripts/microsoft.office.smartlookup.ssr.js";const r=YN();X.a.tta?this.wZl(h,b):(this.tZl(h,
r),this.uZl(b,r))}tZl(b,h){const r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const A={};A.method=r.get_httpVerb();r.set_url(b);const M=(new Date).getTime();try{window.fetch(r.getResolvedUrl(),A).then(()=>{""!==h&&Nl.Txg(h,b,(new Date).getTime()-M);this.Z.Oa(1176)})}catch(ba){Nl.mB("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+ba.toString(),10)}}uZl(b,h){var r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const A={};A.method=r.get_httpVerb();r.set_url(b);let M=
-1;if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))r=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),me.a.instance.Yb(new wc.a(5,1,r,()=>{const ba=vb.a.create(b);ba.jgf(()=>{M=Date.now()});ba.n2((oa,Ja)=>{Ja.succeeded?""!==h&&Nl.Txg(h,b,Date.now()-M):Nl.mB("InsightsPackage - Failed to prefetch JS file.",10)});pb.a.y_(ba)}));else{M=Date.now();try{window.fetch(r.getResolvedUrl(),
A).then(()=>{""!==h&&Nl.Txg(h,b,Date.now()-M)})}catch(ba){Nl.mB("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ba.toString(),10)}}}wZl(b,h){if(X.a.tta){var r=y.AFrameworkApplication.Ge;b=new BI.a(b,1,null,null,!0,2,null);r.send(b).DDa(A=>{A&&A.data?A.data.Ee?this.Z.Oa(1176):Nl.mB("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+A.data.He,10):Nl.mB("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",
10)},A=>{A&&A.data?Nl.mB("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+A.data.He,10):Nl.mB("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});y.AFrameworkApplication.J.$("SmartLookupPrefetchJSIsEnabled")&&(h=new BI.a(h,1,null,null,!0,2,null),r.send(h).DDa(A=>{A&&A.data?A.data.Ee||Nl.mB("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+A.data.He,10):
Nl.mB("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},A=>{A&&A.data?Nl.mB("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+A.data.He,10):Nl.mB("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.p4b&&this.p4b.dispose()}}Object(u.a)(HI,"InsightsPackage",null,[0,1]);var cO=d(1545);class dO{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(u.a)(dO,"DocumentContentParams",null,[]);var hG=d(1899),eO=d(754),fO=d(2119),gO=d(2120),hO=d(2121),Zs;(function(b){b.q1a="SearchProvider";b.Bgb="TextSummarization"})(Zs||(Zs={}));Object(u.b)("WorkflowType",Zs);var Ur;(function(b){b.Success="Success";b.iRg="Invoked";b.Error="Error"})(Ur||(Ur={}));Object(u.b)("LogType",Ur);var Qv;(function(b){b.kek="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier=
"BlockedByClassifier";b.hRg="InvalidAnnotation";b.Zjk="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(Qv||(Qv={}));Object(u.b)("ErrorReason",Qv);class II{constructor(b){this.Ehi=b;this.dfg=this.dfg.bind(this);this.kXb=this.kXb.bind(this);this.Ilp=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}async submitDocumentContentExtractionSignal(){try{this.oPo=Date.now();this.Yxb=hb.a.create().toString();this.log({DM:Zs.q1a,logType:Ur.iRg,
success:!0,correlationId:this.Yxb});var b=Ex().toLowerCase();b="int"===b||"local"===b;await this.activateAnnotation();const h=new Q.l({parentPath:["Signal",hG.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new hG.SearchProviderSignal({correlationId:this.Yxb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.OKj=window.setTimeout(()=>{this.onError(Zs.q1a,Ur.Error,Qv.Timeout)},1500)}catch(h){window.clearTimeout(this.OKj),
this.onError(Zs.q1a,Ur.Error,Qv.Other,this.Mxi(h))}}async generateDocumentSummaryDetails(){try{if(!II.fad)return null;this.Hlp=Date.now();this.log({DM:Zs.Bgb,logType:Ur.iRg,success:!0});await this.activateAnnotation();const b=new Q.l({parentPath:["Signal",fO.a.getTypeName()],items:[{id:"TextSummarization",body:new fO.a}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.P0j=window.setTimeout(()=>{this.onError(Zs.Bgb,Ur.Error,Qv.Timeout)},this.Ilp);return new Promise(h=>
{this.czc=h})}catch(b){window.clearTimeout(this.P0j),this.onError(Zs.Bgb,Ur.Error,Qv.Other,this.Mxi(b))}}async generateDocumentSummary(){var b;return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get fad(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get eun(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",
!1)}async activateAnnotation(){if(!this.Cnc){await bt.a.Bm();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new eO.a,{annotationType:hG.SearchProviderAnnotation.getTypeName(),handler:this.dfg}))];II.fad&&h.push(b(Object.assign(new eO.a,{annotationType:gO.b.getTypeName(),handler:this.kXb})));await Promise.all(h);this.Cnc=!0}}kXb(b){var h,r,A;if(this.czc)if(this.g0i(b)){if(b=b.items[0],gO.b.typeGuard(b.body))if(window.clearTimeout(this.P0j),b=b.body,b.status!==
hO.a.Success)this.onError(Zs.Bgb,Ur.Error,this.Csm(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({DM:Zs.Bgb,logType:Ur.Success,success:!0});var M=null!==b.summary&&""!==b.summary,ba=II.eun&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===hO.b.Success&&null!==(null===(r=b.tts)||void 0===r?void 0:r.base64Audio)&&""!==(null===(A=b.tts)||void 0===A?void 0:A.base64Audio);this.czc({succeeded:M,summary:M?b.summary:null,audioSucceeded:ba,audioBase64:ba?b.tts.base64Audio:
null});this.czc=null}}else this.log({DM:Zs.Bgb,logType:Ur.Error,success:!1,K1d:Qv.hRg})}dfg(b){if(this.g0i(b)&&(b=b.items[0],hG.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.OKj),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Yxb)this.log({DM:Zs.q1a,logType:Ur.Error,K1d:Qv.kek,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});
else if(this.Yxb!==b.correlationId)this.log({DM:Zs.q1a,logType:Ur.Error,K1d:Qv.Zjk,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.Y9h(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({DM:Zs.q1a,logType:Ur.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Yxb=void 0;this.Ehi.aOj(h)}else this.onError(Zs.q1a,
Ur.Error,Qv.hRg)}Csm(b){switch(b.status){case "BlockedByPrefilter":return Qv.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return Qv.BlockedByQualityCheck;default:return Qv.Other}}g0i(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.DM){case Zs.q1a:var h=this.oPo;break;case Zs.Bgb:h=this.Hlp;break;default:h=-1}const r=Date.now(),A=h?r-h:-1;h=[Object.assign(new fa.a,{name:"WorkflowType",string:b.DM}),Object.assign(new fa.a,{name:"LogType",string:b.logType}),
Object.assign(new fa.a,{name:"ErrorReason",string:b.K1d}),Object.assign(new fa.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new fa.a,{name:"Message",string:b.message}),Object.assign(new fa.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new fa.a,{name:"StartTime",int64:h}),Object.assign(new fa.a,{name:"EndTime",int64:r}),Object.assign(new fa.a,{name:"Duration",int64:A})];Object($b.a)("AugloopSearchProviderData",b.success,A,h)}Mxi(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}Y9h(b=
"",h="",r=""){return Object.assign(new dO,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:r})}onError(b,h,r,A){h={DM:b,logType:h,success:!1,message:A,K1d:r};switch(b){case Zs.q1a:if(!this.Yxb)break;h.correlationId=this.Yxb;this.log(h);this.Yxb=void 0;this.X6l();break;case Zs.Bgb:if(!this.czc)break;this.log(h);this.czc(null);this.czc=null;break;default:return null}}X6l(){this.Ehi.aOj(this.Y9h())}}Object(u.a)(II,"AugloopSearchProviderManager",null,[]);class dL{constructor(){this.results=
null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(u.a)(dL,"DocumentContentSearchResults",null,[]);class lM{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,r,A,M){this.selectRange(h,r,A,M)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,r=>{h(Object.assign(new dL,{results:r,totalResultCount:r.length,hasTooManyResults:100<r.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,r=>{h(Object.assign(new dL,{results:r,
totalResultCount:r.length,hasTooManyResults:r.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(u.a)(lM,"BaseDocumentContentExecutor",null,[1883,440]);var mM=d(2162),iO=d(1359);class eL{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(u.a)(eL,"DocumentContentSearchParams",null,[]);class nM{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(u.a)(nM,"DocumentSelection",null,[]);class jO{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(u.a)(jO,"IAuthorProperties",null,[]);var LA=d(683);class oM{constructor(){this.S0c=this.vqf=0}}Object(u.a)(oM,"CommentFindResultIndexInfo",null,[]);const fL=b=>{b.Kc(Le.a.yk(b.gb.currentSelection,!0,!1))},pM=b=>{b=mM.a.r8d(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class kO{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(u.a)(kO,"DocumentContentSearchResult",null,[]);var XD=d(1856);class lO{constructor(){this.authorEmail=this.authorName=this.SOb=this.Bqf=null}}Object(u.a)(lO,"CommentFindResults",null,[]);class qM{constructor(){this.end=this.Dc=0}}Object(u.a)(qM,"FindResultOffset",null,[]);class Pt{constructor(b,h,r,A,M,ba,oa,Ja,jb,zb){this.jMe=this.yw=this.ySe=this.KC=null;this.zIh=0;this.FO=null;this.lFc=new qb.a;this.ach=null;this.$u=b;this.hb=h;this.elb=r;this.rja=
M;this.o7b=ba;this.NDb=oa;this.yi=Ja;this.ga=jb;this.ib=zb}rwm(b,h){var r;const A=[];if(12!=b.type)return A;const M=xa.FormattingReader.Zsi(b);let ba=null,oa=-1;var Ja=Yl.a.auto;for(let zb=0;zb<=M.length;zb++){let Eb=-1;var jb=Yl.a.auto;zb<M.length&&(jb=M[zb],Eb=jb.cp,jb=null===(r=jb.formatting)||void 0===r?void 0:r.cache,jb=(null===jb||void 0===jb?0:jb.CRb)?jb.highlight:(null===jb||void 0===jb?0:jb.zWa)?jb.qu:Yl.a.auto);if(Ja!=jb){if(Ja!=Yl.a.auto){ba||(ba=this.NDb.VVa(b.id));-1==Eb&&(Eb=ba.length);
Ja=this.elb.TYd(ba,oa,Eb,"");const Sb={};Sb.context=Ja.KXd;Sb.startOffsetInContext=Ja.mve;Sb.endOffsetInContext=Ja.kve-1;A.push({data:Sb,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:oa,endOffsetInParagraph:Eb-1})}oa=Eb;Ja=jb}}return A}get Lea(){return this.ach}initialize(){this.KC=fD.a.createInstance(this,this.rja,kA.a.instance,!1,!0)}search(b,h){this.KC.M6a();this.t0f(b)?(this.yw=h,this.FO=new qb.a,b=this.juf(b),this.KC.find(b)):h(null)}searchV2(b,h){this.KC.M6a();if(this.t0f(b)){this.nZi()&&
this.ga.Pb(La.a.Hxe,2,{CommandValueId:b});this.jMe=h;this.zIh=b.totalResultLimit;this.FO=new qb.a;b=this.juf(b);this.ach=new Ip.a;this.KC.find(b);h=this.rja.Rhd(b.text);h=this.rja.GXb(h);b=this.o7b.blc(h.join("|"),b);h=this.yi.GR();for(let A=0;A<h.length;A++){const M=h[A],ba=pM(M);var r=this.NDb.qRb(ba,b);const oa=this.NDb.qRb(M.author,b);if(!r&&!oa){v.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!ba,!b);continue}r=oa&&0<oa.length?oa:r;let Ja="",jb="";oa&&0<oa.length&&
(Ja=M.author,jb=M.authorId);for(const zb of r)r=XD.a.createInstance(zb.Dc,zb.end,P.a.Af(M.objectId),A,32,!1),this.lFc.add(r),this.Lea.mb(A)||this.Lea.add(A,Object.assign(new lO,{Bqf:ba,SOb:[],authorName:Ja,authorEmail:jb}))}}else h(null)}get Coi(){null==this.ySe&&(this.ySe=fD.a.createInstance(this,this.rja,kA.a.instance));return this.ySe}nZi(){var b;return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}zoc(){var b;
return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}highlight(b){var h=this.t0f(b);b=h?this.juf(b):null;var r={};this.nZi()&&this.ga.Pb(Hc.a.ypg,2,r);if(r[Ng.a.On]){if(h){h={};r={};var A={};this.ga.Pb(Hc.a.Cre,2,h);this.ga.Pb(La.a.Bre,2,r);this.ga.Pb(La.a.Dre,2,A);if(b.text!=h.CommandValueId||b.matchCase!=r[Ng.a.On]||b.matchWholeWord!=A[Ng.a.On])fL(this.ib),this.ga.Pb(La.a.Kic,2,{CommandValueId:b.text,
MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else r=this.Coi,r.M6a(),h&&r.find(b)}selectNextPrevHighlight(b){const h=this.Coi;return 0<h.Ek.doa?(b?h.kLi():h.pLi(),h.Ek.gef-1):-1}juf(b){let h=jA.a.none;b.matchCase&&(h|=jA.a.matchCase);b.matchWholeWordOnly&&(h|=jA.a.aPg);return iy.a.createQuery(b.query,h)}t0f(b){return b&&!!b.query&&0<b.query.length}Aye(){}Vwe(){}reset(){}WDf(){}Iic(){if(this.yw){var b=this.Z9h(this.FO);this.yw(b)}if(this.jMe){b=new dL;const h=this.FO.count+this.lFc.count>
this.zIh;b.totalResultCount=this.FO.count+this.lFc.count;b.hasTooManyResults=h;h||(this.FO.wD(this.FO.count,this.lFc),b.results=this.Z9h(this.FO));this.jMe(b);this.lFc.clear()}}Z9h(b){var h;const r=[];var A=Object.assign(new LA.a,{d0:!1,bta:!0,gLa:this.zoc(),e0:!0});A=this.hb.xKa(this.$u.value,A);for(const oa of b){var M=oa.Dc;let Ja=oa.end;var ba=void 0;b=-1;let jb=null,zb=0;if(32===oa.type){jb=Pt.Aqf;zb=3;b=A.count+oa.FWa;const Eb=({Dc:M,end:Ja}=cO.a.DCj(this.Lea.K(oa.FWa).Bqf,M,Ja)).returnValue;
ba=this.elb.TYd(Eb,M,Ja,CB.a(oa.type));this.Lea.K(oa.FWa).Bqf=Eb;this.Lea.K(oa.FWa).SOb.push(Object.assign(new qM,{Dc:M,end:Ja}))}else{if(2===oa.type||4===oa.type)zb=2===oa.type?1:2,jb=Pt.bTf;if(8===oa.type||16===oa.type)zb=8===oa.type?6:5,jb=Pt.Jcg;for(ba=0;ba<A.count;ba++)if(A.K(ba).id===oa.nodeId){b=ba;break}ba=this.elb.UYd(oa)}M=(null===(h=this.Lea)||void 0===h?0:h.mb(oa.FWa))?this.Lea.K(oa.FWa):null;if(0<=b||(null===M||void 0===M?0:M.authorName))b=Object.assign(new kO,{snippet:ba.KXd,subdocumentId:jb,
subdocumentType:zb,startOffsetInSnippet:ba.mve,endOffsetInSnippet:ba.kve-1,paragraphIndex:b,startOffsetInParagraph:oa.Dc-ba.mve,endOffsetInParagraph:oa.end-ba.kve-1,authorName:M?M.authorName:"",authorEmail:M?M.authorEmail:""}),r.push(b)}r.sort((oa,Ja)=>oa.paragraphIndex===Ja.paragraphIndex?oa.startOffsetInParagraph-Ja.startOffsetInParagraph:oa.paragraphIndex-Ja.paragraphIndex);return r}update(){}vVa(b,h){switch(b){case 0:h&&0<h.length&&!this.FO&&(v.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),
this.FO=new qb.a);for(const r of h)this.FO.add(r)}}Dyb(){}dispose(){}}Pt.Aqf="Comment";Pt.bTf="HeaderFooter";Pt.Jcg="Note";Pt.qQi="Image";Object(u.a)(Pt,"WordDocumentSearchProcessor",null,[422,11,519]);class rM extends lM{zoc(){var b;return null===(b=y.AFrameworkApplication.J)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}constructor(b,h,r,A,M,ba,oa,Ja,jb,zb,Eb,Sb,nc){super();this.mHa=null;this.UN=(Dc,Zc)=>{Dc=Zc.node;Zc=Zc.property;
this.kCg(Dc)&&Zc===ze.a.Yn&&this.vRb(Dc,3)};this.Rma=(Dc,Zc)=>{Dc=Zc.node;!Zc.Jde&&this.kCg(Dc)&&this.vRb(Dc,1)};this.awb=(Dc,Zc)=>{Dc=Zc.node;this.kCg(Dc)&&this.vRb(Dc,2)};this.$u=b;this.hb=h;this.od=r;this.ib=A;this.JG=M;this.km=Ja;this.Zb=jb;this.M$=ba;this.gE=oa;this.yi=zb;this.FAk=Eb;this.LCh=P.a.create();this.Hte(this.UN,this.Rma,this.awb);nc&&nc.execute(Dc=>this.Wpa=Dc);Sb.execute(Dc=>{this.Z4a=Dc})}submitDocumentContentExtractionSignal(){this.Z4a&&this.Z4a.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.Z4a?
this.Z4a.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.Z4a?this.Z4a.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=this.yN(this.MFm());for(const r of this.yi.GR()){var h=mM.a.r8d(r.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new LA.a,{d0:!1,bta:!1,e0:!0}),r=this.hb.xKa(this.$u.value,h);h=[];const A=[];for(var M=0;M<r.count;++M){var ba=
r.K(M);h.push(...this.mxm(ba,M));A.push(...this.M$.rwm(ba,M))}r=[];M=this.yi.GR();for(ba=0;ba<M.length;ba++)r.push(this.xnm(M[ba]));M={};M.images=h;M.comments=r;M.highlights=A;b(M)}selectRange(b,h,r,A,M){const ba=Date.now(),oa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.H_a();if(0>b||0>h||0>r||0>A||b>r||b===r&&h>A)throw Error("Provided select range offsets incorrect");const Dc=Object.assign(new LA.a,{d0:!1,bta:!0,gLa:this.zoc(),e0:!0}),Zc=
this.hb.xKa(this.$u.value,Dc);if(r>=Zc.count){const Gd=$a.a.instance.resolve(746).GR(),de=r-Zc.count;if(de<Gd.length){M=-1;if(this.M$.Lea.mb(de)){const fe=this.M$.Lea.K(de).SOb;for(var Ja=0;Ja<fe.length;Ja++)if(fe[Ja].Dc===h){M=Ja;break}}this.mHa=-1!==M?Object.assign(new oM,{vqf:de,S0c:M}):null;const he=Gd[de];y.AFrameworkApplication.va.Ob(Hc.a.dX,2);y.AFrameworkApplication.va.Pb(Hc.a.U6,2,null);y.AFrameworkApplication.va.Pb(Hc.a.selectComment,2,Object.assign(new iO.a,{commentId:he.id,wca:2,v4:!1}))}}else{this.mHa=
null;var jb=Zc.K(b),zb=Zc.K(r);if(!this.Fge(jb,h)||!this.Fge(zb,A))throw Error("Provided select range offsets incorrect");y.AFrameworkApplication.va.Ob(Hc.a.dX,2);this.Lnp(jb);var Eb=this.JG.ve(jb,h);Ja=this.JG.Yy(Eb,vc.a.Tc(zb,A+1));if(M){const Gd=Ja.toArray();h=[];for(const de of Gd)h.push(this.d8d(de.node));h.join(" ").includes(M)||(oa.success=!1,oa.message="The text in clicked passage does not match the selected hit")}var Sb=this.km.value.Fw,nc=this.ib.gb.currentSelection;nc&&nc.equals(Ja)&&this.od.Bha(Sb,
null);this.od.Bha(Sb,Ja);oa.duration=Date.now()-ba;this.logMessage(oa)}}catch(Dc){oa.success=!1,oa.message=Dc.stack,oa.duration=Date.now()-ba,this.logMessage(oa)}}search(b,h){this.H_a();this.M$.search(Object.assign(new eL,{query:b}),h)}searchV2(b,h){this.H_a();this.M$.searchV2(Object.assign(new eL,{query:b}),h)}selectNextPrevHighlight(b){this.H_a();return this.M$.selectNextPrevHighlight(b)}searchWithParam(b,h){this.H_a();this.M$.search(b,h)}searchWithParamV2(b,h){this.H_a();this.M$.searchV2(b,h)}highlight(b){this.H_a();
this.M$.highlight(Object.assign(new eL,{query:b}))}highlightWithParam(b){this.H_a();this.M$.highlight(b)}getRevision(){return this.LCh.toString()}getSelectedText(){const b=this.FAk.getSelectedText();return Object.assign(new Pv.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new LA.a,{d0:!1,bta:!0,gLa:this.zoc(),e0:!0}),h=({ft:ba}=this.ALm(b)).returnValue;if(h)return h;var r=this.ib.gb.currentSelection;if(!r||!r.length)return null;
h=r.Qa;r=r.Wc;let A=-1,M=-1;var ba=ba||this.hb.xKa(this.$u.value,b);b=null;for(let oa=0;oa<ba.count;oa++){const Ja=ba.K(oa);-1===A&&h.node.id===Ja.id&&(A=oa,b=Ja);-1===M&&r.node.id===Ja.id&&(M=oa)}ba=null;5===(null===b||void 0===b?void 0:b.$ra)&&(ba=Pt.bTf);if(1===(null===b||void 0===b?void 0:b.$ra)||2===(null===b||void 0===b?void 0:b.$ra))ba=Pt.Jcg;return Object.assign(new nM,{subdocumentId:ba,startParagraphIndex:A,startParagraphOffset:h.Jj,endParagraphIndex:M,endParagraphOffset:r.Wo})}clearDocumentSelection(){fL(this.ib)}selectRangeV2(b,
h,r,A,M,ba){const oa=Date.now(),Ja={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.H_a();if(0>h||0>r||0>A||0>M||h>A||h===A&&r>M)throw Error("Provided select range offsets incorrect");var jb=Object.assign(new LA.a,{d0:!1,bta:!0,gLa:this.zoc(),e0:!0});const nc=this.hb.xKa(this.$u.value,jb);if(b==Pt.Aqf)this.cLj(r,A,nc.count);else{jb=this.mHa=null;var zb={};zb.subdocumentId=b;zb.startParagraphIndex=h;zb.startParagraphOffset=r;zb.endParagraphIndex=
A;zb.endParagraphOffset=M;jb=b==Pt.qQi?this.Xzi(nc.K(h),{isFloatingImage:!1,imageId:"",...zb}):this.WIi(nc.K(h),nc.K(A),{clickedPassage:ba,...zb},Ja);var Eb=this.km.value.Fw,Sb=this.ib.gb.currentSelection;(null===Sb||void 0===Sb?0:Sb.equals(jb))&&this.od.Bha(Eb,null);this.od.Bha(Eb,jb)}Ja.duration=Date.now()-oa;this.logMessage(Ja)}catch(nc){Ja.success=!1,Ja.message=nc.stack,Ja.duration=Date.now()-oa,this.logMessage(Ja)}}selectRangeV3(b){const h=Date.now(),r={activityName:"InDocSelectRangeData",success:!0,
message:"Select Range Succeeded",duration:0};try{this.H_a();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var A=Object.assign(new LA.a,{d0:!1,bta:!0,gLa:this.zoc(),e0:!0});const oa=this.hb.xKa(this.$u.value,A);if(b.subdocumentId==Pt.Aqf)this.cLj(b.startParagraphOffset,
b.endParagraphIndex,oa.count);else{A=this.mHa=null;A=b.subdocumentId==Pt.qQi?this.Xzi(oa.K(b.startParagraphIndex),b):this.WIi(oa.K(b.startParagraphIndex),oa.K(b.endParagraphIndex),b,r);var M=this.km.value.Fw,ba=this.ib.gb.currentSelection;(null===ba||void 0===ba?0:ba.equals(A))&&this.od.Bha(M,null);this.od.Bha(M,A)}r.duration=Date.now()-h;this.logMessage(r)}catch(oa){r.success=!1,r.message=oa.stack,r.duration=Date.now()-h,this.logMessage(r)}}MFm(){const b=Date.now(),h={activityName:"GetParagraphNodes",
success:!0,message:"",duration:0},r=Object.assign(new LA.a,{d0:!1,bta:!1,e0:!0});h.duration=Date.now()-b;this.logMessage(h);return this.hb.xKa(this.$u.value,r)}yN(b){const h=Date.now(),r={activityName:"GetParagraphContent",success:!0,message:"",duration:0},A=new qb.a;for(const M of b)A.add(this.d8d(M));r.duration=Date.now()-h;this.logMessage(r);return A}Xzi(b,h){if(h.isFloatingImage)return h=P.a.Af(h.imageId),b=b.Ic.Eb(h),b=sc.SelectionFactory.Ir(b);const r=this.JG.ve(b,h.startParagraphOffset);return b=
this.JG.Yy(r,vc.a.Tc(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new ar.a(b,"O365",h,b);if(!this.Wpa||!this.Wpa.getPersonaIconPropertiesArray)return null;b=await this.Wpa.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new jO,{authorImageURL:b[0].authorImageURL,authorColor:b[0].authorColor,authorID:b[0].authorID}):null}WIi(b,h,r,A){if(!this.Fge(b,r.startParagraphOffset)||!this.Fge(h,r.endParagraphOffset))throw Error("Provided select range offsets incorrect");
r.subdocumentId==Pt.bTf?y.AFrameworkApplication.va.Pb(Hc.a.xub,2,new Km.a(b)):y.AFrameworkApplication.va.Ob(Hc.a.dX,2);r.subdocumentId==Pt.Jcg?32===y.AFrameworkApplication.va.Pb(Hc.a.Acb,2,new Km.a(b))&&y.AFrameworkApplication.va.Ob(Hc.a.f4d,2):y.AFrameworkApplication.va.Pb(Hc.a.U6,2,null);b=this.JG.ve(b,r.startParagraphOffset);h=this.JG.Yy(b,vc.a.Tc(h,r.endParagraphOffset+1));if(r.clickedPassage){b=h.toArray();const M=[];for(const ba of b)M.push(this.d8d(ba.node));M.join(" ").includes(r.clickedPassage)||
(A.success=!1,A.message="The text in clicked passage does not match the selected hit")}return h}cLj(b,h,r){const A=$a.a.instance.resolve(746).GR();h-=r;if(h<A.length){r=-1;if(this.M$.Lea.mb(h)){const M=this.M$.Lea.K(h).SOb;for(let ba=0;ba<M.length;ba++)if(M[ba].Dc===b){r=ba;break}}this.mHa=-1!==r?Object.assign(new oM,{vqf:h,S0c:r}):null;b=A[h];y.AFrameworkApplication.va.Ob(Hc.a.dX,2);y.AFrameworkApplication.va.Pb(Hc.a.U6,2,null);y.AFrameworkApplication.va.Pb(Hc.a.selectComment,2,Object.assign(new iO.a,
{commentId:b.id,wca:2,v4:!1}))}}H_a(){this.Zb&&(this.Zb.currentScope&&this.Zb.currentScope.name===fi.ND||this.Zb.Eg(fi.ND))}UBp(){this.LCh=P.a.create()}d8d(b){if(b.$Sb)return"";b=this.hb.text(b);return Pn.AParagraphNode.tV(b," ")}Fge(b,h){b=this.d8d(b);return h<b.length}vRb(b,h){switch(h){case 1:case 2:case 3:this.UBp()}}logMessage(b){const h=[Object.assign(new fa.a,{name:"Message",string:b.message})];Object($b.a)(b.activityName,b.success,b.duration,h)}kCg(b){return!b.$Sb&&this.i$c(b)}i$c(b){const h=
this.$u.value;return!!h&&!!h.ud&&!!b.Ic&&b.Ic.id.equals(h.ud.id)}Lnp(b){this.hb.qoc(b)?32===y.AFrameworkApplication.va.Pb(Hc.a.Acb,2,new Km.a(b))&&y.AFrameworkApplication.va.Ob(Hc.a.f4d,2):y.AFrameworkApplication.va.Pb(Hc.a.U6,2,null)}Hte(b,h,r){this.gE&&(this.gE.ro(b),this.gE.wt(h),this.gE.ly(r))}ALm(b){let h=null;if(!this.yi.ou||!this.mHa)return{returnValue:null,ft:h};const r=Array.indexOf(this.yi.GR(),this.yi.ou);if(0>r)return{returnValue:null,ft:h};h=this.hb.xKa(this.$u.value,b);var A=mM.a.r8d(this.yi.ou.text[0]).split("\n");
b=0;A=(1===A.length?A[0]:A.join(" ")).length-1;this.mHa&&r===this.mHa.vqf&&this.M$.Lea.mb(r)&&this.M$.Lea.K(r).SOb.length>this.mHa.S0c&&(b=this.M$.Lea.K(r).SOb[this.mHa.S0c].Dc,A=this.M$.Lea.K(r).SOb[this.mHa.S0c].end);return{returnValue:Object.assign(new nM,{startParagraphIndex:h.count+r,startParagraphOffset:b,endParagraphIndex:h.count+r,endParagraphOffset:A,subdocumentId:"Comment"}),ft:h}}mxm(b,h){const r=[];if(12!=b.type)return r;r.push(...this.Lxm(b,h));r.push(...this.num(b,h));return r}num(b,
h){const r=[],A=zc.a.Za(b);if(!A.ZA())return r;let M=A.$d();for(;M;){if(!this.mXa(M)){M=A.Fu();continue}const ba=M.properties;ba&&je.a.E9c(ba)&&r.push(this.Z2j(ba,h,0,b.Ic,!0,M.id.toString()));M=A.Fu()}return r}mXa(b){if(19!==b.type||5!==je.a.Ak(b))return!1;b=zc.a.Za(b);if(!b.ZA())return!0;let h=b.$d();for(;h;){if(59===h.type)return!1;h=b.Fu()}return!0}Lxm(b,h){const r=[],A=b.Ic;if(A){if(!b.hasProperty(ze.a.Zn))return r;var M=b.ka(ze.a.Zn,null);if(!M)return r;b=b.ka(ze.a.Dn,null);for(let oa=0;oa<
M.length;++oa){var ba=M[oa];if(!ba)continue;ba=A.Eb(ba);if(!ba||!je.a.E9c(ba)||5!==je.a.Ak(ba))continue;let Ja=0;0!=oa&&b&&oa-1<b.length&&(Ja=b[oa-1]);r.push(this.Z2j(ba,h,Ja,A,!1,""))}return r}}Z2j(b,h,r,A,M,ba){A=(new Sys.Net.WebRequest).getResolvedUrl()+je.a.kEm(b,A);const oa=b.ka(Bd.a.Hu,""),Ja={};Ja.base64Encoding=oa;Ja.url=A;Ja.width=je.a.LF(b);Ja.height=je.a.HL(b);Ja.altText=je.a.I_(b);Ja.description=je.a.$Va(b);Ja.imageId=ba;Ja.isFloatingImage=M;return{data:Ja,startParagraphIndex:h,endParagraphIndex:h,
startOffsetInParagraph:r,endOffsetInParagraph:r+1}}xnm(b){return{data:{comment:pM(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(u.a)(rM,"WordDocumentContentExecutor",lM,[]);class JI{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(u.a)(JI,"BaseDocumentHelper",null,[573]);class aP extends JI{constructor(b){super();this.ofm=b}get ohc(){const b=
this.ofm.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return qa.StaticActiveAppFrame.za().kb.isEditingAllowed}author(){var b;return null===(b=this.ohc)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.ohc)||void 0===b?void 0:b.creationDate}}Object(u.a)(aP,"WordDocumentHelper",JI,[]);class iC{constructor(b){this.qbj=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.YVf(b.htmlText)}getId(){return"InsertContentExecutor"}YVf(b){return this.executeCommand(ub.a.Vqa,
b)}executeCommand(b,h){const r=new ji.DictionaryPropertySet;r.setValue(Bd.a.hY,h);r.setValue(Bd.a.$Da,!1);h=this.qbj.Ob(b,1);32===h&&(h=this.qbj.Pb(b,2,r));return h}}Object(u.a)(iC,"WordInsertContentExecutor",null,[518,440]);var bP=d(1716),mO=d(1717);class sM{constructor(b,h,r,A,M){this.aGc="undefined";this.GBg="Something went wrong with retrieving a summary. Please try again.";this.ufn=(ba,oa,Ja,jb,zb)=>ku.g0(ba,oa,Ja,jb,this.dE,zb);this.zze=(ba,oa,Ja,jb,zb)=>{if(1===Ja)return this.IBk?32:8;ba=jv.getSelectedText();
ba=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,jv.F8d(ba));zb[al.a.LabelText]=ba;return 32};this.yGf=(ba,oa,Ja)=>{if(1===Ja)return 32;const jb={};this.Z4a?this.Z4a.generateDocumentSummary().then(zb=>{zb||(zb=this.GBg,v.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));jb.additionalData=this.Psf(zb);this.ga.Pb(La.a.Maa,2,jb)}).catch(()=>{v.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");
jb.additionalData=this.Psf(this.GBg);this.ga.Pb(La.a.Maa,2,jb)}):(v.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),jb.additionalData=this.Psf(this.GBg),this.ga.Pb(La.a.Maa,2,jb));return 32};this.Lpp=(ba,oa,Ja)=>{if(!this.dcj)return v.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),8;if(1===Ja)return this.Ivn()?32:2;if(2===Ja)this.dcj.G9d(this.Ga.jb("SmartLookupShredderServiceEndpoint")).then(jb=>{jb={token:jb,
files:G.c(this.itm()),type:"MultiFilesDeckGeneration"};jb=Object.assign(new bP.a,{selection:Object.assign(new Pv.a,{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:Object.assign(new st.a,{landingTab:"All",data:jb}),entryPoint:38});this.ga.Pb(La.a.jba,2,jb);return 32}).catch(()=>{v.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");return 8});else return 32};this.dE=b;this.ga=h||y.AFrameworkApplication.va;this.Ga=r;this.oBk=(this.ay=!!y.AFrameworkApplication.ta&&
y.AFrameworkApplication.ta.Hb.A3)&&!!this.Ga&&this.Ga.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.IBk=!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);A&&A.execute(ba=>{this.Z4a=ba});this.dcj=M}Wb(){this.ga.fb(Hc.a.HVh,xe.a.frame,this.ufn,1028);this.ga.fb(Hc.a.zze,xe.a.frame,this.zze,1028);this.ga.fb(Hc.a.esi,xe.a.frame,this.yGf,1028);this.ga.fb(Hc.a.$2j,xe.a.frame,this.Lpp,1028);this.oBk&&(this.aGc=qa.StaticActiveAppFrame.za().fL.getWindowMode(),
this.rki(this.aGc),qa.StaticActiveAppFrame.za().fL.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.aGc&&(this.aGc=h,this.rki(this.aGc))}))}Ivn(){return y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",!1)}rki(b){"DP"===b&&hm.UISurfaces.Ov().then(h=>{h.selectors.getTabbedTaskPaneCount()||
this.ga.Pb(Hc.a.HVh,2,{SourceControlId:"smartlookupAuto"});return null})}Psf(b){return{["documentSummary"]:b}}itm(){const b=new mO.a("docx",y.AFrameworkApplication.J.jb("EditDocInClientUrl"),y.AFrameworkApplication.J.jb("BreadcrumbBrandUrl"),"",y.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(u.a)(sM,"WordInsightsActor",null,[]);class YD{constructor(){this.Tyd=this.kT=null}G9a(){return this.gQb()}xAi(){return this.gQb()}vAi(){return null}X9o(b,
h,r){this.kT||(this.kT=this.EYd());this.kT.yS(b,h,r)}Y9o(b,h,r){this.kT||(this.kT=this.EYd());this.kT.ODg(b,h,r)}n8o(b,h){this.Tyd||(this.Tyd=null);this.Tyd&&this.Tyd.ODg(b,h)}H_b(b,h){this.kT||(this.kT=this.EYd());this.kT.H_b(b,h)}qhe(b){this.kT||(this.kT=this.EYd());this.kT.qhe(b)}tRo(){this.kT&&this.kT.Qwc()}iWo(){this.kT&&this.kT.txe()}A7o(){var b=y.AFrameworkApplication.J.fc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-YD.e6i<=b;b||(YD.e6i=window.performance.now());
return b}dispose(){this.kT&&(this.kT.dispose(),this.kT=null)}get GTb(){return this.kT?this.kT.isVisible:!1}}YD.e6i=0;Object(u.a)(YD,"InsightsManager",null,[1963,11]);class KI{constructor(b,h,r,A,M,ba=!0,oa=null,Ja=null){this.z9=this.IG=this.ERa=null;this.tKc=!1;this.Via=null;this.Zb=h;this.E8b=ba;this.sfh=Ja?Ja:new JI;this.Bv=oa;this.kq=b;this.E8b&&($a.a.instance.Oa(1173)&&(this.Via=$a.a.instance.resolve(1173).DKf()),this.flb=$a.a.instance.resolve(1178),this.DJb=this.flb.L4c())}Xvb(b){if(this.E8b){b=
b.rawEvent;try{var h=G.a(b.data)}catch(r){v.ULS.sendTraceTag(595161728,1303,15,this.mX("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.IG&&(b=this.IG.entryPoint);this.flb.hOf(this.z9,this.sfh,this.ylc(),b).then(r=>{h.data=r;this.Mwb(h)});break;case 118:h.data=this.IG?this.IG:Object.assign(new Ys.a,{selection:Object.assign(new Pv.a,{neighborhood:this.ERa.neighborhood,mentionStart:this.ERa.mentionStart,mentionLength:this.ERa.mentionLength})});
this.Mwb(h);break;case 103:b=G.a(Object(Ma.a)(String,h.data));Nl.sendTelemetryEvent(b);break;case 206:this.flb.G9d(h.data).then(r=>{h.data=r;this.Mwb(h)});break;case 112:h.data.shiftPressed?(X.a.yj&&document.activeElement.blur(),this.kq.w$d(0,null,2,null,null),v.ULS.sendTraceTag(592545156,1303,50,this.mX("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.kq.H5c(0,null,2,null,null),v.ULS.sendTraceTag(592545155,1303,50,this.mX("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Vsa()}}}Pmd(b){if(this.Via){var h=
0;this.IG&&(h=this.IG.entryPoint);this.flb.hOf(this.z9,this.sfh,this.ylc(),h).then(r=>{Nl.cMj("SearchFromHost",this.z9);this.IG.launchData||(this.IG.launchData=new st.a);const A=hC();try{this.Via.search(this.IG,r,y.AFrameworkApplication.userSessionId,A,b),this.flb.Ico(M=>{Nl.cMj("SearchFromHostWithToken",this.z9);this.Via.searchAuthenticatedProviders(this.IG,r,y.AFrameworkApplication.userSessionId,A,null,M)})}catch(M){Nl.mB("BaseSmartLookupPane - Fail to search from host. Error: "+M,10)}}).catch(r=>
{Nl.mB("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+r.toString(),10)})}}Rwc(b){if(this.E8b){var h=Nl,r=h.Rwc,A=this.z9;b=Math.round(window.performance.now()-b);var M=this.IG?FI[this.IG.entryPoint]:"",ba=this.flb.L4c(),oa=this.flb.$sm(),Ja=this.IG?this.IG.entryPoint:0;r.call(h,A,b,M,ba,oa,y.AFrameworkApplication.Nhf,this.tKc,18===Ja||19===Ja||15===Ja)}}}Object(u.a)(KI,"BaseSmartLookupPane",null,[560,11]);class LI{constructor(b){this.messageType=null;this.messageType=
b}}Object(u.a)(LI,"InsightsMessage",null,[]);class iG extends LI{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(u.a)(iG,"InsightsMessageWithContent",LI,[]);class nO extends iG{constructor(b){super(fi.SOn,b)}}Object(u.a)(nO,"InsightsMessageAppProperties",iG,[]);class oO extends iG{constructor(b){super(fi.cPn,b)}}Object(u.a)(oO,"InsightsMessageSelection",iG,[]);class pO extends LI{constructor(){super(fi.ePn)}}Object(u.a)(pO,"InsightsMessageTakeFocus",LI,[]);class gL extends KI{constructor(b,
h,r,A,M=null,ba=null,oa=null,Ja=!0,jb=null,zb=null){super(h,r,M,ba,oa,Ja,jb,zb);this.Uxd=this.NC=this.Qj=null;this.YId=!1;this.T0n=Eb=>{Eb===this.Qj&&this.Vsa()};this.Osc=()=>{v.ULS.sendTraceTag(6295951,1303,50,this.mX("The iframe is successfully loaded in Insights task pane"))};this.Wvb=()=>{v.ULS.sendTraceTag(6295952,1303,15,this.mX("The iframe failed to load in Insights task pane"))};this.QDd=b;this.bJc=this.E8b?jM(this.DJb):y.AFrameworkApplication.vdn;this.u2();this.urg();this.Vp=A;this.geh=0}get isVisible(){return!1}u2(){this.Qj=
this.QDd.iYc();y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb.Ntb&&this.Qj.Cxo(b=>{b===this.Qj&&(this.txe(),this.Qwc())});this.BVf(this.Qj.e0a.vWh);this.Qj.An()}BVf(b){b.style.overflow="hidden";const h=Yg.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.NC=h;b.appendChild(this.NC);this.NC.id=fi.cUf}urg(){uf.a.addHandler(this.NC,"load",this.Osc);uf.a.addHandler(this.NC,"error",this.Wvb);$addHandler(window,"message",
Object(F.a)(this,this.Xvb,"onIFrameMessage"))}pLg(){uf.a.removeHandler(this.NC,"load",this.Osc);uf.a.removeHandler(this.NC,"error",this.Wvb);$removeHandler(window,"message",Object(F.a)(this,this.Xvb,"onIFrameMessage"))}dispose(){this.NC&&(this.pLg(),this.NC.parentNode.removeChild(this.NC),this.NC=null);this.Qj&&(this.QDd.ghc(this.Qj),this.Qj=null)}yS(b,h,r){this.z9=h;this.Uxd=null;this.geh=r;this.tKc=!b.mentionLength;this.YId=!1;v.ULS.sendTraceTag(6295947,1303,50,this.mX("Start to show Insights"));
this.ERa=b;this.bJc&&this.bJc.length?this.NC.src=this.bJc:(this.NC.src=gL.qij,v.ULS.sendTraceTag(6295948,1303,15,this.mX("The Insights URL config setting is null or empty")));this.Vp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.Qj.n0||this.Qj.Arg(this.T0n);this.E8b&&this.Pmd(!1);b=window.performance.now();this.QDd.showTaskPane(this.Qj);this.Qj.An();this.Rwc(b)}ODg(b,h,r){this.IG=b;this.yS(Object.assign(new EI.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength}),h,r)}H_b(){}qhe(){}Qwc(){this.NC.src===this.bJc&&this.YId&&(this.Zb.Eg(fi.ND),this.Mwb(new pO))}txe(){this.NC&&rd.FocusManager.bO(this.NC.contentWindow)}awf(){this.NC.src=gL.qij;this.Qj.Bn()}Vsa(){this.QDd.hideTaskPane(this.Qj);this.awf()}Xvb(b){const h=b.rawEvent;if(h.source===this.NC.contentWindow)if(this.E8b)super.Xvb(b);else{let r;try{r=G.a(h.data)}catch(A){v.ULS.sendTraceTag(6295953,1303,15,this.mX("Message data [{0}] failed to deserialize.",h.data));
return}if(Mf.c(r.messageType))v.ULS.sendTraceTag(6295954,1303,15,this.mX("Message data [{0}] is in wrong format.",h.data));else switch(r.messageType){case fi.TOn:this.Mwb(new nO(this.Vxm()));break;case fi.dPn:this.Mwb(new oO(this.ERa));break;case fi.ZOn:this.YId=!0;this.txe();this.Qwc();v.ULS.sendTraceTag(6295955,1303,50,this.mX("Insights pane rendering is completed"));break;case fi.fPn:b=r.messageContent;this.Uxd=b.clientCorrelationId;this.z9!==b.appCorrelationId&&v.ULS.sendTraceTag(6403778,1303,
15,this.mX("App correlation ID on client {0} does not match one on server {1}",this.z9,b.appCorrelationId));break;case fi.YOn:r.messageContent?(X.a.yj&&document.activeElement.blur(),this.kq.w$d(0,null,2,null,null),v.ULS.sendTraceTag(6604741,1303,50,this.mX("Insights UX lost focus through Ctrl + Shift + F6"))):(this.kq.H5c(0,null,2,null,null),v.ULS.sendTraceTag(6604742,1303,50,this.mX("Insights UX lost focus through Ctrl + F6")));break;case fi.VOn:r.messageContent.keyCode===rf.a.cgb&&this.Vsa();break;
case fi.WOn:try{this.YId=!1,localStorage.setItem(fi.$6i,"true")}catch(A){v.ULS.sendTraceTag(17961859,1303,10,this.mX("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}Vxm(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.z9;3===y.AFrameworkApplication.ta.Hb.Uk?b.applicationName=fi.qMp:4===y.AFrameworkApplication.ta.Hb.Uk&&(b.applicationName=fi.l7n);b.applicationVersion=y.AFrameworkApplication.buildVersion;var h=Ag.a.Hg(y.AFrameworkApplication.lcid);h=h?h.name:
null;b.market=bL(h);b.uiLanguage=h;b.sessionId=y.AFrameworkApplication.userSessionId;b.parentalControl=fi.Wjg;b.clientType="user";b.legalAgreed=this.ezm();b.defaultDefineTab=1===this.geh?"true":null;return b}mX(b,...h){const r={};this.z9&&(r[fi.s0j]=this.z9);this.Uxd&&(r[fi.Pkp]=this.Uxd);r[fi.t0j]=String.format.apply(null,[b].concat(h));return G.c(r)}ylc(){return 5}ezm(){try{const b=localStorage.getItem(fi.$6i);return!!b&&"true"===b}catch(b){return v.ULS.sendTraceTag(17961860,1303,10,this.mX("Failed to GetItem in LocalStorage for LegalAgreed")),
!1}}Mwb(b){b=G.c(b);this.NC.contentWindow.postMessage(b,Fa.a.getOrigin(this.bJc))}}gL.qij="about:blank";Object(u.a)(gL,"InsightsPane",KI,[]);class ZD{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(u.a)(ZD,"SmartLookupTaskPaneProps",null,[]);class tM{}Object(u.a)(tM,"ActionDescriptor",null,[]);class MI extends KI{constructor(b,h,r,A=null,M=null,ba=null,oa=!0,Ja=null,jb=null){super(h,r,A,M,ba,oa,Ja,jb);this.daf=!!y.AFrameworkApplication.ta&&!!y.AFrameworkApplication.ta.Hb&&y.AFrameworkApplication.ta.Hb.J1f;
this.Xt=this.b6e=!1;this.wFk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.uFk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.zFk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.yFk=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);this.cpj=
()=>{if(this.Via)this.Via.onPaneThemeChanged(this.ylc());return zg.a("getTheme")?appChrome.api.getTheme():null};this.Wvb=()=>{Nl.mB("ReactSmartLookupPane - Iframe component failed to load.",10)};this.Osc=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||Nl.mB("ReactSmartLookupPane - Onload detected no network.",50)};oa||Nl.mB("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",
10);this.WGa=b;this.$lh=jM(this.DJb)}get isVisible(){return this.Xt}H_b(b,h){this.IG=b;this.ERa=b=Object.assign(new EI.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.tKc=!b.mentionLength;this.z9=h;this.Pmd(!1)}qhe(b){this.IG=b;this.nyc(Object.assign(new EI.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}yS(b,h){this.z9=h;this.nyc(b,!0)}ODg(b,h,
r){this.IG=b;this.yS(Object.assign(new EI.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}Vsa(){this.tha();this.WGa.hideTaskPane()}nyc(b,h){fc.SessionStatusManager.instance.cB&&this.Via?(this.ERa=b,this.tKc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?y.AFrameworkApplication.J.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.WGa.updateTaskPane(null),h&&this.aSo()):(h&&this.Pmd(!1),this.b6e=
!this.b6e,this.WGa.updateTaskPane(this.TB())):(h&&this.Pmd(this.isVisible),this.WGa.showTaskPane(this.TB())),this.Rwc(b)):(this.WGa.showTaskPane(this.TB()),Nl.vRo(fc.SessionStatusManager.instance.cB,!!this.Via,this.IG?FI[this.IG.entryPoint]:"",this.flb.L4c(),y.AFrameworkApplication.Nhf,this.tKc))}aSo(){if(!this.IG){const b=Object.assign(new Pv.a,{neighborhood:this.ERa.neighborhood,mentionStart:this.ERa.mentionStart,mentionLength:this.ERa.mentionLength});this.IG=Object.assign(new Ys.a,{selection:b,
userIntent:null,entryPoint:0,launchData:null})}this.Pmd(this.isVisible)}HRo(){const b=new tM;b.transactionId=this.z9;b.actionType=15;b.channelId=fi.channelId;this.Mwb(b)}Xvb(b){const h=b.rawEvent;document.getElementById(fi.ND)&&h.source!==document.getElementById(fi.ND).contentWindow||this.gqo(b)}gqo(b){const h=b.rawEvent;let r;try{r=G.b(h.data)}catch(A){v.ULS.sendTraceTag(545604257,1303,15,this.mX("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(r.actionType){case 32:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",
!1)&&(xd.a.zrb()>=this.wFk?this.WGa.updateTaskPane(this.Buf(this.uFk)):xd.a.zrb()>=this.zFk&&this.WGa.updateTaskPane(this.Buf(this.yFk)));break;case 33:y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.WGa.updateTaskPane(this.Buf(r.data));break;case 42:this.WGa.updateTaskPane(this.YLl(r.data));break;case 43:this.WGa.updateTaskPane(this.TB());break;default:super.Xvb(b)}}dispose(){}initialize(){this.u2();this.Ina()}u2(){this.WGa.iYc()}Ina(){const b=
this.Zb.ie(fi.ND);b.parent=pd.AFrame.Kq;b.YL=!0}pWo(){this.Zb.Eg(fi.ND)}tha(){this.bbb()&&this.Zb.Eg(this.Zb.bX)}urg(){$addHandler(window,"message",Object(F.a)(this,this.Xvb,"onIFrameMessage"))}pLg(){$removeHandler(window,"message",Object(F.a)(this,this.Xvb,"onIFrameMessage"))}bbb(){return!!this.Zb.currentScope&&this.Zb.currentScope.name===fi.ND}Mwb(b){b=G.c(b);document.getElementById(fi.ND)&&document.getElementById(fi.ND).contentWindow.postMessage(b,Fa.a.getOrigin(this.$lh))}mX(b,...h){const r={};
this.z9&&(r[fi.s0j]=this.z9);r[fi.t0j]=String.format.apply(null,[b].concat(h));return G.c(r)}ylc(){return zg.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}Qwc(){}txe(){document.getElementById(fi.ND)&&rd.FocusManager.bO(document.getElementById(fi.ND).contentWindow)}Irm(){return this.IG?10===this.IG.entryPoint?2===y.AFrameworkApplication.ta.Hb.Uk?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.IG.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:
37===this.IG.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.IG.entryPoint||38===this.IG.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}TB(){var b=CommonUIStrings.L_SmartLookupPaneTitle;y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&(b=this.Irm());const h=new ZD;h.src=this.$lh;h.id=fi.ND;h.refreshPane=this.b6e;h.onError=this.Wvb;h.onLoad=this.Osc;h.title=b;fc.SessionStatusManager.instance.cB?
this.Via||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new On.a,{title:b,hideHeader:!1,width:fi.width,location:fi.R$n,contentProps:h,isModernPane:!0,onOpen:()=>{this.pWo();this.Xt=!0;this.urg();zg.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(this.cpj);y.AFrameworkApplication.ta.Fe();if(this.Via)this.Via.onPaneStateChanged(!0)},
onClose:()=>{this.HRo();this.tha();this.Xt=!1;this.pLg();zg.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(this.cpj);y.AFrameworkApplication.ta.Fe();if(this.Via)this.Via.onPaneStateChanged(!1)}});this.daf&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}YLl(b){const h=this.TB();h.title=b;h.contentProps.title=b;return h}Buf(b){const h=this.TB();h.resizeWidth=b;return h}}Object(u.a)(MI,"ReactSmartLookupPane",KI,[]);class cP{iYc(){const b=new Vo.a(Li.a.B6a,
WordEditorIntl.WordEditorStrings);return rp.a.instance.mbi(fi.ND,fi.Htc,fi.width,fi.MHg,b)}showTaskPane(b){rp.a.instance.showTaskPane(b)}hideTaskPane(b){rp.a.instance.hideTaskPane(b)}ghc(b){rp.a.instance.ghc(fi.ND,b)}}Object(u.a)(cP,"WordInsightsPaneHandler",null,[546]);class uM{iYc(){rp.a.instance.GUa()}showTaskPane(b){hm.UISurfaces.Ov().then(h=>{h.showTaskPane(fi.ND,b);return null})}updateTaskPane(b=null){hm.UISurfaces.Ov().then(h=>{h.setSelectedTaskPane(fi.ND);b&&h.updateTaskPane(fi.ND,b);return null})}hideTaskPane(){hm.UISurfaces.Ov().then(b=>
{b.hideTaskPane(fi.ND,2);return null})}}Object(u.a)(uM,"WordReactSmartLookupPaneHandler",null,[545]);class c extends YD{constructor(b,h){super();this.Qy=b;this.ib=h}EYd(){const b=!!y.AFrameworkApplication.ta&&!!y.AFrameworkApplication.ta.Hb&&y.AFrameworkApplication.J.$("SmartLookupEnableNativePane");return y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Hb&&y.AFrameworkApplication.ta.Hb.z0f?new MI(new uM,kp.a.instance,rd.FocusManager.instance(),$a.a.instance.resolve(1179),$a.a.instance.resolve(1180),
$a.a.instance.resolve(1181),b,$a.a.instance.Ra(4),$a.a.instance.resolve(1182)):new gL(new cP,kp.a.instance,rd.FocusManager.instance(),$a.a.instance.resolve(25),$a.a.instance.resolve(1179),$a.a.instance.resolve(1180),$a.a.instance.resolve(1181),b,$a.a.instance.Ra(4),$a.a.instance.resolve(1182))}gQb(){return this.Qy.getSelectedText()}vAi(){if(!this.ib||!this.ib.gb||1>this.ib.gb.length)return null;var b=this.ib.gb.currentSelection.Qa;b=null==b?null:xa.FormattingReader.Us(b);return(b=null==b?null:Ag.a.Hg(xa.FormattingReader.language(b)))?
b.name:""}G9a(){return this.Qy.UNf()}xAi(){return this.Qy.UNf()}BZi(){return this.Qy.hjn()}}Object(u.a)(c,"WordInsightsManager",YD,[]);var k=d(216);class t{}Object(u.a)(t,"CommandMetadataResponse",null,[]);class B{constructor(){this.eUf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){k.PrivacyDialogManager.xze()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=
new t;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const r=appChrome.selectors.getControlIconSet(b.commandId),A=Array(2);A[0]=r["default"];A[1]=r.icon32;h.svgData=this.getCommandIconSvg(A)}catch(r){return null}return h}getCommandIconSvg(b){if(!this.eUf)return"";
for(let h=0;h<b.length;h++){const r=b[h];if(r in this.eUf)return this.eUf[r]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const r={};r.featureArea=B.q7l;h.telemetryGroup=r;h.appData=b;return h}}B.FOi="FA000000012";B.queryPrefix="AssetID=";B.q7l="SearchPane";Object(u.a)(B,"BaseSerpletExecutor",null,[439,440]);class N extends B{constructor(b,
h){super();this.ga=b;this.ib=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Pb(ub.a.KUb,2,null);break;case 1:this.ga.Pb(Hc.a.Z0b,2,null);break;case 2:this.ga.Pb(ub.a.tZc,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Pb(La.a.Lce,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Pb(La.a.z_b,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Pb(La.a.RDf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};fL(this.ib);this.ga.Pb(La.a.RDf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Pb(La.a.Kic,2,h)}openNavigationPane(){this.ga.Pb(Hc.a.jyc,2,null)}openSerpletTaskPane(){this.ga.Pb(La.a.TUi,2,null)}sendAutoLaunchSearchRequest(){this.ga.Pb(La.a.Fce,2,null)}getAllIcons(){const b=
{};for(const r of Object.keys(window))if(r.startsWith("word")){var h=window[r];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(A=>b[A.id]=JSON.stringify(A)))}return b}}Object(u.a)(N,"WordSerpletExecutor",B,[]);class da extends HI{constructor(){super();this.m3e=null;this.nz=()=>{y.AFrameworkApplication.m3&&(this.xZl(),bt.a.Bm().then(()=>this.m3e.resolve(1186)))}}get name(){return"WordEditor.Insights"}init(){y.AFrameworkApplication.m3&&(this.m3e.Oa("WordEditor.Insights.WordInsightsActor").Wb(),
y.AFrameworkApplication.J.$("SmartLookupEnableNativePane")&&y.AFrameworkApplication.J.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?y.AFrameworkApplication.J.xp(this.nz):super.init())}uc(b){super.uc(b);this.m3e=b;b.ia("Box4.Insights.Box4InsightsSelection",()=>new Zr.a).as(1185).as(1061).ha();b.ia("WordEditor.Insights.WordInsertContentExecutor",()=>new iC(y.AFrameworkApplication.va)).as(1181).ha();b.ia("WordEditor.Insights.WordSerpletExecutor",()=>new N(y.AFrameworkApplication.va,$f.a.instance)).as(1180).ha();
b.ia("WordEditor.Insights.AugloopSearchProviderManager",()=>new II(b.resolve(1183))).as(1186).ha();b.ia("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new Pt(new Pf.a(()=>qa.StaticActiveAppFrame.za()?qa.StaticActiveAppFrame.za().kb.ed:null),b.resolve(164),cO.a.instance,y.AFrameworkApplication.J,tw.a.instance,hM.a.instance,b.resolve(1184),b.resolve(746),y.AFrameworkApplication.va,$f.a.instance,b.resolve(870));h.initialize();return new rM(new Pf.a(()=>qa.StaticActiveAppFrame.za()?qa.StaticActiveAppFrame.za().kb.ed:
null),b.resolve(164),Object(Jb.a)(),$f.a.instance,b.resolve(870),h,df.a.ff.Pl.jf(12),new Pf.a(()=>qa.StaticActiveAppFrame.za().kb),rd.FocusManager.instance(),b.resolve(746),b.resolve(1185),b.Ra(1186),b.Ra(143))}).as(1179).ha();b.ia("WordEditor.Insights.WordInsightsManager",()=>new c(b.resolve(1185),b.resolve(327))).as(1175).ha();b.ia("WordEditor.Insights.WordInsightsActor",()=>new sM(b.rf(1175),y.AFrameworkApplication.va,y.AFrameworkApplication.J,b.Ra(1186),b.resolve(1178))).ha();b.ia(1182,()=>new aP(b.Ra(1187))).ha()}}
Object(u.a)(da,"WordInsightsPackage",HI,[]);class ta{}Object(u.a)(ta,"ScalingStep",null,[]);class Qa{constructor(b,h,r){this.FJc=!1;this.WS=null;this.QQc=this.p8b=!1;this.h5a=[];this.Yue=A=>{this.sda&&this.sda!==A&&appChrome.api.dispatch(this.yGi(!1))};h.execute(A=>{this.WS=A});b.BA(Object(F.a)(this,this.d5n,"onProcessSetSelectionFinished"));this.yr=r}ilc(b,h,r){const A=[];for(const M of b)A.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:M},r));return A}VEi(b){const h=[];for(let r=
0;4>r;r++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>r?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return h}yGi(b){const h=[];if(b)switch(this.sda){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.VEi("PictureStyles"));h.push(...this.ilc("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),
"DropLabel"));b=this.h5a.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.ilc(b,"MoveToOverflow"));break;case "Table":this.QQc||h.push(...this.VEi("TableStyles"));h.push(...this.ilc(this.h5a,"DropLabel",this.QQc?0:void 0));b=this.h5a.slice().reverse();h.push(...this.ilc(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.ilc(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.h5a.slice().reverse(),h.push(...this.ilc(b,"MoveToOverflow"))}else for(const r of this.h5a)h.push(appChrome.actions.removeControlScalingStepsFromTab(r,
"Home"));return h}Ysd(b){const h={};for(const r of b)try{h[r]=appChrome.selectors.getModelType(r)}catch(A){this.LI("Error","GetModelType failed for "+r)}qa.StaticActiveAppFrame.za().t4d(h)}swp(b){if(0!==b.length){var h=[],r={},A=!1;for(const M of b)try{if(appChrome.selectors.isControlDefined(M))r[M]=appChrome.selectors.getModelType(M);else{A=!0;break}}catch(ba){this.LI("Error","GetModelType failed for "+M);A=!0;break}if(A)this.sda=void 0,this.QEe(!1);else{if("Image"===this.sda&&!this.p8b)h.push(appChrome.actions.updateGroupHiddenState("Font",
!0)),this.p8b=!0;else if(this.p8b){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));A=appChrome.selectors.getVisibleControlsInGroup("Font");for(const M of A)r[M]=appChrome.selectors.getModelType(M);this.p8b=!1}qa.StaticActiveAppFrame.za().t4d(r);this.h5a=b;r=[];for(const M of b)appChrome.selectors.isControlDisabled(M)&&r.push(M);0<r.length&&this.LI("Disabled",r.join(","));0<this.h5a.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",
this.h5a)),h.push(...this.yGi(!0)),this.FJc=!0);appChrome.api.dispatch(h)}}}QEe(b){if(b||this.FJc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.FJc=b;if("Image"===this.sda||this.p8b){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const r=appChrome.selectors.getVisibleControlsInGroup("Font");this.Ysd(r)}this.p8b=!b}appChrome.api.dispatch(h)}}EAc(){this.FJc&&this.yr&&this.yr.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}d5n(b,
h){!y.AFrameworkApplication.ta.Hb.Vxc&&"Home"===appChrome.selectors.getSelectedTabId()&&this.WS&&h.Tm&&h.Tm.currentSelection&&0!==h.Tm.length?(b=()=>{let r=[],A=!1;var M=this.WS.contentType,ba=appChrome.selectors.getActiveContextualTabIds();M.includes("Image")?(this.Yue("Image"),this.sda&&"Image"===this.sda?A=!0:(r="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),
this.sda="Image")):M.includes("Table")&&0<=ba.indexOf("Table")?(M=!(kt.a.instance.currentSelection.XLa||kt.a.instance.currentSelection.Ww||kt.a.instance.currentSelection.abb),(ba="Table"===this.sda&&M!==this.QQc)?this.Yue("TableCellEdit"):this.Yue("Table"),!this.sda||"Table"!==this.sda||ba?(M?(r=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.QQc=!0):(r="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.QQc=!1),this.sda="Table"):A=!0):M.includes("Hyperlink")&&(this.Yue("Hyperlink"),this.sda&&"Hyperlink"===this.sda?A=!0:(r=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.sda="Hyperlink"));A?this.FJc||(this.Ysd(this.h5a),this.QEe(!0),this.EAc()):0<r.length?(this.swp(r),this.EAc()):this.QEe(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.QEe(!1)}LI(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};
h=new Dh.a;h.name="Events";h.dataFields=Rg.a.qI(b);h.durationMs=window.performance.now();ca.a.XNa(h,"TellMeWAC.")}}Object(u.a)(Qa,"AdaptiveTabGroupUpdater",null,[]);class lb{constructor(){this.Z=null;this.oXn=()=>{y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.Z.ia(1188,()=>new Qa(this.Z.resolve(327),this.Z.Ra(5),this.Z.Ra(2))).ha(),this.Z.resolve(1188))}}get name(){return"WordEditor.RibbonIntelligence"}uc(b){this.Z=b}init(){Aw.a(1,
this.oXn)}dispose(){}}Object(u.a)(lb,"PackageManager",null,[0,1]);var Hb=d(1854),ac=d(1078),Ec=d(1851);const bd=(b,h,r)=>1===r?32:2===r?(d.e(5).then(d.bind(null,2146)).then(A=>{A.createAndShowDevToolsMenu()}),32):2;class sd{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",!1))y.AFrameworkApplication.va.qa(Hc.a.nDg,xe.a.frame,bd),null!==sessionStorage.getItem("devToolsRefresh")&&
d.e(5).then(d.bind(null,2146))}dispose(){}uc(b){x(b)}static main(){E.a.instance.Mc(new sd)}}Object(u.a)(sd,"WordDevToolsPackage",null,[0,1]);d(584);class Nd{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(u.a)(Nd,"FormattingData",null,[]);class be extends Nd{constructor(){super();this.hyperlinkData=null}}Object(u.a)(be,"RichContentCommandData",Nd,[]);class $d{constructor(){var b;$d.zj.add(Hc.a.ffb);$d.zj.add(Hc.a.z1b);$d.zj.add(Hc.a.jzc);
$d.zj.add(Hc.a.V0);$d.zj.add(Hc.a.mcg);$d.zj.add(Hc.a.Bmg);$d.zj.add(Hc.a.deleteComment);$d.zj.add(Hc.a.UYc);$d.zj.add(Hc.a.xwf);$d.zj.add(Hc.a.Oze);$d.zj.add(Hc.a.w0a);$d.zj.add(Hc.a.nDg);$d.zj.add(Hc.a.Z0b);$d.zj.add(Hc.a.uDg);$d.zj.add(Hc.a.UZc);(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadPDFWithoutCommentsIsEnabled",!1))&&$d.zj.add(Hc.a.t0d);$d.zj.add(Hc.a.s0d);$d.zj.add(ub.a.tZc);$d.zj.add(ub.a.bY);$d.zj.add(ub.a.print);$d.zj.add(ub.a.rre);
$d.zj.add(ub.a.kpg);$d.zj.add(ub.a.readingMode);$d.zj.add(ub.a.KUb);$d.zj.add(La.a.O1j);$d.zj.add(La.a.su);$d.zj.add(La.a.ord);$d.zj.add(La.a.z_b);$d.zj.add(La.a.Fla);$d.zj.add(La.a.wpd);$d.zj.add(La.a.fDg);$d.zj.add(La.a.ZOg);$d.zj.add(La.a.Maa);$d.zj.add(La.a.xMa);$d.zj.add(La.a.Wpf);$d.zj.add(La.a.aYa);$d.zj.add(La.a.kug);$d.zj.add(La.a.jug);$d.zj.add(La.a.lug);$d.zj.add(La.a.D_d);$d.zj.add(La.a.Yya);$d.zj.add(La.a.aAe);$d.zj.add(La.a.IUj);$d.zj.add(La.a.close);$d.zj.add(La.a.ose);$d.zj.add(La.a.yre);
$d.zj.add(La.a.Loe);$d.zj.add(La.a.Xze);$d.zj.add(La.a.$ze);$d.zj.add(La.a.mYb);$d.zj.add(La.a.cva);$d.zj.add(La.a.anc);$d.zj.add(La.a.VDg);$d.zj.add(La.a.qyc);$d.zj.add(La.a.dfa);$d.zj.add(La.a.Cwc);$d.zj.add(La.a.wqe);$d.zj.add(La.a.cvc);$d.zj.add(La.a.Sxj);$d.zj.add(La.a.j4h);$d.zj.add(La.a.qWd);$d.zj.add(La.a.Vpf);$d.zj.add(La.a.l4h);$d.zj.add(La.a.k4h);$d.zj.add(La.a.Wpf);$d.zj.add(La.a.rWd);$d.zj.add(Hc.a.iHe);$d.zj.add(Hc.a.PPg);$d.zj.add(Hc.a.F3b);$d.zj.add(Hc.a.Dxg);$d.zj.add(Hc.a.Ywb);$d.zj.add(Hc.a.Ise);
$d.zj.add(Hc.a.noa);$d.zj.add(La.a.usb);$d.zj.add(La.a.Gob);$d.zj.add(La.a.tyc);$d.zj.add(La.a.xdk);$d.zj.add(La.a.Zxj);$d.zj.add(Hc.a.jjd);$d.zj.add(ub.a.XXb);$d.zj.add(ub.a.S3)}}$d.zj=new Set;Object(u.a)($d,"CommentRibbonCommands",null,[]);class $e{constructor(b,h,r,A,M){this.Fhj=b;this.Sg=h;this.Np=r;this.lj=A;this.imp=M;this.Y$b=null;this.wFa=new dh.a(0);this.XBb=new dh.a(0);this.ILe=new dh.a(0);this.$bf=!1;this.N8m();this.myo()}cin(b){return this.Y$b&&this.Np.ez?!$d.zj.has(b):!1}Plc(b,h,r){if(b===
La.a.Ug)return 32;if(!this.wFa.mb(b)&&!this.XBb.mb(b)||!this.Y$b)return 2;const A=this.XBb.mb(b);var M=A?this.XBb.K(b):this.wFa.K(b);const ba=A?2:this.ILe.K(r);A||1!==ba||(this.Oln(qa.StaticActiveAppFrame.za().xq.currentScope.name)||qa.StaticActiveAppFrame.za().xq.Eg(this.Sg.jn?pd.AFrame.zt:pd.AFrame.zR),qa.StaticActiveAppFrame.za().Fe(!0));r=new be;switch(M){case 1:r.highlight={color:this.wFi(h.Color)};break;case 6:r.fontColor={color:this.wFi(h.Color)}}M=this.Y$b.executeCommand(M,ba,r);2===M&&A&&
(b===ub.a.Luc?h[Ng.a.On]=!!r.bold:b===ub.a.Suc?h[Ng.a.On]=!!r.italic:b===ub.a.fvc?h[Ng.a.On]=!!r.underline:b===ub.a.Xuc?h[Ng.a.On]=!!r.strikethrough:b===ub.a.yY?h[Ng.a.On]=!!r.highlight:b===ub.a.gx&&(h[Ng.a.On]=!!r.fontColor));return 2===M?32:1===M?2:8}lvo(b){this.Y$b=b;this.Y$b.registerSelectionChangeHandler(()=>{this.$bf||(this.$bf=!0,qa.StaticActiveAppFrame.za().Fe(!0),this.$bf=!1)});this.Y$b.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case rf.a.Y3b:case rf.a.Zvd:case rf.a.ZIe:case rf.a.t1a:qa.StaticActiveAppFrame.za().Fe(!0)}h.key!==
rf.a.UD&&h.key!==rf.a.S4||qa.StaticActiveAppFrame.za().Fe(!0)})}myo(){this.Fhj.DBj(pd.AFrame.zt,this);this.Fhj.DBj(pd.AFrame.zR,this)}N8m(){this.wFa.W(ub.a.bold,0);this.wFa.W(ub.a.lA,3);this.wFa.W(ub.a.strikethrough,4);this.wFa.W(ub.a.underline,5);this.wFa.W(ub.a.yY,1);this.wFa.W(ub.a.vza,1);this.wFa.W(ub.a.gx,6);this.wFa.W(ub.a.kka,6);this.wFa.W(ub.a.yva,6);this.XBb.W(ub.a.Luc,0);this.XBb.W(ub.a.Suc,3);this.XBb.W(ub.a.Xuc,4);this.XBb.W(ub.a.fvc,5);this.ILe.W(1,0);this.ILe.W(2,1)}Oln(b){return b===
pd.AFrame.zt||b===pd.AFrame.zR}wFi(b){return b?Yl.a.QB(this.imp.mka(this.lj.qd,b)):""}}Object(u.a)($e,"CommentRibbonCommandHandler",null,[381,382]);class id{constructor(){this.Z=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.Z.resolve(776);this.Z.resolve(753).dqg?this.Z.resolve(1189):this.Z.resolve(744).h4("OnCommentRenderedOnce",()=>{this.Z.resolve(1189)})}dispose(){}uc(b){this.Z=b;this.Z.ia("WordEditor.Comments.CommentRibbonCommandHandler",()=>new $e(this.Z.Oa(1088),this.Z.resolve(753),
this.Z.resolve(746),$l.a.Pm.kb.Jc,Pk.a.instance)).as(776).ha();this.Z.ia(1189,()=>new $d).ha()}static main(){E.a.instance.Mc(new id)}}Object(u.a)(id,"PackageManager",null,[0,1]);var Wd=d(1999);class oh{constructor(b,h){this.GPl=2E3;this.eMh=null;this.Jjg=b.Urj;this.maxLength=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.GPl);h&&h.execute(r=>{this.eMh=r})}OHf(b){b=this.Clm(b,this.maxLength);return{semantic:Yp.ObjectSemantic.CanvasContext,type:Yp.ObjectSchemaType.WordCanvasContext,
value:b}}Clm(b,h){try{return this.Blm(b,h)}catch(r){return v.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",r),null}}GLm(b,h){const r={q8a:[],NCa:0,selection:{start:null,end:null},cursor:null,tiles:[]},A=b.length;for(let ba=0;ba<A;ba++){const oa=b.K(ba);var M=oa.node;if(!Ed.ParagraphReader.Vb(M)||Array.contains(r.q8a,M.Gk))continue;r.q8a.push(M.Gk);const Ja=Ed.ParagraphReader.textLength(M);if(r.NCa+Ja>h)break;M=this.Jjg.gob(M);r.tiles.push(M);r.NCa+=Ja;1!==
A||r.cursor||(r.cursor=oh.Tpm(oa,r.tiles.length-1));null===r.selection.start&&0===ba&&(r.selection.start=this.$Ii(oa,!0,r.tiles.length-1));null===r.selection.end&&ba===A-1&&(r.selection.end=this.$Ii(oa,!1,r.tiles.length-1))}return r}dCm(b,h,r){const A={Erd:[],p1j:[],NCa:0};var M=b.K(0).node;let ba=b.K(b.length-1).node;for(b=h;0<b&&(M||ba);){var oa=oh.xwj(M,!0,b,r);if(M=oa.node)M=this.Jjg.gob(M),A.Erd.push(M),b-=oa.NCa,M=oa.node,r=oa.q8a;oa=oh.xwj(ba,!1,b,r);if(ba=oa.node)r=this.Jjg.gob(ba),A.p1j.push(r),
b-=oa.NCa,ba=oa.node,r=oa.q8a}A.NCa=h-b;return A}Dlm(b,h){let r=0;var A=this.GLm(b,h);const M={tiles:A.tiles,selection:A.selection,cursor:A.cursor};r+=A.NCa;A=A.q8a;r<h&&(b=this.dCm(b,h-r,A),M.tiles.unshift.apply(M.tiles,b.Erd),M.tiles.push.apply(M.tiles,b.p1j),M.selection.start&&(M.selection.start.index+=b.Erd.length),M.selection.end&&(M.selection.end.index+=b.Erd.length),M.cursor&&(M.cursor.index+=b.Erd.length));return M}Blm(b,h){var r;if(!b)return null;b=this.Dlm(b,h);return{contentType:null===
(r=this.eMh)||void 0===r?void 0:r.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}$Ii(b,h,r){if(b.contextId===mc.a.Fd||b.contextId===mc.a.paragraph||b.contextId===mc.a.Vc){if(h&&-1!==b.Jj)return{index:r,offset:b.Jj};if(!h&&-1!==b.Wo)return{index:r,offset:b.Wo}}return null}static Tpm(b,h){return b.contextId===mc.a.Vc?{index:h,offset:b.Jj}:null}static xwj(b,h,r,A){A={node:null,NCa:0,q8a:A};if(!b||0>=r||!A.q8a)return A;do A.node=Ed.ParagraphReader.mg(b,h,!1,!1),A.NCa=A.node?
Ed.ParagraphReader.textLength(A.node):0,b=A.node;while(A.node&&(Array.contains(A.q8a,A.node.Gk)||!Ed.ParagraphReader.Vb(A.node)||!A.NCa));A.node&&(A.NCa>r?A.node=null:A.q8a.push(A.node.Gk));return A}}Object(u.a)(oh,"Box4CanvasContextProvider",null,[360]);class Ih{get name(){return"Box4.CanvasContext"}init(){}dispose(){}uc(b){b.ia("Box4.CanvasContext.Box4CanvasContextProvider",()=>new oh(b.resolve(738),b.Ra(5))).as(1018).ha()}static main(){E.a.instance.Mc(new Ih)}}Object(u.a)(Ih,"Box4CanvasContextPackage",
null,[0,1]);class Ki{constructor(b,h,r,A){this.PK={};this.bcc=this.OLd=0;this.QZd=3E4;this.start=()=>{0!=this.LJb.size&&0===this.bcc&&(this.bcc=window.setInterval(this.CMo,this.QZd),v.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.CMo=()=>{0!=this.LJb.size&&(this.lf.Mo?(v.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop()):(this.PK.ScanTime=Date.now(),this.PK.NumWatchDogs=this.LJb.size,this.PK.WatchDogManagerScanNumber=++this.OLd,this.LJb.forEach(async(M,
ba)=>{this.PK[ba]=await M.gQn();"KickoutComponent"==this.PK[ba].ComponentStatus&&this.Z2f(this.xsm(ba));M.Qwn()||v.ULS.sendTraceTag(520974674,306,20,JSON.stringify(this.PK))})))};this.lf=b;this.gqa=r;this.P1=A;this.bdf=new Map;this.LJb=new Map;h.execute(M=>{this.xk=M;this.xk.WHa((ba,oa)=>{this.Q_(oa)})})}Q_(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.bcc||(v.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",b.newState),
this.stop()):(this.stop(),this.start(),this.PIo(),v.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,b.newState))}stop(){0!==this.bcc&&(window.clearInterval(this.bcc),this.bcc=0);v.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}I_k(b,h){this.bdf.set(b,h)}sJo(){this.Ngo(this.bdf)}get L5k(){return this.bdf.size===this.LJb.size}Ngo(b){b.forEach((h,r)=>{h.execute(A=>{A?(this.LJb.set(r,A),this.start()):v.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",
r)})})}PIo(){this.LJb.forEach(b=>{b&&b.PDa()});v.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}Z2f(b){0<this.gqa.J0a&&this.P1.uUb(b)}xsm(b){return 1629==b?se.a.sMp:1630==b?se.a.rMp:null}}Object(u.a)(Ki,"WatchDogManager",null,[359]);class kg{constructor(){this.Z=this.KJb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.KJb=this.Z.resolve(this.name);this.U$m()}dispose(){this.KJb&&this.KJb.stop()}uc(b){this.Z=b;b.ia(this.name,this.GMl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").ha()}static main(){E.a.instance.Mc(new kg)}LGp(){if(!this.KJb.L5k){const b=
[];let h=0;this.JLd.forEach((r,A)=>{r&&(this.Z.Oa(A)||(b[h++]=A))});if(0<b.length){const r=!this.Z.resolve(438).PU;v.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,r)}}}GMl(){return new Ki(this.Z.resolve(117)||fc.SessionStatusManager.instance,this.Z.Ra(103),this.Z.resolve(821),this.Z.resolve(441))}E0k(){window.setTimeout(this.LGp.bind(this),this.pIp)}L0k(){this.JLd=new Map;this.JLd.set(1629,df.a.nn||df.a.yt);this.JLd.set(1630,!0)}U$m(){this.L0k();this.K0k(this.JLd,this.KJb.I_k.bind(this.KJb));
this.KJb.sJo();this.E0k()}K0k(b,h){b.forEach((r,A)=>{r&&h(A,this.Z.Ra(A))})}get pIp(){return null!=this.Y7g?this.Y7g:this.Y7g=y.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",3E5)}}Object(u.a)(kg,"WatchDogManagerPackage",null,[0,1]);class ok{constructor(b){this.fNa=b;this.Lpi=!1;this.aqb=void 0}G2o(){this.Lpi||(this.XGl(),this.Bzl(),this.t2l(),this.Ffo(),this.Lpi=!0)}x9o(){hm.UISurfaces.mum().then(b=>{b.renderFloatingHelp(this.aqb.Sla,{["actionCallback"]:(h,
r=2,A=null)=>{y.AFrameworkApplication.va.Pb(h,r,A)}});return null})}Bzl(){this.aqb.pgd.appendChild(this.aqb.Sla)}t2l(){this.fNa.appendChild(this.aqb.pgd)}XGl(){this.aqb={pgd:this.W9h(ok.Y8n),Sla:this.W9h(ok.Ean)}}W9h(b){const h=document.createElement("div");h.id=b;return h}Ffo(){this.aqb.pgd.style.position="fixed";this.aqb.pgd.style.bottom="47px";this.aqb.pgd.style.right="24px"}}ok.Y8n="FloatingHelpOuterContainer";ok.Ean="FloatingHelpInnerHost";Object(u.a)(ok,"FloatingHelpManager",null,[357]);class oj{constructor(){this.container=
void 0}get name(){return"WordEditor.FloatingHelp"}uc(b){this.container=b;const h=$l.a.Pm.nG;this.container.ia("WordEditor.FloatingHelp.FloatingHelpManager",()=>new ok(h)).as(1190).ha()}init(){if(y.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.FloatingHelpExperiment",!1)&&void 0!==this.container){const b=this.container.resolve(1190);b.G2o();b.x9o()}}dispose(){}static main(){E.a.instance.Mc(new oj)}}Object(u.a)(oj,"FloatingHelpPackage",null,[0,1]);class lh{constructor(b,
h){this.id=b;this.altText=h}}Object(u.a)(lh,"ParagraphBorderPropertiesItem",null,[]);class ri{constructor(b,h,r,A,M,ba){this.D4d=b;this.gallerySectionId=h;this.ICf=r;this.Ghf=A;this.commandId=M;this.queryCommandId=ba}}Object(u.a)(ri,"ParagraphBorderPropertiesMenuPropsArgs",null,[]);class Gj{constructor(b,h,r,A){this.size=b;this.space=h;this.style=r;this.color=A}}Object(u.a)(Gj,"ParagraphBorderStyleProperties",null,[]);class Nj{constructor(b,h,r,A,M,ba){this.y6a=b;this.Eqd=h;this.width=r;this.zed=
A;this.height=M;this.Gbd=ba}}Object(u.a)(Nj,"ParagraphBorderPropertiesDefinition",null,[]);class we{constructor(){this.rfl=[new lh(we.e1b,WordEditorIntl.WordEditorStrings.L_ParagraphBorderSolidLine),new lh(we.vNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDashedLine),new lh(we.WNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDottedLine),new lh(we.YNb,WordEditorIntl.WordEditorStrings.L_ParagraphBorderDoubleLine)];this.Bfl=[new lh(we.dLb,"0.25 pt"),new lh(we.bLb,"0.5 pt"),new lh(we.gLb,
"0.75 pt"),new lh(we.cLb,"1 pt"),new lh(we.aLb,"1.5 pt"),new lh(we.hLb,"2.25 pt"),new lh(we.fLb,"3 pt"),new lh(we.$Kb,"4.5 pt"),new lh(we.eLb,"6 pt")];this.nfl=[new lh(we.Alf,"0 pt"),new lh(we.ulf,"1 pt"),new lh(we.zlf,"2 pt"),new lh(we.ylf,"3 pt"),new lh(we.slf,"4 pt"),new lh(we.qlf,"5 pt"),new lh(we.wlf,"6 pt"),new lh(we.vlf,"7 pt"),new lh(we.plf,"8 pt"),new lh(we.tlf,"9 pt"),new lh(we.xlf,"10 pt")]}initialize(){this.M8m();this.gkd()}M8m(){this.LTd=[new Nj(we.e1b,"","2",1,8,0),new Nj(we.vNb,"5,3",
"1",1,8,0),new Nj(we.WNb,"1,1","1",1,8,0),new Nj(we.YNb,"","1",2,8,3)];this.MTd=[new Nj(we.dLb,"","0.25",1,8,0),new Nj(we.bLb,"","0.5",1,8,0),new Nj(we.gLb,"","0.75",1,8,0),new Nj(we.cLb,"","1",1,8,0),new Nj(we.aLb,"","1.5",1,8,0),new Nj(we.hLb,"","2.25",1,8,0),new Nj(we.fLb,"","3",1,8,0),new Nj(we.$Kb,"","4.5",1,8,0),new Nj(we.eLb,"","6",1,8,0)]}gkd(){if(Object(zg.c)()){var b={};for(const h of this.LTd)b[h.y6a]=appChrome.buildBorderStyleIcon(h.Eqd,h.width,h.zed,h.height,h.Gbd);for(const h of this.MTd)b[h.y6a]=
appChrome.buildBorderStyleIcon(h.Eqd,h.width,h.zed,h.height,h.Gbd);appChrome.api.registerIconProvider(()=>b)}else v.ULS.sendTraceTag(508339926,306,15,"AppChrome not loaded yet. Skipping registering icons for paragraph border manager.")}dJf(){return new Gj(we.Fgc,we.gdi,we.Egc,we.LYc)}Ijc(b){var h=this.o2c(b);if(0!==h.length){for(const A of h)if(r){if(h=this.hui(b,A),!this.USd(r,h))return}else var r=this.hui(b,A);return r}}hui(b,h){const r=this.dJf();switch(h){case 0:return{size:Ed.ParagraphReader.Yg(b,
le.a.NP,r.size),space:Ed.ParagraphReader.Yg(b,le.a.Eua,r.space),style:Ed.ParagraphReader.Yg(b,le.a.qZa,r.style),color:Ed.ParagraphReader.Yg(b,le.a.pZa,r.color)};case 1:return{size:Ed.ParagraphReader.Yg(b,le.a.kV,r.size),space:Ed.ParagraphReader.Yg(b,le.a.Cua,r.space),style:Ed.ParagraphReader.Yg(b,le.a.iZa,r.style),color:Ed.ParagraphReader.Yg(b,le.a.hZa,r.color)};case 2:return{size:Ed.ParagraphReader.Yg(b,le.a.D0,r.size),space:Ed.ParagraphReader.Yg(b,le.a.iDa,r.space),style:Ed.ParagraphReader.Yg(b,
le.a.lZa,r.style),color:Ed.ParagraphReader.Yg(b,le.a.kZa,r.color)};case 3:return{size:Ed.ParagraphReader.Yg(b,le.a.E0,r.size),space:Ed.ParagraphReader.Yg(b,le.a.jDa,r.space),style:Ed.ParagraphReader.Yg(b,le.a.Qcb,r.style),color:Ed.ParagraphReader.Yg(b,le.a.cNa,r.color)};case 4:return{size:Ed.ParagraphReader.Yg(b,le.a.rS,r.size),space:Ed.ParagraphReader.Yg(b,le.a.Bua,r.space),style:Ed.ParagraphReader.Yg(b,le.a.Ncb,r.style),color:Ed.ParagraphReader.Yg(b,le.a.Mcb,r.color)}}return r}Qkm(b){switch(b){case we.dLb:return we.sUc;
case we.bLb:return we.nlf;case we.gLb:return we.w6a;case we.cLb:return we.mza;case we.aLb:return we.faa;case we.hLb:return we.dka;case we.fLb:return we.z6;case we.$Kb:return we.lza;case we.eLb:return we.cka;default:return we.Fgc}}Nkm(b){switch(b){case we.e1b:return"single";case we.vNb:return"dashed";case we.WNb:return"dotted";case we.YNb:return"double";default:return we.Egc}}Kkm(b){switch(b){case we.Alf:return we.UWh;case we.ulf:return we.OWh;case we.zlf:return we.TWh;case we.ylf:return we.SWh;case we.slf:return we.rlf;
case we.qlf:return we.MWh;case we.wlf:return we.QWh;case we.vlf:return we.PWh;case we.plf:return we.LWh;case we.tlf:return we.NWh;case we.xlf:return we.RWh;default:return we.gdi}}Rkm(b){switch(b){case we.sUc:return we.dLb;case we.nlf:return we.bLb;case we.w6a:return we.gLb;case we.mza:return we.cLb;case we.faa:return we.aLb;case we.dka:return we.hLb;case we.z6:return we.fLb;case we.lza:return we.$Kb;case we.cka:return we.eLb}}Okm(b){switch(b){case "single":return we.e1b;case "dashed":return we.vNb;
case "dotted":return we.WNb;case "double":return we.YNb}}Lkm(b){switch(b){case we.UWh:return we.Alf;case we.OWh:return we.ulf;case we.TWh:return we.zlf;case we.SWh:return we.ylf;case we.rlf:return we.slf;case we.MWh:return we.qlf;case we.QWh:return we.wlf;case we.PWh:return we.vlf;case we.LWh:return we.plf;case we.NWh:return we.tlf;case we.RWh:return we.xlf}}o2c(b){const h=[];void 0!==Ed.ParagraphReader.Yg(b,le.a.NP,void 0)&&h.push(0);void 0!==Ed.ParagraphReader.Yg(b,le.a.kV,void 0)&&h.push(1);void 0!==
Ed.ParagraphReader.Yg(b,le.a.D0,void 0)&&h.push(2);void 0!==Ed.ParagraphReader.Yg(b,le.a.E0,void 0)&&h.push(3);void 0!==Ed.ParagraphReader.Yg(b,le.a.rS,void 0)&&h.push(4);return h}oGf(){const b=new ri("ParagraphBorderLineStyleOptionsGallery","DefaultBorderStyleOptions","ParagraphBorderLineStyleOptionsGallery",this.rfl,Hc.a.b0b,Hc.a.ese);return this.wjc(b,we.sfl,we.tfl)}pGf(){const b=new ri("ParagraphBorderLineWeightOptionsGallery","DefaultBorderWeightOptions","ParagraphBorderLineWeightOptionsGallery",
this.Bfl,Hc.a.c0b,Hc.a.fse);return this.wjc(b,we.Cfl,we.Dfl)}Yfm(){const b=new ri("ParagraphBorderLinePaddingOptionsGallery","DefaultBorderPaddingOptions","ParagraphBorderLinePaddingOptionsGallery",this.nfl,Hc.a.a0b,Hc.a.dse);return this.wjc(b,"0px","0px")}wjc(b,h="20px",r="50px"){const A=new Xe.a,M=new xh.a,ba=Object.assign(new Bn.a,{Id:b.D4d,ExternalId:b.gallerySectionId,ExternalGalleryId:b.ICf,Type:4,Width:10,GalleryItems:[]});for(const Ja of b.Ghf){var oa={};const jb={};jb.width=r;jb.height=h;
jb.marginRight="8px";oa.root=jb;oa=Object.assign(new cr.a,{Id:String.format("{0}_Button",Ja.id),ExternalId:String.format("{0}_ExternalID",Ja.id),Icon:Ja.id,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:Ja.id,P3p:jb,FullIconStyle:oa,LabelText:Ja.altText});ba.GalleryItems.push(oa)}M.ControlList=[];A.MenuSectionList=[];M.ControlList.push(ba);A.MenuSectionList.push(M);A.UpdateDynamically=!0;return A}USd(b,h){return!b&&!h||b&&h&&b.color===h.color&&b.size===h.size&&
b.style===h.style&&b.space===h.space}ZTh(b,h){if(b.length!==h.length)return!1;for(const r of b)if(-1===h.indexOf(r))return!1;return!0}}var jl=we;we.e1b="SolidLineStyle";we.vNb="DashedLineStyle";we.WNb="DottedLineStyle";we.YNb="DoubleLineStyle";we.sUc=2;we.dLb="BorderPointSizeOneQuarter";we.nlf=4;we.bLb="BorderPointSizeOneHalf";we.w6a=6;we.gLb="BorderPointSizeThreeQuarters";we.mza=8;we.cLb="BorderPointSizeOne";we.faa=12;we.aLb="BorderPointSizeOneAndHalf";we.dka=18;we.hLb="BorderPointSizeTwoAndQuarter";
we.z6=24;we.fLb="BorderPointSizeThree";we.lza=36;we.$Kb="BorderPointSizeFourAndHalf";we.cka=48;we.eLb="BorderPointSizeSix";we.UWh=0;we.Alf="BorderSpaceZero";we.OWh=1;we.ulf="BorderSpaceOne";we.TWh=2;we.zlf="BorderSpaceTwo";we.SWh=3;we.ylf="BorderSpaceThree";we.rlf=4;we.slf="BorderSpaceFour";we.MWh=5;we.qlf="BorderSpaceFive";we.QWh=6;we.wlf="BorderSpaceSix";we.PWh=7;we.vlf="BorderSpaceSeven";we.LWh=8;we.plf="BorderSpaceEight";we.NWh=9;we.tlf="BorderSpaceNine";we.RWh=10;we.xlf="BorderSpaceTen";we.Egc=
"single";we.Fgc=we.nlf;we.LYc=0;we.gdi=jl.rlf;we.tfl="50px";we.sfl="20px";we.Dfl="60px";we.Cfl="20px";Object(u.a)(we,"ParagraphBorderManager",null,[362]);class bh{constructor(){this.rue={size:0,space:0,color:0,style:"none"}}kyb(b,h,r){for(const A of h)this.bUo(b,A,r)}bUo(b,h,r){switch(h){case 0:b.properties.setValue(le.a.Eua,r.space);b.properties.setValue(le.a.NP,r.size);b.properties.setValue(le.a.pZa,r.color);b.properties.setValue(le.a.qZa,r.style);break;case 1:b.properties.setValue(le.a.Cua,r.space);
b.properties.setValue(le.a.kV,r.size);b.properties.setValue(le.a.hZa,r.color);b.properties.setValue(le.a.iZa,r.style);break;case 2:b.properties.setValue(le.a.iDa,r.space);b.properties.setValue(le.a.D0,r.size);b.properties.setValue(le.a.kZa,r.color);b.properties.setValue(le.a.lZa,r.style);break;case 3:b.properties.setValue(le.a.jDa,r.space);b.properties.setValue(le.a.E0,r.size);b.properties.setValue(le.a.cNa,r.color);b.properties.setValue(le.a.Qcb,r.style);break;case 4:b.properties.setValue(le.a.Bua,
r.space),b.properties.setValue(le.a.rS,r.size),b.properties.setValue(le.a.Mcb,r.color),b.properties.setValue(le.a.Ncb,r.style)}}wsl(b){var h=[0,1,2,3,4];for(const r of h)this.xsl(b,r)}xsl(b,h){switch(h){case 0:this.ykd(b,bh.nop);break;case 1:this.ykd(b,bh.Efl);break;case 2:this.ykd(b,bh.TAn);break;case 3:this.ykd(b,bh.qLo);break;case 4:this.ykd(b,bh.Jdl)}}ykd(b,h){const [r,A,M,ba]=h;h=Ed.ParagraphReader.Xb.Hq(b);h.hasProperty(r)?b.properties.setValue(r,this.rue.space):b.properties.hasProperty(r)&&
b.properties.removeProperty(r);h.hasProperty(A)?b.properties.setValue(A,this.rue.size):b.properties.hasProperty(A)&&b.properties.removeProperty(A);h.hasProperty(M)?b.properties.setValue(M,this.rue.color):b.properties.hasProperty(M)&&b.properties.removeProperty(M);h.hasProperty(ba)?b.properties.setValue(ba,this.rue.style):b.properties.hasProperty(ba)&&b.properties.removeProperty(ba)}}bh.nop=[le.a.Eua,le.a.NP,le.a.pZa,le.a.qZa];bh.Efl=[le.a.Cua,le.a.kV,le.a.hZa,le.a.iZa];bh.TAn=[le.a.iDa,le.a.D0,le.a.kZa,
le.a.lZa];bh.qLo=[le.a.jDa,le.a.E0,le.a.cNa,le.a.Qcb];bh.Jdl=[le.a.Bua,le.a.rS,le.a.Mcb,le.a.Ncb];Object(u.a)(bh,"ParagraphBorderEditor",null,[361]);class Dm{constructor(b){this.Xb=b}IAg(b,h){b.properties.setValue(Dm.z0b,h.color)}ipf(b){this.Xb.Hq(b).hasProperty(Dm.z0b)?b.properties.setValue(Dm.z0b,gC.IBo):b.properties.hasProperty(Dm.z0b)&&b.properties.removeProperty(Dm.z0b)}}Dm.z0b=Yf.a.qu;Object(u.a)(Dm,"ParagraphShadingEditor",null,[358]);class Vd{XLm(b){b=Ed.ParagraphReader.Yg(b,Vd.z0b,null);
return null===b?null:new gC(b)}}Vd.z0b=Yf.a.qu;Object(u.a)(Vd,"ParagraphShadingReader",null,[356]);class qe{get name(){return"WordEditor.ParagraphEditor"}uc(b){var h,r;this.container=b;if(null===(h=y.AFrameworkApplication.J)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1))this.container.ia(1167,()=>new bh).ha(),this.container.ia(1168,()=>new we).ha();if(null===(r=y.AFrameworkApplication.J)||void 0===r?0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphShadingEditingEnabled",
!1))this.container.ia(1169,()=>new Dm(this.container.resolve(8))).ha(),this.container.ia(1170,()=>new Vd).ha()}init(){var b;(null===(b=y.AFrameworkApplication.J)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.ParagraphBordersEditingEnabled",!1))&&this.container.resolve(1168).initialize()}dispose(){}static main(){E.a.instance.Mc(new qe)}}Object(u.a)(qe,"WordEditorParagraphEditorsPackage",null,[0,1]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");
Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");
Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");
Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");
Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");
Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");
Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");
Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");L.main();Type.registerNamespace("Common.App.WopiIdentity");ya.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");
Ac.main();Object(Wd.a)(!1);AF.main();zF.main();ic.main();sa.main();ab.main();sd.main();oj.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");De.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");Gg.main();Type.registerNamespace("Common.App.WildFire");nh.main();Type.registerNamespace("Common.App.BrowserInfoLogger");
Mj.main();Type.registerNamespace("Common.App.HostNotification");Tf.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");td.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");Ef.main();Type.registerNamespace("CNT");Ei.main();Type.registerNamespace("Common.App.NewAndOpen.Core");E.a.instance.Mc(new em);Type.registerNamespace("Common.App.NewAndOpen.UX");
E.a.instance.Mc(new Fl);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Hk.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");Nm.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Cd.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");cc.main();
Type.registerNamespace("CADWLTR");Lc.main();Type.registerNamespace("Common.App.DirectPrint");E.a.instance.Mc(new Fg);Type.registerNamespace("Common.App.SearchOAuthManager");ak.main();dg.main();ef.main();We.main();sg.main();zh.main();E.a.instance.Mc(new Xi);Ql.main();Zk.main();mm.main();E.a.instance.Mc(new Zl);Type.registerNamespace("Common.App.SaveStatus");E.a.instance.Mc(new hn);Type.registerNamespace("Common.App.EventsCacheManager");vm.main();Type.registerNamespace("CUIB");Ir.main();Type.registerNamespace("CommandUI.TaskPane");
try{E.a.instance.Mc(new Xb(qa.StaticActiveAppFrame.za().kb))}catch(b){v.ULS.shipAssertTag(575930383,3016,!1,b.message)}No.main();Type.registerNamespace("Common.App.Insights");Hh;E.a.instance.Mc(new Rt);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");oq("Begin");E.a.instance.Mc(new rm);
try{E.a.instance.Mc(new yk(xl.a.get_instance(),qa.StaticActiveAppFrame.za().kb,qa.StaticActiveAppFrame.za().Hb))}catch(b){v.ULS.shipAssertTag(575930384,3016,!1,b.message)}Zb.main();E.a.instance.Mc(new pf);hs.main();Tv.main();Ni.main();Ju.main();Lx.main();ou.main();HC.main();Uu.main();E.a.instance.Mc(new hB);JC.main();LG.main();Wu.main();KE.main();Ih.main();id.main();E.a.instance.Mc(new UG);E.a.instance.Mc(new oJ);dx.main();RE.main();fx.main();qe.main();E.a.instance.Mc(new sL);E.a.instance.Mc(new ys);
Cv;eF.main();bz.main();jF.main();eD.main();Ts;E.a.instance.Mc(new jy);E.a.instance.Mc(new ww);hD.main();kD.main();SH.main();E.a.instance.Mc(new wF);E.a.instance.Mc(new Lt);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=ny;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");od.main();dl.main();Sm.main();Cl;Kn.main();no;window.MSOJS=sy;VD.main();TN.main();E.a.instance.Mc(new da);
E.a.instance.Mc(new lb);(async()=>{y.AFrameworkApplication.J.$("WPMPackageIsEnabled")&&await d.e(29).then(d.bind(null,2155)).then(b=>{b.initializeOnDemandPackage()})})();kg.main();Qh.main()},2159:function(I,J,d){I=d(0);var m=d(108),f=d(8),a=d(2),l=d(42),w=d(467),z=d(19);class x{constructor(E,L,O,V){this.h0e=null;this.Qzd=V;this.Lxa=E;this.Mxa=L;this.m1=O;this.cFh=this.CVb.K5o;E=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.bFk=E[0];this.aFk=E[1]}get CVb(){return this.h0e||(this.h0e=z.a.instance.resolve(1069))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Wrb(){return CommonUIStrings.l_OICErrorHelpLink}get ipd(){return this.cFh}get kcj(){return this.bFk}get jcj(){return this.aFk}get icj(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.cFh?
3:2}get W_c(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get vXd(){return!!this.Mxa}get X_c(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}iqg(E){this.Jed(E)}j4f(E){this.Jed(E)}Jed(E){let L=10;this.Mxa&&1===E&&(this.Mxa(this.m1),L=1);this.Lxa&&this.Lxa(this.m1);this.wS(L)}zWb(){w.Redirect.showHelp("OICFailure");this.wS(2)}Adg(){this.CVb.z6i();this.wS(4)}wS(E){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.Qzd,E);a.AFrameworkApplication.tld(l.a.Xpj,this.Qzd,E)}dispose(){this.m1=this.Lxa=this.Mxa=null}}Object(I.a)(x,"AOICErrorDialog",null,[11]);var u=d(34),v=d(175);class F extends x{constructor(E,L,O,V){super(E,L,O,V);this.Ojb=this.PH=null;E=document.createElement("span");E.id="errorMessageText";E.innerText=this.errorMessage;E.appendChild(document.createElement("br"));E.appendChild(document.createElement("br"));this.PH=document.createElement("a");this.PH.href="#";this.PH.innerText=this.Wrb;E.appendChild(this.PH);
u.a.addHandler(this.PH,"click",Object(m.a)(this,this.zWb,"oicErrorHelpLinkHandler"));L=new v.StandardDialog;L.Pg=this.id;this.ipd?(O=document.createElement("span"),V=document.createElement("span"),O.innerText=this.kcj,V.innerText=this.jcj,this.Ojb=document.createElement("a"),this.Ojb.href="#",this.Ojb.innerText=this.icj,E.appendChild(document.createElement("br")),E.appendChild(O),E.appendChild(this.Ojb),E.appendChild(V),u.a.addHandler(this.Ojb,"click",Object(m.a)(this,this.Adg,"oicErrorMacOfferLinkHandler"))):
this.vXd&&(E.appendChild(document.createElement("br")),E.appendChild(document.createElement("br")),O=document.createElement("span"),O.innerText=this.W_c,E.appendChild(O));this.vXd?(L.Ed=1,L.Qe(1,this.X_c)):L.Ed=0;L.Mx(this.dialogTitle,null,this.icon,Object(m.a)(this,this.j4f,"legacyOICErrorDialogHandler"),E);L.H8("errorMessageText")}dispose(){this.PH&&(u.a.removeHandler(this.PH,"click",Object(m.a)(this,this.zWb,"oicErrorHelpLinkHandler")),this.PH=null);this.Ojb&&(u.a.removeHandler(this.Ojb,"click",
Object(m.a)(this,this.Adg,"oicErrorMacOfferLinkHandler")),this.Ojb=null);super.dispose()}}Object(I.a)(F,"OICErrorDialog",x,[]);class y{constructor(E,L,O){this.Lxa=L;this.Mxa=E;this.m1=O}get id(){return"OICErrorDialogWithDownload"}get tli(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Wrb(){return CommonUIStrings.l_OICErrorHelpLink}get W_c(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get X_c(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}iqg(E){this.Jed(E)}j4f(E){this.Jed(E)}Jed(E){let L=
10;1===E&&(this.Mxa(this.m1),L=1);this.Lxa&&this.Lxa(this.m1);this.wS(L)}zWb(){w.Redirect.showHelp("OICFailure");this.wS(2)}wS(E){a.AFrameworkApplication.tld(l.a.Ypj,3,E)}dispose(){this.m1=this.Mxa=this.Lxa=null}}Object(I.a)(y,"AOICErrorDialogWithDownload",null,[11]);class G extends y{constructor(E,L,O){super(E,L,O);this.PH=null;E=document.createElement("span");E.id="errorMessageText";E.innerText=this.tli;E.appendChild(document.createElement("br"));E.appendChild(document.createElement("br"));this.PH=
document.createElement("a");this.PH.href="#";this.PH.innerText=this.Wrb;E.appendChild(this.PH);u.a.addHandler(this.PH,"click",Object(m.a)(this,this.zWb,"oicErrorHelpLinkHandler"));E.appendChild(document.createElement("br"));E.appendChild(document.createElement("br"));L=document.createElement("span");L.innerText=this.W_c;E.appendChild(L);L=new v.StandardDialog;L.Pg=this.id;L.Ed=1;L.Qe(1,this.X_c);L.Mx(this.dialogTitle,null,this.icon,Object(m.a)(this,this.j4f,"legacyOICErrorDialogHandler"),E);L.H8("errorMessageText")}dispose(){this.PH&&
(u.a.removeHandler(this.PH,"click",Object(m.a)(this,this.zWb,"oicErrorHelpLinkHandler")),this.PH=null);super.dispose()}}Object(I.a)(G,"OICErrorDialogWithDownload",y,[]);var C=d(172);class H extends x{constructor(E,L,O,V){super(E,L,O,V);L={["errorMessage"]:this.errorMessage};L.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Wrb,["onExecute"]:Z=>{this.zWb(Z)}};this.ipd?(L.macOfficePreLinkText=this.kcj,L.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.icj,
["onExecute"]:Z=>{this.Adg(Z)}},L.macOfficePostText=this.jcj):this.vXd&&(L.errorFileDownloadOffer=this.W_c);E=new C.a(!1,!1,!0);this.vXd?(E.Ed=1,E.Qe(1,this.X_c)):E.Ed=0;E.Pg=this.id;L={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:L};E.gi(this.dialogTitle,Object(m.a)(this,this.iqg,"reactOICErrorDialogHandler"),L)}}Object(I.a)(H,"ReactOICErrorDialog",x,[]);class K extends y{constructor(E,L,O){super(E,L,O);L={["errorMessage"]:this.tli,["errorFileDownloadOffer"]:this.W_c};L.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.Wrb,["onExecute"]:V=>{this.zWb(V)}};E=new C.a(!1,!1,!0);E.Ed=1;E.Qe(1,this.X_c);E.Pg=this.id;L={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:L};E.gi(this.dialogTitle,Object(m.a)(this,this.iqg,"reactOICErrorDialogHandler"),L)}}Object(I.a)(K,"ReactOICErrorDialogWithDownload",y,[]);d.d(J,"a",function(){return R});class R{constructor(){this.KRa=!!a.AFrameworkApplication.ta&&a.AFrameworkApplication.ta.Hb.sH}sJl(E,L,O){this.KRa?new H(E,L,null,O):new F(E,L,null,
O)}tJl(E,L,O){this.KRa?new K(E,L,O):new G(E,L,O)}uJl(E,L,O,V,Z){const {ReactOICErrorDialogWithTrial:W}=d(1896),{OICErrorDialogWithTrial:P}=d(1897);this.KRa?new W(E,L,O,null,V,Z):new P(E,L,O,null,V,Z)}static get instance(){return R._instance||(R._instance=new R)}}R._instance=null;Object(I.a)(R,"OICErrorDialogFactoryImpl",null,[1808])},2162:function(I,J,d){I=d(0);var m=d(8),f=d(1563);class a{static get TMn(){return 50}static r8d(w){if(""===w)return"";let z=0,x="";try{const u=f.a.Rqb(w);for(const v of u.ops)if(a.DI(v))z||
(x+=a.Otm(v.attributes.atmention.fullName)),z+=1;else{const F=v.insert?v.insert:"";" "!==F&&0<F.length&&(z=0,x+=F)}}catch(u){m.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return x}static Gnm(w){w=a.r8d(w);return 0<w.length&&w.split(" ").length<=a.TMn?w:null}static Otm(w){let z="";w&&(w=w.split(" "),0<w.length&&(z=w[0]));return z}static DI(w){return!!w.attributes&&!!w.attributes.atmention}}Object(I.a)(a,"BaseCommentSmartReplyHelpers",
null,[]);d.d(J,"a",function(){return l});class l extends a{constructor(){super()}static JPb(w,z,x=!1){if(!w)return null;w=w.text&&0<w.text.length?w.text[0]:"";z=!z||!z.Qf||""===z.Qf;return 0<w.length&&z&&!x?a.Gnm(w):null}}Object(I.a)(l,"CommentSmartReplyHelpers",a,[])},943:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(){this.method=this.api=0}}Object(I.a)(m,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/22809443/wdjs/WordEditorDSReduceInitialBundle.box4.dll1.js.map