'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1381:function(I,J,d){I=d(0);var m=d(13),f=d(38),a=d(5),l=d(106),w=d(177),z=d(800),x=d(221),u=d(605),v=d(2),F=d(357),y=d(19),G=d(108),C=d(267),H=d(1),K=d(1534);class R{constructor(Z,W){this.Avk=Z;this.UB=W}K(Z){return this.Avk.e3(Z,this.UB)}}Object(I.a)(R,"PropertyMergeStrategies",null,[]);var E=d(1598),L=d(1532);class O extends L.a{constructor(){super();this.ned=this.Kje=this.Ho=null;this.mre=0}get mfa(){return"Property"}WPb(){this.detail.W("Type",
this.mfa);this.detail.W("ComplexMerger",null!=this.Ho?this.Ho:-1);this.detail.W("Strategy",null!=this.Kje?this.Kje:-1);this.detail.W("ClassId",null!=this.ned?this.ned:-1);this.detail.W("PropId",this.mre);return this.detail}}Object(I.a)(O,"PropertyMergeFailureDetail",L.a,[]);d.d(J,"a",function(){return V});class V{constructor(Z=null){this.OAh=this.qc=null;this.y9b=Z||this.U3c()}get Ho(){return 1}get dvb(){return this.y9b}U3c(){return[Object(G.a)(this,this.Lsp,"tryPreProcessFavoredRevision"),Object(G.a)(this,
this.xul,"cloneObjectAndRemoveNeededProperties"),Object(G.a)(this,this.xsp,"tryMergeNodeInternal")]}get UB(){return 5}get ore(){return this.OAh||(this.OAh=new R(this.jl(),this.UB))}RD(Z,W){const P=Z.hh.value.Kf;w.a.instance.Ua(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",P.id,P.wc);Z.ku.logger.Ti(Object.assign(new O,{Ho:this.Ho,ned:P.wc,mre:W}));return!1}EKg(Z){const W=Z.hh.value;w.a.instance.Ua(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",W.Kf.id,W.Kf.wc);for(let P=0;P<this.dvb.length;P++)if(!(0,this.dvb[P])(Z))return w.a.instance.Ua(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",W.Kf.id,W.Kf.wc,P),Z.ku.logger.xie("GraphNodeComplexMerge.GetMergeFunctions()",P),this.GFn(Z),Z.Yl=null,!1;w.a.instance.Ua(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",W.Kf.id,W.Kf.wc);
return!0}GFn(Z){Z.QOg||(Z.QOg=!0,E.a(Z.hh.value.Uv,"Base",1),E.a(Z.hh.value.Kf,"Favored",1),E.a(Z.Xo.value.Kf,"Conflict",1))}Lsp(Z){const W=Z.hh.value,P=this.ore;if(!W.s3)return!0;let S=!0;W.mNa.forEach((aa,Y)=>{if(!Y.s3||Z.Vg.contains(aa))return!0;Y=P.K(aa);if(5===Y){const X=W.Uv.wc;w.a.instance.Ua(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",X,aa,Y);Z.ku.logger.Ti(Object.assign(new O,{Ho:this.Ho,
ned:X,mre:aa,Kje:Y}));return S=!1}6===Y&&Z.Zng.add(aa);return!0});return S}xul(Z){Z.Yl=Z.hh.value.Kf.$O();const W=Z.Zng,P=Z.Yl;W&&W.forEach(S=>{P.removeProperty(z.a.D_(S));return!0});return!0}xsp(Z){const W=Z.Xo.value,P=W.Uv.wc,S=this.ore;let aa=!0;W.mNa.forEach((Y,X)=>{const ca=S.K(Y);aa=this.ysp(Z,X,Y,ca);aa||(Z.Yl=null,w.a.instance.Ua(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",P,Y,ca),Z.ku.logger.Ti(Object.assign(new O,{Ho:this.Ho,ned:P,mre:Y,
Kje:ca})));return aa});return aa}ysp(Z,W,P,S){const aa=Z.Yl;if(!W.s3&&8!==S||2===S||7===S||Z.Vg.contains(P))return!0;if(5===S)return!1;if(4===S||3===S){let Y;if(({value:Y}=Z.hh.value.mNa.Ec(P)).returnValue&&Y.s3)return 4!==S;S=0}8===S&&(S=0);if(0===S){if(!W.isDeleted)return Z=z.a.D_(P),(V.xGp(W,P,Z)||V.q6o())&&aa.seb(Z,W.newValue),!0;S=6}return 6===S?(aa.removeProperty(z.a.D_(P)),!0):1===S?this.RD(Z,P):!1}pOn(Z,W,P,S,aa,Y){Z=Z||new x.a;W=W||new x.a;P=P||new x.a;var X=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
Z.length,W.length,P.length),ca=Z.length<=W.length&&Z.length<=P.length;this.i_i()&&ca&&w.a.instance.Ua(541181455,1,1,X);if(!ca&&this.gYi(Y.runtime.qc))return null;if(this.i_i())for(X=0;X<Z.length;X++){ca=Z.tg(X);var fa=W.tg(X);let ja=P.tg(X);ca=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",ca,fa,ja,X,Z.length);w.a.instance.Ua(541181457,1,1,ca)}if(this.gYi(Y.runtime.qc))for(Y=0;Y<
Z.length;Y++)if(X=Z.tg(Y),ca=W.tg(Y),fa=P.tg(Y),!S(X,ca)||!S(X,fa))return null;Z=Z.iOa();S=new u.a;Y=Z.length;for(X=Y;X<W.length;X++)ca=W.tg(X),Z.add(ca),S.add(ca);for(;Y<P.length;Y++)W=P.tg(Y),S.contains(W)?w.a.instance.Ua(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",W):(Z.add(W),aa(W));return Z}i_i(){return!!v.AFrameworkApplication.J&&v.AFrameworkApplication.J.$("LogMPALErrors")}gYi(Z){if(!Z)return!1;Z.l$d(1000008);
return Z.Erb(1000008)}Ztn(Z){if(!Z)return!1;Z.l$d(1000009);return Z.Erb(1000009)}gej(Z,W,P,S){return K.a(Z,W,P,S)}pMa(Z,W,P){Z=Z||new x.a;W=W||new x.a;P=P||new x.a;const S=Z.IS(),aa=W.IS(),Y=P.IS();Z=V.filter(Z,X=>aa.contains(X)&&Y.contains(X));Z.IS();Z.wD(Z.length,V.filter(W,X=>!S.contains(X)));Z.wD(Z.length,V.filter(P,X=>!S.contains(X)&&!aa.contains(X)));return Z}iOn(Z,W){const P=z.a.D_(W),S=Z.kf;var aa=S.getPropertyObjectIds(Z.hh.value.Uv,P),Y=S.getPropertyObjectIds(Z.hh.value.Kf,P);const X=S.getPropertyObjectIds(Z.Xo.value.Kf,
P);aa=this.pMa(aa,Y,X);Y=Z.Yl;0<aa.length?S.setPropertyObjectIds(Y,P,aa):Y.removeProperty(P);Z.Vg.add(W)}job(Z,W,P){Z.hasProperty(P)?W.seb(P,Z.kH(P)):W.removeProperty(P)}IFo(Z,W){var P=W.fk();for(const S of P)W.removeProperty(S);P=Z.fk();for(const S of P)W.seb(S,Z.kH(S))}M2f(Z,W,P,S,aa){W=Z.getPropertyInt32(W,aa);P=Z.getPropertyInt32(P,aa);P=null!=W&&null!=P?Math.max(W,P):null!=P?P:null!=W?W:null;null!=P?Z.setPropertyInt32(S,aa,P):S.removeProperty(aa)}Eof(Z,W,P,S,aa,Y){W=Z(W,aa);P=Z(P,aa);Z=Z(S,aa);
S=W.IS();let X=!1;Y&&(X=Y(W,P,Z));X?(Y=!0,S=!1):(Y=S.H6h(P),S=S.H6h(Z));w.a.instance.Ua(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",z.a.zb(aa),W.Vr(),P.Vr(),Z.Vr(),Y,S);return{DWc:Z,oab:Y,fab:S}}aql(Z,W,P,S,aa){let Y;W=Z(W,aa);P=Z(P,aa);Z=Z(S,aa);S=this.K2i(W,P);Y=this.K2i(W,Z);w.a.instance.Ua(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
z.a.zb(aa),W.Vr(),P.Vr(),Z.Vr(),S,Y);return{DWc:Z,oab:S,fab:Y}}K2i(Z,W){if(!Z&&!W)return!0;if(!Z||!W)return!1;if(!Z.count&&!W.count)return!0;let P=!1;W.forEach((S,aa)=>P=Z.mb(S)&&aa==Z.K(S));return P}jl(){let Z;Z=this.Ztn(this.qc)?V.aEk.value:V.$Dk.value;const W=new F.a(0);for(let P=0;P<Z.length;P++)W.W(Z[P],7);return W}static waa(){return new V}static get instance(){return V._instance.value}static q6o(){return y.a.instance.Oa(23).isFeatureEnabled(69)}static xGp(Z,W,P){if(void 0!==Z.newValue&&null!==
Z.newValue||H.a.Y_i(P.type))return!0;V.EGn(Z,W,P);return!1}static EGn(Z,W,P){P=P.type===H.a.string;W=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",W);P||(W+=String.format(" [NewValue: {0}] [OldValue: {1}]",Z.newValue,Z.oldValue));w.a.instance.Ua(19145822,1,2,W)}static b9f(Z,W,P){const S=z.a.zb(P),aa=Z.kf;var Y=aa.getPropertyObjectIds(Z.hh.value.Uv,P);const X=aa.getPropertyObjectIds(Z.hh.value.Kf,P);var ca=aa.getPropertyObjectIds(Z.Xo.value.Kf,P);ca=V.WRm(ca,Z.ku.runtime.yyc);
W=W.pMa(Y,X,ca);Y=Z.Yl;0<W.length?aa.setPropertyObjectIds(Y,P,W):Y.removeProperty(P);Z.Vg.add(S);return!0}static WRm(Z,W){const P=new x.a;Z.forEach(S=>{W.contains(S,(aa,Y)=>aa.equals(Y))||P.add(S);return!0});return P}static filter(Z,W){const P=new x.a;Z.forEach(S=>{W(S)&&P.add(S);return!0});return P}static Owm(){return[z.a.zb(m.a.h1d),z.a.zb(m.a.lastModifiedTime),z.a.zb(m.a.gM),z.a.zb(m.a.hmd),z.a.zb(m.a.$vg),z.a.zb(f.a.led),z.a.zb(a.a.iXd),z.a.zb(a.a.fpb),z.a.zb(l.a.wJj)]}static Pwm(){return[z.a.zb(m.a.h1d),
z.a.zb(m.a.lastModifiedTime),z.a.zb(m.a.gM),z.a.zb(m.a.hmd),z.a.zb(m.a.$vg),z.a.zb(f.a.led),z.a.zb(a.a.iXd),z.a.zb(l.a.wJj)]}}V._instance=new C.a(V.waa);V.$Dk=new C.a(V.Owm);V.aEk=new C.a(V.Pwm);Object(I.a)(V,"GraphNodeComplexMerge",null,[1134])},1383:function(I,J,d){d.r(J);I=d(0);var m=d(251),f=d(1411),a=d(1391),l=d(1600),w=d(1601);class z{constructor(u,v){this.ujb=!1;this.Cma=null;if(!u)throw Error.argumentNull("annotations");if(!u.Npc(v))throw Error.argument("structTypeID","Invalid struct type ID");
this.Kx=u;this.rrc=this.Kx.ZCi(v);this.LPk=v}get rdc(){return this.Kx}get isReadOnly(){return this.ujb}get f0a(){return this.LPk}Uqb(u){if(0>u||u>=this.rrc)throw Error.argument("iField","Invalid field index");return this.Cma&&null!=this.Cma[u]?this.Cma[u]:this.Kx.IHi(this.f0a,u)}Bzg(u,v){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>u||u>=this.rrc)throw Error.argument("iField","Invalid field index");if(!this.Kx.Ioc(this.Kx.YQb(this.f0a,
u),v))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Cma||(this.Cma=Array(this.rrc)))[u]=v}jia(){const {Annotations:u}=d(1383);let v="[";if(this.Cma){let F=!0;for(let y=0;y<this.rrc;++y){if(null==this.Cma[y])continue;const G=this.Kx.YQb(this.f0a,y);if(u.QAb(G,this.Cma[y],this.Kx.IHi(this.f0a,y)))continue;F?F=!1:v+=", ";v+=this.Kx.JHi(this.f0a,y);v+="=";const C=this.Kx.jia(G,this.Cma[y]);G===u.Uca?(v+='"',v+=f.a.PBf(C),v+='"'):v+=C}}return v+"]"}isEqual(u){const {Annotations:v}=
d(1383);if(this===u)return!0;if(!u||this.Kx!==u.rdc||this.f0a!==u.f0a)return!1;for(let F=0;F<this.rrc;++F)if(!v.QAb(this.Kx.YQb(this.f0a,F),this.Uqb(F),u.Uqb(F)))return!1;return!0}clone(){const u=new z(this.Kx,this.f0a);this.Cma&&(u.Cma=Array.clone(this.Cma));return u}UW(){return this.isReadOnly?this.clone():this}f6f(){const {Annotations:u}=d(1383);if(!this.isReadOnly&&(this.ujb=!0,this.Cma))for(let v=0;v<this.rrc;++v){const F=this.Cma[v];null!=F&&u.iVb(F)}}toString(){return this.jia()}}Object(I.a)(z,
"StructValue",null,[1858,1856]);d.d(J,"Annotations",function(){return x});class x{constructor(u,v){if(!u)throw Error.argumentNull("initData");if(!v)throw Error.argumentNull("objectFetcher");this.IJn=v.kZl;let F=0;var y=v.Gqb(u.K(F));++F;this.W7f=new l.a(new w.a(y));this.wvk=u.K(F);++F;this.Abj=Array(this.E1d);this.Fcd=Array(this.E1d);this.Uub=Array(this.E1d);for(y=0;y<this.E1d;++y){this.Abj[y]=v.rD(u.K(F));++F;this.Fcd[y]=u.K(F);++F;var G=u.K(F);++F;this.Uub[y]=Array(G);for(var C=0;C<G;++C)this.Uub[y][C]=
v.rD(u.K(F)),++F}this.KPk=u.K(F);++F;this.gcj=Array(this.Fqd);this.cje=Array(this.Fqd);this.dje=Array(this.Fqd);this.bje=Array(this.Fqd);for(y=0;y<this.Fqd;++y)for(this.gcj[y]=v.rD(u.K(F)),++F,G=u.K(F),++F,this.cje[y]=Array(G),this.dje[y]=Array(G),this.bje[y]=Array(G),C=0;C<G;++C)this.cje[y][C]=v.rD(u.K(F)),++F,this.dje[y][C]=u.K(F),++F,this.bje[y][C]=({Nla:F}=this.SUa(this.dje[y][C],u,F,null,null,null)).returnValue,x.iVb(this.bje[y][C]);this.$ok=u.K(F);++F;this.A7f=Array(this.Ndc);this.B7f=Array(this.Ndc);
this.z7f=Array(this.Ndc);for(y=0;y<this.Ndc;++y)this.A7f[y]=v.rD(u.K(F)),++F,this.B7f[y]=u.K(F),++F,this.z7f[y]=({Nla:F}=this.SUa(this.B7f[y],u,F,null,null,null)).returnValue,x.iVb(this.z7f[y])}f2c(u){for(let v=0;v<this.Ndc;++v)if(this.A7f[v]===u)return v;return-1}Hti(u){if(!this.Jpc(u))throw Error.argument("attrID","Invalid attribute ID");return this.A7f[u]}getAttributeType(u){if(!this.Jpc(u))throw Error.argument("attrID","Invalid attribute ID");return this.B7f[u]}YQb(u,v){if(!this.Npc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");u=this.dje[x.Gqd(u)];if(0>v||v>=u.length)throw Error.argument("iField","Invalid field index");return u[v]}jia(u,v){if(!this.i2f(u))throw Error.argument("typeID","Invalid type ID");if(!this.Ioc(u,v))throw Error.argument("value","Value is not of the correct type");switch(u){case x.Uca:return v;case x.NEa:return v?"True":"False";case x.gPa:case x.cwa:return v.toString();case x.HY:return v.jia();default:if(!x.yK(u)&&x.Nsd(u)){u=x.CBf(u);const G=this.Uub[u].length;switch(this.Fcd[u]){case 0:return this.Uub[u][v];
case 1:if(v){var F="";for(var y=1;y<G;++y)v&1<<y-1&&(0<F.length&&(F+=" & "),F+=this.Uub[u][y]);return F}return this.Uub[u][0];case 2:F="";for(y=0;y<G;++y)v&1<<y&&(0<F.length&&(F+=" & "),F+=this.Uub[u][y]);return F;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Fcd[u]);}}else return v.jia()}}i2f(u){switch(u){case x.Uca:case x.NEa:case x.gPa:case x.cwa:case x.HY:return!0;default:return x.yK(u)?this.i2f(x.L9a(u)):x.Nsd(u)?this.jwn(u):this.Npc(u)}}jwn(u){u=x.CBf(u);return 0<=
u&&u<this.Abj.length}Npc(u){u=x.Gqd(u);return 0<=u&&u<this.gcj.length}Jpc(u){return 0<=u&&u<this.Ndc}Ioc(u,v){if(null==v)return!1;switch(u){case x.Uca:return"string"===typeof v;case x.NEa:return"boolean"===typeof v;case x.gPa:return"number"===typeof v;case x.cwa:return"number"===typeof v;case x.HY:return Object(m.a)(1855,v);default:if(x.yK(u))return Object(m.a)(1857,v)&&v.b8===x.L9a(u);if(x.Nsd(u)){if("number"!==typeof v)return!1;u=x.CBf(u);const F=this.Uub[u].length;switch(this.Fcd[u]){case 0:return 0<=
v&&v<F;case 1:return!(v&-1<<F-1);case 2:return!!v&&!(v&-1<<F);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Fcd[u]);}}else return Object(m.a)(1858,v)&&v.f0a===u}}get Ndc(){return this.$ok}get E1d(){return this.wvk}get Fqd(){return this.KPk}zjm(u){if(!this.Jpc(u))throw Error.argument("attrID","Invalid attribute ID");return this.z7f[u]}ZCi(u){if(!this.Npc(u))throw Error.argument("structTypeID","Invalid struct type ID");return this.cje[x.Gqd(u)].length}JHi(u,v){if(!this.Npc(u))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.cje[x.Gqd(u)][v]}IHi(u,v){if(!this.Npc(u))throw Error.argument("structTypeID","Invalid struct type ID");u=this.bje[x.Gqd(u)];if(0>v||v>=u.length)throw Error.argument("iField","Invalid field index");return u[v]}SUa(u,v,F,y,G,C){if(!v)throw Error.argumentNull("initData");if(x.yK(u)){var H=v.K(F);++F;u=x.L9a(u);var K=new a.a(this,u);for(var R=0;R<H;++R)Array.add(K.items,({Nla:F}=this.SUa(u,v,F,y,G,C)).returnValue);return{returnValue:K,Nla:F}}switch(u){case x.Uca:return{returnValue:(y||
this.W7f).rD(v.K(F++)),Nla:F};case x.NEa:return{returnValue:1===v.K(F++),Nla:F};case x.gPa:return{returnValue:v.K(F++),Nla:F};case x.cwa:return{returnValue:(G||this.IJn)[v.K(F++)],Nla:F};case x.HY:u=v.K(F++);H=new f.a(this);for(K=0;K<u;++K)R=v.K(F),++F,C&&(R=C[R]),H.kA(R,({Nla:F}=this.SUa(this.getAttributeType(R),v,F,y,G,C)).returnValue);return{returnValue:H,Nla:F};default:if(x.Nsd(u))return{returnValue:v.K(F++),Nla:F};if(x.n5j(u)){H=v.K(F++);K=new z(this,u);for(R=0;R<H;++R){const E=v.K(F);++F;K.Bzg(E,
({Nla:F}=this.SUa(this.YQb(u,E),v,F,y,G,C)).returnValue)}return{returnValue:K,Nla:F}}throw Error.argument("typeID","Invalid type ID");}}static Nsd(u){return 16<=(u&16383)&&16384!==(u&16384)&&32768!==(u&32768)}static n5j(u){return 16<=(u&16383)&&16384===(u&16384)&&32768!==(u&32768)}static yK(u){return 32768===(u&32768)}static cAm(u){if(x.yK(u))throw Error.argument("nonListTypeID","Non-list type ID required");return u|32768}static L9a(u){if(!x.yK(u))throw Error.argument("listTypeID","List type ID required");
return u&-32769}static QAb(u,v,F){switch(u){case x.Uca:case x.NEa:case x.gPa:case x.cwa:return v===F;case x.HY:return v.isEqual(F);default:return x.yK(u)?v.isEqual(F):x.Nsd(u)?v===F:v.isEqual(F)}}static iVb(u){Object(m.a)(1856,u)&&u.f6f()}static UW(u){return Object(m.a)(1856,u)?u.UW():u}static CBf(u){return u-16}static Gqd(u){return(u&-16385)-16}}x.Uca=1;x.NEa=2;x.gPa=3;x.cwa=5;x.HY=9;Object(I.a)(x,"Annotations",null,[1859])},1388:function(I,J,d){I=d(0);var m=d(346);class f{constructor(){this.userId=
this.email=this.displayName=null}}Object(I.a)(f,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(I.a)(a,"InsightsParameters",null,[]);var l=d(1739),w=d(1740),z=d(1742),x=d(1743),u=d(2),v=d(1471),F=d(1489),y=d(28),G=d(17),C=d(16),H=d(1375),K=d(1741);d.d(J,"a",function(){return R});class R{static get AWf(){return"Insights_16x16x32"}static get d$l(){return"Find_16x16x32"}static get Zrj(){return"-Parameterized"}static get rEg(){return"Parameterized"}static get fEe(){return"bTryQuery"}static get LKg(){return"TellMeSuggestion_"}static get P4j(){return"bTryQueryAlternate"}static get ZHg(){return"MenuTellMe"}static get yco(){const E=
{},L=[];Array.add(L,{Term:{PeopleType:"Person"}});E.And=L;return E}static Luf(E){return E+R.Zrj}static getParameter(E){let L="",O="";if(E)for(let V=0;V<E.Cni;++V)"Type"===E.OJf(V)?L=E.getValue(V):"Value"===E.OJf(V)&&(O=E.getValue(V));return new m.a(L,O)}static YMb(E){E=Object.assign(new a,{neighborhood:E,mentionStart:0,mentionLength:E.length});return y.c(E)}static Xai(E,L,O){E=Object.assign(new f,{displayName:E,email:L,userId:O});return y.c(E)}static HUa(E,L,O=null){return y.c(R.oHi(E,L,O,null))}static oHi(E,
L,O=null,V=null){E=Object.assign(new F.a,{neighborhood:E,mentionStart:0,mentionLength:E?E.length:0});return Object.assign(new v.a,{selection:E,userIntent:V,entryPoint:L,launchData:O})}static YJo(E,L){return R.HUa(E,R.DHj(L))}static DHj(E){switch(E){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static nmn(){return!!u.AFrameworkApplication.J&&u.AFrameworkApplication.J.$("IsGoLocalEnvironment")}static wpc(){const E=
u.AFrameworkApplication.J?u.AFrameworkApplication.J.jb("SovereignEnvironmentName"):null;return!!E&&0<E.length}static isEnterpriseUser(){const E=u.AFrameworkApplication.J?u.AFrameworkApplication.J.jb("HostAuthType"):null;return!!E&&"aad"===E.toLowerCase()||"external"===E&&R.DYf()}static fCg(E){return E.Wkp&&!R.wpc()}static dtn(){const E=u.AFrameworkApplication.J?u.AFrameworkApplication.J.jb("UiHostIntegrationType"):"";return!!u.AFrameworkApplication.J&&"UnifiedUiHostTeams"===E&&u.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static eCg(E){return E.p0a&&E.Y7l&&(E.prd||E.nrd||E.bub)&&!R.dtn()&&R.isEnterpriseUser()&&!R.wpc()}static Hta(){return u.AFrameworkApplication.J?u.AFrameworkApplication.Reb||u.AFrameworkApplication.J.$("SmartLookupEnableNativePane"):u.AFrameworkApplication.Reb}static KU(E){return!E||R.F2i(E.Wg)}static F2i(E){return!E||!E.trim().length}static SDe(E){if(!E)return 0;const L=Math.pow(10,5);return Math.round(E*L)/L}static onp(){var E=new Date;return E?new Date(E.getUTCFullYear(),E.getUTCMonth(),E.getUTCDate(),
E.getUTCHours(),E.getUTCMinutes(),E.getUTCSeconds(),E.getUTCMilliseconds()):null}static oPf(E){E=new Date(E);return(R.onp().getTime()-E.getTime())/1E3}static n3i(E){switch(E){case l.a.eTf:case w.a.opi:case K.a.uTi:case z.a.vhj:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return E.startsWith(R.fEe)||
E.startsWith(R.LKg)||E.startsWith(R.P4j)||E.startsWith("PeopleSuggestion")||E.startsWith("FileSuggestion")||E.startsWith("FindInDocumentSuggestion")||E.startsWith("NotesSuggestion")||E.startsWith("OnenoteNotesSuggestion")||E.startsWith("SmartLookupFromTellMe")||E.startsWith("GetHelpFromTellMe")||E.startsWith("GetHelpWithDescriptionFromTellMe")||E.startsWith("AddinSuggestion")||E.startsWith("OfficeScripts")?!0:!1}static lKf(E,L){const O=[];Array.add(O,new x.a(400,E));Array.add(O,new x.a(200,L));E=
{};E.parts=O;return JSON.stringify(E)}static Cqb(E){const L=E.indexOf("<b0>"),O=E.lastIndexOf("</b0>"),V=[];Array.add(V,new x.a(400,E.substring(0,L)));Array.add(V,new x.a(600,E.substring(L+4,O)));Array.add(V,new x.a(400,E.substring(O+5,E.length)));E={};E.parts=V;return JSON.stringify(E)}static iJi(E){const L=R.oPf(E);return 60>L?CommonUIStrings.l_TimeSince_SecsAgo:3600>L?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(L/60).toString()):86400>L?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(L/3600).toString()):172800>L?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(E)).localeFormat("MMMM dd, yyyy"))}static mnm(E){const L=Array(E.length);for(let O=0;O<E.length;O++)L[O]=E[O].commandId;return L}static DYf(){if("Dev Box"===u.AFrameworkApplication.J.jb("StatusBarEnvironmentNameToUse"))return!0;let E=u.AFrameworkApplication.J.jb("UserPrincipalName");E=H.c(E)?"":C.a.xh(E);const L=u.AFrameworkApplication.J.my("TellMeIntEnabledForFeatureCrew")?
u.AFrameworkApplication.J.pD("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(L,E)&&"inner"===u.AFrameworkApplication.J.jb("Microsoft365Ring")}static Kwm(E){switch(R.v6d(E)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static AMm(E){E=R.v6d(E);switch(E){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return E}}static v6d(E){switch(E.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static tta(){return G.a.L7&&!G.a.Ur}}R.vfb=9E5;Object(I.a)(R,"TellMeUtils",null,[])},1389:function(I,J,d){d.r(J);I=d(0);var m=d(515),f=d(277),a=d(108),l=d(251),w=d(82),z=d(1629),x=d(1018);class u{constructor(sa,ab,eb,fb,Cb,lc){this.groupType=sa;this.resultType=ab;this.jGg=eb;this.cba=fb;this.ryf=Cb;this.resultIndex=
lc}}Object(I.a)(u,"ClickLoggingInfo",null,[]);const v=sa=>{const ab=[];for(;sa;)Array.add(ab,"{ContextId:"+sa.contextId+", IsGraphNodeContext:"+sa.Cl+"}"),sa=sa.Ok;ab.reverse();return"{"+ab.join(", ")+"}"};class F{constructor(){this.jta=this.sessionId=null}}Object(I.a)(F,"CorrelationRecord",null,[1834]);var y=d(1424);class G{constructor(sa,ab){this.provider=sa;this.Jfb=ab}}Object(I.a)(G,"ExternalResultProvider",null,[]);class C{constructor(sa,ab){this.Id=null;this.TimeStamp=0;this.Id=sa;this.TimeStamp=
ab}}Object(I.a)(C,"MRUControl",null,[]);var H=d(1602),K=d(1388),R=d(2),E=d(1256);class L{constructor(sa,ab){this.rFk=10;this.s$=[];this.KGa=[];this.Fph=this.Eph=!1;this.hMc=this.gMc="";this.w9b=ab;this.jc=sa}M2c(){!this.Eph&&this.jc&&(this.gMc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.jc.application,this.s$=this.yui(),this.Eph=!0);return this.s$}AIm(){!this.Fph&&this.jc&&(this.hMc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.jc.application,this.KGa=this.yui(!0),this.Fph=!0);return this.KGa}mvn(sa){return sa.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===sa||"TryOfficeUpsell"===sa}jYf(sa){return this.ugn(sa)||this.mvn(sa)||K.a.n3i(sa)?!1:!0}V5a(sa){sa=sa.ControlId;this.jYf(sa)&&(sa=this.Usg(sa),this.DBo(sa),this.DKn(),Array.insert(this.s$,0,new C(sa,Date.now())),this.gMc.length&&(sa=JSON.stringify(this.s$),E.a.instance.setItem(this.gMc,sa)))}UG(sa){this.CKn();Array.insert(this.KGa,0,new C(H.a[sa],Date.now()));this.hMc.length&&(sa=JSON.stringify(this.KGa),E.a.instance.setItem(this.hMc,sa))}yui(sa=!1){if(!this.s$.length){var ab=
sa?E.a.instance.getItem(this.hMc):E.a.instance.getItem(this.gMc);if(!ab||""===ab)return sa?this.KGa:this.s$;let eb=null;try{eb=JSON.parse(ab)}catch(fb){this.zsl(sa),eb=null}if(!eb||!eb.length||10<eb.length)return sa?this.KGa:this.s$;ab=0;for(const fb of eb)if(sa||this.jc.Ege(fb.Id)&&this.jYf(fb.Id))if(sa?Array.insert(this.KGa,ab++,fb):Array.insert(this.s$,ab++,fb),ab===this.w9b)break}return sa?this.KGa:this.s$}yrf(sa){sa=this.Usg(sa);for(const ab of this.s$)if(ab.Id===sa)return!0;return!1}zsl(sa=
!1){E.a.instance.setItem(sa?this.hMc:this.gMc,"")}Rin(sa){sa=this.Usg(sa.ControlId);return this.jYf(sa)?this.yrf(sa):!1}DBo(sa){if(0<this.s$.length){let ab=0;for(const eb of this.s$){if(eb.Id===sa){Array.removeAt(this.s$,ab);break}ab++}}}Usg(sa){return"Excel"===this.jc.application&&sa.startsWith("m_excelWebRenderer_ewaCtl_")?sa.substr(26,sa.length):sa}DKn(){this.s$.length===this.w9b&&Array.removeAt(this.s$,this.s$.length-1)}CKn(){this.KGa.length===this.rFk&&Array.removeAt(this.KGa,this.KGa.length-
1)}ugn(sa){sa=sa.split("|");let ab="";if(6<=sa.length)ab=sa[0];else if(3<=sa.length){if("3"===sa[0])return!0;ab=sa[1]}return ab.startsWith("WA")}static createInstance(sa){let ab=3;R.AFrameworkApplication.J&&(ab=R.AFrameworkApplication.J.fc("TellMeMaxRecommendedResultsToReturn",3));return new L(sa,ab)}}Object(I.a)(L,"MruControlsManager",null,[1833]);class O{constructor(sa){this.WGb=sa}Bka(sa,ab){let eb;return sa.NE&&(eb=this.WGb[sa.value])?eb.Bka(sa,ab):(eb=this.xvi(sa.value))?eb.Bka(eb.kQn,ab):null}dGm(sa,
ab){if(sa=this.WGb[sa])for(const eb of ab)if(ab=K.a.getParameter(eb),ab.key===sa.Rjg)return ab.value;return null}HUn(sa){(sa=this.xvi(sa))&&sa.EUn()}xvi(sa){const ab=sa.indexOf(K.a.Zrj);return 0<ab?this.WGb[sa.substring(0,ab)]:null}}Object(I.a)(O,"ParameterizedCommandManager",null,[1832]);var V=d(1446);class Z{constructor(sa,ab){this.Wg=sa;this.Zwb=ab}}Object(I.a)(Z,"TellMeQuery",null,[]);var W=d(1599);class P{constructor(sa,ab){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=sa;this.TimeElapsedSinceClick=
ab}}Object(I.a)(P,"CommandClickedEvent",null,[]);var S=d(1375);class aa{constructor(sa,ab){this.MHk=sa;this.bya=ab}Qt(sa){this.MHk(S.c(sa.query)?"":sa.query.Wg,sa.hp,sa.attributes,this.bya,sa.$oc)}}Object(I.a)(aa,"ResultsUpdatedCallback",null,[1831]);class Y{constructor(sa,ab,eb,fb,Cb){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=sa;this.TimeElapsedSinceClick=eb;this.CommandSurface=fb;this.CommandId=ab;this.TerminalParentControlId=
Cb}}Object(I.a)(Y,"UserActionEvent",null,[]);var X=d(72);class ca{constructor(sa,ab){this.menuModel=sa;this.BHj=ab}}Object(I.a)(ca,"GeneratedMenuModel",null,[]);class fa{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(I.a)(fa,"MenuModel",null,[]);class ja{constructor(sa,ab,eb){this.jc=sa;this.WGb=ab;this.Hja=eb}wgm(sa,ab,eb){const {TellMeActor:fb}=d(1389);let Cb=0;const lc=new fa,bc=[];let Za="";lc.sections=[];let Ib=new X.a;
const Ub=!!this.jc&&this.jc.cbb;var rc=!!this.jc&&this.jc.Ryb||R.AFrameworkApplication.ta.Hb.Ryb;for(const rb of sa){sa=0;Ub||(Ib=new X.a);const $c=new X.a;let cd=rb.displayName;for(const Rd of rb.results){if(0<=Rd.value.indexOf(K.a.rEg)){if(Rd.NE){var yc=this.WGb[Rd.value];if(yc&&Rd.value.endsWith(K.a.rEg)){if("FindParameterized"!==Rd.value&&!rc){const ge=[];ge.push(appChrome.actions.setControlLabel(Rd.value,yc.m7d(Rd)));ge.push(appChrome.actions.setButtonCommandValueId(Rd.value,yc.gIf(Rd)));appChrome.api.dispatch(ge)}yc=
Rd.value.replace(K.a.rEg,"");Ib.remove(yc)?sa--:$c.add(yc);Ib.add(Rd.value);sa++}}}else switch(Rd.type){case 5:$c.contains(Rd.value)||(Ib.add(Rd.value),sa++);break;case 7:Ib.add(Rd.NE);sa++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Ib.add(Rd.value),sa++}13===rb.groupType&&(cd=K.a.Hta()?0<ab.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
ab):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,ab));21===rb.groupType&&(cd=CommonUIStrings.l_LearningUILiveText)}Cb+=sa;""!==cd&&0<sa&&(Za+=" , "+sa.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+cd+" , ");0<Ib.count&&!Ub&&(sa=appChrome.api.menuSection(Ib.toArray(),rb.displayName,null,V.a[rb.groupType]),bc.push(sa))}rc=null;0<Cb&&(rc=0<ab.length?1!==Cb?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
Cb,ab):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,ab):1!==Cb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Cb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Ub?(ab=appChrome.api.menuSection(Ib.toArray(),"",null,null),bc.push(ab)):rc+=Za);eb&&(this.jc.qBa?fb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(rc)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(rc)));lc.sections=
bc;return new ca(lc,Cb,[])}static get vAf(){return ja.ugh||(ja.ugh=new ca(Object.assign(new fa,{sections:[]}),0,[]))}}ja.ugh=null;Object(I.a)(ja,"TellMeMenuDefintionGenerator",null,[]);var ra;(function(sa){sa[sa.rTp=0]="TellMeControlActivated";sa[sa.tTp=1]="TellMeQueryExecuted";sa[sa.vTp=2]="TellMeResultsRendered";sa[sa.sTp=3]="TellMeControlDeactivated"})(ra||(ra={}));Object(I.b)("PerformanceMarker",ra);var ya;(function(sa){sa[sa.xTp=0]="TellMeTimeToRender";sa[sa.wTp=1]="TellMeSessionLength";sa[sa.uTp=
2]="TellMeResultTriageTime"})(ya||(ya={}));Object(I.b)("PerformanceMeasure",ya);class Ha{mark(sa){window.performance.mark(ra[sa])}measure(sa,ab,eb){const {TellMeActor:fb}=d(1389);try{window.performance.measure(ya[sa],ra[ab],ra[eb])}catch(Cb){fb.instance.We.onError("TellMePerformance:Measure","error measuring "+ya[sa])}}F6f(sa,ab,eb){const {TellMeActor:fb}=d(1389);fb.instance.We.P6f(ab,eb,sa,this.QAm(sa))}btl(){var sa=[0,1,2,3];for(const ab of sa)window.performance.clearMarks(ra[ab])}clearMeasures(sa){for(const ab of sa)window.performance.clearMeasures(ya[ab])}QAm(sa){let ab=
0;(sa=this.jim(sa))&&0<sa.length&&(ab=sa[sa.length-1].duration);return ab}jim(sa){return window.performance.getEntriesByName(ya[sa],"measure")}}Object(I.a)(Ha,"TellMePerformance",null,[]);var Wa=d(1494),Ma=d(1493),ua=d(28);class Ka{constructor(sa){this.LQk=sa}Sfd(sa,ab,eb){const {TellMeActor:fb}=d(1389);fb.instance.We.Rba(ab,Ma.a.Quc,sa.data.He.toString(),Math.round(window.performance.now()-eb),Ma.a.Quc,!0,Wa.a.IWa);sa=ua.b(sa.data.Ee);ab=-1;sa.Index&&(ab=sa.Index);fb.instance.We.JHn(ab,this.LQk)}hfd(sa,
ab,eb){const {TellMeActor:fb}=d(1389);fb.instance.We.Rba(ab,Ma.a.Quc,sa.data.He.toString(),Math.round(window.performance.now()-eb),Ma.a.Quc,!1,Wa.a.IWa)}GIm(sa){if(sa&&""!==sa.trim()){const eb=window.performance.now(),fb=R.AFrameworkApplication.w0j;var ab={};ab.Text=sa;ab.IsFileHash="false";ab=ua.c(ab);R.AFrameworkApplication.Ge.Xj(fb,2,ab,{"Content-Type":"application/json",Accept:"application/json"},!1,0,Cb=>{this.Sfd(Cb,sa.length,eb)},Cb=>{this.hfd(Cb,sa.length,eb)},null,null,!1,4E3,6E3)}}}Object(I.a)(Ka,
"TellMeQueryIndexCallback",null,[]);var za=d(1393);class Fa{constructor(sa,ab,eb){this.xml=sa;this.BHj=ab;this.WWl=eb}}Object(I.a)(Fa,"GeneratedMenuXml",null,[]);var ea=d(1739),la=d(16);class Na{constructor(sa,ab){this.Myd=sa||{};this.f4a=ab}get WZb(){return 5}Bka(sa,ab=null){return this.f4a.Bka(sa,ab)||this.Ogl(sa.value)}Ogl(sa){return Na.smf(sa,this.Myd[sa]||null)}static smf(sa,ab=null){sa=String.format('<ClonedControl Id="{0}" ',sa);for(const Cb in ab){var eb=Cb,fb=ab[Cb];fb=fb?la.a.If(fb.toString()):
"";sa+=String.format('{0}="{1}" ',eb,fb)}return sa+"/>"}}Object(I.a)(Na,"CommandMenuItemFactory",null,[1819]);var Aa=d(226);class wa{constructor(){this.uwk=CommonUIStrings.l_FindInDocumentText}get WZb(){return 8}Bka(sa){var ab=sa.NE;sa=la.a.If(sa.value);const eb=la.a.If(ab);ab=la.a.If(String.format(this.uwk,ab));return this.Ofm(sa,eb,ab)}Ofm(sa,ab,eb){return Aa.a(sa,"1540292897",eb,K.a.d$l,null,ab,eb,null,null)}}Object(I.a)(wa,"FindInDocumentMenuItemFactory",null,[1819]);var va=d(1740),Pa=d(1741);
class Ta{constructor(sa=null){this.DAk=sa||CommonUIStrings.l_InsightsButtonText}get WZb(){return 10}Bka(sa){var ab=sa.NE;sa=K.a.Hta()?K.a.HUa(ab,1):K.a.YMb(ab);ab=String.format(this.DAk,ab);return this.Xfm(sa,ab)}Xfm(sa,ab){return Aa.a(Pa.a.uTi,K.a.Hta()?"1914896509":"3317204163",la.a.If(ab),K.a.AWf,null,la.a.If(sa),la.a.If(ab),null,null)}}Object(I.a)(Ta,"InsightsMenuItemFactory",null,[1819]);var kb=d(1742);class gb{get WZb(){return 7}Bka(sa){const ab=Object(w.a)(W.a,sa);return this.Dgm(la.a.If(sa.value),
ab.id)}Dgm(sa,ab){return Aa.a(ab,"1404166600",sa,null,null,sa,sa,null,null)}}Object(I.a)(gb,"TryQueryMenuItemFactory",null,[1819]);class tb{constructor(sa){this.dT=[];this.jc=sa}Tsm(sa){for(const ab of this.dT)if(ab.WZb===sa)return ab;return null}ia(sa){this.dT.push(sa)}yvo(sa){this.ia(new Na(this.jc.WBl,sa));this.ia(new kb.a(this.jc.pTn));this.ia(new ea.a(this.jc.jPo,this.jc.iPo,this.jc.glp,this.jc.o1m,this.jc.p5o));this.ia(new Ta);this.ia(new wa);this.ia(new va.a);this.ia(new gb)}}Object(I.a)(tb,
"MenuItemFactoryRegistry",null,[]);var hb=d(1395);class Xa{constructor(sa,ab){this.jc=sa;this.Puh=new tb(this.jc);this.Puh.yvo(ab)}xgm(sa,ab){let eb=0;const fb=[],Cb=[];for(const bc of sa){sa=K.a.ZHg;var lc=[];for(const Za of bc.results){const Ib=this.Puh.Tsm(Za.type).Bka(Za,ab);sa=K.a.ZHg;lc.push(Ib);if(13===Za.type||14===Za.type)sa="Menu32";17===Za.type&&(sa="MenuTellMeExtended");Za.groupType=bc.groupType;Cb.push(Object(w.a)(hb.a,Za))}eb=eb?eb:lc.length;lc=Aa.d("TellMeDropdownControls",lc);sa=Aa.g("TellMeDropdownMenuSection",
lc,sa,bc.displayName);fb.push(sa)}ab=Aa.h(fb,"LookupDropdownMenu");return new Fa(ab,eb,Cb)}static get V0d(){return Xa.vgh||(Xa.vgh=new Fa(Aa.h([],"LookupDropdownMenu"),0,[]))}}Xa.vgh=null;Object(I.a)(Xa,"TellMeXmlGenerator",null,[]);class $a{}$a.dRn="MRU";$a.test="Test";Object(I.a)($a,"ActionType",null,[]);var La=d(1475),bb;(function(sa){sa[sa.HSp=0]="Service";sa[sa.M3b=1]="Local";sa[sa.OQp=2]="MRU";sa[sa.Hkk=3]="TestResult";sa[sa.Unknown=4]="Unknown"})(bb||(bb={}));Object(I.b)("SubResultType",bb);
var Gb=d(80);class qb{constructor(sa,ab,eb,fb,Cb=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=sa;this.IsEnabled=ab;this.ResultType=H.a[eb];this.SubResultType=bb[fb];this.OptionalData=Cb?Gb.a.toJSON(Cb):null}}Object(I.a)(qb,"ResultInfo",null,[]);var Sa=d(120),cb=d(185),pb=d(297);class vb{constructor(sa,ab=null){this.ZDd="TellMeWAC.";this.mJk=sa;this.QRk=ab}YNa(sa,ab,eb){ab=Sa.a.qI(ab);sa=Sa.a.Fuf(sa,this.mJk,this.QRk,eb,ab);cb.a.YNa(sa,
this.ZDd)}XNa(sa,ab,eb=0){ab=Sa.a.qI(ab);cb.a.XNa(Object.assign(new pb.a,{name:sa,dataFields:ab,durationMs:eb}),this.ZDd)}}Object(I.a)(vb,"TellMeOtelLogger",null,[1845]);var xb=d(117);class Bb{constructor(sa,ab,eb,fb,Cb,lc,bc){this.v$=this.bea=this.Vbh=null;this.RPa=sa;this.Lhb=ab;this.HSa=eb;this.tjb=fb;this.m3a=Cb;this.eDk=lc;this.v$=bc?bc:new vb(this.tjb?x.a.qEg:x.a.xCe)}get Cs(){return this.tjb}get Wua(){return this.HSa}iye(sa){this.Vbh=sa;switch(sa){case za.a.contextMenu:this.bea=za.a.contextMenu;
break;default:this.bea=za.a.su}}wdl(sa,ab){this.HSa.jta||(this.HSa.jta=xb.a.create().toString(),this.n$i(sa,!0,ab))}Sji(sa,ab=!0){this.HSa.jta&&this.uFn(sa,ab);this.tjb&&appChrome.api.updateTellMeCorrelationId("");this.HSa.jta=null}n$i(sa,ab,eb){const {TellMeActor:fb}=d(1389),Cb=this.zaa(y.a.Z$a);Cb[La.a.culture]=this.Lhb;Cb[La.a.appName]=this.RPa;Cb[La.a.context]=sa;Cb[La.a.Ife]=this.m3a;Cb[La.a.kvn]=this.eDk;Cb[La.a.Rtn]=eb;Cb[La.a.Ann]=ab;Cb[La.a.contentType]=fb.instance.tZd;this.v$.YNa(y.a.Z$a,
Cb,this.Vbh);this.tjb&&appChrome.api.updateTellMeCorrelationId(this.HSa.jta)}uFn(sa,ab){const eb=this.zaa(y.a.LSb);eb[La.a.WZl]=sa;eb[La.a.znn]=ab;this.v$.XNa(y.a.LSb,eb)}IHn(sa,ab,eb){let fb=0;!eb&&0<sa.length&&(fb=sa.trim().split(" ").length);const Cb=this.zaa(y.a.query);Cb[La.a.query]="!";Cb[La.a.EYb]=ab;Cb[La.a.Kxj]=sa.length;Cb[La.a.P4i]=eb;Cb[La.a.tMp]=fb;this.v$.YNa(y.a.query,Cb,this.bea)}LGn(sa,ab,eb,fb,Cb,lc,bc,Za=null){const Ib=this.zaa(y.a.latency);Ib[La.a.culture]=this.Lhb;Ib[La.a.Kxj]=
sa;Ib[La.a.s5j]=ab;Ib[La.a.statusCode]=eb;Ib[La.a.service]=Cb;Ib[La.a.isSuccess]=lc;Ib[La.a.Czn]=bc;Za&&(Ib[La.a.Vnp]=Za);this.v$.XNa(y.a.latency,Ib,fb)}P6f(sa,ab,eb,fb){const Cb=this.zaa(y.a.performance);Cb[La.a.culture]=this.Lhb;Cb[La.a.Adl]=ra[sa];Cb[La.a.y1l]=ra[ab];Cb[La.a.Rco]=ya[eb];this.v$.XNa(y.a.performance,Cb,fb)}RHn(sa,ab){var {TellMeActor:eb}=d(1389);const {CommandResultsUtility:fb}=d(1459);if(sa.results.length){var Cb=this.zaa(y.a.iFj);Cb[La.a.cba]=ab.toString();Cb[La.a.groupType]=V.a[sa.groupType];
16===sa.groupType&&(Cb[La.a.ltn]=eb.instance.Qtd);ab=[];eb=[];var lc=[];for(const bc of sa.results)Cb[La.a.resultType]||(Cb[La.a.resultType]=H.a[bc.type]),sa={},27===bc.type&&(sa.AssetId=bc.hL),eb.push(fb.S8c(bc.value)),ab.push(bc.value),lc.push(new qb(bc.value,fb.S8c(bc.value),bc.type,bc.subType,sa));0<ab.length&&(Cb[La.a.$Jo]="{"+ab.join(", ")+"}",Cb[La.a.U0l]="{"+eb.join(", ")+"}",Cb[La.a.VJo]=ua.c(lc));this.v$.YNa(y.a.iFj,Cb,this.bea)}}lhm(sa,ab){if(4===sa)return $a.dRn;switch(ab){case 5:case 16:case 17:case 18:return"Command";
case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return H.a[ab]}YEn(sa,ab,eb,fb,Cb){const lc=this.zaa(y.a.click);lc[La.a.s5j]=sa;lc[La.a.Mao]=ab;lc[La.a.commandId]=eb;lc[La.a.G6]=fb;lc[La.a.actionType]=this.lhm(Cb.groupType,Cb.resultType);lc[La.a.resultType]=H.a[Cb.resultType];lc[La.a.jGg]=bb[Cb.jGg];lc[La.a.groupType]=V.a[Cb.groupType];lc[La.a.cba]=Cb.cba.toString();lc[La.a.ryf]=Cb.ryf.toString();lc[La.a.resultIndex]=Cb.resultIndex.toString();this.v$.YNa(y.a.click,
lc,this.bea)}dFn(sa,ab){this.HSa.jta||(this.HSa.jta=xb.a.create().toString(),this.n$i("",!1,ab));ab=this.zaa(y.a.I7h);ab[La.a.EYb]=sa;this.v$.XNa(y.a.I7h,ab)}H$i(sa,ab,eb){if(sa){if(eb)for(const fb in eb)sa[fb]=eb[fb];this.v$.XNa(y.a.events,sa,ab)}}LI(sa,ab,eb=null){const fb=this.zaa(y.a.events);fb[La.a.event]=sa;this.H$i(fb,Math.round(ab),eb)}aua(sa,ab,eb=null){const fb=this.zaa(y.a.events);fb[La.a.event]=y.a.error;fb[La.a.module]=sa;fb[La.a.errorMessage]=ab;fb[La.a.message]=ab;this.H$i(fb,Math.round(window.performance.now()),
eb)}WEn(sa){const ab=this.zaa(y.a.B4h);ab[La.a.value]=sa;ab[La.a.mte]=this.tjb;this.v$.YNa(y.a.B4h,ab,this.bea)}nEn(sa){const ab=this.zaa(y.a.fMh);ab[La.a.value]=sa;ab[La.a.mte]=this.tjb;this.v$.YNa(y.a.fMh,ab,this.bea)}QFn(sa){const ab=this.zaa(y.a.aoi);ab[La.a.value]=sa;ab[La.a.mte]=this.tjb;this.v$.YNa(y.a.aoi,ab,this.bea)}GHn(sa){const ab=this.zaa(y.a.bxj);ab[La.a.value]=sa;ab[La.a.mte]=this.tjb;this.v$.YNa(y.a.bxj,ab,this.bea)}BEn(sa){const ab=this.zaa(y.a.JMj);ab[La.a.value]=sa;this.v$.YNa(y.a.JMj,
ab,this.bea)}KHn(sa,ab){const eb=this.zaa(y.a.Fxj);eb[La.a.Quc]=sa;ab&&(eb[La.a.jta]=ab);this.v$.XNa(y.a.Fxj,eb)}zaa(sa){return{["SessionID"]:this.HSa.sessionId,["CorrelationID"]:this.HSa.jta,["Time"]:(new Date).getTime(),["Event"]:sa,["Scenario"]:this.bea}}}Object(I.a)(Bb,"UsageLogger",null,[1830]);var jc=d(77),xc=d(1689),Qc=d(1163),fd=d(1456),Ac=d(92),Nb=d(69),ib=d(1162),Rb=d(595),ic=d(17),kc=d(753),Jb=d(87),ec=d(12);d.d(J,"TellMeActor",function(){return qa});class qa{constructor(){this.f4a=this.R5=
this.Zb=this.Ga=this.WS=this.Bv=this.Gb=this.ga=this.We=this.ZM=this.G0e=this.rLh=this.fqa=this.jc=null;this.N8b=!1;this.tNe=[];this.Rbh=[];this.$Jh=[];this.yvh=[];this.zvh=[];this.tqh=!1;this.B5b=this.Hja=null;this.eKc=this.m3a=!1;this.qHd=!0;this.e2=this.dJc=this.lkh=this.V0e=this.kvh=null;this.g1=[];this.Nhb=this.j6b=this.QFa=this.oKd=this.zFh=null;this.b8b=!1;this.O0e=0;this.Z4b=null;this.bya=-1;this.Ruh=0;this.mKc=!1;this.pib=null;this.VJh=!1;this.a5b=this.yr=null;this.P_d=(sa,ab,eb,fb,Cb)=>
{if(ab.contextId===Jb.a.frame)switch(sa){case ec.a.su:return this.su(sa,ab,eb,fb,Cb);case ec.a.YHg:return this.QYh(sa,ab,eb,fb,Cb);case ec.a.cIg:return this.Z$i(sa,ab,eb,fb,Cb);case ec.a.fIg:return this.y$i(sa,ab,eb,fb,Cb);case ec.a.eIg:return this.V$i(sa,ab,eb,fb,Cb);case ec.a.aIg:return this.Z$a(sa,ab,eb,fb,Cb);case ec.a.hIg:return this.HJo(eb);case ec.a.dIg:return this.U$i(sa,ab,eb,fb,Cb);case ec.a.gIg:return this.x$i(sa,ab,eb,fb,Cb);case ec.a.ord:return this.dqi(sa,ab,eb,fb,Cb);case ec.a.XHg:return this.x6h(sa,
ab,eb,fb,Cb);case ec.a.iIg:case ec.a.b4f:return this.vWf(sa,ab,eb,fb,Cb);case ec.a.mDf:case ec.a.nDf:case ec.a.oDf:case ec.a.pDf:case ec.a.qDf:case ec.a.cig:case ec.a.dig:case ec.a.eig:case ec.a.jIg:return this.WYa(sa,ab,eb,fb,Cb);case ec.a.Dkg:case ec.a.Ekg:case ec.a.Fkg:return this.U$a(sa,ab,eb,fb,Cb);case ec.a.$Hg:return this.Spj(sa,ab,eb,fb,Cb);case ec.a.ehf:case ec.a.fhf:case ec.a.ghf:return this.nhe(sa,ab,eb,fb,Cb);case ec.a.a1b:return this.a1b(sa,ab,eb,fb,Cb);case ec.a.B3f:return this.p6i(sa,
ab,eb,fb,Cb);case ec.a.Dpg:return this.fyj(sa,ab,eb,fb,Cb);case ec.a.uGf:return this.usi(sa,ab,eb,fb,Cb)}return 2};this.fyj=(sa,ab,eb,fb,Cb)=>{if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Zb.KEf();if(sa=Cb.TerminalParentControlId){sa=this.a5b.K(sa);if(!sa)return 16;ab=[];Array.add(ab,sa);if(!this.E6i(ab))return 8}return 32};this.usi=()=>{if(!this.a5b.count)return 16;const sa=[];for(const ab of this.a5b.values)Array.add(sa,
ab);return this.E6i(sa)?32:8};this.U$a=(sa,ab,eb,fb,Cb)=>{if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:InsertMention","actiondata comes null"),16;sa=Cb.UILocation;let lc;Cb=Cb.CommandValueId;try{lc=ua.a(Cb)}catch(bc){return this.We.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return S.c(lc)?(this.We.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):S.c(this.dJc)?(this.We.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),
16):19!==sa?(this.We.onError("TellMeActor:InsertMention","location "+sa+" is unexpected"),16):this.dJc.U$a(lc.displayName,lc.email,lc.userId)?32:(this.We.onError("TellMeActor:InsertMention","mention is not inserted"),16)};this.WYa=(sa,ab,eb,fb,Cb)=>1===eb?32:S.c(Cb)?(this.We.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Cb.UILocation?this.pdn(eb,Cb):this.qtc(sa,ab,eb,fb,Cb);this.Spj=(sa,ab,eb,fb,Cb)=>{if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:OpenFeedback",
"actiondata comes null"),16;this.yr&&window.setTimeout(()=>{this.yr.execute(lc=>{lc.Meb("TellMeSurvey",null)})},qa.p7l);return 32};this.ZCa=(sa,ab,eb,fb,Cb)=>{eb=window.performance.now();this.Neo(ab);this.We.LXo(ab);this.jc.Cs?(this.Nhb=this.G0e.wgm(ab,sa,Cb),this.jc.qBa?(this.g1.push(appChrome.actions.updateTellMeSearchResults(this.Nhb.menuModel,sa,Cb)),appChrome.api.dispatch(this.g1)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.Nhb.menuModel,sa,Cb)),this.jc.MFe&&this.b8b&&
(S.c(this.e2)||this.e2.Location!==za.a.contextMenu)&&(this.ZM.mark(2),this.ZM.measure(0,1,2))):this.QFa=this.rLh.xgm(ab,this.We.Wua);this.Z4b&&this.Gb.Yb(this.Z4b);Cb={};Cb.GroupsCount=ab.length;Cb.QueryID=fb;Cb.QueryLength=sa.length;this.We.lC(y.a.HKl,window.performance.now()-eb,Cb)};this.p6i=(sa,ab,eb,fb,Cb)=>{if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",
!1)){sa={};sa.SourceControlId=Cb.SourceControlId;sa.Query=Cb.CommandValueId;Cb=this.ga.Pb(ec.a.lbd,2,sa);if(32!==Cb)this.We.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+Cb+".");return Cb}return this.ga.Pb(ec.a.lbd,2,Cb)};this.nhe=(sa,ab,eb,fb,Cb)=>{({AddinResultsProvider:sa}=d(1630));if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;eb=Cb.CommandValueId;if(S.b(eb))return this.We.onError("TellMeActor:LaunchAddin",
"Add-in assetId is null"),16;if(!sa.yKb[eb])return this.We.onError("TellMeActor:LaunchAddin","Add-in with assetId "+eb+" doesn't not exist in entitlements"),16;Cb=d(1630).AddinResultsProvider.yKb[eb];sa={};sa.solutionId=Cb.id;sa.version=Cb.appVersion;sa.storeType=Cb.storeType;sa.storeId=Cb.storeId;sa.assetId=Cb.assetId;sa.assetStoreId=Cb.assetStoreId;sa.displayName=Cb.displayName;sa.targetType=Cb.targetType;sa.height=Cb.height;sa.width=Cb.width;Cb=this.ga.Pb(ec.a.gWf,2,sa);if(32!==Cb)this.We.onError("TellMeActor:LaunchAddin",
"CommonCommands.InsertOfficeAddin failed. Response: "+Cb+". AssetId: "+eb);return Cb};this.a1b=()=>{if(!S.c(this.yr))for(const sa of z.a.instance.rqb()){if("ShowContextMenuWithFloatie"===sa.commandId)return this.yr.execute(ab=>{ab.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(sa.commandId&&-1===sa.commandId.indexOf("Tab"))break}return 8}}get tZd(){return this.WS?this.WS.contentType:qa.unknown}get actions(){return this.g1}set actions(sa){this.g1=sa}z9d(){return this.We?this.We.Wua.jta:
null}HR(){return this.jc}get RPn(){return this.qHd}get YHp(){return this.kvh}performance(){return this.ZM}get gEg(){return this.zFh}set gEg(sa){this.zFh=sa}get Qtd(){return this.VJh}set Qtd(sa){this.VJh=sa}lJ(sa){const ab=window.performance.now();this.Hja&&!S.c(sa)&&(this.Hja(sa),this.We.lC(y.a.lJ,window.performance.now()-ab))}initialize(sa,ab=null,eb=null,fb=null,Cb=null,lc=null,bc=null,Za=null,Ib=null,Ub=null,rc=null){const {InteractionLogger:yc}=d(2007),{GroupsPlacementInfo:rb}=d(2005),{AggregatorResultsProvider:$c}=
d(1772);this.jc=sa;this.m3a=!!R.AFrameworkApplication.ta&&R.AFrameworkApplication.ta.Hb.qpc;this.We=fb;if(!fb){fb=new F;fb.sessionId=R.AFrameworkApplication.userSessionId;const cd=kc.a.Hg(R.AFrameworkApplication.lcid)||kc.a.u8c;this.We=new yc(new Bb(this.jc.application,cd.name,fb,this.jc.Cs,this.m3a,sa.p0a,null),this.jc.cCl,this.jc)}this.f4a=new O(this.jc.parameterData);this.rLh=eb||new Xa(this.jc,this.f4a);this.Hja=bc;this.G0e=this.G0e||new ja(this.jc,this.jc.parameterData,bc);this.Zb=jc.FocusManager.instance();
this.R5=L.createInstance(this.jc);this.lkh=new rb(sa);this.ga=Cb||R.AFrameworkApplication.va;this.Gb=lc||R.AFrameworkApplication.oc;this.Bv=Ib;this.fqa=ab;this.yr=rc;this.ZM=new Ha;this.a5b=new m.a(f.a.vh());this.oKd=[];Ib?Ib.execute(cd=>{cd.isFeatureEnabled(qa.Vkp,!0).then(Rd=>{const {AggregatorResultsProvider:ge}=d(1772);this.mKc=Rd;this.fqa=this.fqa||ge.createInstance(this.R5,this.jc,this.f4a,this.mKc);for(const Ze of this.oKd)this.fqa.UG(Ze.provider,Ze.Jfb);this.oKd=[];return null})}):(this.mKc=
!0,this.fqa=this.fqa||$c.createInstance(this.R5,this.jc,this.f4a,this.mKc));this.Ga=Za;this.QFa=Xa.V0d;this.kvh=new Promise(cd=>{this.V0e=cd});Ub&&Ub.execute(cd=>{this.WS=cd})}Wb(){this.W_k()}Wwo(sa){this.dJc=sa}W_k(){this.ga.fb(ec.a.su,Jb.a.frame,Object(a.a)(this,this.su,"tellMe"),96);this.ga.fb(ec.a.YHg,Jb.a.frame,Object(a.a)(this,this.QYh,"cacheAsyncMenuRefreshFunction"),96);this.ga.fb(ec.a.cIg,Jb.a.frame,Object(a.a)(this,this.Z$i,"logItemExecuted"),96);this.ga.fb(ec.a.fIg,Jb.a.frame,Object(a.a)(this,
this.y$i,"logControlDeactivation"),96);this.ga.fb(ec.a.eIg,Jb.a.frame,Object(a.a)(this,this.V$i,"logInputFocus"),96);this.ga.fb(ec.a.aIg,Jb.a.frame,Object(a.a)(this,this.Z$a,"interactionBegin"),96);this.ga.fb(ec.a.hIg,Jb.a.frame,Object(a.a)(this,this.Z$a,"interactionBegin"),96);this.ga.fb(ec.a.dIg,Jb.a.frame,Object(a.a)(this,this.U$i,"logInputBlur"),96);this.ga.fb(ec.a.gIg,Jb.a.frame,Object(a.a)(this,this.x$i,"logControlActivated"),96);this.ga.fb(ec.a.ord,Jb.a.frame,Object(a.a)(this,this.dqi,"focusSearchBox"),
96);this.ga.fb(ec.a.XHg,Jb.a.frame,Object(a.a)(this,this.x6h,"constructLiveNotificationForMenu"),96);this.ga.fb(ec.a.iIg,Jb.a.frame,Object(a.a)(this,this.vWf,"insertTryQuery"),96);this.ga.fb(ec.a.b4f,Jb.a.frame,Object(a.a)(this,this.vWf,"insertTryQuery"),96);this.ga.fb(ec.a.mDf,Jb.a.frame,this.WYa,96);this.ga.fb(ec.a.nDf,Jb.a.frame,this.WYa,96);this.ga.fb(ec.a.oDf,Jb.a.frame,this.WYa,96);this.ga.fb(ec.a.pDf,Jb.a.frame,this.WYa,96);this.ga.fb(ec.a.qDf,Jb.a.frame,this.WYa,96);this.ga.fb(ec.a.cig,Jb.a.frame,
this.WYa,96);this.ga.fb(ec.a.dig,Jb.a.frame,this.WYa,96);this.ga.fb(ec.a.eig,Jb.a.frame,this.WYa,96);this.ga.fb(ec.a.Dkg,Jb.a.frame,this.U$a,96);this.ga.fb(ec.a.Ekg,Jb.a.frame,this.U$a,96);this.ga.fb(ec.a.Fkg,Jb.a.frame,this.U$a,96);this.ga.fb(ec.a.$Hg,Jb.a.frame,this.Spj,96);this.ga.fb(ec.a.jIg,Jb.a.frame,this.WYa,96);this.ga.fb(ec.a.ehf,Jb.a.frame,this.nhe,96);this.ga.fb(ec.a.fhf,Jb.a.frame,this.nhe,96);this.ga.fb(ec.a.ghf,Jb.a.frame,this.nhe,96);this.ga.fb(ec.a.a1b,Jb.a.frame,this.a1b,96);this.ga.fb(ec.a.B3f,
Jb.a.frame,this.p6i,96);this.ga.fb(ec.a.Dpg,Jb.a.frame,this.fyj,96);this.ga.fb(ec.a.uGf,Jb.a.frame,this.usi,96)}Luo(sa){this.qHd=!1;const ab=window.performance.now();sa.wbb.isCompleted?(this.qHd=!0,this.V0e(!0)):sa.n2(()=>{this.qHd=!0;this.V0e(!0);this.We.lC(y.a.tSl,window.performance.now()-ab)});this.Dvo(sa)}Dvo(sa){Rb.a.Bte(this.P_d);Rb.a.E_c([new ib.a(ec.a.su,Jb.a.frame,96),new ib.a(ec.a.YHg,Jb.a.frame,96),new ib.a(ec.a.cIg,Jb.a.frame,96),new ib.a(ec.a.fIg,Jb.a.frame,96),new ib.a(ec.a.eIg,Jb.a.frame,
96),new ib.a(ec.a.aIg,Jb.a.frame,96),new ib.a(ec.a.hIg,Jb.a.frame,96),new ib.a(ec.a.dIg,Jb.a.frame,96),new ib.a(ec.a.gIg,Jb.a.frame,96),new ib.a(ec.a.ord,Jb.a.frame,96),new ib.a(ec.a.XHg,Jb.a.frame,96),new ib.a(ec.a.iIg,Jb.a.frame,96),new ib.a(ec.a.b4f,Jb.a.frame,96),new ib.a(ec.a.mDf,Jb.a.frame,96),new ib.a(ec.a.nDf,Jb.a.frame,96),new ib.a(ec.a.oDf,Jb.a.frame,96),new ib.a(ec.a.pDf,Jb.a.frame,96),new ib.a(ec.a.qDf,Jb.a.frame,96),new ib.a(ec.a.cig,Jb.a.frame,96),new ib.a(ec.a.dig,Jb.a.frame,96),new ib.a(ec.a.eig,
Jb.a.frame,96),new ib.a(ec.a.Dkg,Jb.a.frame,96),new ib.a(ec.a.Ekg,Jb.a.frame,96),new ib.a(ec.a.Fkg,Jb.a.frame,96),new ib.a(ec.a.$Hg,Jb.a.frame,96),new ib.a(ec.a.jIg,Jb.a.frame,96),new ib.a(ec.a.ehf,Jb.a.frame,96),new ib.a(ec.a.fhf,Jb.a.frame,96),new ib.a(ec.a.ghf,Jb.a.frame,96),new ib.a(ec.a.a1b,Jb.a.frame,96),new ib.a(ec.a.B3f,Jb.a.frame,96),new ib.a(ec.a.Dpg,Jb.a.frame,96),new ib.a(ec.a.uGf,Jb.a.frame,96)],sa)}dqi(sa,ab,eb){if(1===eb)return 32;this.vQj();sa=!1;(this.jc.p0a||this.m3a)&&(ab=document.getElementById("SearchButton"))&&
ab.click();if(!this.jc.p0a&&this.m3a)for(ab=document.getElementsByClassName("ms-suiteux-search-box"),eb=0;eb<ab.length;eb++){const fb=ab[eb].querySelector("input[type=search]");fb&&(sa=jc.FocusManager.bO(fb))}else sa=jc.FocusManager.bO($get(this.jc.Cs?x.a.qEg:x.a.xCe));this.eKc=!0;return sa?32:8}vWf(sa,ab,eb,fb,Cb){if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.vQj();sa=Cb.CommandValueId;ab=this.jc.Cs?x.a.qEg:x.a.xCe;this.jc.Cs&&
!S.c(Cb[Qc.a.P_a])&&(Cb[Qc.a.P_a]=!1);if(sa){if(this.jc.Cs)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(sa)),this.pib=[19],32;if(Cb=$get(ab))Cb.value=sa}return jc.FocusManager.bO($get(ab))?32:8}vQj(){this.Zb.WN(this.jc.p0a||this.m3a?this.jc.HRb:this.jc.Odb,!1)}chm(sa,ab){switch(sa){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,ab);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,ab);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,
ab);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,ab)}return ab}x6h(sa,ab,eb,fb,Cb){if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;sa=this.QFa?this.QFa.BHj:0;Cb.Value=1!==sa?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,sa):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.QFa)for(const lc of this.QFa.WWl)Cb=Object(l.a)(W.a,
lc)?lc.id:la.a.replaceAll(lc.value,'"',""),(Cb=$get(Cb+"-"+K.a.ZHg))&&Nb.a.Is(Cb,Nb.a.Yja,la.a.If(this.chm(lc.groupType,Cb.innerText)));return 32}QYh(sa,ab,eb,fb,Cb){if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.Z4b=new Ac.a(2,1,0,()=>{Cb[xc.a.Callback]()},97);this.QFa&&this.Gb.Yb(this.Z4b);return 32}Z$i(sa,ab,eb,fb,Cb){if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:LogItemExecuted","actiondata comes null"),
16;Cb.CloseAllMenus&&(sa=void 0===Cb.ParentControlId||null===Cb.ParentControlId?"<NA>":Cb.ParentControlId,ab=this.B5b?this.B5b[Cb.ControlId]:null,!ab&&this.B5b&&"<NA>"!==sa&&(ab=this.B5b[sa]),ab||(ab=this.N8b&&this.R5.Rin(Cb),ab=this.OTl(ab,Cb.ControlId),ab=new u(ab,32,4,-1,-1,-1),this.We.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Cb.ControlId+" determined group:"+V.a[ab.groupType])),this.We.GYn(Cb.ControlId,sa,Cb.CommandId,Cb.CloseAllMenus,ab),this.f4a.HUn(Cb.ControlId),Cb.Location!==
za.a.contextMenu&&(this.R5.V5a(Cb),this.R5.UG(ab.resultType),this.jc.lze&&this.fqa.EYk(Cb.CommandId)));return 32}y$i(sa,ab,eb,fb,Cb){if(1===eb)return 32;(new Ka(this.z9d())).GIm(this.j6b);sa=this.j6b;ab=this.bya;eb=this.We.mzd;if(S.c(Cb))return this.We.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Cb=Cb.UILocation;sa&&0<sa.length&&this.mKc&&K.a.fCg(this.jc)&&this.jc.kge&&19!==Cb&&ab>eb&&!this.jc.AS&&(this.We.R6f(sa),this.We.rzg(ab));this.We.tIo();this.jc.MFe&&19!==Cb&&(this.ZM.mark(3),
this.ZM.measure(1,0,3),this.ZM.measure(2,2,3),this.ZM.F6f(0,1,2),this.ZM.F6f(2,2,3),this.ZM.F6f(1,0,3),this.ZM.btl(),this.ZM.clearMeasures([0,2,1]));this.We.iZn(window.performance.now()-this.O0e);this.jc.Cs&&(this.Nhb=null,this.We.TCa());this.eKc=this.b8b=!1;this.j6b="";return 32}V$i(sa,ab,eb){if(1===eb)return 32;this.We.Yvb(v(ab),this.eKc);return 32}U$i(sa,ab,eb){if(1===eb)return 32;this.We.TCa();this.b8b=!1;return 32}x$i(sa,ab,eb,fb,Cb){if(1===eb)return 32;this.e2=null;Cb&&(this.e2=Cb);this.jc.MFe&&
(S.c(this.e2)||this.e2.Location!==za.a.contextMenu)&&this.ZM.mark(0);this.We.iye(S.c(this.e2)||S.c(this.e2.Location)?za.a.unknown:this.e2.Location);this.We.hZn(this.Ruh,this.eKc);this.b8b||this.ucb();return 32}f$h(sa,ab){const eb=[],fb=Date.now();for(const Cb of sa)sa=(fb-Cb.timeStamp)/1E3,sa=K.a.SDe(sa),Array.add(eb,new P(ab?Cb.commandId:Cb.controlId,sa));return eb}PMl(sa){const ab=[],eb=Date.now();for(const fb of sa)if(fb.controlId||"keyboardShortcut"===fb.commandSurface)sa=(eb-fb.timeStamp)/1E3,
sa=K.a.SDe(sa),Array.add(ab,new Y(fb.controlId,fb.commandId,sa,fb.commandSurface,fb.BCe));return ab}U$h(sa=!1){var ab=sa?this.R5.AIm():this.R5.M2c();sa=[];const eb=Date.now();for(const fb of ab)ab=(eb-fb.TimeStamp)/1E3,ab=K.a.SDe(ab),Array.add(sa,new P(fb.Id,ab));return sa}ucb(){if(!this.b8b){this.N8b=this.b8b=!0;if(!this.tqh){this.tqh=!0;const sa={};sa.IsMLREnabled=this.jc.kpn;sa.IsReactRibbonEnabled=this.jc.Cs;sa.IsSharedHeaderEnabled=!!R.AFrameworkApplication.ta&&R.AFrameworkApplication.ta.Hb.KN;
sa.IsSearchUxEnabled=this.m3a;sa.IsTellMeInHeaderEnabled=this.jc.p0a;sa.IsGoLocalEnv=K.a.nmn();sa.IsSovereignEnvironment=K.a.wpc();sa.IsTellMeServiceResultsEnabled=K.a.fCg(this.jc);sa.IsSubstrateProviderEnabled=K.a.eCg(this.jc);sa.ShouldFetchTokens=!!R.AFrameworkApplication.ta&&R.AFrameworkApplication.ta.Hb.J0b;sa.IsSerpletEnabled=K.a.Hta();sa.FirstOnClickTimeInMS=Math.round(window.performance.now());sa.IsHeaderHidden=R.AFrameworkApplication.hideHeader||R.AFrameworkApplication.W_;sa.IsSearchInHeaderHidden=
R.AFrameworkApplication.v6c;void 0!==window.performance.timing&&null!==window.performance.timing&&(sa.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));sa.IsFindWithMatchesEnabled=this.jc.g3d;sa.HelpShowsTopSearchResult=this.jc.fpd;sa.HelpShowsNumberOfMatches=this.jc.epd;R.AFrameworkApplication.J&&(sa.UiHost=R.AFrameworkApplication.J.jb("UiHostIntegrationType"));this.We.bIn(JSON.stringify(sa))}this.tNe=this.f$h(z.a.instance.C2c(),!1);this.Rbh=this.f$h(z.a.instance.rqb(),
!0);this.$Jh=this.PMl(z.a.instance.rqb());this.yvh=this.U$h();this.zvh=this.U$h(!0);this.We.ucb()}}Z$a(sa,ab,eb,fb,Cb){if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(ic.a.L9c)return 32;this.O0e=window.performance.now();this.ucb();sa=new aa(this.ZCa,0);this.bya++;this.We.beginQuery("",this.bya,this.N8b);this.dMg(!0,null);this.QFa=Xa.V0d;this.Nhb=ja.vAf;if(this.fqa)qa.instance.actions=[],this.fqa.gK(new Z("",this.bya),sa,this.jc.Cs);
else this.We.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Z4b&&this.Gb.Yb(this.Z4b);return 32}HJo(sa){if(1===sa)return 32;this.Zb.oV(this.jc.p0a||this.m3a?this.jc.HRb:this.jc.Odb,!1);return 32}su(sa,ab,eb,fb,Cb){if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:TellMe","actiondata comes null"),16;this.e2=Cb;this.We.iye(S.c(this.e2.Location)?za.a.unknown:this.e2.Location);sa=this.e2.Value;this.jc.Cs||sa&&""!==sa.trim()?(!this.Nhb&&this.jc.Cs&&
(this.We.Yvb(v(ab),this.eKc),this.ucb()),this.e5l(sa,this.e2.Location),this.e2.PopulationXML=this.QFa.xml):this.N8b?this.e2.PopulationXML=this.QFa.xml:(this.e2.PopulationXML=Xa.V0d.xml,this.Nhb=ja.vAf,this.j6b="");return 32}e5l(sa,ab){this.O0e=window.performance.now();this.jc.MFe&&ab!==za.a.contextMenu&&this.ZM.mark(1);this.jc.Cs&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(sa));sa&&0<sa.trim().length&&(this.N8b=!1);this.jc.y3l();ab=S.c(ab)?za.a.su:ab;if(sa!==this.j6b||this.jc.Cs){this.bya++;
this.We.beginQuery(sa,this.bya,this.N8b);this.dMg(!0,null);const eb=new Z(sa,this.bya),fb=new aa(this.ZCa,this.bya);this.QFa=Xa.V0d;this.Nhb=ja.vAf;if(this.fqa)qa.instance.actions=[],this.fqa.gK(eb,fb,this.jc.Cs,ab,this.pib),this.pib=null;else this.We.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Ruh=this.bya;this.j6b=sa}}Wzp(sa){if(this.jc.Cs){var ab=appChrome.selectors.getActiveControlStates();if(ab=Object(w.a)(Object,ab[sa.value])){sa.label=ab.label;let eb=
null;"description"in ab&&(eb=ab.description);eb&&Object.getType(eb)===String?sa.description=eb:"secondaryText"in ab?sa.description=ab.secondaryText:"fullDescriptionLabel"in ab&&(sa.description=ab.fullDescriptionLabel)}}}Neo(sa){this.B5b={};let ab=0,eb=0;for(const fb of sa){sa=0;for(const Cb of fb.results)this.B5b[Cb.value]=new u(Cb.groupType,Cb.type,Cb.subType,ab,sa,eb),sa++,eb++,Cb.label||5!==Cb.type||this.Wzp(Cb);0<sa&&ab++}}qtc(sa,ab,eb,fb,Cb){if(1===eb)return 32;if(S.c(Cb))return this.We.onError("TellMeActor:OpenUrlInNewTab",
"actiondata comes null"),16;(sa=Cb.CommandValueId)&&window.open(sa,"_blank");return 32}E6i(sa){const ab={};ab.token=this.gEg;ab.files=ua.c(sa);ab.type="MultiFilesDeckGeneration";if(R.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Pb(ec.a.Wzn,2,ab),!0;sa=K.a.oHi("",K.a.DHj("GenerateDeckFromFile"),Object.assign(new fd.a,{landingTab:"All",data:ab}));sa=this.ga.Pb(ec.a.jba,2,sa);return 32!==sa?(this.We.onError("LaunchSmartLookupWithFilesData",
"CommonCommands.InvokeSerplet failed. Response: "+sa+"."),!1):!0}pdn(sa,ab){if(1===sa)return 32;if(S.c(ab))return this.We.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(S.c(this.dJc))return this.We.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;sa=ab.CommandValueId;return S.c(sa)?(this.We.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.dJc.insertHtmlText(sa)?32:(this.We.onError("TellMeActor:InsertUrl","url is not inserted"),16)}OTl(sa,
ab){return ab.startsWith(this.jc.Cs?K.a.LKg:K.a.fEe)?5:sa?4:"bSearchHelp"===ab||ab.startsWith("GetHelpFromTellMe")?8:"bInsights"===ab||ab.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===ab?24:ab===this.jc.DDf?2:0}UG(sa,ab){this.fqa?this.fqa.UG(sa,ab):Array.add(this.oKd,new G(sa,ab))}dMg(sa,ab="",eb=null){sa?this.a5b=new m.a(f.a.vh()):ab&&eb&&this.a5b.add(ab,eb)}static get instance(){return qa._instance||(qa._instance=new qa)}}qa._instance=null;qa.Vkp="mso_tellMeService";qa.unknown="Unknown";
qa.p7l=500;Object(I.a)(qa,"TellMeActor",null,[])},1391:function(I,J,d){d.d(J,"a",function(){return f});I=d(0);var m=d(1411);class f{constructor(a,l){this.ujb=!1;const {Annotations:w}=d(1383);if(!a)throw Error.argumentNull("annotations");if(!a.i2f(l))throw Error.argument("memberTypeID","Invalid type ID");if(w.yK(l))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Kx=a;this.AFk=l;this.mq=[]}get rdc(){return this.Kx}get isReadOnly(){return this.ujb}get b8(){return this.AFk}get items(){return this.mq}jia(){const {Annotations:a}=
d(1383);let l="[";for(let w=0,z=this.items.length;w<z;++w){0<w&&(l+=", ");const x=this.Kx.jia(this.b8,this.items[w]);this.b8===a.Uca?(l+='"',l+=m.a.PBf(x),l+='"'):l+=x}return l+"]"}isEqual(a){const {Annotations:l}=d(1383);if(this===a)return!0;if(!a||a.rdc!==this.Kx||a.b8!==this.b8||a.items.length!==this.items.length)return!1;for(let w=0;w<this.items.length;++w)if(!l.QAb(this.b8,this.items[w],a.items[w]))return!1;return!0}clone(){const a=new f(this.Kx,this.b8);Array.addRange(a.items,this.items);return a}UW(){return this.isReadOnly?
this.clone():this}f6f(){const {Annotations:a}=d(1383);if(!this.isReadOnly){this.ujb=!0;for(const l of this.items)a.iVb(l)}}toString(){return this.jia()}}Object(I.a)(f,"ListValue",null,[1857,1856])},1393:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.su="TellMe";m.contextMenu="ContextMenu";m.unknown="Unknown";Object(I.a)(m,"TellMeScenario",null,[])},1395:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a,l=null,w=null,z=4,x=-99999,u=0){this.hL="";this.fSd=
-1;this.value=f;this.type=a;this.subType=z;this.label=this.NE=l;this.groupType=30;this.description=w;this.score=x;this.count=u}}Object(I.a)(m,"ResultBinding",null,[])},1397:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f){this.attributes=null;this.query=f;this.hp=[]}kw(f){this.hp.push(f)}wDj(f){const a=[];for(const l of this.hp)l.groupType!==f&&a.push(l);this.hp.length!==a.length&&(this.hp=a)}get $oc(){return!1}}Object(I.a)(m,"SimpleResultsUpdatedEventArgs",null,[1844])},
1398:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f=30,a=""){this.FO=[];this.groupType=f;this.displayName=a}get results(){return this.FO}jy(f){f.groupType=this.groupType;Array.add(this.results,f)}Hsg(f=1){if(this.results.length>=f)for(let a=0;a<f;a++)Array.removeAt(this.results,this.results.length-1)}}Object(I.a)(m,"SimpleResultGroup",null,[1820])},1411:function(I,J,d){I=d(0);class m{constructor(a,l){this.Omb=a;this.value=l}}Object(I.a)(m,"AttrValuePair",null,[]);d.d(J,
"a",function(){return f});class f{constructor(a){this.ujb=!1;if(!a)throw Error.argumentNull("annotations");this.Kx=a;this.u0=[]}get rdc(){return this.Kx}get isReadOnly(){return this.ujb}get mSf(){return 0<this.u0.length}pr(a){if(!this.Kx.Jpc(a))throw Error.argument("attributeID","Invalid attribute ID");for(const l of this.u0)if(a===l.Omb)return a=l.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}kA(a,l){var {Annotations:w}=d(1383);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");
if(!this.Kx.Jpc(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Kx.Ioc(this.Kx.getAttributeType(a),l))throw Error.argument("value","Value is not of the correct type for the specified attribute");w.iVb(l);for(w=0;w<this.u0.length;++w){const z=this.u0[w];if(a===z.Omb){z.value=l;return}}Array.add(this.u0,new m(a,l))}YZa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Kx.Jpc(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(let l=0;l<this.u0.length;++l)if(a===this.u0[l].Omb){Array.removeAt(this.u0,l);break}}h4d(a){if(!a)throw Error.argumentNull("action");for(const l of this.u0)a(l.Omb,l.value)}clone(){const a=new f(this.Kx);a.s7a(this);return a}s7a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.rdc!==this.Kx)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.u0);
a.h4d((l,w)=>{this.kA(l,w)})}jia(){const {Annotations:a}=d(1383);let l="[",w=!0;for(const z of this.u0){w?w=!1:l+=", ";l+=this.Kx.Hti(z.Omb);l+="=";const x=this.Kx.getAttributeType(z.Omb),u=this.Kx.jia(x,z.value);x===a.Uca?(l+='"',l+=f.PBf(u),l+='"'):l+=u}return l+"]"}isEqual(a){const {Annotations:l}=d(1383);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.Kx!==a.rdc||this.mSf!==a.mSf)return!1;let w=0,z=null,x=!1;a.h4d((u,v)=>{++w;if(!x){var F=-1;for(let y=0,G=this.u0.length;y<
G;++y)if(this.u0[y].Omb===u){F=y;break}0>F?x=!0:(z||(z=Array(this.u0.length)),z[F]=v)}});if(this.u0.length!==w||x)return!1;for(let u=0,v=this.u0.length;u<v;++u)if(!l.QAb(this.Kx.getAttributeType(this.u0[u].Omb),this.u0[u].value,z[u]))return!1;return!0}UW(){return this.isReadOnly?this.clone():this}f6f(){const {Annotations:a}=d(1383);if(!this.isReadOnly){this.ujb=!0;for(const l of this.u0)a.iVb(l.value)}}toString(){return this.jia()}static PBf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]",
"\\]").replace(",","\\,")}}Object(I.a)(f,"FeatureBundle",null,[1855,1856])},1424:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.click="Click";m.Z$a="InteractionBegin";m.LSb="InteractionEnd";m.I7h="ControlActivated";m.query="Query";m.Fxj="QueryIndexRecorded";m.B4h="Clicks";m.fMh="ActionEvents";m.aoi="FilteredActionEvents";m.JMj="SessionContext";m.latency="Latency";m.performance="Performance";m.iFj="RenderedResults";m.events="Events";m.HKl="CreateResultsMenu";m.lJ="UpdateRibbonControls";
m.ZJo="ResultsAggregation";m.gK="IssueQuery";m.Nwl="CommandSuggestions";m.error="Error";m.P5f="LoadModelData";m.tSl="DepsResolveTime";m.SPn="ModelDataWaitTime";m.TIg="TimedOut";m.Y3k="AddinQueryCommandReady";m.Ghm="GetAddinEntitlements";m.bxj="ProviderMRUEvents";m.K0l="EnableAddinSearchCommands";Object(I.a)(m,"EventNames",null,[])},1434:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(){this.T7f=null;this.uga=this.V7f=0}LFf(f,a,l){if(!f)throw Error.argumentNull("referenceList");
if(0>a||a>f.length)throw Error.argumentOutOfRange("startIndex");if(0>l||l>f.length)throw Error.argumentOutOfRange("length");if(a+l>f.length)throw Error.argument("Invalid start-length range");this.T7f=f;this.V7f=a;this.uga=l}jqb(f,a,l){this.LFf(f.T7f,f.V7f+a,l)}K(f){if(0>f||f>=this.uga)throw Error.argumentOutOfRange("index");return this.T7f[this.V7f+f]}get count(){return this.uga}static luf(f){const a=new m;a.LFf(f,0,f.length);return a}}Object(I.a)(m,"ReadOnlyList",null,[1872])},1446:function(I,J,
d){d.d(J,"a",function(){return m});I=d(0);var m;(function(f){f[f.qOp=0]="Classifier";f[f.RNp=1]="AppsForOffice";f[f.MHe=2]="FindInDocument";f[f.KPp=3]="FindInDocumentScopedSearch";f[f.dSp=4]="RecentlyUsed";f[f.Xkk=5]="TryQuery";f[f.Empty=6]="Empty";f[f.ETp=7]="TryCommand";f[f.iek=8]="Assistance";f[f.aek=9]="Answer";f[f.Definition=10]="Definition";f[f.Entity=11]="Entity";f[f.Mlk=12]="WolframAnswer";f[f.bhk=13]="Insights";f[f.People=14]="People";f[f.Document=15]="Document";f[f.eSp=16]="Recommended";
f[f.ISp=17]="ServiceClassifier";f[f.JSp=18]="ServiceRecommended";f[f.Image=19]="Image";f[f.Notes=20]="Notes";f[f.Hhk=21]="Learning";f[f.Feedback=22]="Feedback";f[f.Template=23]="Template";f[f.Rdk=24]="ActionAI";f[f.Sdk=25]="ActionAICommand";f[f.ckk=26]="SummarizeDeck";f[f.Zdk=27]="Addin";f[f.Lik=28]="OfficeScript";f[f.$dk=29]="AddinStoreEntry";f[f.None=30]="None";f[f.VQp=31]="MergedActions";f[f.WQp=32]="MergedScopedSearches";f[f.XQp=33]="MergedSuggestedSearches"})(m||(m={}));Object(I.b)("ResultGroupType",
m)},1457:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1532);class m extends d.a{constructor(){super();this.info=this.ek=this.eventId=null}get mfa(){return"Misc"}WPb(){this.detail.W("Type",this.mfa);this.detail.W("EventId",this.eventId);this.detail.W("Func",this.ek);this.detail.W("Info",this.info);return this.detail}}Object(I.a)(m,"BasicMergeFailureDetail",d.a,[])},1458:function(I,J,d){d.d(J,"a",function(){return l});I=d(0);var m=d(605),f=d(800),a=d(1479);class l{constructor(w,z=!0){this.Gm=
z&&w?w.$O():w;this.Bbc=new m.a}cN(w){this.Bbc.add(f.a.zb(w))}j1o(w){this.Bbc=w}kej(w){this.Gm&&(new a.a(this.Gm,w)).mNa.forEach((z,x)=>{x.s3&&!this.Bbc.contains(z)&&(this.Bbc.add(z),x.isDeleted?(x=this.Gm,x.hasProperty(f.a.D_(z))&&x.removeProperty(f.a.D_(z))):this.Gm.seb(f.a.D_(z),x.newValue));return!0})}}Object(I.a)(l,"PartialMergeResult",null,[])},1459:function(I,J,d){d.r(J);d.d(J,"CommandResultsUtility",function(){return v});I=d(0);var m=d(1475),f=d(1424),a=d(1476),l=d(1395),w=d(1398),z=d(1389),
x=d(1388),u=d(2);class v{static Ysd(F,y){if(y&&y.Cs){const G={};for(const C of F)y.Ege(C)&&(G[C]=appChrome.selectors.getModelType(C));z.TellMeActor.instance.lJ(G)}}static hlp(F){return F.startsWith("btnTellMeOfficeAddIn")}static S8c(F){const y=z.TellMeActor.instance.HR();return!!y&&y.Cs&&!appChrome.selectors.isControlDisabled(F)}static mie(F,y,G,C){if(z.TellMeActor.instance.We&&F){const H=[];for(const K of F)H.push(String.format('{{"Id":"{0}","Score":{1}}}',K.commandId,K.score));F={};F[m.a.suggestions]=
"[{"+H.join(",")+"}]";F[m.a.P4i]=y;F[m.a.groupType]=G;F[m.a.provider]=C;z.TellMeActor.instance.We.lC(f.a.Nwl,window.performance.now(),F)}}static Wom(F,y){const G=[],C=[];for(const H of y){y=H.commandId;let K=H;H.commandId in F&&(y=F[H.commandId],K=new a.a(y,H.score));Array.contains(C,y)||(G.push(K),C.push(y))}return G}static F4c(F,y,G,C,H,K,R,E){var L;G.HIf&&(y=v.Wom(G.HIf,y));var O=x.a.mnm(y);v.Ysd(O,G);var V=[],Z=[];O=[];const W=new w.a(R);R=16===R||18===R||7===R||4===R?u.AFrameworkApplication.J?
u.AFrameworkApplication.J.fc("TellMeMaxRecommendedResultsToReturn",3):3:0===R||17===R||25===R?5:0;for(const S of y)if(!v.Pin(S.commandId)){y=v.hlp(S.commandId);if(G.Ege(S.commandId)&&!y){if(x.a.n3i(S.commandId))continue;y=null;H&&K&&(y=H.dGm(S.commandId,K));v.S8c(S.commandId)?Array.add(V,new l.a(S.commandId,5,y,null,E,S.score)):Array.add(Z,new l.a(S.commandId,5,y,null,E,S.score))}else G.JKb&&y&&C&&Array.add(O,S.commandId.substr(21));if(V.length+O.length>=R)break}G=0;for(H=0;H<V.length&&G<R;H++,G++)W.jy(V[H]);
var P=(L=(V=null===(L=u.AFrameworkApplication.J)||void 0===L?void 0:L.getBooleanFeatureGate("Microsoft.Office.WordOnline.disabledButtonsInTellMeShouldHide",!1))?null===(P=null===appChrome||void 0===appChrome?void 0:appChrome.api)||void 0===P?void 0:P.getSharedUxSettings():void 0)?L.commonSettings:void 0;if(!V||!P||!P().Nnq())for(P=0;P<Z.length&&G<R;P++,G++)W.jy(Z[P]);for(Z=0;Z<O.length&&G<R;Z++,G++)C.fsq(F,O[Z],W);return W}static Pin(F){v.oWh||(u.AFrameworkApplication.J&&u.AFrameworkApplication.J.my("TellMeControlPredictionBlockList")&&
u.AFrameworkApplication.J.pD("TellMeControlPredictionBlockList").forEach(y=>{Array.add(v.nWh,y.toLowerCase())}),v.oWh=!0);return Array.contains(v.nWh,F.toLowerCase())}static YXf(F){return 2<F.length&&";"===F.charAt(0)&&";"===F.charAt(F.length-1)&&!!u.AFrameworkApplication.J&&(u.AFrameworkApplication.J.$("TellMeCommandHookIsEnabled")||u.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static zvi(F){const y=new w.a(0);var G=F.split(";");F=
z.TellMeActor.instance.HR();for(const C of G)if(0<C.length){G=C.split(":");const H=2===G.length?G[0]:C;if(!F.Ege(H))break;if(1===G.length)G=new l.a(H,5,null,null,1),y.jy(G);else if(2===G.length)G=new l.a(H,5,G[1],null,1),y.jy(G);else break}return y}static MXk(F,y,G){if(!(y&&y.results&&F&&F.results&&F.results.length))return{returnValue:!1,Oef:F,Jff:y};const C=[];for(var H of y.results)Array.add(C,H.value);H=0;const K=0<y.results.length?y.results[0].score:0;for(const R of F.results)if(R.score>G&&!Array.contains(C,
R.value)&&v.S8c(R.value)&&(0<K&&(R.score=K),Array.insert(y.results,H,R),H++),2===H)break;return 0<H?(G=y.results.length-5,0<G&&y.Hsg(G),{returnValue:!0,Oef:F,Jff:y}):{returnValue:!1,Oef:F,Jff:y}}}v.oWh=!1;v.nWh=[];Object(I.a)(v,"CommandResultsUtility",null,[])},1474:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{static fnp(f){return f.toString().charCodeAt(0)}static Mun(f){return 55296<=f&&57343>=f}static charAt(f,a){return f.charAt(a)}static dUh(f,a){if(f===a)return!0;"\u00a0"===
f&&(f=" ");"\u00a0"===a&&(a=" ");return f===a}static cUh(f,a){if(f===a)return!0;if(!f||!a||f.length!==a.length)return!1;f=m.rFj(f);a=m.rFj(a);return f===a}static rFj(f){return f.replace(m.Xcd," ")}static tzb(f,a,l){return f.substring(a,a+l)}}m.Xcd=RegExp("\u00a0","g");Object(I.a)(m,"CharUtils",null,[])},1475:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.appName="AppName";m.G6="CloseAllMenus";m.commandId="CommandId";m.context="Context";m.culture="Culture";m.message="Message";m.errorMessage=
"ErrorMessage";m.event="Event";m.jta="CorrelationID";m.Mao="ParentUiElement";m.query="Input";m.EYb="QueryID";m.Kxj="QueryLength";m.Quc="QueryIndex";m.$Jo="ResultsList";m.suggestions="Suggestions";m.scenario="Scenario";m.sessionId="SessionID";m.source="Source";m.timeStamp="Time";m.s5j="UiElement";m.mte="ReactUx";m.value="Val";m.statusCode="StatusCode";m.service="Service";m.isSuccess="IsSuccess";m.Vnp="TokenAcquired";m.Czn="LatencyType";m.groupName="GroupName";m.cba="GroupIndex";m.groupType="GroupType";
m.VJo="ResultInfoList";m.resultType="ResultType";m.jGg="SubResultType";m.znn="IsInputBlur";m.Ann="IsInputFocus";m.Rtn="IsShortCutUsed";m.actionType="ActionType";m.count="Count";m.WZl="DwellTime";m.P4i="IsZeroTerm";m.tMp="WordsCount";m.Ife="IsSearchUxEnabled";m.kvn="IsTellMeInHeaderEnabled";m.module="Module";m.resultIndex="ResultIndex";m.ryf="DisplayIndex";m.U0l="EnableList";m.provider="Provider";m.contentType="ContentType";m.ltn="IsSelectionBased";m.Adl="BeginPerformanceMarker";m.y1l="EndPerformanceMarker";
m.Rco="PerformanceMeasure";Object(I.a)(m,"Columns",null,[])},1476:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a){this.commandId=f;this.score=a}}Object(I.a)(m,"CommandSuggestion",null,[])},1479:function(I,J,d){I=d(0);var m=d(357),f=d(800),a=d(267),l=d(108);class w{constructor(x,u,v){this.CKk=x;this.UGk=u;this.oGk=v;this.SWe=new a.a(Object(l.a)(this,this.oql,"checkIfDifferent"))}get $ng(){return this.CKk}get oldValue(){return this.UGk}get newValue(){return this.oGk}get Vsb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get s3(){return this.Vsb||this.isDeleted||this.SWe.value}oql(){return this.Vsb||this.isDeleted?!0:!f.a.lUh(this.$ng,this.oldValue,this.newValue)}}Object(I.a)(w,"PropertyDiff",null,[]);d.d(J,"a",function(){return z});class z{constructor(x,u){this.RGk=x;this.lGk=u;this.SWe=new a.a(()=>this.c9c());this.EKk=
new a.a(Object(l.a)(this,this.k4l,"evaluatePropertyDiffs"))}get Uv(){return this.RGk}get Kf(){return this.lGk}get Vsb(){return!!this.Kf&&!this.Uv}get isDeleted(){return!this.Kf&&!!this.Uv}get s3(){return this.Vsb||this.isDeleted||this.SWe.value}get mNa(){return this.EKk.value}c9c(x=null){let u=!1;this.mNa.forEach((v,F)=>{u=F.s3&&(!x||7!==x.K(v));return!u});return u}k4l(){const x=new m.a;var u=this.Kf,v=this.Uv;if(this.Vsb){v=u.fk();for(var F=0;F<v.length;F++){var y=v[F];x.W(f.a.zb(y),new w(y,null,
u.kH(y)))}}else if(this.isDeleted)for(u=v.fk(),F=0;F<u.length;F++)y=u[F],x.W(f.a.zb(y),new w(y,v.kH(y),null));else{F=v.fk();for(y=0;y<F.length;y++){var G=F[y],C=f.a.zb(G),H=v.kH(G);const K=u.hasProperty(G)?u.kH(G):null;x.W(C,new w(G,H,K))}F=u.fk();for(y=0;y<F.length;y++)G=F[y],v.hasProperty(G)||(C=f.a.zb(G),H=u.kH(G),x.W(C,new w(G,null,H)))}return x}}Object(I.a)(z,"MergeableObjectDiff",null,[])},1492:function(I,J,d){d.d(J,"a",function(){return f});I=d(0);var m=d(46);class f{constructor(){this.cp=
0;this.id=m.a.create()}}Object(I.a)(f,"LcsUpdateHint",null,[1135,308])},1493:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.su="TellMe";m.mJn="Loki";m.HZj="Substrate";m.Quc="QueryIndex";m.x0j="TellMeRanker";m.y0j="TellMeRankerLogging";Object(I.a)(m,"Services",null,[])},1494:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{}m.IWa="HttpRequest";m.provider="Provider";Object(I.a)(m,"LatencyTypes",null,[])},1500:function(I,J,d){I=d(0);var m=d(58),f=d(13),a=d(5),l=d(32),
w=d(221),z=d(177),x=d(236),u=d(46),v=d(605),F=d(108),y=d(240),G=d(1532);class C extends G.a{constructor(){super();this.jB=null}get mfa(){return"CreateMergeBlock"}WPb(){this.detail.W("Type",this.mfa);this.detail.W("Revision",this.jB);return this.detail}}Object(I.a)(C,"CreateMergeBlockFailureDetail",G.a,[]);var H=d(1596),K=d(1598),R=d(1727),E=d(1533),L=d(1458),O=d(1794),V=d(574);d.d(J,"a",function(){return Z});class Z{static IYd(W,P,S,aa,Y,X,ca){let fa;fa="";const ja=new w.a;for(let ya=0;ya<S.length;ya++){var ra=
void 0;let Ha;ra=H.a.mpm(P,S.K(ya),aa,Y,X,ca,W);if(!ra)return{returnValue:null,Rbb:fa};({a9f:Ha,Rbb:ra}=ra.gCi());if(!Ha)return{returnValue:null,Rbb:fa};fa+=ra;ja.wD(ja.length,Ha)}return{returnValue:ja,Rbb:fa}}static W$h(W,P,S,aa,Y,X,ca,fa){let ja,ra,ya,Ha,Wa,Ma;Ma=Wa=Ha=ya=ra=ja=null;({Rbb:Ha,returnValue:ja}=Z.IYd(P,ua=>W.runtime.Kn.K(ua),S,1,X,ca,fa));if(!ja)return z.a.instance.Ua(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),
W.logger.Ti(Object.assign(new C,{jB:"Base"})),{returnValue:!1,fN:ja,t0c:ra,Rsd:ya,rTd:Ha,z2d:Wa,DEe:Ma};({Rbb:Wa,returnValue:ra}=Z.IYd(P,ua=>W.runtime.QA.K(ua)||W.runtime.Kn.K(ua),aa,2,X,ca,fa));if(!ra)return z.a.instance.Ua(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),W.logger.Ti(Object.assign(new C,{jB:"Favored"})),{returnValue:!1,fN:ja,t0c:ra,Rsd:ya,rTd:Ha,z2d:Wa,DEe:Ma};({Rbb:Ma,returnValue:ya}=
Z.IYd(P,ua=>W.runtime.zv.K(ua)||W.runtime.Kn.K(ua),Y,4,X,ca,fa));return ya?{returnValue:!0,fN:ja,t0c:ra,Rsd:ya,rTd:Ha,z2d:Wa,DEe:Ma}:(z.a.instance.Ua(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),W.logger.Ti(Object.assign(new C,{jB:"Unfavored"})),{returnValue:!1,fN:ja,t0c:ra,Rsd:ya,rTd:Ha,z2d:Wa,DEe:Ma})}static z4h(W,P=!1){const S=new w.a;let aa=0;for(;aa<W.length;){var Y=W.K(aa);if(1===Y.type||
4===Y.type||2===Y.type)S.add(Y),aa++;else if(3===Y.type){let ca="";ca+=Y.character;aa++;let fa=Y.DXa,ja=!1;for(;aa<W.length;aa++){var X=W.K(aa);3===X.type?Y.runId===X.runId&&Y.DL.equals(X.DL)&&(Y.Ifa===X.Ifa||Y.SKa===X.SKa)&&Y.iA.gC(X.iA)&&(!P||Y.gv&&Y.gv.equals(X.gv))?(ca+=X.character,X.DXa&&(fa=!0)):ja=!0:ja=!0;if(ja){Y=new O.a(null,Y.source,Y.Bk,Y.Qg,Y.runId,Y.DL,ca,Y.vvb,!0,fa,Y.Ifa,Y.SKa,Y.EZa,Y.iA,Y.gv);S.add(Y);break}}}}z.a.instance.Ua(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
S.Vr());return S}static Dwl(W,P=!1){const S=new w.a;let aa=0;for(;aa<W.length;){var Y=W.K(aa);if(1===Y.type||4===Y.type||2===Y.type)S.add(Y),aa++;else if(3===Y.type){let ca=Y.character.toString();aa++;let fa=Y.DXa;for(;aa<W.length;aa++){var X=W.K(aa);if(3===X.type&&Z.x5o(Y,X,P))ca+=X.character,X.DXa&&(fa=!0);else break}Y=new O.a(null,Y.source,Y.Bk,Y.Qg,Y.runId,Y.DL,ca,Y.vvb,!0,fa,Y.Ifa,Y.SKa,Y.EZa,Y.iA,Y.gv);S.add(Y)}}z.a.instance.Ua(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
S.Vr());return S}static x5o(W,P,S){return W.runId===P.runId&&W.DL.equals(P.DL)&&(W.Ifa===P.Ifa||W.SKa===P.SKa)&&W.iA.gC(P.iA)&&(!S||!!W.gv&&W.gv.equals(P.gv))}static TZo(W,P,S,aa,Y,X,ca,fa,ja,ra,ya,Ha,Wa,Ma,ua,Ka){W.setPropertyString(S.Gm,f.a.Yn,Y);W.setPropertyUint32(S.Gm,a.a.Zc,aa);W.setPropertyUint32s(S.Gm,a.a.Mq,X);W.setPropertyUint32s(S.Gm,a.a.Ot,ca);W.setPropertyObjectIds(S.Gm,f.a.Zn,ja);W.hasProperty(S.Gm,a.a.Vj)&&W.setPropertyUint32(S.Gm,a.a.Vj,Z.bgm());P&&P(7)&&W.setPropertyObjectIds(S.Gm,
a.a.Iw,Ka);aa=!1;for(Y=0;Y<ra.length;Y++)if(ra.K(Y)){aa=!0;break}aa&&W.setPropertyBools(S.Gm,a.a.kcg,ra);Z.jkl(P,W,S,ya,Ha,Wa,Ma);Z.kkl(W,S,ua);S.cN(f.a.Yn);S.cN(a.a.Zc);S.cN(a.a.Mq);S.cN(a.a.Ot);S.cN(f.a.Zn);S.cN(a.a.kcg);S.cN(f.a.Dn);S.cN(f.a.hzb);S.cN(a.a.oWa);S.cN(a.a.lNa);S.cN(f.a.LCa);S.cN(a.a.Iw);W.hasProperty(S.Gm,a.a.Vj)&&S.cN(a.a.Vj);0<fa.length?W.setPropertyUint32s(S.Gm,f.a.Dn,fa):S.Gm.removeProperty(f.a.Dn)}static jkl(W,P,S,aa,Y,X,ca){if(W(92)){W=aa.contains(!0,(fa,ja)=>ja);Z.yAg(P,S,
f.a.LCa,W?aa:null);Z.yAg(P,S,f.a.hzb,Z.ZGj(aa,Y));Z.yAg(P,S,a.a.oWa,Z.ZGj(aa,X));aa=!1;for(Y=0;Y<ca.length;Y++)0!==ca.K(Y)&&(aa=!0);aa?P.setPropertyUint32s(S.Gm,a.a.lNa,ca):S.Gm.removeProperty(a.a.lNa)}}static kkl(W,P,S){const aa=ca=>ca;var Y=Object(F.a)(W,W.setPropertyBools,"setPropertyBools");Z.$Ta(P,S.Jsb,aa,Y,a.a.pLa);Z.$Ta(P,S.Kob,aa,Y,a.a.Ika);Z.$Ta(P,S.bdb,aa,Y,a.a.kNa);Y=ca=>0<ca.length;var X=Object(F.a)(W,W.setPropertyStrings,"setPropertyStrings");Z.$Ta(P,S.Isb,Y,X,a.a.qLa);Z.$Ta(P,S.Job,
Y,X,a.a.wJa);Z.$Ta(P,S.Rwb,Y,X,a.a.YOa);Y=ca=>!!ca;X=Object(F.a)(W,W.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");Z.$Ta(P,S.Ksb,Y,X,a.a.rLa);Z.$Ta(P,S.V7a,Y,X,a.a.xJa);Z.$Ta(P,S.Twb,Y,X,a.a.ZOa);Y=ca=>!!ca;X=Object(F.a)(W,W.VZo,"setPropertyList");Z.bnf(P,S.XWa,Y,X,l.a.YWa);Z.bnf(P,S.ENb,Y,X,l.a.QUa);Z.bnf(P,S.jYb,Y,X,l.a.C0a);S.bdb.any(aa)?Z.$Ta(P,S.Swb,()=>!0,Object(F.a)(W,W.setPropertyObjectIds,"setPropertyObjectIds"),a.a.LEa):P.Gm.removeProperty(a.a.LEa)}static ZGj(W,P){const S=
new w.a;let aa=!1;for(let Y=0;Y<W.length;Y++){const X=P.K(Y)&&!W.K(Y);S.add(X);aa=X||aa}return aa?S:null}static yAg(W,P,S,aa){aa?W.setPropertyBools(P.Gm,S,aa):P.Gm.removeProperty(S)}static bgm(){return x.a.gG()}static eDi(W,P){return W.runtime.QA.e3(P,W.runtime.Kn.K(P)||W.runtime.zv.get(P))}static V3c(W,P,S,aa,Y){let X;X=new w.a;const ca=!!S&&S(7),fa=!!S&&S(109);if(W.runtime.qc.isFeatureEnabled(68)){var ja=Z.Dwl(aa,ca);var ra=Z.z4h(aa,ca);ja.length!==ra.length&&W.runtime.qc.kK(68)}else ja=Z.z4h(aa,
ca);ra=0;let ya="",Ha=new w.a,Wa=new w.a,Ma=new w.a,ua=new w.a,Ka=new w.a,za=new w.a,Fa=new w.a,ea=new w.a,la=new w.a;const Na=new R.a;let Aa=new w.a;var wa=ja.K(ja.length-1);if(2!==wa.type&&4!==wa.type)return z.a.instance.Ua(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",wa.type),W.logger.Ti(Object.assign(new E.a,{ek:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",
wa.type)})),{returnValue:!1,Npe:X};var va=0;for(wa=0;wa<ja.length;wa++){var Pa=ja.K(wa),Ta=null;if(1===Pa.type||3===Pa.type)Ta=Pa,ya+=Ta.text;else if(4===Pa.type){Pa=Z.eDi(W,Pa.Bk);Pa=new L.a(Pa);X.add(Pa);continue}Ta?(Ha.add(Ta.runId),Wa.add(Ta.Qg),va+=Ta.text.length,Ma.add(va),ua.add(Ta.DL),Ka.add(Ta.vvb),za.add(Ta.DXa),Fa.add(Ta.Ifa),ea.add(Ta.SKa),la.add(Ta.EZa),Na.Jsb.add(Ta.iA.n_m),Na.Kob.add(Ta.iA.PZm),Na.bdb.add(Ta.iA.T_m),Na.Isb.add(Ta.iA.Lsb.author),Na.Job.add(Ta.iA.Lob.author),Na.Rwb.add(Ta.iA.Qua.author),
Na.Ksb.add(Ta.iA.Lsb.Gdd),Na.V7a.add(Ta.iA.Lob.Gdd),Na.Twb.add(Ta.iA.Qua.Gdd),Na.Swb.add(Ta.iA.Qua.Fmg),fa&&(Na.XWa.push(new V.a(!1,"",null,null!=Ta.iA.Lsb.qMa?P.uzg(Ta.iA.Lsb.qMa):null)),Na.XWa.push(new V.a(!1,"",null,null!=Ta.iA.Lob.qMa?P.uzg(Ta.iA.Lob.qMa):null)),Na.XWa.push(new V.a(!1,"",null,null!=Ta.iA.Qua.qMa?P.uzg(Ta.iA.Qua.qMa):null))),ca&&Aa.add(Ta.gv)):Ha.length||(Ha.add(0),Wa.add(0),Ma.add(0),ua.add(u.a.nil),Ka.add(!1),za.add(!1),Fa.add(!1),ea.add(!1),la.add(0),Na.Jsb.add(!1),Na.Kob.add(!1),
Na.bdb.add(!1),Na.Isb.add(""),Na.Job.add(""),Na.Rwb.add(""),Na.Ksb.add(0),Na.V7a.add(0),Na.Twb.add(0),Na.Swb.add(u.a.nil),fa&&(Na.XWa.push(new V.a(!1,"",null,null)),Na.ENb.push(new V.a(!1,"",null,null)),Na.jYb.push(new V.a(!1,"",null,null))));if(2===Pa.type){va=Pa;Pa=va.Zc;Ma.oI(Ma.length-1);Ta=Y.K(ra);if(!Ta)return z.a.instance.Ua(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
ra,Y.length,aa.length,wa,ja.length),W.logger.Ti(Object.assign(new E.a,{ek:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),z.a.instance.foa(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",Y.Vr()),z.a.instance.foa(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",aa.Vr()),z.a.instance.foa(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",ja.Vr()),{returnValue:!1,Npe:X};if(Ta=Z.eDi(W,Ta))Ta=new L.a(Ta.$O()),Z.TZo(P,S,Ta,
va.Zc,ya,Ha,Wa,Ma,ua,Ka,za,Fa,ea,la,Na,Aa),X.add(Ta);z.a.instance.Ua(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",va.Bk,Pa,Ha.Vr(),Wa.Vr(),Ma.Vr(),za.Vr(),Fa.Vr(),ea.Vr(),ua.Vr(),"",la.Vr());ra++;ya="";Ha=new w.a;Wa=new w.a;Ma=new w.a;ua=new w.a;Ka=new w.a;za=new w.a;Fa=new w.a;ea=new w.a;la=new w.a;Na.reset();va=
0;Aa=new w.a}}return{returnValue:!0,Npe:X}}static MIo(W,P){const S=W.runtime.Yq.K(y.a.cO),aa=P.getPropertyObjectIds(S.Gm,a.a.JY);for(let Y=0;Y<aa.length;Y++)W.runtime.Yq.remove(aa.K(Y));P.setPropertyObjectIds(S.Gm,a.a.JY,new w.a);P.setPropertyString(S.Gm,a.a.TEa,u.a.nil.toString());S.cN(a.a.JY);S.cN(a.a.TEa)}static R$m(W,P){if(W.runtime.Yq.mb(y.a.cO))return null;const S=new L.a(W.runtime.Kn.K(y.a.cO).$O());P.setPropertyString(S.Gm,a.a.TEa,W.output.bM.last().id.toString());P.setPropertyObjectIds(S.Gm,
a.a.JY,new w.a);S.cN(a.a.JY);S.cN(a.a.TEa);W.runtime.Yq.W(y.a.cO,S);return S}static OLf(W){const P=new w.a;W.forEach(S=>{P.add(S.id);return!0});return P}static grc(W,P,S,aa){let Y=0;S.forEach(X=>{K.a(X,P+Y++,1);X.wc===m.a.paragraphNode&&W.getPropertyObjectIds(X,f.a.Zn).forEach(ca=>{aa.add(ca);return!0});return!0})}static FFn(W,P){const S=new v.a;let aa=0;P.forEach(Y=>{if(S.contains(Y))return!0;S.add(Y);if(({index:aa}=Z.z6f("BaseFormatting_",aa,Y,X=>W.runtime.Kn.K(X))).returnValue||({index:aa}=Z.z6f("FavoredFormatting_",
aa,Y,X=>W.runtime.QA.K(X))).returnValue||({index:aa}=Z.z6f("ConflictingFormatting_",aa,Y,X=>W.runtime.zv.K(X))).returnValue)return!0;aa++;return!0})}static z6f(W,P,S,aa){if(S=aa(S))if(K.a(S,W+P,1),S.wc===m.a.O_a)return P++,{returnValue:!0,index:P};return{returnValue:!1,index:P}}static czf(W){return!!W.runtime.Kn.K(y.a.cO)}static $Ta(W,P,S,aa,Y){P.any(S)?(aa(W.Gm,Y,P),W.cN(Y)):W.Gm.removeProperty(Y)}static bnf(W,P,S,aa,Y){P.some(S)?(aa(W.Gm,Y,P),W.cN(Y)):W.Gm.removeProperty(Y)}static ZPj(W,P){const S=
new w.a;S.add(0);const aa=W?W.length:0;for(let Y=0;Y<aa;Y++)S.insert(Y+1,W.tg(Y));S.insert(S.length,P);return S}}Object(I.a)(Z,"ParagraphMergeUtils",null,[])},1530:function(I,J,d){d.d(J,"a",function(){return f});I=d(0);var m=d(221);class f{constructor(a,l,w){this.Gn=null;this.Sk=a;this.source=l;this.Bk=w}get type(){return this.Sk}get dfb(){return!1}get dmn(){return 1===(this.source&1)}get emn(){return 2===(this.source&2)}get fmn(){return 4===(this.source&4)}R7(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.lkm(),this.Gjc())}lkm(){let a="";this.dmn&&(a+="Base");this.emn&&(a+="FavoredUpdate");this.fmn&&(a+="UnfavoredUpdate");return a}Gjc(){return""}gC(a){return this.type===a.type}kqd(){const a=new m.a;a.add(this);return a}get length(){return 0}}Object(I.a)(f,"AMergeBlock",null,[217,218])},1531:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1530);class m extends d.a{constructor(f,a,l){super(2,f,a);this.Zc=l}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Zc,this.Bk)}Gjc(){return"Eop"}clone(){return new m(this.source,this.Bk,this.Zc)}gC(f,a,l,w=!1,z=!0){return super.gC(f,a,l,w)?z?f.Zc===this.Zc:f.Bk===this.Bk&&f.Zc===this.Zc:!1}get length(){return 1}}Object(I.a)(m,"EopMergeBlock",d.a,[])},1532:function(I,J,d){d.d(J,"a",function(){return f});I=d(0);var m=d(357);class f{constructor(){this.detail=new m.a}}Object(I.a)(f,"AMergeFailureDetail",null,[1136])},1533:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1457);class m extends d.a{constructor(){super()}get mfa(){return"ParagraphMerge"}}
Object(I.a)(m,"ParagraphMergeFailureDetail",d.a,[])},1534:function(I,J,d){d.d(J,"b",function(){return w});d.d(J,"a",function(){return x});var m=d(221),f=d(357),a=d(605),l=d(1728);const w=(v,F,y)=>{const G=z(v,F,y);let C=0,H=0,K=0,R=new l.a;const E=new m.a;for(let L=0;L<G.length;L++){const O=G.tg(L+1);R.vSd(v.tg(C));R.xSd(F.tg(H));R.BSd(y.tg(K));C++;H++;for(K++;C<v.length&&(!O||!O.equals(v.tg(C)));)R.vSd(v.tg(C)),C++;for(;H<F.length&&(!O||!O.equals(F.tg(H)));)R.xSd(F.tg(H)),H++;for(;K<y.length&&(!O||
!O.equals(y.tg(K)));)R.BSd(y.tg(K)),K++;E.add(R);R=new l.a}for(;C<v.length;)R.vSd(v.tg(C)),C++;for(;H<F.length;)R.xSd(F.tg(H)),H++;for(;K<y.length;)R.BSd(y.tg(K)),K++;R.isEmpty||E.add(R);return E},z=(v,F,y)=>{const G=new m.a,C=F.IS(),H=y.IS();v.forEach(K=>{C.contains(K)&&H.contains(K)&&G.add(K);return!0});return G},x=(v,F,y)=>{v=v||new m.a;F=F||new m.a;y=y||new m.a;const G=new m.a,C=new f.a(0),H=new a.a;for(var K=0;K<v.length;K++){var R=v.tg(K);C.W(R,K)}for(v=K=0;K<F.length&&v<y.length;){R=F.tg(K);
let E=y.tg(v),L=C.e3(R,-1),O=C.e3(E,-1);-1===L?(u(H,G,R),K++):-1===O?(u(H,G,E),v++):L===O?(u(H,G,R),K++,v++):L<O?K++:v++}for(;K<F.length;K++)R=F.tg(K),-1===C.e3(R,-1)&&u(H,G,R);for(;v<y.length;v++)F=y.tg(v),-1===C.e3(F,-1)&&u(H,G,F);return G},u=(v,F,y)=>{v.contains(y)||(F.add(y),v.add(y))}},1535:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1457);class m extends d.a{constructor(){super()}get mfa(){return"RdOpLcs"}}Object(I.a)(m,"ReducedOpsLcsFailureDetail",d.a,[])},1542:function(I,J,
d){I=d(0);class m{constructor(){this.tokenFilter=this.T7c=null;this.J8f=this.score=this.Zcd=0}Yjg(G,C,H){this.score=G.K(C);++C;this.T7c=G.K(C)?H.Csa(G.K(C)):null;++C;this.tokenFilter=G.K(C)?H.Csa(G.K(C)):null;++C;this.Zcd=G.K(C);++C;this.J8f=G.K(C);++C;return C}}Object(I.a)(m,"TokenStringGeneratorInit",null,[]);class f{constructor(G,C,H,K,R){this.Zpb=G;this.count=C;this.C3d=H;this.qR=K;this.depth=R}}Object(I.a)(f,"ErrorTolerantTrieMatch",null,[]);var a=d(1628),l=d(1748);class w{constructor(G=null,
C=0,H=0,K=0){this.PRk=G||new l.a;this.GAa=C;this.qR=H;this.depth=K}get l9(){return this.PRk}getKey(){return this.l9.az.toString()+":"+this.GAa.toString()}}Object(I.a)(w,"TrieBookmark",null,[]);class z{constructor(G,C){this.pYa=G;this.N7f=C}nJn(G){if(null==G)throw Error.argumentNull("prefix");let C={};var H=C[""]=new w;this.Jae(H,C);for(H=0;H<G.length;++H){const K=G.charCodeAt(H),R={};for(let E in C)this.S4k(K,C[E],R);C=R}return this.$pp(C)}Jae(G,C){if(!(G.qR>=this.N7f)&&(G=new w(a.a.Fpf(G.l9),G.GAa,
G.qR+1,G.depth),G.l9.LH&a.a.Agb&&(G.GAa+=1),this.pYa.m2b(G.l9))){G.depth+=1;let H=!0;for(;H;)z.mFe(G,C),this.Jae(G,C),G.GAa+=this.pYa.Vjc(G.l9,!0)+(G.l9.LH&a.a.Agb?1:0),H=this.pYa.osd(G.l9)}}S4k(G,C,H){C.qR+1<=this.N7f&&(C.qR+=1,z.mFe(C,H),--C.qR);C.l9.LH&a.a.Agb&&(C.GAa+=1);if(this.pYa.m2b(C.l9)){C.depth+=1;let K=!0;for(;K;)C.l9.w3b===G?(z.mFe(C,H),this.Jae(C,H)):C.qR+1<=this.N7f&&(C.qR+=1,z.mFe(C,H),this.Jae(C,H),--C.qR),C.GAa+=this.pYa.Vjc(C.l9,!0)+(C.l9.LH&a.a.Agb?1:0),K=this.pYa.osd(C.l9)}}$pp(G){const C=
[];for(var H in G){const K=G[H];if(!K.l9.az)continue;const R=!!(K.l9.LH&a.a.Agb),E=this.pYa.Vjc(K.l9,!1)+(R?1:0);Array.add(C,new f(K.GAa,E,R,K.qR,K.depth))}C.sort((K,R)=>{let E=K.Zpb-R.Zpb;return E||(E=-(K.count-R.count))?E:E=K.depth-R.depth});if(2>C.length)return C;G=[];for(H=0;H<C.length;)H+=z.e3j(H,C,G);return G}static mFe(G,C){const H=G.getKey();H in C?(C=C[H],C.qR=Math.min(C.qR,G.qR)):C[H]=new w(a.a.Fpf(G.l9),G.GAa,G.qR,G.depth)}static e3j(G,C,H){const K=C[G];let R=K.Zpb;const E=R+K.count;let L=
1,O=K.C3d;for(;G+L<C.length&&C[G+L].Zpb<E;){const V=C[G+L];V.Zpb>R&&(Array.add(H,new f(R,V.Zpb-R,O,K.qR,K.depth)),O=!1);L+=z.e3j(G+L,C,H);R=V.Zpb+V.count}R<E&&Array.add(H,new f(R,E-R,O,K.qR,K.depth));return L}}Object(I.a)(z,"ErrorTolerantTrieLookupEngine",null,[1895]);class x extends m{constructor(G,C,H){super();this.LQi=this.Ipj=!1;this.vli=null;if(G){var K=0;try{K=this.Yjg(G,K,C);this.Ipj=1===G.K(K);++K;this.LQi=1===G.K(K);++K;const R=G.K(K);this.vli=this.fbo(H,R)}catch(R){throw Error.argument("initData");
}}}fbo(G,C){return new z(G,C)}}Object(I.a)(x,"FuzzyMatchTokenStringGeneratorInit",m,[]);class u extends m{constructor(G,C){super();this.query=this.name=null;if(G){this.annotations=C.annotations;var H=0;try{H=this.Yjg(G,H,C),this.name=C.rD(G.K(H)),++H,this.query=C.qN(G.K(H))}catch(K){throw Error.argument("initData");}}}}Object(I.a)(u,"QueryTokenStringGeneratorInit",m,[]);class v extends m{constructor(G,C){super();if(G)try{this.Yjg(G,0,C)}catch(H){throw Error.argument("initData");}}}Object(I.a)(v,"SurfaceStringTokenStringGeneratorInit",
m,[]);var F=d(1434);d.d(J,"a",function(){return y});class y{constructor(G){this.D7f=G}get T7c(){return this.D7f.T7c}get tokenFilter(){return this.D7f.tokenFilter}get Zcd(){return this.D7f.Zcd}static create(G,C,H){const {SurfaceStringTokenStringGenerator:K}=d(1923),{QueryTokenStringGenerator:R}=d(1924),{FuzzyMatchTokenStringGenerator:E}=d(1925);let L=0;try{if(G.K(L)!==y.wLb)throw Error.argument("initData","Input does not represent a token string generator");++L;const O=G.K(L);++L;const V=new F.a;V.jqb(G,
L,G.count-L);switch(O){case K.NUc:return new K(new v(V,C));case R.NUc:return new R(new u(V,C));case E.NUc:return new E(new x(V,C,H));default:throw Error.argument("initData");}}catch(O){throw Error.argument("initData");}}static ZOh(G,C,H,K,R,E){G=G.bop.getId(C,null);if(0>G)return++E,E;y.$Oh(G,H,K,R);return E}static $Oh(G,C,H,K){Array.add(K.WFg,G);Array.add(K.mZj,C);++K.kAc[H]}}y.wLb=1099767983;Object(I.a)(y,"TokenStringGenerator",null,[1889])},1595:function(I,J,d){d.d(J,"a",function(){return a});I=
d(0);var m=d(221);J=d(1530);var f=d(1474);class a extends J.a{constructor(l,w,z){super(l,w,z)}Adp(l){let w;w=null;if(!this.text||!this.dfb||0>=l||l>=this.length)return{returnValue:!1,EXj:w};w=new m.a;const z=this.clone();z.Pod(f.a.tzb(this.text,0,l));const x=this.clone();x.Pod(f.a.tzb(this.text,l,this.length-l));w.add(z);w.add(x);return{returnValue:!0,EXj:w}}R7(){return!0}get length(){return this.text.length}}Object(I.a)(a,"ATextMergeBlock",J.a,[])},1596:function(I,J,d){d.d(J,"a",function(){return a});
I=d(0);var m=d(58),f=d(177);class a{sif(l,w){return l+("[Block: "+w+"] ")}static mpm(l,w,z,x,u,v,F){const {ParagraphMergeBlockCreator:y}=d(2013),{TableMergeBlockCreator:G}=d(2019);if(w.wc===m.a.paragraphNode)return new y(l,w,z,u,v,x(7),F,x(109));if(w.wc===m.a.Ep)return new G(w,z);f.a.instance.Ua(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",w.wc);return null}}Object(I.a)(a,"MergeBlockCreator",null,[])},1597:function(I,J,d){d.d(J,"a",function(){return w});I=d(0);var m=
d(58),f=d(5),a=d(46);J=d(1595);var l=d(1479);class w extends J.a{constructor(z,x,u,v,F,y,G,C,H,K,R,E,L,O){super(x,u,v);this.Qg=F;this.runId=y;this.vvb=C;this.fxk=G;this.oKe=z;this.DXa=H;this.Ifa=K;this.SKa=R;this.EZa=E;this.iA=L;this.gv=O}get fTc(){return this.oKe}get DL(){return this.fxk}get kPb(){return this.fTc(this.DL)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Qg,this.runId,this.vvb,
this.Bk,this.DL.toString(),this.gv?this.gv.toString():"NULL")}gC(z,x,u,v=!1){if(!super.gC(z,x,u,v))return!1;if(v)return!0;if(!this.iA.gC(z.iA)||this.gv&&!this.gv.equals(z.gv))return!1;if(this.DL.equals(z.DL)||this.DL.equals(a.a.nil)||z.DL.equals(a.a.nil))return!0;z=new l.a(this.kPb,z.kPb);x=x.w$h(this.kPb,u);return z.c9c(x.ore)?!1:!0}get Egn(){return this.R7()&&"\ufffc"===this.text&&this.kPb?this.kPb.hasProperty(f.a.ht)||this.kPb.wc!==m.a.zwb?!0:!1:!1}}Object(I.a)(w,"AUserRunMergeBlock",J.a,[])},
1598:function(I,J,d){d.d(J,"a",function(){return f});var m=d(177);const f=(a,l,w=4)=>{a?m.a.instance.foa(4273285,w,4,l,a.hAc()):m.a.instance.Ua(4293845,w,1,l,"{0}: Node was null.",l)}},1599:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1395);class m extends d.a{constructor(f,a,l,w,z=null){super(f,a,z,null,l);this.id=w}}Object(I.a)(m,"TryQueryResultBinding",d.a,[])},1600:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f){this.Bb=f}get icb(){return this.Bb.icb}get Qhp(){return 4!==
this.Bb.style}get Shp(){return!0}get trie(){return this.Bb.trie}getId(f,a){if(!this.Qhp)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Bb.style){case 0:return this.Mwm(f,a);default:throw Error.notImplemented();}}rD(f){if(!this.Shp)throw Error.invalidOperation("String lookup not supported on this string table");if(0>f||f>=this.icb)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Bb.style){case 0:return this.kNm(f);case 4:return this.jNm(f);
default:throw Error.notImplemented();}}Mwm(f,a){f=this.Bb.trie.Waj(f,0,f.length,a);if(!f.succeeded)return-1;if(0>f.AAc||f.AAc>=this.Bb.icb)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Bb.psd?this.Bb.Fjd.hA(this.Bb.psd+4*f.AAc,4):f.AAc}kNm(f){if(this.Bb.psd){let a=0;for(;a<this.Bb.icb&&this.Bb.Fjd.hA(this.Bb.psd+4*a,4)!==f;++a);if(a>=this.Bb.icb)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Bb.trie.HHi(a)}return this.Bb.trie.HHi(f)}jNm(f){const a=
this.Bb.Fjd.hA(this.Bb.jZj+4*f,4);f=this.Bb.Fjd.hA(this.Bb.kZj+4*f,4);if(0>f||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const l=Array(a);for(let w=0;w<a;++w)l[w]=({N4m:f}=this.sqo(f)).returnValue;return String.fromCharCode.apply(null,l)}sqo(f){let a=0;for(let l=0;3>l;++l){const w=this.Bb.Fjd.K(this.Bb.Z0h+f)^182;++f;a|=(w&127)<<7*l;if(!(w&128))break}return{returnValue:a,N4m:f}}}Object(I.a)(m,"StringTable",null,[1871])},1601:function(I,J,d){d.d(J,"a",function(){return f});
I=d(0);var m=d(1628);class f{constructor(a){this.trie=null;this.Z0h=this.jZj=this.kZj=this.psd=0;if(a){this.Fjd=a;var l=0;if(a.hA(l,4)!==f.wLb)throw Error.argument("bytes","Input does not represent a string table");l+=4;this.icb=a.hA(l,4);l+=4;this.style=a.hA(l,4);l+=4;switch(this.style){case 0:const w=1===a.hA(l,4);l+=4;w||(this.psd=l,l+=4*this.icb);a.hA(l,4);this.trie=this.Jbo(a,l+4);break;case 4:this.kZj=l;this.jZj=l+=4*this.icb;l+=4*this.icb;a.hA(l,4);this.Z0h=l+4;break;default:throw Error.argument("bytes");
}}}Jbo(a,l){return new m.a(a,l)}}f.wLb=1025118440;Object(I.a)(f,"StringTableInit",null,[])},1602:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);var m;(function(f){f[f.aek=0]="Answer";f[f.Definition=1]="Definition";f[f.Entity=2]="Entity";f[f.Mlk=3]="WolframAnswer";f[f.iek=4]="Assistance";f[f.Command=5]="Command";f[f.Document=6]="Document";f[f.Xkk=7]="TryQuery";f[f.MHe=8]="FindInDocument";f[f.dQp=9]="HelpAction";f[f.bhk=10]="Insights";f[f.People=11]="People";f[f.Image=12]="Image";f[f.MPp=13]=
"FirstRunResult";f[f.mRp=14]="NoCommandsFoundResult";f[f.Hkk=15]="TestResult";f[f.SNp=16]="AppsForOffice_Installed";f[f.UNp=17]="AppsForOffice_Recommandation";f[f.TNp=18]="AppsForOffice_Query";f[f.rRp=19]="Notes_Onenote";f[f.sRp=20]="Notes_Samsung";f[f.tRp=21]="Notes_Sticky";f[f.Hhk=22]="Learning";f[f.Feedback=23]="Feedback";f[f.Template=24]="Template";f[f.Rdk=25]="ActionAI";f[f.Sdk=26]="ActionAICommand";f[f.Zdk=27]="Addin";f[f.Lik=28]="OfficeScript";f[f.$dk=29]="AddinStoreEntry";f[f.XPp=30]="GenerateSlides";
f[f.ckk=31]="SummarizeDeck";f[f.Unknown=32]="Unknown"})(m||(m={}));Object(I.b)("ResultType",m)},1625:function(I,J,d){I=d(0);var m=d(5),f=d(605),a=d(177),l=d(221),w=d(46),z=d(357),x=d(82),u;(function(Sa){Sa[Sa.none=0]="none";Sa[Sa.zdd=1]="mergeConflict";Sa[Sa.FYp=2]="containerBaseIdValidationFailure";Sa[Sa.k2p=3]="failedToApplyHints";Sa[Sa.eGe=4]="validateUpdateHintsAreComplete";Sa[Sa.other=5]="other"})(u||(u={}));Object(I.b)("ParagraphMergeUsingHintsFailureReason",u);var v=d(1036),F=d(240),y=d(722);
const G=Sa=>{const cb=new l.a;Sa.forEach(pb=>{cb.add(pb);return!0});return cb};var C=d(1531),H=d(1534),K=d(1535);const R=(Sa,cb)=>{if(Sa.length!==cb.length)return!1;for(let pb=0;pb<Sa.length;pb++)Sa.K(pb).Gn=cb.K(pb),cb.K(pb).Gn=Sa.K(pb);return!0},E=(Sa,cb,pb)=>{let vb,xb,Bb;vb=0;xb=!1;Bb=0;var jc;if(!({idx:jc}=W(Sa,cb)).returnValue)return a.a.instance.Ua(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",cb,Sa.Vr()),{returnValue:!1,t5c:vb,
svb:xb,ced:Bb};if(!pb&&2===Sa.K(jc).type)return{returnValue:!0,t5c:jc,svb:xb,ced:Bb};if(!Sa.K(jc).R7())return a.a.instance.Ua(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",jc,pb,Sa.Vr()),{returnValue:!1,t5c:vb,svb:xb,ced:Bb};let xc=!1,Qc=0;for(;jc<Sa.length&&Sa.K(jc).Bk.equals(cb);jc++){if(pb===Qc){xc=!0;break}if(pb>Qc&&pb<Qc+Sa.K(jc).length){xb=xc=!0;Bb=pb-Qc;break}Qc+=Sa.K(jc).length}xc||pb!==Qc||(xc=!0);xc&&(vb=jc);return{returnValue:xc,
t5c:vb,svb:xb,ced:Bb}},L=(Sa,cb,pb)=>{let vb,xb,Bb;Bb=xb=0;vb=!1;let jc=0,xc=!1;for(;xb<Sa.length;xb++){if(cb===jc){xc=!0;break}if(cb>jc&&cb<jc+Sa.K(xb).length){vb=xc=!0;Bb=cb-jc;break}jc+=Sa.K(xb).length}xc||cb!==jc||(xc=!0);xc||(Sa=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Sa.length,jc,cb),a.a.instance.Ua(573178201,1,2,Sa),pb.Ti(Object.assign(new K.a,{eventId:"8k6fz",info:Sa})));return{returnValue:xc,svb:vb,lWh:xb,kWh:Bb}},O=(Sa,cb,pb)=>{let vb;
if(Sa.K(cb).R7()&&({EXj:vb}=Sa.K(cb).Adp(pb)).returnValue)return Sa.wD(cb+1,vb),Sa.oI(cb),!0;a.a.instance.Ua(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",cb,pb,Sa.Vr());return!1},V=(Sa,cb,pb)=>{let vb,xb;if(!({t5c:pb,svb:xb,ced:vb}=E(Sa,cb,pb)).returnValue)return{returnValue:!1,index:0};if(!xb)return{returnValue:!0,index:pb};if(O(Sa,pb,vb))return{returnValue:!0,index:pb+1};a.a.instance.Ua(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",
cb,vb,Sa.Vr());return{returnValue:!1,index:0}},Z=(Sa,cb,pb)=>{let vb;if(!({svb:vb,lWh:cb,kWh:pb}=L(Sa,cb,pb)).returnValue)return{returnValue:!1,index:0};if(!vb)return{returnValue:!0,index:cb};if(O(Sa,cb,pb))return{returnValue:!0,index:cb+1};a.a.instance.Ua(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",pb,Sa.Vr());return{returnValue:!1,index:0}},W=(Sa,cb)=>{let pb;pb=0;for(let vb=0;vb<Sa.length;vb++)if(Sa.K(vb).Bk.equals(cb))return pb=vb,{returnValue:!0,
idx:pb};a.a.instance.Ua(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",cb,Sa.Vr());return{returnValue:!1,idx:pb}},P=(Sa,cb)=>{let pb;pb=-1;for(let vb=cb;vb<Sa.length;vb++)if(2===Sa.K(vb).type)return pb=vb,{returnValue:!0,Zka:pb};a.a.instance.Ua(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",cb,Sa.Vr());return{returnValue:!1,Zka:pb}},S=(Sa,cb,pb)=>{let vb;vb=-1;for(let xb=pb;xb<Sa.length;xb++)if(2===
Sa.K(xb).type&&Sa.K(xb).Bk.equals(cb))return vb=xb,{returnValue:!0,Zka:vb};a.a.instance.Ua(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",cb,pb,Sa.Vr());return{returnValue:!1,Zka:vb}},aa=(Sa,cb)=>{let pb;pb=0;var vb;if(!({idx:vb}=W(Sa,cb)).returnValue)return a.a.instance.Ua(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",cb,Sa),{returnValue:!1,length:pb};for(;vb<Sa.length;vb++)if(6!==Sa.K(vb).type){if(2===Sa.K(vb).type)return{returnValue:!0,
length:pb};a.a.instance.shipAssertTag(17342617,1,Sa.K(vb).R7(),"We found something other than text with type "+Sa.K(vb).type);a.a.instance.shipAssertTag(17877021,1,Sa.K(vb).Bk.equals(cb),"Unexpected GraphNodeId {0} for ParaId {1}",Sa.K(vb).Bk,cb);pb+=Sa.K(vb).length}a.a.instance.Ua(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",cb,Sa);return{returnValue:!1,length:pb}},Y=Sa=>{const cb=new l.a;for(let pb=0;pb<Sa.length;pb++)cb.add(Sa.K(pb).clone());return cb};var X=d(1533),ca=d(1474);
class fa{constructor(Sa,cb,pb=null,vb=null){this.Bk=Sa;this.type=cb;this.text=pb;this.Zc=vb}isEqual(Sa){return Sa.Bk.equals(this.Bk)&&this.type===Sa.type&&this.Zc===Sa.Zc&&ca.a.cUh(this.text,Sa.text)}toString(){let Sa=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Bk,this.Zc,this.type);this.text&&(Sa+=String.format(" [TextLength: {0}]",this.text.length));return Sa}}Object(I.a)(fa,"MergeBlockValidationState",null,[]);var ja=d(251),ra=d(872),ya=d(873),Ha=d(475),Wa=d(476),
Ma=d(871),ua=d(870),Ka=d(1457),za=d(1736),Fa;(function(Sa){Sa[Sa.Sj=1]="base";Sa[Sa.x2p=2]="favoredUpdate";Sa[Sa.yrq=4]="unfavoredUpdate";Sa[Sa.min=1]="min";Sa[Sa.max=7]="max"})(Fa||(Fa={}));Object(I.b)("MergeBlockSource",Fa);class ea{constructor(Sa,cb,pb,vb){this.Qg=Sa;this.cp=cb;this.qTd=pb;this.Btd=vb}}Object(I.a)(ea,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var la=d(1530);class Na extends la.a{constructor(Sa,cb){super(6,Sa,cb);this.Zc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.Bk)}Gjc(){return"Selection"}clone(){return new Na(this.source,this.Bk)}gC(){return!1}get length(){return 0}}Object(I.a)(Na,"SelectionMergeBlock",la.a,[]);var Aa;(function(Sa){Sa[Sa.success=0]="success";Sa[Sa.Ymq=1]="selfSplit";Sa[Sa.Tfq=2]="noSecondaryBlockToSplit";Sa[Sa.wrq=3]="unexpected"})(Aa||(Aa={}));Object(I.b)("SplitTwinListResult",Aa);var wa=d(1595);class va extends wa.a{constructor(Sa,cb,pb,vb){super(5,Sa,cb);this._text=null;this.Pod(pb);this.sSk=vb}get text(){return this._text}Pod(Sa){this._text=
Sa}get htd(){return this.sSk}clone(){return new va(this.source,this.Bk,this.text,this.htd)}get dfb(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(I.a)(va,"UpdateHintTextMergeBlock",wa.a,[]);class Pa{constructor(Sa,cb,pb,vb){this.Q5=!1;this.Okb=new z.a;this.fe=Sa;this.xJh=vb;this.sah=pb;this._base=cb;this.BPe=Y(cb);if(!R(this.Sj,this.Ze))throw a.a.instance.Ua(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Sa.logger.Ti(Object.assign(new Ka.a,
{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get Sj(){return this._base}get Ze(){return this.BPe}get zdd(){return this.Q5}hjf(Sa,cb){switch(Sa.type){case 1:return this.e9k(Sa,cb);case 2:return this.Gif(Sa,cb);case 3:return this.f$k(Sa,cb);case 4:return this.z9k(Sa);case 5:return this.v8k(Sa,cb);case 6:return this.Eif(Sa);default:return!1}}gjf(Sa,cb){switch(Sa.type){case 1:return this.Kif(Sa,cb);case 2:return this.Fif(Sa,cb);case 3:return this.e$k(Sa,cb);case 4:return this.y9k(Sa);
case 5:return this.u8k(Sa,cb);case 6:return this.Dif(Sa);default:return{returnValue:!1,Av:null}}}e9k(Sa,cb){let pb;const vb=({Qla:pb}=this.wOa(Sa.Qg,cb,!1,Sa.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==vb&&1!==vb)return 3!==vb&&(a.a.instance.Ua(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",Fa[cb],Aa[vb]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.Q5=
!1;cb=new va(cb,Sa.Qg,Sa.text,Sa.id);this.TVf(Sa,pb,cb);return!0}Gif(Sa,cb){let pb,vb=({Qla:pb}=this.wOa(Sa.Qg,cb,!1,Sa.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==vb&&1!==vb)return 3!==vb&&(a.a.instance.Ua(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",Fa[cb],Aa[vb]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let xb;({Qla:xb,returnValue:vb}=
this.wOa(Sa.Qg,cb,!1,Sa.cp+Sa.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==vb&&1!==vb)return 3!==vb&&(a.a.instance.Ua(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",Fa[cb],Aa[vb]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.Q5=!1;this.ywf(Sa,pb,xb);return!0}f$k(Sa,cb){let pb;const vb=({iUf:pb}=this.jAi(Sa,cb,!1)).returnValue;if(0!==vb&&1!==vb)return 3!==
vb&&(a.a.instance.Ua(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",Fa[cb],Aa[vb]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.Q5=!1;cb=new C.a(cb,Sa.dv,Sa.Kya);this.TVf(Sa,pb,cb);return!0}z9k(Sa){let cb;if(!({Pae:cb}=this.kAi(Sa,this.Ze,"Derived")).returnValue)return!1;this.ywf(Sa,cb,cb+1);return!0}v8k(Sa,cb){let pb;if(!({$8f:cb,hUf:pb}=this.fCi(Sa,!1,cb)).returnValue)return!1;
this.TVf(Sa,pb,cb);return!0}Eif(Sa){let cb;if(!({Oae:cb}=this.aAi(Sa,this.Ze,"Derived")).returnValue)return!1;this.ywf(Sa,cb,cb+1);return!0}kTh(Sa,cb,pb){const vb=({Qla:cb}=this.wOa(Sa,pb,!1,cb,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==vb&&1!==vb)return 3!==vb&&(a.a.instance.Ua(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",Fa[pb],Aa[vb]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",
eventId:"9l2vz"}))),!1;this.Q5=!1;Sa=new Na(pb,Sa);this.Ze.insert(cb,Sa);return!0}Kif(Sa,cb){var pb=null;if(Pa.TXi(Sa.text.length))return{returnValue:!1,Av:pb};let vb,xb,Bb;var jc=({Qla:vb,FBa:xb,xka:Bb}=this.wOa(Sa.Qg,cb,!0,Sa.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==jc&&2!==jc)return 3!==jc&&(a.a.instance.Ua(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",Fa[cb],Aa[jc]),this.fe.logger.Ti(Object.assign(new za.a,
{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,Av:pb};this.Q5=!1;({Zka:jc}=P(this.Ze,xb));jc=this.Ze.K(jc).Bk;pb=new va(cb,Sa.Qg,Sa.text,Sa.id);cb=new va(cb,jc,Sa.text,Sa.id);pb.Gn=cb;cb.Gn=pb;this.Sj.insert(vb,pb);this.Ze.insert(xb,cb);pb=new l.a;pb.add(new Wa.a(jc,Bb,Sa.text,Sa.id,Sa.Qv));return{returnValue:!0,Av:pb}}Fif(Sa,cb){let pb;pb=null;if(Pa.TXi(Sa.text.length))return{returnValue:!1,Av:pb};let vb;var xb,Bb=({Qla:vb,FBa:jc,xka:xb}=this.wOa(Sa.Qg,cb,!0,Sa.cp,!1,
"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Bb){if(2!==Bb)return 3!==Bb&&(a.a.instance.Ua(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",Fa[cb],Aa[Bb]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,Av:pb};var jc=0;for({idx:xb}=W(this.Sj,Sa.Qg);xb<this.Sj.length&&jc<Sa.cp;xb++)jc+=this.Sj.K(xb).length;jc-=this.Sj.K(xb-1).length;
({FBa:jc,xka:xb,returnValue:Bb}=this.wOa(Sa.Qg,cb,!0,jc,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Bb)return 3!==Bb&&(a.a.instance.Ua(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",Fa[cb],Aa[Bb]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,Av:pb};this.Q5=!1}var xc,Qc;({Qla:xc,FBa:Qc,xka:fd,returnValue:Bb}=this.wOa(Sa.Qg,
cb,!0,Sa.cp+Sa.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Bb){if(2!==Bb)return 3!==Bb&&(a.a.instance.Ua(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",Fa[cb],Aa[Bb]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,Av:pb};var fd=0;for({idx:Qc}=W(this.Sj,Sa.Qg);Qc<this.Sj.length&&fd<Sa.cp+Sa.text.length;Qc++)fd+=this.Sj.K(Qc).length;
({FBa:Qc,xka:fd,returnValue:Bb}=this.wOa(Sa.Qg,cb,!0,fd,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Bb)return 3!==Bb&&(a.a.instance.Ua(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",Fa[cb],Aa[Bb]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,Av:pb};this.Q5=!1}cb="";pb=new l.a;for(--Qc;Qc>=jc;Qc--)if(6!==this.Ze.K(Qc).type)if(this.Ze.K(Qc).Gn)cb=
this.Ze.K(Qc).text+cb,this.Ze.oI(Qc);else{if(5===this.Ze.K(Qc).type)Bb=fd-cb.length;else if(2===this.Ze.K(Qc).type){if(Bb=0,!({length:fd}=aa(this.Ze,this.Ze.K(Qc).Bk)).returnValue)return a.a.instance.Ua(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,Av:pb}}else return a.a.instance.Ua(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),
this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,Av:pb};if(!({Zka:Ac}=P(this.Ze,Qc+1)).returnValue)return a.a.instance.Ua(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,Av:pb};var Ac=this.Ze.K(Ac).Bk;pb.add(new Ha.a(Ac,Bb,cb));cb=""}for(--xc;xc>=vb;xc--)this.Sj.oI(xc);if(!({Zka:Ac}=P(this.Ze,
jc)).returnValue)return a.a.instance.Ua(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,Av:pb};Ac=this.Ze.K(Ac).Bk;cb&&cb.length&&pb.add(new Ha.a(Ac,xb,cb,Sa.id,Sa.Qv));return{returnValue:!0,Av:pb}}e$k(Sa,cb){var pb=null;let vb,xb,Bb;var jc=({iUf:vb,ZPi:xb,xka:Bb}=this.jAi(Sa,cb,!0)).returnValue;if(0!==jc)return 3!==jc&&(a.a.instance.Ua(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",
Fa[cb],Aa[jc]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,Av:pb};var xc;if(!({Zka:xc}=P(this.Ze,xb)).returnValue)return a.a.instance.Ua(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,Av:pb};jc=this.Ze.K(xc).Bk;const Qc=this.Ze.K(xc).Zc;let fd,Ac,Nb;({dv:xc,caa:fd,Kya:Ac,xea:Nb}=this.qCm(Sa,xc));this.T0h(this.Ze,xc,fd,Nb,xb);pb=new C.a(cb,Sa.dv,Sa.Kya);cb=
new C.a(cb,xc,Ac);pb.Gn=cb;cb.Gn=pb;this.Sj.insert(vb,pb);this.Ze.insert(xb,cb);pb=new l.a;pb.add(new ua.a(jc,Qc,Bb,xc,Ac,fd,Nb,Sa.id,Sa.Qv));return{returnValue:!0,Av:pb}}y9k(Sa){let cb;cb=null;let pb,vb;var xb;if(!({Pae:pb}=this.kAi(Sa,this.Sj,"Base")).returnValue)return{returnValue:!1,Av:cb};if(!this.Sj.K(pb).Gn||!({Zka:vb}=S(this.Ze,this.Sj.K(pb).Gn.Bk,0)).returnValue)return a.a.instance.Ua(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),
this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.Q5=!0,{returnValue:!1,Av:cb};if(!({Zka:xb}=P(this.Ze,vb+1)).returnValue)return a.a.instance.Ua(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.Q5=!0,{returnValue:!1,Av:cb};let Bb,jc,xc,Qc,fd,Ac;({Sbb:xb,Tbb:xc,bcg:Bb,
SSn:Qc,CSn:jc,DSn:fd}=this.Kpm(Sa,vb,xb));if(!({length:Ac}=aa(this.Ze,xb)).returnValue)return{returnValue:!1,Av:cb};this.S0h(this.Ze,xb,xc,vb);this.Ze.oI(vb);this.Sj.oI(pb);cb=new l.a;cb.add(new Ma.a(Bb,Qc,Ac,jc,fd,xb,xc,Sa.id,Sa.Qv));return{returnValue:!0,Av:cb}}u8k(Sa,cb){var pb=null;let vb,xb,Bb;if(!({$8f:Bb,hUf:vb}=this.fCi(Sa,!0,cb)).returnValue)return{returnValue:!1,Av:pb};if(!({jsb:xb}=this.I3c(this.Sj,this.Ze,vb,!0)).returnValue)return a.a.instance.Ua(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),
{returnValue:!1,Av:pb};if(0<xb&&2!==this.Ze.K(xb-1).type)return a.a.instance.Ua(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.Q5=!0,{returnValue:!1,Av:pb};let jc;if(!({dv:jc}=this.Ksi(xb)).returnValue)return{returnValue:!1,Av:pb};cb=new C.a(cb,Sa.Qg,Sa.Zc);pb=Bb;pb.Gn=cb;cb.Gn=pb;this.Sj.insert(vb,Bb);this.Ze.insert(xb,cb);pb=new l.a;
pb.add(new ra.a(Sa.Qg,Sa.Zc,jc,Sa.id,Sa.Qv));return{returnValue:!0,Av:pb}}Dif(Sa){let cb;cb=null;let pb;var vb;if(!({Oae:vb}=this.aAi(Sa,this.Sj,"Base")).returnValue)return{returnValue:!1,Av:cb};if(!this.Sj.K(vb).Gn||!this.Sj.K(vb).Gn.Bk.equals(Sa.Qg))return a.a.instance.Ua(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),
this.Q5=!0,{returnValue:!1,Av:cb};if(!({jsb:pb}=this.I3c(this.Sj,this.Ze,vb,!0)).returnValue)return a.a.instance.Ua(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,Av:cb};if(0<pb&&2!==this.Ze.K(pb).type)return a.a.instance.Ua(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.Q5=!0,{returnValue:!1,
Av:cb};const xb=this.Ze.K(pb).Bk,Bb=this.Ze.K(pb).Zc;this.Ze.oI(pb);this.Sj.oI(vb);({dv:vb}=this.Ksi(pb));0<pb&&6===this.Ze.K(pb-1).type&&this.Ifo(pb-1,vb);cb=new l.a;cb.add(new ya.a(xb,Bb,vb,Sa.id,Sa.Qv));return{returnValue:!0,Av:cb}}jTh(Sa,cb,pb){let vb;var xb=({Qla:cb,FBa:vb}=this.wOa(Sa,pb,!0,cb,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==xb)return 3!==xb&&(a.a.instance.Ua(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",
Fa[pb],Aa[xb]),this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({Zka:xb}=P(this.Ze,vb));xb=this.Ze.K(xb).Bk;Sa=new Na(pb,Sa);pb=new Na(pb,xb);Sa.Gn=pb;pb.Gn=Sa;this.Sj.insert(cb,Sa);this.Ze.insert(vb,pb);return!0}Kpm(Sa,cb,pb){let vb,xb,Bb;vb=Sa.Sbb.equals(Sa.Qg)?this.Ze.K(cb).Bk:this.Ze.K(pb).Bk;Sa=Sa.Tbb===Sa.Zc?this.Ze.K(cb).Zc:this.Ze.K(pb).Zc;xb=this.Ze.K(cb).Bk;cb=this.Ze.K(cb).Zc;Bb=this.Ze.K(pb).Bk;pb=this.Ze.K(pb).Zc;return{Sbb:vb,Tbb:Sa,
bcg:xb,SSn:cb,CSn:Bb,DSn:pb}}qCm(Sa,cb){let pb;var vb=Sa.Qg.equals(Sa.dv)?Sa.caa:Sa.dv;const xb=Sa.Zc===Sa.Kya?Sa.xea:Sa.Kya;Sa.Qg.equals(Sa.dv)?pb=this.Ze.K(cb).Bk:(pb=vb,vb=this.Ze.K(cb).Bk);Sa.Zc===Sa.Kya?(Sa=this.Ze.K(cb).Zc,cb=xb):(Sa=xb,cb=this.Ze.K(cb).Zc);return{dv:pb,caa:vb,Kya:Sa,xea:cb}}U0h(Sa,cb,pb,vb){for(;vb<Sa.length;vb++){if(!Sa.K(vb).R7()&&6!==Sa.K(vb).type&&2!==Sa.K(vb).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Sa.K(vb).type);break}Sa.K(vb).Bk=cb;
if(2===Sa.K(vb).type){Sa.K(vb).Zc=pb;break}}}T0h(Sa,cb,pb,vb,xb){this.U0h(Sa,pb,vb,xb);Pa.V0h(Sa,cb,xb)}S0h(Sa,cb,pb,vb){this.U0h(Sa,cb,pb,vb+1);Pa.V0h(Sa,cb,vb)}kAi(Sa,cb,pb){let vb,xb=-1;if(!({Zka:vb}=S(cb,Sa.Qg,0)).returnValue)return a.a.instance.Ua(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+pb+"for GraphNodeId "+Sa.Qg),{returnValue:!1,Pae:vb};if(!({Zka:xb}=P(cb,vb+1)).returnValue||!cb.K(xb).Bk.equals(Sa.caa))return a.a.instance.Ua(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+
vb+1+" in "+pb+" of length "+cb.length),{returnValue:!1,Pae:vb};this.S0h(cb,Sa.Sbb,Sa.Tbb,vb);return{returnValue:!0,Pae:vb}}jAi(Sa,cb,pb){let vb;const xb=pb?this.Sj:this.Ze,Bb=pb?"Base":"Derived",jc=({Qla:cb,FBa:pb,xka:vb}=this.wOa(Sa.Qg,cb,pb,Sa.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===jc||2===jc)return a.a.instance.Ua(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Bb),{returnValue:jc,iUf:cb,ZPi:pb,xka:vb};this.T0h(xb,Sa.dv,Sa.caa,Sa.xea,cb);return{returnValue:jc,
iUf:cb,ZPi:pb,xka:vb}}aAi(Sa,cb,pb){return({idx:Sa}=W(cb,Sa.Qg)).returnValue?2!==cb.K(Sa).type?(a.a.instance.Ua(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+pb),{returnValue:!1,Oae:-1}):{returnValue:!0,Oae:Sa}:(a.a.instance.Ua(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+pb),{returnValue:!1,Oae:-1})}Ifo(Sa,cb){var pb=this.Ze.K(Sa);if(cb){let vb;({Zka:vb}=S(this.Ze,cb,0));pb=pb.clone();pb.Bk=cb;this.Ze.oI(Sa);this.Ze.insert(vb,
pb)}else this.Ze.length>Sa&&(this.Ze.K(Sa+1).R7()||2===this.Ze.K(Sa+1).type)&&(pb.Bk=this.Ze.K(Sa+1).Bk)}fCi(Sa,cb,pb){var vb=cb?this.Sj:this.Ze;cb=cb?"Base":"Derived";pb=new C.a(pb,Sa.Qg,Sa.Zc);if(Sa.dv){if(!({Zka:vb}=S(vb,Sa.dv,0)).returnValue)return a.a.instance.Ua(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Sa.dv,cb),{returnValue:!1,$8f:pb,hUf:vb};vb+=1}else vb=0;return{returnValue:!0,$8f:pb,hUf:vb}}Ksi(Sa){let cb;cb=null;let pb=Sa-1;if(-1===
pb)return{returnValue:!0,dv:cb};6===this.Ze.K(pb).type&&pb--;if(2===this.Ze.K(pb).type||4===this.Ze.K(pb).type)return cb=this.Ze.K(pb).Bk,{returnValue:!0,dv:cb};a.a.instance.Ua(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.Ze.K(Sa-1).type);return{returnValue:!1,dv:cb}}I3c(Sa,cb,pb,vb){let xb,Bb=!0;xb=-1;if(pb>Sa.length)return a.a.instance.Ua(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,jsb:xb};
if(pb<Sa.length){if(-1<pb&&pb<Sa.length&&!Sa.K(pb).Gn){Bb=!1;for(var jc=pb+1;jc<Sa.length;jc++)if(Sa.K(jc).Gn){pb=jc;Bb=!0;break}}if(!Bb)return{returnValue:!1,jsb:xb};Bb=!1;for(jc=0;Sa.K(pb)&&jc<cb.length;jc++)if(cb.K(jc).Gn===Sa.K(pb)){xb=jc;Bb=!0;break}if(!Bb)return{returnValue:!1,jsb:xb}}else xb=cb.length;if(0<xb&&vb&&!cb.K(xb-1).Gn){for(Sa=xb-1;0<=Sa&&!cb.K(Sa).Gn;Sa--);xb=Sa+1;6===cb.K(xb).type&&5!==this.fe.input.source&&xb++}return{returnValue:!0,jsb:xb}}wOa(Sa,cb,pb,vb,xb,Bb){let jc;var xc;
let Qc;var fd=this.Sj;let Ac=this.Ze,Nb=!1;pb||(fd=this.Ze,Ac=this.Sj);Qc=xc=jc=0;let ib,Rb,ic=0;if(!({t5c:vb,svb:ib,ced:Rb}=E(fd,Sa,vb)).returnValue)return a.a.instance.Ua(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,Qla:jc,FBa:xc,xka:Qc};0<=vb&&vb<fd.length&&!fd.K(vb).Gn&&ib&&!xb&&(a.a.instance.Ua(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
Bb),this.Q5=!0,ic=cb===fd.K(vb).source?1:2,Nb=!0);xb&&!fd.K(vb)&&vb--;xb&&ib&&!fd.K(vb).Gn&&(ib=!1,Rb=0);if(!pb&&!({idx:Sa}=W(Ac,Sa)).returnValue&&!ib)return{returnValue:0,Qla:vb,FBa:xc,xka:Qc};if(!({jsb:Sa}=this.I3c(fd,Ac,vb,pb&&!ib)).returnValue&&!Nb&&(cb=!1,1===this.xJh&&0<vb&&!Rb&&(vb--,{jsb:Sa,returnValue:cb}=this.I3c(fd,Ac,vb,pb&&!ib),cb&&(vb++,Sa<Ac.length-1?Sa++:cb=!1)),!cb))return a.a.instance.Ua(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.fe.logger.Ti(Object.assign(new za.a,{ek:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.Q5=!0,{returnValue:3,Qla:jc,FBa:xc,xka:Qc};if(ib&&(!O(fd,vb,Rb)||!Nb&&!O(Ac,Sa,Rb)))return a.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Qla:jc,FBa:xc,xka:Qc};jc=vb;xc=Sa;ib&&(jc=vb+1,Nb||(xc=fd.K(vb),pb=Ac.K(Sa),xc.Gn=pb,pb.Gn=xc,fd=fd.K(vb+1),xc=Ac.K(Sa+1),fd.Gn=xc,xc.Gn=
fd,xc=Sa+1));if(xc>=Ac.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+xc+" secondaryList length was "+Ac.length),{returnValue:3,Qla:jc,FBa:xc,xka:Qc};for(fd=0;fd<xc;fd++)Ac.K(fd).Bk.equals(Ac.K(xc).Bk)&&(Qc+=Ac.K(fd).length);return{returnValue:ic,Qla:jc,FBa:xc,xka:Qc}}ywf(Sa,cb,pb){this.sah.contains(Sa.id)&&this.Okb.W(Sa.id,new l.a);for(--pb;pb>=cb;pb--)this.sah.contains(Sa.id)?this.Okb.K(Sa.id).insert(this.Okb.K(Sa.id).length,
this.Ze.K(pb)):this.Ze.K(pb).Gn&&(this.Ze.K(pb).Gn.Gn=null),this.Ze.oI(pb)}TVf(Sa,cb,pb){if(this.Okb.mb(Sa.Qv)){const vb=this.Okb.K(Sa.Qv);for(let xb=0;xb<vb.length;xb++)vb.K(xb).Bk=pb.Bk,Object(ja.a)(C.a,pb)&&Object(ja.a)(C.a,vb.K(xb))&&(vb.K(xb).Zc=pb.Zc);this.Ze.wD(cb,this.Okb.K(Sa.Qv));this.Okb.remove(Sa.Qv)}else this.Ze.insert(cb,pb)}UQm(Sa){let cb,pb;pb=cb=-1;if(!Sa.Gn)return{returnValue:!1,Rgc:cb,Wwf:pb};var vb;let xb=0,Bb=!1;if(!({idx:vb}=W(this.Ze,Sa.Gn.Bk)).returnValue)return{returnValue:!1,
Rgc:cb,Wwf:pb};for(;vb<this.Ze.length;vb++){if(Sa.Gn===this.Ze.K(vb)){cb=vb;pb=xb;Bb=!0;break}xb+=this.Ze.K(vb).length}return{returnValue:Bb,Rgc:cb,Wwf:pb}}GDf(Sa){let cb;cb=new l.a;let pb=0,vb=0;for(;pb<Sa.length;){if(vb>=this.Sj.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,XAc:cb};if(Sa.K(pb).length>this.Sj.K(vb).length){if(!O(Sa,pb,this.Sj.K(vb).length))return a.a.instance.Ua(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",
pb,this.Sj.K(vb).length),{returnValue:!1,XAc:cb}}else if(Sa.K(pb).length<this.Sj.K(vb).length){var xb=!!this.Sj.K(vb).Gn,Bb=0;if(xb&&!({jsb:Bb}=this.I3c(this.Sj,this.Ze,vb,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",vb),{returnValue:!1,XAc:cb};if(!O(this.Sj,vb,Sa.K(pb).length)||xb&&!O(this.Ze,Bb,Sa.K(pb).length))return a.a.instance.Ua(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,XAc:cb};if(xb){xb=this.Sj.K(vb);var jc=this.Ze.K(Bb);xb.Gn=jc;jc.Gn=xb;xb=this.Sj.K(vb+1);Bb=this.Ze.K(Bb+1);xb.Gn=Bb;Bb.Gn=xb}}if(this.Sj.K(vb).Gn&&5!==this.Sj.K(vb).type&&this.Sj.K(vb).R7()&&(Bb=this.Sj.K(vb),xb=Sa.K(pb),!Bb.DL.equals(xb.DL)||!Bb.iA.gC(xb.iA))){let xc;if(!({Rgc:jc,Wwf:xc}=this.UQm(this.Sj.K(vb))).returnValue)return{returnValue:!1,XAc:cb};cb.add(new ea(this.Ze.K(jc).Bk,xc,Bb,xb))}pb++;vb++}return{returnValue:!0,XAc:cb}}static V0h(Sa,cb,pb){for(--pb;0<=pb;pb--){if(!Sa.K(pb).R7()&&
6!==Sa.K(pb).type){a.a.instance.shipAssertTag(17311187,1,2===Sa.K(pb).type||4===Sa.K(pb).type,"Found merge block of type "+Sa.K(pb).type);break}Sa.K(pb).Bk=cb}}static TXi(Sa){return Sa?!1:(a.a.instance.Ua(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(I.a)(Pa,"ParagraphMergeUsingHintsTwinList",null,[1119]);var Ta=d(1734),kb=d(1735),gb=d(1731),tb=d(1733),hb=d(1732);class Xa{constructor(Sa,cb,pb,vb){this.cp=Sa;this.length=
cb;this.qTd=pb;this.Btd=vb}}Object(I.a)(Xa,"UpdateFormattingIdsPosInfo",null,[]);class $a{constructor(Sa,cb,pb){this.Q5=!1;this.Okb=new z.a;this.Wuh=!1;this.fe=Sa;this.xJh=pb;this._base=cb;this.BPe=Y(cb);if(!R(this.Sj,this.Ze))throw a.a.instance.Ua(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Sa.logger.Ti(Object.assign(new K.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.fe.runtime.qc.Erb(1000010)&&(this.Wuh=!0)}get Sj(){return this._base}get Ze(){return this.BPe}get zdd(){return this.Q5}hjf(Sa,
cb){switch(Sa.type){case 11:return this.c9k(Sa,cb);case 8:return this.Gif(Sa,cb);case 10:return this.Eif(Sa);default:return!1}}gjf(Sa,cb){switch(Sa.type){case 11:return this.b9k(Sa,cb);case 8:return this.Fif(Sa,cb);case 10:return this.Dif(Sa);default:return{returnValue:!1,Av:null}}}kTh(){a.a.instance.Ua(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}jTh(){a.a.instance.Ua(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}GDf(Sa){let cb;cb=new l.a;let pb=0,vb=0,xb=0;for(;pb<Sa.length;){if(vb>=this.Sj.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,Atd:cb};if(Sa.K(pb).length>this.Sj.K(vb).length){if(!O(Sa,pb,this.Sj.K(vb).length))return a.a.instance.Ua(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,Atd:cb}}else if(Sa.K(pb).length<this.Sj.K(vb).length&&!this.Xeb(xb+Sa.K(pb).length,!0).returnValue)return a.a.instance.Ua(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),
this.fe.logger.Ti(Object.assign(new K.a,{ek:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Atd:cb};if(this.Sj.K(vb).Gn&&5!==this.Sj.K(vb).type&&this.Sj.K(vb).R7()){const Bb=this.Sj.K(vb),jc=Sa.K(pb);if(!Bb.DL.equals(jc.DL)||!Bb.iA.gC(jc.iA)){let xc,Qc;if(({Rgc:xc,Wei:Qc}=this.VQm(this.Sj.K(vb))).returnValue)cb.add(new Xa(Qc,this.Ze.K(xc).length,Bb,jc));else return a.a.instance.Ua(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),
this.fe.logger.Ti(Object.assign(new K.a,{ek:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Atd:cb}}}xb+=this.Sj.K(vb).length;pb++;vb++}return{returnValue:!0,Atd:cb}}c9k(Sa,cb){let pb;if(!({yJa:pb}=this.Xeb(Sa.cp,!0)).returnValue)return a.a.instance.Ua(574433300,1,2,"ApplyInsertTextHintToDerived"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let xb=0;xb<Sa.k3.length;xb++)switch(Sa.k3.K(xb).type){case 7:var vb=
Sa.k3.K(xb);this.Ze.insert(pb,new va(cb,null,vb.text,vb.id));break;case 9:vb=Sa.k3.K(xb);this.Ze.insert(pb,new C.a(cb,vb.Qg,vb.Zc));break;default:return a.a.instance.Ua(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}Gif(Sa,cb){let pb,vb;if(!({yJa:pb}=this.Xeb(Sa.cp,!0)).returnValue||!({yJa:vb}=this.Xeb(Sa.cp+Sa.text.length,!1)).returnValue)return a.a.instance.Ua(575706433,1,2,"ApplyDeleteTextHintToDerived"),
this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Sa=vb;Sa>=pb;Sa--)this.Ze.K(Sa).source!==cb&&this.c_d(this.Ze,Sa);return!0}Eif(Sa){let cb;if(!({yJa:cb}=this.Xeb(Sa.cp,!0)).returnValue)return a.a.instance.Ua(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.Cwf(this.Ze,Sa,cb);return!0}b9k(Sa,cb){let pb;pb=null;let vb,xb;if(!({SKb:vb,yJa:xb}=this.Xeb(Sa.cp,
!0)).returnValue)return a.a.instance.Ua(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,Av:pb};var Bb=this.JIf(this.Ze,xb-1);Bb=new hb.a(Bb);for(let jc=0;jc<Sa.k3.length;jc++)switch(Sa.k3.K(jc).type){case 7:Bb.k3.add(this.Kif(Sa.k3.K(jc),cb,vb,xb));break;case 9:Bb.k3.add(this.d9k(Sa.k3.K(jc),cb,vb,xb));break;default:return a.a.instance.Ua(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),
this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,Av:pb}}pb=new l.a;pb.add(Bb);return{returnValue:!0,Av:pb}}Kif(Sa,cb,pb,vb){const xb=new va(cb,Sa.Qg,Sa.text,Sa.id);cb=new va(cb,Sa.Qg,Sa.text,Sa.id);xb.Gn=cb;cb.Gn=xb;this.Sj.insert(pb,xb);this.Ze.insert(vb,cb);pb=new tb.a(Sa.Qg,Sa.text);pb.id=Sa.id;return pb}d9k(Sa,cb,pb,vb){const xb=new C.a(cb,Sa.Qg,Sa.Zc);cb=new C.a(cb,Sa.Qg,Sa.Zc);xb.Gn=cb;cb.Gn=xb;this.Sj.insert(pb,xb);this.Ze.insert(vb,
cb);return new gb.a(Sa.Qg,Sa.Zc)}Fif(Sa){let cb;cb=new l.a;let pb;var vb;let xb;if(!({SKb:pb,yJa:vb}=this.Xeb(Sa.cp,!0)).returnValue||!({SKb:xb,yJa:Bb}=this.Xeb(Sa.cp+Sa.text.length,!1)).returnValue)return a.a.instance.Ua(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,Av:cb};this.fe.runtime.qc.l$d(1000010);for(Sa=Bb;Sa>=vb;Sa--)if(this.Ze.K(Sa).Gn){var Bb=Sa;const jc=({Xbg:Sa}=
this.H9l(Sa,vb)).returnValue;jc&&(cb.add(jc),this.c_d(this.Ze,Sa,Bb))}for(vb=xb;vb>=pb;vb--)this.c_d(this.Sj,vb);return{returnValue:!0,Av:cb}}Dif(Sa){let cb;cb=null;let pb,vb;if(!({SKb:pb,yJa:vb}=this.Xeb(Sa.cp,!0)).returnValue)return a.a.instance.Ua(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,Av:cb};if(!this.Cwf(this.Sj,Sa,pb))return a.a.instance.Ua(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),
this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,Av:cb};this.Cwf(this.Ze,Sa,vb)&&(cb=new l.a,cb.add(new Ta.a(this.JIf(this.Ze,vb-1),Sa.Qg,Sa.Zc)));return{returnValue:!0,Av:cb}}Xeb(Sa,cb){var pb;var vb=pb=-1;let xb,Bb;if(!({svb:Bb,lWh:Sa,kWh:xb}=L(this.Sj,Sa,this.fe.logger)).returnValue)return{returnValue:!1,SKb:pb,yJa:vb};const jc=Sa>=this.Sj.length;jc&&Sa--;if(this.Sj.K(Sa).Gn){const xc=this.eam(this.Ze,this.Sj.K(Sa));if(Bb){if(0>
xc||!O(this.Sj,Sa,xb)||!O(this.Ze,xc,xb))return a.a.instance.Ua(575706444,1,2,"SplitTwinListAndFindIdx"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,SKb:pb,yJa:vb};pb=this.Sj.K(Sa);vb=this.Ze.K(xc);pb.Gn=vb;vb.Gn=pb;pb=this.Sj.K(Sa+1);vb=this.Ze.K(xc+1);pb.Gn=vb;vb.Gn=pb;pb=cb?Sa+1:Sa;vb=cb?xc+1:xc}else cb?(pb=jc?Sa+1:Sa,vb=jc?xc+1:xc):(pb=jc?Sa:Sa-1,vb=jc?xc:xc-1)}else if(Bb){if(O(this.Sj,Sa,xb))pb=cb?Sa+1:Sa;else return a.a.instance.Ua(575706445,
1,2,"SplitTwinListAndFindIdx"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,SKb:pb,yJa:vb};cb?(vb=({aSb:vb}=this.Jic(this.Sj,this.Ze,Sa,!1)).returnValue?vb+1:0,vb=vb>=this.Ze.length?this.Ze.length-1:vb):(vb=({aSb:vb}=this.Jic(this.Sj,this.Ze,Sa,!0)).returnValue?vb-1:this.Ze.length-1,vb=0>vb?0:vb)}else cb?(({aSb:vb}=this.Jic(this.Sj,this.Ze,Sa,!0)).returnValue||(({aSb:vb}=this.Jic(this.Sj,this.Ze,Sa,!1)).returnValue?vb+=1:(vb=jc?this.Ze.length-
1:0,vb=0>vb?0:vb)),pb=jc?Sa+1:Sa):(({aSb:vb}=this.Jic(this.Sj,this.Ze,Sa,!1)).returnValue||(({aSb:vb}=this.Jic(this.Sj,this.Ze,Sa,!0)).returnValue?--vb:(vb=Sa?this.Ze.length-1:0,vb=0>vb?0:vb)),pb=jc?Sa:Sa-1);return{returnValue:!0,SKb:pb,yJa:vb}}Jic(Sa,cb,pb,vb){let xb=null;if(vb)for(;pb<Sa.length;pb++){if(Sa.K(pb).Gn){xb=Sa.K(pb).Gn;break}}else for(;0<=pb;pb--)if(Sa.K(pb).Gn){xb=Sa.K(pb).Gn;break}if(xb)for(Sa=0;Sa<cb.length;Sa++)if(cb.K(Sa)===xb)return cb=Sa,{returnValue:!0,aSb:cb};return{returnValue:!1,
aSb:-1}}eam(Sa,cb){for(let pb=0;pb<Sa.length;pb++)if(Sa.K(pb).Gn===cb)return pb;return-1}c_d(Sa,cb,pb=-1){for(pb=0>pb?cb:pb;pb>=cb;pb--)Sa.K(pb).Gn&&(Sa.K(pb).Gn.Gn=null),Sa.oI(pb)}JIf(Sa,cb){let pb=0;for(;0<=cb;cb--)pb+=Sa.K(cb).length;return pb}rPm(Sa){Sa=Object(x.a)(wa.a,Sa);Sa||(a.a.instance.Ua(575706448,1,2,"GetTextBlock"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"GetTextBlock",eventId:"8ujvq"})));return Sa}H9l(Sa,cb){let pb="",vb=Sa;for(;vb>=cb&&this.Ze.K(vb).Gn&&2!==this.Ze.K(vb).type;)pb=
this.rPm(this.Ze.K(vb)).text+pb,vb--;cb=0>vb?0:this.JIf(this.Ze,vb);return!this.Wuh||vb<Sa?(Sa=vb+1,{returnValue:new kb.a(cb,pb),Xbg:Sa}):{returnValue:null,Xbg:vb}}VQm(Sa){let cb,pb,vb=!1;pb=cb=0;if(!Sa.Gn)return{returnValue:!1,Rgc:cb,Wei:pb};for(cb=0;cb<this.Ze.length;cb++){if(this.Ze.K(cb).Gn===Sa){vb=!0;break}pb+=this.Ze.K(cb).length}return{returnValue:vb,Rgc:cb,Wei:pb}}Cwf(Sa,cb,pb){pb=pb===Sa.length?--pb:pb;pb>Sa.length-1&&(a.a.instance.Ua(571757957,1,2,"DeleteEopInList: Idx out of range"),this.fe.logger.Ti(Object.assign(new K.a,
{ek:"DeleteEopInList",eventId:"8ffwf"})));if(2===Sa.K(pb).type){const vb=Sa.K(pb);if(vb.Bk!==cb.Qg||vb.Zc!==cb.Zc)return!1;this.c_d(Sa,pb);return!0}return!1}}Object(I.a)($a,"ParagraphMergeUsingHintsTwinListLcs",null,[1119]);var La=d(1500),bb=d(1458),Gb=d(1730);d.d(J,"a",function(){return qb});class qb{constructor(Sa,cb,pb,vb,xb,Bb,jc=null,xc=null,Qc=null){this.oT=this.Dya=this.XQa=this.Bwa=null;this._initialized=!1;this.fe=Sa;this.MH=cb;this.DHa=vb;this.hGa=pb;this.dxa=xb;this.uLe=new f.a;for(Sa=
0;Sa<this.MH.length;Sa++)this.uLe.add(this.MH.K(Sa).id);this.xhh=new f.a;for(Sa=0;Sa<this.hGa.length;Sa++)this.xhh.add(this.hGa.K(Sa).id);this.kJh=new f.a;for(Sa=0;Sa<this.DHa.length;Sa++)this.kJh.add(this.DHa.K(Sa).id);this.wg=Bb;this.fcf=jc||y.a.instance;this.TK=xc;this.SZ=Qc;this.hFb=1===(this.TK&&this.SZ&&1===this.TK.pPa&&1===this.SZ.pPa?1:0);this.cxa=0}get Ivg(){return 1!==this.cxa}Q$m(){var Sa=!0;if(this.TK&&this.SZ)return Sa;if(this.TK||this.SZ)return a.a.instance.Ua(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.fe.runtime.QA.mb(F.a.cO)&&(Sa=this.fe.runtime.QA.K(F.a.cO),Sa=this.gOg(Sa,this.fe.runtime.MIa.id,"favored")&&({AK:this.TK}=this.$Ri(Sa,this.uLe,this.xhh,this.fe.runtime.QA,"favored")).returnValue);Sa&&this.fe.runtime.zv.mb(F.a.cO)&&(Sa=this.fe.runtime.zv.K(F.a.cO),Sa=this.gOg(Sa,this.fe.runtime.MIa.id,"unfavored")&&({AK:this.SZ}=this.$Ri(Sa,this.uLe,this.kJh,this.fe.runtime.zv,"unfavored")).returnValue);this.TK=this.TK?this.TK:new Gb.a(new l.a,0);this.SZ=this.SZ?this.SZ:new Gb.a(new l.a,0);
Sa&&this.fe.input.cSb&&(Sa=this.fe.input.Sca.last().GKa(F.a.cO),Sa=this.gOg(Sa,this.fe.input.Sca.last().KJ.id,"alreadyMerged"));return Sa}R8m(){const Sa=new f.a;if(this.hFb)return Sa;const cb=this.TK?this.TK.AK.iOa():new l.a;let pb=0;for(;pb<cb.length-1;){const vb=cb.K(pb);let xb,Bb=!1;for(xb=pb+1;xb<cb.length;xb++){const jc=cb.K(xb);if(vb.GZi(jc)){Sa.add(vb.id);cb.oI(xb);cb.oI(pb);Bb=!0;break}}Bb||pb++}return Sa}gOg(Sa,cb,pb){Sa=this.wg.getPropertyString(Sa,m.a.TEa);Sa=w.a.Af(Sa);return cb.equals(Sa)?
!0:(this.$nd(2),a.a.instance.Ua(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.fe.runtime.MIa.id,Sa,pb),!1)}$Ri(Sa,cb,pb,vb,xb){let Bb;Bb=new Gb.a(new l.a,0);Sa=this.wg.getPropertyObjectIds(Sa,m.a.JY).iOa();for(let xc=0;xc<Sa.length;xc++){if(!vb.mb(Sa.K(xc)))return a.a.instance.Ua(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",
Sa.K(xc),xb),{returnValue:!1,AK:Bb};const Qc=vb.K(Sa.K(xc));var jc=w.a.Af(this.wg.getPropertyString(Qc,m.a.koa));if(cb.contains(jc)||pb.contains(jc)){jc=this.fcf.Blc(Qc);if(!jc)return a.a.instance.Ua(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",Qc.id,xb),{returnValue:!1,AK:Bb};Bb.AK.add(jc)}}0<Sa.length&&a.a.instance.Ua(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",
xb,Sa.Vr(),Bb.AK.Vr());return{returnValue:!0,AK:Bb}}Z9m(){return({fN:this.Bwa,t0c:this.XQa,Rsd:this.Dya}=La.a.W$h(this.fe,this.wg,this.MH,this.hGa,this.DHa,this.dxa,!0,!0)).returnValue?!0:!1}O$m(Sa){const cb=La.a.IYd(this.wg,pb=>this.fe.runtime.Kn.K(pb),this.MH,1,this.dxa,!0,!0).returnValue;if(!cb)return a.a.instance.Ua(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.oT=this.hFb?new $a(this.fe,cb,1):new Pa(this.fe,cb,Sa,this.TK?this.TK.pPa:
0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.Q$m()||!this.Z9m())return!1;const Sa=this.R8m();return this.O$m(Sa)?!0:!1}hCi(Sa){const cb=new l.a;let pb="";for(let vb=0;vb<Sa.length;vb++){const xb=Sa.K(vb);xb.R7()?pb+=Sa.K(vb).text:2===xb.type?(cb.add(new fa(xb.Bk,xb.type,pb,xb.Zc)),pb=""):4===xb.type&&(cb.add(new fa(xb.Bk,xb.type)),pb="")}return cb}eGe(Sa,cb,pb){cb=this.hCi(cb);Sa=this.hCi(Sa);let vb=cb.length===Sa.length;if(vb)for(let xb=0;xb<cb.length;xb++)if(!cb.K(xb).isEqual(Sa.K(xb))){vb=
!1;break}vb||(this.$nd(4),a.a.instance.Ua(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",pb,Sa.Vr(),cb.Vr()));return vb}RTh(Sa,cb,pb){(cb=({Tfb:Sa}=this.P$k(Sa,cb,pb)).returnValue)||this.$nd(this.oT.zdd?1:3);return{returnValue:cb,Tfb:Sa}}P$k(Sa,cb,pb){let vb;vb=new l.a;let xb=!0;var Bb=0;let jc=null,xc=this.TK?this.TK.AK.length:0;for(var Qc=0;Qc<xc&&xb;Qc++)jc=this.TK.AK.K(Qc),
Bb<this.SZ.AK.length&&jc.id.equals(this.SZ.AK.K(Bb).id)&&5!==this.fe.input.source?({returnValue:xb}=this.oT.gjf(jc,2),Bb++):xb=this.oT.hjf(jc,2);if(!xb)return a.a.instance.Ua(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",jc.toString()),{returnValue:!1,Tfb:vb};if(!this.eGe(this.oT.Ze,this.XQa,"Favored"))return{returnValue:!1,Tfb:vb};if(Sa&&1===this.fe.input.Gma&&!this.oT.kTh(cb,pb,2))return a.a.instance.Ua(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
cb,pb),{returnValue:!1,Tfb:vb};xb=!0;Qc=new l.a;for(xc=this.SZ?this.SZ.AK.length:0;Bb<xc&&xb;Bb++){jc=this.SZ.AK.K(Bb);let fd;({Av:fd,returnValue:xb}=this.oT.gjf(jc,4));xb&&fd&&Qc.wD(Qc.length,fd)}return xb?this.eGe(this.oT.Sj,this.Dya,"Unfavored")?Sa&&2===this.fe.input.Gma&&!this.oT.jTh(cb,pb,4)?(a.a.instance.Ua(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",cb,pb),{returnValue:!1,Tfb:vb}):{returnValue:!0,Tfb:Qc}:{returnValue:!1,Tfb:vb}:(a.a.instance.Ua(17044291,
1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",jc.id,jc.type),{returnValue:!1,Tfb:vb})}UAm(){let Sa,cb=0;let pb=0,vb=w.a.nil;for(Sa=new z.a;pb<this.oT.Sj.length;){const jc=this.oT.Sj.K(pb);vb.equals(jc.Bk)||(cb=0,vb=jc.Bk);if(5===jc.type){var xb=cb+jc.length;var Bb=void 0;let xc;const Qc=Y(this.Dya);if(!({index:Bb}=V(Qc,jc.Bk,cb)).returnValue||!({index:xc}=V(Qc,jc.Bk,xb)).returnValue)return a.a.instance.Ua(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",
jc.htd),{returnValue:!1,Ydj:Sa};for(xb=new l.a;Bb<xc;Bb++)xb.add(Qc.K(Bb));Sa.W(jc.htd,xb)}cb+=jc.length;pb++}return{returnValue:!0,Ydj:Sa}}VAm(){let Sa;Sa=new z.a;let cb=0;for(let vb=0;vb<this.oT.Sj.length;vb++){const xb=this.oT.Sj.K(vb);if(5===xb.type){var pb=void 0;let Bb;const jc=Y(this.Dya);if(!({index:pb}=Z(jc,cb,this.fe.logger)).returnValue||!({index:Bb}=Z(jc,cb+xb.length,this.fe.logger)).returnValue)return a.a.instance.Ua(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),
{returnValue:!1,Zdj:Sa};const xc=new l.a;for(;pb<Bb;pb++)xc.add(jc.K(pb));Sa.W(xb.htd,xc)}cb+=xb.length}return{returnValue:!0,Zdj:Sa}}A9k(Sa){let cb;cb=new l.a;let pb;if(this.hFb){if(!({Zdj:pb}=this.VAm()).returnValue)return{returnValue:!1,Edd:cb}}else if(!({Ydj:pb}=this.UAm()).returnValue)return{returnValue:!1,Edd:cb};let vb;vb=this.hFb?new $a(this.fe,Y(this.XQa),1):new Pa(this.fe,Y(this.XQa),new f.a,this.TK?this.TK.pPa:0);for(var xb=0;xb<Sa.length;xb++)if(!vb.hjf(Sa.K(xb),4))return{returnValue:!1,
Edd:cb};for(Sa=vb.Ze.length-1;0<=Sa;Sa--)5===vb.Ze.K(Sa).type&&(xb=vb.Ze.K(Sa).htd,vb.Ze.oI(Sa),vb.Ze.wD(Sa,pb.K(xb)));this.hFb&&(this.Yci(vb.Ze),this.Yci(this.oT.Ze));if(!this.eGe(this.oT.Ze,vb.Ze,"Merged"))return{returnValue:!1,Edd:cb};cb=vb.Ze;return{returnValue:!0,Edd:cb}}Yci(Sa){const cb=new z.a;for(let pb=Sa.length-1;0<=pb;pb--){const vb=Object(x.a)(C.a,Sa.K(pb));vb&&(cb.mb(vb.Zc)?cb.K(vb.Zc).source!==vb.source&&Sa.oI(pb):cb.add(vb.Zc,vb))}}O$k(Sa){let cb;if(!({Atd:cb}=this.oT.GDf(Y(this.Dya))).returnValue)return!1;
for(let vb=0;vb<cb.length;vb++){const xb=cb.K(vb);let Bb,jc;if(!({index:Bb}=Z(Sa,xb.cp,this.fe.logger)).returnValue||!({index:jc}=Z(Sa,xb.cp+xb.length,this.fe.logger)).returnValue)return a.a.instance.Ua(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var pb=!1;for(let xc=Bb;xc<jc&&!pb;xc++)pb=!xb.qTd.DL.equals(Sa.K(xc).DL);if(!pb){for(pb=Bb;pb<jc;pb++)Sa.oI(Bb);Sa.insert(Bb,
xb.Btd)}}return!0}N$k(Sa){let cb;if(!({XAc:cb}=this.oT.GDf(Y(this.Dya))).returnValue)return!1;for(let xb=0;xb<cb.length;xb++){var pb=cb.K(xb);let Bb,jc;if(({index:Bb}=V(Sa,pb.Qg,pb.cp)).returnValue&&({index:jc}=V(Sa,pb.Qg,pb.cp+pb.Btd.length)).returnValue){var vb=!1;for(let xc=Bb;xc<jc&&!vb;xc++)vb=!pb.qTd.DL.equals(Sa.K(xc).DL)||!pb.qTd.iA.gC(Sa.K(xc).iA);if(vb){if(this.TK&&1===this.TK.pPa||this.SZ&&1===this.SZ.pPa)return!1}else{for(vb=Bb;vb<jc;vb++)Sa.oI(Bb);Sa.insert(Bb,pb.Btd)}}else if(pb=pb.Btd.Egn,
a.a.instance.Ua(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",pb),pb||this.TK&&1===this.TK.pPa||this.SZ&&1===this.SZ.pPa)return!1}return!0}rGm(Sa){let cb,pb;pb=new l.a;cb=this.fe.runtime.Yq.K(F.a.cO);let vb;({j9f:vb}=qb.jti(this.fe,this.wg));const xb=new l.a;for(let jc=0;jc<Sa.length;jc++){if(vb.contains(Sa.K(jc).id,(Qc,fd)=>Qc.equals(fd)))continue;if(this.fe.runtime.Yq.mb(Sa.K(jc).id))return a.a.instance.shipAssertTag(17044293,
1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Sa.K(jc).id),{returnValue:!1,Ppe:cb,Ope:pb};xb.add(Sa.K(jc).id);var Bb=Sa.K(jc).cWa();const xc=new bb.a(Bb);Bb=Bb.fk();for(const Qc of Bb)xc.cN(Qc);pb.add(xc)}Sa=this.wg.getPropertyObjectIds(cb.Gm,m.a.JY);Sa.wD(Sa.length,xb);this.wg.setPropertyObjectIds(cb.Gm,m.a.JY,Sa);return{returnValue:!0,Ppe:cb,Ope:pb}}o6d(Sa){return String.format("Name: {0}, Message: {1}, Stack: {2}",Sa.name,Sa.message,Sa.stack)}$nd(Sa){0===this.cxa&&(this.cxa=
Sa)}JAc(){let Sa;Sa=null;let cb,pb;var vb;try{if({Yq:Sa,Ppe:cb,Ope:pb,returnValue:vb}=this.rrp(),vb){if(cb&&pb){this.fe.runtime.Yq.W(cb.Gm.id,cb);for(vb=0;vb<pb.length;vb++){const xc=pb.K(vb);this.fe.runtime.Yq.W(xc.Gm.id,xc)}const xb=cb.Gm,Bb=this.wg.getPropertyObjectIds(xb,m.a.JY),jc=this.wg.getPropertyString(xb,m.a.TEa);a.a.instance.Ua(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Bb.Vr(),jc)}else a.a.instance.Ua(593826831,
1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Yq:Sa}}}catch(xb){a.a.instance.Ua(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.o6d(xb))}this.$nd(5);a.a.instance.Ua(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.cxa,this.Ivg);this.Abb();this.TK&&1===this.TK.pPa&&this.fe.logger.Ti(Object.assign(new X.a,{eventId:"bc04c",ek:"ParagraphMergeUsingHints.TryDoMerge",
info:u[this.cxa]+"/LCS"}));return{returnValue:!1,Yq:Sa}}rrp(){let Sa,cb,pb;pb=cb=Sa=null;let vb;vb=this.initialize();this.fe.logger.WX("PMUH Initialize");let xb=null;vb=vb&&({Tfb:xb}=this.RTh(!1,w.a.nil,0)).returnValue;this.fe.logger.WX("PMUH ApplyUpdateHints");let Bb=new l.a;vb=vb&&({Edd:Bb}=this.A9k(xb)).returnValue;this.fe.logger.WX("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");vb=this.hFb?vb&&this.O$k(Bb):vb&&this.N$k(Bb);this.fe.logger.WX("PMUH ApplyUnfavoredFormattingChanges");
this.hFb&&!this.KKo(Bb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.fe.logger.Ti(Object.assign(new K.a,{ek:"ReuseParaIdsIfPossible",eventId:"8ettb"})),vb=!1);const jc=this.$7d(Bb);vb=vb&&({Npe:Sa}=La.a.V3c(this.fe,this.wg,this.dxa,Bb,jc)).returnValue;this.fe.logger.WX("PMUH GetMergeableObjectsFromMergeBlocks");this.TK&&1===this.TK.pPa&&this.SZ&&1===this.SZ.pPa||(vb=vb&&({Ppe:cb,Ope:pb}=this.rGm(G(xb))).returnValue,this.fe.logger.WX("PMUH GetPartialMergeResultForUpdateHintNodes"));
return{returnValue:vb,zdd:!!this.oT&&this.oT.zdd,Yq:Sa,Ppe:cb,Ope:pb}}$7d(Sa){const cb=new l.a;for(let pb=0;pb<Sa.length;pb++)2===Sa.K(pb).type&&cb.add(Sa.K(pb).Bk);return cb}FJf(Sa){const cb=new l.a;for(let pb=0;pb<Sa.length;pb++)2===Sa.K(pb).type&&cb.add(Sa.K(pb));return cb}KKo(Sa){var cb=this.FJf(this.Bwa),pb=this.FJf(this.XQa),vb=this.FJf(this.Dya),xb=this.$7d(cb),Bb=this.$7d(pb),jc=this.$7d(vb);Bb=H.b(xb,Bb,jc);xb=new l.a;for(jc=0;jc<Bb.length;jc++)xb.wD(xb.length,Bb.K(jc).ham());Bb=this.mam(Sa);
cb=this.iam(Bb,xb,cb,pb,vb);pb=0;vb=new f.a;for(xb=0;xb<Sa.length;xb++)if(Bb=Sa.K(xb),2===Bb.type)if(vb.contains(Bb.Bk))if(pb<cb.length)Sa.oI(xb),Sa.insert(xb,cb.K(pb)),pb++;else return!1;else vb.add(Bb.Bk);0<Sa.length&&2!==Sa.K(Sa.length-1).type&&pb<cb.length&&Sa.insert(Sa.length,cb.K(pb));return!0}mam(Sa){const cb=new f.a;for(let pb=0;pb<Sa.length;pb++)2===Sa.K(pb).type&&cb.add(Sa.K(pb).Bk);return cb}iam(Sa,cb,pb,vb,xb){const Bb=new l.a;for(let jc=0;jc<cb.length;jc++){const xc=cb.K(jc);if(!Sa.contains(xc)){let Qc;
(({block:Qc}=this.yDf(vb,xc)).returnValue||({block:Qc}=this.yDf(xb,xc)).returnValue||({block:Qc}=this.yDf(pb,xc)).returnValue)&&Qc&&Bb.add(Qc)}}return Bb}yDf(Sa,cb){for(let pb=0;pb<Sa.length;pb++)if(2===Sa.K(pb).type&&Sa.K(pb).Bk===cb)return Sa=Sa.K(pb),{returnValue:!0,block:Sa};return{returnValue:!1,block:null}}Abb(){const Sa=new l.a;La.a.grc(this.wg,"BaseObjects_",this.MH,Sa);La.a.grc(this.wg,"FavoredObjects_",this.hGa,Sa);La.a.grc(this.wg,"ConflictObjects_",this.DHa,Sa)}nll(){let Sa,cb;Sa=w.a.nil;
cb=-1;let pb=0;for(let vb=0;vb<this.oT.Ze.length;vb++){const xb=this.oT.Ze.K(vb);if(xb.R7())pb+=xb.length;else if(6!==xb.type)pb=0;else return Sa=xb.Bk,cb=pb,{returnValue:!0,objectId:Sa,cp:cb}}a.a.instance.Ua(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Sa,cp:cb}}ctd(Sa,cb){let pb,vb;vb=cb;pb=Sa;try{let xb=this.initialize();if(xb=(xb=xb&&this.RTh(!0,Sa,cb).returnValue)&&({objectId:pb,cp:vb}=this.nll()).returnValue)return a.a.instance.Ua(17409924,
1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",pb,vb),{returnValue:!0,Jdb:pb,hva:vb}}catch(xb){a.a.instance.Ua(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.o6d(xb))}this.$nd(5);a.a.instance.Ua(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.cxa,this.Ivg);this.Abb();return{returnValue:!1,Jdb:pb,hva:vb}}static jti(Sa,
cb){let pb;pb=new l.a;if(!Sa.input.cSb)return{returnValue:!0,j9f:pb};Sa=Sa.input.Sca.last().GKa(F.a.cO);pb=cb.getPropertyObjectIds(Sa,m.a.JY);return{returnValue:!0,j9f:pb}}static qgo(Sa){if(!La.a.czf(Sa))return!0;const cb=new v.a;Sa.runtime.Yq.W(F.a.cO,La.a.R$m(Sa,cb));return!0}static Ufo(Sa){if(!Sa.runtime.Yq.mb(F.a.cO)||!Sa.runtime.zv.mb(F.a.cO))return!0;const cb=new v.a,pb=Sa.runtime.Yq.K(F.a.cO);var vb=cb.getPropertyString(pb.Gm,m.a.TEa);if(w.a.Af(vb).equals(w.a.nil))return!0;vb=cb.getPropertyObjectIds(pb.Gm,
m.a.JY);const xb=cb.getPropertyObjectIds(Sa.runtime.zv.K(F.a.cO),m.a.JY);let Bb;({j9f:Bb}=qb.jti(Sa,cb));for(let jc=0;jc<xb.length;jc++)vb.contains(xb.K(jc),(xc,Qc)=>xc.equals(Qc))||Bb.contains(xb.K(jc),(xc,Qc)=>xc.equals(Qc))||(vb.add(xb.K(jc)),Sa.runtime.Yq.W(xb.K(jc),new bb.a(Sa.runtime.zv.K(xb.K(jc)).$O())));cb.setPropertyObjectIds(pb.Gm,m.a.JY,vb);return!0}}Object(I.a)(qb,"ParagraphMergeUsingHints",null,[1018])},1628:function(I,J,d){I=d(0);class m{constructor(x){this.jhj=x;this.succeeded=!1;
this.AAc=x?x.AAc:0;this.evn=!1;this.length=this.ckp=0}}Object(I.a)(m,"TrieResult",null,[]);class f{constructor(x,u,v){this.Wub=new m(null);this.QJn=x;this.Hcd=u;this.zbj=u+v-1}get result(){return this.Wub}CCi(){let x;return this.Hcd<=this.zbj?(x=this.QJn.charAt(this.Hcd),++this.Hcd,{returnValue:!0,ch:x}):{returnValue:!1,ch:"\x00"}}Jrg(x,u,v){x&&(this.Wub.evn=!0,this.Wub.ckp=u);this.Wub.length=this.Hcd;this.Wub.succeeded=!0;this.Wub.AAc=v;this.Hcd!==this.zbj+1&&(this.Wub=new m(this.Wub))}}Object(I.a)(f,
"LookUpStringVisitor",null,[1887]);var a=d(1748);class l{constructor(){this.w0h=this.LYh=this.NYh=this.KYh=this.MYh=this.Qmf=this.Omf=this.Smf=this.Nmf=0}}Object(I.a)(l,"TRIESTATS",null,[]);class w{constructor(){this.AOa=this.xed=0}}Object(I.a)(w,"TrieSymbol",null,[]);d.d(J,"a",function(){return z});class z{constructor(x,u){this.Y7=null;this.Xie=this.Obj=this.Mbj=this.Qbj=this.Ibj=this.Pbj=this.Nbj=this.Rbj=this.Jbj=0;this.aM=x;if(x.hA(u,4)!==z.wLb)throw Error.argument("Input does not represent a trie");
u+=4;this.Bbj=1===x.hA(u,4);u+=4;this.NJn=1===x.hA(u,4);u+=4;this.JJn=x.hA(u,4);u+=4;if(x.hA(u,4)){x=u+4;this.Y7=this.Aqo(x);this.Jbj=u=x+z.Gjl;this.Rbj=u+=z.kUd*(this.Y7.Nmf+(this.Y7.Nmf%2?1:0));this.Nbj=u+=z.kUd*(this.Y7.Smf+(this.Y7.Smf%2?1:0));this.Pbj=u+=z.kUd*(this.Y7.Omf+(this.Y7.Omf%2?1:0));this.Ibj=u+=z.kUd*(this.Y7.Qmf+(this.Y7.Qmf%2?1:0));this.Qbj=u+=z.Umf*this.Y7.KYh;this.Mbj=u+=z.Vmf*this.Y7.NYh;this.Obj=u+=z.Vmf*this.Y7.LYh;u+=z.Vmf*this.Y7.MYh;if(u!==x+this.Y7.w0h)throw Error.argument("Corrupted trie binary");
this.Xie=u}else this.Y7=null}Waj(x,u,v,F){x=new f(x,u,v);this.sbk(x,F);return x.result}HHi(x){if(this.Bbj)if(x)--x;else return"";if(!this.Y7)throw Error.argument("Invalid trieID");const u=new a.a;u.LH=0;this.m2b(u);const v=[];for(;;){if(u.LH&z.Agb)if(x)--x;else return Array.add(v,u.w3b),String.fromCharCode.apply(null,v);const F=!!(u.LH&z.HIe),y=this.Vjc(u,!0);if(F||x<y){if(Array.add(v,u.w3b),!this.m2b(u))throw Error.argument("Invalid trieID");}else if(x-=y,!this.osd(u))throw Error.argument("Invalid trieID");
}}sbk(x,u){let v=0;this.Bbj&&(x.Jrg(this.NJn,this.JJn,0),++v);if(this.Y7){var F=new a.a;F.LH=0;if(this.m2b(F))for(;;){var y=void 0;if(!({ch:y}=x.CCi()).returnValue)break;u&&(y=u(y));y=y.toString().charCodeAt(0);let G=!1;for(;!G;){const C=!!(F.LH&z.Agb);if(F.w3b===y){if(G=!0,C&&x.Jrg(!!(F.LH&z.xSg),F.kCe,v),!this.m2b(F))return}else if(v+=this.Vjc(F,!0),!this.osd(F))return;C&&++v}}}}m2b(x){if(!x.LH)return this.fKg(x),!0;if(!(x.LH&z.GIe))return!1;x.LWa=0;x.az=x.isb;this.fKg(x);return!0}osd(x){if(x.LH&
z.HIe)return!1;this.fKg(x);return!0}Vjc(x,u){return x.LH&z.wSg?x.jUd:x.LH&z.GIe?!u&&x.LH&z.HIe?this.$om(x):1:0}$om(x){x=z.Fpf(x);if(!this.m2b(x))return 0;let u=0;do x.LH&z.Agb&&++u,u+=this.Vjc(x,!1);while(this.osd(x));return u}fKg(x){x.LH||(x.LWa=0,x.az=this.Xie);var u=this.KZd(this.Jbj,x.az),v=u.AOa;x.az+=u.xed;u=this.aM.hA(this.Ibj+z.Umf*v,z.Umf);x.w3b=u&65535;x.LH=u>>16;x.LH&z.wSg&&(x.jUd=this.JOl(x));x.LH&z.xSg&&(u=this.KZd(this.Rbj,x.az),v=u.AOa,x.az+=u.xed,x.kCe=this.aM.hA(this.Qbj+4*v,4));
x.LH&z.xkk?(x.isb=this.Xie+((this.aM.K(x.az)<<8|this.aM.K(x.az+1))<<8|this.aM.K(x.az+2)),x.az+=3):x.LH&z.ykk?(x.isb=x.az,x.LWa=x.isb):x.LH&z.zkk?(u=this.KZd(this.Nbj,x.az),v=u.AOa,x.az+=u.xed,x.isb=this.Xie+this.aM.hA(this.Mbj+4*v,4)):x.LH&z.GIe&&(u=this.KZd(this.Pbj,x.az),v=u.AOa,x.az+=u.xed,x.LWa||(x.LWa=x.az),x.LWa+=this.aM.hA(this.Obj+4*v,4),x.isb=x.LWa)}KZd(x,u){const v=new w;let F=0;for(;;){F+=this.aM.K(u);++u;++v.xed;const y=this.aM.hA(x,2);if(F<y)break;v.AOa+=y;F-=y;x+=2;F<<=8}v.AOa+=F;return v}JOl(x){let u=
this.aM.K(x.az);192<=u?(u=(u&63)<<15|(this.aM.K(x.az+1)&127)<<8,u|=this.aM.K(x.az+2),x.az+=3):128<=u?(u=(u&127)<<8|this.aM.K(x.az+1),x.az+=2):x.az+=1;return u}Aqo(x){const u=new l;u.Nmf=this.aM.hA(x+12,2);u.Smf=this.aM.hA(x+14,2);u.Omf=this.aM.hA(x+16,2);u.Qmf=this.aM.hA(x+18,2);u.MYh=this.aM.hA(x+24,4);u.KYh=this.aM.hA(x+28,4);u.NYh=this.aM.hA(x+32,4);u.LYh=this.aM.hA(x+36,4);u.w0h=this.aM.hA(x+40,4);return u}static Fpf(x){const u=new a.a;u.w3b=x.w3b;u.LH=x.LH;u.jUd=x.jUd;u.az=x.az;u.isb=x.isb;u.LWa=
x.LWa;u.kCe=x.kCe;return u}}z.wLb=1654263084;z.Gjl=48;z.kUd=2;z.Vmf=4;z.Umf=4;z.Agb=1;z.HIe=2;z.wSg=4;z.xSg=8;z.GIe=16;z.ykk=64;z.zkk=128;z.xkk=256;Object(I.a)(z,"Trie",null,[1885])},1630:function(I,J,d){d.r(J);I=d(0);d(1393);var m=d(1424);class f{}f.Qcj=0;f.Hnl=1;f.$qe=10;Object(I.a)(f,"AppsForOfficeStoreType",null,[]);var a=d(1389),l=d(2),w=d(92),z=d(12);class x{constructor(){this.U9e=0}Dog(K,R){this.U9e=window.performance.now();this.d1a(()=>{const E=window.performance.now(),L={},O=l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);R.Z3k&&(L.callback=V=>{K(V,f.Qcj,E)},O&&(L.storeType=f.Qcj),l.AFrameworkApplication.va.Pb(z.a.CYb,2,L));R.$3k&&(L.callback=V=>{K(V,f.$qe,E)},O?L.storeType=f.$qe:l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?L.storeType=10:L.storeType=f.$qe,l.AFrameworkApplication.va.Pb(z.a.CYb,2,L))},0,()=>{if(a.TellMeActor.instance.We)a.TellMeActor.instance.We.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+
(window.performance.now()-this.U9e)+" ms")})}d1a(K,R=0,E=null){2!==l.AFrameworkApplication.va.Ob(z.a.CYb,1)?(a.TellMeActor.instance.We&&a.TellMeActor.instance.We.lC(m.a.Y3k,window.performance.now()-this.U9e),K()):R<x.cNn?l.AFrameworkApplication.oc.Yb(new w.a(2,1,x.bIp,()=>{this.d1a(K,R+1,E)})):E&&E()}static get instance(){x._instance||(x._instance=new x);return x._instance}}x._instance=null;x.cNn=20;x.bIp=500;Object(I.a)(x,"AddinEntitlementsQuery",null,[]);class u{constructor(){this.description=this.id=
this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.V2f=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(I.a)(u,"AddinInfo",null,[]);var v=d(1395),F=d(1398),y=d(1397),G=d(1388),C=d(153);d.d(J,"AddinResultsProvider",function(){return H});class H{constructor(K){this.f6e=[];this.jc=K;this.Z_n=(R,E,L)=>{if(R){const O=R.errorCode;if(a.TellMeActor.instance.We){const V={};V.StoreType=E;V.ErrorCode=O;V.AddinCount=
R.value?R.value.length:0;a.TellMeActor.instance.We.lC(m.a.Ghm,window.performance.now()-L,V)}if(0===O&&R.value){H.yKb=H.yKb||{};R=R.value;for(const V of R)R=new u,R.displayName=V[0],R.id=V[1],R.description=V[2],R.targetType=V[3],R.appVersion=4<V.length?V[4]:"",R.assetId=5<V.length?V[5]:"",R.assetStoreId=6<V.length?V[6]:"",R.width=7<V.length?V[7]:0,R.height=8<V.length?V[8]:0,R.iconUrl=9<V.length?V[9]:"",R.providerName=10<V.length?V[10]:"",R.storeId=11<V.length?V[11]:"",R.storeType=12<V.length?V[12]:
"",R.V2f=this.vym(R),H.yKb[R.id]=R,0<R.iconUrl.length&&(E="AddinIcon_"+R.id,l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.oBj(E,R.iconUrl):appChrome.addInApi.registerAddinIcon(E,R.iconUrl))}}};x.instance.Dog(this.Z_n,this.jc)}zN(){return"Add-ins"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:2}gK(K,R,E,L,O=null){E=new y.a(K);O&&!Array.contains(O,27)||G.a.KU(K)||(O=new F.a(27),O.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,
this.Xxm(K.Wg,O),E.kw(O));R.Qt(E)}Xxm(K,R){if((K=this.gPo(K))&&0<K.length){let E=0;K.forEach(L=>{if(!(3<++E)){var O="AddinSuggestion"+E,V={};if(l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var Z="AddinIcon_"+L.id;0>Array.indexOf(this.f6e,Z)&&0<L.iconUrl.length&&this.oBj(Z,L.iconUrl);V["default"]=0<=Array.indexOf(this.f6e,Z)?Z:"AppForOfficeLogo_20"}else V["default"]=0<L.iconUrl.length?"AddinIcon_"+L.id:"AppForOfficeLogo_20";Z=[];
Z.push(appChrome.actions.setControlLabel(O,L.displayName));Z.push(appChrome.actions.setControlIconSet(O,V));Z.push(appChrome.actions.setCompoundButtonCommandValueId(O,L.id));Z.push(appChrome.actions.updateCompoundButtonDescription(O,L.description));l.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(V=window.performance.now(),Z.push(appChrome.actions.updateControlEnabledDisabledState(O,!1)),a.TellMeActor.instance.We&&a.TellMeActor.instance.We.lC(m.a.K0l,
window.performance.now()-V));appChrome.api.dispatch(Z);O=new v.a(O,27,void 0,void 0,1);O.hL=Telemetry.PrivacyRules.GetPrivacyCompliantId(L.id,L.storeType,L.assetId,null,null,L.storeId);R.jy(O)}})}}oBj(K,R){C.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(K,R),Array.add(this.f6e,K))}gPo(K){if(!H.yKb)return null;const R=[],E=H.yKb;for(const O in E){var L=E[O];L&&H.fMn(K,L)&&Array.add(R,L)}return R}vym(K){return H.$dp(K.displayName)}static fMn(K,R){if(!R.V2f)return!1;
for(const E of K.split(" ")){K=!1;for(const L of R.V2f)if(L.toLowerCase().startsWith(E.toLowerCase())){K=!0;break}if(!K)return!1}return!0}static $dp(K){const R=[];for(const E of K.split(" ")){K=0;for(let L=0;L<E.length;L++){const O=E.charAt(L);O.toString().toUpperCase()===O.toString()&&L>K&&(Array.add(R,E.substring(K,L)),K=L)}Array.add(R,E.substring(K,E.length));K&&Array.add(R,E.substring(0,E.length))}return R}}H.yKb=null;Object(I.a)(H,"AddinResultsProvider",null,[1024])},1727:function(I,J,d){d.d(J,
"a",function(){return f});I=d(0);var m=d(221);class f{constructor(){this.jYb=this.ENb=this.XWa=this.Swb=this.Twb=this.V7a=this.Ksb=this.Rwb=this.Job=this.Isb=this.bdb=this.Kob=this.Jsb=null;this.reset()}reset(){this.Jsb=new m.a;this.Kob=new m.a;this.bdb=new m.a;this.Isb=new m.a;this.Job=new m.a;this.Rwb=new m.a;this.Ksb=new m.a;this.V7a=new m.a;this.V7a=new m.a;this.Twb=new m.a;this.Swb=new m.a;this.XWa=[];this.ENb=[];this.jYb=[]}yGp(a){return this.wWa(this.Jsb,a)&&this.wWa(this.Kob,a)&&this.wWa(this.bdb,
a)&&this.wWa(this.Isb,a)&&this.wWa(this.Job,a)&&this.wWa(this.Rwb,a)&&this.wWa(this.Ksb,a)&&this.wWa(this.V7a,a)&&this.wWa(this.Twb,a)&&this.wWa(this.Swb,a)}wWa(a,l){return!a||!a.length||a.length===l}}Object(I.a)(f,"MergeableTrackedChangesProperties",null,[])},1728:function(I,J,d){d.d(J,"a",function(){return a});I=d(0);var m=d(221),f=d(605);class a{constructor(){this.UPa=new m.a;this.WQa=new m.a;this.nTa=new m.a}get QKb(){return this.UPa}get UCf(){return this.WQa}get vAb(){return this.nTa}get isEmpty(){return!this.UPa.length&&
!this.WQa.length&&!this.nTa.length}get avb(){return Math.max(Math.max(this.UPa.length,this.WQa.length),this.nTa.length)}get DPn(){return Math.min(Math.min(this.UPa.length,this.WQa.length),this.nTa.length)}vSd(l){this.UPa.add(l)}xSd(l){this.WQa.add(l)}BSd(l){this.nTa.add(l)}ham(){const l=new f.a,w=new m.a;let z=0;for(;z<this.UPa.length||z<this.WQa.length||z<this.nTa.length;)z<this.UPa.length&&!l.contains(this.UPa.K(z))&&(w.add(this.UPa.K(z)),l.add(this.UPa.K(z))),z<this.WQa.length&&!l.contains(this.WQa.K(z))&&
(w.add(this.WQa.K(z)),l.add(this.WQa.K(z))),z<this.nTa.length&&!l.contains(this.nTa.K(z))&&(w.add(this.nTa.K(z)),l.add(this.nTa.K(z))),z++;return w}}Object(I.a)(a,"ObjectCollection",null,[])},1729:function(I,J,d){d.d(J,"a",function(){return C});I=d(0);var m=d(58),f=d(13),a=d(357),l=d(221);d(46);d(800);var w=d(605),z=d(177),x=d(183),u=d(1036),v=d(1281),F=d(1780),y=d(1534),G=d(1777);class C{constructor(H){this.PC=new u.a;this.tZ=new a.a;this.nIh=new a.a(0);this.Ewd=new l.a;this.tlh=new l.a;this.Gvh=
new l.a;this.cth=new l.a;this.Vuh="";this.H2a=null;this.rt=this.VZe=0;this.dJd=new a.a(0);this.eSe=this.ezh=this.VFd=0;const {MarkerValidation:K}=d(1921);this._state=H;this.eFk=new K}get Wcd(){return this.eFk}get hxj(){return this.H2a}s0o(H){this.VZe=H}xie(H,K){this.Vuh=String.format("{0}-{1}",H,K)}Vxe(H){this.Msl();this.eSe=H}hAg(){this.eSe=0}Msl(){this.H2a&&this.Ewd.add(this.H2a);this.H2a=null}Ti(H){this.H2a||(this.H2a=H);switch(this.eSe){case 1:this.tlh.add(H);break;case 2:this.Gvh.add(H);break;
case 3:this.cth.add(H);break;default:this.H2a&&this.Ewd.add(H)}}l$i(H){this.Ewd.add(H)}VGn(){this.rt=this.uKa();this.Dbb("MergeEnd")}Dbb(H){const K=this.uKa();this.nIh.W(H,K-this.VZe);this.VZe=K}oZo(){this.VFd=this.uKa();this.ezh++}WX(H){const K=this.uKa();let R;({value:R}=this.dJd.Ec(H)).returnValue?(R+=K-this.VFd,this.dJd.W(H,R)):this.dJd.W(H,K-this.VFd);this.VFd=K}YAm(){this.tZ.W("Id",this._state.input.UVb.toString());this.tZ.W("Source",v.a[this._state.input.source]);this.tZ.W("RevSummary",C.h1a(this.RJm()));
this.tZ.W("NodesRolledBackIfFailed",C.h1a(this.fDm()));if(!this._state.output.succeeded){let H,K,R,E,L;({gdl:H,h7l:K,uup:R,ldl:E,wup:L}=this.n9l(this._state.runtime));this.tZ.W("CharactersLost",this.mmm(H,K,R));this.tZ.W("CharactersLostInComments",this.unm());this.tZ.W("CharactersLostInTables",this.Bim(L,E))}this.tZ.W("FuncStep",this.Vuh);this.tZ.W("FailureDetail",C.h1a(this.WPb()));this.tZ.W("FailDetailHints",this.q6d(this.tlh));this.tZ.W("FailDetailNaiveMerge",this.q6d(this.Gvh));this.tZ.W("FailDetailLcs",
this.q6d(this.cth));this.tZ.W("ExtraDetails",this.q6d(this.Ewd));this.tZ.W("Timeline",C.h1a(this.nIh));this.tZ.W("ParagraphMergesCount",this.ezh);this.tZ.W("ParagraphMergeDurations",C.h1a(this.dJd));this.tZ.W("MarkerInfo",C.h1a(this.Wcd.gxi()));this.tZ.W("Result",C.h1a(this.$Am()));return JSON.stringify(C.h1a(this.tZ))}uKa(){return(new Date).getTime()}RJm(){const H=new a.a;let K,R,E;({FIg:K,OPg:R,MIa:E}=this.iLf(this._state,this._state.input.Sca,this._state.input.j1a,this._state.input.cSb));H.W("hasBase",
E?"true":"false");if(E){let L=0,O=0;for(;K&&!K.id.equals(E.id);)L++,K=K.KJ;for(;R&&!R.id.equals(E.id);)O++,R=R.KJ;H.W("lenToBaseTheirs",K?L:-1);H.W("lenToBaseYours",R?O:-1)}return H}iLf(H,K,R,E){H=K.tg(K.length-1-(E?1:0));K=(R=R.tg(R.length-1))&&H?H.KVa(R):null;return{FIg:H,OPg:R,MIa:K}}fDm(){if(!this._state.runtime.cSi)return null;const H=this._state.runtime.zv,K=new a.a(0);H.forEach((R,E)=>{({value:R}=K.Ec(E.wc.toString()));K.W(E.wc.toString(),R+1);return!0});return K}mmm(H,K,R){let E=null,L=null,
O=null;const V=this._state.runtime.zv;let Z=0;try{O=new G.a(this.PC,this._state);E=y.b(H,K,R);L=new w.a;for(H=0;H<E.length;H++)if(!E.K(H).QKb.xt(E.K(H).vAb,(W,P)=>W.equals(P))){const W=this.dgi(E.K(H),O);Z+=W;L.add(E.K(H))}E&&V.forEach((W,P)=>{if(P.wc===m.a.paragraphNode){P=null;for(let S=0;S<E.length;S++)if(!L.contains(E.K(S))&&E.K(S).vAb.contains(W,(aa,Y)=>aa===Y)){P=E.K(S);break}P&&(W=this.dgi(P,O),L.add(P),Z+=W)}return!0});return Z}catch(W){return z.a.instance.Ua(579190992,1,2,"Exception in GetCharactersLost: "+
W.toString()),-1}}n9l(H){let K,R,E,L,O;H.gJ=Z=>{if(750<this.uKa()-this._state.input.d0a)throw z.a.instance.Ua(579190991,1,2,"Timed out while calculating characters lost: {0}",Z),x.a.invalidOperation(Z);};K=new l.a;R=new l.a;E=new l.a;L=new l.a;const V=new l.a;O=new l.a;try{if(H.Kn){const Z=H.Kn.K(F.ChildNodeListMerge.dpe);let W,P;W=H.QA.K(F.ChildNodeListMerge.dpe)||Z;P=H.zv.K(F.ChildNodeListMerge.dpe)||Z;this.wDf(Z,S=>H.Kn.K(S),K,L);this.wDf(W,S=>H.QA.K(S)||H.Kn.K(S),R,V);this.wDf(P,S=>H.zv.K(S)||
H.Kn.K(S),E,O)}}catch(Z){z.a.instance.Ua(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+Z.toString())}return{gdl:K,h7l:R,uup:E,ldl:L,wup:O}}Bim(H,K){try{let E=0;const L=this._state.runtime;var R=Z=>L.zv.K(Z)||L.Kn.K(Z);const O=new w.a,V=this.aam(H,L,R,O);for(H=0;H<V.count;H++){let Z=V.keys.K(H);const W=V.K(Z);if(!O.contains(Z)){let P=this.gIi(L,R,O,Z,W);if(-1!==P)E+=P;else return z.a.instance.Ua(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(R=
0;R<K.length;R++){let Z=K.K(0);if(!O.contains(Z)){let W=this.B9d(L.Kn.K(Z));if(-1===W)return z.a.instance.Ua(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;E+=W}}return E}catch(E){return z.a.instance.Ua(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+E.toString()),-1}}gIi(H,K,R,E,L){H.gJ("GetTableCharactersLost");let O=0;L=this.PC.getPropertyObjectIds(L,f.a.qg);for(let S=0;S<L.length;S++){var V=K(L.K(S));V=this.PC.getPropertyObjectIds(V,f.a.qg);for(let aa=
0;aa<V.length;aa++){var Z=K(V.K(aa));if(H.Kn.K(L.K(S))&&H.Kn.K(V.K(aa))){var W=H.Kn.K(V.K(aa));if(!W)return z.a.instance.Ua(573089737,1,2,"Base cell unexpectedly null"),-1;Z=this.PC.getPropertyObjectIds(W,f.a.qg);var P=H.QA.K(V.K(aa))||H.Kn.K(V.K(aa));P=this.PC.getPropertyObjectIds(P,f.a.qg);W=this.PC.getPropertyObjectIds(W,f.a.qg);Z=y.b(Z,P,W);for(W=0;W<Z.length;W++){P=Z.K(W);const Y=this.FOm(H,K,R,P);if(-1===Y)return z.a.instance.Ua(573089738,1,2,"Error getting characters lost for parition {0}",
P.toString()),-1;O+=Y}}else{W=this.vPm(K,Z,R);if(-1===W)return z.a.instance.Ua(573089736,1,2,"Error getting text length of cell {0}",Z.id.toString()),-1;O+=W}}}R.add(E);return O}FOm(H,K,R,E){let L=0;var O=new l.a,V=new l.a;const Z=new a.a;new a.a;for(var W=0;W<E.QKb.length;W++){var P=H.Kn.K(E.QKb.K(W));P=this.PC.getPropertyObjectIds(P,f.a.aH);if(1!==P.length)return z.a.instance.Ua(573089739,1,2,"Unexpected number of ContentNodes: {0}",P.length),-1;var S=H.Kn.K(P.K(0));S.wc===m.a.paragraphNode?O.add(S):
S.wc===m.a.Ep&&Z.add(P.K(0),S)}for(W=0;W<E.vAb.length;W++){P=K(E.vAb.K(W));P=this.PC.getPropertyObjectIds(P,f.a.aH);if(1!==P.length)return z.a.instance.Ua(573089740,1,2,"Unexpected number of ContentNodes: {0}",P.length),-1;S=K(P.K(0));if(S.wc===m.a.paragraphNode)V.add(S);else if(S.wc===m.a.Ep){S=this.gIi(H,K,R,P.K(0),S);if(-1===S)return z.a.instance.Ua(573089741,1,2,"Error diffing table {0}",P.K(0).toString()),-1;L+=S}}W=new G.a(this.PC,this._state);if(0<O.length&&0<V.length){O=W.loi(O,aa=>H.Kn.K(aa),
V,aa=>K(aa));if(-1===O)return z.a.instance.Ua(573089742,1,2,"Problem diffing parition {0} with LCS",E.toString()),-1;L+=O}else if(0<O.length)for(E=0;E<O.length;E++)L+=this.PC.getPropertyString(O.K(E),f.a.Yn).length+1;else if(0<V.length)for(E=0;E<V.length;E++)L+=this.PC.getPropertyString(V.K(E),f.a.Yn).length+1;for(E=0;E<Z.count;E++)if(O=Z.keys.K(E),!R.contains(O)){V=this.B9d(Z.K(O));if(-1===V)return z.a.instance.Ua(573089743,1,2,"Error getting length of table {0}",O.toString()),-1;L+=V}return L}vPm(H,
K,R){let E=0;K=this.PC.getPropertyObjectIds(K,f.a.qg);for(let V=0;V<K.length;V++){var L=H(K.K(V));L=this.PC.getPropertyObjectIds(L,f.a.aH);if(1!==L.length)return z.a.instance.Ua(573089744,1,2,"Unexpected number of ContentNodes: {0}",L.length),-1;var O=H(L.K(0));if(O.wc===m.a.paragraphNode)E+=this.PC.getPropertyString(O,f.a.Yn).length+1;else if(O.wc===m.a.Ep){O=this.B9d(O);if(-1===O)return z.a.instance.Ua(573089745,1,2,"Problem finding text length of table {0}",L.K(0).toString()),-1;E+=O;R.add(L.K(0))}}return E}B9d(H){this._state.runtime.gJ("GetTextLengthOfTable");
let K=0;const R=Z=>this._state.runtime.zv.K(Z)||this._state.runtime.Kn.K(Z);H=this.PC.getPropertyObjectIds(H,f.a.qg);for(let Z=0;Z<H.length;Z++){var E=R(H.K(Z));E=this.PC.getPropertyObjectIds(E,f.a.qg);for(let W=0;W<E.length;W++){var L=R(E.K(W));L=this.PC.getPropertyObjectIds(L,f.a.qg);for(let P=0;P<L.length;P++){var O=R(L.K(P));O=this.PC.getPropertyObjectIds(O,f.a.aH);if(1!==O.length)return z.a.instance.Ua(573089746,1,2,"Unexpected number of ContentNodes: {0}",O.length),-1;var V=R(O.K(0));if(V.wc===
m.a.paragraphNode)K+=this.PC.getPropertyString(V,f.a.Yn).length+1;else if(V.wc===m.a.Ep){V=this.B9d(V);if(-1===V)return z.a.instance.Ua(573089747,1,2,"Error finding the text length of table {0}",O.K(0)),-1;K+=V}}}}return K}aam(H,K,R,E){const L=new a.a;for(let O=0;O<H.length;O++){let V=!1;K.zv.K(H.K(O))&&(V=!0);const Z=R(H.K(O)),W=this.PC.getPropertyObjectIds(Z,f.a.qg);if(!V)for(let P=0;P<W.length;P++)if(K.zv.K(W.K(P))){V=!0;break}V?L.add(H.K(O),Z):E.add(H.K(O))}return L}dgi(H,K){return this.cgi(H.QKb,
H.vAb,K)}cgi(H,K,R){const E=new l.a;for(var L=0;L<H.length;L++)E.add(this._state.runtime.Kn.K(H.K(L)));H=new l.a;for(L=0;L<K.length;L++)H.add(this._state.runtime.zv.K(K.K(L))||this._state.runtime.Kn.K(K.K(L)));return R.loi(E,O=>this._state.runtime.Kn.K(O),H,O=>this._state.runtime.zv.K(O)||this._state.runtime.Kn.K(O))}wDf(H,K,R,E){if(H.wc===m.a.Vh){H=this.PC.getPropertyObjectIds(H,f.a.qg);for(let L=0;L<H.length;L++){const O=this.PC.getPropertyObjectIds(K(H.K(L)),f.a.qg);for(let V=0;V<O.length;V++){const Z=
this.PC.getPropertyObjectIds(K(O.K(V)),f.a.qg);for(let W=0;W<Z.length;W++){const P=this.PC.getPropertyObjectIds(K(Z.K(W)),f.a.aH);if(1!==P.length)return;const S=K(P.K(0));S.wc===m.a.paragraphNode?R.add(P.K(0)):S.wc===m.a.Ep?E.add(P.K(0)):z.a.instance.Ua(573089748,1,2,"Unsupported class id in GetCharactersLost: "+m.a[S.wc])}}}}}xDf(H,K){H=this.PC.getPropertyObjectIds(H,f.a.qg);const R=new l.a;for(let E=0;E<H.length;E++){const L=this.PC.getPropertyObjectIds(K(H.K(E)),f.a.aH);if(1!==L.length)return null;
R.add(L.K(0))}return R}unm(){let H=0;const K=this._state.runtime,R=K.zv,E=O=>K.zv.K(O)||K.Kn.K(O);let L=null;K.gJ=O=>{if(750<this.uKa()-this._state.input.d0a)throw z.a.instance.Ua(573089749,1,2,"Timed out while calculating comment characters lost: {0}",O),x.a.invalidOperation(O);};try{R.forEach((O,V)=>{if(V.wc===m.a.lL){O=this.xDf(V,E);var Z=K.Kn.K(V.id);if(Z)Z=this.xDf(Z,P=>K.Kn.K(P)),L||(L=new G.a(this.PC,this._state)),H+=this.cgi(Z,O,L);else for(Z=0;Z<O.length;Z++)H+=this.PC.getPropertyString(K.zv.K(O.K(Z)),
f.a.Yn).length+1}if(V.wc===m.a.nka&&(O=this.PC.getPropertyObjectIds(V,f.a.qg).IS(),V=K.Kn.K(V.id)))for(V=this.PC.getPropertyObjectIds(V,f.a.qg),Z=0;Z<V.length;Z++)if(!O.contains(V.K(Z))){var W=K.Kn.K(V.K(Z));W=this.xDf(W,P=>K.Kn.K(P));for(let P=0;P<W.length;P++)H+=this.PC.getPropertyString(K.Kn.K(W.K(P)),f.a.Yn).length+1}return!0})}catch(O){return z.a.instance.Ua(573089750,1,2,"Exception in GetCommentCharactersLost: "+O.toString()),-1}return H}WPb(){return this.H2a?this.H2a.WPb():null}q6d(H){const K=
new l.a;H.forEach(R=>{K.add(C.h1a(R.WPb()));return!0});return K.toArray()}$Am(){const H=new a.a;H.W("Succeeded",this._state.output.succeeded);H.W("Timeout",this._state.output.timeout);H.W("Crash",this._state.output.Qza);H.W("MergedRevisions",this._state.output.bM?this._state.output.bM.length:-1);H.W("Duration",this.rt-this._state.input.d0a);return H}static h1a(H){if(!H)return null;const K={};H.forEach((R,E)=>{K[R.toString()]=E;return!0});return K}}Object(I.a)(C,"MergeLogger",null,[])},1730:function(I,
J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a){this.pPa=a;this.AK=f}}Object(I.a)(m,"UpdateHintCollection",null,[])},1731:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1492);class m extends d.a{constructor(f,a){super();this.Qg=f;this.Zc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Qg,this.Zc)}}Object(I.a)(m,"LcsInsertParaUpdateHint",d.a,[])},1732:function(I,J,d){d.d(J,"a",function(){return f});
I=d(0);var m=d(221);d=d(1492);class f extends d.a{constructor(a){super();this.k3=new m.a;this.cp=a}get type(){return 11}toString(){let a="";for(let l=0;l<this.k3.length;l++)a+=String.format("({0}), ",this.k3.K(l).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(I.a)(f,"LcsInsertUpdateHint",d.a,[])},1733:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1492);class m extends d.a{constructor(f,a){super();this.text=a;this.Qg=f}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",
this.cp,this.type,this.Qg,this.text)}}Object(I.a)(m,"LcsInsertTextUpdateHint",d.a,[])},1734:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1492);class m extends d.a{constructor(f,a,l){super();this.cp=f;this.Qg=a;this.Zc=l}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Qg,this.Zc)}}Object(I.a)(m,"LcsDeleteParaUpdateHint",d.a,[])},1735:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1492);class m extends d.a{constructor(f,
a){super();this.cp=f;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(I.a)(m,"LcsDeleteTextUpdateHint",d.a,[])},1736:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1457);class m extends d.a{constructor(){super()}get mfa(){return"Conflict"}}Object(I.a)(m,"ConflictMergeFailureDetail",d.a,[])},1737:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);d=d(1457);class m extends d.a{constructor(){super()}get mfa(){return"TableMerge"}}
Object(I.a)(m,"TableMergeFailureDetail",d.a,[])},1739:function(I,J,d){d.d(J,"a",function(){return a});I=d(0);var m=d(226),f=d(16);class a{constructor(l,w,z,x,u){this.Q7e=l;this.P7e=w;this.PQk=z;this.fzk=x;this.emh=u}get WZb(){return 4}Bka(l,w=null){w=w.sessionId+"|"+w.jta+"|"+l.NE;if(this.emh||this.fzk){let z=this.emh||f.a.zC(CommonUIStrings.l_HelpTooltip)===f.a.zC(l.NE.trim());if(this.PQk&&2<l.NE.length){const x=l.NE;";"===x.charAt(0)&&";"===x.charAt(x.length-1)&&x.substring(1,x.length-1)===a.eTf&&
(z=!0)}l=z?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.NE);return this.tsi(w,f.a.If(l),z)}return this.tsi(w,f.a.If(String.format(CommonUIStrings.l_TextWithQuotation,l.NE)),!1)}tsi(l,w,z){return m.a(a.eTf,z?this.P7e:this.Q7e,w,"OfficeAssistant_16x16x32","A0",f.a.If(l),w,null,null)}}a.eTf="bSearchHelp";Object(I.a)(a,"AssistanceMenuItemFactory",null,[1819])},1740:function(I,J,d){d.d(J,"a",function(){return w});I=d(0);var m=d(2),f=d(226),a=d(96),l=
d(16);class w{get WZb(){return 13}Bka(){return w.hhl()}static hhl(){return f.b(w.opi,"798637440",l.a.If(CommonUIStrings.l_LookupFirstRunExperienceTitle),m.AFrameworkApplication.Vs,a.getImageClass("Info_32x32x32"),null,null,l.a.If(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,l.a.If(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}w.opi="bTellMeFirstRun";Object(I.a)(w,"FirstRunMenuItemFactory",null,[1819])},1741:function(I,J,d){d.d(J,"a",function(){return m});
I=d(0);class m{}m.uTi="bInsights";Object(I.a)(m,"InsightsMenuItemFactoryStatic",null,[])},1742:function(I,J,d){d.d(J,"a",function(){return l});I=d(0);var m=d(2),f=d(226),a=d(16);class l{constructor(w=null,z=null){this.gwh=w;this.wGk=z||CommonUIStrings.l_LookupNoResultsDescription}get WZb(){return 14}Bka(w){w=String.format(this.wGk,w.NE);return this.Uhl(w)}Uhl(w){return f.b(l.vhj,"798637440",a.a.If(CommonUIStrings.l_LookupNoResultsTitle),this.gwh?m.AFrameworkApplication.Vs:null,this.gwh,null,null,
a.a.If(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.If(w),null,null)}}l.vhj="lookupNoResults";Object(I.a)(l,"NoCommandsFoundMenuItemFactory",null,[1819])},1743:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(f,a){this.FontWeight=0;this.Text=null;this.FontWeight=f;this.Text=a}}Object(I.a)(m,"LabelFormatted",null,[])},1744:function(I,J,d){d.d(J,"a",function(){return z});I=d(0);d(1393);var m=d(1395),f=d(1398),a=d(1397),l=d(1388),w=d(16);class z{constructor(x){this.jc=
x}zN(){return"Assistance"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:this.jc.bgd?3:2}gK(x,u,v=!1,F,y=null){F=new a.a(x);if((!y||Array.contains(y,8))&&!l.a.KU(x)){y=new f.a(8);if(v){v=w.a.zC(CommonUIStrings.l_HelpTooltip)===w.a.zC(x.Wg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,x.Wg);const G=[];this.jc.cbb&&(this.jc.tze||G.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),v=this.TCi(x.Wg));const C=
"||"+x.Wg;G.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",v));G.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",C));appChrome.api.dispatch(G);x=new m.a("GetHelpFromTellMe",4,x.Wg,null,1)}else x=new m.a("bSearchHelp",4,x.Wg,null,1);y.jy(x);y.displayName=CommonUIStrings.l_HelpButtonTitle;F.kw(y)}u.Qt(F)}Mrb(x,u=null){const v=new f.a(8),F=w.a.zC(CommonUIStrings.l_HelpTooltip)===w.a.zC(x.Wg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
x.Wg);for(let G=0;G<u.length&&2>G;G++){var y=[];let C="GetHelpWithDescriptionFromTellMe"+(G+1).toString(),H=4;if(this.jc.epd)y.push(appChrome.actions.setControlLabel(C,F)),y.push(appChrome.actions.setCompoundButtonCommandValueId(C,x.Wg)),y.push(appChrome.actions.updateCompoundButtonDescription(C,this.vPf(u.length)));else if(this.jc.fpd){let K=this.tJi(u[G]);C="GetHelpFromTellMe"+(G+1).toString();this.jc.cbb&&(K=this.TCi(K));H=9;y.push(appChrome.actions.setControlLabel(C,K));y.push(appChrome.actions.setButtonCommandValueId(C,
this.kQm(u[G])))}appChrome.api.dispatch(y);y=new m.a(C,H,null,null,0);y.label=this.tJi(u[G]);y.description=this.jQm(u[G]);v.jy(y);if(this.jc.fpd)break}v.displayName=CommonUIStrings.l_HelpButtonTitle;return v}vPf(x){return 1===x?String.format(CommonUIStrings.l_SearchResultText,x):String.format(CommonUIStrings.l_SearchResultsText,x)}TCi(x){return this.jc.q1f?l.a.lKf(x,CommonUIStrings.l_HelpScopedButtonText):x+CommonUIStrings.l_HelpScopedButtonText}tJi(x){return x.name?x.name:""}jQm(x){return x.description?
x.description:""}kQm(x){return x.id?"AssetID="+x.id:""}}Object(I.a)(z,"AssistanceResultsProvider",null,[1024])},1745:function(I,J,d){d.d(J,"a",function(){return x});I=d(0);d(1393);var m=d(1395),f=d(1398),a=d(1397),l=d(1389),w=d(1388),z=d(1456);class x{constructor(u){this.jc=u}zN(){return"Image"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:3===this.jc.nw?3:2}gK(u,v,F,y,G=null){F=new a.a(u);(!G||Array.contains(G,19))&&w.a.KU(u)&&this.jc.AS&&this.Mrb(u,F,1);v.Qt(F)}Mrb(u,v,F,y=null){var G=[];let C;
l.TellMeActor.instance.HR()&&l.TellMeActor.instance.HR().cbb?(C=this.jc.q1f?w.a.lKf(u.Wg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):u.Wg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.jc.tze||G.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):C=this.jc.AS?w.a.KU(u)?this.jc.Mmb?w.a.Cqb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.jc.Mmb?w.a.Cqb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
u.Wg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,u.Wg):this.jc.Txc?CommonUIStrings.l_TellMeImageSuggestionButtonText:u.Wg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.jc.qBa?(l.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",C)),G=w.a.HUa(u.Wg,9,Object.assign(new z.a,{landingTab:"Image"})),l.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",G))):(G.push(appChrome.actions.setControlLabel("ImageForSearch",
C)),u=w.a.HUa(u.Wg,9,Object.assign(new z.a,{landingTab:"Image"})),G.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",u)),appChrome.api.dispatch(G));F=new m.a("ImageForSearch",12,null,null,F);y&&(F.score=y.ConfidenceScore);y=new f.a(19,this.jc.Txc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);y.jy(F);v.kw(y)}}Object(I.a)(x,"ImageResultsProvider",null,[1024])},1746:function(I,J,d){d.d(J,"a",function(){return z});I=d(0);d(1393);var m=d(1395),f=d(1398),a=d(1397),
l=d(1388),w=d(2);class z{constructor(x){this.jc=x}zN(){return"Template"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:3}gK(x,u){x=new a.a(x);u.Qt(x)}Mrb(x,u,v){var F=[];let y;y=this.jc.AS?this.jc.Mmb?l.a.Cqb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,x.Wg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,x.Wg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,x.Wg);F.push(appChrome.actions.setControlLabel("TemplateForSearch",y));F.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(w.AFrameworkApplication.J.jb("TellMeTemplateProviderURL"),w.AFrameworkApplication.uiCulture,x.Wg)));appChrome.api.dispatch(F);x=new f.a(23);x.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;F=new m.a("TemplateForSearch",24,null,null,0);F.label=v[0].Title?v[0].Title:"";F.description=v[0].Description?v[0].Description:"";x.jy(F);u.kw(x)}}Object(I.a)(z,"TemplateResultsProvider",null,[1024])},1747:function(I,J,d){d.d(J,"a",function(){return v});I=d(0);d(1393);var m=d(1459),f=d(1395),
a=d(1398),l=d(1397),w=d(1599),z=d(1389),x=d(1388),u=d(16);class v{constructor(F,y,G,C){this.R5=F;this.Nlb=y;this.UIh=C;this.Ewk=G;this.jc=z.TellMeActor.instance.HR()}zN(){return"EmptyQuery"}rX(){return 1===this.jc.nw?1:0}gK(F,y,G=!1,C,H=null){C=new l.a(F);if((!H||Array.contains(H,5)||Array.contains(H,6)||Array.contains(H,4))&&x.a.KU(F)){this.R5.M2c().length||!this.Ewk||this.UIh||(F=new a.a(6),H=new f.a(null,13,void 0,void 0,1),F.jy(H),C.kw(F));F=new a.a(4);if(0<this.R5.M2c().length){F.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;H=this.R5.M2c();var K=[];for(var R of H)K.push(R.Id);m.CommandResultsUtility.Ysd(K,this.jc);for(var E of H)m.CommandResultsUtility.S8c(E.Id)&&F.jy(new f.a(E.Id,5,null,null,2));C.kw(F)}if(this.UIh&&0<this.Nlb.length&&this.R5.M2c().length<v.maxResults){R=new a.a(5);R.displayName=CommonUIStrings.l_TellMeTryQueryTitle;E=v.maxResults-F.results.length;F=[];for(H=0;H<this.Nlb.length&&H<E;++H){if(G){K=x.a.LKg+(H+1);const L=this.Nlb[H].key,O=u.a.replaceAll(L,'"',"");
F.push(appChrome.actions.setControlLabel(K,L));F.push(appChrome.actions.setButtonCommandValueId(K,O));K=new w.a(L,7,0,O,K)}else K=new w.a(this.Nlb[H].key,7,0,this.Nlb[H].value);R.jy(K)}0<F.length&&appChrome.api.dispatch(F);C.kw(R)}}y.Qt(C)}}v.maxResults=5;Object(I.a)(v,"EmptyQueryResultsProvider",null,[1024])},1748:function(I,J,d){d.d(J,"a",function(){return m});I=d(0);class m{constructor(){this.kCe=this.LWa=this.isb=this.az=this.jUd=this.LH=this.w3b=0}}Object(I.a)(m,"TRIESCAN",null,[])},1772:function(I,
J,d){d.r(J);var m=d(0),f=d(1393),a=d(1475),l=d(1424),w=d(1395),z=d(1398),x=d(1397),u=d(1389),v=d(1388),F=d(1456);class y{constructor(ob){this.jc=ob}zN(){return"ActionAI"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:2}gK(ob,Lb,fc=!1,Jc,Tc=null){Jc=new x.a(ob);if(!Tc||Array.contains(Tc,24))if(this.H6o()||!v.a.KU(ob)){Tc=new z.a(24);var qd=v.a.KU(ob);fc&&(fc=null,v.a.Hta()&&(fc=v.a.HUa(qd?"":ob.Wg,1,Object.assign(new F.a,{landingTab:"ActionAI"}))),this.jc.qBa?fc&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
fc)):(ob=[],fc&&ob.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",fc)),appChrome.api.dispatch(ob)));Tc.jy(new w.a("ActionAIFromTellMe",25,null,null,1));Jc.kw(Tc)}Lb.Qt(Jc)}H6o(){return v.a.Hta()&&this.jc.sXf}}Object(m.a)(y,"ActionAIResultsProvider",null,[1024]);var G=d(1630);class C{constructor(ob,Lb){this.nFa=ob;this.Gl=Lb}Qt(ob){this.nFa.p_o(this.Gl,ob)}}Object(m.a)(C,"AggregatorResultsProviderCallback",null,[1831]);class H{constructor(ob){this.vwa=null;this.jc=ob;this.jc.JKb&&
(this.vwa=null)}zN(){return"AppsForOffice"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:2}gK(ob,Lb,fc,Jc,Tc=null){fc=new x.a(ob);if(!Tc||Array.contains(Tc,1))Tc=new z.a(1),this.vwa.sVp(Tc,ob.Wg),fc.kw(Tc);Lb.Qt(fc)}}Object(m.a)(H,"AppsForOfficeRecommendationResultsProvider",null,[1024]);var K=d(1744),R=d(1383),E=d(1411),L=d(251);class O{constructor(ob,Lb){this.Bb=ob;this.MJn=Lb}isMatch(ob,Lb){if(!Object(L.a)(1855,ob))throw Error.argument("objToTest","Expected feature bundle");let fc;return({value:fc}=
ob.pr(this.Bb.gza)).returnValue?this.Bb.kOg.isMatch(fc,Lb):this.MJn}}Object(m.a)(O,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1875]);class V{constructor(ob,Lb){this.Bb=ob;this.J7f=Lb}isMatch(ob){if(!Object(L.a)(1855,ob))throw Error.argument("objToTest","Expected feature bundle");return!!(this.J7f^ob.pr(this.Bb.gza).returnValue)}}Object(m.a)(V,"AnnotatedWithAnnotationFilter",null,[1875]);class Z{constructor(ob){this.Bb=ob}isMatch(ob,Lb){if(!Object(L.a)(1858,ob))throw Error.argument("objToTest",
"Expected struct value");return this.Bb.kOg.isMatch(ob.Uqb(this.Bb.uVa),Lb)}}Object(m.a)(Z,"FieldValueMatchesStructFilter",null,[1875]);class W{constructor(ob,Lb){ob&&(this.uVa=ob.K(0),this.kOg=Lb.Csa(ob.K(1)))}}Object(m.a)(W,"FieldValueMatchesStructFilterInit",null,[]);class P{constructor(ob){this.J7f=ob}isMatch(ob){if(!Object(L.a)(1855,ob))throw Error.argument("objToTest","Expected feature bundle");return!!(this.J7f^ob.mSf)}}Object(m.a)(P,"HasAnnotationsAnnotationFilter",null,[1875]);class S{constructor(ob,
Lb){this.Bb=ob;this.Kba=Lb}isMatch(ob,Lb){if(!Object(L.a)(1857,ob))throw Error.argument("objToTest","Expected list value");switch(this.Kba){case 0:for(const fc of ob.items)if(this.Bb.filter.isMatch(fc,Lb))return!0;return!1;case 1:for(const fc of ob.items)if(!this.Bb.filter.isMatch(fc,Lb))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(S,"ItemTestListFilter",null,[1875]);class aa{constructor(ob){this.Bb=ob}isMatch(ob,Lb){if(!Object(L.a)(1857,ob))throw Error.argument("objToTest",
"Expected list value");return this.Bb.filter.isMatch(ob.items.length,Lb)}}Object(m.a)(aa,"LengthMatchesListFilter",null,[1875]);class Y{constructor(ob,Lb){this.Bb=ob;this.Kba=Lb}isMatch(ob,Lb,fc=null){let Jc=0===this.Kba;for(const Tc of this.Bb.i2h)if((Jc=Tc.isMatch(ob,Lb,fc))?1===this.Kba:0===this.Kba)return Jc;2===this.Kba&&(Jc=!Jc);return Jc}}Object(m.a)(Y,"NonterminalFilter",null,[1875]);class X{constructor(ob,Lb){if(ob){var fc=ob.K(0);this.i2h=Array(fc);for(let Jc=0;Jc<fc;++Jc)this.i2h[Jc]=Lb.Csa(ob.K(1+
Jc))}}}Object(m.a)(X,"NonterminalFilterInit",null,[]);class ca{constructor(ob,Lb){this.Bb=ob;this.Kba=Lb}isMatch(ob,Lb){if("number"!==typeof ob)throw Error.argument("objToTest","Expected number value");let fc=this.Bb.number;if(this.Bb.query){Lb=this.Bb.query.Lu(null,Lb);if("number"!==typeof Lb)throw Error.invalidOperation("Query did not return number");fc+=Lb}switch(this.Kba){case 0:return ob===fc;case 1:return ob<fc;case 2:return ob<=fc;case 3:return ob>fc;case 4:return ob>=fc;default:throw Error.notImplemented();
}}}Object(m.a)(ca,"NumberFilter",null,[1875]);class fa{constructor(ob,Lb){ob&&(this.number=ob.K(0),this.query=ob.K(1)?Lb.qN(ob.K(1)):null)}}Object(m.a)(fa,"NumberFilterInit",null,[]);class ja{constructor(ob,Lb,fc){this.r6d=this.Zsm;this.SJn=ob;this.Fbj=Lb;this.Ebj=fc}kof(ob){this.Fbj=ob}Zsm(ob){if(!ob)throw Error.argument("name","Invalid named feature bundle reference");const Lb=ob.substr(1);return 1===ob.charCodeAt(0)&&Lb===this.SJn?this.Fbj:this.Ebj?this.Ebj.r6d(ob):null}}Object(m.a)(ja,"SimpleNamedFeatureBundleResolver",
null,[1890]);class ra{constructor(ob){this.Bb=ob}isMatch(ob,Lb){if(!Object(L.a)(1855,ob))throw Error.argument("objToTest","Expected feature bundle");ob=this.Bb.query.Lu(null,new ja(this.Bb.gGe,ob,Lb));if("boolean"!==typeof ob)throw Error.invalidOperation("Query did not return bool");return ob}}Object(m.a)(ra,"PredicateAnnotationFilter",null,[1875]);class ya{constructor(ob,Lb){ob&&(this.gGe=Lb.rD(ob.K(0)),this.query=Lb.qN(ob.K(1)))}}Object(m.a)(ya,"PredicateAnnotationFilterInit",null,[]);class Ha{constructor(ob){this.Bb=
ob}isMatch(ob,Lb){if("boolean"!==typeof ob)throw Error.argument("objToTest","Expected bool value");Lb=this.Bb.query.Lu(null,Lb);if("boolean"!==typeof Lb)throw Error.invalidOperation("Query did not return bool");return ob===Lb}}Object(m.a)(Ha,"QueryBooleanFilter",null,[1875]);class Wa{constructor(ob,Lb){this.Bb=ob;this.Kba=Lb}isMatch(ob,Lb){if("number"!==typeof ob)throw Error.argument("objToTest","Expected integer");Lb=this.Bb.query.Lu(null,Lb);if("number"!==typeof Lb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.Kba){case 0:return ob===Lb;case 1:return 0!==(ob&Lb);case 2:return ob===(ob&Lb);case 3:return Lb===(ob&Lb);default:throw Error.notImplemented();}}}Object(m.a)(Wa,"QueryEnumFilter",null,[1875]);class Ma{constructor(ob,Lb){ob&&(this.Vee=1===ob.K(0),this.query=Lb.qN(ob.K(1)))}}Object(m.a)(Ma,"QueryEnumFilterInit",null,[]);class ua{constructor(ob,Lb){this.Bb=ob;this.Kba=Lb}isMatch(ob,Lb){if(!Object(L.a)(1857,ob))throw Error.argument("objToTest","Expected list value");Lb=this.Bb.query.Lu(null,
Lb);if(!Object(L.a)(1857,Lb))throw Error.invalidOperation("Query did not return list value");if(ob.b8!==Lb.b8)return!1;switch(this.Kba){case 0:return R.Annotations.QAb(R.Annotations.cAm(ob.b8),ob,Lb);case 1:for(const fc of ob.items)for(const Jc of Lb.items)if(R.Annotations.QAb(ob.b8,fc,Jc))return!0;return!1;case 2:for(const fc of ob.items)for(const Jc of Lb.items)if(!R.Annotations.QAb(ob.b8,fc,Jc))return!1;return!0;case 3:for(const fc of Lb.items)for(const Jc of ob.items)if(!R.Annotations.QAb(ob.b8,
fc,Jc))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(ua,"QueryListFilter",null,[1875]);class Ka{constructor(ob,Lb){this.Bb=ob;this.Kba=Lb}isMatch(ob,Lb){if("string"!==typeof ob)throw Error.argument("objToTest","Expected string");Lb=this.Bb.query.Lu(null,Lb);if("string"!==typeof Lb)throw Error.invalidOperation("Query did not return string");this.Bb.SXf&&(ob=ob.toUpperCase(),Lb=Lb.toUpperCase());switch(this.Kba){case 0:return ob===Lb;case 1:return 0<=ob.indexOf(Lb);case 2:return ob.startsWith(Lb);
case 3:return ob.endsWith(Lb);case 4:return 0<=Lb.indexOf(ob);case 5:return Lb.startsWith(ob);case 6:return Lb.endsWith(ob);default:throw Error.notImplemented();}}}Object(m.a)(Ka,"QueryStringFilter",null,[1875]);class za{constructor(ob,Lb){ob&&(this.query=Lb.qN(ob.K(0)),this.SXf=1===ob.K(1))}}Object(m.a)(za,"QueryStringFilterInit",null,[]);class Fa{constructor(ob){this.Bb=ob}isMatch(ob,Lb){if(!Object(L.a)(1858,ob))throw Error.argument("objToTest","Expected struct value");Lb=this.Bb.query.Lu(null,
Lb);if(!Object(L.a)(1858,Lb))throw Error.invalidOperation("Query did not return struct value");return ob.isEqual(ob)}}Object(m.a)(Fa,"QueryStructFilter",null,[1875]);class ea{constructor(ob){this.Bb=ob}isMatch(ob,Lb){ob=this.Bb.query.Lu(null,Lb);if("boolean"!==typeof ob)throw Error.invalidOperation("Query did not return bool");return ob}}Object(m.a)(ea,"QueryWhereConstraintFilter",null,[1875]);class la{constructor(ob){this.Bb=ob}isMatch(ob){if("string"!==typeof ob)throw Error.argument("objToTest",
"Expected string");return this.Bb.akd.test(ob)}}Object(m.a)(la,"RegexStringFilter",null,[1875]);class Na{constructor(ob,Lb){ob&&(this.akd=Lb.blc(ob.K(0)))}}Object(m.a)(Na,"RegexStringFilterInit",null,[]);class Aa{constructor(ob,Lb){ob&&(this.filter=Lb.Csa(ob.K(0)))}}Object(m.a)(Aa,"SingleFilterFilterInit",null,[]);class wa{constructor(ob,Lb){ob&&(this.query=Lb.qN(ob.K(0)))}}Object(m.a)(wa,"SingleQueryFilterInit",null,[]);class va{constructor(ob){this.Bb=ob}isMatch(ob){if("boolean"!==typeof ob)throw Error.argument("objToTest",
"Expected bool value");return ob===this.Bb.value}}Object(m.a)(va,"StoredValueBooleanFilter",null,[1875]);class Pa{constructor(ob){ob&&(this.value=1===ob.K(0))}}Object(m.a)(Pa,"StoredValueBooleanFilterInit",null,[]);class Ta{constructor(ob,Lb){this.Bb=ob;this.Kba=Lb}isMatch(ob){if("number"!==typeof ob)throw Error.argument("objToTest","Expected integer");switch(this.Kba){case 0:return this.Bb.Vee?this.Bb.value?!!(ob&this.Bb.value):!ob:ob===this.Bb.value;case 1:return this.Bb.Vee?(ob&this.Bb.value)===
this.Bb.value:32>ob&&(1<<ob&this.Bb.value)===this.Bb.value;case 2:return this.Bb.Vee?!!(ob&this.Bb.value):32>ob&&!!(1<<ob&this.Bb.value);default:throw Error.notImplemented();}}}Object(m.a)(Ta,"StoredValueEnumFilter",null,[1875]);class kb{constructor(ob){ob&&(this.Vee=1===ob.K(0),this.value=ob.K(1))}}Object(m.a)(kb,"StoredValueEnumFilterInit",null,[]);class gb{constructor(){this.Lao=null;this.Tmf=this.ZRb=0}}Object(m.a)(gb,"WHEREConstraintData",null,[]);class tb{constructor(ob){this.Bb=ob}isMatch(ob,
Lb){if(!Object(L.a)(gb,ob))throw Error.argument("objToTest","Expected WHERE constraint data");let fc=-1,Jc=-1;const Tc=ob.Lao;switch(this.Bb.Wnf){case 4:fc=Tc.b1c;Jc=Tc.EEg;break;case 5:fc=ob.ZRb;Jc=Tc.b1c-ob.ZRb;break;case 6:fc=Tc.b1c+Tc.EEg;Jc=ob.ZRb+ob.Tmf-fc;break;case 1:case 2:case 3:let qd=!1;for(let Wc=Tc.AXp;Wc;Wc=Wc.next)if(this.Bb.cFp===Wc.name){qd=!0;1===this.Bb.Wnf?(fc=Wc.b1c,Jc=Wc.EEg):2===this.Bb.Wnf?(fc=ob.ZRb,Jc=Wc.b1c-ob.ZRb):(fc=Wc.b1c+Wc.EEg,Jc=ob.ZRb+ob.Tmf-fc);break}if(!qd)return!1;
break;case 7:fc=ob.ZRb;Jc=ob.Tmf;break;default:throw Error.notImplemented();}return null!==this.Bb.aep.y4p(Tc.opq,fc,Jc,fc,!0,2,Lb)}}Object(m.a)(tb,"SubSreWhereConstraintFilter",null,[1875]);class hb{constructor(ob,Lb){if(ob){var fc=Lb.rD(ob.K(0));this.Wnf=fc.charCodeAt(0);this.cFp=fc.substr(1);this.aep=Lb.CKm(ob.K(1))}}}Object(m.a)(hb,"SubSreWhereConstraintFilterInit",null,[]);class Xa{constructor(ob){this.Bb=ob}isMatch(ob,Lb,fc=null){if(!Object(L.a)(1855,ob))throw Error.argument("objToTest","Expected feature bundle");
if(null==fc)throw Error.argumentNull("parentTextForSpan");if(this.Bb.JRh&&!this.Bb.JRh.isMatch(ob,Lb))return!1;if(this.Bb.rIg){let Jc;if(({value:Jc}=ob.pr(this.Bb.Tcp)).returnValue){if(!this.Bb.rIg.isMatch(Jc,Lb))return!1}else{let Tc,qd;if(!({value:Tc}=ob.pr(this.Bb.fXj)).returnValue||!({value:qd}=ob.pr(this.Bb.eXj)).returnValue||0>Tc||0>qd||Tc+qd>fc.length||!this.Bb.rIg.isMatch(fc.substr(Tc,qd),Lb))return!1}}if(this.Bb.ZXj){let Jc;if(!({value:Jc}=ob.pr(this.Bb.fXj)).returnValue||!this.Bb.ZXj.isMatch(Jc,
Lb))return!1}if(this.Bb.a7i){let Jc;if(!({value:Jc}=ob.pr(this.Bb.eXj)).returnValue||!this.Bb.a7i.isMatch(Jc,Lb))return!1}return!0}}Object(m.a)(Xa,"TextSpanFilter",null,[1875]);class $a{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.fXj=ob.K(0),this.eXj=ob.K(1),this.Tcp=ob.K(2),this.rIg=ob.K(3)?Lb.Csa(ob.K(3)):null,this.JRh=ob.K(4)?Lb.Csa(ob.K(4)):null,this.ZXj=ob.K(5)?Lb.Csa(ob.K(5)):null,this.a7i=ob.K(6)?Lb.Csa(ob.K(6)):null)}}Object(m.a)($a,"TextSpanFilterInit",null,[]);class La{constructor(ob,
Lb){ob&&(this.annotations=Lb.annotations,this.gza=ob.K(0),this.kOg=ob.K(1)?Lb.Csa(ob.K(1)):null)}}Object(m.a)(La,"ValueFilterAnnotationFilterInit",null,[]);var bb=d(1434);class Gb{Csa(ob,Lb){const fc=ob.K(0),Jc=new bb.a;Jc.jqb(ob,1,ob.count-1);switch(fc){case 1:return new Y(new X(Jc,Lb),0);case 2:return new Y(new X(Jc,Lb),1);case 3:return new Y(new X(Jc,Lb),2);case 101:return new la(new Na(Jc,Lb));case 103:return new Ka(new za(Jc,Lb),0);case 104:return new Ka(new za(Jc,Lb),1);case 105:return new Ka(new za(Jc,
Lb),2);case 106:return new Ka(new za(Jc,Lb),3);case 107:return new Ka(new za(Jc,Lb),4);case 108:return new Ka(new za(Jc,Lb),5);case 109:return new Ka(new za(Jc,Lb),6);case 201:return new va(new Pa(Jc));case 202:return new Ha(new wa(Jc,Lb));case 301:return new ca(new fa(Jc,Lb),0);case 302:return new ca(new fa(Jc,Lb),1);case 303:return new ca(new fa(Jc,Lb),2);case 304:return new ca(new fa(Jc,Lb),3);case 305:return new ca(new fa(Jc,Lb),4);case 401:return new Ta(new kb(Jc),0);case 402:return new Ta(new kb(Jc),
1);case 403:return new Ta(new kb(Jc),2);case 404:return new Wa(new Ma(Jc,Lb),0);case 405:return new Wa(new Ma(Jc,Lb),1);case 406:return new Wa(new Ma(Jc,Lb),2);case 407:return new Wa(new Ma(Jc,Lb),3);case 501:return new Z(new W(Jc,Lb));case 502:return new Fa(new wa(Jc,Lb));case 601:return new S(new Aa(Jc,Lb),0);case 602:return new S(new Aa(Jc,Lb),1);case 603:return new aa(new Aa(Jc,Lb));case 604:return new ua(new wa(Jc,Lb),0);case 605:return new ua(new wa(Jc,Lb),1);case 606:return new ua(new wa(Jc,
Lb),2);case 607:return new ua(new wa(Jc,Lb),3);case 701:return new P(!1);case 702:return new P(!0);case 703:return new V(new La(Jc,Lb),!1);case 704:return new V(new La(Jc,Lb),!0);case 705:return new O(new La(Jc,Lb),!1);case 706:return new O(new La(Jc,Lb),!0);case 707:return new ra(new ya(Jc,Lb));case 901:return new Xa(new $a(Jc,Lb));case 1002:return new ea(new wa(Jc,Lb));case 1001:return new tb(new hb(Jc,Lb));default:throw Error.argument("initData");}}}Object(m.a)(Gb,"FilterFactory",null,[1854]);
var qb=d(1391);class Sa{constructor(ob){this.Bb=ob}get QF(){return this.Bb.QF}get C8(){return this.Bb.C8}get FBe(){return this.Bb.FBe}get yde(){return this.Bb.yde}load(ob,Lb){return this.Lu(ob,ob?new ja("root",ob,Lb):Lb)}store(ob,Lb,fc){this.Syc(ob,Lb,ob?new ja("root",ob,fc):fc,null)}Lu(ob,Lb){if(!this.yde&&!this.Bb.annotations.Ioc(this.QF,ob))throw Error.argument("input","Input value not of expected type");let fc=this.Bb.rpi;for(;fc;)ob=fc.load(ob,Lb),fc=fc.next;return ob}Syc(ob,Lb,fc,Jc){if(!this.FBe)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.yde&&!this.Bb.annotations.Ioc(this.QF,ob))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Bb.annotations.Ioc(this.C8,Lb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Bb.rpi.store(ob,Lb,fc,Jc)}static n4h(ob,Lb,fc,Jc){if(fc===Jc)return Lb;if(R.Annotations.yK(fc)&&R.Annotations.yK(Jc)){fc=R.Annotations.L9a(fc);Jc=R.Annotations.L9a(Jc);const Tc=new qb.a(ob,Jc);for(const qd of Lb.items)Array.add(Tc.items,Sa.n4h(ob,qd,fc,Jc));return Tc}if(fc===
R.Annotations.gPa){if(Jc===R.Annotations.cwa)return Lb;if(Jc===R.Annotations.Uca)return Lb.toString()}else if(fc===R.Annotations.cwa){if(Jc===R.Annotations.gPa)return Math.floor(Lb);if(Jc===R.Annotations.Uca)return Lb.toString()}else if(fc===R.Annotations.Uca){if(Jc===R.Annotations.gPa)return parseInt(Lb);if(Jc===R.Annotations.cwa)return parseFloat(Lb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(m.a)(Sa,"AnnotationQuery",null,[1878]);class cb{constructor(){this.C8=
this.QF=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}P9a(ob){if(this.next)return{returnValue:this.next,xOa:ob};if(ob){const Lb=ob.F7h;ob=ob.Avj;return{returnValue:Lb,xOa:ob}}return{returnValue:null,xOa:ob}}}Object(m.a)(cb,"AnnotationQueryStep",null,[1893]);class pb extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){Lb=this.Bb.query.Lu(ob,Lb);if(R.Annotations.yK(this.QF)){var fc=R.Annotations.L9a(this.QF);let Tc=new qb.a(this.Bb.annotations,fc);if(R.Annotations.yK(this.Bb.query.C8)){if(ob.items.length!==
Lb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let qd=0,Wc=ob.items.length;qd<Wc;++qd)Array.add(Tc.items,this.sUd(ob.items[qd],Lb.items[qd],fc===R.Annotations.cwa))}else for(var Jc of ob.items)Array.add(Tc.items,this.sUd(Jc,Lb,fc===R.Annotations.cwa));return Tc}if(R.Annotations.yK(this.Bb.query.C8)){Jc=new qb.a(this.Bb.annotations,this.QF);for(fc of Lb.items)Array.add(Jc.items,this.sUd(ob,fc,this.QF===R.Annotations.cwa));return Jc}return this.sUd(ob,
Lb,this.QF===R.Annotations.cwa)}sUd(ob,Lb,fc){ob=this.zec(ob,Lb);return fc?ob:Math.floor(ob)}}Object(m.a)(pb,"NumericAnnotationQueryStep",cb,[]);class vb extends pb{constructor(ob){super(ob)}zec(ob,Lb){return ob+Lb}}Object(m.a)(vb,"AddAnnotationQueryStep",pb,[]);class xb extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){if(this.QF===R.Annotations.NEa&&this.Bb.query.C8===R.Annotations.NEa){let Tc;if(({result:Tc}=this.E_h(ob)).returnValue)return Tc}if(R.Annotations.yK(this.QF)){var fc=new qb.a(this.Bb.annotations,
R.Annotations.NEa);Lb=this.Bb.query.Lu(ob,Lb);if(R.Annotations.yK(this.Bb.query.C8)){if(ob.items.length!==Lb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Tc=0,qd=ob.items.length;Tc<qd;++Tc)Array.add(fc.items,this.AWc(Lb.items[Tc],ob.items[Tc]))}else for(var Jc of ob.items)Array.add(fc.items,this.AWc(Lb,Jc));return fc}Jc=this.Bb.query.Lu(ob,Lb);if(R.Annotations.yK(this.Bb.query.C8)){Lb=new qb.a(this.Bb.annotations,R.Annotations.NEa);for(fc of Jc.items)Array.add(Lb.items,
this.AWc(fc,ob));return Lb}return this.AWc(Jc,ob)}}Object(m.a)(xb,"BinaryBooleanAnnotationQueryStep",cb,[]);class Bb extends xb{constructor(ob){super(ob)}E_h(ob){return{returnValue:!ob,result:!1}}AWc(ob,Lb){return ob&&Lb}}Object(m.a)(Bb,"AndAnnotationQueryStep",xb,[]);class jc{constructor(ob){ob&&(this.annotations=ob)}}Object(m.a)(jc,"AnnotationsOnlyQueryStepInit",null,[]);class xc extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){Lb=this.Bb.query.Lu(ob,Lb);ob=ob.clone();R.Annotations.yK(this.Bb.query.C8)?
Array.addRange(ob.items,Lb.items):Array.add(ob.items,Lb);return ob}}Object(m.a)(xc,"AppendAnnotationQueryStep",cb,[]);class Qc extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){if(this.QF===R.Annotations.HY)return this.g0c(ob,Lb);const fc=new qb.a(this.Bb.annotations,R.Annotations.HY);for(const Jc of ob.items)Array.add(fc.items,this.g0c(Jc,Lb));return fc}g0c(ob,Lb){const fc=new E.a(this.Bb.annotations);fc.s7a(ob);ob=new E.a(this.Bb.annotations);this.Bb.script.mVa(null,new ja("Input",fc,new ja("Output",
ob,Lb)));return ob}}Object(m.a)(Qc,"ApplyAnnotationQueryStep",cb,[]);class fd extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){if(this.QF===R.Annotations.HY)return Lb=this.g0c(ob,Lb),Lb.pr(this.Bb.HRh).returnValue||new qb.a(this.Bb.annotations,R.Annotations.HY),Lb;const fc=new qb.a(this.Bb.annotations,R.Annotations.HY);for(const Jc of ob.items)if(ob=this.g0c(Jc,Lb),({value:ob}=ob.pr(this.Bb.HRh)).returnValue)for(const Tc of ob.items)Array.add(fc.items,Tc);return fc}g0c(ob,Lb){const fc=new E.a(this.Bb.annotations);
fc.s7a(ob);ob=new E.a(this.Bb.annotations);this.Bb.script.mVa(null,new ja("Input",fc,new ja("Output",ob,Lb)));return ob}}Object(m.a)(fd,"ApplyExpandAnnotationQueryStep",cb,[]);class Ac{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.script=Lb.vPb(ob.K(0)),this.HRh=ob.K(1))}}Object(m.a)(Ac,"ApplyExpandQueryStepInit",null,[]);class Nb{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.script=Lb.vPb(ob.K(0)))}}Object(m.a)(Nb,"ApplyQueryStepInit",null,[]);class ib extends cb{constructor(ob){super();
this.Bb=ob}load(ob){if(this.QF===R.Annotations.HY)return this.Yhe(ob);const Lb=new qb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.gza));for(const fc of ob.items)Array.add(Lb.items,this.Yhe(fc));return Lb}store(ob,Lb,fc,Jc){if(this.QF===R.Annotations.HY){var Tc=Lb,qd=({xOa:Jc}=this.P9a(Jc)).returnValue;qd&&(Tc=qd.store(R.Annotations.UW(this.Yhe(ob)),Lb,fc,Jc));ob.kA(this.Bb.gza,Tc)}else{var Wc=Lb;if(Tc=({xOa:Jc}=this.P9a(Jc)).returnValue){Wc=new qb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.gza));
for(qd of ob.items)Array.add(Wc.items,this.Yhe(qd));Wc=Tc.store(Wc,Lb,fc,Jc)}Lb=Wc;if(Lb.items.length!==ob.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let Zd=0,ie=ob.items.length;Zd<ie;++Zd)fc=ob.items[Zd],fc.isReadOnly&&(fc=fc.clone(),ob.items[Zd]=fc),fc.kA(this.Bb.gza,Lb.items[Zd])}return ob}Yhe(ob){({value:ob}=ob.pr(this.Bb.gza)).returnValue||(ob=this.Bb.annotations.zjm(this.Bb.gza));return ob}}Object(m.a)(ib,"AttrAnnotationQueryStep",cb,
[]);class Rb{constructor(ob,Lb){ob&&(this.annotations=Lb,this.gza=ob.K(0))}}Object(m.a)(Rb,"AttrQueryStepInit",null,[]);class ic extends cb{constructor(ob){super();this.Bb=ob}load(ob){const Lb=new E.a(this.Bb.annotations);Lb.s7a(ob);return this.Bb.module.execute(Lb)}}Object(m.a)(ic,"CallModuleAnnotationQueryStep",cb,[]);class kc{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.module=Lb.TLf(ob.K(0)))}}Object(m.a)(kc,"CallModuleQueryStepInit",null,[]);class Jb extends cb{constructor(ob){super();
this.Bb=ob}load(ob,Lb){if(R.Annotations.yK(this.QF)){var fc=this.Bb.query.Lu(ob,Lb);Lb=new qb.a(this.Bb.annotations,R.Annotations.Uca);let qd="string"===typeof fc;for(var Jc of ob.items)if(qd)Array.add(Lb.items,Jc+fc);else for(var Tc of fc.items)Array.add(Lb.items,Jc+Tc);return Lb}Jc=this.Bb.query.Lu(ob,Lb);if("string"===typeof Jc)return ob+Jc;Tc=new qb.a(this.Bb.annotations,R.Annotations.Uca);for(fc of Jc.items)Array.add(Tc.items,ob+fc);return Tc}}Object(m.a)(Jb,"ConcatAnnotationQueryStep",cb,[]);
class ec extends cb{constructor(ob){super();this.Bb=ob}load(ob){return Sa.n4h(this.Bb.annotations,ob,this.QF,this.C8)}}Object(m.a)(ec,"ConvertAnnotationQueryStep",cb,[]);class qa extends cb{constructor(){super()}load(ob){return ob.items.length}}Object(m.a)(qa,"CountAnnotationQueryStep",cb,[]);class sa extends pb{constructor(ob){super(ob)}zec(ob,Lb){return ob/Lb}}Object(m.a)(sa,"DivideAnnotationQueryStep",pb,[]);class ab extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){Lb=new ja(this.Bb.gGe,
null,Lb);for(const fc of ob.items)if(Lb.kof(fc),this.Bb.query.Lu(fc,Lb))return!0;return!1}}Object(m.a)(ab,"ExistsAnnotationQueryStep",cb,[]);class eb extends pb{constructor(ob){super(ob)}zec(ob,Lb){return Math.pow(ob,Lb)}}Object(m.a)(eb,"ExpAnnotationQueryStep",pb,[]);class fb{constructor(ob,Lb){ob&&(this.tVa=Lb.rD(ob.K(0)))}}Object(m.a)(fb,"FeatureBundleNameQueryStepInit",null,[]);class Cb extends cb{constructor(ob){super();this.Bb=ob}load(ob){if(R.Annotations.yK(this.QF)){const Lb=new qb.a(this.Bb.annotations,
this.Bb.annotations.YQb(R.Annotations.L9a(this.QF),this.Bb.uVa));for(const fc of ob.items)Array.add(Lb.items,fc.Uqb(this.Bb.uVa));return Lb}return ob.Uqb(this.Bb.uVa)}store(ob,Lb,fc,Jc){if(R.Annotations.yK(this.QF)){var Tc=Lb,qd=({xOa:Jc}=this.P9a(Jc)).returnValue;if(qd){Tc=new qb.a(this.Bb.annotations,this.Bb.annotations.YQb(R.Annotations.L9a(this.QF),this.Bb.uVa));for(var Wc of ob.items)Array.add(Tc.items,Wc.Uqb(this.Bb.uVa));Tc=qd.store(Tc,Lb,fc,Jc)}Lb=Tc;if(Lb.items.length!==ob.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let Zd=0,ie=ob.items.length;Zd<ie;++Zd)fc=ob.items[Zd],fc.isReadOnly&&(fc=fc.clone(),ob.items[Zd]=fc),fc.Bzg(this.Bb.uVa,Lb.items[Zd])}else qd=Lb,(Wc=({xOa:Jc}=this.P9a(Jc)).returnValue)&&(qd=Wc.store(R.Annotations.UW(ob.Uqb(this.Bb.uVa)),Lb,fc,Jc)),ob.Bzg(this.Bb.uVa,qd);return ob}}Object(m.a)(Cb,"FieldAnnotationQueryStep",cb,[]);class lc{constructor(ob,Lb){ob&&(this.annotations=Lb,this.uVa=ob.K(0))}}Object(m.a)(lc,"FieldQueryStepInit",null,[]);class bc extends cb{constructor(ob){super();this.Bb=
ob}load(ob,Lb){for(const fc of ob.items)if(this.Bb.filter.isMatch(fc,Lb))return fc;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(ob,Lb,fc,Jc){let Tc=Lb,qd=-1;for(let Zd=0,ie=ob.items.length;Zd<ie;Zd++)if(this.Bb.filter.isMatch(ob.items[Zd],fc)){qd=Zd;break}if(0>qd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Wc=({xOa:Jc}=this.P9a(Jc)).returnValue;Wc&&(Tc=Wc.store(R.Annotations.UW(ob.items[qd]),Lb,fc,Jc));
ob.items[qd]=Tc;return ob}}Object(m.a)(bc,"FirstItemMatchingAnnotationQueryStep",cb,[]);class Za extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){Lb=new ja(this.Bb.gGe,null,Lb);for(const fc of ob.items)if(Lb.kof(fc),!this.Bb.query.Lu(fc,Lb))return!1;return!0}}Object(m.a)(Za,"ForAllAnnotationQueryStep",cb,[]);class Ib extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){ob=Lb?Lb.r6d(this.Bb.tVa):null;if(!ob)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.tVa+
'"');return ob}store(ob,Lb,fc,Jc){ob=fc?fc.r6d(this.Bb.tVa):null;if(!ob)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.tVa+'"');let Tc=Lb;const qd=({xOa:Jc}=this.P9a(Jc)).returnValue;qd&&(Tc=qd.store(ob,Lb,fc,Jc));ob!==Tc&&ob.s7a(Tc);return ob}}Object(m.a)(Ib,"GetAnnotationQueryStep",cb,[]);class Ub{constructor(ob,Lb){this.Rsk=ob;this.gKk=Lb}get F7h(){return this.Rsk}get Avj(){return this.gKk}}Object(m.a)(Ub,"AnnotationQueryStoreContinuation",null,[1894]);class rc extends cb{constructor(ob){super();
this.Bb=ob}load(ob,Lb){return this.Bb.DCe.Lu(ob,Lb)?this.Bb.T3j.Lu(ob,Lb):this.Bb.w2d?this.Bb.w2d.Lu(ob,Lb):ob}store(ob,Lb,fc,Jc){var Tc=this.Bb.DCe.Lu(ob,fc);this.next&&(Jc=new Ub(this.next,Jc));if(Tc)return this.Bb.T3j.Syc(ob,Lb,fc,Jc);if(this.Bb.w2d)return this.Bb.w2d.Syc(ob,Lb,fc,Jc);Tc=Lb;let qd=null;Jc&&(qd=Jc.F7h,Jc=Jc.Avj);qd&&(Tc=qd.store(R.Annotations.UW(ob),Lb,fc,Jc));return Tc}}Object(m.a)(rc,"IfAnnotationQueryStep",cb,[]);class yc{constructor(ob,Lb){ob&&(this.DCe=Lb.qN(ob.K(0)),this.T3j=
Lb.qN(ob.K(1)),this.w2d=ob.K(2)?Lb.qN(ob.K(2)):null)}}Object(m.a)(yc,"IfQueryStepInit",null,[]);class rb{constructor(ob,Lb){ob&&(this.h7m=Lb.qN(ob.K(0)),this.S4i=Lb.qN(ob.K(1)))}}Object(m.a)(rb,"IndexAndItemQueryStepInit",null,[]);class $c extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){const fc=this.Bb.h7m.Lu(ob,Lb);Lb=this.Bb.S4i.Lu(ob,Lb);ob=ob.clone();if(0>fc||fc>ob.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(R.Annotations.yK(this.Bb.S4i.C8))for(let Jc=
0;Jc<Lb.items.length;++Jc)Array.insert(ob.items,fc+Jc,Lb.items[Jc]);else Array.insert(ob.items,fc,Lb);return ob}}Object(m.a)($c,"InsertAtAnnotationQueryStep",cb,[]);class cd extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){return!(!Lb||!Lb.r6d(this.Bb.tVa))}}Object(m.a)(cd,"IsDefinedAnnotationQueryStep",cb,[]);class Rd extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){Lb=this.IL(ob,Lb);return ob.items[Lb]}store(ob,Lb,fc,Jc){const Tc=this.IL(ob,fc);let qd=Lb;const Wc=({xOa:Jc}=this.P9a(Jc)).returnValue;
Wc&&(qd=Wc.store(R.Annotations.UW(ob.items[Tc]),Lb,fc,Jc));ob.items[Tc]=qd;return ob}IL(ob,Lb){Lb=this.Bb.query.Lu(ob,Lb);if(0>Lb||Lb>=ob.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Lb}}Object(m.a)(Rd,"ItemAnnotationQueryStep",cb,[]);class ge extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){const fc=new qb.a(this.Bb.annotations,R.Annotations.L9a(this.QF));for(const Jc of ob.items)this.Bb.filter.isMatch(Jc,Lb)&&Array.add(fc.items,Jc);return fc}}
Object(m.a)(ge,"ItemsMatchingAnnotationQueryStep",cb,[]);class Ze extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){Lb=this.IL(ob,Lb);return ob.items[ob.items.length-Lb-1]}store(ob,Lb,fc,Jc){const Tc=this.IL(ob,fc);let qd=Lb;const Wc=({xOa:Jc}=this.P9a(Jc)).returnValue;Wc&&(qd=Wc.store(R.Annotations.UW(ob.items[ob.items.length-Tc-1]),Lb,fc,Jc));ob.items[ob.items.length-Tc-1]=qd;return ob}IL(ob,Lb){Lb=this.Bb.query?this.Bb.query.Lu(ob,Lb):0;if(0>Lb||Lb>=ob.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Lb}}Object(m.a)(Ze,"LastItemAnnotationQueryStep",cb,[]);class De extends cb{constructor(ob){super();this.Bb=ob}load(ob){if(R.Annotations.yK(this.QF)){const Lb=new qb.a(this.Bb.annotations,R.Annotations.gPa);for(const fc of ob.items)Array.add(Lb.items,fc.length);return Lb}return ob.length}}Object(m.a)(De,"LengthAnnotationQueryStep",cb,[]);class Df extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){if(R.Annotations.yK(this.QF)){const fc=new qb.a(this.Bb.annotations,R.Annotations.NEa);
for(const Jc of ob.items)Array.add(fc.items,this.Bb.filter.isMatch(Jc,Lb));return fc}return this.Bb.filter.isMatch(ob,Lb)}}Object(m.a)(Df,"MatchesAnnotationQueryStep",cb,[]);class zd extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){return this.Bb.filter.isMatch(ob,Lb)}}Object(m.a)(zd,"MatchesAsListAnnotationQueryStep",cb,[]);class hg extends pb{constructor(ob){super(ob)}zec(ob,Lb){return ob%Lb}}Object(m.a)(hg,"ModuloAnnotationQueryStep",pb,[]);class ni extends pb{constructor(ob){super(ob)}zec(ob,
Lb){return ob*Lb}}Object(m.a)(ni,"MultiplyAnnotationQueryStep",pb,[]);class Fd extends cb{constructor(ob){super();this.Bb=ob}load(ob){if(R.Annotations.yK(this.QF)){const Lb=new qb.a(this.Bb.annotations,R.Annotations.NEa);for(const fc of ob.items)Array.add(Lb.items,!fc);return Lb}return!ob}}Object(m.a)(Fd,"NotAnnotationQueryStep",cb,[]);class Uc extends xb{constructor(ob){super(ob)}E_h(ob){return{returnValue:ob,result:!0}}AWc(ob,Lb){return ob||Lb}}Object(m.a)(Uc,"OrAnnotationQueryStep",xb,[]);class pd extends cb{constructor(ob){super();
this.Bb=ob}load(ob,Lb){const fc=this.Bb.yFg.Lu(ob,Lb);ob=this.Bb.vXc.Lu(ob,Lb);Lb=new qb.a(this.Bb.annotations,R.Annotations.gPa);for(let Jc=0;Jc<ob;++Jc)Array.add(Lb.items,fc+Jc);return Lb}}Object(m.a)(pd,"RangeAnnotationQueryStep",cb,[]);class He{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.filter=Lb.Csa(ob.K(0)))}}Object(m.a)(He,"SingleFilterQueryStepInit",null,[]);class rf{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.query=ob.K(0)?Lb.qN(ob.K(0)):null)}}Object(m.a)(rf,
"SingleOptionalQueryQueryStepInit",null,[]);class Rf{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.query=Lb.qN(ob.K(0)))}}Object(m.a)(Rf,"SingleQueryQueryStepInit",null,[]);class kd{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.yFg=Lb.qN(ob.K(0)),this.vXc=ob.K(1)?Lb.qN(ob.K(1)):null)}}Object(m.a)(kd,"StartAndCountOrLengthQueryStepInit",null,[]);class ff extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){let fc;({startIndex:Lb,length:fc}=this.d9d(ob,Lb));const Jc=
new qb.a(this.Bb.annotations,ob.b8);for(let Tc=0;Tc<fc;++Tc)Array.add(Jc.items,ob.items[Lb+Tc]);return Jc}store(ob,Lb,fc,Jc){let Tc,qd;({startIndex:Tc,length:qd}=this.d9d(ob,fc));var Wc=Lb;const Zd=({xOa:Jc}=this.P9a(Jc)).returnValue;if(Zd){Wc=new qb.a(this.Bb.annotations,ob.b8);for(let ie=0;ie<qd;++ie)Array.add(Wc.items,ob.items[Tc+ie]);Wc=Zd.store(Wc,Lb,fc,Jc)}Lb=Wc;for(fc=0;fc<qd;++fc)Array.removeAt(ob.items,Tc);for(let ie=0,vf=Lb.items.length;ie<vf;++ie)Array.insert(ob.items,Tc+ie,Lb.items[ie]);
return ob}d9d(ob,Lb){let fc;fc=this.Bb.yFg.Lu(ob,Lb);if(0>fc)throw Error.invalidOperation("Invalid start index in Sublist() query step");Lb=this.Bb.vXc?this.Bb.vXc.Lu(ob,Lb):ob.items.length-fc;if(0>Lb||fc+Lb>ob.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:fc,length:Lb}}}Object(m.a)(ff,"SublistAnnotationQueryStep",cb,[]);class Te extends cb{constructor(ob){super();this.Bb=ob}load(ob,Lb){if(R.Annotations.yK(this.QF)){const fc=
new qb.a(this.Bb.annotations,R.Annotations.Uca);for(let Jc=0,Tc=ob.items.length;Jc<Tc;++Jc)Array.add(fc.items,this.UHi(ob.items[Jc],Lb));return fc}return this.UHi(ob,Lb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}UHi(ob,Lb){let fc;({startIndex:Lb,length:fc}=this.d9d(ob,Lb));return ob.substr(Lb,fc)}d9d(ob,Lb){let fc;fc=this.Bb.yFg.Lu(ob,Lb);if(0>fc)throw Error.invalidOperation("Invalid start index in Substring() query step");Lb=this.Bb.vXc?this.Bb.vXc.Lu(ob,
Lb):ob.length-fc;if(0>Lb||fc+Lb>ob.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:fc,length:Lb}}}Object(m.a)(Te,"SubstringAnnotationQueryStep",cb,[]);class xe extends pb{constructor(ob){super(ob)}zec(ob,Lb){return ob-Lb}}Object(m.a)(xe,"SubtractAnnotationQueryStep",pb,[]);class jf extends cb{constructor(ob){super();this.Bb=ob}load(ob){const Lb=new qb.a(this.Bb.annotations,R.Annotations.Uca);for(let fc=0;fc<ob.length;++fc)Array.add(Lb.items,
ob.charAt(fc).toString());return Lb}}Object(m.a)(jf,"ToCharListAnnotationQueryStep",cb,[]);class Gg extends cb{constructor(ob){super();this.Bb=ob}load(ob){const Lb=new qb.a(this.Bb.annotations,this.QF);Array.add(Lb.items,ob);return Lb}}Object(m.a)(Gg,"ToListAnnotationQueryStep",cb,[]);class ng extends cb{constructor(ob){super();this.Bb=ob}load(){return this.Bb.value}}Object(m.a)(ng,"ValueAnnotationQueryStep",cb,[]);class pg{constructor(ob,Lb){if(ob){var fc=ob.K(0),Jc=1;this.value=({Nla:Jc}=Lb.SUa(fc,
ob,Jc,null,null,null)).returnValue;R.Annotations.iVb(this.value)}}}Object(m.a)(pg,"ValueQueryStepInit",null,[]);class dh{constructor(ob,Lb){ob&&(this.gGe=Lb.rD(ob.K(0)),this.query=Lb.qN(ob.K(1)))}}Object(m.a)(dh,"VarNameAndQueryQueryStepInit",null,[]);class Hg{constructor(ob,Lb){this.nih=null;if(ob){this.annotations=Lb.annotations;var fc=0;this.QF=ob.K(fc);++fc;this.C8=ob.K(fc);++fc;this.FBe=1===ob.K(fc);++fc;this.yde=1===ob.K(fc);++fc;var Jc=ob.K(fc);++fc;if(Jc){var Tc=fc,qd=fc+Jc,Wc=fc+2*Jc;fc+=
3*Jc;var Zd=ob.count-fc,ie=null;for(let vg=0;vg<Jc;++vg){var vf=fc+ob.K(Wc+vg);const Ch=(vg===Jc-1?Zd:ob.K(Wc+vg+1))-ob.K(Wc+vg),ek=new bb.a;ek.jqb(ob,vf,Ch);vf=Hg.sCm(ob.K(qd+vg),ek,Lb);vf.QF=ob.K(Tc+vg);vf.C8=vg===Jc-1?this.C8:ob.K(Tc+vg+1);ie?ie.next=vf:this.nih=vf;ie=vf}}}}get rpi(){return this.nih}static sCm(ob,Lb,fc){switch(ob){case 1:return new Ib(new fb(Lb,fc));case 2:return new cd(new fb(Lb,fc));case 3:return new ib(new Rb(Lb,fc.annotations));case 4:return new Cb(new lc(Lb,fc.annotations));
case 5:return new rc(new yc(Lb,fc));case 6:return new Df(new He(Lb,fc));case 43:return new zd(new He(Lb,fc));case 45:return new Qc(new Nb(Lb,fc));case 49:return new fd(new Ac(Lb,fc));case 46:return new ng(new pg(Lb,fc.annotations));case 51:return new ic(new kc(Lb,fc));case 52:return new pd(new kd(Lb,fc));case 53:return new ec(new jc(fc.annotations));case 13:return new Rd(new Rf(Lb,fc));case 14:return new Ze(new rf(Lb,fc));case 15:return new qa;case 18:return new bc(new He(Lb,fc));case 16:return new Za(new dh(Lb,
fc));case 17:return new ab(new dh(Lb,fc));case 22:return new $c(new rb(Lb,fc));case 24:return new xc(new Rf(Lb,fc));case 26:return new ff(new kd(Lb,fc));case 27:return new ge(new He(Lb,fc));case 30:return new Gg(new jc(fc.annotations));case 31:return new Te(new kd(Lb,fc));case 32:return new Jb(new Rf(Lb,fc));case 47:return new De(new jc(fc.annotations));case 48:return new jf(new jc(fc.annotations));case 34:return new vb(new Rf(Lb,fc));case 35:return new xe(new Rf(Lb,fc));case 36:return new ni(new Rf(Lb,
fc));case 37:return new sa(new Rf(Lb,fc));case 38:return new hg(new Rf(Lb,fc));case 39:return new eb(new Rf(Lb,fc));case 40:return new Bb(new Rf(Lb,fc));case 41:return new Uc(new Rf(Lb,fc));case 42:return new Fd(new jc(fc.annotations));default:throw Error.argument("currStepInitData");}}}Object(m.a)(Hg,"AnnotationQueryInit",null,[]);class Zj{constructor(ob){this.Bb=ob}execute(ob,Lb){this.mVa(ob,ob?new ja("root",ob,Lb):Lb)}mVa(ob,Lb){for(const fc of this.Bb.commands)Lb=fc.execute(ob,Lb)}}Object(m.a)(Zj,
"AnnotationScript",null,[1877]);class nh{constructor(ob){this.Bb=ob}execute(ob,Lb){const fc=this.Bb.Man.Lu(ob,Lb),Jc=this.Bb.t9n.Lu(ob,Lb);this.Bb.script.mVa(ob,new ja("Input",fc,new ja("Output",Jc,Lb)));return Lb}}Object(m.a)(nh,"ApplyAnnotationScriptCommand",null,[1891]);class eh{constructor(ob,Lb){ob&&(this.Man=Lb.qN(ob.K(0)),this.t9n=Lb.qN(ob.K(1)),this.script=Lb.vPb(ob.K(2)))}}Object(m.a)(eh,"ApplyScriptCommandInit",null,[]);class xf{constructor(ob){this.Bb=ob}execute(ob,Lb){const fc=this.Bb.Fwg.Lu(ob,
Lb);this.Bb.Oie.Syc(ob,fc,Lb,null);return Lb}}Object(m.a)(xf,"AssignAnnotationScriptCommand",null,[1891]);class Ig{constructor(ob){this.Bb=ob}execute(ob,Lb){const fc=this.Bb.Oie.Lu(ob,Lb);ob=this.Bb.Fwg.Lu(ob,Lb);fc!==ob&&fc.s7a(ob);return Lb}}Object(m.a)(Ig,"CopyAnnotationScriptCommand",null,[1891]);class Mj{constructor(ob){this.Bb=ob}execute(ob,Lb){let fc=this.Bb.F4f.Lu(ob,Lb);if(this.Bb.F4f.FBe){fc=R.Annotations.UW(fc);var Jc=new ja(this.Bb.tVa,null,Lb);for(let qd=0,Wc=fc.items.length;qd<Wc;++qd){var Tc=
this.Vli(ob,fc.items[qd],Jc);if(0>this.Bb.jve)fc.items[qd]=Tc;else if(({value:Tc}=Tc.pr(this.Bb.jve)).returnValue)fc.items[qd]=Tc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Bb.F4f.Syc(ob,fc,Lb,null)}else{Jc=new ja(this.Bb.tVa,null,Lb);for(let qd=0,Wc=fc.items.length;qd<Wc;++qd)this.Vli(ob,fc.items[qd],Jc)}return Lb}Vli(ob,Lb,fc){let Jc;0>this.Bb.jve?Jc=R.Annotations.UW(Lb):(Jc=new E.a(this.Bb.annotations),Jc.kA(this.Bb.jve,Lb));fc.kof(Jc);
this.Bb.Fel.mVa(ob,fc);return Jc}}Object(m.a)(Mj,"EnumerateAnnotationScriptCommand",null,[1891]);class If{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.tVa=Lb.rD(ob.K(0)),this.F4f=Lb.qN(ob.K(1)),this.Fel=Lb.vPb(ob.K(2)),this.jve=ob.K(3))}}Object(m.a)(If,"EnumerateScriptCommandInit",null,[]);class $b{constructor(ob){this.Bb=ob}execute(ob,Lb){this.Bb.DCe.Lu(ob,Lb)?this.Bb.Wqp.mVa(ob,Lb):this.Bb.$mi&&this.Bb.$mi.mVa(ob,Lb);return Lb}}Object(m.a)($b,"IfAnnotationScriptCommand",null,[1891]);
class wc{constructor(ob,Lb){ob&&(this.DCe=Lb.qN(ob.K(0)),this.Wqp=Lb.vPb(ob.K(1)),this.$mi=ob.K(2)?Lb.vPb(ob.K(2)):null)}}Object(m.a)(wc,"IfScriptCommandInit",null,[]);class ed{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.Oie=Lb.qN(ob.K(0)),this.Fwg=Lb.qN(ob.K(1)))}}Object(m.a)(ed,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Dd{constructor(ob){this.Bb=ob}execute(ob,Lb){const fc=this.Bb.Fwg.Lu(this.Bb.Oie.Lu(ob,Lb),Lb);this.Bb.Oie.Syc(ob,fc,Lb,null);return Lb}}Object(m.a)(Dd,
"ModifyAnnotationScriptCommand",null,[1891]);class ee{constructor(ob){this.Bb=ob}execute(ob,Lb){const fc=new E.a(this.Bb.annotations);this.Bb.query&&fc.s7a(this.Bb.query.Lu(ob,Lb));return Lb=new ja(this.Bb.tVa,fc,Lb)}}Object(m.a)(ee,"NewAnnotationScriptCommand",null,[1891]);class me{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.tVa=Lb.rD(ob.K(0)),this.query=ob.K(1)?Lb.qN(ob.K(1)):null)}}Object(m.a)(me,"NewScriptCommandInit",null,[]);class Nf{constructor(ob){this.Bb=ob}execute(ob,Lb){ob=
this.Bb.query.Lu(ob,Lb);if(this.Bb.query.C8===R.Annotations.HY)ob.YZa(this.Bb.gza);else for(const fc of ob.items)fc.YZa(this.Bb.gza);return Lb}}Object(m.a)(Nf,"RemoveAnnotationScriptCommand",null,[1891]);class Tf{constructor(ob,Lb){ob&&(this.annotations=Lb.annotations,this.query=Lb.qN(ob.K(0)),this.gza=ob.K(1))}}Object(m.a)(Tf,"RemoveScriptCommandInit",null,[]);class oi{constructor(ob,Lb){if(ob){var fc=0,Jc=ob.K(fc);++fc;if(Jc){var Tc=fc,qd=fc+Jc;fc+=2*Jc;var Wc=ob.count-fc;this.commands=Array(Jc);
for(let Zd=0;Zd<Jc;++Zd){const ie=fc+ob.K(qd+Zd),vf=(Zd===Jc-1?Wc:ob.K(qd+Zd+1))-ob.K(qd+Zd),vg=new bb.a;vg.jqb(ob,ie,vf);this.commands[Zd]=oi.iCm(ob.K(Tc+Zd),vg,Lb)}}}}static iCm(ob,Lb,fc){switch(ob){case 1:return new xf(new ed(Lb,fc));case 2:return new Dd(new ed(Lb,fc));case 3:return new Nf(new Tf(Lb,fc));case 6:return new ee(new me(Lb,fc));case 7:return new Mj(new If(Lb,fc));case 8:return new $b(new wc(Lb,fc));case 9:return new Ig(new ed(Lb,fc));case 10:return new nh(new eh(Lb,fc));default:throw Error.argument("initData");
}}}Object(m.a)(oi,"AnnotationScriptInit",null,[]);var Ie=d(1628);class ag{constructor(ob){this.e5=ob;this.Bz=0}kca(){const ob=this.e5.hA(this.Bz,4);this.Bz+=4;return ob}get $ja(){return this.e5}get offset(){return this.Bz}set offset(ob){this.Bz=ob}}Object(m.a)(ag,"ByteArrayReader",null,[]);class uf{constructor(){this.aM=null;this.Kbj=this.uga=0}K(ob){if(0>ob||ob>=this.uga)throw Error.argumentOutOfRange("index");return this.aM.hA(this.Kbj+4*ob,4)}get count(){return this.uga}static hHl(ob,Lb,fc){const Jc=
new uf;Jc.aM=ob;Jc.Kbj=Lb;Jc.uga=fc;return Jc}}Object(m.a)(uf,"ReadOnlyListOverByteArray",null,[1872]);class Pe{constructor(ob,Lb){this.Dbj=this.Cbj=!1;this.Kx=this.pYa=this.y7f=this.Gbj=null;try{this.Kx=Lb.annotations;const fc=Lb.Gqb(ob.K(0)),Jc=new ag(fc);if(-914743053!==Jc.kca())throw Error.argument("Input does not represent a flat lexicon");this.Cbj=1===Jc.kca();this.Dbj=1===Jc.kca();const Tc=Jc.kca();Jc.offset+=Tc;const qd=Jc.kca();this.y7f=Pe.Qao(Jc,qd,this.Kx);const Wc=Jc.kca();this.Gbj=Pe.gbo(Jc,
Wc);const Zd=Jc.kca();this.pYa=new Ie.a(Jc.$ja,Jc.offset);Jc.offset+=Zd}catch(fc){throw Error.argument("initData");}}get trie(){return this.pYa}Glm(ob){return"i"===ob&&this.Dbj?"\u0130":ob.toUpperCase()}SXf(){return this.Cbj}Kim(ob){let Lb;Lb=new qb.a(this.Kx,R.Annotations.HY);if(1!==ob)if(0===ob)ob=new E.a(this.Kx),Array.add(Lb.items,ob);else if(ob&1073741824){ob=this.Gbj[ob&-1073741825];for(let Jc=0;Jc<ob.length;++Jc){var fc=ob[Jc];fc=0===fc?new E.a(this.Kx):this.y7f[fc-2];Array.add(Lb.items,fc)}}else Array.add(Lb.items,
this.y7f[ob-2]);return{returnValue:!0,mBn:Lb}}static Qao(ob,Lb,fc){if(Lb%4)throw Error.argument("reader");const Jc=uf.hHl(ob.$ja,ob.offset,Lb/4);ob.offset+=Lb;ob=[];for(Lb=0;Lb<Jc.count;){const Tc=({Nla:Lb}=fc.SUa(R.Annotations.HY,Jc,Lb,null,null,null)).returnValue;Array.add(ob,Tc)}return ob}static gbo(ob,Lb){Lb=ob.offset+Lb;const fc=[];for(;ob.offset<Lb;){const Jc=ob.kca(),Tc=Array(Jc);for(let qd=0;qd<Jc;++qd){const Wc=ob.kca();Tc[qd]=Wc}Array.add(fc,Tc)}return fc}}Object(m.a)(Pe,"RawFlatLexicon",
null,[1876]);var Db=d(1600),Vb=d(1601);class Nc{constructor(ob){if(null==ob)throw Error.argumentNull("base64String");const Lb=ob.length;if(Lb%4)throw Error.argument("base64String's length must be a multiple of 4");this.uga=.75*Lb;this.yVb=Array(Math.ceil(this.uga/4));ob.endsWith("==")?this.uga-=2:ob.endsWith("=")&&--this.uga;let fc=0;for(let Jc=0;Jc<Lb;Jc+=4){const Tc=Nc.Xve[ob.charCodeAt(Jc)-43]<<18|Nc.Xve[ob.charCodeAt(Jc+1)-43]<<12|Nc.Xve[ob.charCodeAt(Jc+2)-43]<<6|Nc.Xve[ob.charCodeAt(Jc+3)-43];
let qd=Tc>>16&255;this.yVb[Math.floor(fc/4)]|=qd<<fc%4*8;++fc;qd=Tc>>8&255;this.yVb[Math.floor(fc/4)]|=qd<<fc%4*8;++fc;qd=Tc&255;this.yVb[Math.floor(fc/4)]|=qd<<fc%4*8;++fc}}get length(){return this.uga}K(ob){if(0>ob||ob>=this.uga)throw Error.argumentOutOfRange("i");return this.sui(ob)}hA(ob,Lb){if(0>ob||0>Lb||ob+Lb>this.uga)throw Error.argument("Bad range");let fc=0;for(let Jc=0;Jc<Lb;++Jc)fc|=this.sui(ob+Jc)<<8*Jc;return fc}Dqo(ob,Lb){let fc=0,Jc=0,Tc=Math.floor(ob/8);for(ob%=8;Jc<Lb;){const qd=
8-ob>Lb-Jc?Lb-Jc:8-ob,Wc=this.K(Tc);fc|=(Wc>>ob&~(255<<qd))<<Jc;Jc+=qd;++Tc;ob=0}return fc}sui(ob){return this.yVb[Math.floor(ob/4)]>>ob%4*8&255}}Nc.Xve=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(m.a)(Nc,"ByteArray",null,[]);class td{constructor(ob,Lb,fc){this.ZF=ob;this.OJn=Lb;this.RJn=fc;this.Sbj=Array(ob.b?ob.b.length:
0);this.W7f=new Db.a(new Vb.a(this.Gqb(this.ZF.s)));this.Iba=Array(ob.t.length);this.XD=new R.Annotations(this.Bqb(0),this)}get annotations(){return this.XD}get kZl(){return this.ZF.d}zBm(){if(!(""in this.ZF.m))throw Error.argument("name","Unrecognized module");return this.TLf(this.ZF.m[""])}Gqb(ob){if(0>ob||!this.ZF.b||ob>=this.ZF.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.Sbj[ob]||(this.Sbj[ob]=new Nc(this.ZF.b[ob]))}rD(ob){if(1>ob||ob>=this.ZF.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.ZF.t[ob])throw Error.argument("blobID","Requested blob is not a string");if(null==this.Iba[ob]){const Lb=this.Bqb(ob).K(0);this.Iba[ob]=this.W7f.rD(Lb)}return this.Iba[ob]}blc(ob){if(1>ob||ob>=this.ZF.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.ZF.t[ob])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.Iba[ob]){var Lb=this.Bqb(ob);const fc=this.rD(Lb.K(0));Lb=1===Lb.K(1);this.Iba[ob]=new RegExp(fc,Lb?"i":"")}return this.Iba[ob]}CKm(ob){if(1>ob||
ob>=this.ZF.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.ZF.t[ob])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}TLf(ob){if(1>ob||ob>=this.ZF.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.ZF.t[ob])throw Error.argument("blobID","Requested blob is not an NL module");return this.Iba[ob]||(this.Iba[ob]=this.RJn.WBm(this.Bqb(ob),this))}qN(ob){if(1>ob||ob>=this.ZF.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.ZF.t[ob])throw Error.argument("blobID",
"Requested blob is not an annotation query");return this.Iba[ob]||(this.Iba[ob]=new Sa(new Hg(this.Bqb(ob),this)))}vPb(ob){if(1>ob||ob>=this.ZF.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.ZF.t[ob])throw Error.argument("blobID","Requested blob is not an annotation script");return this.Iba[ob]||(this.Iba[ob]=new Zj(new oi(this.Bqb(ob),this)))}Csa(ob){if(1>ob||ob>=this.ZF.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.ZF.t[ob])throw Error.argument("blobID","Requested blob is not a filter");
return this.Iba[ob]||(this.Iba[ob]=this.OJn.Csa(this.Bqb(ob),this))}NIm(ob){if(1>ob||ob>=this.ZF.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.ZF.t[ob])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.Iba[ob]||(this.Iba[ob]=new Pe(this.Bqb(ob),this))}Bqb(ob){const Lb=this.ZF.n[ob];ob=(ob<this.ZF.t.length-1?this.ZF.n[ob+1]:this.ZF.n.length)-Lb;if(0>Lb||0>ob||Lb+ob>this.ZF.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+
Lb+","+ob+")");const fc=new bb.a;fc.LFf(this.ZF.n,Lb,ob);return fc}}Object(m.a)(td,"ObjectFetcher",null,[1853]);class Ke{constructor(ob,Lb,fc){if(!ob)throw Error.argumentNull("prediction");if(!Lb)throw Error.argumentNull("fieldNames");if(!fc)throw Error.argumentNull("values");if(Lb.length!==fc.length)throw Error.argument("values","fieldNames and values do not have same length");this.WJk=ob;this.zVb=Lb;this.Lcd=fc}get prediction(){return this.WJk}get Cni(){return this.zVb.length}OJf(ob){return 0<=
ob&&ob<this.zVb.length?this.zVb[ob]:null}getValue(ob){return 0<=ob&&ob<this.Lcd.length?this.Lcd[ob]:null}}Object(m.a)(Ke,"PredictionData",null,[]);class sf{constructor(ob,Lb){if(!ob)throw Error.argumentNull("predictions");if(!Lb)throw Error.argumentNull("tokenAttributes");this.UJn=ob;this.YJn=Lb}aNf(){return this.UJn}hti(){return this.YJn}}Object(m.a)(sf,"PredictionDataWithTokenAttributes",null,[]);class qh{constructor(ob,Lb){this.prediction=null;this.score=0;this.prediction=ob;this.score=Lb}}Object(m.a)(qh,
"PredictionWithScore",null,[]);class Ef{constructor(ob,Lb){if(!ob)throw Error.argumentNull("predictions");if(!Lb)throw Error.argumentNull("attributes");this.XJk=ob;this.bpk=Lb}aNf(){return this.XJk}hti(){return this.bpk}}Object(m.a)(Ef,"PredictionsWithTokenAttributes",null,[]);class jg{constructor(ob,Lb,fc){if(!ob)throw Error.argumentNull("attributeName");if(!Lb)throw Error.argumentNull("fieldNames");if(!fc)throw Error.argumentNull("values");if(Lb.length!==fc.length)throw Error.argument("values",
"fieldNames and values do not have same length");this.apk=ob;this.zVb=Lb;this.Lcd=fc}get attributeName(){return this.apk}get Cni(){return this.zVb.length}OJf(ob){return 0<=ob&&ob<this.zVb.length?this.zVb[ob]:null}getValue(ob){return 0<=ob&&ob<this.Lcd.length?this.Lcd[ob]:null}}Object(m.a)(jg,"TokenAttributes",null,[]);var Fi=d(108),hf=d(137);class Ph{constructor(ob,Lb,fc,Jc,Tc){this.Vud=0;this.SPg=null;this.Wud=this.fCc=0;this.jHe=this.G3b=this.rwa=this.gCc=null;this.TPg=0;this.x1e=this.YD=null;this._state=
-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.OV=ob;this.Adk=this.Edk=Lb;this.zdk=this.Cdk=fc;this.Tud=this.Bdk=Jc;this.Uud=this.Ddk=Tc}Fdk(){this.Wud=0;return this.QPg}QPg(){if(!(this.Wud<this.Tud))return this.RPg;this.gCc=this.Adk.items[this.Wud+this.zdk];this.rwa=new E.a(this.OV.Bb.annotations);1!==this.Tud&&this.OV.Bb.O8c||this.rwa.s7a(this.gCc);if(0<=this.OV.Bb.Hke){({value:this.G3b}=this.rwa.pr(this.OV.Bb.Hke)).returnValue?this.G3b=
this.G3b.UW():this.G3b=new qb.a(this.OV.Bb.annotations,R.Annotations.HY);this.jHe=this.Uud.items;this.TPg=this.jHe.length;for(this.Vud=0;this.Vud<this.TPg;++this.Vud)this.SPg=this.jHe[this.Vud],Array.add(this.G3b.items,this.SPg);this.rwa.kA(this.OV.Bb.Hke,this.G3b)}else 0<=this.OV.Bb.sEg?this.rwa.kA(this.OV.Bb.sEg,this.Uud.items[0]):0<=this.OV.Bb.glf?this.rwa.kA(this.OV.Bb.glf,!0):this.OV.Bb.n0i?this.Uud.items[0].h4d((ob,Lb)=>this.rwa.kA(ob,Lb)):(this.rwa.s7a(this.Uud.items[0]),1!==this.Tud&&this.OV.Bb.O8c||
(({value:this.fCc}=this.gCc.pr(this.OV.Bb.w6)).returnValue&&this.rwa.kA(this.OV.Bb.w6,this.fCc),({value:this.fCc}=this.gCc.pr(this.OV.Bb.Z$)).returnValue&&this.rwa.kA(this.OV.Bb.Z$,this.fCc),this.gCc.pr(this.OV.Bb.Pmb).returnValue&&this.rwa.kA(this.OV.Bb.Pmb,this.fCc)));this.YD=this.rwa;this._state=2;return this.Hdk}RPg(){this._state=3}Gdk(){this.Wud++;return this.QPg}Hdk(){return 1<this.Tud&&this.OV.Bb.O8c?this.RPg:this.Gdk}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Ph(this.OV,
this.Edk,this.Cdk,this.Bdk,this.Ddk)).getEnumerator()}[Symbol.iterator](){return Object(hf.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.x1e=this.Fdk());for(;1===this._state;)this.x1e=this.x1e();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.YD}}Object(m.a)(Ph,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[11,17,41]);class mg{constructor(ob,Lb,fc){this.Icd=this.Lbj=0;this.trc=null;this.X7f=this.E7f=this.qrc=this.Vie=this.H7f=0;this.Wie=!1;this.R7f=ob;this.Z7f=Lb;this.TJn=fc}CCi(){null===this.trc&&({O0j:this.trc,RPi:this.H7f,length:this.Vie,I6l:ob}=this.R7f.qJi(this.Z7f.items[this.Icd],this.TJn),this.Wie=ob||this.Wie);if(this.qrc<this.Vie){var ob=this.trc.charAt(this.H7f+this.qrc);++this.qrc;return{returnValue:!0,ch:ob}}if(this.Icd===this.Z7f.items.length-1)return{returnValue:!1,ch:"\x00"};++this.Icd;
this.qrc=0;this.trc=null;return{returnValue:!0,ch:" "}}Jrg(ob,Lb){this.qrc===this.Vie&&this.trc&&(this.X7f=Lb,this.E7f=this.Icd-this.Lbj+1)}GIo(ob){if(0>ob||ob>=this.Z7f.items.length)throw Error.argumentOutOfRange("iToken");this.Icd=this.Lbj=ob;this.trc=null;this.E7f=this.qrc=this.Vie=this.H7f=0;this.X7f=-1;this.Wie=!1}xAm(){return{Ejl:this.E7f,syn:this.X7f,H6l:this.Wie}}}Object(m.a)(mg,"TriePrefixVisitor",null,[1887]);class el{constructor(ob){this.Bb=ob}execute(ob){if(!({value:fc}=ob.pr(this.Bb.TTa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Lb;({value:Lb}=ob.pr(this.Bb.t6a)).returnValue||(Lb=null);var fc=this.Phm(fc,Lb);ob=R.Annotations.UW(ob);ob.kA(this.Bb.TTa,fc);return ob}Phm(ob,Lb){let fc=null;const Jc=this.Bb.flatLexicon.trie,Tc=new mg(this,ob,Lb);let qd=null;this.Bb.flatLexicon.SXf()&&(qd=Object(Fi.a)(this.Bb.flatLexicon,this.Bb.flatLexicon.Glm,"getCaseInsensitiveForm"));let Wc=0,Zd;var ie;let vf;for(;Wc<ob.items.length;){const vg=ob.items[Wc];Tc.GIo(Wc);Jc.sbk(Tc,qd);({Ejl:Zd,syn:ie,H6l:vf}=Tc.xAm());if(0<Zd){({mBn:ie}=this.Bb.flatLexicon.Kim(ie));
for(let Ch of this.iJl(ob,Wc,Zd,ie)){1<Zd&&this.Bb.O8c&&this.dKl(ob,Lb,Wc,vg,Zd,vf,Ch);if(!fc)for(fc=new qb.a(this.Bb.annotations,R.Annotations.HY),ie=0;ie<Wc;++ie)Array.add(fc.items,ob.items[ie]);Array.add(fc.items,Ch)}Wc+=Zd}else fc&&Array.add(fc.items,vg),++Wc}return fc||ob}dKl(ob,Lb,fc,Jc,Tc,qd,Wc){if(qd)qd=!0;else if(this.Bb.W_i){qd=!1;var Zd=-1;for(var ie=0;ie<Tc;ie++){var vf=ob.items[fc+ie];let dj;var vg=void 0;if(!({value:dj}=vf.pr(this.Bb.w6)).returnValue||!({value:vg}=vf.pr(this.Bb.Z$)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<ie){if(dj>Zd+1){qd=!0;break}if(0>Zd||null===Lb||Zd>=Lb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Lb.charAt(Zd)){qd=!0;break}}Zd=dj+vg}}else qd=!1;if(qd){vg=new Sys.StringBuilder;for(qd=0;qd<Tc;++qd)({O0j:Zd,RPi:ie,length:vf}=this.qJi(ob.items[fc+qd],Lb)),0<qd&&vg.append(" "),vg.append(Zd.substr(ie,vf));Wc.kA(this.Bb.Pmb,vg.toString())}ob=ob.items[fc+Tc-1];let Ch,ek;({value:Jc}=Jc.pr(this.Bb.w6)).returnValue&&
({value:Ch}=ob.pr(this.Bb.w6)).returnValue&&({value:ek}=ob.pr(this.Bb.Z$)).returnValue?(Wc.kA(this.Bb.w6,Jc),Wc.kA(this.Bb.Z$,Ch+ek-Jc)):(Wc.YZa(this.Bb.w6),Wc.YZa(this.Bb.Z$))}iJl(ob,Lb,fc,Jc){return new Ph(this,ob,Lb,fc,Jc)}qJi(ob,Lb){let fc,Jc;if(({value:fc}=ob.pr(this.Bb.Pmb)).returnValue)Jc=!0,Lb=0,ob=fc.length;else{Jc=!1;if(null===Lb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");fc=Lb;if(!({value:Lb}=ob.pr(this.Bb.w6)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:ob}=ob.pr(this.Bb.Z$)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Lb||0>ob||Lb+ob>fc.length)throw Error.argument("Token start/length values out of range","token");}return{O0j:fc,RPi:Lb,length:ob,I6l:Jc}}}Object(m.a)(el,"FlatLexiconNLModule",null,[1873]);class Tg{constructor(ob,Lb){this.glf=this.Hke=this.sEg=this.Pmb=this.Z$=this.w6=this.t6a=this.TTa=0;this.n0i=this.W_i=this.O8c=!1;this.flatLexicon=null;this.annotations=Lb.annotations;
let fc=0;try{this.TTa=ob.K(fc),++fc,this.t6a=ob.K(fc),++fc,this.w6=ob.K(fc),++fc,this.Z$=ob.K(fc),++fc,this.Pmb=ob.K(fc),++fc,this.sEg=ob.K(fc),++fc,this.Hke=ob.K(fc),++fc,this.glf=ob.K(fc),++fc,this.O8c=1===ob.K(fc),++fc,this.W_i=1===ob.K(fc),++fc,this.n0i=1===ob.K(fc),++fc,this.flatLexicon=Lb.NIm(ob.K(fc))}catch(Jc){throw Error.argument("initData");}}}Object(m.a)(Tg,"FlatLexiconNLModuleInit",null,[]);class jh{constructor(){this.O6c=0;this.uDf=null;this.Mmd=0}}Object(m.a)(jh,"FeatureGenStackRec",
null,[]);class xg{constructor(ob){this.qJg=Array(ob);this.kAc=Array(ob);this.WFg=[];this.mZj=[]}}Object(m.a)(xg,"TokenStringLattice",null,[]);const Of=(ob,Lb,fc)=>{for(let Jc=0;Jc<ob.length;Jc++)fc=Lb(fc,ob[Jc]);return fc},Zh=(ob,Lb)=>{const fc=Array(ob.length);for(let Jc=0;Jc<ob.length;Jc++)fc[Jc]=Lb(ob[Jc]);return fc},Ei=(ob,Lb)=>{Lb=Array(Math.min(Lb,ob.length));for(let fc=0;fc<Lb.length;fc++)Lb[fc]=ob[fc];return Lb},Pf=(ob,Lb)=>{const fc=[];for(const Jc of ob)Lb(Jc)&&Array.add(fc,Jc);return fc};
class Gi{constructor(ob,Lb){this.key=ob;this.value=Lb}}Object(m.a)(Gi,"KeyValuePair",null,[]);const Xk=(ob,Lb)=>({returnValue:Lb in ob,value:ob[Lb]}),Sf=ob=>{const Lb=[];for(let fc in ob){const Jc=new Gi(fc,ob[fc]);Array.add(Lb,Jc)}return Lb};class Pi{constructor(ob){this.pJi=this.ZPm;this.Bb=ob;this.Zie=this.O7f=this.P7f=0;for(const Lb of this.Bb.D2d)this.P7f=Math.max(this.P7f,Lb.Zlg),this.O7f=Math.max(this.O7f,Lb.Tlg),this.Zie=Math.max(this.Zie,Lb.dzb.length)}get d9l(){return this.Bb.vDe.trie}execute(ob){if(!ob)throw Error.argumentNull("input");
let Lb,fc;({tokens:Lb,Ezn:fc}=this.$Pm(ob));let Jc=null,Tc=null,qd={};if(this.Bb.u9c){Lb=R.Annotations.UW(Lb);for(var Wc=0;Wc<Lb.items.length;++Wc)Lb.items[Wc]=R.Annotations.UW(Lb.items[Wc])}else({hni:Tc,returnValue:Jc}=this.rDi(ob,qd));Wc=Array(this.Zie);const Zd=Array(this.Zie);for(var ie=0;ie<Zd.length;++ie)Zd[ie]=new jh;for(ie=-this.P7f;ie<Lb.items.length+this.O7f;++ie){let vf=null;this.Bb.u9c&&(vf=Lb.items[ie],qd={},{hni:Tc,returnValue:Jc}=this.rDi(vf,qd));for(const vg of this.Bb.D2d){if(0>ie&&
-ie>vg.Zlg||ie>=Lb.items.length&&ie-Lb.items.length+1>vg.Tlg)continue;let Ch=!0;for(let ek=0;ek<vg.dzb.length;++ek){const dj=ie+vg.dzb[ek];Wc[ek]=dj;if(0>dj?0>this.Bb.$lg:dj>=Lb.items.length?0>this.Bb.Ulg:!fc.kAc[dj]){Ch=!1;break}}Ch&&({uNl:Jc,vNl:Tc}=this.Ddn(vg,fc,Jc,Tc,qd,Zd,Wc))}this.Bb.u9c&&(vf.kA(this.Bb.uab?this.Bb.Mdc:this.Bb.Kdc,Jc),this.Bb.uab&&vf.kA(this.Bb.Ldc,Tc))}ob=R.Annotations.UW(ob);this.Bb.u9c?ob.kA(this.Bb.TTa,Lb):(ob.kA(this.Bb.uab?this.Bb.Mdc:this.Bb.Kdc,Jc),this.Bb.uab&&ob.kA(this.Bb.Ldc,
Tc));return ob}$Pm(ob){let Lb,fc;if(!ob||!({value:Lb}=ob.pr(this.Bb.TTa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Jc;({value:Jc}=ob.pr(this.Bb.t6a)).returnValue||(Jc="");fc=new xg(Lb.items.length);const Tc=Pf(this.Bb.tJg,qd=>!qd.T7c||qd.T7c.isMatch(ob,null));for(let qd=0;qd<Lb.items.length;++qd){const Wc=Lb.items[qd];let Zd=null;fc.qJg[qd]=fc.WFg.length;let ie=fc.kAc[qd]=0;for(const vf of Tc)0<vf.Zcd&&fc.kAc[qd]+ie>=vf.Zcd||vf.tokenFilter&&!vf.tokenFilter.isMatch(Wc,
null)||({Urd:Zd,MUc:ie}=vf.apply(this,Wc,qd,fc,Jc,Zd,ie))}return{tokens:Lb,Ezn:fc}}Ddn(ob,Lb,fc,Jc,Tc,qd,Wc){let Zd=0;qd[0].O6c=-1;for(qd[0].uDf=ob.LIj;;){var ie=Wc[Zd],vf=0>ie||ie>=Lb.kAc.length?1:Lb.kAc[ie];let ek=!1;for(;qd[Zd].O6c<vf-1;){++qd[Zd].O6c;var vg=void 0,Ch=void 0;0>ie?(vg=this.Bb.$lg,Ch=1):ie>=Lb.qJg.length?(vg=this.Bb.Ulg,Ch=1):(Ch=Lb.qJg[ie]+qd[Zd].O6c,vg=Lb.WFg[Ch],Ch=Lb.mZj[Ch]);qd[Zd].Mmd=Ch*(Zd?qd[Zd-1].Mmd:ob.score);if(({value:vg}=Xk(qd[Zd].uDf,vg.toString())).returnValue){Zd===
ob.dzb.length-1?(ie=vg,qd[Zd].Mmd&&(({value:vf}=Xk(Tc,ie.toString())).returnValue||(vf=-1),0>vf&&(fc=R.Annotations.UW(fc),Array.add(fc.items,ie)),this.Bb.uab&&(Jc=R.Annotations.UW(Jc),0>vf?Array.add(Jc.items,qd[Zd].Mmd):Jc.items[vf]+=qd[Zd].Mmd),0>vf&&(this.Bb.X3i||this.Bb.uab)&&(Tc[ie.toString()]=fc.items.length-1))):(++Zd,qd[Zd].O6c=-1,qd[Zd].uDf=vg);ek=!0;break}}if(!ek&&(--Zd,0>Zd))break}return{uNl:fc,vNl:Jc}}rDi(ob,Lb){let fc;if(({value:fc}=ob.pr(this.Bb.uab?this.Bb.Mdc:this.Bb.Kdc)).returnValue)for(let Jc=
0;Jc<fc.items.length;++Jc)Lb[fc.items[Jc].toString()]=Jc;else fc=new qb.a(this.Bb.annotations,R.Annotations.gPa);if(this.Bb.uab){if(({value:Lb}=ob.pr(this.Bb.Ldc)).returnValue||(Lb=new qb.a(this.Bb.annotations,R.Annotations.cwa)),Lb.items.length!==fc.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Bb.annotations.jia(R.Annotations.HY,ob));}else Lb=null;return{returnValue:fc,hni:Lb}}get bop(){return this.Bb.vDe}ZPm(ob,
Lb){var fc;if(({value:fc}=Lb.pr(this.Bb.Pmb)).returnValue)ob=fc;else{if(!({value:fc}=Lb.pr(this.Bb.w6)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Lb}=Lb.pr(this.Bb.Z$)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>fc||0>Lb||fc+Lb>ob.length)throw Error.argument("Token indices are out of range");ob=ob.substr(fc,Lb)}return ob}}Object(m.a)(Pi,"NGramNLModule",null,[1873,1874]);class El{constructor(ob){this.dzb=null;this.score=this.Tlg=this.Zlg=
0;this.LIj=null;if(ob){var Lb=0;try{if(ob.K(Lb)!==El.wLb)throw Error.argument("initData","Input does not represent a feature template");++Lb;const fc=ob.K(Lb);++Lb;this.dzb=Array(fc);for(let Jc=0;Jc<fc;++Jc)this.dzb[Jc]=ob.K(Lb),++Lb;this.Zlg=ob.K(Lb);++Lb;this.Tlg=ob.K(Lb);++Lb;this.score=ob.K(Lb);++Lb;this.LIj=({LPi:Lb}=El.lzj(ob,Lb)).returnValue}catch(fc){throw Error.argument("initData");}}}static lzj(ob,Lb){const fc=ob.K(Lb);++Lb;const Jc={};for(let Tc=0;Tc<fc;++Tc){const qd=ob.K(Lb);++Lb;ob.K(Lb)?
Jc[qd.toString()]=({LPi:Lb}=El.lzj(ob,Lb)).returnValue:(++Lb,Jc[qd.toString()]=ob.K(Lb),++Lb)}return{returnValue:Jc,LPi:Lb}}}El.wLb=240803228;Object(m.a)(El,"FeatureTemplate",null,[1888]);var Kh=d(1542);class Vi{constructor(ob,Lb){this.uab=this.X3i=this.u9c=!1;this.Pmb=this.Z$=this.w6=this.TTa=this.t6a=this.Ldc=this.Mdc=this.Kdc=0;this.vDe=null;this.Ulg=this.$lg=0;this.D2d=this.tJg=null;if(ob){this.annotations=Lb.annotations;var fc=0;try{this.u9c=1===ob.K(fc);++fc;this.X3i=1===ob.K(fc);++fc;this.uab=
1===ob.K(fc);++fc;this.Kdc=ob.K(fc);++fc;this.Mdc=ob.K(fc);++fc;this.Ldc=ob.K(fc);++fc;this.t6a=ob.K(fc);++fc;this.TTa=ob.K(fc);++fc;this.w6=ob.K(fc);++fc;this.Z$=ob.K(fc);++fc;this.Pmb=ob.K(fc);++fc;this.vDe=this.Ebo(Lb.Gqb(ob.K(fc)));++fc;this.$lg=ob.K(fc);++fc;this.Ulg=ob.K(fc);++fc;const Jc=ob.K(fc);++fc;this.tJg=Array(Jc);for(let qd=0;qd<Jc;++qd){const Wc=ob.K(fc);++fc;const Zd=this.vDe.trie,ie=new bb.a;ie.jqb(ob,fc,Wc);this.tJg[qd]=this.Ibo(ie,Lb,Zd);fc+=Wc}const Tc=ob.K(fc);++fc;this.D2d=Array(Tc);
for(Lb=0;Lb<Tc;++Lb){const qd=ob.K(fc);++fc;const Wc=new bb.a;Wc.jqb(ob,fc,qd);this.D2d[Lb]=this.hbo(Wc);fc+=qd}}catch(Jc){throw Error.argument("initData");}}}Ebo(ob){return new Db.a(new Vb.a(ob))}Ibo(ob,Lb,fc){return Kh.a.create(ob,Lb,fc)}hbo(ob){return new El(ob)}}Object(m.a)(Vi,"NGramNLModuleInit",null,[]);class Bj{constructor(ob){this.Bb=ob}execute(ob){if(!ob)throw Error.argumentNull("input");ob=ob.clone();this.Bb.script.execute(ob,null);return ob}}Object(m.a)(Bj,"ScriptNLModule",null,[1873]);
class ci{constructor(ob,Lb){ob&&(this.script=Lb.vPb(ob.K(0)))}}Object(m.a)(ci,"ScriptNLModuleInit",null,[]);const Mg=ob=>{ob=Zh(ob,Lb=>Lb*Lb);return Math.sqrt(Of(ob,(Lb,fc)=>Lb+fc,0))},ij=ob=>Of(ob,(Lb,fc)=>Lb>fc?Lb:fc,ob[0]);class fl{constructor(ob){this.Bb=ob}execute(ob){if(!ob)throw Error.argumentNull("input");var Lb=[],fc=[];this.Wvl(ob,Lb,fc);this.l4k(Lb,fc);const Jc={};for(let qd=0;qd<Lb.length;++qd){var Tc=Lb[qd];const Wc=this.Bb.YTi.K(Tc);Tc=this.Bb.ZTi.K(Tc);for(let Zd=0;Zd<Tc;++Zd){const ie=
this.Bb.naa.K(this.Bb.t2h.K(Wc+Zd)),vf=this.Bb.u2h.K(Wc+Zd);let vg;({value:vg}=Xk(Jc,ie)).returnValue||(vg=0);Jc[ie]=vg+fc[qd]*vf}}fc=Sf(Jc);fc.sort((qd,Wc)=>{var Zd=qd.value,ie=Wc.value;(Zd=-(Zd>ie?1:Zd<ie?-1:0))||(Zd=qd.key.localeCompare(Wc.key));return Zd});Lb=new qb.a(this.Bb.annotations,R.Annotations.HY);for(const qd of Ei(fc,this.Bb.wMn))fc=new E.a(this.Bb.annotations),fc.kA(this.Bb.Dbl,qd.key),fc.kA(this.Bb.Fbl,qd.value),Array.add(Lb.items,fc);ob.kA(this.Bb.Ebl,Lb);return ob}Wvl(ob,Lb,fc){if(({value:ob}=
ob.pr(this.Bb.Cbl)).returnValue){let Jc;if(({value:Jc}=ob.pr(this.Bb.Mdc)).returnValue){let Tc;if(!({value:Tc}=ob.pr(this.Bb.Ldc)).returnValue||Jc.items.length!==Tc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.yWd(Jc,Tc,Lb,fc)}if(({value:Jc}=ob.pr(this.Bb.Hbl)).returnValue){let Tc;if(!({value:Tc}=ob.pr(this.Bb.Ibl)).returnValue||Jc.items.length!==Tc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.yWd(Jc,Tc,Lb,fc)}({value:Jc}=ob.pr(this.Bb.Kdc)).returnValue&&this.yWd(Jc,null,Lb,fc);({value:Jc}=ob.pr(this.Bb.Gbl)).returnValue&&this.yWd(Jc,null,Lb,fc)}}yWd(ob,Lb,fc,Jc){for(let qd=0;qd<ob.items.length;++qd){var Tc=void 0;ob.b8===R.Annotations.Uca?({value:Tc}=Xk(this.Bb.Bii,ob.items[qd])).returnValue||(Tc=-1):(Tc=ob.items[qd],Tc=Tc>=this.Bb.z9f&&Tc<=this.Bb.YMn?this.Bb.Acg?this.Bb.Acg.K(Tc-this.Bb.z9f)-1:Tc-this.Bb.z9f:-1);if(0<=Tc){let Wc;Wc=Lb?Lb.items[qd]:1;0<Wc&&(Array.add(fc,Tc),Array.add(Jc,
Wc))}}}l4k(ob,Lb){if(ob.length){switch(this.Bb.gmo){case 0:break;case 1:for(var fc=0;fc<Lb.length;++fc)Lb[fc]=1+Math.log(Lb[fc]);break;case 2:fc=ij(Lb);for(let Jc=0;Jc<Lb.length;++Jc)Lb[Jc]=.5+Lb[Jc]/fc*.5;break;case 3:for(fc=0;fc<Lb.length;++fc)Lb[fc]=1;break;default:throw Error.notImplemented();}if(this.Bb.vce)for(fc=0;fc<Lb.length;++fc)Lb[fc]*=this.Bb.vce.K(ob[fc]);ob=Mg(Lb);for(fc=0;fc<Lb.length;++fc)Lb[fc]/=ob}}}Object(m.a)(fl,"TfIdfRankerNLModule",null,[1873]);class Mi{constructor(ob,Lb=0){if(!ob)throw Error.argumentNull("byteArray");
this.$ie=Lb;if(604662927!==ob.hA(this.$ie+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Qk=ob.hA(this.$ie+4,4);this.ubj=ob.hA(this.$ie+8,4);this.HJn=ob}K(ob){if(0>ob||ob>=this.count)throw Error.argumentOutOfRange("index");return this.HJn.Dqo(8*this.$ie+96+ob*this.ubj,this.ubj)}get count(){return this.Qk}}Object(m.a)(Mi,"CompactIntArray",null,[1872]);const dk=(ob,Lb)=>{Lb=Array(Lb);for(let qd=0;qd<Lb.length;qd++){var fc=qd,Jc=ob.kca(),Tc=1===(Jc>>31&1)?
-1:1;const Wc=Jc&8388607;Jc=Jc>>23&255;256===Jc+1?Tc=Wc?Number.NaN:1===Tc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Jc?(Jc-=127,Tc=Tc*zg(Wc,1)*Math.pow(2,Jc)):Tc=Tc*zg(Wc,0)*Math.pow(2,-126);Lb[fc]=Tc}return Lb},zg=(ob,Lb)=>{let fc=0;for(let Jc=0;23>Jc;Jc++)fc+=(ob>>22-Jc&1)/Math.pow(2,Jc+1);return Lb+fc};class Gf{constructor(ob,Lb){this.Acg=null;this.uij=0;this.ZTi=this.YTi=this.vce=null;this.tij=0;this.u2h=this.t2h=null;this.annotations=Lb.annotations;let fc=0;this.Gbl=ob.K(fc);++fc;this.Kdc=
ob.K(fc);++fc;this.Hbl=ob.K(fc);++fc;this.Ibl=ob.K(fc);++fc;this.Mdc=ob.K(fc);++fc;this.Ldc=ob.K(fc);++fc;this.Cbl=ob.K(fc);++fc;this.Ebl=ob.K(fc);++fc;this.Dbl=ob.K(fc);++fc;this.Fbl=ob.K(fc);++fc;var Jc=ob.K(fc);++fc;var Tc=Array(Jc);for(var qd=0;qd<Jc;++qd)Tc[qd]=Lb.rD(ob.K(fc)),++fc;this.naa=bb.a.luf(Tc);this.wMn=ob.K(fc);++fc;this.gmo=ob.K(fc);++fc;Jc=ob.K(fc);++fc;this.Bii={};for(Tc=0;Tc<Jc;++Tc){qd=Lb.rD(ob.K(fc));++fc;const Wc=ob.K(fc);++fc;this.Bii[qd]=Wc}this.z9f=ob.K(fc);++fc;this.YMn=
ob.K(fc);++fc;Jc=ob.K(fc);++fc;0<Jc&&(Jc=Lb.Gqb(ob.K(fc)),++fc,this.Acg=this.Gpe(new ag(Jc)));++fc;ob=Lb.Gqb(ob.K(fc));this.qbo(ob)}Gpe(ob){return new Mi(ob.$ja,ob.offset)}qbo(ob){try{const Lb=new ag(ob);this.uij=Lb.kca();1===Lb.kca()?this.vce=bb.a.luf(dk(Lb,this.uij)):this.vce=null;const fc=Lb.kca();this.YTi=this.Gpe(Lb);Lb.offset+=fc;const Jc=Lb.kca();this.ZTi=this.Gpe(Lb);Lb.offset+=Jc;this.tij=Lb.kca();const Tc=Lb.kca();this.t2h=this.Gpe(Lb);Lb.offset+=Tc;this.u2h=bb.a.luf(dk(Lb,this.tij))}catch(Lb){throw Error.argument("byteReader");
}}}Object(m.a)(Gf,"TfIdfRankerNLModuleInit",null,[]);class Ag{constructor(ob,Lb,fc,Jc){this.Vjg=ob;this.gpi=fc;this.tokens=Jc;this.Jra=Lb;this.Vwc=-1;this.Owe=0}}Object(m.a)(Ag,"TokenizerData",null,[]);class Ti{constructor(ob){this.Bb=ob}execute(ob){if(!ob)throw Error.argumentNull("input");if(!({value:Jc}=ob.pr(this.Bb.t6a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Lb;({value:Lb}=ob.pr(this.Bb.w6)).returnValue||(Lb=0);let fc;({value:fc}=
ob.pr(this.Bb.Z$)).returnValue||(fc=Jc.length-Lb);if(0>Lb||Lb>Jc.length)throw Error.argument("input","Start index out of range");if(0>fc||fc>Jc.length)throw Error.argument("input","Length out of range");if(Lb+fc>Jc.length)throw Error.argument("input","Bad start-length range");var Jc=new Ag(Jc,Lb,Lb+fc,new qb.a(this.Bb.annotations,R.Annotations.HY));this.cop(Jc);ob=ob.isReadOnly?ob.clone():ob;ob.kA(this.Bb.TTa,Jc.tokens);return ob}cop(ob){for(;ob.Jra<ob.gpi;){if(this.Bb.FQf){var Lb=this.Bb.FQf.Waj(ob.Vjg,
ob.Jra,ob.gpi-ob.Jra,null);!Lb.succeeded&&Lb.jhj&&(Lb=Lb.jhj);if(Lb.succeeded){this.smj(ob,Lb.length,this.Bb.NLi);ob.Jra+=Lb.length;continue}}Lb=ob.Vjg.substr(ob.Jra);let fc=-1,Jc=-1,Tc=-1;for(let qd=0;qd<this.Bb.Mve.length;++qd){const Wc=this.Bb.Mve[qd].exec(Lb);Wc&&0<Wc[1].length&&(0>fc||Wc[0].length>Jc)&&(fc=qd,Jc=Wc[0].length,Tc=Wc[1].length)}0<=fc?(this.smj(ob,Tc,this.Bb.Awg[fc]),ob.Jra+=Tc):ob.Jra+=1}}smj(ob,Lb,fc){if(this.Bb.f2i)fc!==Ti.Njl&&(0>ob.Vwc&&(ob.Vwc=ob.Jra),ob.Owe=ob.Jra+Lb-ob.Vwc,
fc===Ti.Mjl&&(0<=ob.Vwc&&0<ob.Owe&&(Lb=new E.a(this.Bb.annotations),Lb.kA(this.Bb.w6,ob.Vwc),Lb.kA(this.Bb.Z$,ob.Owe),Lb.kA(this.Bb.Ujf,Ti.Ojl),Lb.kA(this.Bb.t6a,ob.Vjg),Array.add(ob.tokens.items,Lb)),ob.Vwc=-1,ob.Owe=0));else{let Jc=new E.a(this.Bb.annotations);Jc.kA(this.Bb.w6,ob.Jra);Jc.kA(this.Bb.Z$,Lb);Jc.kA(this.Bb.Ujf,fc);Array.add(ob.tokens.items,Jc)}}}Ti.Njl="GAP";Ti.Mjl="EOS_CHUNK";Ti.Ojl="SENTENCE";Object(m.a)(Ti,"TokenizerNLModule",null,[1873]);class em{constructor(ob,Lb){this.Z$=this.w6=
this.Ujf=this.TTa=this.t6a=0;this.f2i=!1;this.Awg=this.Mve=this.NLi=this.FQf=null;if(ob){this.annotations=Lb.annotations;var fc=0;try{this.t6a=ob.K(fc);++fc;this.TTa=ob.K(fc);++fc;this.Ujf=ob.K(fc);++fc;this.w6=ob.K(fc);++fc;this.Z$=ob.K(fc);++fc;this.f2i=1===ob.K(fc);++fc;var Jc=ob.K(fc);++fc;0<Jc&&(this.FQf=Lb.TLf(Jc).d9l);this.NLi=ob.K(fc)?Lb.rD(ob.K(fc)):"";++fc;const Tc=ob.K(fc);++fc;this.Mve=Array(Tc);this.Awg=Array(Tc);for(Jc=0;Jc<Tc;++Jc)this.Mve[Jc]=new RegExp(Lb.rD(ob.K(fc))),++fc,this.Awg[Jc]=
Lb.rD(ob.K(fc)),++fc}catch(Tc){throw Error.argument("initData");}}}}Object(m.a)(em,"TokenizerNLModuleInit",null,[]);class Eg{constructor(ob){this.Bb=ob}execute(ob){if(!ob)throw Error.argumentNull("input");let Lb;if(!({value:Lb}=ob.pr(this.Bb.gVh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const fc of this.Bb.hFg)Lb=fc.apply(Lb);ob=R.Annotations.UW(ob);ob.kA(this.Bb.hVh,Lb);return ob}static fjf(ob,Lb){const fc=new Sys.StringBuilder;for(let Jc=
0;Jc<ob.length;++Jc)fc.append(Lb(ob.substr(Jc,1)));return fc.toString()}}Object(m.a)(Eg,"TransliteratorNLModule",null,[1873]);class Md{constructor(ob){ob&&(this.style=ob.K(0))}apply(ob){return Eg.fjf(ob,Lb=>Md.Kol(Lb,this.style))}static Kol(ob,Lb){switch(Lb){case 0:return ob.toLowerCase();case 1:return"I"===ob?"\u0131":ob.toLowerCase();case 2:return ob.toUpperCase();case 3:return"i"===ob?"\u0130":ob.toUpperCase();default:throw Error.invalidOperation();}}}Md.xLb=0;Object(m.a)(Md,"ChangeCaseTransliterationStage",
null,[1886]);class Re{apply(ob){return Eg.fjf(ob,Re.Jpp)}static Jpp(ob){const Lb=ob.charCodeAt(0);return 65281<=Lb&&65374>=Lb?String.fromCharCode(Lb-65248):ob}}Re.xLb=4;Object(m.a)(Re,"LatinFullWidthToHalfWidthTransliterationStage",null,[1886]);class Vm{constructor(ob,Lb){ob&&(this.akd=Lb.blc(ob.K(0)),this.nGo=Lb.rD(ob.K(1)))}apply(ob){return ob.replace(this.akd,this.nGo)}}Vm.xLb=1;Object(m.a)(Vm,"RegexReplaceTransliterationStage",null,[1886]);class um{constructor(ob,Lb){if(ob){var fc=ob.K(0),Jc=
Lb.rD(ob.K(1)),Tc=new Mi(Lb.Gqb(ob.K(2)));ob=0>ob.K(3)?null:new Mi(Lb.Gqb(ob.K(3)));this.oGg={};for(Lb=0;Lb<fc;++Lb)this.oGg[Jc.charAt(Lb).toString()]=Jc.substr(Tc.K(Lb),ob?ob.K(Lb):1)}}apply(ob){return Eg.fjf(ob,Lb=>Lb in this.oGg?this.oGg[Lb]:Lb)}}um.xLb=2;Object(m.a)(um,"SingleCharSubstitutionsTransliterationStage",null,[1886]);class ce{constructor(ob,Lb){this.hVh=this.gVh=0;this.hFg=null;if(ob){this.annotations=Lb.annotations;var fc=0;try{this.gVh=ob.K(fc);++fc;this.hVh=ob.K(fc);++fc;const Jc=
ob.K(fc);++fc;this.hFg=Array(Jc);for(let Tc=0;Tc<Jc;++Tc){const qd=ob.K(fc);++fc;const Wc=ob.K(fc);++fc;const Zd=new bb.a;Zd.jqb(ob,fc,Wc);fc+=Wc;this.hFg[Tc]=this.Dbo(qd,Zd,Lb)}}catch(Jc){throw Error.argument("initData");}}}Dbo(ob,Lb,fc){switch(ob){case Md.xLb:return new Md(Lb);case Vm.xLb:return new Vm(Lb,fc);case um.xLb:return new um(Lb,fc);case Re.xLb:return new Re;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(m.a)(ce,"TransliteratorNLModuleInit",
null,[]);class nd{WBm(ob,Lb){const fc=ob.K(0),Jc=new bb.a;Jc.jqb(ob,1,ob.count-1);switch(fc){case 0:return new Bj(new ci(Jc,Lb));case 2:return new Ti(new em(Jc,Lb));case 3:return new Pi(new Vi(Jc,Lb));case 5:return new el(new Tg(Jc,Lb));case 9:return new Eg(new ce(Jc,Lb));case 10:return new fl(new Gf(Jc,Lb));default:throw Error.notImplemented();}}}Object(m.a)(nd,"NLModuleFactory",null,[1861]);class Sk{constructor(ob){this.Kjl=";";if(!ob)throw Error.argumentNull("resource");this.Dma=new td(ob,new Gb,
new nd);this.R7f=this.Dma.zBm();this.tbj=this.Dma.annotations.f2c("Text.Text");this.rbj=this.Dma.annotations.f2c("Classification.Predictions");this.C7f=this.Dma.annotations.f2c("Classification.PredictionString");this.sbj=this.Dma.annotations.f2c("Classification.Probability");this.GJn=this.Dma.annotations.f2c("NLMod.Tokens");if(0>this.tbj||0>this.rbj||0>this.C7f||0>this.sbj)throw Error.argument("resourceObj","Resource does not represent a ranker");}Xjm(){const ob=[];this.bCf(void 0,this.Uti(ob),null);
return ob}Zjm(ob,Lb){const fc=[],Jc=[];this.bCf(ob,this.Uti(fc),(Tc,qd)=>{const Wc=this.Dma.annotations.Hti(Tc),Zd=[],ie=[];Lb&&Lb.length&&-1===Array.indexOf(Lb,Wc)||(Tc=this.Dma.annotations.getAttributeType(Tc),this.puj(Tc,qd,Zd,ie),qd=new jg(Wc,Zd,ie),Array.add(Jc,qd))});return new Ef(fc,Jc)}Yjm(ob){const Lb=[];this.bCf(ob,fc=>{let Jc;if(({value:Jc}=fc.pr(this.C7f)).returnValue){let Tc;({value:Tc}=fc.pr(this.sbj)).returnValue&&Array.add(Lb,new qh(Jc,Tc))}},null);return Lb}bCf(ob,Lb,fc){var Jc=new E.a(this.Dma.annotations);
Jc.kA(this.tbj,ob);ob=this.R7f.execute(Jc);if(({value:Jc}=ob.pr(this.rbj)).returnValue)for(const Tc of Jc.items)Lb(Tc);if(fc&&({value:Lb}=ob.pr(this.GJn)).returnValue)for(const Tc of Lb.items)Tc.h4d(fc)}puj(ob,Lb,fc,Jc){if(R.Annotations.yK(ob))for(var Tc of Lb.items)this.puj(Lb.b8,Tc,fc,Jc);else if(R.Annotations.n5j(ob)){Tc=this.Dma.annotations.ZCi(ob);for(let qd=0;qd<Tc;qd++)Array.add(fc,this.Dma.annotations.JHi(ob,qd)),Array.add(Jc,this.Dma.annotations.jia(this.Dma.annotations.YQb(ob,qd),Lb.Uqb(qd)))}else Array.add(fc,
"VALUE"),Array.add(Jc,this.Dma.annotations.jia(ob,Lb))}Uti(ob){return Lb=>{let fc;({value:fc}=Lb.pr(this.C7f)).returnValue&&Array.add(ob,this.mHm(fc))}}mHm(ob){const Lb=ob.indexOf(this.Kjl);return 0>Lb?ob:ob.substring(0,Lb)}}Object(m.a)(Sk,"Ranker",null,[]);var tg=d(1459),Bk=d(1476),jj=d(2);class af{constructor(ob,Lb){this.msh="";this.E5e=null;this.F5e=!1;this.vwa=null;this.dpk=["TellMe.TellMeParamCollection"];this.jc=ob;this.f4a=Lb;this.jc.JKb&&(this.vwa=null)}get ise(){if(!this.E5e&&!this.F5e){let ob=
null;try{ob=window.TellMeModel}catch(Lb){if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("QueryRanker","TellMeModel not found. Exception: "+Lb)}if(ob){try{this.E5e=new Sk(ob)}catch(Lb){if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Lb)}this.F5e=!0}else if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("QueryRanker","Classifier model not found")}return this.E5e}zN(){return"Command"}rX(){return 0===
this.jc.nw?0:1===this.jc.nw?1:2}gK(ob,Lb,fc=!1,Jc=f.a.su,Tc=null){const qd=new x.a(ob);if((!Tc||Array.contains(Tc,0))&&!v.a.KU(ob)){if(!this.ise&&this.F5e){if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.jc.JKb&&this.vwa&&this.vwa.initialize();if(tg.CommandResultsUtility.YXf(ob.Wg)&&(Tc=tg.CommandResultsUtility.zvi(ob.Wg),0<Tc.results.length)){Tc.displayName=
"Classifier Debug";qd.kw(Tc);Lb.Qt(qd);return}Tc=ob?this.msh=ob.Wg:this.msh;if(jj.AFrameworkApplication.J.$("TellMeParameterizedQueriesEnabled")){Tc=this.oHm(Tc);var Wc=this.z5d(Tc.aNf());Tc=Tc.hti()}else Tc=this.nHm(Tc),Wc=this.pnm(Tc),Tc=[];tg.CommandResultsUtility.mie(Wc,!1,"Classifier","TFIDF");Wc=tg.CommandResultsUtility.F4c(ob,Wc,this.jc,this.vwa,this.f4a,Tc,0,1);0<Wc.results.length&&Jc!==f.a.contextMenu&&(Wc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);fc||Wc.results.length||this.jc.m3||
this.jc.Reb||(ob=new w.a("lookupNoResults",14,ob.Wg,null,1),Wc.jy(ob));0<Wc.results.length&&qd.kw(Wc);qd.attributes=Tc}Lb.Qt(qd)}aNf(){let ob=[];try{ob=this.ise.Xjm()}catch(Lb){if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("GetPredictions","Exception: "+Lb)}return ob}nHm(ob){let Lb=[];try{Lb=this.ise.Yjm(ob)}catch(fc){if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("GetPredictionsWithScore","Exception: "+fc)}return Lb}oHm(ob){try{return this.ise.Zjm(ob,this.dpk)}catch(Lb){if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("GetPredictionsWithTokenAttributes",
"Exception: "+Lb)}return new Ef([],[])}z5d(ob){const Lb=[];if(ob)for(const fc of ob)Lb.push(new Bk.a(fc,-99999));return Lb}pnm(ob){const Lb=[];if(ob)for(const fc of ob)Lb.push(new Bk.a(fc.prediction,fc.score));return Lb}}Object(m.a)(af,"CommandResultsProvider",null,[1024]);var di=d(1747);class Fl{constructor(ob){this.jc=ob}zN(){return"Feedback"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:2}gK(ob,Lb,fc,Jc,Tc=null){ob=new x.a(ob);if(!Tc||Array.contains(Tc,21))Tc=[],Tc.push(appChrome.actions.setControlLabel("TellMeFeedback",
CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Tc),Tc=new z.a(22),Tc.displayName="",Tc.jy(new w.a("TellMeFeedback",23,null,null,1)),ob.kw(Tc);Lb.Qt(ob)}}Object(m.a)(Fl,"FeedbackResultsProvider",null,[1024]);class kh{constructor(ob,Lb,fc,Jc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=ob;this.CommandId=Lb;this.CommandValueId=fc;this.InputText=Jc}}Object(m.a)(kh,"FindInDocumentProp",null,[]);var Xf=d(16);class fh{constructor(ob){this.t0e=2;this.gGb=[];
this.Xjb=[];this.jc=ob;fh.$Ja=ob.DDf;fh.Boi="FindInDocumentSuggestion";fh.vtj="FindInDocumentSuggestion3";this.s_e=Object.assign(new F.a,{landingTab:"Indoc",data:null});this.LNk=this.jc.Ryb||!!jj.AFrameworkApplication.ta&&jj.AFrameworkApplication.ta.Hb.Ryb}zN(){return"FindInDocument"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:3===this.jc.nw?this.jc.yWj?2:3:2}gK(ob,Lb,fc=!1,Jc,Tc=null){const qd=new x.a(ob);if(Tc&&!Array.contains(Tc,2))Lb.Qt(qd);else if(Array.clear(this.gGb),v.a.KU(ob)){if(fc&&this.QTj()){fc=
new z.a(2);fc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Tc=1;Jc="";if(0<this.Xjb.length&&!this.jc.Txc)for(var Wc of this.Xjb)if(""!==Wc.Label.toLowerCase()){if(Tc>=this.t0e)break;this.r9j(fc,Wc.Label,Wc.CommandValueId,fh.Boi+Tc,Wc.InputText);Tc++}Wc="";this.jc.AS?(qd.kw(fc),fc=new z.a(3),Wc=this.jc.Mmb?v.a.Cqb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):Wc=CommonUIStrings.l_TellMeOpenFindPaneText;Jc=this.yvi("");this.r9j(fc,Wc,Jc,
fh.vtj,"");qd.kw(fc)}Lb.Qt(qd)}else Wc="",fc&&(fc=this.yvi(ob.Wg),Jc=[],this.jc.cbb?(this.jc.tze&&Jc.push(appChrome.actions.setControlIconSet(fh.$Ja,{"default":"FindInDocument_20"})),Wc=this.jc.q1f?v.a.lKf(ob.Wg,CommonUIStrings.l_FindInDocumentScopedButtonText):ob.Wg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.jc.AS?(Wc=this.jc.Mmb?v.a.Cqb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,ob.Wg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,ob.Wg),
Jc.push(appChrome.actions.setControlIconSet(fh.$Ja,{"default":"FindInDocument_20"}))):Wc=this.jc.Txc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,ob.Wg),this.jc.qBa?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(fh.$Ja,Wc)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(fh.$Ja,fc))):(Jc.push(appChrome.actions.setControlLabel(fh.$Ja,Wc)),Jc.push(appChrome.actions.setButtonCommandValueId(fh.$Ja,fc)),
appChrome.api.dispatch(Jc)),this.mPj(Wc,fh.$Ja,fc,ob.Wg)),this.jc.yWj?(Wc=new w.a(fh.$Ja,8,ob.Wg),fc=new z.a(2),fc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,fc.jy(Wc),qd.kw(fc),Lb.Qt(qd)):this.jc.w6d(ob.Wg).then(Zd=>{const ie=new w.a(fh.$Ja,8,ob.Wg,null,1);ie.count=Zd;Zd=new z.a(2);Zd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Zd.jy(ie);qd.kw(Zd);Lb.Qt(qd)},Zd=>{u.TellMeActor.instance.We.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+
Zd);Zd=new w.a(fh.$Ja,8,ob.Wg,null,1);const ie=new z.a(2);ie.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;ie.jy(Zd);qd.kw(ie);Lb.Qt(qd)})}QTj(){return!!this.jc&&this.jc.lze}r9j(ob,Lb,fc,Jc,Tc=null){const qd=[];Lb&&qd.push(appChrome.actions.setControlLabel(Jc,Lb));this.jc.AS&&qd.push(appChrome.actions.setControlIconSet(Jc,{"default":"FindInDocument_20"}));qd.push(appChrome.actions.setButtonCommandValueId(Jc,fc));appChrome.api.dispatch(qd);this.mPj(Lb,Jc,fc,"");ob.jy(new w.a(Jc,8,Tc,null,
1,-99999))}yvi(ob){return this.LNk?v.a.HUa(ob,15,this.s_e):Xf.a.If(ob)}mPj(ob,Lb,fc,Jc){this.QTj()&&this.gGb.length<this.t0e&&(ob=new kh(ob,Lb,fc,Jc),Array.add(this.gGb,ob))}qYo(ob){for(let Lb=0;Lb<this.gGb.length;Lb++)if(this.gGb[Lb].CommandId===ob){const fc=this.gGb[Lb].Label;let Jc=!1;if(0<this.Xjb.length){let Tc=0;for(const qd of this.Xjb){if(qd.Label===fc){Array.removeAt(this.Xjb,Tc);Jc=!0;break}Tc++}}!Jc&&this.Xjb.length>=this.t0e-1&&Array.removeAt(this.Xjb,1);Array.insert(this.Xjb,0,this.gGb[Lb])}}}
fh.$Ja=null;fh.Boi=null;fh.vtj=null;Object(m.a)(fh,"FindInDocumentResultsProvider",null,[1024]);var Cj=d(1745);class Dj{constructor(ob){this.jc=ob}zN(){return"Insights"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:2}gK(ob,Lb,fc=!1,Jc,Tc=null){Jc=new x.a(ob);if(!Tc||Array.contains(Tc,13))if(this.V6o()||!v.a.KU(ob)){Tc=new z.a(13);var qd=""===ob.Wg.trim(),Wc=qd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Zd=new w.a(Wc,10,ob.Wg,null,1);fc&&(fc=null,v.a.Hta()?qd?qd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:
(qd=this.jc.Txc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ob.Wg),fc=v.a.HUa(ob.Wg,1)):(qd=String.format(CommonUIStrings.l_InsightsButtonText,ob.Wg),fc=v.a.YMb(ob.Wg)),this.jc.qBa?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Wc,qd)),fc&&u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",fc))):(ob=[],ob.push(appChrome.actions.setControlLabel(Wc,qd)),
fc&&ob.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",fc)),appChrome.api.dispatch(ob)),Zd.label=qd);Tc.jy(Zd);Jc.kw(Tc)}Lb.Qt(Jc)}V6o(){return v.a.Hta()&&this.jc.Ukp&&!this.jc.Ska}}Object(m.a)(Dj,"InsightsResultsProvider",null,[1024]);var Vl=d(1743);class kj{constructor(ob){this.jc=ob}zN(){return"Learning"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:2}gK(ob,Lb,fc,Jc,Tc=null){fc=new x.a(ob);Tc&&!Array.contains(Tc,21)||!v.a.KU(ob)||(Tc=[],Jc=this.jc.SAn,Tc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",
Jc)),Jc=kj.Xum(Jc),Tc.push(appChrome.actions.setControlLabel("LearningForSearch",Jc)),appChrome.api.dispatch(Tc),ob=new w.a("LearningForSearch",22,ob.Wg,null,1),Tc=new z.a(21),Tc.jy(ob),fc.kw(Tc));Lb.Qt(fc)}static Xum(ob){const Lb=[];Array.add(Lb,new Vl.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Lb,new Vl.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Lb,new Vl.a(600,ob));Array.add(Lb,new Vl.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));ob={};ob.parts=
Lb;return JSON.stringify(ob)}}Object(m.a)(kj,"LearningProvider",null,[1024]);var ql=d(606);class Pl{constructor(ob,Lb){this.Q8b=this.Mbc=this.Bkb=this.pHd=null;this.Oy=!1;this.A9b=ob;this.vtk=Lb;ob&&this.Jmi(ob)}bEe(){this.A9b.bEe()&&this.Jmi(this.A9b)}COf(ob){let Lb=[];var fc=[];ob=Pl.XTn(ob);var Jc="";Array.clear(fc);for(let Tc=0;Tc<ob.length;Tc++){const qd=ob.charAt(Tc);-1!==" ".indexOf(qd)?(Jc.length&&Array.add(fc,Jc),Jc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(qd)?(Jc.length&&Array.add(fc,
Jc),Jc=qd,Array.add(fc,Jc),Jc=""):Jc+=qd}Jc.length&&Array.add(fc,Jc);for(ob=0;ob<fc.length;ob++)Jc=this.onm(fc[ob]),Jc=this.QCl(Jc),Lb=Pl.UNn(Lb,Jc);return Lb=this.HZk(Lb)}y_f(){this.Oy||this.bEe();return this.Oy}JZd(ob){return this.pHd[ob.toString()]}HZk(ob){for(let Lb=0;Lb<ob.length;Lb++){const fc=this.Bkb[Lb];if(ob[Lb].commandId!==this.JZd(fc[0]))throw Error.create("Incorrect Tcid orders with Priors data");let Jc;(Jc=ob[Lb]).score=Jc.score+fc[1]}return ob}QCl(ob){const Lb=[];for(var fc=0;fc<this.Bkb.length;fc++)Lb.push(new Bk.a(this.JZd(this.Bkb[fc][0]),
-5));fc=new ql.a;for(var Jc=0;Jc<ob.length;Jc++)fc.add(this.JZd(ob[Jc][0]));for(Jc=0;Jc<Lb.length;Jc++){const qd=Lb[Jc];for(let Wc=0;Wc<ob.length;Wc++){var Tc=ob[Wc];const Zd=this.JZd(Tc[0]);Tc=Tc[1];if(Zd===qd.commandId){qd.score=Tc;fc.remove(Zd);break}}if(!fc.count)break}return Lb}onm(ob){const Lb=1>ob.length;for(let Wc=0;2>=Wc;Wc++){const Zd=this.Q8b;for(const ie in Zd){var fc=Zd[ie],Jc=ob,Tc=ie;const vf=Tc.length+1,vg=Array((Jc.length+1)*vf);for(var qd=0;qd<=Jc.length;qd++)vg[qd*vf]=qd;for(qd=
0;qd<=Tc.length;qd++)vg[qd]=qd;for(qd=0;qd<Tc.length;qd++)for(let Ch=0;Ch<Jc.length;Ch++)vg[(Ch+1)*vf+(qd+1)]=Jc.charAt(Ch)===Tc.charAt(qd)?vg[Ch*vf+qd]:Math.min(Math.min(vg[Ch*vf+(qd+1)]+1,vg[(Ch+1)*vf+qd]+1),vg[Ch*vf+qd]+1);Jc=vg[Jc.length*vf+Tc.length];if((!Jc||!Lb)&&Jc<=Wc)return fc}}return this.Mbc}Jmi(ob){this.pHd=ob.SLf();this.Bkb=ob.ZHm();this.Mbc=ob.fRm();this.Q8b=ob.xym();if(this.Oy=!!this.pHd&&!!this.Bkb&&!!this.Q8b&&!!this.Mbc)this.Oy=0<this.Bkb.length&&Pl.EXf(this.Bkb);this.Oy&&(this.Oy=
0<this.Mbc.length&&Pl.EXf(this.Mbc));this.Oy&&(this.Q8b=Pl.VRm(this.Q8b));this.Oy||(this.Q8b=this.Mbc=this.Bkb=this.pHd=null)}lQm(ob){ob=this.COf(ob);return this.Q8l(ob,this.vtk)}Q8l(ob,Lb){let fc=[];for(let Jc=0;Jc<ob.length;Jc++)ob[Jc].score>=Lb&&fc.push(ob[Jc]);fc.sort((Jc,Tc)=>Jc.score<Tc.score?1:Jc.score>Tc.score?-1:0);0<fc.length-10&&(fc=fc.slice(0,10));return fc}static UNn(ob,Lb){if(!ob.length)return Lb;if(ob.length!==Lb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");
for(let fc=0;fc<ob.length;fc++){if(ob[fc].commandId!==Lb[fc].commandId)throw Error.create("Incorrect CommandId");let Jc;(Jc=ob[fc]).score=Jc.score+Lb[fc].score}return ob}static XTn(ob){return Xf.a.xh(ob)}static EXf(ob){for(let Lb=0;Lb<ob.length;Lb++)if(2!==ob[Lb].length)return!1;return!0}static VRm(ob){const Lb={};for(const Tc in ob){var fc=Tc,Jc=ob[Tc];const qd=Jc;qd.length&&Pl.EXf(qd)&&(Lb[fc]=Jc)}return Lb}}Object(m.a)(Pl,"NaiveBayesClassifierModel",null,[]);class on{constructor(ob,Lb){this.vwa=
null;this.jc=ob;this.bMc=new Pl(Lb,ob.XBm);this.jc.JKb&&(this.vwa=null)}zN(){return"NBCommand"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:2}gK(ob,Lb,fc=!1,Jc=f.a.su,Tc=null){const qd=new x.a(ob);if((!Tc||Array.contains(Tc,0))&&!v.a.KU(ob)){if(tg.CommandResultsUtility.YXf(ob.Wg)&&(Tc=tg.CommandResultsUtility.zvi(ob.Wg),0<Tc.results.length)){Tc.displayName="Classifier Debug";qd.kw(Tc);Lb.Qt(qd);return}if(!this.bMc.y_f()){if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");
throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.jc.JKb&&this.vwa&&this.vwa.initialize();Tc=this.bMc.lQm(ob.Wg);tg.CommandResultsUtility.mie(Tc,!1,"Classifier","NaiveBayesian");Tc=tg.CommandResultsUtility.F4c(ob,Tc,this.jc,this.vwa,null,null,0,1);0<Tc.results.length&&Jc!==f.a.contextMenu&&(Tc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);fc||Tc.results.length||this.jc.m3||this.jc.Reb||(ob=new w.a("lookupNoResults",14,ob.Wg,null,1),Tc.jy(ob));0<Tc.results.length&&
qd.kw(Tc)}Lb.Qt(qd)}}Object(m.a)(on,"NaiveBayesCommandProvider",null,[1024]);class vl{constructor(){this.dGb=null;this.Oy=!1;this.bEe()}bEe(){this.Oy||(this.dGb=window.NBCRM)&&4===this.dGb.length&&(this.Oy=!0);return this.Oy}ZHm(){return this.Oy?this.dGb[1]:null}fRm(){return this.Oy?this.dGb[2]:null}xym(){return this.Oy?this.dGb[3][0]:null}SLf(){return this.Oy?this.dGb[0][0]:null}}Object(m.a)(vl,"NaiveBayesModelAdapter",null,[1847]);var co=d(132);class fm{constructor(ob){this.jc=ob}zN(){return"OfficeScript"}rX(){return 0===
this.jc.nw?0:1===this.jc.nw?1:2}gK(ob,Lb){const fc=new x.a(ob);if(!v.a.KU(ob)){ob=co.d(ob.Wg);var Jc=new z.a(28);Jc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Jc=this.xOh(ob,fm.zup,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Jc);Jc=this.xOh(ob,fm.Sem,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Jc);fc.kw(Jc)}Lb.Qt(fc)}xOh(ob,Lb,fc,Jc,Tc,qd){const Wc=[];for(const Zd of Lb)if(co.a(ob,Zd)){this.jc.qBa?
(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(fc,Tc)),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(fc,Jc))):(Wc.push(appChrome.actions.setControlLabel(fc,Tc)),Wc.push(appChrome.actions.setButtonCommandValueId(fc,Jc)),appChrome.api.dispatch(Wc));qd.jy(new w.a(fc,28,null,null,1));break}return qd}}fm.zup="unhide row rows col cols column columns".split(" ");fm.Sem=["freeze","selection","pane","panes"];Object(m.a)(fm,"OfficeScriptsSamplesProvider",
null,[1024]);var Hk=d(72),gn=d(346),Mm=d(1494),sk=d(1446),km=d(1493),jk=d(28),gm=d(117),wi=d(1375);class Nm{constructor(ob){this.qT=null;this.u5=-1;this.K8f=14;this.N8f=12;this.attributes=this.Rbf=this.query=null;this.$oc=!1;this.P$b=[];this.Gf=jj.AFrameworkApplication.Ge;jj.AFrameworkApplication.J&&(this.K8f=jj.AFrameworkApplication.J.fc("TellMeMaxTermedResults",this.K8f),this.N8f=jj.AFrameworkApplication.J.fc("TellMeMaxZeroTermResults",this.N8f));this.ZU=ob}get hp(){return this.P$b}get HEe(){return this.Rbf}kw(ob){let Lb=
!1;for(let fc=0;fc<this.hp.length;fc++)if(30!==this.hp[fc].groupType&&this.hp[fc].groupType===ob.groupType){this.vff(this.hp[fc],ob);Lb=!0;break}Lb||this.hp.push(ob)}vff(ob,Lb){for(let fc=0;fc<Lb.results.length;fc++)ob.jy(Lb.results[fc])}wDj(ob){const Lb=[];for(const fc of this.hp)fc.groupType!==ob&&Lb.push(fc);this.hp.length!==Lb.length&&(this.P$b=Lb)}qBo(ob){let Lb=null,fc=null,Jc=null;for(let Tc=0;Tc<ob.length;Tc++){const qd=ob[Tc];if(qd&&qd.hp&&qd.hp.length)for(const Wc of qd.hp)if(17===Wc.groupType||
18===Wc.groupType)Lb=Wc;else if(0===Wc.groupType||16===Wc.groupType)fc=Wc,Jc=qd}Lb&&fc&&0<fc.results.length&&(17===Lb.groupType&&({Oef:fc,Jff:Lb}=tg.CommandResultsUtility.MXk(fc,Lb,this.ZU.HR()?this.ZU.HR().Jmm:-.6)),Jc.wDj(fc.groupType))}wcp(){this.ZU&&(new Hk.a,this.bqd(this.ZU.Zbj))}cad(ob,Lb){return this.query.Wg.length>this.ZU.HR().HIm&&this.wrn(ob,Lb)||this.query.Wg.length>this.ZU.HR().IIm&&this.yun(ob,Lb)?!0:!1}yun(ob,Lb){return ob&&ob.length&&Lb&&Lb.length?-1===Lb.toLowerCase().indexOf(ob.toLowerCase())?
!1:!0:!1}wrn(ob,Lb){return ob&&ob.length&&Lb&&Lb.length?Lb.toLowerCase().startsWith(ob.toLowerCase()):!1}b9l(ob){const Lb=[];for(const fc of this.ZU.HR().AS?this.HEe:this.hp)ob.contains(fc.groupType)||Lb.push(fc);this.ZU.HR().AS?this.Rbf=Lb:this.P$b=Lb}RBp(ob,Lb){const fc=[];for(const Jc of this.hp){const Tc=Jc;if(13!==Tc.groupType||24!==Tc.groupType){const qd=ob[sk.a[Tc.groupType].toLowerCase()];let Wc="False";qd<Lb&&(Wc="True");Tc.displayName=Tc.displayName+" ("+Wc+": "+qd+")"}fc.push(Tc)}this.P$b=
fc}bqd(ob,Lb=!1,fc=null){if(this.ZU.HR().AS){if(!Lb)for(this.Rbf=Array(this.hp.length),Lb=0;Lb<this.hp.length;Lb++)this.HEe[Lb]=this.hp[Lb];this.ZU.ecj.bqd(this.hp,this.HEe,this.query,ob,fc)}else{for(fc=new Hk.a;this.hp.length;){Lb=this.hp.pop();const Jc=sk.a[Lb.groupType].toLowerCase(),Tc=ob[Jc];if(wi.c(Tc))throw Error.create("GroupId "+Jc+" missed from group SortingOrder");fc.add(new gn.a(Tc,Lb))}fc.Sc((Jc,Tc)=>Jc.key<Tc.key?-1:1);for(ob=0;ob<fc.count;ob++)Lb=fc.K(ob).value,this.hp.push(Lb)}}xcp(){var ob=
!1;let Lb=!1,fc=!1;for(let Tc=0;Tc<this.hp.length;Tc++){var Jc=this.hp[Tc];const qd=Jc.groupType;if(8===qd||15===qd||14===qd){Jc=Jc.results;for(let Wc=0;Wc<Jc.length;Wc++){if(8===qd&&this.cad(this.query.Wg,Jc[Wc].label)){ob=!0;break}if(15===qd&&this.cad(this.query.Wg,Jc[Wc].label)){Lb=!0;break}if(14===qd){if(this.cad(this.query.Wg,Jc[Wc].label)||this.cad(this.query.Wg,Jc[Wc].description)){fc=!0;break}const Zd=Jc[Wc].label.split(" ");for(const ie of Zd)if(this.cad(this.query.Wg,ie)){fc=!0;break}}}}}ob=
this.ZU.xKm(ob,Lb,fc);this.bqd(ob)}jXb(ob,Lb,fc,Jc,Tc,qd){if(Tc===this.qT){var Wc=ob.data.Ee;Tc=null;try{Tc=jk.b(Wc)}catch(gh){u.TellMeActor.instance.We.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+gh);return}if("RankerResults"in Tc&&Tc.RankerResults){this.EIa();var Zd=Tc.RankerResults,ie=new Hk.a,vf=new Hk.a;Wc=0;for(var vg of Zd){Zd=vg.ProviderId;var Ch=vg.Score;Wc+=Ch;ie.add(new gn.a(Zd,Ch))}ie.Sc((Xe,xh)=>Xe.value>xh.value?-1:1);Ch=qd?qd.XGi:1E-6;
vg={};Zd={};let gh=0;for(var ek=0;ek<ie.count;ek++){const Xe=parseInt(ie.K(ek).key),xh=ie.K(ek).value/Wc;1===Xe&&(Zd.answer=gh++,Zd.entity=gh++,Zd.definition=gh++,Zd.wolframanswer=gh++,xh<Ch&&(vf.add(9),vf.add(11),vf.add(10),vf.add(12)),vg.answer=xh,vg.entity=xh,vg.definition=xh,vg.wolframanswer=xh);2===Xe&&(Zd.assistance=gh++,xh<Ch&&vf.add(8),vg.assistance=xh);3===Xe&&(Zd.classifier=gh++,Zd.serviceclassifier=gh++,xh<Ch&&(vf.add(0),vf.add(17)),vg.classifier=xh,vg.serviceclassifier=xh);4===Xe&&(Zd.people=
gh++,xh<Ch&&vf.add(14),vg.people=xh);5===Xe&&(Zd.document=gh++,xh<Ch&&vf.add(15),vg.document=xh);6===Xe&&(Zd.findindocument=gh++,xh<Ch&&vf.add(2),vg.findindocument=xh);7===Xe&&(Zd.notes=gh++,xh<Ch&&vf.add(20),vg.notes=xh);8===Xe&&(Zd.image=gh++,xh<Ch&&vf.add(19),vg.image=xh)}ie=new Hk.a;ie.add("classifier");ie.add("serviceclassifier");ie.add("appsforoffice");ie.add("addin");ie.add("findindocument");ie.add("assistance");ie.add("document");ie.add("people");ie.add("answer");ie.add("wolframanswer");ie.add("definition");
ie.add("entity");ie.add("image");ie.add("template");ie.add("officescript");for(ek=0;ek<ie.count;ek++)ie.K(ek)in Zd||(Zd[ie.K(ek)]=gh++);Zd.learning=gh++;Zd.insights=gh++;Zd.actionai=gh++;Zd.actionaicommand=gh++;Zd.feedback=gh++;qd&&qd.z_i&&this.RBp(vg,Ch);qd&&qd.A_i&&this.b9l(vf);vf={};for(var dj in vg)vf[dj]=vg[dj]*Wc;this.bqd(Zd,!0,vf)}if(qd.Qfe&&"Intents"in Tc&&Tc.Intents){dj=Tc.Intents;for(var Cd of dj)if(this.c2f(Cd)&&"Serplet"===Cd.GroupType&&Cd.ConfidenceScore>Cd.ConfidenceThreshold){dj=!1;
Tc=0;if(qd.Rfe){Wc=new w.a("",32);for(vf=0;vf<this.hp.length;vf++)if((ie=this.hp[vf].results)&&0<ie.length){Tc=vf;Wc=ie[0];break}2===Wc.groupType&&(dj=!0)}Wc=new z.a(13);dj&&qd.Rfe&&(Wc=new z.a(13,CommonUIStrings.l_TellMeWebTitle));vf=new w.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Wg,null,0);ie=[];vg=null;vg=v.a.Hta()?v.a.HUa(this.query.Wg,1):v.a.YMb(this.query.Wg);ie.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",vg));vg=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,
this.query.Wg);ie.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",vg));appChrome.api.dispatch(ie);Wc.jy(vf);vf=[];if(dj&&qd.Rfe)for(vf.push(this.hp[Tc]),vf.push(Wc),dj=Tc+1;dj<this.hp.length;dj++)(Tc=this.hp[dj].results)&&0<Tc.length&&vf.push(this.hp[dj]);else for(vf.push(Wc),dj=0;dj<this.hp.length;dj++)(Tc=this.hp[dj].results)&&0<Tc.length&&vf.push(this.hp[dj]);this.P$b=vf}}if(qd.mad&&!qd.AS){Cd=dj=-1;for(Tc=0;Tc<this.hp.length;Tc++)switch(this.hp[Tc].groupType){case 23:dj=
Tc;break;case 0:case 17:case 2:-1===Cd&&(Cd=Tc)}if(-1!==dj){Cd=-1===Cd?0:dj>Cd?Cd+1:Cd;dj=this.hp[dj];Tc=Array(this.hp.length);Wc=0;for(vf=0;vf<Tc.length;vf++)vf===Cd?Tc[vf]=dj:(23===this.hp[Wc].groupType&&Wc++,Tc[vf]=this.hp[Wc],Wc++);this.P$b=Tc}}Jc.Qt(this);Jc=u.TellMeActor.instance.We;Jc.Rba(Lb.length,"RankerInference",ob.data.He.toString(),Math.round(window.performance.now()-fc),km.a.x0j,!0,Mm.a.IWa);this.$oc&&Jc&&(ob=this.query.Zwb,Lb=Jc.mzd,qd.kge&&ob>Lb&&!qd.AS&&(Jc.R6f(this.query.Wg),Jc.rzg(ob)))}}c2f(ob){if("GroupType"in
ob&&ob.GroupType&&"ConfidenceScore"in ob&&"ConfidenceThreshold"in ob)return!0;u.TellMeActor.instance.We.onError("IsValidIntentGroup","Invalid intents found");return!1}RWb(ob,Lb,fc,Jc,Tc){Jc===this.qT&&(this.EIa(),u.TellMeActor.instance.We.Rba(Lb.length,"RankerInference",ob.data.He.toString(),Math.round(window.performance.now()-fc),km.a.x0j,!1,Mm.a.IWa));Tc.Qt(this)}EIa(){-1!==this.u5&&(window.clearTimeout(this.u5),this.u5=-1)}ycp(ob){let Lb;Lb=this.ZU.HR().AS?u.TellMeActor.instance.We.AOf(this.HEe,
this.query.Wg):u.TellMeActor.instance.We.AOf(this.hp,this.query.Wg);var fc=this.ZU.HR().WGi;""!==fc&&(fc="_"+fc);let Jc="";this.ZU.HR().Tee&&(Jc="RankerInference"+fc+",");this.ZU.HR().Qfe&&(Jc+="SerpletClassifier");","===Jc.charAt(Jc.length-1)&&(Jc=Jc.substring(0,Jc.length-1));fc=u.TellMeActor.instance.We.LIi(Jc);const Tc=this.qT=gm.a.create().toString();fc["Client-Request-Id"]=Tc;const qd=window.performance.now(),Wc=this.ZU.HR()?this.ZU.HR().YGi:600;this.EIa();this.u5=window.setTimeout(()=>{if(Tc===
this.qT){this.qT="";this.u5=-1;ob.Qt(this);const Zd={};Zd[a.a.provider]="Ranker";Zd[a.a.EYb]=this.query.Zwb;u.TellMeActor.instance.We.lC(l.a.TIg,Wc,Zd)}},Wc);this.Gf.Xj(u.TellMeActor.instance.We.MIi(),2,Lb,fc,!1,0,Zd=>{this.jXb(Zd,this.query.Wg,qd,ob,Tc,this.ZU.HR())},Zd=>{this.RWb(Zd,this.query.Wg,qd,Tc,ob)},null,null,!1,4E3,6E3)}Kqp(){var ob=0,Lb=new Hk.a,fc=this.ZU.Xbj,Jc=this.ZU.Ybj;for(var Tc=0;Tc<this.hp.length;Tc++){var qd=this.hp[Tc],Wc=sk.a[qd.groupType].toLowerCase(),Zd=fc[Wc];ob+=qd.results.length;
qd.results.length>Zd&&(Wc=Jc[Wc],wi.c(Wc)||Lb.add(new gn.a(Wc,qd)))}Jc=!this.query||""===this.query.Wg.trim();Tc=ob-(Jc?this.N8f:this.K8f);if(!(0>=Tc)){Jc=window.performance.now();ob=ob.toString()+" total,"+Tc.toString()+" to remove.";if(0<Lb.count)for(Lb.Sc((ie,vf)=>ie.key>vf.key?-1:1),qd=0;qd<Lb.count&&0<Tc;qd++){Wc=Lb.K(qd).value;Zd=sk.a[Wc.groupType].toLowerCase();let ie=Wc.results.length-fc[Zd];ie>Tc&&(ie=Tc);0<ie&&(Wc.Hsg(ie),ob+=Zd+": "+ie.toString()+" results removed.",Tc-=ie)}if(0<Tc){ob+=
Tc.toString()+" results left after trimming.";Lb=new Hk.a;fc=this.ZU.bcj;for(qd=0;qd<this.hp.length;qd++)Wc=this.hp[qd],Zd=fc[sk.a[Wc.groupType].toLowerCase()],wi.c(Zd)||Lb.add(new gn.a(Zd,Wc));Lb.Sc((ie,vf)=>ie.key<vf.key?-1:1);for(fc=0;0<Tc;)qd=Lb.K(fc++).value,Tc>=qd.results.length?(Array.remove(this.hp,qd),ob+=sk.a[qd.groupType]+": "+qd.results.length.toString()+" results force removed.",Tc-=qd.results.length):(qd.Hsg(Tc),ob+=sk.a[qd.groupType]+": "+Tc.toString()+" results force removed.",Tc=
0)}u.TellMeActor.instance.We&&(Lb={},Lb[a.a.message]=ob,u.TellMeActor.instance.We.lC("ShowOptimal",window.performance.now()-Jc,Lb))}}}Object(m.a)(Nm,"CombineResultsUpdatedEventArgs",null,[1844]);class Ej{constructor(ob,Lb,fc,Jc=!1,Tc=""){this.Z3e=this.P6e=!1;this.yw=ob;this.PHb=[];this.SAh=Lb.length;this.jc=u.TellMeActor.instance.HR();this.rFd=Jc;this.Gja=Tc;this.hbc={};for(ob=0;ob<Lb.length;++ob)this.hbc[ob.toString()]=fc?0:Lb[ob].rX()}p_o(ob,Lb){Lb&&Lb.query&&Lb.query.Zwb<u.TellMeActor.instance.bya||
(this.PHb[ob]=Lb,this.Z3e?this.P6e=!0:(!this.jc||3!==this.jc.nw||3!==this.hbc[ob.toString()]||this.agi())&&this.QSb())}lco(){this.Z3e=!0}Rup(){this.Z3e=!1;this.P6e&&(this.P6e=!1,this.QSb())}agi(){if(this.PHb.length<this.SAh)return!1;for(let ob=0;ob<this.SAh;++ob)if(!this.PHb[ob])return!1;return!0}QSb(){var ob=this.agi();const Lb=window.performance.now(),fc=new Nm(u.TellMeActor.instance.lkh);fc.qBo(this.PHb);for(var Jc=0;Jc<this.PHb.length;++Jc){var Tc=this.PHb[Jc];if(Tc&&Tc.hp&&Tc.hp.length&&(fc.query=
Tc.query,Tc.attributes&&0<Tc.attributes.length&&(fc.attributes=Tc.attributes),Tc&&Tc.hp&&(ob||this.jrl(Jc,this.PHb))))for(const qd of Tc.hp)fc.kw(qd)}fc.hp&&fc.hp.length&&(fc.$oc=ob,this.jc&&this.jc.ODe&&fc.Kqp(),this.jc&&this.jc.Osn&&fc.query.Wg&&0<fc.query.Wg.length?fc.xcp():fc.wcp(),this.jc&&(this.jc.Tee||this.jc.Qfe)&&this.rFd&&fc.query.Wg&&0<fc.query.Wg.length&&fc.$oc&&this.Gja!==f.a.contextMenu?(3===this.jc.nw&&ob||this.yw.Qt(fc),fc.ycp(this.yw)):this.yw.Qt(fc),ob=u.TellMeActor.instance.We,
fc.$oc&&ob&&(Jc=fc.query.Zwb,Tc=ob.mzd,fc.query.Wg&&0<fc.query.Wg.length&&this.rFd&&this.jc.kge&&this.Gja!==f.a.contextMenu&&Jc>Tc&&!this.jc.Tee&&!this.jc.AS&&(ob.R6f(fc.query.Wg),ob.rzg(Jc)),ob.lC(l.a.ZJo,window.performance.now()-Lb)))}jrl(ob,Lb){if(!(this.hbc&&ob.toString()in this.hbc)||Lb.length<=ob||!Lb[ob])return!1;if(!Lb[ob].hp.length)return!0;const fc=this.hbc[ob.toString()];if(0===fc)return!0;const Jc=this.hbc;for(const qd in Jc){var Tc=Jc[qd];const Wc=Number.parseInvariant(qd);if(Wc!==ob&&
Tc===fc&&!(Lb.length>Wc&&Lb[Wc]))return!1}return!0}}Object(m.a)(Ej,"ResultsAggregator",null,[]);var wl=d(1781);class rl{constructor(){this.dAc=this.eAc=this.cAc=this.icd=this.mrc=this.tnc=0}sXk(ob,Lb){switch(ob){case 1:this.tnc=Lb;break;case 3:this.mrc=Lb;break;case 2:this.icd=Lb;break;case 5:this.cAc=Lb;break;case 4:this.eAc=Lb;break;case 6:this.dAc=Lb}}}Object(m.a)(rl,"CommandFeatures",null,[]);class ug{constructor(ob){this.Chh=0;this.IGa=ob;this.Grk={}}get modelId(){return this.IGa}get l7l(){return this.Chh}get dWc(){return this.Grk}lWk(ob,
Lb,fc){0===Lb?this.Chh=fc:(this.dWc[ob]||(this.dWc[ob]=new rl),this.dWc[ob].sXk(Lb,fc))}}Object(m.a)(ug,"CoefficientsModel",null,[]);const Yk=(ob,Lb)=>Math.pow(10,-Lb/(60*Math.LN10/Math.LN2*ob));class te{constructor(ob,Lb){this.Qk=1;this.hwk=new rl;this.features.icd=1+Math.log(this.count)/Math.LN2;this.features.tnc=ob?1/ob:0;this.features.mrc=2/Math.pow(2,ob);this.features.cAc=Yk(10,Lb);this.features.eAc=Yk(2,Lb);this.features.dAc=Yk(1,Lb)}get count(){return this.Qk}get features(){return this.hwk}SQi(){this.Qk=
this.count+1;this.features.icd=1+Math.log(this.count)/Math.LN2}GBp(ob){const Lb=2/Math.pow(2,ob);this.features.tnc=Math.max(this.features.tnc,ob?1/ob:0);this.features.mrc=Math.max(this.features.mrc,Lb)}bDp(ob){const Lb=Yk(10,ob),fc=Yk(2,ob);ob=Yk(1,ob);this.features.cAc=Math.max(this.features.cAc,Lb);this.features.eAc=Math.max(this.features.eAc,fc);this.features.dAc=Math.max(this.features.dAc,ob)}}Object(m.a)(te,"CommandModel",null,[]);class Un{constructor(ob){this.dFc=null;if(!ob&&u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("PredictionEngine",
"IModelAdapter can't be null");this.A9b=ob;this.oHd=this.P5f()}P5f(){const ob=this.A9b.qBm(),Lb=this.A9b.SLf();if(void 0===ob||null===ob||void 0===Lb||null===Lb)return!1;try{window.performance.now();this.dFc={};for(let fc=0;fc<ob.length;fc++){const Jc=ob[fc],Tc=Lb[Jc[0].toString()].trim(),qd=Jc[1],Wc=0!==qd?Lb[Jc[2].toString()].trim():"",Zd=Jc[3];Tc in this.dFc||(this.dFc[Tc]=new ug(Tc));this.dFc[Tc].lWk(Wc,qd,Zd)}}catch(fc){if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("LoadModelData",
"Error Loading Suggestions Model: "+fc);return!1}return!0}Wfm(){const ob=this.A9b.Oxm(),Lb={};if(!ob)return Lb;let fc=1;for(let Jc=0;Jc<ob.length;Jc++){const Tc=ob[Jc];Tc.Id in Lb?(Lb[Tc.Id].SQi(),Lb[Tc.Id].GBp(fc),Lb[Tc.Id].bDp(Tc.TimeElapsedSinceClick)):Lb[Tc.Id]=new te(fc,Tc.TimeElapsedSinceClick);fc++}return Lb}y_f(){this.oHd||(this.oHd=this.P5f());return this.oHd}lHm(){let ob=[];if(!this.oHd){if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("GetPredictedCommands","IModelAdapter returned no data");
return ob}const Lb=this.Wfm(),fc=this.dFc;for(const Tc in fc){const qd=fc[Tc],Wc=qd.modelId;let Zd=0;for(const ie in Lb){var Jc=ie;const vf=Lb[ie].features;(Jc=Jc in qd.dWc?qd.dWc[Jc]:null)&&(Zd+=vf.tnc*Jc.tnc+vf.mrc*Jc.mrc+vf.icd*Jc.icd+vf.cAc*Jc.cAc+vf.eAc*Jc.eAc+vf.dAc*Jc.dAc)}Zd+=qd.l7l;ob.push(new Bk.a(Wc,Zd))}ob.sort((Tc,qd)=>Tc.score<qd.score?1:Tc.score>qd.score?-1:0);0<ob.length-10&&(ob=ob.slice(0,10));return ob}}Object(m.a)(Un,"PredictionEngine",null,[]);class Wh{constructor(){this.XDh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}z5d(ob,Lb){return Lb&&"word"===Lb.application.toLowerCase()&&
ob in this.XDh?this.XDh[ob]:[]}}Object(m.a)(Wh,"SuggestionResultsUtility",null,[]);class cj{constructor(ob,Lb,fc){this.jc=Lb;this.bMc=new Un(ob);this.R5=fc;this.RGh=new Wh}zN(){return"Suggestion"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:2}gK(ob,Lb,fc,Jc=f.a.su,Tc=null){fc=new x.a(ob);u.TellMeActor.instance.Qtd=!1;if((!Tc||Array.contains(Tc,16))&&v.a.KU(ob)){if(!this.bMc.y_f()){if(u.TellMeActor.instance.We)u.TellMeActor.instance.We.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.Jfe()&&0<this.RGh.z5d(u.TellMeActor.instance.tZd,this.jc).length){const Wc=this.RGh.z5d(u.TellMeActor.instance.tZd,this.jc);Tc=[];for(var qd of Wc)this.jc.lze&&"Find"===qd||Tc.push(new Bk.a(qd,0));u.TellMeActor.instance.Qtd=!0}else Tc=this.bMc.lHm();tg.CommandResultsUtility.mie(Tc,!0,"Recommended","LRE");qd=[];for(const Wc of Tc)this.R5&&this.R5.yrf(Wc.commandId)||qd.push(Wc);ob=tg.CommandResultsUtility.F4c(ob,
qd,this.jc,null,null,null,16,1);0<ob.results.length&&Jc!==f.a.contextMenu&&(ob.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<ob.results.length&&fc.kw(ob)}Lb.Qt(fc)}Jfe(){return!!this.jc&&(this.jc.Jfe||this.jc.nxn)}}Object(m.a)(cj,"SuggestionResultsProvider",null,[1024]);class Kf{Oxm(){return u.TellMeActor.instance.tNe}qBm(){return window.TellMeSuggestionModel}SLf(){return window.CoefficientModelIdMap}}Object(m.a)(Kf,"SuggestionsModelAdapter",null,[1846]);var nf=d(1792),bg=d(1746);d.d(J,"AggregatorResultsProvider",
function(){return Qg});class Qg{constructor(ob=!1){this.C$b={};this.C$b[f.a.su]=[];this.C$b[f.a.contextMenu]=[];this.rFd=ob}R4i(ob,Lb,fc,Jc,Tc=null){let qd;var Wc=!1;switch(Jc){case f.a.contextMenu:qd=this.C$b[f.a.contextMenu];Wc=!0;break;default:qd=this.C$b[f.a.su]}Lb=new Ej(Lb,qd,Wc,this.rFd,Jc);Lb.lco();for(let Zd=0;Zd<qd.length;++Zd){const ie=window.performance.now(),vf=new C(Lb,Zd);(Wc=u.TellMeActor.instance.HR())&&Wc.Ufl?window.setTimeout(()=>{qd[Zd].gK(ob,vf,fc,Jc,Tc);if(u.TellMeActor.instance.We){const vg=
{};vg[a.a.provider]=qd[Zd].zN();vg[a.a.EYb]=ob.Zwb;u.TellMeActor.instance.We.lC(l.a.gK,window.performance.now()-ie,vg)}},0):(qd[Zd].gK(ob,vf,fc,Jc,Tc),u.TellMeActor.instance.We&&(Wc={},Wc[a.a.provider]=qd[Zd].zN(),Wc[a.a.EYb]=ob.Zwb,u.TellMeActor.instance.We.lC(l.a.gK,window.performance.now()-ie,Wc)))}Lb.Rup()}zN(){return"Aggregator"}rX(){return 0}gK(ob,Lb,fc=!1,Jc=f.a.su,Tc=null){if(u.TellMeActor.instance.RPn)this.R4i(ob,Lb,fc,Jc,Tc);else{const qd=window.performance.now();u.TellMeActor.instance.YHp.then(()=>
{u.TellMeActor.instance.We&&u.TellMeActor.instance.We.lC(l.a.SPn,window.performance.now()-qd);this.R4i(ob,Lb,fc,Jc,Tc);return!0})}}UG(ob,Lb){this.C$b[Lb].push(ob)}EYk(ob){switch(ob){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Lb=this.C$b[f.a.su];for(const fc of Lb)if("FindInDocument"===fc.zN()){fc.qYo(ob);break}}}static createInstance(ob,Lb,fc,Jc){const Tc=Lb.Ska;var qd=Jc&&v.a.fCg(Lb),Wc=qd&&Lb.fig&&!Tc;const Zd=Lb.K1f&&!v.a.wpc()&&!Tc,ie=Lb.O_f&&
!Tc,vf=new Qg(qd);if(Lb.W6o&&!Tc){var vg=new kj(Lb);vf.UG(vg,f.a.su)}vg=Lb.Cs?jj.AFrameworkApplication.J.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):jj.AFrameworkApplication.J.$("TellMeSuggestionsIsEnabled");const Ch=!vg&&jj.AFrameworkApplication.J.$("TellMeFirstRunExperienceIsEnabled");vf.UG(new di.a(ob,Lb.Psp,Ch,!1),f.a.su);vg&&!Tc&&vf.UG(new cj(new Kf,Lb,ob),f.a.su);ob=jj.AFrameworkApplication.ta.Hb.o3i?new on(Lb,new vl):new af(Lb,fc);vf.UG(ob,f.a.contextMenu);(qd&&Lb.gig||Wc)&&vf.UG(nf.a.obi(Lb,
!0),f.a.su);vf.UG(ob,f.a.su);!Lb.woi||Tc||"Word"===Lb.application&&Lb.g3d||vf.UG(new fh(Lb),f.a.su);Lb.JKb&&!Tc&&(Wc=new H(Lb),vf.UG(Wc,f.a.su),vf.UG(Wc,f.a.contextMenu));!Lb.NKb||Lb.fpd||Lb.epd||Tc||vf.UG(new K.a(Lb),f.a.su);Jc&&(Lb.m3||v.a.Hta())&&(Wc=new Dj(Lb),vf.UG(Wc,f.a.su),vf.UG(Wc,f.a.contextMenu));qd&&vf.UG(nf.a.obi(Lb,!1),f.a.su);Jc&&!Lb.qGg&&v.a.eCg(Lb)&&!Tc&&(vf.UG(new wl.a(Lb),f.a.su),Lb.IZj&&vf.UG(new wl.a(Lb),f.a.contextMenu));Zd&&vf.UG(new Fl(Lb),f.a.su);!Lb.Xxc&&!Lb.AS||Tc||vf.UG(new Cj.a(Lb),
f.a.su);Lb.mad&&!Tc&&vf.UG(new bg.a(Lb),f.a.su);Lb.sXf&&(qd=new y(Lb),vf.UG(qd,f.a.su),vf.UG(qd,f.a.contextMenu));Jc&&Lb.Xce&&!Tc&&vf.UG(new G.AddinResultsProvider(Lb),f.a.su);ie&&"Excel"===Lb.application&&!Tc&&vf.UG(new fm(Lb),f.a.su);return vf}}Object(m.a)(Qg,"AggregatorResultsProvider",null,[1024])},1777:function(I,J,d){I=d(0);var m=d(58),f=d(13),a=d(5),l=d(177),w=d(221),z=d(357);d(46);var x=d(82);d(872);d(873);var u=d(475);d(476);var v=d(1734),F=d(1735),y=d(1731),G=d(1733),C=d(1732);d(871);d(870);
class H{constructor(X,ca,fa){this.nfm=X;this.bdl=ca;this.dpl=fa}}Object(I.a)(H,"BacktraceAndMakeUpdateHintsInput",null,[]);var K=d(1474),R;(function(X){X[X.qPp=0]="EOP";X[X.character=1]="character";X[X.S0p=2]="embeddedMarker"})(R||(R={}));Object(I.b)("LCSBlockType",R);class E{toString(){return String.format("[Type: {0}]",R[this.type])}}Object(I.a)(E,"ALCSBlock",null,[]);class L extends E{constructor(X,ca){super();this.BMe=ca;this.J3e=X}get type(){return 1}get character(){return this.BMe}get nZa(){return this.J3e}gC(X){return 1===
X.type&&K.a.dUh(X.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(I.a)(L,"CharacterLCSBlock",E,[]);class O extends E{constructor(X,ca,fa){super();this.J3e=X;this.mdf=ca;this.zG=fa}get type(){return 0}get Zc(){return this.mdf}get length(){return this.zG}get nZa(){return this.J3e}gC(X){return 0!==X.type?!1:X.nZa===this.nZa&&X.Zc===this.Zc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),
this.nZa.toString(),this.Zc,this.length)}}Object(I.a)(O,"EOPLCSBlock",E,[]);class V extends L{constructor(X,ca,fa){super(X,"\ufffc");this.dFk=ca;this.UBd=fa}get type(){return 2}get pe(){return this.dFk}get Lk(){return this.UBd}gC(X){return 2!==X.type?!1:X.pe===this.pe&&this.Lk.equals(X.Lk)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),this.pe,this.Lk)}}Object(I.a)(V,"EmbeddedMarkerLCSBlock",L,[]);class Z{constructor(X,ca){this.x=X;this.y=ca}equals(X){return X.x===
this.x&&X.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(I.a)(Z,"IntPair",null,[1126]);var W=d(1533),P=d(1500),S=d(1535),aa=d(1730);d.d(J,"a",function(){return Y});class Y{constructor(X,ca){this.wg=X;this.fe=ca}ybi(X,ca,fa,ja,ra,ya,Ha){return this.sMl(X,ca,fa,ja,ra,ya,Ha)}sMl(X,ca,fa,ja,ra,ya,Ha){let Wa;Wa=null;({returnValue:X}=this.l7d(X,ca));if(!X)return l.a.instance.Ua(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.fe.logger.WX("GetLCSBlocksFromObject"),{returnValue:!1,
AK:Wa};({returnValue:fa}=this.l7d(fa,ja));if(!fa)return l.a.instance.Ua(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.fe.logger.WX("GetLCSBlocksFromObject"),{returnValue:!1,AK:Wa};this.fe.logger.WX("GetLCSBlocksFromObject");Wa=this.rMl(X,fa,ra,ya,Ha);return Wa?{returnValue:!0,AK:Wa}:(l.a.instance.Ua(575706451,1,2,"Failed to Create UpdateHints"),{returnValue:!1,AK:Wa})}loi(X,ca,fa,ja){({returnValue:X}=this.l7d(X,ca));if(!X)return-1;({returnValue:fa}=this.l7d(fa,ja));if(!fa)return-1;
({Nvf:fa}=this.poi(X,fa));return fa}l7d(X,ca){let fa;const ja=new w.a;fa=new w.a;if(!X.length)return l.a.instance.Ua(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.fe.logger.Ti(Object.assign(new W.a,{ek:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,EBf:fa};for(let Ha=0;Ha<X.length;Ha++)if(this.fe.runtime.gJ("GetLCSBlocksFromObject: paraObjs#"+Ha),X.K(Ha).wc===m.a.paragraphNode){const Wa=this.wg.getPropertyString(X.K(Ha),f.a.Yn),Ma=this.wg.getPropertyUint32(X.K(Ha),
a.a.Zc);if(null==Ma)return l.a.instance.Ua(594124835,1,2,"Abandoning LCS due to missing WordId"),this.fe.logger.Ti(Object.assign(new W.a,{ek:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,EBf:fa};let ua=this.wg.getPropertyUint32s(X.K(Ha),f.a.Dn);ua=P.a.ZPj(ua,Wa.length);const Ka=this.wg.getPropertyObjectIds(X.K(Ha),f.a.Zn);let za;for(za=0;za<ua.length-1;za++){var ra=ca(Ka.tg(za)),ya=void 0;ya=ra?(ya=this.wg.getPropertyBool(ra,f.a.Qca))?ya:!1:!1;if(ya)ja.add(this.CGl(X.K(Ha).id,ra));
else for(ra=ua.tg(za);ra<ua.tg(za+1);ra++)ja.add(new L(X.K(Ha).id,K.a.charAt(Wa,ra)))}ja.add(new O(X.K(Ha).id,Ma,ua.K(za)));fa.add(ja.length-1)}else return l.a.instance.Ua(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",X.K(Ha).wc),this.fe.logger.Ti(Object.assign(new W.a,{ek:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,EBf:fa};this.fe.runtime.gJ("LCS: GetLCSBlocks for base");return{returnValue:ja,EBf:fa}}CGl(X,ca){const fa=null==this.wg.getPropertyInt32(ca,
a.a.ht)?0:this.wg.getPropertyInt32(ca,a.a.ht);return new V(X,fa,ca.id)}rMl(X,ca,fa,ja,ra){ja=({Nvf:fa}=this.poi(X,ca,fa,ja,ra)).returnValue;this.fe.logger.WX("FindFurthestPaths");X=new H(ja,X,ca);X=new aa.a(this.Rcl(X,fa),1);this.fe.logger.WX("BacktraceAndMakeUpdateHints");return X}poi(X,ca,fa=-1,ja=-1,ra=-1){let ya;if(-1===fa||-1===ja||-1===ra)ra=ja=fa=-1;ya=-1;const Ha=new z.a;Ha.W(new Z(-1,1),new Z(0,-1));if(-1!==fa){Ha.W(new Z(0,0),new Z(fa,fa));var Wa=1}else Wa=0,ja=X.length,ra=ca.length;for(fa=
0;Wa<=X.length+ca.length;Wa++){let Ma=!1;for(let ua=-Wa;ua<=Wa;ua+=2){let Ka,za;ua===-Wa?(Ka=Ha.K(new Z(Wa-1,ua+1)).x,za=Ha.K(new Z(Wa-1,ua+1)).y+1):ua===Wa?(Ka=Ha.K(new Z(Wa-1,ua-1)).x+1,za=Ha.K(new Z(Wa-1,ua-1)).y):Ha.K(new Z(Wa-1,ua-1)).x>=Ha.K(new Z(Wa-1,ua+1)).x?(Ka=Ha.K(new Z(Wa-1,ua-1)).x+1,za=Ha.K(new Z(Wa-1,ua-1)).y):(Ka=Ha.K(new Z(Wa-1,ua+1)).x,za=Ha.K(new Z(Wa-1,ua+1)).y+1);for(;Ka<ja&&za<ra&&X.K(Ka).gC(ca.K(za));)Ka++,za++;Ha.W(new Z(Wa,ua),new Z(Ka,za));if(Ka===ja&&za===ra){Ma=!0;ya=
Wa;fa=ua;break}}if(Ma)break;this.fe.runtime.gJ("LCS FindFurthestPaths")}if(fa!==ja-ra)return{returnValue:null,Nvf:ya};Ha.W(new Z(ya,fa),new Z(ja+1,ra+1));l.a.instance.Ua(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",X.length,ca.length,ya);return{returnValue:Ha,Nvf:ya}}Rcl(X,ca){const fa=X.nfm,ja=X.bdl;X=X.dpl;const ra=new w.a;let ya=ja.length,Ha=X.length;for(;0<ya||0<Ha;){var Wa=ya-1,Ma=Ha-1;if(this.kco(fa,ca,ya,Ha)){Wa=X.K(Ma);if(1===Wa.type||
2===Wa.type)this.jdn(ra,ya,Wa);else if(0===Wa.type)this.Ecn(ra,ya,Wa);else return l.a.instance.Ua(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",Wa.type),this.fe.logger.Ti(Object.assign(new S.a,{ek:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Ha--;ca--}else if(this.jco(fa,ca,ya,Ha)){Ma=ja.K(Wa);if(1===Ma.type||2===Ma.type)this.kSl(ra,Wa,Ma);else if(0===Ma.type)this.RRl(ra,Wa,Ma);else return l.a.instance.Ua(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",
Ma.type),this.fe.logger.Ti(Object.assign(new S.a,{ek:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;ya--;ca--}else if(ya&&Ha&&ja.K(Wa).gC(X.K(Ma)))ya--,Ha--;else return l.a.instance.Ua(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.fe.logger.Ti(Object.assign(new S.a,{ek:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.fe.runtime.gJ("LCS: CreateUpdateHintsFromLCSBlocks");return ra}jco(X,ca,fa,ja){ca=new Z(ca-1,fa-ja-1);return X.mb(ca)&&X.K(ca).x===fa-1&&
X.K(ca).y===ja}kco(X,ca,fa,ja){ca=new Z(ca-1,fa-ja+1);return X.mb(ca)&&X.K(ca).x===fa&&X.K(ca).y===ja-1}Ecn(X,ca,fa){fa=new y.a(fa.nZa,fa.Zc);let ja=!1;if(0<X.length&&11===X.tg(X.length-1).type){const ra=X.tg(X.length-1);ra.cp===ca&&(ja=!0,ra.k3.add(fa))}ja||(ca=new C.a(ca),ca.k3.add(fa),X.add(ca))}jdn(X,ca,fa){var ja=!1;if(0<X.length&&11===X.tg(X.length-1).type){const ra=X.tg(X.length-1);ra.cp===ca&&((ja=Object(x.a)(G.a,ra.k3.K(ra.k3.length-1)))?ja.text=fa.character.toString()+ja.text:ra.k3.add(new G.a(fa.nZa,
fa.character.toString())),ja=!0)}ja||(ca=new C.a(ca),ca.k3.add(new G.a(fa.nZa,fa.character.toString())),X.add(ca))}RRl(X,ca,fa){ca=new v.a(ca,fa.nZa,fa.Zc);X.add(ca)}ZYc(X,ca){let fa=!1;if(0<X.AK.length&&2===X.AK.tg(X.AK.length-1).type){const ja=X.AK.tg(X.AK.length-1);ja.Qg.equals(ca.nZa)&&ja.cp===ca.spe&&(ja.cp=ca.spe-1,ja.text=(void 0).character.toString()+ja.text,fa=!0)}fa||X.AK.add(new u.a(ca.nZa,ca.spe-1,(void 0).character.toString()));--ca.spe}kSl(X,ca,fa){let ja=!1;if(0<X.length&&8===X.tg(X.length-
1).type){const ra=X.tg(X.length-1);ra.cp===ca+1&&(ra.text=fa.character.toString()+ra.text,--ra.cp,ja=!0)}ja||X.add(new F.a(ca,fa.character.toString()))}}Object(I.a)(Y,"LCSUpdateHintGenerator",null,[])},1780:function(I,J,d){d.r(J);I=d(0);var m=d(58),f=d(13),a=d(5),l=d(177),w=d(357),z=d(605),x=d(221),u=d(46),v=d(108),F=d(1457);class y extends F.a{constructor(){super()}get mfa(){return"ChildNodeListMerge"}}Object(I.a)(y,"ChildNodeListMergeFailureDetail",F.a,[]);class G{qAb(aa,Y,X){return Y.e3(aa,X.K(aa))}n4j(aa,
Y,X,ca){let fa;return({value:fa}=Y.Ec(aa)).returnValue||({value:fa}=X.Ec(aa)).returnValue?fa:ca.K(aa)}}Object(I.a)(G,"ChildNodeListMergeUtils",null,[1128]);var C=d(1534),H=d(1795),K=d(1598);class R{constructor(aa,Y){this.classId=aa;this.qtp=Y}}Object(I.a)(R,"NodeChildrenTransformation",null,[]);var E=d(800),L=d(1479);class O{constructor(aa,Y,X){this.eN=aa;this.PEa=X;this.psa=Y}nre(aa){let Y,X;return({Xwj:Y}=this.s4j(this.PEa,aa)).returnValue&&Y.s3||({Xwj:X}=this.s4j(this.psa,aa)).returnValue&&X.s3}s4j(aa,
Y){let X;return{returnValue:({value:X}=(new L.a(this.eN,aa)).mNa.Ec(E.a.zb(Y))).returnValue,Xwj:X}}}Object(I.a)(O,"NodeTriplet",null,[]);var V=d(1728);class Z{constructor(aa,Y,X){this.fe=aa;this.wg=Y;this.k6=X;this.NGh=!0}get ku(){return this.fe}get kf(){return this.wg}get $Ea(){return this.k6}get success(){return this.NGh}qGm(){l.a.instance.Ua(4220310,1,5,"Evaluating ParentObjects");const aa=new w.a;this.Amf(aa,Y=>this.ku.runtime.Kn.K(Y));this.Amf(aa,Y=>this.$Ea.qAb(Y,this.ku.runtime.QA,this.ku.runtime.Kn));
this.Amf(aa,Y=>this.$Ea.qAb(Y,this.ku.runtime.zv,this.ku.runtime.Kn));return aa}Amf(aa,Y){const X=Y(d(1780).ChildNodeListMerge.dpe);this.kf.getPropertyObjectIds(X,f.a.qg).forEach(ca=>{this.kf.getPropertyObjectIds(Y(ca),f.a.qg).forEach(fa=>{aa.mb(fa)&&!ca.equals(aa.K(fa))&&(this.NGh=!1,l.a.instance.Ua(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",fa,ca,aa.K(fa)));aa.W(fa,ca);return!0});return!0})}}Object(I.a)(Z,"OutlineGroupParentFinder",null,[]);var W=
d(1458),P=d(1737);d.d(J,"ChildNodeListMerge",function(){return S});class S{constructor(aa,Y=null,X=null,ca=null,fa=null){this.wg=aa;this.wao=Y||H.a.M4j;this.jle=X||this.ZCm();this.$Ea=ca||new G;this.bej=fa||this.WAm()}get kf(){return this.wg}ZCm(){return[new R(m.a.Vh,Object(v.a)(this,this.$9n,"pageContentNodeThreewayChildMerge")),new R(m.a.mia,Object(v.a)(this,this.gMp,"wordSectionNodeThreewayChildMerge")),new R(m.a.xH,Object(v.a)(this,this.Woe,"outlineElementContainerThreewayChildMerge")),new R(m.a.Nca,
Object(v.a)(this,this.cjp,"tableCellThreewayChildMerge")),new R(m.a.Oaa,Object(v.a)(this,this.Woe,"outlineElementContainerThreewayChildMerge")),new R(m.a.emc,Object(v.a)(this,this.Woe,"outlineElementContainerThreewayChildMerge")),new R(m.a.lL,Object(v.a)(this,this.Woe,"outlineElementContainerThreewayChildMerge"))]}WAm(){return[Object(v.a)(this,this.hho,"prepareObjectGroupings"),Object(v.a)(this,this.hXm,"handleInterOutlineGroupMerge"),Object(v.a)(this,this.Qco,"performThreewayChildMerge")]}TNn(aa){let Y=
0;for(;Y<this.bej.length;Y++)if(!(0,this.bej[Y])(aa))return l.a.instance.Ua(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",Y),aa.logger.xie("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",Y),!1;return!0}hho(aa){const Y=new w.a,X=new w.a,ca=new z.a;aa.runtime.QA.forEach((fa,ja)=>S.vsj(ja,Y));aa.runtime.zv.forEach((fa,ja)=>S.vsj(ja,X));for(let fa=0;fa<this.jle.length;fa++){const ja=this.jle[fa].classId;aa.runtime.Avb.W(ja,new w.a);Y.mb(ja)&&Y.K(ja).forEach(ra=>{var ya=aa.runtime.Kn.K(ra.id);
ya&&(ya=new O(ya,ra,aa.runtime.zv.e3(ra.id,ya)),aa.runtime.Avb.K(ja).add(ra.id,ya),ca.add(ra.id));return!0});X.mb(ja)&&X.K(ja).forEach(ra=>{if(ca.contains(ra.id))return!0;const ya=aa.runtime.Kn.K(ra.id);ya&&aa.runtime.Avb.K(ja).add(ra.id,new O(ya,ya,ra));return!0})}aa.runtime.gJ("PrepareObjectGroupings");aa.logger.Dbb("PrepareObjectGroupings");return!0}Qco(aa){let Y=!0;for(let X=0;Y&&X<this.jle.length;X++){const ca=this.jle[X];aa.runtime.gJ("Before function#"+X);const fa=ca.classId;aa.runtime.Avb.K(fa).forEach((ja,
ra)=>{aa.runtime.fUa.contains(ra.eN.id)||(Y=ca.qtp(aa,ra)&&Y);Y||(l.a.instance.Ua(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",fa,ra.eN.id),aa.logger.Ti(Object.assign(new y,{ek:"PerformThreewayChildMerge",eventId:"aqtsr"})));return Y});aa.runtime.gJ("PerformThreewayChildMerge"+X)}aa.logger.Dbb("PerformThreewayChildMerge");return Y}$9n(aa,Y){if(Y.nre(f.a.qg)){var X=this.kf.getPropertyObjectIds(Y.eN,f.a.qg);const ca=this.kf.getPropertyObjectIds(Y.psa,f.a.qg);
Y=this.kf.getPropertyObjectIds(Y.PEa,f.a.qg);X=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",X.length,ca.length,Y.length,aa.input.source);l.a.instance.Ua(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",X);aa.logger.Ti(Object.assign(new y,{ek:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:X}));return!1}return!0}gMp(aa,Y){if(Y.nre(f.a.qg)){const Ha=new z.a,Wa=new z.a,Ma=new z.a,ua=new z.a;var X=
this.kf.getPropertyObjectIds(Y.eN,f.a.qg),ca=X.IS(),fa,ja=({W8h:fa}=this.Zak(Y.psa,ca,Ha,"Favored")).returnValue,ra=({W8h:ya}=this.Zak(Y.PEa,ca,Wa,"Unfavored")).returnValue;if(!ja||!ra)return X=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",ca.count,Ha.count,Wa.count,fa,ya),aa.logger.Ti(Object.assign(new y,{ek:"WordSectionNodeThreewayChildMerge",info:X})),!1;X.forEach(Ka=>
{Ha.contains(Ka)||Ma.add(Ka);Wa.contains(Ka)||ua.add(Ka);return!0});Y=Y.eN.$O();ca=new x.a;for(fa=0;fa<X.length;fa++){var ya=X.tg(fa);if(Ma.contains(ya)||ua.contains(ya)){if(aa.runtime.fUa.add(ya),ca.length&&(ja=ca.tg(ca.length-1),ja=aa.runtime.Avb.K(m.a.xH).K(ja),ra=aa.runtime.Avb.K(m.a.xH).K(ya),ja&&ra))Ma.contains(ya)?ua.contains(ya)||(ja.eN=ja.eN.$O(),ja.PEa=ja.PEa.$O(),this.wSd(ja.eN,ra.eN),this.wSd(ja.PEa,ra.PEa)):(ja.eN=ja.eN.$O(),ja.psa=ja.psa.$O(),this.wSd(ja.eN,ra.eN),this.wSd(ja.psa,ra.psa))}else ca.add(ya)}this.kf.setPropertyObjectIds(Y,
f.a.qg,ca);X=new W.a(Y);X.cN(f.a.qg);aa.runtime.Yq.W(Y.id,X)}return!0}wSd(aa,Y){const X=this.kf.getPropertyObjectIds(aa,f.a.qg);Y=this.kf.getPropertyObjectIds(Y,f.a.qg);const ca=X.iOa();Y.forEach(fa=>{ca.add(fa);return!0});this.kf.setPropertyObjectIds(aa,f.a.qg,ca)}Zak(aa,Y,X,ca){let fa=0,ja=!0;this.kf.getPropertyObjectIds(aa,f.a.qg).forEach(ra=>{Y.contains(ra)?X.add(ra):(ja=!1,l.a.instance.Ua(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",ca,ra),fa++);return!0});
return{returnValue:ja,W8h:fa}}hXm(aa){let Y=!0;aa.runtime.Avb.K(m.a.xH).forEach((X,ca)=>{if(this.Knn(ca)){l.a.instance.Ua(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",ca.eN.id);let fa;const ja=new Z(aa,this.kf,this.$Ea);if(({Eqj:X,Tck:fa}=this.Brp(aa,ja.qGm(),ca)).returnValue)return l.a.instance.Ua(4220303,1,4,"Merging WordSection {0} as a unit.",fa),Y=ja.success&&this.LOn(aa,fa,X)&&Y,Y||(l.a.instance.Ua(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",
ca.eN.id,ja.success),aa.logger.Ti(Object.assign(new y,{ek:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ja.success)}))),Y}return!0});return Y}Knn(aa){if(!aa.nre(f.a.qg))return!1;const Y=this.kf.getPropertyObjectIds(aa.eN,f.a.qg).K(0),X=this.kf.getPropertyObjectIds(aa.psa,f.a.qg);aa=this.kf.getPropertyObjectIds(aa.PEa,f.a.qg);return!X.contains(Y,(ca,fa)=>ca.equals(fa))||!aa.contains(Y,(ca,fa)=>ca.equals(fa))}Brp(aa,Y,X){Y=
Y.K(X.eN.id);l.a.instance.Ua(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",X.eN.id,Y);if(aa.runtime.fUa.contains(Y))return l.a.instance.Ua(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",Y),{returnValue:!1,Eqj:null,Tck:Y};const ca=new V.a;X=aa.runtime.Kn.K(Y);this.kf.getPropertyObjectIds(X,f.a.qg).forEach(fa=>{ca.vSd(fa);
return!0});X=this.$Ea.qAb(Y,aa.runtime.QA,aa.runtime.Kn);this.kf.getPropertyObjectIds(X,f.a.qg).forEach(fa=>{ca.xSd(fa);return!0});aa=this.$Ea.qAb(Y,aa.runtime.zv,aa.runtime.Kn);this.kf.getPropertyObjectIds(aa,f.a.qg).forEach(fa=>{ca.BSd(fa);return!0});return{returnValue:!0,Eqj:ca,Tck:Y}}smg(aa,Y,X,ca,fa){let ja=!0;aa.forEach(ra=>{const ya=Y(ra);this.kf.getPropertyObjectIds(ya,f.a.qg).forEach(Ha=>{X.add(Ha);if(ca.mb(Ha))return(ja=ca.K(Ha).equals(ra)&&ja)||l.a.instance.Ua(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",
fa,Ha,ra,ca.K(Ha)),ja;ca.W(Ha,ra);return!0});return!0});return ja}BEm(aa,Y){let X,ca,fa,ja;X=new x.a;ca=new x.a;fa=new x.a;ja=new w.a;const ra=aa.runtime.Kn;return this.smg(Y.QKb,ya=>ra.K(ya),X,ja,"Base")&&this.smg(Y.UCf,ya=>this.$Ea.qAb(ya,aa.runtime.QA,ra),ca,ja,"Favored")&&this.smg(Y.vAb,ya=>this.$Ea.qAb(ya,aa.runtime.zv,ra),fa,ja,"Unfavored")?{returnValue:!0,NVh:X,bni:ca,J5j:fa,Kij:ja}:{returnValue:!1,NVh:X,bni:ca,J5j:fa,Kij:ja}}ram(aa,Y,X,ca){let fa=!0;const ja=aa.runtime.Kn,ra=aa.runtime.QA,
ya=aa.runtime.zv,Ha=aa.runtime.Yq,Wa=new x.a,Ma=new w.a;X.forEach(ua=>{const Ka=ca.K(ua);if(!Ka)return l.a.instance.Ua(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",ua),aa.logger.Ti(Object.assign(new y,{ek:"FinishInterOutlineGroupMerge",eventId:"aqgws"})),fa=!1;Ka.equals(Wa.last())||(Wa.add(Ka),Ma.add(Ka,new x.a));Ma.K(Ka).add(ua);aa.runtime.fUa.add(ua);return!0});if(!fa)return!1;Ma.forEach((ua,Ka)=>{const za=this.$Ea.n4j(ua,ra,ya,ja).$O();this.kf.setPropertyObjectIds(za,
f.a.qg,Ka);Ha.W(ua,new W.a(za));Ha.K(ua).cN(f.a.qg);aa.runtime.fUa.add(ua);return fa});X=this.$Ea.n4j(Y,ra,ya,ja).$O();this.kf.setPropertyObjectIds(X,f.a.qg,Wa);Ha.W(Y,new W.a(X));Ha.K(Y).cN(f.a.qg);aa.runtime.fUa.add(Y);return fa}LOn(aa,Y,X){let ca,fa;if(!({NVh:ja,bni:ca,J5j:fa,Kij:X}=this.BEm(aa,X)).returnValue)return!1;var ja=C.b(ja,ca,fa);ja=this.Aqj(aa,ja);return!!ja&&this.ram(aa,Y,ja,X)}Woe(aa,Y){return this.Bqj(aa,Y)}Bqj(aa,Y){if(Y.nre(f.a.qg)){var X=this.xEm(Y);X=this.Aqj(aa,X);if(!X)return l.a.instance.Ua(4220308,
1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",Y.eN.id),aa.logger.Ti(Object.assign(new y,{ek:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),K.a(Y.eN,"OutlineElementContainerThreewayChildMerge_Base",1),K.a(Y.psa,"OutlineElementContainerThreewayChildMerge_Favored",1),K.a(Y.PEa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ca=this.kf.getPropertyObjectIds(Y.eN,
f.a.qg);const fa=X.IS();ca.forEach(ja=>{fa.contains(ja)||(ja=this.kf.getPropertyObjectIds(Y.eN,f.a.aH),0<ja.length&&aa.runtime.xjg.add(ja.K(0)));return!0});ca=Y.psa.$O();this.kf.setPropertyObjectIds(ca,f.a.qg,X);aa.runtime.Yq.W(ca.id,new W.a(ca));aa.runtime.Yq.K(ca.id).cN(f.a.qg)}return!0}cjp(aa,Y){let X=Y.psa.hasProperty(f.a.qg),ca=Y.PEa.hasProperty(f.a.qg);X&&(X=!!this.kf.getPropertyObjectIds(Y.psa,f.a.qg).length);ca&&(ca=!!this.kf.getPropertyObjectIds(Y.PEa,f.a.qg).length);if(X!==ca)if(this.Uun(aa.runtime.qc))aa.logger.l$i(Object.assign(new P.a,
{info:"TableCell OE missing children, ghost cell likely touched"}));else return aa.logger.Ti(Object.assign(new P.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.Bqj(aa,Y)}xEm(aa){let Y,X;({cdl:aa,e7l:Y,qup:X}=this.Xrm(aa));return C.b(aa,Y,X)}Aqj(aa,Y){l.a.instance.Ua(4220309,1,5,"Considering {0} OutlineElement collections for merge.",Y.length);const X=new x.a;let ca=!0;Y.forEach(fa=>{if(!fa)return l.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),aa.logger.Ti(Object.assign(new y,
{ek:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ca=!1;if(1===fa.DPn&&1===fa.avb){const za=fa.QKb.K(0),Fa=fa.UCf.K(0),ea=fa.vAb.K(0);if(za&&za.equals(Fa)&&za.equals(ea))return X.add(za),!0;if(1!==Y.length)return l.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",za,Fa,ea,Y.length),aa.logger.Ti(Object.assign(new y,
{ek:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ca=!1}const ja=new w.a,ra=new x.a,ya=new x.a,Ha=new x.a,Wa=new x.a,Ma=new x.a,ua=new x.a,Ka=aa.runtime.Kn;fa.QKb.forEach(za=>ca=this.ung(aa,za,Fa=>Ka.K(Fa),ra,Wa,ja,"Base"));if(!ca)return l.a.instance.Ua(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),aa.logger.Ti(Object.assign(new y,{ek:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;fa.UCf.forEach(za=>ca=this.ung(aa,
za,Fa=>this.$Ea.qAb(Fa,aa.runtime.QA,Ka),ya,Ma,ja,"Favored"));if(!ca)return l.a.instance.Ua(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),aa.logger.Ti(Object.assign(new y,{ek:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;fa.vAb.forEach(za=>ca=this.ung(aa,za,Fa=>this.$Ea.qAb(Fa,aa.runtime.zv,Ka),Ha,ua,ja,"Unfavored"));if(!ca)return l.a.instance.Ua(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
aa.logger.Ti(Object.assign(new y,{ek:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;aa.runtime.qc&&aa.runtime.qc.Erb(1000005)&&(Ma.length&&this.d7l(Ma,aa.runtime.QA)?(this.YOh(Ma,aa,X,ja),this.zRd(aa,ja,ua)):this.YOh(ua,aa,X,ja));if(ra.length){fa=null;if(!({Yq:fa}=this.wao(aa,ra,ya,Ha,fa)).returnValue||!fa)return ca=!1;fa.forEach(za=>{0<za.Bbc.count&&aa.runtime.Yq.W(za.Gm.id,za);X.add(ja.K(za.Gm.id));return!0})}return!0});return ca?X:null}d7l(aa,Y){for(let X=0;X<aa.length;X++)if(Y.get(aa.tg(X).id))return!0;
return!1}zRd(aa,Y,X){X.length&&(X.forEach(ca=>{aa.runtime.yyc.add(ca.id);aa.runtime.yyc.add(Y.K(ca.id));return!0}),H.a.zRd(aa,this.kf,X.K(0)))}YOh(aa,Y,X,ca){aa.forEach(fa=>{const ja=new W.a(fa.$O());Y.runtime.Yq.W(fa.id,ja);X.add(ca.K(fa.id));return!0})}ung(aa,Y,X,ca,fa,ja,ra){var ya=X(Y);if(!ya)return l.a.instance.Ua(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",ra,Y),aa.logger.Ti(Object.assign(new y,{ek:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",
ra)})),!1;const Ha=this.kf.getPropertyObjectIds(ya,f.a.aH);if(!Ha||!Ha.length)return l.a.instance.Ua(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",ra,Y),aa.logger.Ti(Object.assign(new y,{ek:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",ra)})),K.a(ya,"ProcessOutlineElement_"+ra,1),!1;ya=Ha.tg(0);X=X(ya);if(!X)return l.a.instance.Ua(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",
ra,ya,Y),aa.logger.Ti(Object.assign(new y,{ek:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",ra)})),!1;if((ra=this.kf.getPropertyString(X,a.a.nQ))&&""!==ra&&aa.runtime.qc&&(aa.runtime.qc.l$d(1000005),aa.runtime.qc.Erb(1000005)))return fa.add(X),ja.add(ya,Y),aa.runtime.fUa.add(ya),!0;ca.add(X);ja.add(ya,Y);aa.runtime.fUa.add(ya);return!0}Xrm(aa){let Y,X;Y=this.kf.getPropertyObjectIds(aa.eN,f.a.qg);X=this.kf.getPropertyObjectIds(aa.psa,
f.a.qg);aa=this.kf.getPropertyObjectIds(aa.PEa,f.a.qg);return{cdl:Y,e7l:X,qup:aa}}Uun(aa){if(!aa)return l.a.instance.Ua(51422868,1,2,"Feature Helper is null"),!1;aa.kK(97);return aa.isFeatureEnabled(97)}static vsj(aa,Y){Y.mb(aa.wc)||Y.W(aa.wc,new x.a);Y.K(aa.wc).add(aa);return!0}}S.dpe=u.a.Af("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(I.a)(S,"ChildNodeListMerge",null,[1107])},1781:function(I,J,d){I=d(0);var m=d(1393),f=d(1590),a=d(1475),l=d(1424),w=d(1717),z=d(1494);class x{constructor(Y,
X){this.DimensionValue=this.DimensionName=null;this.DimensionName=Y;this.DimensionValue=X}}Object(I.a)(x,"Dimension",null,[]);class u{constructor(Y,X,ca,fa,ja){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=Y;this.Query=X;this.From=ca;this.Size=fa;ja&&(this.Filter=ja)}}Object(I.a)(u,"EntityRequest",null,[]);class v{constructor(Y){this.QueryString=null;this.QueryString=Y}}Object(I.a)(v,"Query",null,[]);var F=d(1395);class y{constructor(Y,X){this.Dimensions=this.Name=
null;this.Name=Y;this.Dimensions=X}}Object(I.a)(y,"Scenario",null,[]);var G=d(1398),C=d(1397);class H{constructor(Y,X,ca,fa){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=Y;this.TimeZone=X;this.Cvid=ca;this.Scenario=fa}}Object(I.a)(H,"SubstrateBody",null,[]);var K=d(1493),R=d(1389),E=d(1388),L=d(2),O=d(1711),V=d(1710),Z=d(1456),W=d(28),P=d(16),S=d(117);d.d(J,"a",function(){return aa});class aa{constructor(Y){this.gNc=this.Zkb=this.MHd=this.OHc=this.RNc=0;this.mwh=
this.Kzh=this.qT=null;this.i_e=0;this.u5=-1;this.JQc="";this.nTe=!1;this.Gf=L.AFrameworkApplication.Ge;this.jc=Y;this.HNd=this.BOf();this.dIb=new f.a;this.Euh=this.jc.ODe?3:2;this.kaf=this.jc.ODe&&this.jc.nVj?5:3;this.Adf=this.jc.lze?2:3;this.sLh=1;this.SGd=this.jc.bDi;this.PFh=this.jc.bun;this.SOc=Y.mHi;L.AFrameworkApplication.J&&(this.Kzh=L.AFrameworkApplication.J.jb("AppCatalogUrl")+L.AFrameworkApplication.J.jb("SearchPersonaPhotoBaseUrl"),this.nTe=this.jc.Rhc||this.jc.Ska||this.jc.Z0d);this.jc.Ska&&
(this.Adf=this.kaf=5)}zN(){return"Substrate"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:3}gK(Y,X,ca,fa=m.a.su,ja=null){const ra=new C.a(Y);if(!ja||Array.contains(ja,14)||Array.contains(ja,15)||Array.contains(ja,20))if(!this.i_e||window.performance.now()-this.i_e>=E.a.vfb)if(ca=this.dIb.SHi())this.i_e=window.performance.now(),ca.then(ya=>{ya&&""!==ya?(this.JQc=ya,""!==this.qT&&this.RHi(Y,fa,this.JQc,X,ja)):(R.TellMeActor.instance.We.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),
X.Qt(ra))},ya=>{R.TellMeActor.instance.We.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+ya);X.Qt(ra)});else{if(R.TellMeActor.instance.We)R.TellMeActor.instance.We.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");X.Qt(ra)}else this.JQc&&""!==this.JQc?this.RHi(Y,fa,this.JQc,X,ja):(X.Qt(ra),R.TellMeActor.instance.We.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else X.Qt(ra)}PDa(){this.Zkb=this.gNc=this.MHd=this.OHc=
this.RNc=0}RHi(Y,X,ca,fa,ja){this.PDa();const ra=new C.a(Y),ya=this.qT=S.a.create().toString();this.EIa();this.u5=window.setTimeout(()=>{if(ya===this.qT){this.qT="";this.u5=-1;fa.Qt(ra);const Ma={};Ma[a.a.provider]=this.zN();Ma[a.a.EYb]=Y.Zwb;R.TellMeActor.instance.We.lC(l.a.TIg,this.SOc,Ma)}},this.SOc);const Ha={"Content-Type":"application/json",Accept:"application/json"};Ha.Authorization="Bearer "+ca;Ha["X-Office-Version"]=L.AFrameworkApplication.buildVersion;Ha["X-Office-Application"]=L.AFrameworkApplication.J.jb("Application");
Ha["X-Office-Platform"]="WAC";Ha["X-TellMe-SessionId"]=R.TellMeActor.instance.z9d();Ha["X-TellMe-Culture"]=L.AFrameworkApplication.uiCulture;Ha["X-TellMe-ProcessSessionId"]=L.AFrameworkApplication.userSessionId;Ha["Client-Request-Id"]=ya;const Wa=window.performance.now();this.Gf.Xj(this.FNm(),2,this.GNm(Y.Wg,this.jc.application,R.TellMeActor.instance.z9d(),E.a.KU(Y)),Ha,!1,0,Ma=>{this.jXb(Ma,Y,fa,ya,Wa,X,ja)},Ma=>{this.RWb(Ma,Y,fa,ya,Wa)},null,null,!1,4E3,6E3)}EIa(){-1!==this.u5&&(window.clearTimeout(this.u5),
this.u5=-1)}jXb(Y,X,ca,fa,ja,ra,ya){R.TellMeActor.instance.We.Rba(X.Wg.length,this.HNd.join(","),Y.data.He.toString(),Math.round(window.performance.now()-ja),K.a.HZj,!0,z.a.IWa);const Ha=E.a.KU(X),Wa=new C.a(X);if(fa===this.qT){this.EIa();Y=W.b(Y.data.Ee);if(Y.Groups){Y=Y.Groups;for(const Ma of Y)"People"===Ma.Type&&this.jc.prd&&(ya?Array.contains(ya,14):1)?(Y=this.sEi(Ma.Suggestions,Ha,ra),0<Y.results.length&&Wa.kw(Y)):"File"===Ma.Type&&this.jc.nrd&&(ya?Array.contains(ya,15):1)?(Y=this.SJf(Ma.Suggestions,
Ha,ra),0<Y.results.length&&(this.lee()&&(fa=new F.a("GenerateSlidesFromTellMe",30,"",null,1),Y.jy(fa)),Wa.kw(Y))):"Notes"===Ma.Type&&this.jc.bub&&ra!==m.a.contextMenu&&(ya?Array.contains(ya,20):1)&&(Y=this.YCi(Ma.Suggestions,Ha,X),0<Y.results.length&&Wa.kw(Y))}ca.Qt(Wa);R.TellMeActor.instance.We.Rba(X.Wg.length,this.HNd.join(","),"",Math.round(window.performance.now()-ja),"",!0,z.a.provider)}else ca.Qt(Wa)}YCi(Y,X,ca){const fa=new G.a(20);fa.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;
for(const ja of Y)this.uwn(ja)&&(Y=ja.NotesType,Y=P.a.xh(Y),Y=this.pDm(Y,ja.LastModifiedTime,ja.BodyPreview,ja.Subject,X,ca,ja))&&(Y.groupType=20,fa.jy(Y));return fa}sEi(Y,X,ca){const fa=new G.a(14);fa.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const ra of Y)if(this.vwn(ra)){var ja=ra.Id.split("@")[0];Y=ra.EmailAddresses[0];let ya=ra.Type;if(void 0===ya||null===ya)ya="User";if(ja=this.FGm(ya,ra.DisplayName,ra.JobTitle,Y,ja,ca,X))ja.description=Y,Y=ra.JobTitle,"Department"in ra&&"CompanyName"in
ra&&(Y+="@"+ra.Department+"@"+ra.CompanyName),ja.hL=Y,fa.jy(ja)}return fa}SJf(Y,X,ca){const fa=new G.a(15);fa.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ma of Y)if(this.lwn(Ma)){var ja=Ma.FileName;Y=Ma.FileExtension;var ra=ja;ja.length>Y.length&&ra.endsWith(Y)&&(ra=ja.substr(0,ja.length-Y.length-1));var ya=void 0,Ha=0;"DateCreated"in Ma&&Ma.DateCreated?(Ha=E.a.oPf(Ma.DateCreated),ya=E.a.iJi(Ma.DateCreated),ya=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ma.Author,ya)):
ya=Ma.Author;var Wa=Ma.AccessUrl+"?web=1";const ua=P.a.ymc(Wa);ja=String.format('<a href="{0}">{1}</a>',ua,P.a.$_(ja));if(ca!==m.a.contextMenu||P.a.QX(Wa))if(ra=this.mtm(ra,ca===m.a.contextMenu?ja:Wa,ya,Ma.FileExtension,Ma.Text,X))ra.description=Ma.Author,ra.fSd=Ha,fa.jy(ra),this.nTe&&(Ha=Ma.AccessUrl,ja=E.a.v6d(Y),ya=Ma.DateModified?Ma.DateModified:Ma.DateCreated,Wa=Ma.Size?Ma.Size:Ma.FileSize,this.Q5o()&&(Ha=Ha.replace(RegExp("%20","g")," "),ja=E.a.AMm(Y)),Y=new w.a(ja,Ha,Ma.SPWebUrl,Ma.Id,Wa,ya),
R.TellMeActor.instance.dMg(!1,ra.value,Y))}return fa}RWb(Y,X,ca,fa,ja){fa===this.qT&&(this.EIa(),R.TellMeActor.instance.We.Rba(X.Wg.length,this.HNd.join(","),Y.data.He.toString(),Math.round(window.performance.now()-ja),K.a.HZj,!1,z.a.IWa));Y=new C.a(X);ca.Qt(Y)}FGm(Y,X,ca,fa,ja,ra,ya){ya=ya?this.sLh:this.Euh;if(!window.LPC&&!E.a.DYf()||this.RNc===ya)return null;this.RNc+=1;ya="PeopleSuggestion"+this.RNc.toString();var Ha=this.Kzh+"?size=1&accountName="+fa;Y=Object.assign(new O.a,{PersonaType:Y,Smtp:fa,
ProfilePictureUrl:Ha,AadObjectId:ja});const Wa=Object.assign(new V.a,{identifiers:Y,displayName:X});Y=ra===m.a.contextMenu;this.jc.qBa?(R.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(ya,Wa,X,ca)),ra===m.a.contextMenu&&(ca=E.a.Xai(X,fa,ja),R.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ya,ca))),R.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(ya,Y))):(Ha=[],Ha.push(appChrome.actions.setPersonaButtonCoauthor(ya,
Wa,X,ca)),ra===m.a.contextMenu&&(ca=E.a.Xai(X,fa,ja),Ha.push(appChrome.actions.setButtonCommandValueId(ya,ca))),Ha.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(ya,Y)),appChrome.api.dispatch(Ha));return new F.a(ya,11,X,fa,0)}pDm(Y,X,ca,fa,ja,ra,ya){if(ja&&!this.jc.s3i||this.MHd===this.SGd||this.gNc===this.SGd||this.Zkb===this.SGd)return null;var Ha=null;this.MHd+=1;ja="";const Wa=[],Ma={};ya.type="Notes";this.mwh=Object.assign(new Z.a,{landingTab:"Notes",data:ya});ra=E.a.HUa(ra.Wg,
33,this.mwh);if("onenotepagepreviews"===Y){if(!("ClickthroughUrl"in ya&&ya.ClickthroughUrl)||""===ya.ClickthroughUrl)return null;this.gNc+=1;ja="OnenoteNotesSuggestion"+this.gNc.toString();Ma["default"]="SaveAsonetoc2_20";Ha=ya.ClickthroughUrl;Wa.push(appChrome.actions.setControlIconSet(ja,Ma));Wa.push(appChrome.actions.setCompoundButtonCommandValueId(ja,Ha));Ha=new F.a(ja,19,null,null,0)}else if("stickynote"===Y){if(!this.PFh)return null;this.Zkb+=1;ja="NotesSuggestion"+this.Zkb.toString();Ma["default"]=
"ShowAllNotes_20";Wa.push(appChrome.actions.setControlIconSet(ja,Ma));Wa.push(appChrome.actions.setCompoundButtonCommandValueId(ja,ra));Ha=new F.a(ja,21,null,null,0)}else if("samsung"===Y){if(!this.PFh)return null;this.Zkb+=1;ja="NotesSuggestion"+this.Zkb.toString();Ma["default"]="CategoryCollapsed_20";Wa.push(appChrome.actions.setControlIconSet(ja,Ma));Wa.push(appChrome.actions.setCompoundButtonCommandValueId(ja,ra));Ha=new F.a(ja,20,null,null,0)}""!==ja&&(Y=E.a.iJi(X),Y=String.format(CommonUIStrings.l_LastModifiedString,
Y),Ha.label=fa,Ha.fSd=E.a.oPf(X),Wa.push(appChrome.actions.setControlLabel(ja,fa)),Wa.push(appChrome.actions.updateCompoundButtonDescription(ja,Y)),Wa.push(appChrome.actions.setControlCustomTooltip(ja,ca)),appChrome.api.dispatch(Wa));return Ha}mtm(Y,X,ca,fa,ja,ra){if(this.OHc===(ra?this.Adf:this.kaf)||this.nTe&&"Word"!==E.a.v6d(fa))return null;this.OHc+=1;ra="FileSuggestion"+this.OHc.toString();const ya=[],Ha={};Ha["default"]=E.a.Kwm(fa);this.jc.qBa?(R.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ra,
Y)),R.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ra,Ha)),R.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ra,ca)),R.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ra,X)),R.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ra,ja)),this.jc.Rhc&&R.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonSecondaryButtonId(ra,"QuickActionOnFile"))):(ya.push(appChrome.actions.setControlLabel(ra,
Y)),ya.push(appChrome.actions.setControlIconSet(ra,Ha)),ya.push(appChrome.actions.updateCompoundButtonDescription(ra,ca)),ya.push(appChrome.actions.setCompoundButtonCommandValueId(ra,X)),ya.push(appChrome.actions.setControlCustomTooltip(ra,ja)),this.jc.Rhc&&ya.push(appChrome.actions.setCompoundButtonSecondaryButtonId(ra,"QuickActionOnFile")),appChrome.api.dispatch(ya));return new F.a(ra,6,Y,ca,0)}BOf(){const Y=[];this.jc.prd&&Array.add(Y,"People");this.jc.nrd&&Array.add(Y,"File");this.jc.bub&&Array.add(Y,
"Notes");return Y}GNm(Y,X,ca,fa){var ja=new v(Y);Y=new u("File",ja,0,fa?this.Adf:this.kaf,null);fa=new u("People",ja,0,fa?this.sLh:this.Euh,E.a.yco);ja=new u("Notes",ja,0,this.SGd,null);(this.jc.Rhc||this.jc.Z0d)&&"powerpoint"===X.toLowerCase()&&(X="word");X=new x("app",X.toLowerCase());var ra=[];Array.add(ra,X);X=new y("tellmesearch",ra);ra=[];this.jc.nrd&&Array.add(ra,Y);this.jc.prd&&Array.add(ra,fa);this.jc.bub&&Array.add(ra,ja);ca=new H(ra,"UTC",ca,X);return W.c(ca)}FNm(){let Y=this.jc.thp;this.jc.bub&&
(Y+="?&setflight=NotesFrom3S");""!==this.jc.THi&&(Y=Y+"&"+this.jc.THi);return Y}vwn(Y){return"DisplayName"in Y&&"Id"in Y&&"EmailAddresses"in Y&&!!Y.Id&&!!Y.EmailAddresses}lwn(Y){return"FileExtension"in Y&&!!Y.FileExtension&&"FileName"in Y&&!!Y.FileName&&""!==Y.FileName&&"AccessUrl"in Y&&!!Y.AccessUrl&&""!==Y.AccessUrl}uwn(Y){return"Id"in Y&&!!Y.Id&&"NotesType"in Y&&!!Y.NotesType&&"Subject"in Y&&!!Y.Subject&&""!==Y.Subject}lee(){return!!L.AFrameworkApplication.J&&L.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",
!1)}Q5o(){return!!L.AFrameworkApplication.J&&L.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(I.a)(aa,"SubstrateResultsProvider",null,[1024])},1783:function(I,J,d){I=d(0);var m=d(58),f=d(32),a=d(5),l=d(13),w=d(177),z=d(85),x=d(183),u=d(221),v=d(605),F=d(46),y=d(357),G=d(2),C=d(1337),H=d(951),K=d(1335);class R{constructor(ja,ra=0){this.wtf=null;this.fkg=0;this.bM=ja;this.g9f=ra}}Object(I.a)(R,"GraphMergerResponse",null,[]);var E=
d(108),L=d(1),O=d(91),V=d(877),Z=d(1457),W=d(1532);class P extends W.a{constructor(){super();this.NXj=null;this.$bk=!1}get mfa(){return"Crash"}WPb(){this.detail.W("Type",this.mfa);this.detail.W("Trace",this.Xqp(this.NXj));this.detail.W("Continue",this.$bk);return this.detail}Xqp(ja){ja=ja.split("\n");const ra=4<ja.length?4:ja.length,ya=new Sys.StringBuilder;for(let Ha=0;Ha<ra;Ha++)Ha===ra-1?ya.append(String.format("{0}...",ja[Ha])):ya.append(String.format("{0}\n",ja[Ha]));return ya.toString()}}Object(I.a)(P,
"CrashMergeFailureDetail",W.a,[]);var S=d(2008),aa=d(1479),Y=d(1625),X=d(1458);class ca{constructor(){this.Sel=new y.a;this.Mxl=new y.a;this.gBl=new y.a}}Object(I.a)(ca,"RangeMarkers",null,[]);d.d(J,"a",function(){return fa});class fa{constructor(){this.k$d=0;this.dkh=this.Mib=this.y9b=this.wg=this.KCh=this.S$b=null;this.Cuh=0;this.jrh=50;this.Bhh=this.dbh=null}get Mdb(){return this.S$b}get VKo(){return this.KCh}get kf(){return this.wg}get dvb(){return this.y9b}get ELi(){return this.Mib}get CUm(){return this.dkh}get Drc(){return this.Cuh}get j2h(){return this.dbh}get v0c(){return this.Bhh}SVb(ja,
ra,ya,Ha,Wa,Ma,ua){ya=this.OIl(ja,ra,Ha,Wa,Ma,ua,this.v0c);Ha=0;const Ka=ya.runtime.qze;let za=null;try{this.aHn(Ka,ya,ua,ja,ra,Wa,Ma);let Fa=K.a.success;for(;Ha<this.dvb.length;Ha++)if(!(0,this.dvb[Ha])(ya)){Fa=K.a.Kk;ya.logger.xie("GraphMerger.GetMergeFunctions()",Ha);break}return za=new R(ya.output.bM,Fa)}catch(Fa){const ea=!ya.output.timeout;ya.output.Qza=ea;const la=this.o6d(Fa),Na=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",ea?"Crashed":"Timed Out",
ya.input.UVb,!!ya.output.bM,la);ea?(w.a.instance.Ua(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Na),ya.logger.Ti(Object.assign(new P,{NXj:la,$bk:!!ya.output.bM}))):w.a.instance.Ua(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",Na);if(ya.output.bM)return za=new R(ya.output.bM,K.a.Kk);throw Fa;}finally{ya.output.succeeded?this.YGn(Ka,ya,Ha):ya.output.timeout?this.$Gn(ya,Ha):ya.output.Qza?ya.output.bM?this.ZGn(ya,Ha):this.XGn(ya,Ha):this.WGn(ya,Ha);ya.logger.VGn();w.a.instance.foa(42350232,1,ya.output.succeeded?
4:2,"MergeLogger",ya.logger.YAm());ya.logger.Wcd.FNi()&&w.a.instance.foa(559015903,1,2,"MarkerInfo",ya.logger.Wcd.toString());if(ya.runtime.qc&&ya.runtime.qc.isFeatureEnabled(65))try{this.rEn(ya)}catch(Fa){w.a.instance.Ua(571619421,1,4,"Error logging references: {0}",Fa.toString())}this.HHn(ya);za.fkg|=(ya.output.succeeded?2:1)<<2*(ua-1);if(za)try{za.wtf=this.Ogo(ya)}catch(Fa){w.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",Fa)}}}HHn(ja){if(!ja.output.succeeded){ja=ja.output.timeout?
"Timeout":ja.logger.hxj?ja.logger.hxj.mfa:"Unknown";const ra=new O.a;z.Health.instance.recordQosError(ja,["MergeFailure"],!0,!0,!1,!1,ra)}}rEn(ja){const ra=Wa=>{const Ma=this.uKa()-ja.input.d0a>this.Drc;if(0<this.Drc&&Ma)throw w.a.instance.Ua(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Wa),x.a.invalidOperation(Wa);};let ya=ja.runtime.QA.keys,Ha=Wa=>ja.runtime.QA.K(Wa);this.k6f(ja,ra,ya,Ha,"Favored");ya=ja.runtime.zv.keys;Ha=Wa=>ja.runtime.zv.K(Wa);this.k6f(ja,ra,ya,Ha,
"Unfavored");ya=ja.runtime.Yq.keys;Ha=Wa=>{const Ma=ja.runtime.Yq.K(Wa);return Ma?Ma.Gm:ja.runtime.QA.K(Wa)};this.k6f(ja,ra,ya,Ha,"Merged")}k6f(ja,ra,ya,Ha,Wa){var Ma=new u.a;const ua=new u.a;for(let Ka=0;Ka<ya.length;Ka++){ra("LogAddedAndDeletedNodes");const za=Ha(ya.K(Ka));if(za.wc===m.a.loa)continue;const Fa=ja.runtime.Kn.K(za.id);Fa&&this.sEn(Ma,ua,za,Fa)}this.eaj(ua,Ka=>ja.runtime.Kn.K(Ka),ra);this.eaj(Ma,Ha,ra);ra=new Sys.StringBuilder;for(ya=0;ya<Ma.length;ya++)ra.append(Ma.K(ya).toString()+
",");Ma=new Sys.StringBuilder;for(ya=0;ya<ua.length;ya++)Ma.append(ua.K(ya).toString()+",");w.a.instance.foa(571619423,1,4,Wa+" revision: Added references",ra.toString());w.a.instance.foa(571619424,1,4,Wa+" revision: Deleted references",Ma.toString())}sEn(ja,ra,ya,Ha){const Wa=ya.fk();for(let ua=0;ua<Wa.length;ua++){const Ka=Wa[ua];if(this.tVi(Ka)){var Ma=this.kf.getPropertyObjectIds(ya,Ka);this.gGn(ja,ra,Ha,Ka,Ma)}else this.b0i(Ka)&&(Ma=this.kf.getPropertyObjectId(ya,Ka),this.fGn(ja,ra,Ha,Ka,Ma))}}eaj(ja,
ra,ya){ya("LogNestedReferences");ya=new u.a;const Ha=new v.a;for(let Wa=0;Wa<ja.length;Wa++){const Ma=ja.K(Wa);this.N6f(Ma,ya,Ha,ra)}for(ra=0;ra<ya.length;ra++)ja.add(ya.K(ra))}N6f(ja,ra,ya,Ha){const Wa=Ha(ja);if(Wa){const ua=Wa.fk();for(let Ka=0;Ka<ua.length;Ka++){var Ma=ua[Ka];if(this.tVi(Ma)){Ma=this.kf.getPropertyObjectIds(Wa,Ma);for(let za=0;za<Ma.length;za++)ya.contains(Ma.K(za))||(ra.add(Ma.K(za)),ya.add(Ma.K(za)),this.N6f(Ma.K(za),ra,ya,Ha))}else this.b0i(Ma)&&(Ma=this.kf.getPropertyObjectId(Wa,
Ma),ya.contains(Ma)||(ra.add(Ma),ya.add(Ma),this.N6f(ja,ra,ya,Ha)))}}}gGn(ja,ra,ya,Ha,Wa){if(this.kf.hasProperty(ya,Ha)){ya=this.kf.getPropertyObjectIds(ya,Ha);const Ma=ya.IS();Ha=Wa.IS();for(let ua=0;ua<Wa.length;ua++)Ma.contains(Wa.K(ua))||ja.add(Wa.K(ua));for(ja=0;ja<ya.length;ja++)Ha.contains(ya.K(ja))||ra.add(ya.K(ja))}else for(ra=0;ra<Wa.length;ra++)ja.add(Wa.K(ra))}fGn(ja,ra,ya,Ha,Wa){Wa&&(this.kf.hasProperty(ya,Ha)?(ya=this.kf.getPropertyObjectId(ya,Ha),Wa.equals(ya)||(ja.add(Wa),ra.add(ya))):
ja.add(Wa))}UGn(ja){w.a.instance.Ua(4535064,1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",ja.input.UVb,ja.output.Qza,ja.output.timeout)}aHn(ja,ra,ya,Ha,Wa,Ma,ua){if(ja){ja=Ha.length?Ha.tg(Ha.length-1):null;var Ka=Wa.length?Wa.tg(Wa.length-1):null;ya=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",
ra.input.UVb,Ha.length,ja?ja.id:F.a.nil,ja?ja.KJ?ja.KJ.id:F.a.nil:F.a.nil,Wa.length,Ka?Ka.id:F.a.nil,Ka?Ka.KJ?Ka.KJ.id:F.a.nil:F.a.nil,Ma,ua,this.Drc,ya);switch(ra.input.source){case 5:w.a.instance.Ua(51663493,1,4,ya);break;default:w.a.instance.Ua(4051606,1,4,ya)}}}YGn(ja,ra,ya){if(ja)switch(ja=this.c3c(ra,ya,"Succeeded"),ra.input.source){case 5:w.a.instance.Ua(51663494,1,4,ja);break;default:w.a.instance.Ua(4059162,1,4,ja)}}$Gn(ja,ra){ra=this.c3c(ja,ra,"Timeout");switch(ja.input.source){case 5:w.a.instance.Ua(51663495,
1,4,ra);break;default:w.a.instance.Ua(4059163,1,2,ra)}}WGn(ja,ra){ra=this.c3c(ja,ra,"Rejection");switch(ja.input.source){case 5:w.a.instance.Ua(51663496,1,4,ra);break;default:w.a.instance.Ua(4059164,1,2,ra)}}ZGn(ja,ra){ra=this.c3c(ja,ra,"Crash - Rejection");switch(ja.input.source){case 5:w.a.instance.Ua(51663497,1,4,ra);break;default:w.a.instance.Ua(4059165,1,2,ra)}}XGn(ja,ra){ra=this.c3c(ja,ra,"Crash - Failed");switch(ja.input.source){case 5:w.a.instance.Ua(51663498,1,4,ra);break;default:w.a.instance.Ua(4059166,
1,2,ra)}}c3c(ja,ra,ya){const Ha=ja.output.bM,Wa=Ha&&Ha.length?Ha.tg(Ha.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",ja.input.UVb,ya,this.uKa()-ja.input.d0a,ra,Ha?Ha.length:0,Wa?Wa.id:F.a.nil,Wa?Wa.KJ?Wa.KJ.id:F.a.nil:F.a.nil,ja.input.source)}OIl(ja,ra,ya,Ha,Wa,Ma,ua){const Ka=new S.a,za=Ka.input;za.Sca=ja;za.j1a=ra;za.kl=ya;za.Gma=Ha;za.cSb=Wa;za.source=
Ma;za.v0c=ua;za.d0a=this.uKa();Ka.logger.s0o(za.d0a);ja=Ka.runtime;ja.ppd=w.a.instance.x4(1,5);ja.qze=w.a.instance.x4(1,4);let Fa="";ja.gJ=ea=>{if(this.Drc){var la=this.uKa()-za.d0a,Na=la>this.Drc;Fa+=String.format(" ({0}: {1})",ea,la);Na&&(Ka.output.timeout=!0,ea=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",za.UVb,this.Drc,ea,la,Fa),w.a.instance.Ua(528061012,1,2,ea),this.qmp(ea))}};return Ka}U3c(){return[Object(E.a)(this,
this.O8n,"otherAuthorsHaveChangesToMerge"),Object(E.a)(this,this.Bnn,"isInputValid"),Object(E.a)(this,this.d$m,"initializeOutputMergeState"),Object(E.a)(this,this.Kbe,"initializeRuntimeMergeState"),Y.a.qgo,Object(E.a)(this.j2h,this.j2h.TNn,"mergeChildNodeLists"),Object(E.a)(this,this.Dsp,"tryObjectMerge"),Y.a.Ufo,Object(E.a)(this,this.h9l,"finalizeObjectMerge"),Object(E.a)(this,this.mGp,"validateMarkers"),Object(E.a)(this,this.HYk,"addMergeResultsToOutput")]}O8n(ja){const ra=ja.input.Sca;ja=ja.output;
return ra?ra.length?!0:(w.a.instance.Ua(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),ja.bM=ra,ja.succeeded=!0,!1):(w.a.instance.Ua(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),ja.bM=ra,ja.succeeded=!0,!1)}Bnn(ja){var ra=ja.input;const ya=ra.Sca,Ha=ra.j1a,Wa=ra.kl,Ma=ra.Gma;ra=ra.cSb;ja=ja.output;if(!Ha||!Ha.length)return w.a.instance.Ua(42350233,1,5,"IsInputValid: No local changes to merge."),ja.bM=ya,ja.succeeded=
!0,!1;let ua=!0;if(2!==Ma&&1!==Ma)return ja.bM=ya,!1;Wa&&Wa!==F.a.nil||(ua=!1);ya.length<(ra?2:1)&&(w.a.instance.Ua(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",ra),ua=!1);ua||(ja.bM=2===Ma?ya:Ha);return ua}Kbe(ja){var ra=ja.input,ya=ra.Sca,Ha=ra.j1a,Wa=ra.Gma,Ma;let ua;({FIg:Ma,OPg:ua,MIa:ra}=this.iLf(ja,ya,Ha,ra.cSb));if(!ra)return w.a.instance.Ua(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",
Ma.id,ua.id),ja.logger.Ti(Object.assign(new Z.a,{ek:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.vaj(Ma,ya.length,"TheirChanges"),this.vaj(ua,Ha.length,"YourChanges"),ja.output.bM=2===Wa?ya:Ha,!1;ja.runtime.MIa=ra;({rup:ya,f7l:Ha}=this.gUl(Wa,Ma,ua));({tup:ra,g7l:Wa,fdl:Ma}=this.vBm(ja,ya,Ha,ra));ja.runtime.Kn=Ma;ja.runtime.zv=ra;ja.runtime.QA=Wa;ja.runtime.Yq=new y.a;ja.runtime.y2d=Ha.id;ja.runtime.CEe=ya.id;ja.runtime.Avb=new y.a;ja.runtime.fUa=
new v.a;ja.runtime.swf=new y.a;ja.runtime.Vyl=new y.a;ja.runtime.ljp=new y.a;ja.runtime.kte=new ca;ja.runtime.Mje=new u.a;ja.runtime.xjg=new v.a;ja.runtime.yyc=new u.a;ja.runtime.qc=ja.input.v0c(ja);ja.runtime.qc.RSc(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",f.a.ilp);ja.runtime.qc.RSc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",f.a.snp);ja.runtime.qc.RSc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",
f.a.O6l);ja.runtime.qc.RSc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",f.a.GAo);ja.runtime.qc.RSc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix","79ee6190;i588c310",f.a.hOn);ja.runtime.cSi=!0;G.AFrameworkApplication.J&&(this.jrh=G.AFrameworkApplication.J.fc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}vaj(ja,ra,ya){const Ha=new u.a;for(;ja;)Ha.add(ja),ja=ja.KJ;const Wa=new Sys.StringBuilder;Wa.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",
ya,ra,Ha.length));let Ma=Ha.length,ua=0;Ha.forEach(Ka=>({QPi:Ma,Saj:ua}=this.A_k(Wa,Ka,Ha,Ma,ua)).returnValue);w.a.instance.Ua(4273302,1,4,Wa.toString())}A_k(ja,ra,ya,Ha,Wa){ja.append(String.format(" [{0} {1} {2}]",Ha,ra.pma?"S":"B",ra.id));Ha--;Wa++;return 50<Wa&&ya.length!==Wa?(ja.append(" ...Truncated."),{returnValue:!1,QPi:Ha,Saj:Wa}):{returnValue:!0,QPi:Ha,Saj:Wa}}iLf(ja,ra,ya,Ha){ra=ra.tg(ra.length-1-(Ha?1:0));ya=ya.tg(ya.length-1);Ha=ra.KVa(ya);ja.runtime.gJ("GetCommonBase");ja.logger.Dbb("GetCommonBase");
return{FIg:ra,OPg:ya,MIa:Ha}}vBm(ja,ra,ya,Ha){let Wa,Ma;({result:Wa}=ra.VVb(Ha));ja.runtime.gJ("GetUnfavoredChanges");ja.logger.Dbb("GetUnfavoredChanges");({result:Ma}=ya.VVb(Ha));5===ja.input.source&&(ja.runtime.j7l=V.a.PFi(ya),ja.runtime.vup=V.a.PFi(ra));ja.runtime.gJ("GetFavoredChanges");ja.logger.Dbb("GetFavoredChanges");ra=new C.a(Object(E.a)(Ha,Ha.GKa,"getMergeableObject"));ja.runtime.gJ("GetModifiedObjects");ja.logger.Dbb("GetModifiedObjects");return{tup:Wa,g7l:Ma,fdl:ra}}gUl(ja,ra,ya){2===
ja?(ja=ra,ra=ya):ja=ya;return{rup:ra,f7l:ja}}d$m(ja){const ra=ja.input,ya=ra.Sca,Ha=ra.j1a;ja.output.bM=(2===ra.Gma?ya:Ha).iOa();ja.runtime.gJ("InitializeOutputMergeState");ja.logger.Dbb("InitializeOutputMergeState");return!0}HYk(ja){var ra=ja.input.kl;const ya=ja.runtime.Yq,Ha=ja.output.bM;ra=this.PIl(ja,Ha.tg(Ha.length-1),ra,F.a.create());this.F8l(ja,ra,ya);Ha.add(ra);return ja.output.succeeded=!0}PIl(ja,ra,ya,Ha){ja.runtime.qze&&w.a.instance.Ua(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",
ya,Ha);ja=this.VKo(Ha);ja.aWh(ra,ya);return ja}F8l(ja,ra,ya){ja.runtime.qze&&w.a.instance.Ua(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",ya.count);ya.forEach((Ha,Wa)=>{ra.Pcc(Wa.Gm);return!0})}Dsp(ja){return this.I4j(ja,!1)}h9l(ja){return this.I4j(ja,!0)}I4j(ja,ra){const ya=ja.runtime,Ha=ya.Kn,Wa=ya.QA,Ma=ra?ya.swf:ya.zv,ua=ya.Yq;let Ka=!0;const za=ja.runtime.ppd;let Fa=0,ea=0,la=0;Ma.forEach((Na,Aa)=>{za&&w.a.instance.Ua(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",
Na,Aa.wc,ra);ea++;this.jrh===ea&&(Fa++,ja.runtime.gJ(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",Fa,la,ra)),ea=0);if(ja.runtime.qc&&ja.runtime.qc.Erb(1000005)&&ja.runtime.yyc.contains(Aa.id,(Pa,Ta)=>Pa.equals(Ta))||this.Abp(Aa.wc))return!0;if(!ra&&this.FQl(Aa.wc,ja.runtime.qc))return ya.swf.W(Na,Aa),!0;var wa=Wa.get(Na);if(!wa)return ua.mb(Na)?ua.K(Na).kej(Aa):ua.W(Na,new X.a(Aa,!1)),!0;if(!Ha.K(Na)&&!this.KOn(wa.wc)){var va=!!ja.input.Sca&&!!ja.input.Sca.last()&&
ja.input.Sca.last().y3(Na);const Pa=!!ja.input.j1a&&!!ja.input.j1a.last()&&ja.input.j1a.last().y3(Na),Ta=new aa.a(wa,Aa);if(!Ta.s3)return ua.W(Na,new X.a(wa,!1)),!0;w.a.instance.Ua(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",Na,Aa.wc,ra,va,Pa,!Ta.s3,ja.input.source);ja.logger.Ti(Object.assign(new Z.a,{ek:"GraphMerger.TryObjectMerge",
eventId:"ap3k8"}));return Ka=!1}va=ua.e3(Na,new X.a(Ha.K(Na)));({Yl:wa,returnValue:Ka}=this.CUm.merge(ja,this.ELi,this.kf,va,wa,Aa));la++;Ka&&(ja.runtime.gJ(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",Na,Aa.wc,la,Fa,ra)),wa&&(ua.mb(wa.Gm.id)?ua.K(wa.Gm.id).kej(wa.Gm):ua.W(wa.Gm.id,wa)));return Ka});ja.logger.Dbb("ObjectMerge");za&&w.a.instance.Ua(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",Ma.count,
la,ra);return Ka}mGp(ja){try{for(let ra=0;ra<ja.runtime.Mje.length;ra++){const ya=ja.runtime.Mje.K(ra);if(ja.runtime.Yq.K(ya)){if(!this.Uon(ja,ya))return!1}else w.a.instance.Ua(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");ja.runtime.gJ("Validate markers taking too long")}}catch(ra){w.a.instance.Ua(559535579,1,2,"ValidateMerge threw an exception: {0}",ra)}return ja.logger.Wcd.FNi()?!1:!0}l7o(ja){return 38===ja||39===ja||40===ja||41===ja||44===ja||45===ja||33===ja||34===ja?!1:
!0}IAm(ja){switch(ja){case 38:case 39:case 40:case 41:return a.a.se;case 44:case 45:return a.a.ITd;case 33:case 34:return a.a.pk}return H.CommonProperties.nil}lGp(ja,ra){const ya=this.kf.getPropertyUint32(ja,a.a.ht);if(!ya||this.l7o(ya))return!0;ja=this.kf.getPropertyObjectId(ja,this.IAm(ya));return fa.lkc(ra,ja)?!0:(ra.logger.Wcd.yce=ya,!1)}Uon(ja,ra){if(ja.runtime.xjg.contains(ra))return!1;if(ra=fa.lkc(ja,ra)){ra=this.kf.getPropertyObjectIds(ra,l.a.Zn);for(let ya=0;ya<ra.length;ya++){const Ha=fa.lkc(ja,
ra.tg(ya));if(Ha&&!this.lGp(Ha,ja))return!1}}return!0}Abp(ja){switch(ja){case m.a.dIa:case m.a.vdc:case m.a.zKb:case m.a.sdc:case m.a.SEa:case m.a.loa:return!0}return!1}FQl(ja,ra){let ya=!1;if(ja===m.a.Wd)return!0;ra&&ra.kK(115);ra&&ra.isFeatureEnabled(115)&&ja===m.a.$mb&&(ya=!0);return ya}KOn(ja){switch(ja){case m.a.Ezc:return!0}return!1}fLl(ja,ra){const ya=new u.a,Ha=new u.a,Wa=new u.a;var Ma=ja.runtime.MIa;const ua=Ma?Ma.id:F.a.nil;this.H4f(Ma).forEach(Ka=>{ya.add(ra(Ka));return!0});Ma=ja.input.Sca.tg(ja.input.Sca.length-
1);this.H4f(Ma,ua).forEach(Ka=>{Ha.add(ra(Ka));return!0});ja=ja.input.j1a.tg(ja.input.j1a.length-1);this.H4f(ja,ua).forEach(Ka=>{Wa.add(ra(Ka));return!0});return{edl:ya,Qlp:Ha,$Mp:Wa}}H4f(ja,ra=null){const ya=new u.a;ra||(ra=F.a.nil);for(;ja&&!ra.equals(ja.id);)ya.add(ja),ja=ja.KJ;ya.reverse();return ya}Rhp(ja){const ra=3===this.k$d;let ya=!1;!ja.output.succeeded&&(2===this.k$d||ja.output.Qza&&1===this.k$d)&&(ya=!0);let Ha=!1;ja.input.Sca&&0<ja.input.Sca.length&&(ra||ya)&&ja.runtime.QA&&ja.runtime.Kn&&
ja.runtime.qc&&(Ha=ja.runtime.qc.isFeatureEnabled(44));return Ha}tVi(ja){return 9===L.a.srb(L.a.OFf(ja))}b0i(ja){return 8===L.a.srb(L.a.OFf(ja))}static ovm(ja){return ja.output.Qza?2:ja.output.succeeded?3:1}static lkc(ja,ra){if(!ra||ra===F.a.nil)return null;const ya=ja.runtime.Yq.K(ra);return ya?ya.Gm:ja.runtime.Kn.K(ra)}}fa.i$d=F.a.Af("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");Object(I.a)(fa,"GraphMergerBase",null,[1030])},1792:function(I,J,d){I=d(0);var m=d(72),f=d(1393),a=d(1590),l=d(1475),w=
d(1424),z=d(1494),x=d(1395),u=d(1398),v=d(1397),F=d(1389),y=d(1388);class G{constructor(S){this.jc=S;this.HNd=this.BOf()}zN(){return"Add-ins"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:3}gK(S,aa){S=new v.a(S);aa.Qt(S)}Mrb(S,aa,Y){let X;X=this.jc.AS?new u.a(29):new u.a(27);X.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;Y&&this.fap(S.Wg,aa,X)}fap(S,aa,Y){const X=[];let ca;ca=this.jc.Xfn?this.jc.AS&&this.jc.Mmb?y.a.Cqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,
S)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,S):this.jc.Yfn?this.jc.AS&&this.jc.Mmb?y.a.Cqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,S)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,S):this.jc.AS&&this.jc.Mmb?y.a.Cqb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,S)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,S);this.jc.qBa?(F.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
ca)),F.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",S))):(X.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ca)),X.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",S)),appChrome.api.dispatch(X));Y.jy(new x.a("LaunchAddinDialogFromTellMe",29));aa.kw(Y)}BOf(){const S=[];this.jc.Xce&&Array.add(S,"Addin");return S}}Object(I.a)(G,"AddinStoreResultsProvider",null,[1024]);var C=d(1744),H=d(1459),
K=d(1476),R=d(1745),E=d(1781),L=d(1746),O=d(1493),V=d(2),Z=d(28),W=d(117);d.d(J,"a",function(){return P});class P{constructor(S,aa,Y){this.olb=this.cQc=this.dQc=this.NMd=!1;this.qT=null;this.u5=-1;this.i5a=this.YQc=this.Gja=this.NIb=null;this.xsh=this.Gsh=0;this.jc=S;const X=y.a.Hta();this.pib=aa||[];this.Gf=V.AFrameworkApplication.Ge;this.jFh=S.gig;this.eQc=S.fig;this.LMd=X&&this.O0b();this.MMd=X&&this.P0b();this.lFh=X&&this.Q0b();this.PMd=this.R0b();this.S8e=this.Xxc();if((aa=S.qGg&&y.a.eCg(S))||
S.Ska)this.NIb=new E.a(S),this.NMd=S.nrd;aa&&(this.dQc=S.prd,this.cQc=S.bub,this.olb=this.NMd&&this.Ay("File")||this.dQc&&this.Ay("People")||this.cQc&&this.Ay("Notes"));this.KMd=this.J6o();this.gQc=S.bgd;this.OMd=this.c7o();this.R8e=this.I6o();this.Gac=this.kze();this.gda=this.nPm();this.D9g=new C.a(S);this.Wzk=new R.a(S);this.NQk=new L.a(S);this.Hnk=new G(S);this.SOc=Y;this.dIb=new a.a;this.gQc&&(this.D9g=new C.a(S));S.Ska&&(this.R8e=this.OMd=this.gQc=this.olb=this.cQc=this.dQc=this.S8e=this.PMd=
this.lFh=this.MMd=this.LMd=this.eQc=!1,V.AFrameworkApplication.J&&this.Ay("File")&&this.fUj()||this.Gac)&&(S=this.dIb.rPf("Search",V.AFrameworkApplication.J.jb("TellMeServiceAuthEndpointForSearch")),this.x0c(S,"TellMeService",!0),S=this.dIb.rPf("SmartLookup",V.AFrameworkApplication.J.jb("SmartLookupShredderServiceEndpoint")),this.x0c(S,"Shredder",!1));V.AFrameworkApplication.J&&this.olb&&this.Ay("File")&&this.fUj()&&(S=this.dIb.rPf("Search",V.AFrameworkApplication.J.jb("TellMeServiceAuthEndpointForSearch")),
this.x0c(S,"TellMeService",!0))}Ay(S){return Array.contains(this.pib,S)?!0:!1}zN(){return"TellMeService"}rX(){return 0===this.jc.nw?0:1===this.jc.nw?1:this.Ay("Command")||this.Ay("Recommended")?2:3}kPm(S){let aa="";if(!S&&this.Ay("Command")&&this.jc.A_f){aa+="CommandSearch_DLIS,";var Y=this.jc.B0j;0<Y.length&&(aa+=Y+",")}S&&this.Ay("Recommended")&&this.eQc&&(Y=this.sTm(),0<Y.length&&(aa+=Y+","));!S&&this.Ay("Help")&&(S=this.jc.A0j,0<S.length&&(aa+=S+","));this.jc.Ska&&this.i5a&&0<this.i5a.length&&
(aa+="IsRecallEnabled_true,");(this.jc.Rhc||this.jc.Z0d||this.jc.Ska)&&this.olb&&(aa+="IsGenerateSlidesEnabled_true,");0<aa.length&&(aa=aa.substr(0,aa.length-1));return aa}x0c(S,aa,Y){const X=Y?this.Gsh:this.xsh;if(!X||window.performance.now()-X>=y.a.vfb)if(S)Y?this.Gsh=window.performance.now():this.xsh=window.performance.now(),S.then(ca=>{Y?this.YQc=ca:(this.i5a=ca,F.TellMeActor.instance.gEg=ca)},ca=>{F.TellMeActor.instance.We.onError("TellMeServiceProvider:FetchTokenForService_"+aa,"tellMeServiceToken promise rejected: "+
ca)});else if(F.TellMeActor.instance.We)F.TellMeActor.instance.We.onError("TellMeServiceProvider:FetchTokenForService_"+aa,"undefined token promise")}gK(S,aa,Y,X=f.a.su,ca=null){const fa=new v.a(S);Y=y.a.KU(S);this.Ay("File")&&(this.olb||this.jc.Ska)&&this.x0c(this.dIb.oPm(),"TellMeService",!0);(this.Ay("File")&&this.jc.Ska||this.Ay("ActionAI")&&this.Gac)&&this.x0c(this.dIb.nMm(),"Shredder",!1);var ja=this.olb&&!!this.YQc;const ra=this.jc.Ska&&!!this.i5a;var ya=ja||ra||Y&&this.Ay("Recommended")&&
this.eQc;ja=ja||ra||!Y&&(this.jFh&&this.Ay("Command")||this.LMd&&this.Ay("Answer")||this.MMd&&this.Ay("Definition")||this.S8e&&this.Ay("Image")||this.gQc&&this.Ay("Help")||this.PMd&&this.Ay("WolframAnswer")||this.OMd&&this.Ay("Template")||this.R8e&&this.Ay("Addin"));if(ya||ja)if(this.Gja=X,X={"Content-Type":"application/json",Accept:"application/json"},X["X-Office-Version"]=V.AFrameworkApplication.buildVersion,X["X-Office-Application"]=V.AFrameworkApplication.J.jb("Application"),X["X-Office-Platform"]=
"WAC",X["X-TellMe-SqmUserId"]=V.AFrameworkApplication.J.jb("LoggableUserId")||"",X["X-TellMe-SessionId"]=F.TellMeActor.instance.z9d(),this.YQc&&(X.Authorization="Bearer "+this.YQc),this.i5a&&0<this.i5a.length&&(X["X-TellMe-ShredderToken"]="Bearer "+this.i5a),ya=this.kPm(Y),0<ya.length&&(X["X-TellMe-Flights"]=ya),ya=[],!Y&&this.Ay("Answer")&&this.LMd&&(ca?Array.contains(ca,9):1)&&Array.add(ya,"Answer"),!Y&&this.Ay("Command")&&this.jFh&&!H.CommandResultsUtility.YXf(S.Wg)&&(ca?Array.contains(ca,17):
1)&&Array.add(ya,"Command"),!Y&&this.Ay("Definition")&&this.MMd&&(ca?Array.contains(ca,10):1)&&Array.add(ya,"Definition"),!Y&&this.Ay("Help")&&this.gQc&&(ca?Array.contains(ca,8):1)&&Array.add(ya,"Help"),!Y&&this.Ay("WolframAnswer")&&this.PMd&&(ca?Array.contains(ca,12):1)&&Array.add(ya,"WolframAnswer"),Y&&this.Ay("Recommended")&&this.eQc&&!F.TellMeActor.instance.Qtd&&(ca?Array.contains(ca,18):1)&&Array.add(ya,"Recommended"),!Y&&this.Ay("Image")&&this.S8e&&(ca?Array.contains(ca,19):1)&&Array.add(ya,
"Image"),this.YQc&&this.olb&&(ca?Array.contains(ca,14)||Array.contains(ca,15)||Array.contains(ca,20):1)&&(this.NIb.PDa(),this.NMd&&this.Ay("File")&&Array.add(ya,"File"),this.dQc&&this.Ay("People")&&Array.add(ya,"People"),this.cQc&&this.Ay("Notes")&&Array.add(ya,"Notes")),this.i5a&&0<this.i5a.length&&this.jc.Ska&&(ca?Array.contains(ca,15):1)&&(this.NIb.PDa(),this.Ay("File")&&Array.add(ya,"File")),!Y&&this.Ay("Template")&&this.OMd&&(ca?Array.contains(ca,23):1)&&Array.add(ya,"Template"),!Y&&this.Ay("Addin")&&
this.R8e&&(ca?Array.contains(ca,27):1)&&Array.add(ya,"Addin"),!Y&&this.Ay("ActionAI")&&this.Gac&&(ca?Array.contains(ca,25):1)&&Array.add(ya,"ActionAI"),ya.length){X["X-TellMe-SuggestionTypes"]=ya.join(",");X["X-TellMe-Culture"]=V.AFrameworkApplication.uiCulture;X["X-TellMe-ProcessSessionId"]=V.AFrameworkApplication.userSessionId;var Ha=this.qT=W.a.create().toString();X["Client-Request-Id"]=Ha;var Wa=window.performance.now();this.EIa();this.u5=window.setTimeout(()=>{if(Ha===this.qT){this.qT="";this.u5=
-1;aa.Qt(fa);const Ma={};Ma[l.a.provider]=this.zN();Ma[l.a.EYb]=S.Zwb;F.TellMeActor.instance.We.lC(w.a.TIg,this.SOc,Ma)}},this.SOc);this.Gf.Xj(this.gda,2,this.mPm(S.Wg),X,!1,0,Ma=>{this.jXb(Ma,S,aa,Ha,Wa,ca)},Ma=>{this.RWb(Ma,S,aa,Ha,Wa)},null,null,!1,4E3,this.Gac?3E4:6E3)}else F.TellMeActor.instance.We.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),aa.Qt(fa);else aa.Qt(fa)}EIa(){-1!==this.u5&&(window.clearTimeout(this.u5),this.u5=-1)}jXb(S,aa,Y,X,ca,fa){const ja=
new v.a(aa);if(X===this.qT){this.EIa();F.TellMeActor.instance.We.Rba(aa.Wg.length,this.pib.join(","),S.data.He.toString(),Math.round(window.performance.now()-ca),O.a.su,!0,z.a.IWa);X=S.data.Ee;S=null;try{S=Z.b(X)}catch(ua){F.TellMeActor.instance.We.onError("OnSuccessCallBack","Exception occured while deserializing response:"+ua);return}X=y.a.KU(aa);if("Groups"in S&&S.Groups){var ra=S.Groups;for(var ya of ra)if("GroupType"in ya&&"Suggestions"in ya&&ya.Suggestions)if("Commands"===ya.GroupType&&(fa?
Array.contains(fa,17):1)||"Recommended"===ya.GroupType&&(fa?Array.contains(fa,18):1)){var Ha=(ra="Recommended"===ya.GroupType)?"DLIS":"NaiveBayes";"Source"in ya&&ya.Source&&(Ha=ya.Source);var Wa=ya.Suggestions;new m.a;var Ma=[];for(const ua of Wa)this.ewn(ua)&&(Wa=ua.Type,("Command"===Wa||ra&&"Recommended"===Wa)&&Ma.push(new K.a(ua.CommandId,ua.Score)));H.CommandResultsUtility.mie(Ma,!aa.Wg.trim().length,ya.GroupType,Ha);Ha=F.TellMeActor.instance.R5;Wa=[];for(const ua of Ma)ra&&Ha&&Ha.yrf(ua.commandId)||
Wa.push(ua);Ma=H.CommandResultsUtility.F4c(aa,Wa,this.jc,null,null,null,ra?18:17,0);0<Ma.results.length&&(this.Gja!==f.a.contextMenu&&(Ma.displayName=ra?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ja.kw(Ma))}else if("Answer"===ya.GroupType){Wa=ya.Suggestions;ra=null;Ma=2147483647;Ha="";for(const ua of Wa)if(this.dwn(ua))if(Ha=ua.Type,Wa=this.XHm(Ha),"Answer"===Ha&&this.LMd){ra=this.Lai(Ha,ua,aa.Wg);break}else Wa&&Wa<Ma&&(Ma=Wa,ra=this.Lai(Ha,ua,aa.Wg));Ma=
y.a.YJo(aa.Wg,Ha);ra&&(fa?Array.contains(fa,ra.type):1)&&(Ha=[],this.KMd?this.jc.qBa?(F.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ra.value,ra.NE)),F.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ra.value,ra.description)),F.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ra.value,Ma))):(Ha.push(appChrome.actions.setControlLabel(ra.value,ra.NE)),Ha.push(appChrome.actions.updateCompoundButtonDescription(ra.value,
ra.description)),Ha.push(appChrome.actions.setCompoundButtonCommandValueId(ra.value,Ma)),appChrome.api.dispatch(Ha)):this.jc.qBa?(F.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ra.value,ra.NE+" - "+ra.description)),F.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ra.value,Ma))):(Ha.push(appChrome.actions.setControlLabel(ra.value,ra.NE+" - "+ra.description)),Ha.push(appChrome.actions.setButtonCommandValueId(ra.value,Ma)),appChrome.api.dispatch(Ha)),
Ma=this.oLl(ra.type),Ma.jy(ra),ja.kw(Ma))}else"Help"===ya.GroupType&&ya.Suggestions.length&&(fa?Array.contains(fa,8):1)?this.gQc&&(ra=this.D9g.Mrb(aa,ya.Suggestions))&&0<ra.results.length&&ja.kw(ra):"Template"===ya.GroupType&&(fa?Array.contains(fa,23):1)?(ra=ya.Suggestions)&&0<ra.length&&this.NQk.Mrb(aa,ja,ra):"Addin"===ya.GroupType&&(fa?Array.contains(fa,27):1)?(ra=ya.Suggestions)&&0<ra.length&&this.Hnk.Mrb(aa,ja,ra):"ActionAI"===ya.GroupType&&(fa?Array.contains(fa,25):1)?(Ma=ya.Suggestions,ra=[],
new u.a(25),Ma&&1===Ma.length&&(Ha=Ma[0])&&Ha.CommandId&&(Ma=Ha.CommandId,ra.push(new K.a(Ma,"Score"in Ha?Ha.Score:0)),ra=H.CommandResultsUtility.F4c(aa,ra,this.jc,null,null,null,25,0),ra.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,ja.kw(ra))):"Substrate"===ya.GroupType&&this.olb&&"Type"in ya?"File"===ya.Type&&this.NMd&&(fa?Array.contains(fa,15):1)?(ra=this.NIb.SJf(ya.Suggestions,X,this.Gja))&&0<ra.results.length&&(this.lee()&&(Ma=new x.a("GenerateSlidesFromTellMe",30,"",null,1),ra.jy(Ma)),
ja.kw(ra)):"People"===ya.Type&&this.dQc&&(fa?Array.contains(fa,14):1)?(ra=this.NIb.sEi(ya.Suggestions,X,this.Gja))&&0<ra.results.length&&ja.kw(ra):"Notes"===ya.Type&&this.cQc&&(fa?Array.contains(fa,14):1)&&(ra=this.NIb.YCi(ya.Suggestions,X,aa))&&0<ra.results.length&&ja.kw(ra):"Recall"===ya.GroupType&&this.jc.Ska&&"Type"in ya&&"IntentService"===ya.Type&&(fa?Array.contains(fa,15):1)&&(ra=this.NIb.SJf(ya.Suggestions,X,this.Gja))&&0<ra.results.length&&(this.lee()&&(Ma=new x.a("GenerateSlidesFromTellMe",
30,"",null,1),ra.jy(Ma)),ja.kw(ra));else F.TellMeActor.instance.We.onError("OnSuccessCallBack","GroupType"in ya?"Invalid group suggestions found for "+ya.GroupType:"Invalid group found")}if(S.Intents){ya=S.Intents;for(const ua of ya)this.c2f(ua)&&("Image"===ua.GroupType&&ua.ConfidenceScore>ua.ConfidenceThreshold&&(fa?Array.contains(fa,19):1)?this.Wzk.Mrb(aa,ja,0,ua):"Commands"===ua.GroupType&&ua.ConfidenceScore<ua.ConfidenceThreshold&&(fa?Array.contains(fa,17):1)&&(ya=new u.a(17),ja.kw(ya)))}Y.Qt(ja);
F.TellMeActor.instance.We.Rba(aa.Wg.length,this.pib.join(","),"",Math.round(window.performance.now()-ca),"",!0,z.a.provider)}}RWb(S,aa,Y,X,ca){const fa=new v.a(aa);X===this.qT&&(this.EIa(),F.TellMeActor.instance.We.Rba(aa.Wg.length,this.pib.join(","),S.data.He.toString(),Math.round(window.performance.now()-ca),O.a.su,!1,z.a.IWa));Y.Qt(fa)}XHm(S){switch(S){case "Entity":return this.lFh?3:0;case "Definition":return this.MMd?5:0;case "WolframAnswer":return this.PMd?2:0;default:return 0}}Lai(S,aa,Y){switch(S){case "Answer":return new x.a(this.KMd?
"AnswerForSearch":"AnswerForSearchSingleLine",0,""===aa.Title?Y:aa.Title,aa.Description,0);case "Entity":return new x.a(this.KMd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===aa.Title?Y:aa.Title,aa.Description,0);case "Definition":return new x.a(this.KMd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===aa.Title?Y:aa.Title,aa.Description,0);case "WolframAnswer":return new x.a("WolframForSearch",3,""===aa.Title?Y:aa.Title,aa.Description,0);default:return null}}oLl(S){switch(S){case 0:return new u.a(9,
CommonUIStrings.l_TellMeAnswersTitle);case 2:return new u.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new u.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new u.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new u.a(19,this.jc.Txc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}dwn(S){return"Type"in S&&!!S.Type&&""!==S.Type&&"Description"in S&&!!S.Description&&""!==S.Description}ewn(S){return"Type"in S&&!!S.Type&&""!==
S.Type&&"CommandId"in S&&!!S.CommandId&&""!==S.CommandId&&"Score"in S&&!!S.Score}c2f(S){if("GroupType"in S&&S.GroupType&&"ConfidenceScore"in S&&"ConfidenceThreshold"in S)return!0;F.TellMeActor.instance.We.onError("IsValidIntentGroup","Invalid intents found");return!1}mPm(S){const aa=y.a.F2i(S),Y={};Y.Query=S;aa&&this.eQc&&(this.Apn()?Y.UserActionEvents=F.TellMeActor.instance.$Jh:(Y.CommandClickedEvents=F.TellMeActor.instance.tNe,Y.CommandActionEvents=F.TellMeActor.instance.Rbh),Y.TellMeCommandClickMruEvents=
F.TellMeActor.instance.yvh,Y.ContentType=F.TellMeActor.instance.tZd);this.OMd&&(S={},S.Application=this.jc.application,Y.TemplateInfo=S);return Z.c(Y)}O0b(){return!!this.jc&&this.jc.O0b||!!V.AFrameworkApplication.ta&&V.AFrameworkApplication.ta.Hb.O0b}P0b(){return!!this.jc&&this.jc.P0b||!!V.AFrameworkApplication.ta&&V.AFrameworkApplication.ta.Hb.P0b}Q0b(){return!!this.jc&&this.jc.Q0b||!!V.AFrameworkApplication.ta&&V.AFrameworkApplication.ta.Hb.Q0b}R0b(){return!!this.jc&&this.jc.R0b||!!V.AFrameworkApplication.ta&&
V.AFrameworkApplication.ta.Hb.R0b}Xxc(){return!!this.jc&&(this.jc.Xxc||this.jc.AS)}J6o(){return!!this.jc&&!this.jc.cbb}c7o(){return!!this.jc&&this.jc.mad}I6o(){return!!this.jc&&this.jc.Zfn&&this.jc.Wfn}kze(){return!!this.jc&&this.jc.kze}p3i(){return!!V.AFrameworkApplication.J&&V.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}q3i(){return!!V.AFrameworkApplication.J&&V.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",
!1)}Apn(){return!!V.AFrameworkApplication.J&&V.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}lee(){return!!V.AFrameworkApplication.J&&V.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}fUj(){return!!V.AFrameworkApplication.J&&V.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}sTm(){return V.AFrameworkApplication.J?
V.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}nPm(){if(!V.AFrameworkApplication.J)return"";if(this.q3i())return V.AFrameworkApplication.J.jb("TellMeServiceProdEndpointForSearch");if(this.p3i())return V.AFrameworkApplication.J.jb("TellMeServiceEdogEndpointForSearch");if(y.a.DYf())return V.AFrameworkApplication.J.jb("TellMeServiceIntEndpointForSearch");let S=V.AFrameworkApplication.J.jb("TellMeServiceSearchEndpoint");S&&""!==S||(S=V.AFrameworkApplication.z0j);
return S}static obi(S,aa){if(aa)return new P(S,["Command","Recommended"],S.Wsm);aa=y.a.Hta()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new P(S,aa,S.mHi)}}Object(I.a)(P,"TellMeServiceProvider",null,[1024])},1794:function(I,J,d){I=d(0);var m=d(221),f=d(1597),a=d(183),l=d(1474);class w extends f.a{constructor(x,u,v,F,y,G,C,H,K,R,E,L,O,V){super(x,3,u,v,F,y,G,H,K,R,E,
L,O,V);this.BMe=C}get character(){return this.BMe}get text(){return this.character.toString()}Pod(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}Gjc(){return"CharRun"}clone(){return new w(this.fTc,this.source,this.Bk,this.Qg,this.runId,this.DL,this.character,this.vvb,this.DXa,this.Ifa,this.SKa,this.EZa,this.iA,this.gv)}gC(x,u,v,F=!1){return super.gC(x,u,v,F)?x.character===this.character?!0:l.a.dUh(x.character,this.character):!1}}Object(I.a)(w,"CharRunMergeBlock",
f.a,[]);d.d(J,"a",function(){return z});class z extends f.a{constructor(x,u,v,F,y,G,C,H,K,R,E,L,O,V,Z){super(x,1,u,v,F,y,G,H,R,E,L,O,V,Z);this._text=C;this.C$e=K}get text(){return this._text}Pod(x){this._text=x}get dfb(){return this.C$e&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.C$e)}Gjc(){return"TextRun"}clone(){return new z(this.fTc,this.source,this.Bk,this.Qg,this.runId,this.DL,this._text,this.vvb,this.C$e,this.DXa,this.Ifa,
this.SKa,this.EZa,this.iA,this.gv)}gC(x,u,v,F=!1){return super.gC(x,u,v,F)?l.a.cUh(this._text,x._text):!1}kqd(){const x=new m.a;for(let v=0;v<this.text.length;v++){var u=l.a.charAt(this._text,v);if(l.a.Mun(l.a.fnp(u))){let F="";F+=u;u=l.a.charAt(this._text,++v);F+=u;u=new z(this.fTc,this.source,this.Bk,this.Qg,this.runId,this.DL,F,this.vvb,!1,this.DXa,this.Ifa,this.SKa,this.EZa,this.iA,this.gv);x.add(u)}else u=new w(this.fTc,this.source,this.Bk,this.Qg,this.runId,this.DL,u,this.vvb,this.DXa,this.Ifa,
this.SKa,this.EZa,this.iA,this.gv),x.add(u)}return x}}Object(I.a)(z,"TextRunMergeBlock",f.a,[])},1795:function(I,J,d){I=d(0);var m=d(267),f=d(32),a=d(13),l=d(5),w=d(106),z=d(800),x=d(177),u=d(221),v=d(357),F=d(1381);class y{constructor(H,K,R){this.position=H;this.leader=K;this.val=R}equals(H){return this.position===H.position&&this.leader===H.leader&&this.val===H.val}toString(){return this.position.toString()}}Object(I.a)(y,"TabStop",null,[]);var G=d(1922);d.d(J,"a",function(){return C});class C extends F.a{constructor(){super();
this.ZOd=null}get Ho(){return 20}get Zop(){return this.ZOd?this.ZOd:this.ZOd=new Set([z.a.zb(f.a.YWa),z.a.zb(f.a.QUa),z.a.zb(f.a.C0a)])}get UB(){return 0}jl(){const H=super.jl();H.W(z.a.zb(a.a.Yn),1);H.W(z.a.zb(a.a.Zn),1);H.W(z.a.zb(a.a.Dn),1);H.W(z.a.zb(l.a.Ot),1);H.W(z.a.zb(l.a.Mq),1);H.W(z.a.zb(l.a.Zc),1);H.W(z.a.zb(a.a.hzb),1);H.W(z.a.zb(l.a.oWa),1);H.W(z.a.zb(l.a.lNa),1);H.W(z.a.zb(a.a.LCa),1);H.W(z.a.zb(l.a.pLa),1);H.W(z.a.zb(l.a.Ika),1);H.W(z.a.zb(l.a.qLa),1);H.W(z.a.zb(l.a.wJa),1);H.W(z.a.zb(l.a.rLa),
1);H.W(z.a.zb(l.a.xJa),1);H.W(z.a.zb(l.a.kNa),1);H.W(z.a.zb(l.a.YOa),1);H.W(z.a.zb(l.a.ZOa),1);H.W(z.a.zb(l.a.LEa),1);H.W(z.a.zb(l.a.Iw),1);H.W(z.a.zb(f.a.YWa),1);H.W(z.a.zb(f.a.QUa),1);H.W(z.a.zb(f.a.C0a),1);H.W(z.a.zb(l.a.mC),1);H.W(z.a.zb(l.a.nC),1);H.W(z.a.zb(l.a.Cy),1);H.W(z.a.zb(w.a.pna),6);H.W(z.a.zb(w.a.jK),6);H.W(z.a.zb(w.a.e1a),6);H.W(z.a.zb(l.a.WLb),7);H.W(z.a.zb(w.a.jK),6);H.W(z.a.zb(l.a.EWj),2);H.W(z.a.zb(w.a.KAl),2);H.W(z.a.zb(w.a.dao),2);H.W(z.a.zb(l.a.xAc),2);H.W(z.a.zb(l.a.jsd),2);
H.W(z.a.zb(l.a.l2b),2);H.W(z.a.zb(l.a.Bfb),2);H.W(z.a.zb(l.a.ksd),2);H.W(z.a.zb(l.a.lsd),2);H.W(z.a.zb(l.a.g6f),2);H.W(z.a.zb(l.a.listID),3);H.W(z.a.zb(l.a.listLevel),3);return H}RD(H,K){var R=H.ku.runtime.qc,E=R.isFeatureEnabled(109);if(K===z.a.zb(a.a.Yn)||K===z.a.zb(a.a.Zn)||K===z.a.zb(a.a.Dn)||K===z.a.zb(l.a.Ot)||K===z.a.zb(l.a.Mq)||K===z.a.zb(l.a.Zc)||K===z.a.zb(a.a.hzb)||K===z.a.zb(l.a.oWa)||K===z.a.zb(l.a.lNa)||K===z.a.zb(a.a.LCa)||K===z.a.zb(l.a.pLa)||K===z.a.zb(l.a.Ika)||K===z.a.zb(l.a.qLa)||
K===z.a.zb(l.a.wJa)||K===z.a.zb(l.a.rLa)||K===z.a.zb(l.a.xJa)||K===z.a.zb(l.a.kNa)||K===z.a.zb(l.a.YOa)||K===z.a.zb(l.a.ZOa)||K===z.a.zb(l.a.LEa)||K===z.a.zb(l.a.Iw)||K===z.a.zb(l.a.nQ)||this.COn(K,E)){var L=H.Xo.value.Uv;E=H.Xo.value.Kf;K=H.hh.value.Kf;if(H.ku.runtime.fUa.contains(L.id))return x.a.instance.Ua(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",L.id),!0;if(R.Erb(1000005)&&this.Ibp(H,K,E))return H.Yl=K.$O(),
C.ONh(H),C.zRd(H.ku,H.kf,E),!0;R=new u.a;R.add(L);L=new u.a;L.add(E);E=new u.a;E.add(K);if(!({Yq:K}=C.M4j(H.ku,R,E,L)).returnValue)return H.QOg=!0,H.Yl=null,!1;C.ONh(H);H.Yl=K.tg(0).Gm;return!0}return K===z.a.zb(l.a.mC)||K===z.a.zb(l.a.nC)||K===z.a.zb(l.a.Cy)?(this.mrp(H),H.Vg.add(z.a.zb(l.a.mC)),H.Vg.add(z.a.zb(l.a.nC)),H.Vg.add(z.a.zb(l.a.Cy)),!0):!1}Ibp(H,K,R){K=H.kf.getPropertyString(K,l.a.nQ);H=H.kf.getPropertyString(R,l.a.nQ);return K||H?!0:!1}mrp(H){const K=H.kf,R=H.Yl;var E=H.Xo.value.Kf,
L=H.hh.value.Kf;H=this.ZIf(H.Xo.value.Uv,K);L=this.ZIf(L,K);E=this.ZIf(E,K);({POn:E,QOn:H,ROn:L}=this.bBm(H,L,E));E.length?(K.setPropertyUint32s(R,l.a.Cy,E),K.setPropertyUint32s(R,l.a.mC,H),K.setPropertyUint32s(R,l.a.nC,L)):this.sAo(R)}ZIf(H,K){const R=K.getPropertyUint32s(H,l.a.Cy),E=K.getPropertyUint32s(H,l.a.mC);H=K.getPropertyUint32s(H,l.a.nC);K=new u.a;if(!R)return K;for(let L=0;L<R.length;++L)K.add(new y(R.K(L),E.K(L),H.K(L)));return K}bBm(H,K,R){({tqj:K,uqj:V,vqj:O}=this.Mwi(H,K));let E,L;
({tqj:R,uqj:E,vqj:L}=this.Mwi(H,R));H=this.hWm(H,V,O,E,L);var O=this.gWm(H,K,R);H=new u.a;K=new u.a;var V=new u.a;for(R=0;R<O.length;++R)H.add(O.K(R).position),K.add(O.K(R).leader),V.add(O.K(R).val);return{POn:H,QOn:K,ROn:V}}Mwi(H,K){let R,E,L;R=new u.a;E=new v.a;L=new v.a;let O,V;for(O=V=0;O<H.length&&V<K.length;)H.K(O).position===K.K(V).position?(H.K(O).equals(K.K(V))||L.W(H.K(O).position,K.K(V)),++O,++V):H.K(O).position<K.K(V).position?(E.W(H.K(O).position,H.K(O)),++O):(R.add(K.K(V)),++V);for(;O<
H.length;)E.W(H.K(O).position,H.K(O)),++O;for(;V<K.length;)R.add(K.K(V)),++V;return{tqj:R,uqj:E,vqj:L}}hWm(H,K,R,E,L){const O=new u.a;for(let V=0;V<H.length;++V){const Z=H.K(V).position;K.mb(Z)||(R.mb(Z)?O.add(R.K(Z)):E.mb(Z)||(L.mb(Z)?O.add(L.K(Z)):O.add(H.K(V))))}return O}gWm(H,K,R){K=this.iej(K,R);return this.iej(H,K)}iej(H,K){const R=new u.a;let E,L;for(E=L=0;E<H.length&&L<K.length;)H.K(E).position<=K.K(L).position?(R.add(H.K(E)),H.K(E).position===K.K(L).position&&++L,++E):R.add(K.K(L++));for(;E<
H.length;)R.add(H.K(E++));for(;L<K.length;)R.add(K.K(L++));return R}sAo(H){H.removeProperty(l.a.Cy);H.removeProperty(l.a.mC);H.removeProperty(l.a.nC)}static Hh(){return new C}static get instance(){return C.gh.value}static ONh(H){H.Vg.add(z.a.zb(a.a.Yn));H.Vg.add(z.a.zb(a.a.Zn));H.Vg.add(z.a.zb(a.a.Dn));H.Vg.add(z.a.zb(l.a.Ot));H.Vg.add(z.a.zb(l.a.Mq));H.Vg.add(z.a.zb(l.a.Zc));H.Vg.add(z.a.zb(a.a.hzb));H.Vg.add(z.a.zb(l.a.oWa));H.Vg.add(z.a.zb(l.a.lNa));H.Vg.add(z.a.zb(a.a.LCa));H.Vg.add(z.a.zb(l.a.pLa));
H.Vg.add(z.a.zb(l.a.Ika));H.Vg.add(z.a.zb(l.a.qLa));H.Vg.add(z.a.zb(l.a.wJa));H.Vg.add(z.a.zb(l.a.rLa));H.Vg.add(z.a.zb(l.a.xJa));H.Vg.add(z.a.zb(l.a.kNa));H.Vg.add(z.a.zb(l.a.YOa));H.Vg.add(z.a.zb(l.a.ZOa));H.Vg.add(z.a.zb(l.a.LEa));H.Vg.add(z.a.zb(l.a.Iw));H.Vg.add(z.a.zb(l.a.nQ))}static M4j(H,K,R,E){return(new G.a(H,K,R,E)).JAc()}static zRd(H,K,R){R=K.getPropertyObjectIds(R,a.a.Zn);for(let L=0;L<R.length;L++){var E=H.runtime.zv.K(R.tg(L));if(E&&(E=K.getPropertyObjectId(E,l.a.se))){H.runtime.yyc.add(E);
break}}}COn(H,K){return K?this.Zop.has(H)?!0:!1:!1}}C.gh=new m.a(C.Hh);Object(I.a)(C,"ParagraphNodeComplexMerge",F.a,[])},1921:function(I,J,d){d.r(J);d.d(J,"MarkerValidation",function(){return a});I=d(0);var m=d(357),f=d(1729);class a{constructor(){this.yce=this.kUi=this.jUi=this.iUi=0}gxi(){const l=new m.a(0);l.W("InvalidBookmarks",this.iUi);l.W("InvalidComments",this.jUi);l.W("InvalidContentControls",this.kUi);0!==this.yce&&l.W("InvalidMarkerType",this.yce);return l}FNi(){return 0<this.iUi||0<this.jUi||
0<this.kUi||0!==this.yce?!0:!1}toString(){return JSON.stringify(f.a.h1a(this.gxi()))}}Object(I.a)(a,"MarkerValidation",null,[])},1922:function(I,J,d){d.d(J,"a",function(){return z});I=d(0);var m=d(177),f=d(1036),a=d(240),l=d(1625),w=d(1500);class z{constructor(x,u,v,F,y=null,G=null,C=null,H=null){this.fe=x;this.MH=u;this.hGa=v;this.DHa=F;this.EFk=y;this.cwk=G;this.gSk=C;this.dxa=H||this.htf()}htf(){return x=>!!this.fe.runtime.qc&&this.fe.runtime.qc.isFeatureEnabled(x)}RGl(){return()=>this.fe.runtime.qc}czf(){return!!this.fe.runtime.Kn.K(a.a.cO)}XWj(){let x;
if(1===this.fe.input.source||2===this.fe.input.source)x=72;else if(4===this.fe.input.source||3===this.fe.input.source)x=33;else if(5===this.fe.input.source)x=110;else return!1;return this.czf()&&this.dxa(x)}iZj(x,...u){return String.format.apply(null,[x].concat(u))}b8d(x){const {ParagraphMerge:u}=d(2009);let v=this.fe,F=this.hGa,y=this.DHa;x||(v=this.EFk||this.fe,F=this.cwk||F,y=this.gSk||y);var G=w.a.OLf(this.MH);const C=w.a.OLf(F),H=w.a.OLf(y);G=this.iZj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
v.input.source,v.runtime.MIa.id,v.runtime.y2d,v.runtime.CEe,G.Vr(),C.Vr(),H.Vr());return x?{returnValue:new l.a(v,this.MH,F,y,this.htf(),new f.a),Vr:G}:{returnValue:new u(v,this.MH,F,y,this.htf(),this.RGl(),new f.a),Vr:G}}JAc(){this.fe.logger.oZo();var x=this.XWj();var u=({Vr:F}=this.b8d(x)).returnValue;m.a.instance.Ua(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",x,F);this.fe.logger.WX("ParagraphMergeSelector initialization");x?this.fe.logger.Vxe(1):this.fe.logger.Vxe(2);
let v=({Yq:u}=u.JAc()).returnValue;this.fe.logger.hAg();var F=!v;x=!!this.fe.runtime.Kn.K(a.a.cO)&&(x&&!v||!x);F&&({Vr:F,returnValue:u}=this.b8d(!1),{Yq:u,returnValue:v}=u.JAc(),m.a.instance.Ua(18994390,1,v?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",v,F));x&&(F=new f.a,w.a.MIo(this.fe,F));this.fe.logger.WX("ParagraphMergeSelector finalization");return{returnValue:v,Yq:u}}ctd(x,u){let v,F,y;const G=this.XWj()&&this.dxa(111);let C=({Vr:y}=this.b8d(G)).returnValue,H=({Jdb:v,
hva:F}=C.ctd(x,u)).returnValue;m.a.instance.Ua(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",G,y);G&&!H&&C.Ivg&&({Vr:y,returnValue:C}=this.b8d(!1),{Jdb:v,hva:F,returnValue:H}=C.ctd(x,u),m.a.instance.Ua(18994392,1,H?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",H,y));return{returnValue:H,Jdb:v,hva:F}}}Object(I.a)(z,"ParagraphMergeSelector",null,[1018])},1923:function(I,J,d){d.r(J);d.d(J,"SurfaceStringTokenStringGenerator",
function(){return f});I=d(0);var m=d(1542);class f extends m.a{constructor(a){super(a);this.Bb=a}apply(a,l,w,z,x,u,v){null==u&&(u=a.pJi(x,l));v=m.a.ZOh(a,u,this.Bb.score,w,z,v);return{Urd:u,MUc:v}}}f.NUc=0;Object(I.a)(f,"SurfaceStringTokenStringGenerator",m.a,[])},1924:function(I,J,d){d.r(J);d.d(J,"QueryTokenStringGenerator",function(){return a});I=d(0);var m=d(1542),f=d(1383);class a extends m.a{constructor(l){super(l);this.Bb=l}apply(l,w,z,x,u,v,F){w=this.Bb.query.load(w,null);u=0;let y=null;this.Bb.query.C8===
f.Annotations.NEa?w&&(y=this.Bb.name):((y=this.Bb.name)&&(y+="_"),y+=this.Bb.annotations.jia(this.Bb.query.C8,w));null!=y&&(u=m.a.ZOh(l,y,this.Bb.score,z,x,u));return{Urd:v,MUc:F+u}}}a.NUc=1;Object(I.a)(a,"QueryTokenStringGenerator",m.a,[])},1925:function(I,J,d){d.r(J);d.d(J,"FuzzyMatchTokenStringGenerator",function(){return f});I=d(0);var m=d(1542);class f extends m.a{constructor(a){super(a);this.Bb=a}apply(a,l,w,z,x,u,v){null==u&&(u=a.pJi(x,l));a=this.Bb.vli.nJn(u);if(this.Bb.Ipj)for(var F of a)if(!F.qR&&
F.C3d)return{Urd:u,MUc:v};F=0;for(const y of a)if(y.qR&&!({Rmf:F}=this.TTh(y,!0,w,z,F)).returnValue)return{Urd:u,MUc:v};if(this.Bb.LQi)for(const y of a)if(!({Rmf:F}=this.TTh(y,!1,w,z,F)).returnValue)break;return{Urd:u,MUc:v}}TTh(a,l,w,z,x){let u;l?(l=0,u=a.C3d?1:0):(l=a.C3d?1:0,u=a.count-l);for(let v=0;v<u;++v)if(m.a.$Oh(a.Zpb+l+v,this.Bb.score,w,z),++x,0<this.Bb.J8f&&x>=this.Bb.J8f)return{returnValue:!1,Rmf:x};return{returnValue:!0,Rmf:x}}}f.NUc=2;Object(I.a)(f,"FuzzyMatchTokenStringGenerator",m.a,
[])},2E3:function(I,J,d){I=d(0);var m=d(58),f=d(5),a=d(38),l=d(267),w=d(1381);class z extends w.a{constructor(){super()}get Ho(){return 2}get UB(){return 7}static Hh(){return new z}static get instance(){return z.gh.value}}z.gh=new l.a(z.Hh);Object(I.a)(z,"AppBindingNodeComplexMerge",w.a,[]);var x=d(13),u=d(800),v=d(177),F=d(1458);class y extends w.a{constructor(){super()}get Ho(){return 3}get UB(){return 7}jl(){const fb=super.jl();fb.W(u.a.zb(x.a.SU),1);return fb}RD(fb,Cb){if(Cb===u.a.zb(x.a.SU)){const bc=
fb.Yl;var lc=fb.kf;v.a.instance.Ua(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",bc.id,bc.wc,Cb);Cb=lc.getPropertyMilliseconds(fb.hh.value.Kf,x.a.SU);lc=lc.getPropertyMilliseconds(fb.Xo.value.Kf,x.a.SU);Cb<lc&&this.Wnm(fb);fb.Vg.add(u.a.zb(x.a.SU));return!0}v.a.instance.Ua(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Kf.id,Cb);return!1}Wnm(fb){this.IFo(fb.Xo.value.Kf,
fb.Yl);this.nIf(fb,f.a.sSd);this.nIf(fb,f.a.mif);this.nIf(fb,f.a.dif)}nIf(fb,Cb){var lc=fb.kf,bc=fb.Yl;if(lc.hasProperty(bc,Cb)&&(Cb=lc.getPropertyObjectIds(bc,Cb))&&Cb.length)for(lc=fb.ku.runtime.zv,fb=fb.ku.runtime.Yq,bc=0;bc<Cb.length;bc++){const Za=Cb.K(bc);if(!lc.mb(Za))continue;const Ib=lc.K(Za).$O();fb.add(Za,new F.a(Ib,!1))}}static Hh(){return new y}static get instance(){return y.gh.value}}y.gh=new l.a(y.Hh);Object(I.a)(y,"AppNodeComplexMerge",w.a,[]);class G extends w.a{constructor(){super()}get Ho(){return 4}get UB(){return 7}static Hh(){return new G}static get instance(){return G.gh.value}}
G.gh=new l.a(G.Hh);Object(I.a)(G,"AppPropNodeComplexMerge",w.a,[]);class C extends w.a{constructor(){super()}get Ho(){return 5}get UB(){return 7}static Hh(){return new C}static get instance(){return C.gh.value}}C.gh=new l.a(C.Hh);Object(I.a)(C,"AppRefNodeComplexMerge",w.a,[]);var H=d(357),K=d(605),R=d(221),E=d(16);class L{constructor(fb,Cb){this.id=fb;this.nep=Cb}}Object(I.a)(L,"IdAndTime",null,[]);class O extends w.a{constructor(){super()}get Ho(){return 6}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.LTa),
1);return fb}RD(fb,Cb){if(Cb===u.a.zb(f.a.LTa)){const lc=fb.Yl,bc=fb.kf;v.a.instance.Ua(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",lc.id,lc.wc,Cb);Cb=bc.getPropertyObjectIds(fb.hh.value.Uv,f.a.LTa);const Za=bc.getPropertyObjectIds(fb.hh.value.Kf,f.a.LTa),Ib=bc.getPropertyObjectIds(fb.Xo.value.Kf,f.a.LTa);Cb=this.JNn(fb,Cb,Za,Ib);0<Cb.length?bc.setPropertyObjectIds(lc,f.a.LTa,Cb):lc.removeProperty(f.a.LTa);fb.Vg.add(u.a.zb(f.a.LTa));
return!0}v.a.instance.Ua(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Kf.id,Cb);return!1}JNn(fb,Cb,lc,bc){const Za=this.pMa(Cb,lc,bc),Ib=Cb.IS(),Ub=lc.IS(),rc=bc.IS();Cb=w.a.filter(Za,$c=>!Ib.contains($c)&&Ub.contains($c));lc=w.a.filter(Za,$c=>!Ib.contains($c)&&rc.contains($c));if(!Cb.length||!lc.length)return Za;const yc=new H.a;Cb.forEach($c=>{const cd=new L($c,this.Eti(fb,$c,!1));this.Ati(fb,$c,!1).forEach(Rd=>
{yc.add(Rd,cd);return!0});return!0});const rb=new K.a;lc.forEach($c=>{const cd=this.Eti(fb,$c,!0);this.Ati(fb,$c,!0).forEach(Rd=>yc.mb(Rd)?(rb.add(yc.K(Rd).nep>=cd?$c:yc.K(Rd).id),!1):!0);return!0});return w.a.filter(Za,$c=>!rb.contains($c))}Eti(fb,Cb,lc){return(Cb=this.zla(fb,Cb,lc))?fb.kf.getPropertyMilliseconds(Cb,x.a.SU):0}zla(fb,Cb,lc){fb=lc?fb.ku.runtime.zv:fb.ku.runtime.QA;return fb.mb(Cb)?fb.K(Cb):null}Ati(fb,Cb,lc){const bc=new R.a,Za=new K.a,Ib=fb.kf;Cb=this.zla(fb,Cb,lc);var Ub=this.GFi(Ib,
Cb);if(Ub)for(bc.add(Ub),Za.add(Ub),Cb=Ib.getPropertyObjectIds(Cb,f.a.sSd),Ub=0;Cb&&Ub<Cb.length;Ub++){const rc=this.GFi(Ib,this.zla(fb,Cb.K(Ub),lc));if(!rc)break;Za.contains(rc)||(bc.add(rc),Za.add(rc))}return bc}GFi(fb,Cb){if(!fb.hasProperty(Cb,f.a.MTa)||!fb.hasProperty(Cb,f.a.Fmb)||!fb.hasProperty(Cb,f.a.AKb))return null;const lc=fb.getPropertyString(Cb,f.a.MTa),bc=fb.getPropertyString(Cb,f.a.Fmb);fb=fb.getPropertyString(Cb,f.a.AKb);return E.a.zC(lc+";"+bc+";"+fb)}static Hh(){return new O}static get instance(){return O.gh.value}}
O.gh=new l.a(O.Hh);Object(I.a)(O,"AppsNodeComplexMerge",w.a,[]);class V extends w.a{constructor(){super()}get Ho(){return 36}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.cMg),1);fb.W(u.a.zb(f.a.vAg),1);return fb}RD(fb,Cb){v.a.instance.Ua(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",Cb);if(Cb===u.a.zb(f.a.cMg)||Cb===u.a.zb(f.a.vAg)){const Ib=u.a.D_(Cb);var lc=fb.hh.value.Kf,bc=fb.Xo.value.Kf;const Ub=fb.Yl;var Za=fb.kf.getPropertyStrings(fb.hh.value.Uv,Ib);lc=fb.kf.getPropertyStrings(lc,
Ib);bc=fb.kf.getPropertyStrings(bc,Ib);Za=this.pMa(Za,lc,bc);fb.kf.setPropertyStrings(Ub,Ib,Za);fb.Vg.add(Cb);return!0}return!1}static Hh(){return new V}static get instance(){return V.gh.value}}V.gh=new l.a(V.Hh);Object(I.a)(V,"AutoSaveParametersNodeComplexMerge",w.a,[]);class Z extends w.a{constructor(){super()}get Ho(){return 44}jl(){const fb=super.jl();fb.W(u.a.zb(x.a.qg),1);return fb}RD(fb,Cb){const lc=fb.ku.runtime.qc;if(Cb===u.a.zb(x.a.qg))return v.a.instance.Ua(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
fb.Yl.id,fb.Yl.wc,Cb),lc.kK(115),lc.isFeatureEnabled(115)?this.MNn(fb,Cb):this.iOn(fb,Cb),!0;v.a.instance.Ua(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",fb.hh.value.Kf.id,Cb);return!1}MNn(fb,Cb){const lc=u.a.D_(Cb),bc=fb.kf;var Za=bc.getPropertyObjectIds(fb.hh.value.Uv,lc),Ib=bc.getPropertyObjectIds(fb.hh.value.Kf,lc),Ub=bc.getPropertyObjectIds(fb.Xo.value.Kf,lc);Ub=Z.dRm(fb,Ib,Ub);Za=this.pMa(Za,Ib,
Ub);Ib=fb.Yl;0<Za.length?bc.setPropertyObjectIds(Ib,lc,Za):Ib.removeProperty(lc);fb.Vg.add(Cb)}static Hh(){return new Z}static get instance(){return Z.gh.value}static dRm(fb,Cb,lc){const bc=new R.a,Za=new H.a;Cb.forEach(Ib=>{const Ub=fb.ku.runtime.QA.K(Ib);Ub&&Za.add(Ub.kH(f.a.zu).toString(),Ib);return!0});lc.forEach(Ib=>{var Ub=fb.ku.runtime.zv.K(Ib);Ub?(Ub=Ub.kH(f.a.zu).toString(),Za.mb(Ub)&&Za.get(Ub)!==Ib?v.a.instance.Ua(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
bc.add(Ib)):bc.add(Ib);return!0});return bc}}Z.gh=new l.a(Z.Hh);Object(I.a)(Z,"BookmarkContainerNodeComplexMerge",w.a,[]);class W extends w.a{constructor(){super()}get Ho(){return 41}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.YKb),1);fb.W(u.a.zb(f.a.zu),1);return fb}RD(fb,Cb){return Cb===u.a.zb(f.a.YKb)?(fb.Vg.add(u.a.zb(f.a.YKb)),!0):Cb===u.a.zb(f.a.zu)?(fb.Vg.add(u.a.zb(f.a.zu)),!0):!1}Uf(fb){return fb&&fb.length?!1:!0}static Hh(){return new W}static get instance(){return W.gh.value}}W.gh=new l.a(W.Hh);
Object(I.a)(W,"BookmarkNodeComplexMerge",w.a,[]);class P extends w.a{constructor(){super();this.nde=!1}get Ho(){return 7}jl(){const fb=super.jl();fb.W(u.a.zb(x.a.qg),1);return fb}RD(fb,Cb){if(Cb===u.a.zb(x.a.qg)){const Za=fb.Yl,Ib=fb.kf;var lc=fb.ku.runtime.qc;lc&&(this.nde=lc.isFeatureEnabled(66));v.a.instance.Ua(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Za.id,Za.wc,Cb);Cb=Ib.getPropertyObjectIds(fb.hh.value.Uv,x.a.qg);
lc=Ib.getPropertyObjectIds(fb.hh.value.Kf,x.a.qg);var bc=Ib.getPropertyObjectIds(fb.Xo.value.Kf,x.a.qg);Cb=this.VNn(Cb,lc,bc);if(this.nde&&0<Cb.length){lc=new Sys.StringBuilder;for(bc=0;bc<Cb.length;bc++)lc.append(Cb.K(bc).toString()+",");v.a.instance.Ua(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",Za.id,lc.toString())}0<Cb.length?Ib.setPropertyObjectIds(Za,x.a.qg,Cb):Za.removeProperty(x.a.qg);fb.Vg.add(u.a.zb(x.a.qg));return!0}v.a.instance.Ua(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
fb.hh.value.Kf.id,Cb);return!1}VNn(fb,Cb,lc){const bc=new R.a,Za=new H.a(0);this.D8l(fb,lc,bc,Za);return this.WTl(Cb,Za,bc)}D8l(fb,Cb,lc,bc){fb=fb||new R.a;Cb=Cb||new R.a;fb.forEach(Za=>{bc.W(Za,1);return!0});Cb.forEach(Za=>{bc.Ec(Za).returnValue?bc.W(Za,2):(bc.W(Za,0),lc.add(Za));return!0})}WTl(fb,Cb,lc){fb=fb||new R.a;const bc=new R.a,Za=new R.a,Ib=new R.a;fb.forEach(Ub=>{let rc=!0,yc;({value:yc}=Cb.Ec(Ub)).returnValue&&(0===yc?Cb.W(Ub,2):1===yc&&(rc=!1));rc?bc.add(Ub):this.nde&&Za.add(Ub);return!0});
lc.forEach(Ub=>{let rc=!1,yc;({value:yc}=Cb.Ec(Ub)).returnValue?0===yc&&(rc=!0,Cb.W(Ub,2)):v.a.instance.Ua(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Ub);rc?bc.add(Ub):this.nde&&Ib.add(Ub);return!0});this.saj(Za,"Favored");this.saj(Ib,"Unfavored");return bc}saj(fb,Cb){if(fb.length){var lc=new Sys.StringBuilder;for(let bc=0;bc<fb.length;bc++)lc.append(fb.K(bc).toString()+",");v.a.instance.Ua(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",Cb,lc.toString())}}static Hh(){return new P}static get instance(){return P.gh.value}}P.gh=new l.a(P.Hh);Object(I.a)(P,"CommentContentNodeComplexMerge",w.a,[]);var S=d(82),aa=d(28);class Y extends w.a{constructor(){super();this.XGh=[1];this.L5e=new H.a}get Ho(){return 8}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.Kea),3);fb.W(u.a.zb(f.a.eH),3);fb.W(u.a.zb(f.a.mfc),2);fb.W(u.a.zb(f.a.commentId),2);fb.W(u.a.zb(f.a.wqf),2);fb.W(u.a.zb(f.a.JIa),
2);fb.W(u.a.zb(f.a.rUa),1);fb.W(u.a.zb(f.a.Urb),1);fb.W(u.a.zb(f.a.ctb),1);fb.W(u.a.zb(f.a.cU),1);fb.W(u.a.zb(f.a.FI),1);fb.W(u.a.zb(f.a.oWc),2);fb.W(u.a.zb(f.a.HWd),2);fb.W(u.a.zb(f.a.dMb),2);fb.W(u.a.zb(f.a.yqf),2);fb.W(u.a.zb(f.a.aP),1);fb.W(u.a.zb(x.a.qg),0);fb.W(u.a.zb(f.a.NJ),0);return fb}RD(fb,Cb){if(Cb===u.a.zb(f.a.aP)){var lc=fb.kf.getPropertyString(fb.Xo.value.Kf,f.a.aP);this.Uf(lc)?fb.Yl.removeProperty(f.a.aP):fb.Yl.seb(f.a.aP,lc);return!0}if(Cb!==u.a.zb(f.a.rUa)&&Cb!==u.a.zb(f.a.Urb)&&
Cb!==u.a.zb(f.a.ctb)&&Cb!==u.a.zb(f.a.FI)&&Cb!==u.a.zb(f.a.cU))return!1;var bc=fb.hh.value.Uv;const Za=fb.hh.value.Kf;var Ib=fb.Xo.value.Kf;lc=fb.Yl;if(Cb===u.a.zb(f.a.rUa)){bc=fb.kf.getPropertyString(Za,f.a.rUa);Ib=fb.kf.getPropertyString(Ib,f.a.rUa);Ib=this.Uf(bc)?Ib:this.Uf(Ib)?bc:null;if(this.Uf(Ib))return!0;fb.kf.setPropertyString(lc,f.a.rUa,Ib);fb.Vg.add(u.a.zb(f.a.rUa));return!0}if(Cb===u.a.zb(f.a.ctb))return bc=fb.kf.getPropertyBool(Za,f.a.ctb),Ib=fb.kf.getPropertyBool(Ib,f.a.ctb),bc=null!=
bc?bc:!1,bc=(null!=Ib?Ib:!1)||bc,fb.kf.setPropertyBool(lc,f.a.ctb,bc),fb.Vg.add(u.a.zb(f.a.ctb)),!0;if(Cb===u.a.zb(f.a.Urb)){bc=fb.kf.getPropertyBool(Za,f.a.Urb);Ib=fb.kf.getPropertyBool(Ib,f.a.Urb);if(bc===Ib)return!0;bc=null!=bc?bc:!1;bc=(null!=Ib?Ib:!1)||bc;fb.kf.setPropertyBool(lc,f.a.Urb,bc);return!0}if(Cb===u.a.zb(f.a.FI)){bc=fb.kf.getPropertyBool(Za,f.a.FI);Ib=fb.kf.getPropertyBool(Ib,f.a.FI);if(bc===Ib)return!0;bc=null!=bc?bc:!1;bc=(null!=Ib?Ib:!1)||bc;fb.kf.setPropertyBool(lc,f.a.FI,bc);
fb.Vg.add(u.a.zb(f.a.FI));return!0}if(Cb===u.a.zb(f.a.cU)){Cb=fb.ku.runtime.qc;Cb.kK(11);if(Cb.isFeatureEnabled(11))return this.Qxl(fb,bc,Za,Ib,lc);bc=fb.kf.getPropertyString(Za,f.a.cU);Ib=fb.kf.getPropertyString(Ib,f.a.cU);if(bc===Ib)return!0;fb.kf.setPropertyString(lc,f.a.cU,Ib||bc);fb.Vg.add(u.a.zb(f.a.cU));return!0}return!1}Qxl(fb,Cb,lc,bc,Za){lc=fb.kf.getPropertyString(lc,f.a.cU);bc=fb.kf.getPropertyString(bc,f.a.cU);if(lc===bc)return!0;Cb=fb.kf.getPropertyString(Cb,f.a.cU);const Ib={};for(let rc=
0;rc<this.XGh.length;rc++){const yc=this.XGh[rc];var Ub=this.lNf(Cb,yc,0);const rb=this.lNf(lc,yc,1),$c=this.lNf(bc,yc,2);Ub=this.qOn(Ub,rb,$c);Ib[yc.toString()]=Ub.toArray()}fb.kf.setPropertyString(Za,f.a.cU,this.PSo(Ib));fb.Vg.add(u.a.zb(f.a.cU));return!0}qOn(fb,Cb,lc){const bc=new H.a,Za=new H.a(0);for(var Ib=0;Ib<Cb.length;Ib++){const rc=Cb[Ib].UserId;bc.add(rc,Cb[Ib]);Za.add(rc,0)}for(Cb=0;Cb<lc.length;Cb++)Ib=lc[Cb].UserId,Za.mb(Ib)?Za.W(Ib,2):(bc.add(Ib,lc[Cb]),Za.add(Ib,0));for(lc=0;lc<fb.length;lc++)Cb=
fb[lc].UserId,Za.mb(Cb)&&2!==Za.K(Cb)&&Za.W(Cb,1);const Ub=new R.a;Za.forEach((rc,yc)=>{if(1===yc)return!0;Ub.add(bc.K(rc));return!0});return Ub}lNf(fb,Cb,lc){fb=Object(S.a)(Object,this.TIm(fb,lc));return Cb.toString()in fb?Array.isArray(fb[Cb.toString()])?fb[Cb.toString()]:null:[]}TIm(fb,Cb){if(this.L5e.mb(Cb))return Object(S.a)(Object,this.L5e.K(Cb));fb=Object(S.a)(Object,this.GSl(fb));this.L5e.add(Cb,fb);return fb}GSl(fb){return Object(S.a)(Object,aa.b(fb))}PSo(fb){return aa.c(fb)}Uf(fb){return fb&&
fb.length?!1:!0}static Hh(){return new Y}static get instance(){return Y.gh.value}}Y.gh=new l.a(Y.Hh);Object(I.a)(Y,"CommentNodeComplexMerge",w.a,[]);class X extends w.a{constructor(){super()}get Ho(){return 46}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.Wd),1);fb.W(u.a.zb(x.a.lastModifiedTime),0);fb.W(u.a.zb(f.a.TWc),2);return fb}RD(fb,Cb){if(Cb===u.a.zb(f.a.Wd))return v.a.instance.Ua(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
fb.Yl.id,fb.Yl.wc,Cb),w.a.b9f(fb,this,f.a.Wd);v.a.instance.Ua(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",fb.hh.value.Kf.id,Cb);return!1}static Hh(){return new X}static get instance(){return X.gh.value}}X.gh=new l.a(X.Hh);Object(I.a)(X,"ContentControlContainerNodeComplexMerge",w.a,[]);var ca=d(32),fa=d(46),ja=d(1783);class ra extends w.a{constructor(){super()}get Ho(){return 37}jl(){const fb=
super.jl();fb.W(u.a.zb(f.a.raa),1);fb.W(u.a.zb(f.a.dAb),1);fb.W(u.a.zb(f.a.AXd),2);fb.W(u.a.zb(f.a.tMb),2);fb.W(u.a.zb(f.a.Wd),1);fb.W(u.a.zb(f.a.mba),1);fb.W(u.a.zb(f.a.tka),1);fb.W(u.a.zb(f.a.Hfc),1);fb.W(u.a.zb(f.a.bob),1);fb.W(u.a.zb(f.a.Znb),1);fb.W(u.a.zb(f.a.Ynb),1);fb.W(u.a.zb(f.a.xUa),2);fb.W(u.a.zb(f.a.vMb),1);fb.W(u.a.zb(f.a.BXd),1);fb.W(u.a.zb(f.a.qaa),1);fb.W(u.a.zb(f.a.UL),2);fb.W(u.a.zb(f.a.gAa),2);fb.W(u.a.zb(f.a.Rra),2);fb.W(u.a.zb(f.a.w3),1);fb.W(u.a.zb(f.a.gta),1);fb.W(u.a.zb(f.a.hta),
1);this.qc.isFeatureEnabled(16)&&(fb.W(u.a.zb(ca.a.Prf),2),fb.W(u.a.zb(ca.a.e7h),2),fb.W(u.a.zb(ca.a.d7h),2),fb.W(u.a.zb(ca.a.m7h),2),fb.W(u.a.zb(ca.a.l7h),2));return fb}RD(fb,Cb){var lc=fb.hh.value.Kf,bc=fb.Xo.value.Kf;const Za=fb.Yl;if(Cb===u.a.zb(f.a.Wd))return w.a.b9f(fb,this,f.a.Wd);if(Cb===u.a.zb(f.a.mba)){Cb=fb.kf.getPropertyBool(lc,f.a.mba);bc=fb.kf.getPropertyBool(bc,f.a.mba);if(null!=Cb&&Cb||null!=bc&&bc)fb.kf.setPropertyBool(Za,f.a.mba,!0),fb.Vg.add(u.a.zb(f.a.mba));return!0}if(Cb===u.a.zb(f.a.tka))return Cb=
fb.kf.getPropertyBool(lc,f.a.tka),bc=fb.kf.getPropertyBool(bc,f.a.tka),fb.kf.setPropertyBool(Za,f.a.tka,null!=Cb&&!!Cb&&null!=bc&&!!bc),fb.Vg.add(u.a.zb(f.a.tka)),!0;if(Cb===u.a.zb(f.a.Hfc))return Cb=fb.kf.getPropertyUint32(bc,f.a.Hfc),null!=Cb&&(fb.kf.setPropertyUint32(Za,f.a.Hfc,Cb),fb.Vg.add(u.a.zb(f.a.Hfc))),!0;if(Cb===u.a.zb(f.a.bob)||Cb===u.a.zb(f.a.Znb)||Cb===u.a.zb(f.a.Ynb))return(bc=fb.kf.getPropertyString(bc,u.a.D_(Cb)))&&0<bc.length&&(fb.kf.setPropertyString(Za,u.a.D_(Cb),bc),fb.Vg.add(Cb)),
!0;if(Cb===u.a.zb(f.a.vMb)||Cb===u.a.zb(f.a.BXd)){lc=fb.kf.getPropertyObjectId(lc,u.a.D_(Cb));if(ja.a.lkc(fb.ku,lc))return!0;if((bc=fb.kf.getPropertyObjectId(bc,u.a.D_(Cb)))&&bc!==fa.a.nil)return fb.kf.setPropertyObjectId(Za,u.a.D_(Cb),bc),fb.Vg.add(Cb),!0;Za.removeProperty(u.a.D_(Cb));fb.Vg.add(Cb);return!0}if(Cb===u.a.zb(f.a.qaa)){lc=fb.kf.getPropertyObjectId(lc,f.a.qaa);if((lc=ja.a.lkc(fb.ku,lc))&&fb.kf.getPropertyObjectIds(lc,f.a.Wd).IS().contains(fb.Yl.id))return!0;bc=fb.kf.getPropertyObjectId(bc,
f.a.qaa);return(lc=ja.a.lkc(fb.ku,bc))&&fb.kf.getPropertyObjectIds(lc,f.a.Wd).IS().contains(fb.Yl.id)?(fb.kf.setPropertyObjectId(Za,f.a.qaa,bc),fb.Vg.add(Cb),!0):!1}if(Cb===u.a.zb(f.a.raa))return Cb=fb.kf.getPropertyBool(bc,f.a.raa),null==Cb||Cb||(fb.kf.setPropertyBool(Za,f.a.raa,!1),fb.Vg.add(u.a.zb(f.a.raa))),!0;if(Cb===u.a.zb(f.a.dAb)){Cb=fb.kf.getPropertyObjectId(lc,f.a.dAb);bc=fb.kf.getPropertyObjectId(bc,f.a.dAb);if(Cb&&!Cb.equals(bc))return!1;if(Cb=Cb||bc)fb.kf.setPropertyObjectId(Za,f.a.dAb,
Cb),fb.Vg.add(u.a.zb(f.a.dAb));return!0}Cb!==u.a.zb(f.a.w3)&&Cb!==u.a.zb(f.a.gta)&&Cb!==u.a.zb(f.a.hta)||v.a.instance.Ua(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",Cb);return!1}static Hh(){return new ra}static get instance(){return ra.gh.value}}ra.gh=new l.a(ra.Hh);Object(I.a)(ra,"ContentControlNodeComplexMerge",w.a,[]);class ya extends w.a{constructor(){super()}get Ho(){return 10}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.jR),
1);return fb}RD(fb,Cb){if(Cb===u.a.zb(f.a.jR)){Cb=fb.Yl;const bc=fb.kf;var lc=bc.getPropertyObjectIds(fb.hh.value.Uv,f.a.jR);const Za=bc.getPropertyObjectIds(fb.hh.value.Kf,f.a.jR),Ib=bc.getPropertyObjectIds(fb.Xo.value.Kf,f.a.jR);lc=this.ZNn(lc,Za,Ib);0<lc.length?bc.setPropertyObjectIds(Cb,f.a.jR,lc):Cb.removeProperty(f.a.jR);fb.Vg.add(u.a.zb(f.a.jR));return!0}return!1}ZNn(fb,Cb,lc){return this.pMa(fb,Cb,lc)}static Hh(){return new ya}static get instance(){return ya.gh.value}}ya.gh=new l.a(ya.Hh);
Object(I.a)(ya,"CustomXmlPartContainerNodeComplexMerge",w.a,[]);class Ha extends w.a{constructor(){super()}get Ho(){return 9}get UB(){return 0}static Hh(){return new Ha}static get instance(){return Ha.gh.value}}Ha.gh=new l.a(Ha.Hh);Object(I.a)(Ha,"CustomXmlPartNodeComplexMerge",w.a,[]);class Wa extends w.a{constructor(){super()}get Ho(){return 29}get UB(){return 3}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.Rka),1);return fb}RD(fb,Cb){if(Cb===u.a.zb(f.a.Rka)){Cb=fb.kf;var lc=Cb.getPropertyObjectIds(fb.hh.value.Uv,
f.a.Rka),bc=Cb.getPropertyObjectIds(fb.hh.value.Kf,f.a.Rka);const Za=Cb.getPropertyObjectIds(fb.Xo.value.Kf,f.a.Rka);lc=this.pMa(lc,bc,Za);bc=fb.Yl;0<lc.length?Cb.setPropertyObjectIds(bc,f.a.Rka,lc):bc.removeProperty(f.a.Rka);fb.Vg.add(u.a.zb(f.a.Rka));return!0}return!1}static Hh(){return new Wa}static get instance(){return Wa.gh.value}}Wa.gh=new l.a(Wa.Hh);Object(I.a)(Wa,"EmbeddedFontContainerNodeComplexMerge",w.a,[]);class Ma extends w.a{constructor(){super()}get Ho(){return 30}get UB(){return 3}static Hh(){return new Ma}static get instance(){return Ma.gh.value}}
Ma.gh=new l.a(Ma.Hh);Object(I.a)(Ma,"EmbeddedFontNodeComplexMerge",w.a,[]);class ua extends w.a{constructor(){super()}get Ho(){return 11}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.h7),4);fb.W(u.a.zb(f.a.kKa),1);return fb}RD(fb,Cb){if(Cb===u.a.zb(f.a.kKa)){const lc=fb.Yl,bc=fb.kf;v.a.instance.Ua(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",lc.id,lc.wc,Cb);Cb=bc.getPropertyObjectIds(fb.hh.value.Uv,f.a.kKa);const Za=bc.getPropertyObjectIds(fb.hh.value.Kf,
f.a.kKa),Ib=bc.getPropertyObjectIds(fb.Xo.value.Kf,f.a.kKa);Cb=this.gej(Cb,Za,Ib,(Ub,rc)=>Ub.equals(rc));0<Cb.length?bc.setPropertyObjectIds(lc,f.a.kKa,Cb):lc.removeProperty(f.a.kKa);fb.Vg.add(u.a.zb(f.a.kKa));return!0}v.a.instance.Ua(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Kf.id,Cb);return!1}static Hh(){return new ua}static get instance(){return ua.gh.value}}ua.gh=new l.a(ua.Hh);
Object(I.a)(ua,"FootnoteEndnoteContainerNodeComplexMerge",w.a,[]);class Ka extends w.a{constructor(){super()}get Ho(){return 12}get UB(){return 3}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.tsa),1);return fb}RD(fb,Cb){const lc=fb.Yl,bc=fb.kf;if(Cb===u.a.zb(f.a.tsa)){let Za=-1;v.a.instance.Ua(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",lc.id,lc.wc,Cb);const Ib=bc.getPropertyInt32(fb.hh.value.Kf,f.a.tsa),Ub=bc.getPropertyInt32(fb.Xo.value.Kf,
f.a.tsa);null!=Ib&&-1!==Ib?Za=Ib:null!=Ub&&(Za=Ub);bc.setPropertyInt32(lc,f.a.tsa,Za);fb.Vg.add(Cb);return!0}v.a.instance.Ua(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Uv.id,Cb);return!1}static Hh(){return new Ka}static get instance(){v.a.instance.Ua(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return Ka.gh.value}}Ka.gh=new l.a(Ka.Hh);Object(I.a)(Ka,"FootnoteEndnoteNodeComplexMerge",
w.a,[]);class za extends w.a{constructor(){super()}get Ho(){return 47}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.mWa),1);return fb}RD(fb,Cb){return Cb===u.a.zb(f.a.mWa)?(v.a.instance.Ua(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",fb.Yl.id,fb.Yl.wc,Cb),w.a.b9f(fb,this,f.a.mWa)):!1}static Hh(){return new za}static get instance(){return za.gh.value}}za.gh=new l.a(za.Hh);Object(I.a)(za,"GlossaryPageManifestNodeComplexMerge",
w.a,[]);class Fa extends w.a{constructor(){super()}get Ho(){return 13}get UB(){return 3}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.yna),4);return fb}static Hh(){return new Fa}static get instance(){return Fa.gh.value}}Fa.gh=new l.a(Fa.Hh);Object(I.a)(Fa,"HeaderFooterContainerNodeComplexMerge",w.a,[]);class ea extends w.a{constructor(){super()}get Ho(){return 14}get UB(){return 3}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.runId),3);fb.W(u.a.zb(f.a.Zc),3);fb.W(u.a.zb(f.a.fVi),3);fb.W(u.a.zb(f.a.BX),1);fb.W(u.a.zb(a.a.c0),
1);fb.W(u.a.zb(x.a.imageAltText),1);fb.W(u.a.zb(f.a.a0),1);fb.W(u.a.zb(x.a.eca),1);fb.W(u.a.zb(a.a.jgb),1);fb.W(u.a.zb(f.a.JTa),1);return fb}RD(fb,Cb){if(Cb===u.a.zb(x.a.imageAltText)||Cb===u.a.zb(f.a.a0)||Cb===u.a.zb(f.a.BX)||Cb===u.a.zb(f.a.b0)||Cb===u.a.zb(x.a.hsb)||Cb===u.a.zb(x.a.eca)||Cb===u.a.zb(a.a.c0)||Cb===u.a.zb(a.a.jgb)||Cb===u.a.zb(f.a.JTa)){const bc=fb.Yl;var lc=fb.kf;v.a.instance.Ua(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
bc.id,bc.wc,Cb);const Za=lc.getPropertyInt32(fb.hh.value.Kf,a.a.c0);lc=lc.getPropertyInt32(fb.Xo.value.Kf,a.a.c0);if(null!=Za&&(0===Za||2===Za))return!0;if(null!=lc&&(0===lc||2===lc))return Cb=fb.Xo.value.Kf,this.job(Cb,bc,x.a.imageAltText),this.job(Cb,bc,f.a.a0),this.job(Cb,bc,f.a.b0),Cb.hasProperty(f.a.BX)&&this.job(Cb,bc,f.a.BX),this.job(Cb,bc,x.a.hsb),this.job(Cb,bc,x.a.eca),this.job(Cb,bc,a.a.c0),this.job(Cb,bc,a.a.jgb),fb.Vg.add(u.a.zb(x.a.imageAltText)),fb.Vg.add(u.a.zb(f.a.a0)),fb.Vg.add(u.a.zb(f.a.b0)),
fb.Vg.add(u.a.zb(f.a.BX)),fb.Vg.add(u.a.zb(x.a.hsb)),fb.Vg.add(u.a.zb(x.a.eca)),fb.Vg.add(u.a.zb(a.a.c0)),fb.Vg.add(u.a.zb(a.a.jgb)),fb.Vg.add(u.a.zb(f.a.JTa)),!0}v.a.instance.Ua(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Uv.id,Cb);return!1}static Hh(){return new ea}static get instance(){return ea.gh.value}}ea.gh=new l.a(ea.Hh);Object(I.a)(ea,"ImageNodeComplexMerge",w.a,[]);class la extends w.a{constructor(){super()}get Ho(){return 40}get UB(){return 0}static Hh(){return new la}static get instance(){return la.gh.value}}
la.gh=new l.a(la.Hh);Object(I.a)(la,"IntelligenceAnnotationNodeComplexMerge",w.a,[]);class Na extends w.a{constructor(){super()}get Ho(){return 32}get UB(){return 0}static Hh(){return new Na}static get instance(){return Na.gh.value}}Na.gh=new l.a(Na.Hh);Object(I.a)(Na,"IntelligenceContentLocatorNodeComplexMerge",w.a,[]);class Aa extends w.a{constructor(){super()}get Ho(){return 34}get UB(){return 0}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.$Wa),1);return fb}RD(fb,Cb){const lc=fb.Yl,bc=fb.kf;if(Cb===
u.a.zb(f.a.$Wa)){Cb=bc.getPropertyObjectIds(fb.hh.value.Uv,f.a.$Wa);const Za=bc.getPropertyObjectIds(fb.hh.value.Kf,f.a.$Wa),Ib=bc.getPropertyObjectIds(fb.Xo.value.Kf,f.a.$Wa);Cb=this.pMa(Cb,Za,Ib);bc.setPropertyObjectIds(lc,f.a.$Wa,Cb);fb.Vg.add(u.a.zb(f.a.$Wa));return!0}return!1}static Hh(){return new Aa}static get instance(){return Aa.gh.value}}Aa.gh=new l.a(Aa.Hh);Object(I.a)(Aa,"IntelligenceRegionNodeComplexMerge",w.a,[]);class wa extends w.a{constructor(){super()}get Ho(){return 35}get UB(){return 0}static Hh(){return new wa}static get instance(){return wa.gh.value}}
wa.gh=new l.a(wa.Hh);Object(I.a)(wa,"IntelligenceRejectionNodeComplexMerge",w.a,[]);class va extends w.a{constructor(){super()}get Ho(){return 39}get UB(){return 0}static Hh(){return new va}static get instance(){return va.gh.value}}va.gh=new l.a(va.Hh);Object(I.a)(va,"IntelligenceReviewedNodeComplexMerge",w.a,[]);class Pa extends w.a{constructor(){super()}get Ho(){return 33}get UB(){return 0}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.nnc),1);fb.W(u.a.zb(f.a.mnc),1);fb.W(u.a.zb(f.a.mce),1);fb.W(u.a.zb(f.a.oce),
1);return fb}RD(fb,Cb){const lc=fb.Yl,bc=fb.kf;if(Cb===u.a.zb(f.a.nnc)||Cb===u.a.zb(f.a.mnc)||Cb===u.a.zb(f.a.mce)||Cb===u.a.zb(f.a.oce)){Cb=Cb===u.a.zb(f.a.nnc)?f.a.nnc:f.a.mnc;var Za=bc.getPropertyObjectIds(fb.hh.value.Uv,Cb);const Ib=bc.getPropertyObjectIds(fb.hh.value.Kf,Cb),Ub=bc.getPropertyObjectIds(fb.Xo.value.Kf,Cb);Za=this.pMa(Za,Ib,Ub);bc.setPropertyObjectIds(lc,Cb,Za);fb.Vg.add(u.a.zb(Cb));return!0}return!1}static Hh(){return new Pa}static get instance(){return Pa.gh.value}}Pa.gh=new l.a(Pa.Hh);
Object(I.a)(Pa,"IntelligenceRootNodeComplexMerge",w.a,[]);class Ta extends w.a{constructor(){super()}get Ho(){return 42}get UB(){return 0}static Hh(){return new Ta}static get instance(){return Ta.gh.value}}Ta.gh=new l.a(Ta.Hh);Object(I.a)(Ta,"IntelligenceSettingNodeComplexMerge",w.a,[]);class kb extends w.a{constructor(){super()}get Ho(){return 45}get UB(){return 0}static Hh(){return new kb}static get instance(){return kb.gh.value}}kb.gh=new l.a(kb.Hh);Object(I.a)(kb,"IntelligenceWorkflowNodeComplexMerge",
w.a,[]);class gb extends w.a{constructor(){super()}get Ho(){return 15}get UB(){return 3}static Hh(){return new gb}static get instance(){return gb.gh.value}}gb.gh=new l.a(gb.Hh);Object(I.a)(gb,"NumberListNodeComplexMerge",w.a,[]);var tb=d(106);class hb extends w.a{constructor(){super()}get Ho(){return 16}get UB(){return 0}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.IKb),1);fb.W(u.a.zb(tb.a.Gqf),7);fb.W(u.a.zb(tb.a.Eqf),7);return fb}RD(fb,Cb){const lc=fb.Yl,bc=fb.kf;if(Cb===u.a.zb(f.a.IKb))return this.M2f(bc,
fb.hh.value.Kf,fb.Xo.value.Kf,lc,f.a.IKb),fb.Vg.add(Cb),!0;v.a.instance.Ua(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Uv.id,Cb);return!1}static Hh(){return new hb}static get instance(){return hb.gh.value}}hb.gh=new l.a(hb.Hh);Object(I.a)(hb,"OutlineElementNodeComplexMerge",w.a,[]);class Xa extends w.a{constructor(){super()}get Ho(){return 17}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.IKb),1);
fb.W(u.a.zb(f.a.Zra),1);fb.W(u.a.zb(tb.a.CR),1);fb.W(u.a.zb(tb.a.rqc),1);fb.W(u.a.zb(tb.a.aZa),8);return fb}RD(fb,Cb){const lc=fb.Yl,bc=fb.kf;if(Cb===u.a.zb(f.a.IKb))return this.M2f(bc,fb.hh.value.Kf,fb.Xo.value.Kf,lc,f.a.IKb),fb.Vg.add(Cb),!0;if(Cb===u.a.zb(f.a.Zra)){var Za=bc.getPropertyBool(fb.hh.value.Kf,f.a.Zra),Ib=bc.getPropertyBool(fb.Xo.value.Kf,f.a.Zra);bc.setPropertyBool(lc,f.a.Zra,null==Za?!1:Za&&null==Ib?!1:Ib);fb.Vg.add(Cb);return!0}if(Cb===u.a.zb(tb.a.rqc))return this.M2f(bc,fb.hh.value.Kf,
fb.Xo.value.Kf,lc,tb.a.rqc),fb.Vg.add(Cb),!0;if(Cb===u.a.zb(tb.a.CR))return Za=bc.getPropertyBool(fb.hh.value.Kf,tb.a.CR),Ib=bc.getPropertyBool(fb.Xo.value.Kf,tb.a.CR),bc.setPropertyBool(lc,tb.a.CR,null==Za?!0:Za||null==Ib?!0:Ib),fb.Vg.add(Cb),!0;v.a.instance.Ua(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Uv.id,Cb);return!1}static Hh(){return new Xa}static get instance(){return Xa.gh.value}}Xa.gh=
new l.a(Xa.Hh);Object(I.a)(Xa,"OutlineGroupNodeComplexMerge",w.a,[]);var $a=d(108);class La extends w.a{constructor(){super()}get Ho(){return 18}get UB(){return 2}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.R$d),3);fb.W(u.a.zb(x.a.pS),this.UB);fb.W(u.a.zb(f.a.Zs),1);fb.W(u.a.zb(f.a.q8),1);fb.W(u.a.zb(f.a.Xq),1);fb.W(u.a.zb(ca.a.XF),1);fb.W(u.a.zb(ca.a.IYa),1);return fb}RD(fb,Cb){const lc=fb.kf;if(fb.ku.runtime.qc.isFeatureEnabled(63)){if(Cb===u.a.zb(f.a.Zs)||Cb===u.a.zb(f.a.q8)||Cb===u.a.zb(ca.a.IYa)||
Cb===u.a.zb(f.a.Xq)||Cb===u.a.zb(ca.a.XF))return this.jtp(lc,fb)}else if(Cb===u.a.zb(f.a.Zs)||Cb===u.a.zb(f.a.Xq)){let bc,Za;({DWc:Cb,oab:bc,fab:Za}=this.Eof(Object($a.a)(lc,lc.getPropertyUint32s,"getPropertyUint32s"),fb.hh.value.Uv,fb.hh.value.Kf,fb.Xo.value.Kf,f.a.Zs,null));if(!Za&&!bc)return v.a.instance.Ua(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",fb.hh.value.Kf.id,u.a.zb(f.a.Zs)),!0;let Ib,Ub,rc;({DWc:Ib,
oab:Ub,fab:rc}=this.Eof(Object($a.a)(lc,lc.getPropertyObjectIds,"getPropertyObjectIds"),fb.hh.value.Uv,fb.hh.value.Kf,fb.Xo.value.Kf,f.a.Xq,null));if(!Ub&&!rc)return v.a.instance.Ua(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",fb.hh.value.Kf.id,u.a.zb(f.a.Xq)),!0;const yc=Ub&&!rc;if((bc&&!Za)!==yc)return v.a.instance.Ua(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
fb.hh.value.Kf.id,u.a.zb(f.a.Zs),u.a.zb(f.a.Xq)),!1;yc&&(lc.setPropertyObjectIds(fb.Yl,f.a.Xq,Ib),lc.setPropertyUint32s(fb.Yl,f.a.Zs,Cb));v.a.instance.Ua(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",fb.hh.value.Kf.id,u.a.zb(f.a.Zs),bc,Za,u.a.zb(f.a.Xq),Ub,rc);fb.Vg.add(u.a.zb(f.a.Xq));fb.Vg.add(u.a.zb(f.a.Zs));
return!0}v.a.instance.Ua(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Kf.id,Cb);return!1}iOi(fb,Cb,lc,bc){let Za;({DWc:Cb,oab:bc,fab:Za}=this.Eof(Cb,lc.hh.value.Uv,lc.hh.value.Kf,lc.Xo.value.Kf,fb,bc));return Za||bc?{returnValue:!0,hrf:Cb,oab:bc,fab:Za}:(v.a.instance.Ua(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
lc.hh.value.Kf.id.toString(),u.a.zb(fb)),{returnValue:!1,hrf:Cb,oab:bc,fab:Za})}jNi(fb,Cb,lc,bc,Za){let Ib;let Ub,rc,yc,rb;({hrf:Ib,oab:$c,fab:Ub,returnValue:yc}=this.iOi(fb,Object($a.a)(lc,lc.getPropertyUint32s,"getPropertyUint32s"),bc,null));({hrf:lc,oab:Za,fab:rc,returnValue:rb}=this.iOi(Cb,Object($a.a)(lc,lc.getPropertyObjectIds,"getPropertyObjectIds"),bc,Za));var $c=$c&&!Ub;return yc&&rb?$c!==(Za&&!rc)?(v.a.instance.Ua(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
bc.hh.value.Kf.id.toString(),u.a.zb(fb),u.a.zb(Cb)),{returnValue:2,kXd:Ib,jXd:lc,lCe:$c}):{returnValue:0,kXd:Ib,jXd:lc,lCe:$c}:{returnValue:1,kXd:Ib,jXd:lc,lCe:$c}}VYf(fb){let Cb=!0;fb.forEach(lc=>lc!==fa.a.nil?Cb=!1:!0);return Cb}Msm(fb,Cb,lc){return this.VYf(fb)&&this.VYf(Cb)&&this.VYf(lc)?!0:!1}jtp(fb,Cb){let lc,bc,Za,Ib,Ub,rc;var yc=({kXd:Ib,jXd:Ub,lCe:bc}=this.jNi(ca.a.IYa,f.a.Xq,fb,Cb,null)).returnValue;if(2===yc||1===yc)return!0;({kXd:Za,jXd:rc,lCe:lc,returnValue:yc}=this.jNi(f.a.Zs,f.a.q8,
fb,Cb,Object($a.a)(this,this.Msm,"getExtendedGuidEquivalence")));if(2===yc||1===yc)return!0;let rb;({DWc:yc,oab:$c,fab:rb}=this.aql(Object($a.a)(fb,fb.getPropertyDictionary,"getPropertyDictionary"),Cb.hh.value.Uv,Cb.hh.value.Kf,Cb.Xo.value.Kf,ca.a.XF));if(!rb&&!$c)return v.a.instance.Ua(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Cb.hh.value.Kf.id.toString(),u.a.zb(ca.a.XF)),!0;var $c=$c&&!rb;if(lc!==bc||lc!==
$c)return v.a.instance.Ua(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",Cb.hh.value.Kf.id.toString(),u.a.zb(f.a.Zs),u.a.zb(ca.a.IYa),u.a.zb(ca.a.XF),bc,lc,$c),!0;lc&&(fb.setPropertyObjectIds(Cb.Yl,f.a.Xq,Ub),fb.setPropertyUint32s(Cb.Yl,ca.a.IYa,Ib),fb.setPropertyObjectIds(Cb.Yl,
f.a.q8,rc),fb.setPropertyUint32s(Cb.Yl,f.a.Zs,Za),fb.setPropertyDictionary(Cb.Yl,ca.a.XF,yc));v.a.instance.Ua(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",Cb.hh.value.Kf.id.toString(),bc,lc,$c);Cb.Vg.add(u.a.zb(ca.a.IYa));Cb.Vg.add(u.a.zb(f.a.Xq));Cb.Vg.add(u.a.zb(f.a.Zs));Cb.Vg.add(u.a.zb(f.a.q8));Cb.Vg.add(u.a.zb(ca.a.XF));return!0}static Hh(){return new La}static get instance(){return La.gh.value}}
La.gh=new l.a(La.Hh);Object(I.a)(La,"PageContentNodeComplexMerge",w.a,[]);class bb extends w.a{constructor(){super()}get Ho(){return 19}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.nEa),1);fb.W(u.a.zb(f.a.PTa),2);fb.W(u.a.zb(f.a.Gka),2);fb.W(u.a.zb(f.a.C7),1);return fb}RD(fb,Cb){const lc=fb.kf;if(Cb===u.a.zb(f.a.nEa)){var bc=lc.getPropertyObjectIds(fb.hh.value.Uv,f.a.nEa),Za=lc.getPropertyObjectIds(fb.hh.value.Kf,f.a.nEa),Ib=lc.getPropertyObjectIds(fb.Xo.value.Kf,f.a.nEa);if((bc=this.pOn(bc,Za,Ib,(Ub,
rc)=>Ub.equals(rc),Ub=>{let rc;({value:rc}=fb.ku.runtime.zv.Ec(Ub)).returnValue?fb.ku.runtime.Yq.W(Ub,new F.a(rc,!1)):v.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},fb.ku))&&0<bc.length)return lc.setPropertyObjectIds(fb.Yl,f.a.nEa,bc),fb.Vg.add(u.a.zb(f.a.nEa)),!0}if(Cb===u.a.zb(f.a.C7))return bc=lc.getPropertyObjectIds(fb.hh.value.Uv,f.a.C7),Za=lc.getPropertyObjectIds(fb.hh.value.Kf,f.a.C7),Ib=lc.getPropertyObjectIds(fb.Xo.value.Kf,
f.a.C7),bc=this.pMa(bc,Za,Ib),lc.setPropertyObjectIds(fb.Yl,f.a.C7,bc),fb.Vg.add(Cb),!0;v.a.instance.Ua(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Kf.id,Cb);return!1}static Hh(){return new bb}static get instance(){return bb.gh.value}}bb.gh=new l.a(bb.Hh);Object(I.a)(bb,"PageManifestNodeComplexMerge",w.a,[]);class Gb extends w.a{constructor(){super()}get Ho(){return 43}jl(){const fb=super.jl();
fb.W(u.a.zb(f.a.Pqa),0);fb.W(u.a.zb(f.a.TXb),0);fb.W(u.a.zb(f.a.XTb),0);fb.W(u.a.zb(f.a.Tsa),1);fb.W(u.a.zb(f.a.sessionId),3);fb.W(u.a.zb(f.a.buildVersion),3);fb.W(u.a.zb(f.a.pCa),1);fb.W(u.a.zb(f.a.IYi),1);fb.W(u.a.zb(f.a.tw),1);return fb}RD(fb,Cb){if(Cb===u.a.zb(f.a.pCa)||Cb===u.a.zb(f.a.IYi)||Cb===u.a.zb(f.a.tw)){var lc=fb.Xo.value.Kf,bc=fb.hh.value.Kf,Za=u.a.D_(Cb);bc=fb.kf.getPropertyBool(bc,Za);lc=fb.kf.getPropertyBool(lc,Za);fb.kf.setPropertyBool(fb.Yl,Za,null==bc?!1:bc&&null==lc?!1:lc);fb.Vg.add(Cb);
return!0}if(Cb===u.a.zb(f.a.Tsa)){Cb=fb.kf;lc=fb.hh.value.Uv;bc=fb.Xo.value.Kf;Za=fb.hh.value.Kf;lc=lc?Cb.getPropertyObjectId(lc,f.a.Tsa):null;bc=bc?Cb.getPropertyObjectId(bc,f.a.Tsa):null;Za=Za?Cb.getPropertyObjectId(Za,f.a.Tsa):null;v.a.instance.Ua(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",lc?lc.toString():"NULL",bc?bc.toString():"NULL",Za?Za.toString():"NULL");if(bc){if(Za&&bc.equals(Za))return fb.Vg.add(u.a.zb(f.a.Tsa)),Cb.setPropertyObjectId(fb.Yl,
f.a.Tsa,bc),!0;if(ja.a.i$d.equals(bc))return fb.Vg.add(u.a.zb(f.a.Tsa)),Cb.setPropertyObjectId(fb.Yl,f.a.Tsa,ja.a.i$d),!0}if(Za&&ja.a.i$d.equals(Za))return fb.Vg.add(u.a.zb(f.a.Tsa)),Cb.setPropertyObjectId(fb.Yl,f.a.Tsa,ja.a.i$d),!0;v.a.instance.Ua(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",lc?lc.toString():"NULL",bc?bc.toString():"NULL",Za?Za.toString():"NULL")}return!1}static Hh(){return new Gb}static get instance(){return Gb.gh.value}}Gb.gh=new l.a(Gb.Hh);
Object(I.a)(Gb,"PageMetadataNodeComplexMerge",w.a,[]);var qb=d(1795),Sa=d(178);class cb extends w.a{constructor(){super()}get Ho(){return 31}jl(){const fb=super.jl();fb.W(u.a.zb(Sa.a.iC),1);fb.W(u.a.zb(f.a.listID),3);fb.W(u.a.zb(f.a.listLevel),1);fb.W(u.a.zb(f.a.Se),3);fb.W(u.a.zb(f.a.Zdc),3);fb.W(u.a.zb(f.a.runId),3);fb.W(u.a.zb(f.a.H1d),3);fb.W(u.a.zb(x.a.fontColor),3);fb.W(u.a.zb(f.a.l6h),3);fb.W(u.a.zb(f.a.Zc),1);fb.W(u.a.zb(Sa.a.ide),3);fb.W(u.a.zb(Sa.a.B2f),3);fb.W(u.a.zb(Sa.a.O9c),3);fb.W(u.a.zb(f.a.ddm),
3);fb.W(u.a.zb(tb.a.l6j),3);for(let Cb=0;Cb<cb.tbb.length;Cb++)fb.W(cb.tbb[Cb],1);return fb}RD(fb,Cb){var lc=fb.kf;const bc=fb.Yl;u.a.D_(Cb);if(Cb===u.a.zb(f.a.Zc)){lc=fb.kf.getPropertyInt32(fb.Xo.value.Kf,f.a.Zc);if(null==lc||!lc)return!0;fb.kf.setPropertyInt32(bc,f.a.Zc,lc);fb.Vg.add(Cb);return!0}if(Cb===u.a.zb(Sa.a.iC)){const Za=lc.getPropertyUint32(fb.hh.value.Kf,Sa.a.iC),Ib=lc.getPropertyUint32(fb.Xo.value.Kf,Sa.a.iC);if(null!=Za&&null!=Ib&&Za===Ib)return lc.setPropertyUint32(bc,Sa.a.iC,Za),
fb.Vg.add(Cb),!0;if(null==Za&&null==Ib)return bc.removeProperty(Sa.a.iC),fb.Vg.add(u.a.zb(Sa.a.iC)),!0;if(null!=Za&&null==Ib)return lc.setPropertyUint32(bc,Sa.a.iC,Za),fb.Vg.add(Cb),!0;if(null==Za&&null!=Ib)return lc.setPropertyUint32(bc,Sa.a.iC,Ib),fb.Vg.add(Cb),!0}else{if(Cb===u.a.zb(f.a.listLevel))return this.wsp(lc,fb);if(Array.contains(cb.tbb,Cb))return this.vsp(fb)}return!1}vsp(fb){let Cb=!0,lc=!0,bc,Za;({gln:Cb,oin:lc,i7l:bc,Jzl:Za}=this.bql(fb));v.a.instance.Ua(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",
fb.hh.value.Kf.id.toString(),Cb,lc);return Cb&&!lc?(this.Vej(Za,fb),!0):Cb?!1:(this.Vej(bc,fb),!0)}bql(fb){let Cb,lc,bc,Za;const Ib=fb.Xo.value;let Ub;const rc=fb.hh.value;let yc;lc=Cb=!0;bc=new H.a;Za=new H.a;for(let rb=0;rb<cb.tbb.length;rb++){const $c=cb.tbb[rb],cd=({value:Ub}=Ib.mNa.Ec($c)).returnValue;({value:yc}=rc.mNa.Ec($c)).returnValue&&(Cb=this.r4j(fb.hh,bc,yc,$c)&&Cb);cd&&(lc=this.r4j(fb.Xo,Za,Ub,$c)&&lc)}return{gln:Cb,oin:lc,i7l:bc,Jzl:Za}}r4j(fb,Cb,lc,bc){const Za=u.a.D_(bc);fb=fb.value.Kf;
Cb.W(bc,fb.hasProperty(Za)?fb.kH(Za):null);return!lc.s3}Vej(fb,Cb){const lc=Cb.Yl;for(let Za=0;Za<cb.tbb.length;Za++){var bc=cb.tbb[Za];const Ib=u.a.D_(bc);(bc=fb.K(bc))?lc.seb(Ib,bc):lc.removeProperty(Ib)}for(fb=0;fb<cb.tbb.length;fb++)Cb.Vg.add(cb.tbb[fb]);v.a.instance.Ua(578932994,1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",Cb.hh.value.Kf.id.toString())}wsp(fb,Cb){const lc=Cb.Yl,bc=fb.getPropertyInt32(Cb.hh.value.Kf,f.a.listLevel),Za=fb.getPropertyInt32(Cb.Xo.value.Kf,
f.a.listLevel);return null!=bc&&null!=Za&&bc===Za?(fb.setPropertyInt32(lc,f.a.listLevel,bc),Cb.Vg.add(u.a.zb(f.a.listLevel)),!0):null==bc&&null==Za?(lc.removeProperty(f.a.listLevel),Cb.Vg.add(u.a.zb(f.a.listLevel)),!0):null!=bc&&null==Za?(fb.setPropertyInt32(lc,f.a.listLevel,bc),Cb.Vg.add(u.a.zb(f.a.listLevel)),!0):null==bc&&null!=Za?(fb.setPropertyInt32(lc,f.a.listLevel,Za),Cb.Vg.add(u.a.zb(f.a.listLevel)),!0):!1}static Hh(){return new cb}static get instance(){return cb.gh.value}}cb.gh=new l.a(cb.Hh);
cb.tbb=[u.a.zb(f.a.je),u.a.zb(f.a.Pt),u.a.zb(x.a.e8),u.a.zb(f.a.rga),u.a.zb(f.a.Yw),u.a.zb(f.a.$s),u.a.zb(x.a.VU),u.a.zb(f.a.xkf),u.a.zb(x.a.font),u.a.zb(tb.a.Pub),u.a.zb(a.a.fx)];Object(I.a)(cb,"PersistablePropertySetComplexMerge",w.a,[]);class pb extends w.a{constructor(){super()}get Ho(){return 21}get UB(){return 0}static Hh(){return new pb}static get instance(){return pb.gh.value}}pb.gh=new l.a(pb.Hh);Object(I.a)(pb,"RevisionMetadataNodeComplexMerge",w.a,[]);class vb extends w.a{constructor(){super()}get Ho(){return 48}jl(){const fb=
super.jl();fb.W(u.a.zb(f.a.Xqe),3);return fb}static Hh(){return new vb}static get instance(){return vb.gh.value}}vb.gh=new l.a(vb.Hh);Object(I.a)(vb,"ShadowNumberListNodeComplexMerge",w.a,[]);class xb extends w.a{constructor(){super()}get Ho(){return 22}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.kbb),7);fb.W(u.a.zb(f.a.x$c),2);return fb}static Hh(){return new xb}static get instance(){return xb.gh.value}}xb.gh=new l.a(xb.Hh);Object(I.a)(xb,"SharedPersistablePropertySetComplexMerge",w.a,[]);class Bb extends w.a{constructor(){super()}get Ho(){return 38}get UB(){return 3}static Hh(){return new Bb}static get instance(){return Bb.gh.value}}
Bb.gh=new l.a(Bb.Hh);Object(I.a)(Bb,"StylePropertySetComplexMerge",w.a,[]);class jc extends w.a{constructor(){super()}get Ho(){return 23}get UB(){return 0}jl(){const fb=super.jl();fb.W(u.a.zb(x.a.qg),4);fb.W(u.a.zb(f.a.rowSpan),1);fb.W(u.a.zb(f.a.colSpan),1);fb.W(u.a.zb(f.a.ghostCell),1);fb.W(u.a.zb(ca.a.vMerge),1);fb.W(u.a.zb(ca.a.gridSpan),1);fb.W(u.a.zb(f.a.Cfb),2);fb.W(u.a.zb(f.a.lAb),2);fb.W(u.a.zb(f.a.HOa),2);return fb}oCa(fb){if(!fb)return v.a.instance.Ua(540120285,1,2,"Feature helper is null"),
!1;fb.kK(98);return fb.isFeatureEnabled(98)}RD(fb,Cb){fb.ku.runtime.gJ("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+Cb);let lc=Cb===u.a.zb(f.a.rowSpan)||Cb===u.a.zb(f.a.colSpan)||Cb===u.a.zb(f.a.ghostCell);this.oCa(fb.ku.runtime.qc)&&(lc=lc||Cb===u.a.zb(ca.a.vMerge)||Cb===u.a.zb(ca.a.gridSpan));return!lc}static Hh(){return new jc}static get instance(){return jc.gh.value}}jc.gh=new l.a(jc.Hh);Object(I.a)(jc,"TableCellNodeComplexMerge",w.a,[]);var xc=d(1737);class Qc extends w.a{constructor(){super()}get Ho(){return 24}get UB(){return 0}jl(){const fb=
super.jl();fb.W(u.a.zb(x.a.qg),1);fb.W(u.a.zb(x.a.a9),1);fb.W(u.a.zb(x.a.Uha),1);fb.W(u.a.zb(f.a.nzc),1);fb.W(u.a.zb(f.a.Pca),1);fb.W(u.a.zb(f.a.Cfb),2);fb.W(u.a.zb(f.a.lAb),2);fb.W(u.a.zb(f.a.HOa),2);return fb}RD(fb,Cb){fb.ku.runtime.gJ("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+Cb);if(Cb===u.a.zb(x.a.qg)||Cb===u.a.zb(x.a.a9)||Cb===u.a.zb(f.a.nzc)||Cb===u.a.zb(f.a.Pca)||Cb===u.a.zb(x.a.Uha)){const bc=fb.Yl,Za=fb.kf;v.a.instance.Ua(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
bc.id,bc.wc,Cb);if(this.vXl(fb))return!1;var lc=Za.getPropertyObjectIds(fb.hh.value.Uv,x.a.qg);const Ib=Za.getPropertyObjectIds(fb.hh.value.Kf,x.a.qg),Ub=Za.getPropertyObjectIds(fb.Xo.value.Kf,x.a.qg);lc=this.gej(lc,Ib,Ub,(rc,yc)=>rc.equals(yc));if(0<lc.length)return Za.setPropertyObjectIds(bc,x.a.qg,lc),Za.setPropertyInt32(bc,x.a.Uha,lc.length),fb.Vg.add(u.a.zb(x.a.qg)),fb.Vg.add(u.a.zb(x.a.a9)),fb.Vg.add(u.a.zb(x.a.Uha)),fb.Vg.add(u.a.zb(f.a.nzc)),fb.Vg.add(u.a.zb(f.a.Pca)),!0}v.a.instance.Ua(4018189,
1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Kf.id,Cb);return!1}vXl(fb){const Cb=fb.Xo.value,lc=fb.hh.value;let bc,Za;({value:bc}=Cb.mNa.Ec(u.a.zb(x.a.a9)));({value:Za}=lc.mNa.Ec(u.a.zb(x.a.a9)));return bc.s3||Za.s3?bc.s3&&Za.s3?(v.a.instance.Ua(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",bc.oldValue,Za.newValue,bc.newValue),
fb.ku.logger.Ti(Object.assign(new xc.a,{ek:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):Qc.chi(fb.ku,bc,lc,"BaseConflict")||Qc.chi(fb.ku,Za,Cb,"BaseFavored")?!0:!1:!1}static Hh(){return new Qc}static get instance(){return Qc.gh.value}static chi(fb,Cb,lc,bc){return Cb.s3&&({value:Cb}=lc.mNa.Ec(u.a.zb(x.a.qg)),Cb.s3)?(v.a.instance.Ua(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",bc),fb.logger.Ti(Object.assign(new xc.a,
{ek:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}Qc.gh=new l.a(Qc.Hh);Object(I.a)(Qc,"TableNodeComplexMerge",w.a,[]);class fd extends w.a{constructor(){super()}get Ho(){return 25}get UB(){return 0}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.Zc),3);fb.W(u.a.zb(x.a.qg),4);fb.W(u.a.zb(f.a.Cfb),2);fb.W(u.a.zb(f.a.lAb),2);fb.W(u.a.zb(f.a.HOa),2);fb.W(u.a.zb(ca.a.wHg),2);fb.W(u.a.zb(ca.a.vHg),2);return fb}static Hh(){return new fd}static get instance(){return fd.gh.value}}fd.gh=new l.a(fd.Hh);Object(I.a)(fd,
"TableRowNodeComplexMerge",w.a,[]);class Ac extends w.a{constructor(){super()}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.xkp),2);fb.W(u.a.zb(x.a.qg),1);return fb}RD(fb,Cb){if(Cb===u.a.zb(x.a.qg)){const bc=fb.Yl,Za=fb.kf;v.a.instance.Ua(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",bc.id,bc.wc,Cb);var lc=Za.getPropertyObjectIds(fb.hh.value.Uv,x.a.qg);const Ib=Za.getPropertyObjectIds(fb.hh.value.Kf,x.a.qg),Ub=Za.getPropertyObjectIds(fb.Xo.value.Kf,
x.a.qg);if(lc=this.AOn(lc,Ib,Ub))return 0<lc.length?Za.setPropertyObjectIds(bc,x.a.qg,lc):bc.removeProperty(x.a.qg),fb.Vg.add(u.a.zb(x.a.qg)),!0}v.a.instance.Ua(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Kf.id,Cb);return!1}AOn(fb,Cb,lc){const bc=new H.a(0);fb.forEach(Ib=>{bc.W(Ib,0);return!0});Cb.forEach(Ib=>{bc.mb(Ib)?bc.W(Ib,1):bc.W(Ib,3);return!0});lc.forEach(Ib=>{let Ub;({value:Ub}=bc.Ec(Ib)).returnValue?
1===Ub?bc.W(Ib,5):3===Ub?(v.a.instance.Ua(42754253,1,2,"TaskNode was found added by both sides of merge"),bc.W(Ib,3)):bc.W(Ib,2):bc.W(Ib,4);return!0});const Za=new R.a;bc.forEach((Ib,Ub)=>{0!==Ub&&2!==Ub&&1!==Ub&&Za.add(Ib);return!0});return Za}static Hh(){return new Ac}static get instance(){return Ac.gh.value}}Ac.gh=new l.a(Ac.Hh);Object(I.a)(Ac,"TaskContentNodeComplexMerge",w.a,[]);class Nb{equals(fb,Cb){return fb&&Cb?fb.UserId===Cb.UserId&&fb.Provider===Cb.Provider&&fb.DisplayName===Cb.DisplayName&&
fb.Email===Cb.Email:!fb&&!Cb}tN(){return 0}}Object(I.a)(Nb,"CommentTaskPersonComparer",null,[14]);class ib{equals(fb,Cb){return fb&&Cb?fb.startDate?fb.endDate?fb.startDate.getTime()===Cb.startDate.getTime()&&fb.endDate.getTime()===Cb.endDate.getTime():!Cb.endDate:!Cb.startDate:!fb&&!Cb}tN(){return 0}}Object(I.a)(ib,"CommentTaskScheduleEqualityComparer",null,[14]);class Rb{equals(fb,Cb){if(!fb||!Cb)return!fb&&!Cb;if(!fb.extensions&&!Cb.extensions)return!0;if(!fb.extensions||!Cb.extensions||fb.extensions.count!==
Cb.extensions.count)return!1;let lc=!0;fb.extensions.forEach((bc,Za)=>{let Ib;return({value:Ib}=Cb.extensions.Ec(bc)).returnValue&&Za===Ib?!0:lc=!1});return lc}tN(){return 0}}Object(I.a)(Rb,"ExtensionListEqualityComparer",null,[14]);class ic{O3l(fb,Cb){return fb&&Cb?fb.recordId===Cb.recordId&&ic.dch.equals(fb.user,Cb.user)&&ic.dch.equals(fb.assignee,Cb.assignee)&&fb.type===Cb.type&&fb.title===Cb.title&&fb.priority===Cb.priority&&fb.isLossy===Cb.isLossy&&fb.completion===Cb.completion&&fb.commentId===
Cb.commentId&&fb.time===Cb.time&&ic.Urk.equals(fb.schedule,Cb.schedule):!fb&&!Cb}equals(fb,Cb){return this.O3l(fb,Cb)}tN(){return 0}}ic.dch=new Nb;ic.Urk=new ib;new Rb;Object(I.a)(ic,"HistoryRecordEqualityComparer",null,[14]);var kc=d(2161),Jb=d(1479);class ec extends w.a{constructor(fb){super();this.eTa=fb}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.M1b),5);fb.W(u.a.zb(f.a.taskId),2);fb.W(u.a.zb(f.a.ikp),2);fb.W(u.a.zb(f.a.nkp),2);fb.W(u.a.zb(f.a.DEa),1);return fb}EKg(fb){if(!fb.Xo.value.Uv&&!fb.hh.value.Uv){const Cb=
fb.hh.value.Kf.$O();Cb.removeProperty(f.a.DEa);const lc=fb.hh.value.Kf,bc=fb.Xo.value.Kf;fb.hh=new l.a(()=>new Jb.a(Cb,lc));fb.Xo=new l.a(()=>new Jb.a(Cb,bc))}return super.EKg(fb)}RD(fb,Cb){if(Cb!==u.a.zb(f.a.DEa))return v.a.instance.Ua(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",fb.hh.value.Kf.id,Cb),!1;const lc=fb.Yl,bc=fb.kf;v.a.instance.Ua(42754255,1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
lc.id,lc.wc,Cb);Cb=bc.getPropertyString(fb.hh.value.Uv,f.a.DEa);const Za=bc.getPropertyString(fb.hh.value.Kf,f.a.DEa),Ib=bc.getPropertyString(fb.Xo.value.Kf,f.a.DEa);Cb=this.zOn(Cb,Za,Ib);if(!Cb)return!1;0<Cb.length?bc.setPropertyString(lc,f.a.DEa,Cb):lc.removeProperty(f.a.DEa);fb.Vg.add(u.a.zb(f.a.DEa));return!0}zOn(fb,Cb,lc){fb=this.eTa.Sgc(fb);Cb=this.eTa.Sgc(Cb);lc=this.eTa.Sgc(lc);if(!ec.X0i(fb,Cb))return v.a.instance.Ua(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),
null;if(!ec.X0i(fb,lc))return v.a.instance.Ua(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;lc=ec.Fwl(fb.length,Cb,lc);return this.eTa.Dyg(lc)}static Hh(){const fb=new kc.a;return new ec(fb)}static get instance(){return ec.gh.value}static Fwl(fb,Cb,lc){const bc=new R.a;for(let Za=0;Za<Cb.length;Za++)bc.add(Cb.K(Za));for(;fb<lc.length;fb++)bc.add(lc.K(fb));return bc}static X0i(fb,Cb){const lc=fb.length;if(lc>Cb.length)return!1;for(let bc=0;bc<lc;bc++)if(!ec.nzk.equals(Cb.K(bc),
fb.K(bc)))return Cb.K(bc).recordId===fb.K(bc).recordId&&v.a.instance.Ua(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}ec.gh=new l.a(ec.Hh);ec.nzk=new ic;Object(I.a)(ec,"TaskSingleNodeComplexMerge",w.a,[]);class qa extends w.a{constructor(){super()}get Ho(){return 26}jl(){const fb=super.jl();fb.W(u.a.zb(x.a.qg),1);return fb}RD(fb,Cb){const lc=x.a.qg;if(Cb===u.a.zb(lc)){Cb=fb.Yl;const Za=fb.kf;var bc=Za.getPropertyObjectIds(fb.hh.value.Uv,
lc);const Ib=Za.getPropertyObjectIds(fb.hh.value.Kf,lc),Ub=Za.getPropertyObjectIds(fb.Xo.value.Kf,lc);bc=this.HOn(bc,Ib,Ub);Za.setPropertyObjectIds(Cb,lc,bc);fb.Vg.add(u.a.zb(lc));return!0}return!1}HOn(fb,Cb,lc){return this.pMa(fb,Cb,lc)}static Hh(){return new qa}static get instance(){return qa.gh.value}}qa.gh=new l.a(qa.Hh);Object(I.a)(qa,"VectorClockContainerNodeComplexMerge",w.a,[]);class sa extends w.a{constructor(){super()}get Ho(){return 27}jl(){const fb=super.jl();fb.W(u.a.zb(f.a.a1),1);return fb}RD(fb,
Cb){const lc=f.a.a1;if(Cb===u.a.zb(lc)){Cb=fb.Yl;const bc=fb.kf,Za=bc.getPropertyUint32(fb.hh.value.Kf,lc)||0,Ib=bc.getPropertyUint32(fb.Xo.value.Kf,lc)||0;bc.setPropertyUint32(Cb,lc,this.OAm(Za,Ib));fb.Vg.add(u.a.zb(lc));return!0}return!1}OAm(fb,Cb){return fb>Cb?fb:Cb}static Hh(){return new sa}static get instance(){return sa.gh.value}}sa.gh=new l.a(sa.Hh);Object(I.a)(sa,"VectorClockNodeComplexMerge",w.a,[]);class ab extends w.a{constructor(){super()}get Ho(){return 28}get UB(){return 0}jl(){const fb=
super.jl();fb.W(u.a.zb(f.a.Qyf),3);fb.W(u.a.zb(f.a.Zc),3);fb.W(u.a.zb(f.a.xhi),5);fb.W(u.a.zb(f.a.Pje),5);fb.W(u.a.zb(f.a.yna),5);return fb}static Hh(){return new ab}static get instance(){return ab.gh.value}}ab.gh=new l.a(ab.Hh);Object(I.a)(ab,"WordSectionNodeComplexMerge",w.a,[]);d.d(J,"a",function(){return eb});class eb{w$h(fb,Cb){switch(fb.wc){case m.a.bna:return fb.hasProperty(f.a.imageType)||fb.hasProperty(a.a.c0)?this.hq(ea.instance,Cb):this.hq(cb.instance,Cb);case m.a.sdc:return this.hq(z.instance,
Cb);case m.a.dIa:return this.hq(y.instance,Cb);case m.a.zKb:return this.hq(G.instance,Cb);case m.a.vdc:return this.hq(C.instance,Cb);case m.a.PTa:return this.hq(O.instance,Cb);case m.a.kIa:return this.hq(V.instance,Cb);case m.a.kza:return this.hq(Z.instance,Cb);case m.a.$mb:return this.hq(W.instance,Cb);case m.a.nka:return this.hq(P.instance,Cb);case m.a.lL:return this.hq(Y.instance,Cb);case m.a.Wd:return this.hq(ra.instance,Cb);case m.a.zra:return this.hq(X.instance,Cb);case m.a.Gka:return this.hq(ya.instance,
Cb);case m.a.jR:return this.hq(Ha.instance,Cb);case m.a.MJa:return this.hq(Wa.instance,Cb);case m.a.Rka:return this.hq(Ma.instance,Cb);case m.a.jKa:return this.hq(ua.instance,Cb);case m.a.Oaa:return this.hq(Ka.instance,Cb);case m.a.yBa:return this.hq(Fa.instance,Cb);case m.a.NWa:return this.hq(ea.instance,Cb);case m.a.zI:return this.hq(ea.instance,Cb);case m.a.EWf:return this.hq(la.instance,Cb);case m.a.FWf:return this.hq(Na.instance,Cb);case m.a.lce:return this.hq(Aa.instance,Cb);case m.a.GWf:return this.hq(wa.instance,
Cb);case m.a.HWf:return this.hq(va.instance,Cb);case m.a.C7:return this.hq(Pa.instance,Cb);case m.a.pcb:return this.hq(gb.instance,Cb);case m.a.dY:return this.hq(hb.instance,Cb);case m.a.xH:return this.hq(Xa.instance,Cb);case m.a.Vh:return this.hq(La.instance,Cb);case m.a.wXb:return this.hq(Gb.instance,Cb);case m.a.gDa:return this.hq(bb.instance,Cb);case m.a.paragraphNode:return this.hq(qb.a.instance,Cb);case m.a.kwc:return this.hq(pb.instance,Cb);case m.a.O_a:return this.hq(xb.instance,Cb);case m.a.rzb:return this.hq(Bb.instance,
Cb);case m.a.Nca:return this.hq(jc.instance,Cb);case m.a.Ep:return this.hq(Qc.instance,Cb);case m.a.Xna:return this.hq(fd.instance,Cb);case m.a.o3b:return this.hq(qa.instance,Cb);case m.a.KOa:return this.hq(Ac.instance,Cb);case m.a.Ezc:return this.hq(ec.instance,Cb);case m.a.iGe:return this.hq(sa.instance,Cb);case m.a.mia:return this.hq(ab.instance,Cb);case m.a.MWf:return this.hq(kb.instance,Cb);case m.a.JWf:return this.hq(Ta.instance,Cb);case m.a.mBa:return this.hq(za.instance,Cb);case m.a.Sod:return this.hq(vb.instance,
Cb)}return this.hq(w.a.instance,Cb)}hq(fb,Cb){fb.qc=Cb?Cb():null;return fb}}Object(I.a)(eb,"GraphNodeComplexMergeFactory",null,[1181])},2005:function(I,J,d){d.r(J);I=d(0);var m=d(1446),f=d(72),a=d(346),l=d(82),w=d(1398);class z{constructor(K,R,E,L=0){this.WLi=K;this.groupType=R;this.FRf=L;this.Uld=E}}Object(I.a)(z,"SortingGroup",null,[]);class x{constructor(K,R,E,L){this.order=K;this.cba=R;this.aVm=E;this.groupType=L}}Object(I.a)(x,"SortingProp",null,[]);var u=d(1389),v=d(1393),F=d(1388),y=d(1375);
class G{constructor(K,R){this.acj={};this.$bj={};this.Wbj=this.hcj=1;this.iYh(K,R)}zcp(K,R,E){var L=F.a.KU(E)?this.acj:this.$bj;E=new f.a;for(var O of R)R=Object(l.a)(x,L[m.a[O.groupType].toLowerCase()]),y.c(R)||E.add(new a.a(R,O));E.Sc((Z,W)=>Z.key.order<W.key.order?-1:1);Array.clear(K);O=u.TellMeActor.instance.e2;for(R=0;R<E.count;){L=E.K(R).key.cba;var V=E.K(R).value;const Z=new w.a(E.K(R).key.groupType);y.c(O)||O.Location===v.a.contextMenu||(Z.displayName=E.K(R).key.aVm);for(const W of V.results)Z.jy(W);
for(V=++R;V<E.count&&E.K(V).key.cba===L;)this.vff(Z,E.K(V).value),V=++R;K.push(Z)}}rCp(K,R){this.Wbj=this.hcj=1;this.iYh(K,R)}iYh(K,R){this.TWj(K);for(var E=0;E<K.length;E++){const L=K[E];for(const O of L.Uld)this.KXk(O,E,L.WLi,L.groupType)}this.TWj(R);for(K=0;K<R.length;K++){E=R[K];for(const L of E.Uld)this.JXk(L,K,E.WLi,E.groupType)}}TWj(K){K.sort((R,E)=>Object(l.a)(z,R).FRf>Object(l.a)(z,E).FRf?-1:1)}KXk(K,R,E,L){this.acj[m.a[K].toLowerCase()]=new x(this.hcj++,R,E,L)}JXk(K,R,E,L){this.$bj[m.a[K].toLowerCase()]=
new x(this.Wbj++,R,E,L)}vff(K,R){for(let E=0;E<R.results.length;E++)K.jy(R.results[E])}}Object(I.a)(G,"BaseGroupingSorter",null,[]);class C{constructor(){this.fje=[new z("",26,[26]),new z("",24,[24]),new z(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new z(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new z("",13,[13]),new z("",22,[22])];this.aje=[new z("",25,[25]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,
31,[17,0,1,8,28]),new z(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new z(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new z("",13,[13]),new z("",22,[22])];this.Hbj=new G(this.fje,this.aje)}bqd(K,R,E,L=null,O=null){let V=!1;if(L){for(const Z of F.a.KU(E)?this.fje:this.aje)this.Hpo(Z,L);V=!0}if(O){for(const Z of F.a.KU(E)?this.fje:this.aje)this.sCp(R,Z,O);V=!0}V&&this.Hbj.rCp(this.fje,this.aje);this.Hbj.zcp(K,R,E)}Hpo(K,R){const E=new f.a;
for(var L of K.Uld){const O=R[m.a[L].toLowerCase()];E.add(new a.a(y.c(O)?Number.MAX_VALUE:O,L))}if(E.count){E.Sc((O,V)=>O.key<V.key?-1:1);R=Array(E.count);for(L=0;L<E.count;L++)R[L]=E.K(L).value;K.Uld=R}}sCp(K,R,E){let L=0;for(const O of R.Uld)if(m.a[O].toLowerCase()in E&&E[m.a[O].toLowerCase()])for(const V of K)if(V.groupType===O){L+=E[m.a[O].toLowerCase()];break}R.FRf=L}}Object(I.a)(C,"SimplifiedGroupingSorterImpl",null,[]);d.d(J,"GroupsPlacementInfo",function(){return H});class H{constructor(K){this.Zbj=
{};this.Xbj={};this.Ybj={};this.bcj={};this.U7f={};this.ccj=this.$Jn=this.VJn=this.XJn=1;this.ecj=null;this.Lx=K;this.Eil();this.mfo();this.sil();this.whl();K.AS&&(this.ecj=new C)}QG(K){this.Zbj[m.a[K].toLowerCase()]=this.XJn++}IJ(K,R){this.Xbj[m.a[K].toLowerCase()]=R}wTa(K){this.Ybj[m.a[K].toLowerCase()]=this.VJn++}p6(K){this.bcj[m.a[K].toLowerCase()]=this.$Jn++}tF(K){this.U7f[m.a[K].toLowerCase()]=this.ccj++}Eil(){const K=!!this.Lx&&this.Lx.cbb,R=!!this.Lx&&this.Lx.bgd,E=!!this.Lx&&this.Lx.bub,
L=!!this.Lx&&this.Lx.K1f&&!F.a.wpc(),O=!!this.Lx&&this.Lx.mad,V=!!this.Lx&&this.Lx.Xce,Z=!!this.Lx&&this.Lx.O_f,W=!!this.Lx&&this.Lx.sXf;this.Lx&&(this.Lx.Rhc||this.Lx.Ska||this.Lx.Z0d)&&this.QG(26);W&&this.QG(24);this.QG(4);this.QG(18);this.QG(16);this.QG(7);this.QG(17);this.QG(0);this.QG(1);Z&&this.QG(28);O&&this.QG(23);K||this.QG(2);K&&!R||this.QG(8);this.QG(15);E&&this.QG(20);this.QG(14);this.QG(9);this.QG(12);this.QG(10);this.QG(11);K&&this.QG(2);K&&!R&&this.QG(8);this.QG(19);V&&this.QG(27);
this.QG(21);this.QG(13);L&&this.QG(22);this.QG(30)}mfo(){this.IJ(21,1);this.IJ(4,3);this.IJ(18,3);this.IJ(16,3);this.IJ(7,3);this.IJ(17,5);this.IJ(0,5);this.IJ(1,1);this.IJ(28,2);this.IJ(2,1);this.IJ(8,2);this.IJ(15,3);this.IJ(14,2);this.IJ(27,3);this.IJ(9,1);this.IJ(12,1);this.IJ(10,1);this.IJ(11,1);this.IJ(19,1);this.IJ(23,1);this.IJ(13,1);this.IJ(24,1);this.IJ(25,1);this.IJ(20,2);this.IJ(22,1);this.IJ(26,1)}sil(){this.wTa(4);this.wTa(0);this.wTa(17);this.wTa(7);this.wTa(16);this.wTa(18);this.wTa(15);
this.wTa(20);this.wTa(8);this.wTa(14)}whl(){this.p6(14);this.p6(10);this.p6(12);this.p6(9);this.p6(11);this.p6(20);this.p6(15);this.p6(8);this.p6(2);this.p6(1);this.p6(27);this.p6(7);this.p6(18);this.p6(16);this.p6(17);this.p6(0);this.p6(4)}DIo(){this.U7f={};this.ccj=1}xKm(K,R,E){this.DIo();const L=!!this.Lx&&this.Lx.cbb,O=!!this.Lx&&this.Lx.bgd,V=!!this.Lx&&this.Lx.bub,Z=!!this.Lx&&this.Lx.K1f&&!F.a.wpc(),W=!!this.Lx&&this.Lx.mad,P=!!this.Lx&&this.Lx.Xce,S=!!this.Lx&&this.Lx.O_f,aa=!!this.Lx&&this.Lx.kze;
K=K&&O;aa&&this.tF(25);this.tF(4);this.tF(18);this.tF(16);this.tF(7);this.tF(17);this.tF(0);this.tF(1);S&&this.tF(28);W&&this.tF(23);L&&!O||!K||this.tF(8);R&&this.tF(15);L||this.tF(2);P&&this.tF(27);E&&this.tF(14);L&&!O||K||this.tF(8);R||this.tF(15);V&&this.tF(20);E||this.tF(14);this.tF(9);this.tF(12);this.tF(10);this.tF(11);L&&this.tF(2);L&&!O&&this.tF(8);this.tF(19);this.tF(21);this.tF(13);Z&&this.tF(22);return this.U7f}HR(){return this.Lx}}Object(I.a)(H,"GroupsPlacementInfo",null,[])},2007:function(I,
J,d){d.r(J);I=d(0);var m=d(1629),f=d(1494),a=d(1446),l=d(1792),w=d(1493);class z{constructor(H="",K="",R="",E=-99999,L=-1,O=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=H?H:"";this.Description=K?K:"";this.Type=R?R:"";this.Score=E;this.Age=L;this.Count=O}}Object(I.a)(z,"Suggestion",null,[]);class x{constructor(H,K){this.GroupType=this.Suggestions=null;this.Suggestions=H;this.GroupType=K}}Object(I.a)(x,"SuggestionGroup",null,[]);class u{}u.gmc="help";u.U6k=
"answer";u.commands="commands";u.XSo="servicecommands";u.template="template";Object(I.a)(u,"SuggestionGroupType",null,[]);var v=d(1389),F=d(1388),y=d(2),G=d(28);d.d(J,"InteractionLogger",function(){return C});class C{constructor(H,K,R){this.WQe=0;this.haf=this.UKc=null;this.Hc=H;this.n9e=this.iOe=this.OVe=!1;this.Wsk=K;this.Gf=y.AFrameworkApplication.Ge;this.jc=R;this.mzd=this.P3e=0}get Wua(){return this.Hc.Wua}iye(H){this.Hc.iye(H)}taj(){if(this.UKc){var H=0;for(const K of this.UKc)this.Hc.RHn(K,
H++);this.UKc=null}}beginQuery(H,K,R){this.Hc.IHn(H,K,R)}Yvb(H,K){this.Hc.wdl(H,K);this.OVe=!0;this.n9e=!1}TCa(){this.OVe=!1;this.iOe||(this.taj(),this.Hc.Sji(this.WQe))}JHn(H,K){this.Hc.KHn(H,K)}GYn(H,K,R,E,L){for(const O of this.Wsk)if(H.startsWith(O)){this.n9e=!0;break}this.Hc.YEn(H,K,R,E,L)}iZn(H){this.iOe=!1;this.WQe=H;this.OVe||this.n9e||(this.taj(),this.Hc.Sji(this.WQe,!1))}hZn(H,K){this.Hc.dFn(H,K);this.iOe=!0}iGf(H,K){if(!H.count)return"";let R="";const E=Date.now();for(const L of H)H=(E-
L.timeStamp)/1E3,H=F.a.SDe(H),0<R.length&&(R+=";"),R+=K?L.commandId:L.controlId,R+=":",R+=H.toString();return R}ucb(){var H=this.iGf(m.a.instance.C2c(),!1);0<H.length&&this.Hc.WEn(H);H=this.iGf(m.a.instance.rqb(),!0);0<H.length&&this.Hc.nEn(H);H=this.iGf(m.a.instance.PHc,!0);0<H.length&&this.Hc.QFn(H);H=v.TellMeActor.instance.zvh;0<H.length&&this.Hc.GHn(G.c(H))}bIn(H){this.Hc.BEn(H)}Rba(H,K,R,E,L,O,V,Z=null){this.Hc.LGn(H,K,R,E,L,O,V,Z)}P6f(H,K,R,E){this.Hc.P6f(H,K,R,E)}lC(H,K,R=null){this.Hc.LI(H,
K,R)}onError(H,K,R=null){this.Hc.aua(H,K,R)}LXo(H){this.UKc=H}KNm(H){const K=[];if(!H)return K;for(let R=0;R<H.length;R++){const E=a.a[H[R].groupType].toLowerCase(),L=[],O=H[R].results;if(O){for(let V=0;V<O.length;V++)"findindocument"===E?Array.add(L,new z("","",E,O[V].score,O[V].fSd,O[V].count)):Array.add(L,new z(O[V].label,O[V].description,E,O[V].score,O[V].fSd,O[V].count));"answer"===E||"definition"===E||"wolframanswer"===E||"entity"===E?Array.add(K,new x(L,u.U6k)):"classifier"===E||"appsforoffice"===
E?Array.add(K,new x(L,u.commands)):"serviceclassifier"===E?Array.add(K,new x(L,u.XSo)):"assistance"===E?Array.add(K,new x(L,u.gmc)):("document"===E||"people"===E||"findindocument"===E||"notes"===E||"image"===E||"template"===E)&&Array.add(K,new x(L,E))}}return K}AOf(H,K){const R={};R.Query=K;R.SuggestionGroups=G.c(this.KNm(H));return G.c(R)}LIi(H){const K={"Content-Type":"application/json",Accept:"application/json"};K["X-Office-Version"]=y.AFrameworkApplication.buildVersion;K["X-Office-Application"]=
y.AFrameworkApplication.J.jb("Application");K["X-Office-Platform"]="WAC";K["X-TellMe-SqmUserId"]=y.AFrameworkApplication.J.jb("LoggableUserId")||"";K["X-TellMe-SessionId"]=this.Hc.Wua.jta;K["X-TellMe-SuggestionTypes"]="Ranker";K["X-TellMe-Culture"]=y.AFrameworkApplication.uiCulture;K["X-TellMe-ProcessSessionId"]=y.AFrameworkApplication.userSessionId;K["X-TellMe-Flights"]=H;K["X-TellMe-PartialQueryIndex"]=this.P3e;return K}jXb(H,K,R){this.Rba(K.length,"RankerLogging",H.data.He.toString(),Math.round(window.performance.now()-
R),w.a.y0j,!0,f.a.IWa)}RWb(H,K,R){this.Rba(K.length,"RankerLogging",H.data.He.toString(),Math.round(window.performance.now()-R),w.a.y0j,!1,f.a.IWa)}MIi(){this.haf||(this.haf=new l.a(this.jc,null,6E3));return this.haf.gda}R6f(H){const K=this.AOf(this.UKc,H),R=this.LIi("RankerLogging"),E=window.performance.now();this.Gf.Xj(this.MIi(),2,K,R,!1,0,L=>{this.jXb(L,H,E)},L=>{this.RWb(L,H,E)},null,null,!1,4E3,6E3);this.P3e++}tIo(){this.P3e=0}rzg(H){this.mzd=H}}Object(I.a)(C,"InteractionLogger",null,[])},2008:function(I,
J,d){I=d(0);var m=d(1729),f=d(46);class a{constructor(){this.source=0;this.kl=this.j1a=this.Sca=null;this.Gma=0;this.cSb=!1;this.mode=this.d0a=0;this.v0c=null;this.UVb=f.a.create()}}Object(I.a)(a,"InputState",null,[]);class l{constructor(){this.timeout=this.succeeded=this.Qza=!1;this.bM=null}}Object(I.a)(l,"OutputState",null,[]);class w{constructor(){this.cSi=this.qze=this.ppd=!1;this.qc=this.Mje=this.xjg=this.kte=this.ljp=this.Vyl=this.fUa=this.gJ=this.Avb=this.yyc=this.vup=this.j7l=this.Yq=this.swf=
this.zv=this.QA=this.Kn=this.CEe=this.y2d=this.MIa=null}}Object(I.a)(w,"RuntimeState",null,[]);d.d(J,"a",function(){return z});class z{constructor(){this.input=new a;this.runtime=new w;this.output=new l;this.logger=new m.a(this)}}Object(I.a)(z,"MergeState",null,[])},2009:function(I,J,d){d.r(J);I=d(0);var m=d(605),f=d(221),a=d(177),l=d(251),w=d(1597),z=d(1736),x=d(1777),u=d(5),v=d(2E3);class F{constructor(E,L){this.start=E;this.end=L}}Object(I.a)(F,"MergeDiffIdx",null,[]);class y{constructor(E,L,O,
V=!1,Z=null,W=null,P=!0){this.Vzd=this.Uzd=this.afh=this.SLc=0;this.Obc=this.sLe=null;this.Mib=Z||new v.a;this.wg=O;this.Bwa=E.iOa();this.zSk=L.iOa();this.ZS=new F(0,0);this.EW=new F(0,0);this.pVe=V;this.iJc=P;this.exa=W;this.Ckl();this.xYo()}get fN(){return this.Bwa}get AM(){return this.zSk}get dB(){return this.SLc}get VB(){return this.afh}get iAa(){return this.Uzd}get Ura(){return this.Vzd}get ZUl(){const E=new f.a;for(let L=this.sLe.start;L<this.sLe.end;L++)E.add(this.fN.tg(L));return E}get Lxf(){const E=
new f.a;for(let L=this.Obc.start;L<this.Obc.end;L++)E.add(this.AM.tg(L));return E}bzf(E){if(this.VB<E.VB){if(this.VB+this.iAa>E.VB)return!0}else if(this.VB>E.VB){if(E.VB+E.iAa>this.VB)return!0}else if(2===this.dB&&3===E.dB||3===this.dB&&2===E.dB||2===this.dB&&2===E.dB||3===this.dB&&3===E.dB)return!0;return!1}pFj(E,L,O,V){E.oI(L);E.wD(L,O);return V+=O.length-1}tXj(E,L,O,V,Z){let W=this.fN.tg(E),P=this.AM.tg(L);if(!W||!P||!W.dfb&&!P.dfb)return{returnValue:!1,lIa:V,oPa:Z};let S=new f.a,aa=new f.a;W.dfb&&
(S=W.kqd(),W=S.tg(O?0:S.length-1));P.dfb&&(aa=P.kqd(),P=aa.tg(O?0:aa.length-1));if(!W.gC(P,this.Mib,this.exa,this.pVe,this.iJc))return{returnValue:!1,lIa:V,oPa:Z};S.length&&(V=this.pFj(this.fN,E,S,V));aa.length&&(Z=this.pFj(this.AM,L,aa,Z));return{returnValue:!0,lIa:V,oPa:Z}}W9l(E,L,O,V,Z,W){for(;Z<=O&&W<=V;){const P=E.tg(Z),S=L.tg(W);if(!P.gC(S,this.Mib,this.exa,this.pVe,this.iJc))break;this.ZS.start+=P.length;this.EW.start+=S.length;Z++;W++}return{wkf:Z,VLg:W}}U9l(E,L,O,V,Z,W){for(;Z>=O&&W>=V;){const P=
E.tg(Z),S=L.tg(W);if(!P.gC(S,this.Mib,this.exa,this.pVe,this.iJc))return{returnValue:!0,lIa:Z,oPa:W};Z--;W--}return{returnValue:!1,lIa:Z,oPa:W}}V9l(E,L,O,V){let Z=!1;do({wkf:E,VLg:L}=this.W9l(this.fN,this.AM,O,V,E,L)),{lIa:O,oPa:V,returnValue:Z}=this.tXj(E,L,!0,O,V);while(Z);return{wkf:E,VLg:L,lIa:O,oPa:V}}T9l(E,L,O,V){let Z=!1;do{if(!({lIa:O,oPa:V}=this.U9l(this.fN,this.AM,E,L,O,V)).returnValue)break;({lIa:O,oPa:V,returnValue:Z}=this.tXj(O,V,!1,O,V))}while(Z);return{lIa:O,oPa:V}}Ckl(){var E=0,L=
0,O=this.fN.length-1,V=this.AM.length-1;0<=O&&this.fN.tg(O);0<=V&&this.AM.tg(V);({wkf:E,VLg:L,lIa:O,oPa:V}=this.V9l(E,L,O,V));if(E<O||L<V)({lIa:O,oPa:V}=this.T9l(E,L,O,V));O++;V++;this.sLe=new F(E,O);this.Obc=new F(L,V);this.ZS.end=this.ZS.start;this.EW.end=this.EW.start;for(var Z=E;Z<O;Z++){var W=this.fN.tg(Z);this.ZS.end+=W.length}for(Z=L;Z<V;Z++)W=this.AM.tg(Z),this.EW.end+=W.length;a.a.instance.Ua(3993809,1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
E,O,L,V);a.a.instance.Ua(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.ZS.start,this.ZS.end,this.EW.start,this.EW.end);this.ZS.start<=this.ZS.end&&this.EW.start<=this.EW.end&&(E=this.fN.tg(E),L=this.AM.tg(L),Z=this.fN.tg(O),W=this.AM.tg(V),O=this.fN.tg(O-1),V=this.AM.tg(V-1),a.a.instance.Ua(3993811,1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",
E,Z,L,W,O,V))}xYo(){this.afh=this.ZS.start;this.Uzd=this.Vzd=0;this.ZS.start===this.ZS.end&&this.EW.start===this.EW.end?this.SLc=0:this.ZS.start===this.ZS.end&&this.EW.start<this.EW.end?(this.SLc=1,this.Vzd=this.EW.end-this.EW.start):this.EW.start===this.EW.end&&this.ZS.start<this.ZS.end?(this.SLc=2,this.Uzd=this.ZS.end-this.ZS.start):(this.SLc=3,this.Uzd=this.ZS.end-this.ZS.start,this.Vzd=this.EW.end-this.EW.start);a.a.instance.Ua(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",
this.dB,this.VB,this.iAa,this.Ura)}Xon(E,L){return E.R7()&&L.R7()?E.runId===L.runId&&E.Qg===L.Qg:!1}Eun(E){if(!E.R7()||"\ufffc"!==E.text)return!1;E=E.kPb;return E?E.hasProperty(u.a.pk)||E.hasProperty(u.a.ITd)||E.hasProperty(u.a.Ezf)||E.hasProperty(u.a.h7)||E.hasProperty(u.a.imageType)||E.hasProperty(u.a.KXa)||E.hasProperty(u.a.aUb)||E.hasProperty(u.a.ht)&&(E=this.wg.getPropertyInt32(E,u.a.ht))&&(36===E||35===E||24===E||23===E||33===E||34===E||44===E||45===E||42===E||43===E)?!0:!1:!1}Y9c(E){return E.R7()&&
!this.Eun(E)}hml(){if(2===this.dB)return!1;var E=this.Obc.start;if(!E)return!1;let L=null;for(var O=this.Obc.start;O<this.Obc.end;O++){const V=this.AM.tg(O);if(this.Y9c(V)){L=V;break}}if(!L)return!1;--E;for(O=this.AM.tg(E);O&&!this.Y9c(O);)E--,O=this.AM.tg(E);return O&&this.Xon(O,L)?!0:!1}$yi(E){const L=new f.a;for(let O=0;O<E.length;O++)E.K(O).dfb?L.wD(L.length,E.K(O).kqd()):L.insert(L.length,E.K(O));return L}Zon(){if(3!==this.dB||this.iAa!==this.Ura)return!1;const E=this.$yi(this.ZUl),L=this.$yi(this.Lxf);
if(E.length!==L.length)return!1;for(let O=0;O<E.length;O++)if(!E.K(O).gC(L.K(O),this.Mib,this.exa,!0,this.iJc))return!1;return!0}Yon(){if(0!==this.dB&&3!==this.dB||this.fN.length!==this.AM.length)return!1;let E=!1;for(let L=0;L<this.fN.length;L++){if(!this.fN.K(L).gC(this.AM.K(L),this.Mib,this.exa,!0,this.iJc))return!1;if(3===this.fN.K(L).type||1===this.fN.K(L).type){const O=this.fN.K(L),V=this.AM.K(L);E=O.runId!==V.runId||O.Qg!==V.Qg||E}}return E}}Object(I.a)(y,"MergeBlockDiff",null,[]);var G=d(1533);
class C{constructor(E,L){this.id=E;this.index=L}}Object(I.a)(C,"ParagraphStartIndex",null,[]);var H=d(1625),K=d(1500);d.d(J,"ParagraphMerge",function(){return R});class R{constructor(E,L,O,V,Z,W,P){this.Q$b=this.SGb=this.Wp=this.Ly=null;this.vi=!1;this.lJh=this.yhh=this.d$g=this.Dya=this.XQa=this.Bwa=null;this.fe=E;this.MH=L;this.DHa=V;this.hGa=O;this.dxa=Z;this.exa=W;this.wg=P}OFi(E){const L=new m.a;E.fN.forEach(O=>{2===O.type&&L.add(O.Bk);return!0});E.AM.forEach(O=>{2===O.type&&L.remove(O.Bk);return!0});
return L}iCi(E){const L=new f.a;E.AM.forEach(O=>{2===O.type&&L.add(O.Bk);return!0});return L}V5h(E){const L=new f.a;let O=0,V=0;E.AM.forEach(Z=>{2===Z.type&&(L.add(new C(Z.Bk,O<E.VB?O:O<E.VB+E.Ura?E.VB:O-E.Ura+E.iAa)),O=V);V+=Z.length;return!0});return L}jzl(E,L){var O=this.V5h(E);const V=this.V5h(L);E=this.OFi(E);const Z=this.OFi(L);L=new f.a;const W=new m.a;let P=0;for(let S=0;S<O.length;S++){const aa=O.K(S);if(P<V.length){let Y=V.K(P);for(;P<V.length&&Y.index<=aa.index;){if(Y.id.equals(aa.id)){P++;
break}E.contains(Y.id)||W.contains(Y.id)||(L.add(Y.id),W.add(Y.id));P++;Y=V.K(P)}}Z.contains(aa.id)||(L.add(aa.id),W.add(aa.id))}for(;P<V.length;)O=V.K(P),E.contains(O.id)||W.contains(O.id)||(L.add(O.id),W.add(O.id)),P++;return L}initialize(){if(this.vi){const E=!!this.Ly&&!!this.Wp;this.fe.logger.Ti(Object.assign(new G.a,{ek:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return E}this.vi=!0;if(!({fN:this.Bwa,t0c:this.XQa,Rsd:this.Dya,rTd:this.d$g,z2d:this.yhh,DEe:this.lJh}=
K.a.W$h(this.fe,this.wg,this.MH,this.hGa,this.DHa,this.dxa,!1,!1)).returnValue)return!1;this.Ly=new y(this.Bwa,this.XQa,this.wg,void 0,void 0,this.exa);this.Wp=new y(this.Bwa,this.Dya,this.wg,void 0,void 0,this.exa);a.a.instance.Ua(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.Ly.iAa,this.Ly.Ura,this.Wp.iAa,this.Wp.Ura));return!0}$Oa(){a.a.instance.Ua(593826836,1,4,"Attempting to merge with LCS");let E=!1;
const L=new x.a(this.wg,this.fe);let O=null,V=null;var Z=null;const W=S=>this.fe.runtime.Kn.K(S),P=S=>this.fe.runtime.zv.K(S)||this.fe.runtime.Kn.K(S);this.Ly=new y(this.Bwa,this.XQa,this.wg,void 0,void 0,this.exa,!1);this.Wp=new y(this.Bwa,this.Dya,this.wg,void 0,void 0,this.exa,!1);({AK:O}=L.ybi(this.MH,W,this.hGa,S=>this.fe.runtime.QA.K(S)||this.fe.runtime.Kn.K(S),this.Ly.VB,this.Ly.VB+this.Ly.iAa,this.Ly.VB+this.Ly.Ura)).returnValue&&({AK:V}=L.ybi(this.MH,W,this.DHa,P,this.Wp.VB,this.Wp.VB+this.Wp.iAa,
this.Wp.VB+this.Wp.Ura)).returnValue&&(E=!0);E||(a.a.instance.Ua(593826835,1,2,"Failed to create update hints with LCS"),E=!1);E&&(Z=new H.a(this.fe,this.MH,this.hGa,this.DHa,S=>this.fe.runtime.qc?this.fe.runtime.qc.isFeatureEnabled(S):!1,this.wg,null,O,V),({Yq:Z}=Z.JAc()).returnValue||(a.a.instance.Ua(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.fe.logger.Ti(Object.assign(new G.a,{ek:"TryLCSMerge",eventId:"9zrqs"})),E=!1));a.a.instance.Ua(593826833,1,E?4:2,"TryLCSMerge: [Success: {0}]",
E);return{returnValue:E,Yq:Z}}JAc(){let E;E=null;if(!this.initialize())return this.fe.logger.WX("ParagraphMerge Initialize"),this.Abb(),{returnValue:!1,Yq:E};this.fe.logger.WX("ParagraphMerge Initialize");let L;this.fe.logger.Vxe(2);let O=({$Oa:L}=this.IXl()).returnValue;O=O&&({Yq:E,$Oa:L}=this.V3c(this.fe,this.wg,this.dxa,this.Q$b,this.SGb)).returnValue;this.fe.logger.hAg();if(!O){this.fe.logger.WX("ParagraphMerge DoMergeInteral");if(L){this.fe.logger.Vxe(3);({Yq:E,returnValue:O}=this.$Oa());this.fe.logger.hAg();
if(O)return{returnValue:!0,Yq:E};this.Abb();return{returnValue:!1,Yq:E}}this.Abb();return{returnValue:!1,Yq:E}}if(!({Yq:E,$Oa:L}=this.V3c(this.fe,this.wg,this.dxa,this.Q$b,this.SGb)).returnValue)return this.fe.logger.WX("ParagraphMerge DoMergeInteral"),this.Abb(),{returnValue:!1,Yq:E};this.fe.logger.WX("ParagraphMerge DoMergeInteral");return{returnValue:!0,Yq:E}}V3c(){let E;if(!({Npe:E}=K.a.V3c(this.fe,this.wg,this.dxa,this.Q$b,this.SGb)).returnValue)return this.fe.logger.WX("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),
this.Abb(),{returnValue:!1,Yq:E,$Oa:!0};this.fe.logger.WX("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,Yq:E,$Oa:!1}}Abb(E=!1){a.a.instance.foa(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+E+"] BaseRevisionMergeBlocksList: {0}",this.d$g);a.a.instance.foa(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.yhh);a.a.instance.foa(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.lJh);E=new f.a;K.a.grc(this.wg,"BaseObjects_",this.MH,E);K.a.grc(this.wg,"FavoredObjects_",
this.hGa,E);K.a.grc(this.wg,"ConflictObjects_",this.DHa,E);K.a.FFn(this.fe,E)}KZh(E){let L,O;O=L=0;if(0===this.Ly.dB)L=this.Wp.VB;else if(1===this.Ly.dB)L=this.Wp.VB<this.Ly.VB?this.Wp.VB:this.Wp.VB===this.Ly.VB?E||1!==this.Wp.dB?this.Wp.VB+this.Ly.Ura:this.Wp.VB:this.Wp.VB+this.Ly.Ura;else if(2===this.Ly.dB||3===this.Ly.dB)L=this.Wp.VB<=this.Ly.VB?this.Wp.VB:this.Wp.VB+(this.Ly.Ura-this.Ly.iAa);if(2===this.Wp.dB||3===this.Wp.dB)O=L+this.Wp.iAa;return{zLi:L,pUm:O}}Eoi(E,L){let O;O=0;if(!L)return{returnValue:!0,
qed:O};let V=0,Z=0;for(;V<E.length;){let W;for(let P=V;P<E.length;P++){V=P;W=E.K(P);const S=W.length;Z+=S;if(!(Z<L)){if(Z>L)if(W.dfb)E.oI(V),E.wD(V,W.kqd()),Z-=S;else return a.a.instance.Ua(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",L),this.fe.logger.Ti(Object.assign(new G.a,{ek:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,qed:O};break}}if(Z===L)return V++,
O=V,{returnValue:!0,qed:O}}a.a.instance.Ua(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",L);this.fe.logger.Ti(Object.assign(new G.a,{ek:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,qed:O}}o$k(E,L,O){let V=0;var Z=0,W=!1;const P=this.Wp.Lxf.iOa();if(this.Wp.hml())for(--L;0<=L;L--){let S=E.K(L);if(this.Wp.Y9c(S)){Z=E.K(L);V=Z.runId;Z=Z.Qg;W=!0;break}}W||((Z=E.K(O))&&this.Wp.Y9c(Z)?
(V=Z.runId,Z=Z.Qg):Z=V=0);for(E=0;E<P.length;E++)O=P.K(E),O.R7()&&(W=O,this.Wp.Y9c(O)?(W.runId=V,W.Qg=Z):(W.runId=0,W.Qg=0));return P}e0i(E){if(2===E.length){const L=1===E.K(0).type?E.K(0):null;E=2===E.K(1).type;if(L&&E&&""===L.text)return!0}return!1}IXl(){const E=this.Ly.Yon();if(!E&&0===this.Ly.dB)return this.Q$b=this.Wp.AM.iOa(),this.SGb=this.iCi(this.Wp),{returnValue:!0,$Oa:!1};if(0===this.Wp.dB)return this.Q$b=this.Ly.AM.iOa(),this.SGb=this.iCi(this.Ly),{returnValue:!0,$Oa:!1};(this.e0i(this.Ly.AM)||
this.e0i(this.Wp.AM))&&this.fe.logger.l$i(Object.assign(new G.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!E){var L=this.Ly.bzf(this.Wp);L&&this.dxa(47)&&(a.a.instance.Ua(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.Ly=new y(this.Bwa,this.XQa,this.wg,!0,void 0,this.exa),this.Wp=new y(this.Bwa,this.Dya,this.wg,!0,void 0,this.exa),L=this.Ly.bzf(this.Wp));if(L)return a.a.instance.Ua(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),
this.fe.logger.Ti(Object.assign(new z.a,{ek:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,$Oa:!0}}var O;L=0;this.SGb=this.jzl(this.Ly,this.Wp);({zLi:O,pUm:Z}=this.KZh(!1));const V=this.Ly.AM.iOa();if(!({qed:O}=this.Eoi(V,O)).returnValue||(2===this.Wp.dB||3===this.Wp.dB)&&!({qed:L}=this.Eoi(V,Z)).returnValue)return{returnValue:!1,$Oa:!1};if(2===this.Wp.dB||3===this.Wp.dB){this.bxc(V,L);this.bxc(V,O-1);var Z=null;for(var W=L-1;W>=O;W--)2===V.K(W).type&&(Z=V.K(W)),V.oI(W);0<V.length&&(W=V.K(V.length-
1),2!==W.type&&4!==W.type&&Z&&(this.fe.runtime.qc.kK(68),this.fe.runtime.qc.isFeatureEnabled(68)&&(V.add(Z),this.SGb.add(Z.Bk))));a.a.instance.Ua(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",L-O-1,O)}if(1===this.Wp.dB||3===this.Wp.dB)Z=this.Wp.Lxf,E&&(Z=this.o$k(V,O,L)),this.bxc(V,O-1),this.bxc(V,O),this.bxc(Z,0),this.bxc(Z,Z.length-1),V.wD(O,Z),a.a.instance.Ua(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",
O,E,Z.Vr());this.Q$b=V;return{returnValue:!0,$Oa:!1}}bxc(E,L){0>L||L>=E.length||(E=E.K(L),Object(l.a)(w.a,E)&&(E.DXa=!0))}ctd(E,L){let O;O=L;if(!this.initialize())return{returnValue:!1,Jdb:E,hva:O};if(this.Wp.bzf(this.Ly))return this.Abb(!0),this.fe.logger.Ti(Object.assign(new z.a,{ek:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,Jdb:E,hva:O};if(0===this.Wp.dB||3===this.Wp.dB&&this.Wp.Zon())return{returnValue:!0,Jdb:E,hva:L};let V;({zLi:V}=this.KZh(!0));L<V||L===V&&(1!==this.Wp.dB||1===
this.Wp.dB&&1===this.Ly.dB&&L===this.Ly.VB+this.Ly.Ura)?O=L:(O=L+this.Wp.Ura-this.Wp.iAa,O<V&&(O=V));return{returnValue:!0,Jdb:E,hva:O}}}Object(I.a)(R,"ParagraphMerge",null,[1018])},2013:function(I,J,d){d.r(J);I=d(0);var m=d(13),f=d(5),a=d(32),l=d(177),w=d(221),z=d(46),x=d(1727),u=d(1596),v=d(1531),F=d(1500);class y{constructor(K,R,E=null,L=null){this.author=K;this.Gdd=R;this.Fmg=E||z.a.nil;this.qMa=L}gC(K){return K?this.author===K.author&&this.Gdd===K.Gdd&&this.Fmg===K.Fmg&&this.qMa===K.qMa:!1}}
Object(I.a)(y,"RunMergeBlockTrackedChangeAttribute",null,[]);class G{constructor(K,R,E){this.Lsb=K||G.sAf;this.Lob=R||G.sAf;this.Qua=E||G.sAf}get n_m(){return 0<this.Lsb.author.length}get PZm(){return 0<this.Lob.author.length}get T_m(){return 0<this.Qua.author.length}gC(K){return K?this.Lsb.gC(K.Lsb)&&this.Lob.gC(K.Lob)&&this.Qua.gC(K.Qua):!1}}G.sAf=new y("",0);Object(I.a)(G,"RunMergeBlockTrackedChangeInfo",null,[]);var C=d(1794);d.d(J,"ParagraphMergeBlockCreator",function(){return H});class H extends u.a{constructor(K,
R,E,L,O,V,Z,W){super();this.maxValue=Number.MAX_VALUE;this.Yt=new x.a;this.i5b=null;this.HG=0;this.Goh=!1;this.RLc="";this.oKe=K;this.Qq=R;this.Ev=E;this.ZOk=L;this.PBd=O;this.Qnh=V;this.K8b=W;this.wg=Z;if(this.wg.hasProperty(this.Qq,m.a.Yn))if(this.wg.hasProperty(this.Qq,f.a.Zc))if(this.wg.hasProperty(this.Qq,f.a.Mq))if(this.wg.hasProperty(this.Qq,f.a.Ot))if(this.wg.hasProperty(this.Qq,m.a.Zn))if(this.S5=this.wg.getPropertyString(this.Qq,m.a.Yn),this.mdf=this.wg.getPropertyUint32(this.Qq,f.a.Zc),
this.ut=this.wg.getPropertyUint32s(this.Qq,f.a.Mq),this.ZId=this.wg.getPropertyUint32s(this.Qq,f.a.Ot),this.$Se=this.wg.getPropertyObjectIds(this.Qq,m.a.Zn),this.S5||""===this.S5)if(this.S5.length||1!==this.$Se.length||(this.ut.length||(this.ut.add(0),l.a.instance.Ua(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.ZId.length||(this.ZId.add(0),l.a.instance.Ua(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),
this.pGk=this.c5d(this.Qq,f.a.kcg,this.ut.length),this.NNc=this.c5d(this.Qq,m.a.LCa,this.ut.length),this.mqa=this.c5d(this.Qq,m.a.hzb,this.ut.length),this.xpa=this.c5d(this.Qq,f.a.oWa,this.ut.length),this.Ypa=this.YQm(this.Qq,f.a.lNa,this.ut.length),this.p8m(),K=this.wg.hasProperty(this.Qq,m.a.Dn)?this.wg.getPropertyUint32s(this.Qq,m.a.Dn):new w.a,this.HLd=F.a.ZPj(K,this.S5.length),this.ut.length!==this.ZId.length)l.a.instance.Ua(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",
R.id);else if(this.ut.length!==this.$Se.length)l.a.instance.Ua(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",R.id);else{this.Qnh&&(this.wg.hasProperty(this.Qq,f.a.Iw)?this.i5b=this.wg.getPropertyObjectIds(this.Qq,f.a.Iw):(l.a.instance.Ua(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",R.id),this.i5b=this.J2(this.ut.length,z.a.nil)),this.ut.length!==this.i5b.length&&(l.a.instance.Ua(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",
R.id,this.ut.length,this.i5b.length),this.i5b=this.J2(this.ut.length,z.a.nil)));if(this.ut.length!==this.NNc.length||this.ut.length!==this.mqa.length||this.ut.length!==this.xpa.length||this.ut.length!==this.Ypa.length)this.ut.length===this.NNc.length||this.PBd||l.a.instance.Ua(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",R.id,this.ut.length,this.NNc.length),this.ut.length===this.mqa.length||
this.PBd||l.a.instance.Ua(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",R.id,this.ut.length,this.mqa.length),this.ut.length===this.xpa.length||this.PBd||l.a.instance.Ua(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",R.id,this.ut.length,this.xpa.length),this.ut.length===this.Ypa.length||
this.PBd||l.a.instance.Ua(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",R.id,this.ut.length,this.Ypa.length),K=this.wg.getPropertyBool(this.Qq,m.a.Frf),l.a.instance.Ua(17877020,1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",R.id,O,null==K?!1:K),this.NNc=this.J2(this.ut.length,!0),this.mqa=this.J2(this.ut.length,!1),this.xpa=this.J2(this.ut.length,
!1),this.Ypa=this.J2(this.ut.length,0),this.wg.setPropertyBool(this.Qq,m.a.Frf,!1);this.Yt.yGp(this.ut.length)?(this.HLd.length!==this.ut.length+1&&l.a.instance.Ua(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",R.id,this.ut.length,this.HLd.length),this.rDk=!0):l.a.instance.Ua(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",R.id)}else l.a.instance.Ua(4322133,
1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",R.id);else l.a.instance.Ua(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",R.id);else l.a.instance.Ua(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",R.id);else l.a.instance.Ua(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",R.id);else l.a.instance.Ua(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",R.id);else l.a.instance.Ua(3993794,1,
1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",R.id)}p8m(){this.wg.hasProperty(this.Qq,f.a.pLa)?this.Yt.Jsb=this.wg.getPropertyBools(this.Qq,f.a.pLa):this.Yt.Jsb=this.J2(this.ut.length,!1);this.wg.hasProperty(this.Qq,f.a.Ika)?this.Yt.Kob=this.wg.getPropertyBools(this.Qq,f.a.Ika):this.Yt.Kob=this.J2(this.ut.length,!1);this.wg.hasProperty(this.Qq,f.a.qLa)?this.Yt.Isb=this.wg.getPropertyStrings(this.Qq,f.a.qLa):this.Yt.Isb=this.J2(this.ut.length,"");this.wg.hasProperty(this.Qq,
f.a.wJa)?this.Yt.Job=this.wg.getPropertyStrings(this.Qq,f.a.wJa):this.Yt.Job=this.J2(this.ut.length,"");this.wg.hasProperty(this.Qq,f.a.rLa)?this.Yt.Ksb=this.wg.getPropertyListOfMilliseconds(this.Qq,f.a.rLa):this.Yt.Ksb=this.J2(this.ut.length,0);this.K8b&&this.wg.hasProperty(this.Qq,a.a.YWa)?this.Yt.XWa=this.wg.eNf(this.Qq,a.a.YWa):this.Yt.XWa=null;this.wg.hasProperty(this.Qq,f.a.xJa)?this.Yt.V7a=this.wg.getPropertyListOfMilliseconds(this.Qq,f.a.xJa):this.Yt.V7a=this.J2(this.ut.length,0);this.K8b&&
this.wg.hasProperty(this.Qq,a.a.QUa)?this.Yt.ENb=this.wg.eNf(this.Qq,a.a.QUa):this.Yt.ENb=null;this.wg.hasProperty(this.Qq,f.a.kNa)?this.Yt.bdb=this.wg.getPropertyBools(this.Qq,f.a.kNa):this.Yt.bdb=this.J2(this.ut.length,!1);this.wg.hasProperty(this.Qq,f.a.YOa)?this.Yt.Rwb=this.wg.getPropertyStrings(this.Qq,f.a.YOa):this.Yt.Rwb=this.J2(this.ut.length,"");this.wg.hasProperty(this.Qq,f.a.ZOa)?this.Yt.Twb=this.wg.getPropertyListOfMilliseconds(this.Qq,f.a.ZOa):this.Yt.Twb=this.J2(this.ut.length,0);this.K8b&&
this.wg.hasProperty(this.Qq,a.a.C0a)?this.Yt.jYb=this.wg.eNf(this.Qq,a.a.C0a):this.Yt.jYb=null;this.wg.hasProperty(this.Qq,f.a.LEa)?this.Yt.Swb=this.wg.getPropertyObjectIds(this.Qq,f.a.LEa):this.Yt.Swb=this.J2(this.ut.length,z.a.nil)}c5d(K,R,E){return this.wg.hasProperty(K,R)?this.wg.getPropertyBools(K,R):this.J2(E,!1)}YQm(K,R,E){return this.wg.hasProperty(K,R)?this.wg.getPropertyUint32s(K,R):this.J2(E,0)}J2(K,R){const E=new w.a;for(let L=0;L<K;L++)E.add(R);return E}uPm(K){const R=this.HLd.tg(K);
K=this.HLd.tg(K+1);return this.S5.substring(R,K)}BCi(){if(this.Goh)return null;var K=this.HG<this.ut.length?this.ut.tg(this.HG):this.maxValue;if(K===this.maxValue||this.ZOk&&!this.S5.length)return this.Goh=!0,K=new v.a(this.Ev,this.Qq.id,this.mdf),this.RLc=this.sif(this.RLc,K.toString()),K;const R=this.ZId.tg(this.HG),E=this.$Se.tg(this.HG),L=this.pGk.tg(this.HG),O=this.NNc.tg(this.HG),V=this.mqa.tg(this.HG),Z=this.xpa.tg(this.HG),W=this.Ypa.tg(this.HG),P=this.Qnh?this.i5b.tg(this.HG):null;var S=
null;this.Yt.Jsb.tg(this.HG)&&(S=new y(this.Yt.Isb.tg(this.HG)||"",this.Yt.Ksb.tg(this.HG)));if(this.K8b&&null!=S){var aa=this.Yt.XWa.length<this.HG?this.Yt.XWa[this.HG]:null;null!=aa&&null!=aa.$ca&&(S.qMa=this.wg.cJf(new Date(aa.$ca)))}aa=null;this.Yt.Kob.tg(this.HG)&&(aa=new y(this.Yt.Job.tg(this.HG)||"",this.Yt.V7a.tg(this.HG)));if(this.K8b&&null!=aa){var Y=this.Yt.ENb.length<this.HG?this.Yt.ENb[this.HG]:null;null!=Y&&null!=Y.$ca&&(aa.qMa=this.wg.cJf(new Date(Y.$ca)))}Y=null;this.Yt.bdb.tg(this.HG)&&
(Y=new y(this.Yt.Rwb.tg(this.HG)||"",this.Yt.Twb.tg(this.HG),this.Yt.Swb.tg(this.HG)));if(this.K8b&&null!=Y){const X=this.Yt.jYb.length<this.HG?this.Yt.jYb[this.HG]:null;null!=X&&null!=X.$ca&&(Y.qMa=this.wg.cJf(new Date(X.$ca)))}S=new G(S,aa,Y);aa=this.uPm(this.HG);this.HG++;Y=aa.startsWith("\ufddfHYPERLINK ");K=new C.a(this.oKe,this.Ev,this.Qq.id,R,K,E,aa,L,!Y,O,V,Z,W,S,P);this.RLc=this.sif(this.RLc,K.toString());return K}gCi(){let K;K=null;var R="";if(!this.rDk)return{a9f:K,Rbb:R};if(R=this.BCi())K=
new w.a,K.add(R);for(;R=this.BCi();)K.add(R);R=this.RLc;return{a9f:K,Rbb:R}}}Object(I.a)(H,"ParagraphMergeBlockCreator",u.a,[])},2019:function(I,J,d){d.r(J);I=d(0);var m=d(221),f=d(1596),a=d(1530);class l extends a.a{constructor(z,x){super(4,z,x)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Bk)}Gjc(){return"Table"}clone(){return new l(this.source,this.Bk)}gC(z,x,u,v=!1){return super.gC(z,x,u,v)?this.Bk.equals(z.Bk):!1}get length(){return 1}}Object(I.a)(l,"TableMergeBlock",
a.a,[]);d.d(J,"TableMergeBlockCreator",function(){return w});class w extends f.a{constructor(z,x){super();this.o$g=new l(x,z.id)}gCi(){let z;z=new m.a;z.add(this.o$g);return{a9f:z,Rbb:this.sif("",this.o$g.toString())}}}Object(I.a)(w,"TableMergeBlockCreator",f.a,[])},2129:function(I,J,d){function m(a){var l=!0,w=[];a.forEach(function(z){var x,u=z.classification;if(u===f.a.AQg.tSg||u===f.a.AQg.ogk){u=(x={},x.name=z.name,x.bool=null,x.string=null,x["double"]=null,x.int64=null,x.date=null,x.contract=
null,x);switch(z.dataType){case f.a.pvd.Boolean:u.bool=z.value;break;case f.a.pvd.Double:u["double"]=z.value;break;case f.a.pvd.Int64:u.int64=z.value;break;case f.a.pvd.String:u.string=z.value;break;default:return}w.push(u)}else l=!1});return l?w:[]}d.d(J,"a",function(){return m});var f=d(2130)},2144:function(I,J,d){d.r(J);var m=d(2),f=d(0),a=d(172),l=d(768);class w extends a.a{constructor(Q,Ca){super(!1,!1,!0);this.YZb=(sb,Xb)=>{1===sb&&(this.kFa.VTf=Xb.tooltipPersistenceEnabled,m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",
!1)&&(sb=Xb.textSelectionChangeEnabled,this.kFa.Qzc!==sb&&this.XQk.raiseEvent(l.a.apj),this.kFa.Qzc=sb))};this.kFa=Q;this.XQk=Ca}start(){const Q={["tooltipPersistenceEnabled"]:this.kFa.VTf};m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(Q.textSelectionChangeEnabled=this.kFa.Qzc);this.gi("",this.YZb,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:Q})}}Object(f.a)(w,"AccessibilitySettingsDialog",a.a,[]);var z=d(87),x=d(12);
class u{constructor(Q,Ca){this.l8o=()=>{(new w(this.kFa,l.a.instance())).start();return 32};this.ga=Q;this.kFa=Ca}Wb(){this.ga.qa(x.a.k8o,z.a.frame,this.l8o)}}Object(f.a)(u,"AccessibilitySettingsDialogActor",null,[1069]);var v=d(334);const F=Q=>{const Ca=new v.a;m.AFrameworkApplication.Ge.Xj(G(Q),1,null,null,!0,2,sb=>{200===sb.data.He?Ca.hg("true"===sb.data.Ee.toLowerCase()):Ca.hg(!1)},()=>{Ca.hg(!1)},null,void 0,void 0,void 0,void 0,"7");return Ca.task},y=(Q,Ca)=>{m.AFrameworkApplication.Ge.Xj(G(Q),
2,Ca.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},G=Q=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",m.AFrameworkApplication.J.appSettings.RoamingServiceHandlerWebServiceBase||"",Q,m.AFrameworkApplication.xm);var C=d(153);class H{constructor(){this.qbc=this.P7b=null}get VTf(){return!!this.P7b}set VTf(Q){Q!==this.P7b&&(this.P7b=Q,C.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),this.Cfe()&&y("saveHoverableRibbonTooltipIsEnabled",
Q))}get Qzc(){return!!this.qbc}set Qzc(Q){Q!==this.qbc&&(this.qbc=Q,this.Cfe()&&y("saveTextSelectionHighlightChangeIsEnabled",Q))}cDn(){const Q=new v.a;if(this.P7b)Q.hg(this.P7b);else if(this.Cfe()){const Ca=F("getHoverableRibbonTooltipIsEnabled");Ca.continueWith(()=>{this.P7b=Ca.result;C.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Ca.result);Q.hg(Ca.result)},8)}else Q.hg(!1)}HDn(){const Q=new v.a;if(this.qbc)Q.hg(this.qbc);else if(this.Cfe()){const Ca=F("getTextSelectionHighlightChangeIsEnabled");
Ca.continueWith(()=>{this.qbc=Ca.result;Q.hg(Ca.result)},8)}else Q.hg(!1)}Cfe(){const Q=m.AFrameworkApplication.J.$("IsRoamingServiceEnabled"),Ca=m.AFrameworkApplication.J.$("IsAnonymousUser");return Q&&!Ca}}Object(f.a)(H,"AccessibilitySettingsInfo",null,[1068]);var K=d(179),R=d(24);class E{constructor(){this.Z=null}get name(){return"Common.App.AccessibilitySettings"}uc(Q){this.Z=Q;this.Z.register(H,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as(498).Sd(()=>new H).ha();this.Z.register(u,
"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as(1534).Sd(()=>new u(m.AFrameworkApplication.va,this.Z.Oa(498))).ha()}init(){const Q=this.Z.Oa(498),Ca=this.Z.Oa(1534);Q&&Ca?(Ca.Wb(),Q.cDn(),Q.HDn(),R.b(508827098,200,50,"Text Selection Highlight Change Setting value on boot: {0}",Q.Qzc)):R.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){K.a.instance.Mc(new E)}}
Object(f.a)(E,"AccessibilitySettingsPackage",null,[0,1]);var L=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},O=d(108),V=d(86);class Z extends Sys.EventArgs{constructor(Q,Ca){super();this.UCe=Q;this.actualValue=Ca}}Object(f.a)(Z,
"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);class W{constructor(){this.M5b=[];this.cdh=this.xOe=0;this.oj=null;this.sa=new V.a;this.kEl=(Q,Ca)=>{R.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.xYd(Ca.UCe,Ca.actualValue))}}init(Q,Ca,sb){this.oj=Q;this.xOe=Ca;this.cdh=sb;this.oj.ngf(Object(O.a)(this,this.mme,"onCpuMeterFrameAvailable"));this.T1k(this.kEl)}mme(Q,Ca){Ca.Xgj&&(Array.enqueue(this.M5b,Ca.Xgj.CP),this.M5b.length>this.cdh&&(Array.dequeue(this.M5b),
this.Epl()))}Epl(){var Q=this.M5b.length;let Ca=0;for(let sb=0;sb<Q;sb++){const Xb=Array.dequeue(this.M5b);Ca+=Xb;Array.enqueue(this.M5b,Xb)}Q=Ca/Q;Q>this.xOe&&this.sa.raiseEvent("CPTTE",new Z(this.xOe,Q))}T1k(Q){this.sa.addHandler("CPTTE",Q)}xYd(Q,Ca){const sb={};sb.ThresholdValue=Q;sb.ActualValue=Ca;return sb}}Object(f.a)(W,"CpuMeterMonitor",null,[1074]);class P{constructor(){this.S=this.T=this.M=this.C=0}}Object(f.a)(P,"ProfileInformation",null,[]);var S=d(10),aa=d(34),Y=d(236),X=d(80);class ca{constructor(Q=
0,Ca=0){this.AEb=!1;this.$Db={};this.GGd=Q;this.ZGd=Ca;this.Nbf=0;aa.a.addHandler(window.self,S.a.fRh,()=>{this.AEb=!0});aa.a.addHandler(window.self,S.a.gRh,()=>{this.AEb=!1})}iRh(Q,Ca,sb){const Xb=ca.generateKey(Ca,sb);Xb in this.$Db?Ca=this.$Db[Xb]:(Ca=new P,Ca.S=sb?1:0,this.$Db[Xb]=Ca,this.Nbf++);Ca.C++;Ca.M=Q>Ca.M?Q:Ca.M;Ca.T+=Q}aIa(Q,Ca){this.iRh(Q,Ca,!1);this.AEb&&this.iRh(Q,Ca,!0)}getData(){if(0<this.ZGd&&this.Nbf>this.ZGd)return this.xpm();const Q=0<this.GGd,Ca={},sb=this.$Db;for(const Cc in sb){var Xb=
Cc;const jd=sb[Cc];this.TIj(jd);Q&&jd.T>=this.GGd&&(Ca[Xb]=jd)}return Q?X.a.Uf(Ca)?null:Ca:this.$Db}xpm(){var Q=0<this.GGd,Ca=[];const sb=this.$Db;for(const Xb in sb){const Cc={key:Xb,value:sb[Xb]},jd=Cc.value;(!Q||jd.T>=this.GGd)&&Array.add(Ca,Cc)}if(Ca.length>this.ZGd)Ca.sort((Xb,Cc)=>Cc.value.T-Xb.value.T),Ca=Ca.slice(0,this.ZGd);else if(!Ca.length)return null;Q={};for(const Xb of Ca)Ca=Xb.value,this.TIj(Ca),Q[Xb.key]=Ca;return Q}TIj(Q){Q.M=Y.a.bQ(Q.M,0);Q.T=Y.a.bQ(Q.T,0)}reset(){this.$Db={};this.Nbf=
0}static generateKey(Q,Ca){return Ca?Q+" [it]":Q}}Object(f.a)(ca,"FunctionCallAggregator",null,[1070]);var fa=d(893);class ja{}Object(f.a)(ja,"CpuMeterFrame",null,[]);class ra extends Sys.EventArgs{constructor(Q){super();this.Xgj=Q}}Object(f.a)(ra,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class ya{}Object(f.a)(ya,"MiniTaskItemInfo",null,[]);class Ha{}Object(f.a)(Ha,"TaskItemInfo",null,[]);var Wa=d(1033),Ma=d(1286),ua=d(190);class Ka{constructor(Q,Ca,sb,Xb,Cc){this.HIb=0;this.U1=null;this.KLd=
this.nGh=0;this.dya=!1;this.e7b=0;this.bKc=!1;this.Nxa=null;this.YDd=0;this.j2e=new V.a;this.jOd=[];this.uB=Q;this.g0e=Ca;this.fTe=sb;this.juh=Xb;m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.cqc();this.Nvk=Cc;this.gTe=new ca(100);this.ZEk=Wa.a.jH(1,5,new Ma.a)}ngf(Q){this.j2e.addHandler("OnCpuMeterFrameAvailable",Q)}lEj(Q){this.j2e.removeHandler("OnCpuMeterFrameAvailable",Q)}Uwb(Q,Ca,sb,Xb=null){sb=Xb?Xb.priority:7;const Cc=this.uB();this.start(Ca,
sb);try{Q()}finally{this.stop(Ca,Xb),Q=this.uB()-Cc,this.juh.track(Q,Ca)}}ee(Q,Ca){const sb=this.uB();try{Q()}finally{Q=this.uB()-sb,this.fTe.aIa(Q,Ca),0<this.HIb&&this.gTe.aIa(Q,Ca),this.juh.track(Q,Ca)}}whg(Q){const Ca=new Ha;Ca.TN=Q.m7f;Ca.TP=Q.priority;this.Hyj(1,Ca)}zrc(Q){this.YDd|=Q}start(Q,Ca){if(!this.HIb){this.gTe.reset();const sb=this.g4i(Q);sb&&this.nje(1);this.U1=new Ha;this.U1.TN=Q;this.U1.TP=Ca;this.U1.ST=(new Date).toISOString();this.U1.STS=Y.a.bQ(this.uB(),2);sb?this.U1.UI=1:this.hpn(Q)?
this.U1.UI=2:this.U1.UI=0}this.HIb++}nje(Q){this.e7b|=Q}PVd(Q=!0,Ca=0){this.e7b=Q?0:this.e7b&~Ca}stop(Q,Ca=null){let sb;this.HIb--;0>=this.HIb&&this.U1&&(sb=this.uB()-this.U1.STS,this.KLd+=sb,this.g0e.aIa(sb,Q),this.g4i(Q)&&this.PVd(!1,1),this.U1.TRT=Y.a.bQ(sb,2),Ca&&(this.U1.TQT=Y.a.bQ(Ca.$no,2),this.U1.TDT=Y.a.bQ(Ca.F5i,2)),this.Nvk&&(this.Hyj(0,this.U1),this.RGo()),this.HIb=0);0<=Q.indexOf(fa.a.ztp)&&this.zrc(2);0<=Q.indexOf(fa.a.xFj)&&this.zrc(4);1===(this.e7b&1)&&this.zrc(1);2===(this.e7b&2)&&
this.zrc(8)}RGo(){var Q=this.U1.TRT;if(750<Q){let sb=this.gTe.getData();if(sb){const Xb={};for(const Cc in sb){var Ca=sb[Cc];const jd=Cc;jd.startsWith("SiOp_")||jd.endsWith("[it]")||(Xb[jd]=Math.round(100*Ca.T/Q))}sb=Xb}Q=Object.assign(new ya,{B:this.U1.STS,T:Q,S:sb});this.ZEk.track(Q,this.U1.TN)}}mcp(){var Q=this.uB()-this.nGh,Ca=Y.a.bQ(this.KLd/Q*100,2);Q=new ja;Q.CP=Ca;Q.II=this.YDd;Ca=this.g0e.getData();X.a.count(Ca)&&(Q.LRT=Ca);Ca=this.fTe.getData();X.a.count(Ca)&&(Q.FP=Ca);this.j2e.raiseEvent("OnCpuMeterFrameAvailable",
new ra(Q));this.XXj()}XXj(){this.g0e.reset();this.fTe.reset();this.KLd=this.HIb=0;this.nGh=this.uB();this.YDd=0;this.U1=null}run(){this.dya?this.mcp():(this.XXj(),this.dya=!0);this.Nxa?this.Nxa(Object(O.a)(this,this.run,"run"),1E3):window.setTimeout(Object(O.a)(this,this.run,"run"),1E3)}ZQd(Q,Ca,sb){const Xb=Array(2);Xb[0]=Ca;Xb[1]=sb;this.jOd[Q]||(this.jOd[Q]=[]);this.jOd[Q].push(Xb)}Hyj(Q,Ca){Q=this.jOd[Q];if(!ua.a.Uf(Q))for(let Xb=0;Xb<Q.length;Xb++){var sb=Q[Xb];const Cc=sb[0];sb=sb[1];Cc&&!Cc(Ca)||
sb(Ca)}}cqc(){if(!this.bKc){const Q=window.setTimeout;this.Nxa=(Ca,sb)=>Q(Ca,sb);this.bKc=!0}}g4i(Q){return Q.startsWith("key")||Q.startsWith("input")}hpn(Q){return Q.startsWith("click")||Q.startsWith("mouse")||Q.startsWith("pointer")}}Object(f.a)(Ka,"CpuMeter",null,[98]);class za{constructor(Q){this.HFc=null;this.Sq=new v.a;this.uB=Q}initialize(Q,Ca,sb,Xb=!1){this.HFc||(this.HFc=new Ka(this.uB,Q,Ca,sb,Xb),this.Sq.hg(this.HFc));return this.HFc}}Object(f.a)(za,"CpuMeterProvider",null,[1072]);var Fa=
d(156);class ea{constructor(Q=1){this.sF=[];this.Nzd=[];this.Qk=Q}f$l(){let Q=0;for(let Ca=0;Ca<this.sF.length;Ca++)this.sF[Ca]<this.sF[Q]&&(Q=Ca);return Q}aIa(Q,Ca){Q=Y.a.bQ(Q,2);if(this.sF.length<this.Qk)Array.add(this.sF,Q),Array.add(this.Nzd,Ca);else{var sb=this.f$l();Q>this.sF[sb]&&(this.sF[sb]=Q,this.Nzd[sb]=Ca)}}getData(){return this.sF.length?{["Vals"]:this.sF,["Desc"]:this.Nzd}:null}reset(){this.sF=[];this.Nzd=[]}}Object(f.a)(ea,"MaxDataAggregator",null,[1070]);var la=d(39),Na=d(19);class Aa{get name(){return"Common.App.CpuMeter"}uc(Q){Q.register(za,
1535).as(100).ha().Sd(()=>new za(la.a.Le));Q.register(W,"Common.App.CpuMeter.CpuMeterMonitor").as(1536).ha().Sd(()=>new W)}init(){const Q=m.AFrameworkApplication.J;if(Q.$("CpuMeterIsEnabled")){const Ca=Na.a.instance.resolve(1535);Fa.a.instance.hif.continueWith(()=>{Aa.f9m(Q,Ca)})}}dispose(){}static f9m(Q,Ca){const sb=Wa.a.jH(10,5,new ca(Q.fc("TaskManagerLoggingThreshold",0),Q.fc("CpuMeterMaximumEntriesToLog",0)));Ca=Ca.initialize(new ea(5),new ca,sb,Q.$("CPUMeterExposeTaskDetailsIsEnabled"));Q.$("WordEditorInteractivePerfDisableCpuMeterFrames")||
(Ca.run(),Q.$("CpuMeterMonitorIsEnabled")&&Na.a.instance.resolve(1536).init(Ca,Q.YJ("CpuMeterAverageCpuPercentThreshold",80),Q.fc("CpuMeterRollingAverageFramesCount",15)));R.b(16827671,306,50,"Initializing CpuMeter")}static main(){K.a.instance.Mc(new Aa)}}Object(f.a)(Aa,"CpuMeterPackage",null,[0,1]);var wa=d(8),va=d(85),Pa=d(1056),Ta=d(1043),kb=d(17),gb=d(1287);class tb{constructor(){this.Sxa=this.EDc=null;this.JJb=!0;this.lKc=!1}uc(Q){m.AFrameworkApplication.J.$("EventTimingMeterIsEnabled")&&Q.register(1022,
209).ha().Sd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var Q=new Ta.a(m.AFrameworkApplication.J.fc("EventTimingMeterEventSamplingPercent",0)/100);Q=new Pa.a(Object(O.a)(Q,Q.D0b,"shouldBeInSample"));const Ca=Wa.a.jH(16,1,Q);this.Sxa=new gb.a("TypingDuration-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.YJ("AshaVetoForTypingThresholdInMS",150),m.AFrameworkApplication.J.YJ("AshaVetoForTypingThresholdPercentile",95),this.JJb);(this.lKc=
!kb.a.Rab)&&m.AFrameworkApplication.JH(()=>{this.Jof()});this.EDc=sb=>{sb=sb.rawEvent.detail;for(const Xb of sb)Ca.track(Xb,"EventTimingData"),"false"!==Xb.metadata.altPressed.toString()||"false"!==Xb.metadata.ctrlPressed.toString()||"false"!==Xb.metadata.repeat.toString()||"CharacterKey"!==Xb.metadata.key.toString()&&"Space"!==Xb.metadata.key.toString()||!this.lKc||this.Sxa.yDa(Xb.timeToRequestAnimationFrameMs)};aa.a.addHandler(window.self,S.a.eRh,this.EDc)}dispose(){this.EDc&&(aa.a.removeHandler(window.self,
S.a.eRh,this.EDc),this.EDc=null)}Jof(){this.Sxa.OZa();this.Sxa.Gqj&&(wa.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),va.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){K.a.instance.Mc(new tb)}}Object(f.a)(tb,"EventTimingMeterPackage",null,[0,1]);var hb=d(72),Xa=d(82),$a=d(28);class La{constructor(Q,Ca,sb,Xb=null,Cc=null){this.PQb=jd=>{let dd=!1,oe=null;try{if(0<jd.data.Ee.length){const Me=
Object(Xa.a)(Object,$a.a(jd.data.Ee)),zf=Me?Me[this.yO.jif]:null;zf&&(oe=Object(Xa.a)(Object,$a.a(zf.toString())))}dd=!0}catch(Me){this.X9a(null)}dd&&this.yIc&&this.yIc(jd.data,oe)};this.X9a=jd=>{this.sIc&&this.sIc(jd?jd.data:null)};this.Xfo=jd=>{this.Yzh&&this.Yzh(jd?jd.data:null)};this.Ycb=jd=>{this.aOc&&this.aOc(jd?jd.data:null)};this.yO=Q;this.yIc=Ca;this.sIc=sb;this.Yzh=Xb;this.aOc=Cc}hCf(Q){const Ca=new Sys.StringBuilder(this.yO.lmd);Ca.append("RoamingServiceHandler.ashx?action=");Ca.append("getFirstRunExperienceSettings");
Ca.append("&");Ca.append(this.iNf(Q));Ca.append("&");Ca.append(m.AFrameworkApplication.xm);m.AFrameworkApplication.Ge.Xj(Ca.toString(),1,null,null,!0,2,this.PQb,this.X9a,null)}b2d(Q){var Ca=new Sys.StringBuilder(this.yO.lmd);Ca.append("RoamingServiceHandler.ashx?action=");Ca.append("saveFirstRunExperienceSettings");Ca.append("&");Ca.append(m.AFrameworkApplication.xm);Ca=Ca.toString();Q=$a.c(Q);m.AFrameworkApplication.Ge.Xj(Ca,2,Q,null,!0,4,this.Xfo,this.Ycb,null)}iNf(Q){const Ca=new Sys.StringBuilder("requestedsettings=");
for(let sb=0;sb<Q.count;sb++)Ca.append(Q.K(sb)),sb<Q.count-1&&Ca.append(";");return Ca.toString()}}Object(f.a)(La,"FirstRunExperienceRequestHandler",null,[]);var bb=d(250);class Gb{constructor(){this.aIc=this.BBd=this.yO=null;this.PQb=(Q,Ca)=>{Q=Q?+Q.bP-+Q.rH:-1;Q>this.yO.EIj?wa.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Q,this.yO.EIj):Ca?this.i8o(Ca)?(wa.ULS.sendTraceTag(51675536,
306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.yO.Dej),this.vDg()):(this.kyf(!1),wa.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(wa.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.vDg())};this.X9a=Q=>{this.kyf(!1);wa.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",
Q?Q.He:-1)};this.Ycb=Q=>{wa.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Q?Q.He:-1)};this.B_n=Q=>{if(Q){var Ca=Q.detail;Q=Q.type;var sb=this.yO&&this.yO.m_h?this.yO.m_h.split("-")[0]:null;if("FRELaunchedEvent"===Q||sb&&Ca&&Ca.id&&-1!==Ca.id.indexOf(sb)){if("FRELaunchedEvent"===Q||Ca&&Ca.success)wa.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.LJj(this.yO.currentVersion);
window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.aIc,!0),window.removeEventListener("FRELaunchedEvent",this.aIc,!0))}}}}s9o(Q){Q?(this.yO=Q,this.bpn()&&(wa.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Q=new hb.a,Q.add(this.yO.jif),this.BBd=new La(this.yO,this.PQb,this.X9a,null,this.Ycb),this.BBd.hCf(Q)),(this.yO.u3i||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",
!1))&&this.vDg()):wa.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}bpn(){try{if(this.yO.u3i)return!0;if(!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||m.AFrameworkApplication.J.$("IsAnonymousUser"))return!1;if(this.yO.wjn||this.yO.Fpc||m.AFrameworkApplication.J.$("IsO365ConsumerHost"))return!0;const Q=m.AFrameworkApplication.J.jb("FlightId");return-1!==(Q?Q.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Q){wa.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",Q?Q.toString():null)}return!1}LJj(Q){const Ca={},sb={};sb.FREDisplayedDate=(new Date).toUTCString();sb.VersionDisplayed=Q;sb.RemindMeLater=!1;Ca[this.yO.jif]=$a.c(sb);wa.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.BBd&&this.BBd.b2d(Ca)}vDg(){this.kyf(!0);var Q=Na.a.instance.Oa(2);Q?this.KUj(Q):(wa.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((Q=Na.a.instance.Ra(2))?Q.execute(Ca=>{this.KUj(Ca)}):wa.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}KUj(Q){if(Q){var Ca=this.yO.Kbm;Ca&&m.AFrameworkApplication.tga(Ca);wa.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ca);Q.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.aIc=this.B_n,window.addEventListener("FGWebSurfaceEvent",this.aIc,!0),window.addEventListener("FRELaunchedEvent",
this.aIc,!0)):(wa.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.LJj(this.yO.currentVersion))}else wa.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}i8o(Q){if("RemindMeLater"in Q&&"FREDisplayedDate"in Q){if("true"===Q.RemindMeLater.toString()&&(+new Date-+new Date(Q.FREDisplayedDate.toString()))/36E5>this.yO.Dej)return!0}else if(m.AFrameworkApplication.J.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in Q&&Q.VersionDisplayed<
this.yO.currentVersion)return wa.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}kyf(Q){m.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&bb.a.dispatch("FREDecisionEvent",{["show"]:Q})}}Object(f.a)(Gb,"FirstRunExperienceLauncher",null,[1021]);class qb{constructor(){this.Z=null}get name(){return"Common.App.FirstRunExperienceLauncher"}uc(Q){this.Z=Q;this.Z.register(1021,
1590).ha().Sd(()=>new Gb)}init(){}dispose(){}static main(){K.a.instance.Mc(new qb)}}Object(f.a)(qb,"FirstRunExperienceLauncherPackage",null,[0,1]);class Sa{constructor(){this.y=this.x=0}}Object(f.a)(Sa,"HammerPoint",null,[]);class cb{constructor(Q,Ca,sb,Xb,Cc){this.nsh=this.b3a=this.LDd=1;this.qPd=this.CRc=this.G5a=0;this.z1e=this.mQa=null;this.CBb=this.wSe=this.jKd=!1;this.Wj=Q;this.TSa=Ca;this.dlb=sb;this.ga=Xb;Cc&&(this.jKd=Cc.$("PromoteLayerPinchToZoomIsEnabled"),this.wSe=Cc.$("FinalizeWithInitialPinchScaleIsEnabled"),
this.CBb=Cc.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get uK(){return this.TSa}get lxg(){return this.dlb}jmn(){return!!this.Wj.instance}Y_n(Q){this.ga&&this.ga.Ob(x.a.lYj,2);const Ca=this.Wj.instance;this.jKd&&Ca.Ayj();this.b3a=Ca.Cj;this.LDd=Q.Q1c.scale;this.nsh=1;this.z1e=this.PZh();this.mQa=this.TSa.getBounds();if(!this.mQa)return wa.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;Q=this.FEi(Q);this.CBb?this.xPj(this.TSa.scrollWidth,this.mQa.width,Q,this.b3a,Ca):this.G5a=this.TSa.scrollWidth>
this.mQa.width?this.RUc(this.dlb.scrollLeft,Q.x,this.b3a):null;this.qPd=this.TSa.scrollHeight>this.mQa.height?this.RUc(this.dlb.scrollTop,Q.y,this.b3a):null;return!0}Yug(){this.G5a=null;this.CRc=0}xPj(Q,Ca,sb,Xb,Cc){Q>Ca?this.G5a?(Q=Cc.g4f,Q!==this.CRc&&(this.G5a-=this.CRc-Q,this.CRc=Q)):(this.G5a=this.RUc(this.dlb.scrollLeft,sb.x,Xb),this.CRc=Cc.g4f):this.Yug()}X_n(Q){const Ca=this.FEi(Q);if(!Ca)return wa.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;Q=this.ZVo(Q.Q1c.scale/
this.LDd)*this.b3a;this.dCp(Ca,Q);this.eCp(Ca,Q);return!0}dCp(Q,Ca){const sb=this.TSa.scrollWidth,Xb=this.mQa.width;this.CBb?this.xPj(sb,Xb,Q,Ca,this.Wj.instance):!this.G5a&&sb>Xb&&(this.G5a=this.RUc(this.dlb.scrollLeft,Q.x,Ca));if(Q=this.YZh(Q.x,this.G5a,sb,Xb,Ca))this.dlb.scrollLeft=Q}eCp(Q,Ca){const sb=this.TSa.scrollHeight,Xb=this.mQa.height;!this.qPd&&sb>Xb&&(this.qPd=this.RUc(this.dlb.scrollTop,Q.y,Ca));if(Q=this.YZh(Q.y,this.qPd,sb,Xb,Ca))this.dlb.scrollTop=Q}YZh(Q,Ca,sb,Xb,Cc){return sb<=
Xb||!Ca||!Xb?null:Math.max(0,Math.min(Ca*Cc-Q,sb-Xb))}RUc(Q,Ca,sb){return(Q+Ca)/sb}W_n(Q){Q=Q.Q1c.scale;this.wSe&&(Q/=this.LDd);this.boi(Q);this.jKd&&this.Wj.instance.Wpg();this.ga&&this.ga.Ob(x.a.NAf,2);this.CBb&&this.Yug()}V_n(Q){Q=Q.Q1c.scale;this.wSe&&(Q/=this.LDd);this.boi(Q,!0);this.jKd&&this.Wj.instance.Wpg();this.ga&&this.ga.Ob(x.a.NAf,2);this.CBb&&this.Yug()}ZVo(Q){const Ca=this.Wj.instance,sb=new Date>=this.z1e;sb&&(this.z1e=this.PZh());Math.abs(Q-this.nsh)>=.01*Q&&Ca.Y1o(Q*this.b3a,sb);
return Ca.Cj/this.b3a}boi(Q,Ca=!1){Q*=this.b3a;this.Wj.instance.pBg(Q,!1);const sb={};sb.initialScale=this.b3a;sb.finalScale=Q;sb.cancelled=Ca;wa.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",sb)}FEi(Q){return(Q=Q.Q1c.center)&&this.mQa?Object.assign(new Sa,{x:Q.x-this.mQa.x,y:Q.y-this.mQa.y}):null}PZh(){const Q=(new Date).getTime();return new Date(Q+1E3)}}Object(f.a)(cb,"PinchZoomAdapter",null,[1099]);class pb{constructor(Q){this._element=Q}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}
Object(f.a)(pb,"ScrollContainerElement",null,[1097]);var vb=d(124);class xb{constructor(Q,Ca,sb,Xb,Cc,jd){this.f$e=this.Jib=null;this.Z=Q;this.Zd=Ca;this.VEd=sb;this.aqh=Xb;this.CCk=Cc;this.H7b=jd;this.xyd=new hb.a}register(Q,Ca){this.VEd&&(4===m.AFrameworkApplication.ta.Hb.Uk&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?vb.a.get_instance().$k(8,()=>{this.hHj(Q,Ca)}):this.hHj(Q,Ca))}hHj(Q,Ca){this.Z.Ra(91).execute(sb=>{this.bfp();this.Jib=
sb;this.xyd.add(Q);if(this.aqh){if(this.CCk&&0!==sb.kvm()){this.SYj();return}var Xb=this.Z.Ra(6);this.Z.resolve(71);const Cc=new pb(Q);Xb=new cb(Xb,Cc,Ca,m.AFrameworkApplication.va,m.AFrameworkApplication.J);sb.vwo(Q,Xb)}this.SYj()})}unregister(){if(this.Jib&&this.xyd){if(this.aqh){for(const Q of this.xyd)this.Jib.ivp(Q);this.xyd.clear()}this.Jib=null}}bfp(){this.H7b&&(this.Zd?this.f$e=this.Zd.Xf("Task","Register"):wa.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}SYj(){this.H7b&&
(this.f$e?this.f$e.stop():wa.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(f.a)(xb,"GestureInputRegistrar",null,[1020]);class Bb{constructor(){this.Z=null;this.vi=!1}get name(){return"Common.App.GestureInput"}init(){this.vi||(this.Z.resolve(127),this.vi=!0)}dispose(){}uc(Q){this.Z=Q;Q.register(1020,127).ha().Sd(()=>new xb(Q,m.AFrameworkApplication.ta.$r,m.AFrameworkApplication.e$c(),m.AFrameworkApplication.S0i(),!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("PinchZoomOnlyPointerEventsIsEnabled"),
!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("HammerJsPerformanceTimersIsEnabled")))}static main(){K.a.instance.Mc(new Bb)}}Object(f.a)(Bb,"GestureInputPackage",null,[0,1]);var jc=d(417),xc=d(94);class Qc{constructor(){this.cxb=this.Gsi=null}}Object(f.a)(Qc,"GestureAdapterInfo",null,[]);var fd=d(595),Ac=d(299);class Nb{constructor(){this.$Cb=null}J5f(){if(!this.$Cb){var Q="hammer.min.js";m.AFrameworkApplication.J.my("IsServerFlavorDebug")&&(Q=m.AFrameworkApplication.J.$("IsServerFlavorDebug")?
"hammer.js":"hammer.min.js");Q=m.AFrameworkApplication.rC(String.format("{0}",Q),5);Q=Ac.a.create(Q,null,null);fd.a.y_(Q);this.$Cb=Q.wbb}return this.$Cb}static get instance(){Nb._instance||(Nb._instance=new Nb);return Nb._instance}}Nb._instance=null;Object(f.a)(Nb,"HammerJsDependencyLoader",null,[1109]);const ib=(Q,Ca,sb=null)=>{if(void 0===Ca||null===Ca)throw wa.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Xb=null;switch(Q){case S.a.fqe:Xb=
new Hammer.Pinch(sb);break;case S.a.pan:Xb=new Hammer.Pan(sb)}Xb&&(Xb.manager=Ca);return Xb};var Rb;(function(Q){Q[Q.none=-1]="none";Q[Q.fqe=0]="pinch";Q[Q.pan=1]="pan";Q[Q.UGg=2]="swipe"})(Rb||(Rb={}));Object(f.b)("GestureEvent",Rb);var ic=d(71);class kc extends ic.a{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe){super(Q,sb,Xb,jd);this.YEc=Ca;this.g5a=dd;this.Pwa=oe;this.pxk=Cc}get shiftKey(){return this.g5a}get ctrlKey(){return this.Pwa}get clientPoint(){return this.YEc}get Q1c(){return this.pxk}static create(Q,
Ca,sb,Xb,Cc,jd){if(sb.rawEvent)if(jd){var dd=sb.rawEvent;dd=new Sys.UI.Point(dd.clientX,dd.clientY)}else dd=ic.a.p5d(sb);else dd=new Sys.UI.Point(sb.clientX,sb.clientY);return new kc(Q,dd,Ca,sb,Xb,Cc,sb.shiftKey,sb.ctrlKey,jd)}}Object(f.a)(kc,"GestureEventArgs",ic.a,[]);class Jb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(f.a)(Jb,"GestureManagerData",null,[]);class ec{}ec.Djk=2;ec.Ejk=4;ec.Fjk=8;ec.Gjk=8;Object(f.a)(ec,"HammerConstants",null,[]);var qa=d(107),sa=d(125),ab=d(16),eb=d(109);class fb extends aa.a{constructor(Q,Ca){super();this.CRa=jc.a.Qgm;this.v4e=!!window.PointerEvent;this.BIh=window.hasOwnProperty("ontouchstart");this.dEb=this.UMc=null;this.pRa=
!1;this.Xpa=new xc.a;this.YNc=new xc.a;this.ujh=new hb.a;this.Phb=null;this.$4b=this.H7b=this.Sah=this.HMe=this.Y_e=this.kCh=this.jbh=this.JRc=!1;this.MLc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.g$e=null;this.jwb=(sb,Xb,Cc)=>{sb=this.sAi(sb);Xb=this.Nxm(Cc);Hammer.inputHandler(this,sb,Xb);this.pRa&&Cc.preventDefault();return this.pRa};this.Ane=(sb,Xb,Cc)=>{var jd=Cc.rawEvent.pointerType.toString();const dd=Cc.rawEvent.pointerId.toString();if("touch"!==jd)return!1;sb=this.sAi(sb);
if(1!==sb&&!this.Xpa.mb(dd))return!1;this.jbh&&1===sb&&Cc.rawEvent.isPrimary&&this.Xpa.count&&(wa.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.KUd());this.JRc?this.hZk(dd,Xb,Cc):this.Xpa.W(dd,Cc);this.Y_e&&2===sb&&(!this.HMe||this.HMe&&"function"===typeof Cc.rawEvent.getCoalescedEvents)&&(Xb=Cc.rawEvent.getCoalescedEvents())&&this.bNi()&&(this.MLc=Math.max(this.MLc,Xb.length));this.kCh&&(this.pRa=!1);jd=this.Mxm(this.Xpa,Cc,jd);Hammer.inputHandler(this,sb,jd);if(4===sb||
8===sb)this.JRc?this.rDj(dd):this.Xpa.remove(dd),this.Xpa.count||(this.session=null,this.Y_e&&-1!==this.MLc&&(wa.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.MLc),this.MLc=-1));this.pRa&&Cc.preventDefault();return this.pRa};this.jne=()=>!1;this.Gg=qa.EventHandlerManager.instance;this.v4e?(wa.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.UMc=this.Ane,this.dEb=S.a.Sgm):this.BIh?(wa.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.UMc=this.jwb,
this.dEb=S.a.rAc):(wa.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.UMc=this.jne,this.dEb=S.a.Rgm);this.Zd=Ca;this.z5=Q;m.AFrameworkApplication.J&&(this.JRc=m.AFrameworkApplication.J.$("UsePointerCaptureIsEnabled"),this.jbh=m.AFrameworkApplication.J.$("ClearCacheOnPrimaryPointerIsEnabled"),this.kCh=m.AFrameworkApplication.J.$("ResetHandledBeforeInputHandlerIsEnabled"),this.Y_e=m.AFrameworkApplication.J.$("LogCoalescedEventsIsEnabled"),this.HMe=m.AFrameworkApplication.J.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),
this.Sah=m.AFrameworkApplication.J.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.H7b=m.AFrameworkApplication.J.$("HammerJsPerformanceTimersIsEnabled"),this.$4b=this.JRc&&m.AFrameworkApplication.J.$("CancelDragFromGestureInputManagerIsEnabled")&&m.AFrameworkApplication.J.$("UseGestureInputManagerPointerCacheIsEnabled"))}kvm(){return this.v4e?0:this.BIh?1:2}rw(Q){super.rw(Q);this.Gg.kLa(this.dEb,Q,0,this.UMc)}mw(Q){super.mw(Q);this.Gg.T7a(Q,this.dEb)}vwo(Q,Ca){m.AFrameworkApplication.e$c()?Nb.instance.J5f().continueWith(sb=>
{this.afp();if(sb.ij||sb.yp)wa.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",sb.status);else{wa.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",sb.status);if(this.Sah){sb=window.Hammer;if("undefined"===typeof sb){wa.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.bBe();return}if("undefined"===typeof sb.inputHandler){wa.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.bBe();return}}if(!Q)throw this.bBe(),Error.argumentNull("source element can not be null");
sb=sa.a.Eb(Q,this.CRa);if(void 0===sb||null===sb)sb=new xc.a,sa.a.Im(Q,this.CRa,sb),this.wwo(Q);if(!sb.mb(Rb[0])){var Xb=Object.assign(new Qc,{cxb:ib(Rb[0],this,null),Gsi:Ca});sb.add(Rb[0],Xb)}}this.bBe()}):wa.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}afp(){this.H7b&&(this.Zd?this.g$e=this.Zd.Xf("Task","RegisterGestureAdapterAfterLoad"):wa.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}bBe(){this.H7b&&(this.g$e?this.g$e.stop():
wa.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}ivp(Q){wa.ULS.sendTraceTag(42256223,310,Q?100:10,"source element {0} ",Q.id);const Ca=sa.a.Eb(Q,this.CRa);void 0!==Ca&&null!==Ca&&(Ca.remove(Rb[0]),Ca.count||(sa.a.sV(Q,this.CRa),this.curRecognizer=null,this.jvp(Q)))}wwo(Q){this.ujh.add(Q);this.Gg.kLa(this.dEb,Q,0,this.UMc)}jvp(Q){this.ujh.remove(Q);this.Gg.T7a(Q,this.dEb)}recognize(Q){var Ca=Array(Q.pointers.length);for(var sb=0;sb<Q.pointers.length;sb++)Ca[sb]=
Q.pointers[sb].target;sb=null;for(this.Phb=this.zAm(Ca);void 0!==this.Phb&&null!==this.Phb&&(sb=sa.a.Eb(this.Phb,this.CRa),void 0===sb||null===sb);this.Phb=this.Phb.parentNode);if(void 0!==sb&&null!==sb){this.curRecognizer&&this.curRecognizer.state===ec.Gjk&&(this.curRecognizer=null);Ca=sb.keys;for(const Xb of Ca){Ca=sb.K(Xb);void 0!==Ca&&null!==Ca&&void 0!==Ca.cxb&&null!==Ca.cxb&&(void 0===this.curRecognizer||null===this.curRecognizer||Ca.cxb===this.curRecognizer||Ca.cxb.canRecognizeWith(this.curRecognizer))&&
Ca.cxb.recognize(Q);const Cc=Ca.cxb.state;this.curRecognizer||ec.Djk!==Cc&&ec.Ejk!==Cc&&ec.Fjk!==Cc||(this.curRecognizer=Ca.cxb)}}}emit(Q,Ca){if("hammer.input"!==Q){this.pRa=!1;Ca=kc.create(Q,this.Phb,Ca.srcEvent,Ca,3,this.v4e);var sb=sa.a.Eb(this.Phb,this.CRa);if(this.frn(Q))var Xb=0;else if(this.Eqn(Q))Xb=1;else if(this.Pun(Q))Xb=2;else{wa.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:sb}=sb.Ec(Rb[Xb]));void 0!==sb&&null!==sb&&((sb=sb.Gsi,sb.jmn())?
Q.endsWith("start")?this.pRa=sb.Y_n(Ca):Q.endsWith("end")?(sb.W_n(Ca),this.pRa=!0):Q.endsWith("cancel")?(sb.V_n(Ca),this.pRa=!0):Q.endsWith("move")&&(this.pRa=sb.X_n(Ca)):wa.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(Xa.a)(Hammer.Recognizer,Q)}zAm(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];var Ca=Q[0],sb=!0;for(let Xb=1;Xb<Q.length;Xb++){if(!Q[Xb])return null;if(Ca!==Q[Xb]){sb=!1;break}}if(sb)return Ca;Ca=this.kti(Q[0]);sb=
0;for(const Xb of Q){Q=this.kti(Xb);if(Ca.K(Ca.count-1)!==Q.K(Q.count-1))return null;for(let Cc=Ca.count-2,jd=Q.count-2;Cc>=sb&&0<=jd;Cc--,jd--)if(Ca.K(Cc)!==Q.K(jd)){sb=Cc+1;break}}return Ca.K(sb)}kti(Q){const Ca=new hb.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)Ca.add(Q);return Ca}sAi(Q){switch(Q){case S.a.KS:case S.a.nLb:return 1;case S.a.JS:case S.a.jmf:return 2;case S.a.xM:case S.a.oLb:return 4;case S.a.BDe:case S.a.imf:return 8}return 0}bNi(){return 1<this.Xpa.count}KUd(){wa.ULS.sendTraceTag(594055960,
310,50,"CancelPendingPointerEvents");if(this.JRc)for(const Q of this.Xpa)this.rDj(Q.key);else this.Xpa=new xc.a;this.session=null}hZk(Q,Ca,sb){wa.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.YNc.mb(Q)){try{Ca.setPointerCapture(Q)}catch(Xb){wa.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",Xb)}this.YNc.add(Q,Ca)}this.Xpa.W(Q,sb);this.$4b&&1<this.Xpa.count&&this.z5&&!this.z5.cVc&&(this.z5.cVc=!0)}rDj(Q){wa.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",
Q);if(this.YNc.mb(Q)){try{this.YNc.K(Q).releasePointerCapture(Q)}catch(Ca){wa.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Ca)}this.YNc.remove(Q)}else wa.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.Xpa.remove(Q);this.$4b&&1>=this.Xpa.count&&this.z5&&this.z5.cVc&&(this.z5.cVc=!1)}Nxm(Q){const Ca=new Jb;var sb=Q.rawEvent;const Xb=sb.touches;sb=sb.changedTouches;Ca.pointers=Array.clone(Xb);Ca.pointers=Array.clone(0<Xb.length?Xb:sb);Ca.changedPointers=
Array.clone(sb);Ca.srcEvent=Q;Ca.pointerType="touch";return Ca}Mxm(Q,Ca,sb){const Xb=new Jb;Xb.pointers=eb.toArray(Q.values);Xb.changedPointers=[Ca];Xb.pointerType=sb;Xb.srcEvent=Ca;return Xb}frn(Q){return ab.a.startsWith(Q,S.a.fqe)}Eqn(Q){return ab.a.startsWith(Q,S.a.pan)}Pun(Q){return ab.a.startsWith(Q,S.a.UGg)}}Object(f.a)(fb,"GestureInputManager",aa.a,[1075,1076]);var Cb=d(305);class lc{constructor(){this.Z=null;this.vi=!1}get name(){return"Common.App.GestureInputManager"}uc(Q){Q.register(fb,
1537).as(91).ha().Sd(()=>new fb(Cb.a.instance,m.AFrameworkApplication.ta.$r));this.Z=Q}init(){this.vi||(this.Z.resolve(1537),this.vi=!0)}dispose(){}static main(){K.a.instance.Mc(new lc)}}Object(f.a)(lc,"GestureInputManagerPackage",null,[0,1]);var bc=d(267),Za=d(44),Ib=d(1487);class Ub{constructor(Q,Ca,sb){this.G8e=this.F8e=null;this.Dac=new v.a;this.Sfd=Xb=>{let Cc=null;Cc&&Cc.length||!Xb||!Xb.data||(Cc=Xb.data.Ee);if(Cc&&Cc.length)try{const jd=$a.a(Cc);this.F8e=jd.NavBarDataJson;wa.ULS.sendTraceTag(41551899,
215,50,"Skipping call to TryLoadResources for React Shared Header.");this.F8e?({hv:this.G8e}=$a.d(jd.NavBarDataJson)).returnValue?(this.gHn(this.G8e),this.Dac.hg(this.G8e)):(wa.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Ib.a.tsd(this.F8e)}),this.Dac.rha()):(wa.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Dac.rha())}catch(jd){wa.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.Dac.rha()}else wa.ULS.sendTraceTag(6362369,
215,10,"Response from O365ShellServiceProxy is null.")};this.hfd=()=>{this.Dac.rha();wa.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.Gf=Q;this.MMc=sb;this.Fqa=Ca.appSettings[Ub.tIp]||""}get C3o(){return this.Dac.task}get aU(){return this.Gf.value}wHo(){const Q={};Q[Ub.rZm]=m.AFrameworkApplication.xm;Q["Content-Type"]="application/json; charset=utf-8";wa.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const Ca=Za.a.pq(this.Fqa+
Ub.D3o,Ub.bWn,m.AFrameworkApplication.ta.Hb.Uk.toString());this.aU.Xj(Ca,1,"",Q,!0,2,this.Sfd,this.hfd,null,void 0,void 0,void 0,void 0,"20")}gHn(Q){try{const Ca={};Ca.FlightName=Q.FlightName;Ca.SessionID=Q.SessionID;wa.ULS.sendTraceTag(594883776,215,50,$a.c(Ca))}catch(Ca){wa.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}static get instance(){return Ub._instance||(Ub._instance=Ub.uPb())}static uPb(){return new Ub(new bc.a(()=>m.AFrameworkApplication.Ge),m.AFrameworkApplication.J,
m.AFrameworkApplication.ta.Hb.Uk)}}Ub.rZm="X-qs";Ub.bWn="at";Ub.D3o="O365ShellServiceProxy.ashx";Ub._instance=null;Ub.tIp="ShellWebServiceBase";Object(f.a)(Ub,"O365ShellActor",null,[1066]);class rc{constructor(){this.Z=null;this.nz=()=>{m.AFrameworkApplication.CNg&&m.AFrameworkApplication.ta.Hb.KN&&this.Z.resolve(1538).wHo()}}get name(){return"Common.App.O365Shell"}uc(Q){this.Z=Q;this.Z.register(Ub,1538).as(1072).ha().Sd(()=>new Ub(new bc.a(()=>m.AFrameworkApplication.Ge),m.AFrameworkApplication.J,
m.AFrameworkApplication.ta.Hb.Uk))}init(){m.AFrameworkApplication.J.xp(this.nz)}dispose(){}static main(){K.a.instance.Mc(new rc)}}Object(f.a)(rc,"PackageManager",null,[0,1]);class yc{fYa(){}init(){}dispose(){}}Object(f.a)(yc,"NoOpOfflineLogger",null,[1123,11]);var rb=d(789);class $c{}$c.qSd=0;Object(f.a)($c,"OfflineLoggerConstants",null,[]);var cd=d(92),Rd=d(253),ge=d(308);class Ze{constructor(Q,Ca,sb,Xb,Cc,jd){this.k3a=!1;this.n$=null;this.VFc=this.W8b=this.MCb=0;this.aL=this.Kjb=this.tT=null;this.jm=
!1;this.Nhg=(dd,oe)=>{if(void 0!==oe&&null!==oe&&void 0!==oe.args&&null!==oe.args){dd=!1;if(!this.Kjb.mb(oe.args.tag)){if(!this.Kjb.mb($c.qSd))return;dd=!0}this.Kjb.remove(dd?$c.qSd:oe.args.tag);this.aL.mb(oe.uploadId)||this.aL.W(oe.uploadId,new hb.a);this.aL.K(oe.uploadId).add(oe.args)}};this.Phg=(dd,oe)=>{this.aL.remove(oe.uploadId);this.CFb&&(this.CFb=!1,this.N2h())};this.Ohg=(dd,oe)=>{this.CFb=!0;if(void 0!==oe&&null!==oe&&this.aL.mb(oe.uploadId)){dd=!0;var Me=this.aL.K(oe.uploadId);for(const zf of Me)Me=
Ze.serialize(zf,this.pHa),this.Esd(this.FUc(this.VFc++),Me)||(dd=!1);dd&&this.aL.remove(oe.uploadId)}};this.Pdg=()=>{this.dispose()};this.OGa=sb;this.BHa=Xb;this.pHa=Cc;this.Gf=Ca;this.Gb=Q;this.j2a=jd;this.CFb=!1;this.l0e="OfflineLoggerManifest|"+this.j2a;this.QEk="OfflineLog|"+this.j2a+"|"}init(){this.BBg();this.iDn();this.k3a=!1;this.Gf.Y5a(this);this.tT=new cd.a(3,2,2500,Object(O.a)(this,this.Jwe,"sendOfflineLogs"),104);this.Gb.Yb(this.tT)}FUc(Q){return this.QEk+Q}iDn(){const Q=this.OGa.getItem(this.l0e);
void 0!==Q&&null!==Q&&0<Q.length&&(this.n$=Ze.Dsd(Q));this.n$||(this.n$={});if(void 0===this.n$.end||null===this.n$.end)this.n$.end=0;if(void 0===this.n$.offset||null===this.n$.offset)this.n$.offset=0;this.MCb=this.n$.offset;isFinite(this.MCb)||(this.MCb=0);this.W8b=this.n$.end;isFinite(this.W8b)||(this.W8b=0);this.VFc=this.W8b}BBg(){this.Kjb=new ge.a;this.aL=new Rd.a;this.BHa.LPh(this.Nhg);this.BHa.kQh(this.Phg);this.BHa.jQh(this.Ohg);this.BHa.BPh(this.Pdg)}Esd(Q,Ca){try{return this.OGa.setItem(Q,
Ca),!0}catch(sb){return!1}}Jwe(){if(!this.k3a){for(var Q=this.MCb,Ca=new hb.a,sb=null;Q<this.W8b&&5>=Ca.count;++Q){var Xb=this.FUc(Q);const Cc=this.OGa.getItem(Xb);this.OGa.removeItem(Xb);if(void 0===Cc||null===Cc)continue;const jd=({sessionId:Xb}=Ze.deserialize(Cc)).returnValue;if(jd){if(!sb)sb=Xb;else if(Xb!==sb)break;Ca.add(jd)}else wa.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",Cc)}0<Ca.count&&this.BHa.JGj(this,eb.toArray(Ca),sb);this.MCb=Q;Q>=this.W8b&&this.tOb()}}N2h(){this.tOb();
this.tT=new cd.a(3,2,2500,Object(O.a)(this,this.Jwe,"sendOfflineLogs"),104);this.Gb.Yb(this.tT)}fYa(Q,Ca,sb){!this.jm&&wa.ULS.x4(Ca,sb)&&this.Kjb.W(Q,!0)}dispose(){if(!this.jm){this.tT&&this.Gb.uf(this.tT);var Q=eb.toArray(this.aL.keys);Q.sort();for(const Ca of Q){Q=this.aL.K(Ca);for(const sb of Q)Q=Ze.serialize(sb,this.pHa),this.Esd(this.FUc(this.VFc++),Q)}this.MCb<this.VFc?(this.n$.end=this.VFc,this.n$.offset=this.MCb,this.Esd(this.l0e,JSON.stringify(this.n$))):this.OGa.removeItem(this.l0e)}this.jm=
!0}HCa(){this.k3a=!0}CYa(){this.k3a=!1;this.N2h()}tOb(){this.tT&&(this.Gb.uf(this.tT),this.tT=null)}static serialize(Q,Ca){const sb={};sb.t=Q.tag;sb.c=Q.category;sb.l=Q.level;sb.m=Q.message;sb.lt=Q.logType;sb.s=Ca;sb.ts=Q.timestamp;sb.o=Q.isMinified;sb.a=Q.args;return JSON.stringify(sb)}static deserialize(Q){return(Q=Ze.Dsd(Q))?{returnValue:new rb.a(Q.ts,Q.c,Q.t,Q.l,Q.m,Q.lt,Q.o,Q.a),sessionId:Q.s}:{returnValue:null,sessionId:null}}static Dsd(Q){try{return JSON.parse(Q)}catch(Ca){wa.ULS.sendTraceTag(18614234,
222,10,"OfflineLogger TryParseString failed with exception: {0}",Ca.message)}return null}}Object(f.a)(Ze,"OfflineLoggerImpl",null,[1123,11,264]);class De{constructor(Q,Ca,sb,Xb){this.sessionId=Q;this.version=Ca;this.hTd=sb;this.Cig=Xb;this.tVb=new hb.a}}Object(f.a)(De,"CachedLogUpload",null,[]);class Df{constructor(Q){Q.name&&(this.n=Q.name);Q.stack&&(this.s=Q.stack);Q.message&&(this.m=Q.message);Q.file&&(this.f=Q.file);null!=Q.line&&(this.l=Q.line);null!=Q.column&&(this.c=Q.column)}}Object(f.a)(Df,
"LoggingExceptionArgsLocalStorage",null,[]);class zd{constructor(Q){this.t=Q.tag;this.c=Q.category;this.l=Q.level;this.m=Q.message;this.lt=Q.logType;this.ts=Q.timestamp;this.o=Q.isMinified;this.a=Q.args;Q.exceptionArgs&&(this.e=new Df(Q.exceptionArgs))}}Object(f.a)(zd,"LoggingArgsLocalStorage",null,[]);var hg=d(490);class ni{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.t=Q;this.m=Ca;this.s=sb;this.v=Xb;this.i=Cc;this.a=jd;this.d=dd;this.op="Log"}}Object(f.a)(ni,"LoggingKeyLocalStorage",null,[]);var Fd=d(117);
const Uc=(Q,Ca,sb,Xb)=>!(void 0===Q||null===Q)&&!(void 0===Q.i||null===Q.i)&&!(void 0===Q.t||null===Q.t)&&!(void 0===Q.s||null===Q.s)&&"Log"===Q.op&&Q.t===Ca&&isFinite(Q.t)&&Fd.a.isValid(Q.s)&&(void 0===Q.m||null===Q.m||Q.m===sb)&&(void 0===Q.d||null===Q.d||Q.d===Xb);class pd{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf,uh,wj){this.k3a=this.Yth=this.Nth=this.Oth=!1;this.aL=this.Kjb=this.n$=this.tT=null;this.jm=!1;this.UTl=()=>{this.wfi(!0)};this.VTl=()=>{this.wfi(!1)};this.ucp=Sh=>Sh.s!==Sh.s?Sh.s.localeCompare(Sh.s):
Sh.i-Sh.i;this.rcp=Sh=>Sh.s!==Sh.s?Sh.s.localeCompare(Sh.s):Sh.i-Sh.i;this.Nhg=(Sh,qi)=>{if(void 0!==qi&&null!==qi&&void 0!==qi.args&&null!==qi.args){if(this.Vbd.mb(qi.args.tag))this.Vbd.remove(qi.args.tag);else if(this.Vbd.mb($c.qSd))this.Vbd.remove($c.qSd);else if(!(this.FEk&&50>qi.args.level))return;({value:Sh}=this.dMa.Ec(qi.uploadId)).returnValue||(Sh=new De(qi.sessionId,qi.version,qi.hTd,qi.Cig),this.dMa.W(qi.uploadId,Sh));this.dMa.K(qi.uploadId).tVb.add(qi.args)}};this.Phg=(Sh,qi)=>{this.dMa.remove(qi.uploadId);
this.CFb&&(this.CFb=!1,this.O2h())};this.Ohg=(Sh,qi)=>{this.CFb=!0;void 0!==qi&&null!==qi&&this.dMa.mb(qi.uploadId)&&this.dfj(qi.uploadId)&&!this.Yth&&(this.Yth=!0)};this.Pdg=()=>{this.dispose()};this.lFb=[];this.P8b=[];this.OGa=sb;this.BHa=Xb;this.pHa=Cc;this.Gf=Ca;this.Gb=Q;this.MMc=jd;this.W1e=dd;this.wCh=oe;this.G3a=Me;this.FEk=zf;this.DYe=uh;this.j2a=wj;this.CFb=!1}get manifest(){return this.n$}get Vbd(){return this.Kjb}get dMa(){return this.aL}init(){this.BBg();this.k3a=!1;this.Gf.Y5a(this);
this.tT=new cd.a(3,1,2500,this.UTl,103);this.Gb.Yb(this.tT)}wfi(Q){this.tOb();this.lFb=[];Q&&(this.P8b=[]);for(var Ca=0;Ca<this.OGa.length;Ca++){const sb=this.OGa.key(Ca),Xb=pd.N4j(sb,!1);Uc(Xb,this.MMc,this.W1e,this.j2a)&&(Xb.s===this.pHa?Array.add(this.lFb,sb):Q&&Array.add(this.P8b,sb))}if(this.lFb.length||Q&&this.P8b.length)if(Ca=this.DYe?this.rcp:this.ucp,this.lFb.sort(Ca),Q&&this.P8b.sort(Ca),0<this.lFb.length||0<this.P8b.length)this.tT=new cd.a(3,2,2500,Object(O.a)(this,this.Jwe,"sendOfflineLogs"),
105),this.Gb.Yb(this.tT)}FUc(Q,Ca,sb,Xb){Q=new ni(this.MMc,this.W1e,Ca,sb,Q,Xb,this.j2a);return JSON.stringify(Q)}BBg(){this.Kjb=new ge.a;this.aL=new Rd.a;this.BHa.LPh(this.Nhg);this.BHa.kQh(this.Phg);this.BHa.jQh(this.Ohg);this.BHa.BPh(this.Pdg)}dfj(Q){let Ca=!1;if(({value:Xb}=this.dMa.Ec(Q)).returnValue&&Xb&&0<Xb.tVb.count){if(Xb.hTd>=this.G3a)return this.dMa.remove(Q),!1;var sb=Xb.tVb;const Cc=Array(sb.count);for(let jd=0,dd=sb.count;jd<dd;++jd)Cc[jd]=new zd(sb.K(jd));sb=pd.serialize(Cc);var Xb=
this.FUc(Xb.Cig,Xb.sessionId,Xb.version,Xb.hTd);this.Esd(Xb,sb)&&(this.dMa.remove(Q),Ca=!0)}return Ca}Esd(Q,Ca){try{return this.OGa.setItem(Q,Ca),!0}catch(sb){return!1}}Jwe(){if(!this.k3a){var Q=0<this.lFb.length?this.lFb:this.P8b,Ca=Q.length;if(Ca)for(;0<Ca;){Ca--;var sb=this.DYe?Q.pop():Q[0];this.DYe||Array.removeAt(Q,0);const jd=pd.N4j(sb,!0);if(Uc(jd,this.MMc,this.W1e,this.j2a)){var Xb=this.OGa.getItem(sb);this.OGa.removeItem(sb);if(void 0!==Xb&&null!==Xb)if(jd.a>this.G3a)wa.ULS.sendTraceTag(37290075,
222,50,"Log has more attempt {0} than the max allowed {1}.",jd.a,this.G3a);else if(sb=pd.Dsd(Xb,!0),void 0!==sb&&null!==sb&&isFinite(sb.length))if(sb.length){Xb=sb[sb.length-1];var Cc=(new Date).getTime()-Xb.ts;if(Cc<-pd.t1j)wa.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Xb.ts);else if(Cc>this.wCh*pd.t1j)wa.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.wCh,
Xb.ts);else{jd.s===this.pHa?this.Oth||(this.Oth=!0,wa.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.Nth||(this.Nth=!0,wa.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",jd.s));Ca=Array(sb.length);for(Xb=0;Xb<sb.length;Xb++){Q=Xb;a:{Cc=sb[Xb];if(void 0===Cc||null===Cc){Cc=null;break a}let dd=null;Cc.e&&(dd=new hg.a(null),dd.name=Cc.e.n,dd.stack=Cc.e.s,dd.message=Cc.e.m,dd.file=Cc.e.f,dd.line=Cc.e.l,dd.column=Cc.e.c);Cc=
new rb.a(Cc.ts,Cc.c,Cc.t,Cc.l,Cc.m,Cc.lt,Cc.o,Cc.a,dd)}Ca[Q]=Cc}this.BHa.JGj(this,Ca,jd.s,jd.v,jd.a+1,jd.i);break}}else wa.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Xb);else wa.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",Xb)}}else this.tOb()}}O2h(){this.tOb();this.tT=new cd.a(3,1,2500,this.VTl,102);this.Gb.Yb(this.tT)}fYa(Q,Ca,sb){!this.jm&&wa.ULS.x4(Ca,sb)&&this.Vbd.W(Q,!0)}dispose(){if(!this.jm){this.tT&&this.Gb.uf(this.tT);
var Q=eb.toArray(this.dMa.keys);for(const Ca of Q)this.dfj(Ca)}this.jm=!0}HCa(){this.k3a=!0;this.tOb()}CYa(){this.k3a=!1;this.O2h()}tOb(){this.tT&&(this.Gb.uf(this.tT),this.tT=null)}static serialize(Q){return JSON.stringify(Q)}static N4j(Q,Ca){(Q=pd.Dsd(Q,Ca))&&void 0===Q.d&&(Q=new ni(Q.t,Q.m,Q.s,Q.v,Q.i,Q.a,0));return Q}static Dsd(Q,Ca){try{return JSON.parse(Q)}catch(sb){Ca&&wa.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",sb.message)}return null}}pd.t1j=
864E5;Object(f.a)(pd,"OfflineLoggerImplV2",null,[1123,11,264]);class He{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(Q){return this.handleError("Length",Q),-1}}key(Q){try{return localStorage.key(Q)}catch(Ca){return this.handleError("Key",Ca),null}}getItem(Q){try{return localStorage.getItem(Q)}catch(Ca){return this.handleError("GetItem",Ca),null}}setItem(Q,Ca){try{return localStorage.setItem(Q,Ca)}catch(sb){return this.handleError("SetItem",
sb),null}}removeItem(Q){try{localStorage.removeItem(Q)}catch(Ca){this.handleError("RemoveItem",Ca)}}clear(){try{localStorage.clear()}catch(Q){this.handleError("Clear",Q)}}handleError(){}}Object(f.a)(He,"OfflineStorage",null,[1122]);class rf{create(Q){var Ca=null;try{void 0!==localStorage&&null!==localStorage&&(Ca=new He)}catch(Xb){wa.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",Xb.message)}Object.getType(wa.ULS.host).implementsInterface(1095)&&Ca||(wa.ULS.sendTraceTag(18614230,
222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",Ca?"supported":"not supported",Object.getType(wa.ULS.host).implementsInterface(1095)?"supported":"not supported"),Q=0);const sb=m.AFrameworkApplication.J;1===Q?Ca=new Ze(m.AFrameworkApplication.oc,m.AFrameworkApplication.Ge,Ca,wa.ULS.host,m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.Hci):2===Q?(Q=m.AFrameworkApplication.ta.Hb,Ca=new pd(m.AFrameworkApplication.oc,m.AFrameworkApplication.Ge,Ca,wa.ULS.host,
m.AFrameworkApplication.userSessionId,Q.Uk,Q.Lma,sb.fc("OfflineLoggerRetentionInDays",30),sb.fc("OfflineLoggerMaxAttempts",5),sb.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),sb.$("SendOfflineLogsV2ImprovementIsEnabled"),m.AFrameworkApplication.Hci)):Ca=new yc;Ca.init();return Ca}}Object(f.a)(rf,"OfflineLoggerFactory",null,[]);class Rf{uc(){}get name(){return"Common.App.OfflineLogger"}init(){const Q=m.AFrameworkApplication.J;let Ca=0;Q.$("OneNoteOfflineLoggerIsEnabled")?Ca=1:Q.$("OfflineLoggerV2IsEnabled")&&
(Ca=2);0!==Ca&&(m.AFrameworkApplication.ICe=(new rf).create(Ca))}dispose(){}}Object(f.a)(Rf,"OfflineLoggerPackage",null,[0,1]);var kd=d(41),ff=d(1256);class Te{constructor(Q){this.Ubj=null;this.eNm=()=>{wa.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")};this.gNm=Ca=>{wa.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Ca=$a.a(Ca.data.Ee).state+"";ff.a.instance.setItem("AccountLinkedStatusCache",Ca)};
wa.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.Kcd=m.AFrameworkApplication.J.jb("PhoneLinkServiceEndpoint");(this.Jba=Q)||wa.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Kcd&&this.Kcd.length||wa.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}N7l(Q){Q&&(this.Kcd="https://dcg-df.microsoft.com/",wa.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.M7l()}M7l(){wa.ULS.sendTraceTag(527214155,
306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.Ubj)wa.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.Ubj=new Date;var Q=new Date;this.Jba.GV("BayBridge",this.Kcd).then(Ca=>{const sb=+new Date-+Q;Ca.IsSuccess?(wa.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",sb),this.B7l(Ca.Token,this.ijm())):wa.ULS.sendTraceTag(527574724,306,
15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",sb,Ca.ErrorCode,Ca.ErrorMessage)}).catch(Ca=>{wa.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",Ca,+new Date-+Q)})}}B7l(Q,Ca){const sb={};sb.Authorization="Bearer "+Q;sb["Authorization-Type"]="AAD";sb.Accept="application/json";sb["DCG-SessionId"]=m.AFrameworkApplication.userSessionId;m.AFrameworkApplication.Ge.Xj(Ca,
1,null,sb,!1,2,this.gNm,this.eNm,null,void 0,void 0,void 0,void 0,"39");kd.a("FetchAccountLinkedStatus")}ulm(){const Q=ff.a.instance.getItem("AccountLinkedStatusCache");return Q&&Q.length?"true"===Q.toLowerCase()?!0:!1:!1}ijm(){return this.Kcd+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}}Object(f.a)(Te,"PhoneLinkManager",null,[1019]);class xe{constructor(){this.Z=null}get name(){return"Common.App.PhoneLink"}uc(Q){this.Z=Q;this.Z.register(1019,1030).ha().Sd(()=>new Te(this.Z.resolve(725)))}init(){m.AFrameworkApplication.J.xp(()=>
{this.L$a()})}L$a(){this.Z.resolve(1030)}dispose(){}static main(){K.a.instance.Mc(new xe)}}Object(f.a)(xe,"PhoneLinkPackage",null,[0,1]);const jf=Q=>{try{return $a.a(Q)}catch(Ca){}return null};class Gg{constructor(Q,Ca,sb,Xb,Cc,jd){this.H1=!1;this.gl=null;this.f4e=!1;this.jkf=dd=>{const oe=dd.hQb();oe.continueWith(()=>{this.gl=oe.result;this.f4e&&(this.gl.tC(2,null,!0),this.f4e=!1);this.gl.TO((Me,zf)=>{2===zf.type&&this.Qb.Ob(x.a.OOb,2)});this.gl.a_((Me,zf)=>{2===zf.newState&&this.Qb.Ob(x.a.OOb,2)});
2===this.gl.connectionState&&this.Qb.Ob(x.a.OOb,2)})};this.Xsc=dd=>{this.H1=!1;const oe=jf(dd.data.Ee);dd.data.state.ME(oe,this.Ysh.value)};this.Q3n=dd=>{5!==dd.data.status||this.H1?this.Anj(dd):(this.H1=!0,this.emi(dd.data.state,!1))};this.Anj=dd=>{dd.data.state.onFailure(-1)};this.Nfd=dd=>{this.H1=!1;const oe=jf(dd.data.Ee);dd.data.state.ME(oe,this.Ysh.value);this.cij()};this.U3n=dd=>{5!==dd.data.status||this.H1?this.Cnj(dd):(this.H1=!0,this.gmi(dd.data.state,!1))};this.Cnj=dd=>{dd.data.state.onFailure(-1)};
this.ga=Q;this.Gf=Ca;this.im=sb;this.Ysh=Xb;this.Ga=Cc;this.jEk=jd}init(Q,Ca){Ca&&Q.Ra(140).execute(this.jkf)}nVa(Q){this.emi(Q,!0)}emi(Q,Ca){const sb=this.jil(Q.vWj),Xb={};Xb[Gg.v7h]=Gg.w7h;this.wGj.Xj(sb,2,"",Xb,!1,2,this.Xsc,Ca?this.Q3n:this.Anj,Q)}BOb(Q){this.gmi(Q,!0)}gmi(Q,Ca){const sb=this.kil(),Xb={};Xb[Gg.v7h]=Gg.w7h;Xb[Gg.pZm]=ab.a.ej(Q.DGj);Xb[Gg.nZm]=this.jEk.value.svl;this.wGj.Xj(sb,2,"",Xb,!1,2,this.Nfd,Ca?this.U3n:this.Cnj,Q)}kil(){return this.hYh()}jil(Q){let Ca=this.hYh();return Ca=
Za.a.pq(Ca,Gg.tZm,Q?"2":"1")}hYh(){let Q=(this.Ga.value.appSettings.RenameWebServiceBase||"")+Gg.oZm;Q=Za.a.pq(Q,Gg.qZm,ab.a.ej(m.AFrameworkApplication.xm));this.Ln&&this.Ln.hZf&&(Q=Za.a.pq(Q,Gg.sZm,"1"));return Q}cij(){this.gl?this.gl.tC(2,null,!0):this.f4e=!0}get Qb(){return this.ga.value}get wGj(){return this.Gf.value}get Ln(){return this.im.value}static get instance(){return Gg._instance||(Gg._instance=Gg.uPb())}static uPb(){return new Gg(new bc.a(()=>m.AFrameworkApplication.va),new bc.a(()=>
m.AFrameworkApplication.Ge),new bc.a(()=>m.AFrameworkApplication.Ln),new bc.a(()=>Na.a.instance.resolve(7)),new bc.a(()=>m.AFrameworkApplication.J),new bc.a(()=>Na.a.instance.resolve(1071)))}}Gg.v7h="Content-Type";Gg.w7h="application/json; charset=utf-8";Gg.oZm="renamehandler.ashx";Gg.qZm="qs";Gg.pZm="n";Gg.sZm="sl";Gg.nZm="X-CoauthLockId";Gg.tZm="u";Gg._instance=null;Object(f.a)(Gg,"ExecuteRenameFileHandler",null,[]);class ng{constructor(){this.onFailure=this.ME=null;this.vWj=!1}}Object(f.a)(ng,
"ExecuteRefreshFilenameData",null,[]);class pg{constructor(){this.onFailure=this.ME=this.DGj=null}}Object(f.a)(pg,"ExecuteRenameFileData",null,[]);class dh{constructor(){this.Z=null;this.URe=Gg.instance;this.nz=()=>{m.AFrameworkApplication.M$c()&&(Gg.instance.init(this.Z,m.AFrameworkApplication.Ykd),m.AFrameworkApplication.BOb=Object(O.a)(this,this.BOb,"executeRenameFile"),m.AFrameworkApplication.nVa=Object(O.a)(this,this.nVa,"executeRefreshFilename"),m.AFrameworkApplication.ond=Object(O.a)(this,
this.ond,"sendFileNameAndLocationUpdateNotification"))}}get name(){return"Common.App.RenameFile.RenameExecutor"}uc(Q){this.Z=Q}init(){m.AFrameworkApplication.J.xp(this.nz)}BOb(Q,Ca,sb){const Xb=new pg;Xb.DGj=Q;Xb.ME=Ca;Xb.onFailure=sb;this.URe.BOb(Xb)}nVa(Q,Ca,sb){const Xb=new ng;Xb.ME=Q;Xb.onFailure=Ca;Xb.vWj=sb;this.URe.nVa(Xb)}ond(){this.URe.cij()}dispose(){}}Object(f.a)(dh,"PackageManager",null,[0,1]);var Hg=d(175);class Zj{constructor(Q,Ca,sb){this.JDg=this.KDg=this.LDg=!1;this.$Dg=!Q&&!Ca;this.aEg=
!Q&&!sb;this.$Dg||this.aEg||(this.LDg=!Q,this.KDg=!Ca,this.JDg=!sb)}}Object(f.a)(Zj,"RenameDisabledDialogInfo",null,[]);class nh extends Hg.StandardDialog{constructor(Q,Ca,sb,Xb,Cc){super();this.oIg=[];this.Xia=new Zj(Q,Ca,sb);this.Xlb=Xb;this.vjb=Cc;this.Pg="RenameDisabledDialog";this.Ed=0;this.Qe(1,CommonUIStrings.l_DialogClose);this.X0o();this.YEo()}X0o(){this.Xia.$Dg?this.Jpd(this.Xlb?this.vjb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Xia.aEg?this.Jpd(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.DYk();this.SQd(this.oIg)}Jpd(Q){Array.add(this.oIg,Q)}DYk(){const Q=[];this.Xia.LDg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.Xia.KDg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.Xia.JDg||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Q.length&&Array.add(this.oIg,Q)}}Object(f.a)(nh,"ReactRenameDisabledDialogBase",
Hg.StandardDialog,[]);class eh extends nh{constructor(Q,Ca,sb,Xb,Cc){super(Q,Ca,sb,Xb,Cc)}YEo(){this.evb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(f.a)(eh,"ReactRenameDisabledDialog",nh,[]);class xf{static get lh(){return a.a.ry(xf.Qn,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}xf.Qn="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(f.a)(xf,"RenameDisabledDialogHtml",null,[]);class Ig extends a.a{constructor(Q,Ca,sb,Xb,Cc){super();this.Xia=new Zj(Q,Ca,sb);this.Xlb=Xb;this.vjb=Cc;this.Pg="RenameDisabledDialog";this.Ed=0;this.Qe(1,CommonUIStrings.l_DialogClose);this.lh=xf.lh;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.H8("RenameRow")}Pba(){if(this.Xia.$Dg){let Q;Q=this.Xlb?this.vjb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Ig.Jpd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Q)}else this.Xia.aEg?Ig.Jpd(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.S1m()}S1m(){this.Xia.LDg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Xia.KDg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Xia.JDg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Jpd(Q,Ca,sb){Q.style.display="none";Ca.innerText=sb}}Object(f.a)(Ig,"RenameDisabledDialog",a.a,[]);class Mj{constructor(Q,Ca){this.ZFb=0;this.Hqf=(sb,Xb,Cc,jd,dd)=>{if(1===Cc)return this.ga.Ob(x.a.cva,1);sb=ab.a.FL(this.HQa.HA);dd=(0,dd.getNewDocumentTitle)();dd.length>this.ZFb&&(dd=dd.substr(0,this.ZFb));if(32!==this.ga.Pb(x.a.cva,2,dd))return this.mBc(sb),8;this.mBc(dd);return 32};this.ga=
Q;this.HQa=Ca}initialize(Q){if(!this.ga||!this.HQa)return!1;this.ZFb=Q;this.Wb();return!0}Wb(){this.ga.qa(x.a.Hqf,z.a.frame,this.Hqf)}mBc(Q){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Q))}static Sm(){return new Mj(m.AFrameworkApplication.va,m.AFrameworkApplication.Ht)}}Object(f.a)(Mj,"ReactRenameUIHandler",null,[1124]);var If=d(1018),$b=d(1571),wc=d(706),ed=d(140),Dd=d(260),ee=d(69);class me{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf,uh,wj){this._initialized=!1;this._element=null;
this.ZFb=0;this.e8e=this.rVe=!1;this.ga=Q;this.Ioa=Ca;this.oe=sb;this.qx=Xb;this.HQa=Cc;this.xDh=jd;this.$Ld=dd;this.aNe=oe;this.Sib=Me;this.Rph=zf;this.Xi=uh;this.cXe=wj}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Q,Ca,sb){if(!(this.ga&&this.HQa&&this.xDh&&this.$Ld&&this.aNe&&Ca)||0>=Q)return!1;this._element=Ca;this._element.title=sb;this._element.setAttribute(ee.a.Sh,ee.a.X$);this._element.setAttribute("Unselectable","on");this.ZFb=Q;this.YE();return this._initialized=
!0}YE(){this.Ioa&&(this.Ioa.nb(S.a.blur,this._element,Object(O.a)(this,this.onBlur,"onBlur")),this.Ioa.nb(S.a.paste,this._element,Object(O.a)(this,this.Dfd,"onPaste")));this.oe.nb(S.a.kj,this._element,Object(O.a)(this,this.onKeyDown,"onKeyDown"));this.qx.nb(S.a.jt,this._element,Object(O.a)(this,this.LE,"onPointerDown"));this.qx.nb(S.a.PP,this._element,Object(O.a)(this,this.XCa,"onPointerUp"))}onBlur(){this.isActive&&!this.rVe&&(this.Rph||this.aNe(this._element),this.u5h(),this.$vf(!1));return this.rVe=
!1}Dfd(){wa.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Q){return this.isActive?this.c1n(Q):this.d1n(Q)}c1n(Q){let Ca=!1;switch(Q.Nb.keyCode){case Sys.UI.Key.enter:this.u5h();this.$vf(this.Xi||this.cXe);Ca=!0;break;case Sys.UI.Key.tab:this.Rph&&this.aNe(this._element);break;case Sys.UI.Key.esc:this.rvg(),this.$vf(this.Xi||this.cXe),Ca=!0}return Ca}d1n(Q){let Ca=!1;switch(Q.Nb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.U3j(this.cXe),
this.isActive&&this.$Ld(this._element),Ca=!0}return Ca}LE(){this.isActive||(this.U3j(!1),this.isActive&&(this._element.focus(),this.$Ld(this._element),this.e8e=!0));return!1}XCa(){return this.e8e?(this.$Ld(this._element),this.e8e=!1,!0):!1}epc(){return 32===this.ga.Ob(x.a.cva,1)}u5h(){const Q=ab.a.FL(this.HQa.HA);let Ca=this._element.innerText.trim();Ca.length>this.ZFb&&(Ca=Ca.substr(0,this.ZFb));Ca!==Q&&""!==Ca?32!==this.ga.Pb(x.a.cva,2,Ca)?this.rvg():this.mBc(Ca):this.rvg()}rvg(){this.mBc(ab.a.FL(this.HQa.HA))}mBc(Q){this._initialized&&
(this._element.innerText=Q,this.xDh())}U3j(Q){this.epc()?this.isActive||(Q&&(this.rVe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(ee.a.Sh,ee.a.GUh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,If.a.Iii),this.Sib&&this.Sib.execute(Ca=>{Ca.Cyj(!0)}),Q&&this._element.focus(),wa.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.Ob(x.a.pyc,2)}$vf(Q){this._element.removeAttribute("contentEditable");
this._element.setAttribute("Unselectable","on");this._element.setAttribute(ee.a.Sh,ee.a.X$);Sys.UI.DomElement.removeCssClass(this._element,If.a.Iii);this.Sib&&this.Sib.execute(Ca=>{Ca.Cyj(!1)});Q&&(this._element.blur(),this._element.focus())}static WDa(){$b.a.WDa(m.AFrameworkApplication.isRtl)}static Sm(){return new me(m.AFrameworkApplication.va,wc.a.instance,ed.KeyInputManager.instance,Dd.a.instance,m.AFrameworkApplication.Ht,me.WDa,la.a.LPo,la.a.m3h,Na.a.instance.Ra(694),kb.a.N7,kb.a.Di,kb.a.yj)}}
Object(f.a)(me,"RenameUIHandler",null,[1124]);class Nf{static get instance(){return m.AFrameworkApplication.ta.Hb.KN?Nf._instance||(Nf._instance=Mj.Sm()):Nf._instance||(Nf._instance=me.Sm())}}Nf._instance=null;Object(f.a)(Nf,"RenameUIHandlerFactory",null,[]);var Tf=d(862);class oi{constructor(){this.Ubg=this.GSn=this.xNl=null}}Object(f.a)(oi,"RenameMruEntryProperties",null,[]);var Ie=d(186),ag=d(89),uf=d(1486),Pe;(function(Q){Q[Q.unknown=-1]="unknown";Q[Q.success=0]="success";Q[Q.Ekq=1]="renameInvalidFileName";
Q[Q.Dkq=2]="renameInCoauthNotSupported";Q[Q.Fkq=3]="renameNotSupportedInViewMode";Q[Q.Uco=4]="permissionDenied";Q[Q.dnq=5]="serverCommunicationFailure";Q[Q.N2p=6]="fileNameTooLong"})(Pe||(Pe={}));Object(f.b)("CommonOperationResult",Pe);class Db{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf,uh,wj){this.anc=()=>Nf.instance.initialize(m.AFrameworkApplication.U2d,m.AFrameworkApplication.Khi,m.AFrameworkApplication.GEj||CommonUIStrings.l_RenameFileTooltip)?32:8;this.pyc=()=>{const Sh=this.aFp(),qi=this.OSk();
wa.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.GFb,qi,Sh,this.Xlb);m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb.sH&&m.AFrameworkApplication.J.$("ReactRenameDisabledDialogIsEnabled")?new eh(this.GFb,!qi,!Sh,this.Xlb,this.vjb()):new Ig(this.GFb,!qi,!Sh,this.Xlb,this.vjb());return 32};this.cva=(Sh,qi,yk,Zo,Hn)=>{var zn;if(1===yk)return this.epc();
if(!m.AFrameworkApplication.BOb)return 8;if(8===this.epc())return this.Qb.Ob(x.a.pyc,2),8;wa.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");Sh=!1;(null===(zn=m.AFrameworkApplication.J)||void 0===zn?0:zn.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameDisableFailedDialog",!1))&&"object"===typeof Hn&&(Sh=Hn.disableFailedDialog,Hn=Hn.fileNameCandidate);m.AFrameworkApplication.BOb(Hn,Object(O.a)(this,this.Nfd,"onRenameFileSuccess"),Sh?()=>{}:this.T3n);m.AFrameworkApplication.FEj=!0;
return 32};this.T3n=Sh=>{const qi=new Hg.StandardDialog;qi.Ed=0;switch(Sh){case 1:wa.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");qi.Nna(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:wa.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");qi.Nna(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:wa.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",
{["Result"]:Sh}),qi.Nna(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}m.AFrameworkApplication.DN().execute(yk=>{yk.sendMessage(ag.a.t8l,{["FailureMessage"]:Pe[Sh]})});this.xHj()};this.vuo=(Sh,qi,yk)=>{if(1===yk)return this.epc();if(!m.AFrameworkApplication.nVa)return 8;m.AFrameworkApplication.nVa(Object(O.a)(this,this.Xsc,"onRefreshFilenameSuccess"),Object(O.a)(this,this.Dne,"onRefreshFilenameFailure"),!1);return 32};this.yke=(Sh,qi,yk,Zo,Hn)=>{if(1===
yk)return m.AFrameworkApplication.J.$("UiHostSupportsMoveToFolder")?this.epc():8;if(2===yk){if(!m.AFrameworkApplication.ond)return va.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Hn)return va.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Hn[Ie.a.ejn])if(Hn[Ie.a.u$j])if(Sh=Hn[Ie.a.u$j].toLowerCase(),qi=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"),yk=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1),qi&&m.AFrameworkApplication.dub&&yk){const zn={};zn[Ie.a.ovc]="1";zn[Ie.a.documentUrl]=Sh;zn[Ie.a.reason]=uf.a.Mwg;va.Health.instance.recordKpiSuccess("MoveToFolder",null);m.AFrameworkApplication.DN().execute(At=>{At.sendMessage(ag.a.SNb,zn)})}else if(!m.AFrameworkApplication.dub&&yk)va.Health.instance.recordKpiSuccess("MoveToFolder",null),la.a.Cn(Sh,la.a.owa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return va.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",
!1,!1,null),8;else va.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else m.AFrameworkApplication.nVa(Object(O.a)(this,this.Xsc,"onRefreshFilenameSuccess"),Object(O.a)(this,this.Dne,"onRefreshFilenameFailure"),!1),m.AFrameworkApplication.ond(),va.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.kqh=Q;this.ga=Ca;this.im=sb;this.rO=Xb;this.GFb=Cc;this.OSk=jd;this.Xlb=dd;this.CJh=oe;this.uLk=Me;this.vjb=zf;this.Ga=uh;this.tLk=wj}Wb(){m.AFrameworkApplication.ta&&
m.AFrameworkApplication.ta.Hb.KN||this.Qb.qa(x.a.anc,z.a.frame,this.anc);this.Qb.qa(x.a.pyc,z.a.frame,this.pyc);this.Qb.qa(x.a.cva,z.a.frame,this.cva);this.Qb.fb(x.a.OOb,z.a.frame,this.vuo,64);this.Qb.fb(x.a.yke,z.a.frame,this.yke,64);this.Qb.qa(x.a.bWb,z.a.frame,Object(O.a)(this,this.bWb,"moveToFolder"));(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||m.AFrameworkApplication.ta&&(m.AFrameworkApplication.J.$("PostMessageEmbedded")||
m.AFrameworkApplication.J.$("IsJsApi"))&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&m.AFrameworkApplication.DN().execute(Q=>{Q.Gv(ag.a.Bfj);Q.XE(ag.a.Bfj,Db.Qqo);Q.Gv(ag.a.jDf);Q.XE(ag.a.jDf,Db.Pqo)})}epc(){return 0===this.tLk.QFi()?32:8}aFp(){return this.Ln?this.Xlb?this.Ln.Shi:this.Ln.zqb:!0}Nfd(Q,Ca){Q?0!==Q.OperationResult?this.pMi(Q.OperationResult):(this.CRo(Ca,Q.NewName),this.Gwp(Q,Object(O.a)(m.AFrameworkApplication.ta.Hb,m.AFrameworkApplication.ta.Hb.K8j,
"updateOpenInClientDocumentUrl")),m.AFrameworkApplication.J.$("DocumentNameInJewelInfoMenuIsEnabled")&&m.AFrameworkApplication.ta.Fe(),this.uLk.u6j()):this.pMi(5)}CRo(Q,Ca){const sb={};sb[Ie.a.u8l]=Ca;Q.sendMessage(ag.a.jDf,sb)}Gwp(Q,Ca){this.Uwp(Q);m.AFrameworkApplication.E_d=Q.DirectInvokeDavUrl;Ca=Ca(Q.EditDocInClientUrl);const sb=new oi;sb.Ubg=this.rO.HA;sb.xNl=Ca;sb.GSn=Q.EditDocInClientUrl;this.Qb.Pb(x.a.HEj,2,sb)}pMi(Q){switch(Q){case 1:Q=new Hg.StandardDialog,Q.Ed=0,Q.AY(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileInvalidName,null),this.xHj()}}Uwp(Q){this.rO.HA=Db.N7k(this.rO.HA,Q.NewName);Q.BreadcrumbFolderName&&(this.rO.breadcrumbFolderName=Q.BreadcrumbFolderName);Q.BreadcrumbFolderUrl&&(this.rO.breadcrumbFolderUrl=Q.BreadcrumbFolderUrl);this.CJh(Q.NewName)}bWb(Q,Ca,sb,Xb,Cc){if(1===sb)return m.AFrameworkApplication.J.$("UiHostSupportsMoveToFolder")?32:8;if(2===sb){const jd={};Q=m.AFrameworkApplication.dub;Ca=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures");Q=(!Q||
Q&&Ca)&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);jd[Ie.a.Chp]=Q;Cc&&Cc.MoveButtonClickedTime&&(jd[Ie.a.sQn]=Cc.MoveButtonClickedTime.getTime());m.AFrameworkApplication.DN().execute(dd=>{dd.sendMessage(ag.a.bWb,jd)});if(Cc&&Cc.MoveButtonClickedTime){if(Q=Tf.a.cH())Cc=(new Date).getTime()-Cc.MoveButtonClickedTime.getTime(),Q.set("MovePostDuration",Cc.toString());va.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Q)}return 32}return 8}L7o(Q,
Ca){return Q&&Ca?Q!==this.rO.breadcrumbFolderName||Ca!==this.rO.breadcrumbFolderUrl:!1}Xsc(Q,Ca){Q&&(Q.NewName!==ab.a.FL(this.rO.HA)||this.L7o(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl))&&this.Nfd(Q,Ca)}Dne(){}xHj(){this.CJh(ab.a.FL(this.rO.HA))}get Qb(){return this.ga.value}get Ln(){return this.im.value}static get instance(){return Db._instance||(Db._instance=Db.uPb())}static uPb(){return new Db(m.AFrameworkApplication.M$c,new bc.a(()=>m.AFrameworkApplication.va),new bc.a(()=>m.AFrameworkApplication.Ln),
m.AFrameworkApplication.Ht,m.AFrameworkApplication.Vta,()=>m.AFrameworkApplication.LNg,m.AFrameworkApplication.Ykd,Object(O.a)(Nf.instance,Nf.instance.mBc,"updateTitle"),Na.a.instance.resolve(1539),()=>m.AFrameworkApplication.tw,m.AFrameworkApplication.J,Na.a.instance.resolve(1071))}static N7k(Q,Ca){Q=ab.a.ola(Q);return Ca+Q}static Qqo(Q){const Ca=Q.Values[Ie.a.jpn];wa.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Ca);Ca?m.AFrameworkApplication.va.Pb(x.a.yke,2,Q.Values):
va.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static Pqo(Q){m.AFrameworkApplication.va.Pb(x.a.cva,2,Q.Values.NewName)}}Db._instance=null;Object(f.a)(Db,"RenameActor",null,[]);var Vb=d(196),Nc=d(1263),td=d(572),Ke=d(469);class sf{constructor(Q,Ca){this.ga=Q;this.DGc=Ca}Wb(){this.ga.qa(x.a.VDg,z.a.frame,Object(O.a)(this,this.L$o,"showRenameDialogAction"))}L$o(Q,Ca,sb){Q=32;if(1===sb)return Ke.SessionStatusManager.instance.Nk||m.AFrameworkApplication.wta?
8:32;2===sb&&(32!==this.ga.Ob(x.a.cva,1)?(this.ga.Ob(x.a.pyc,2),Vb.a.instance.$b(Nc.a.osa,{["Reason"]:td.a.eEo}),Q=8):32===this.ga.Ob(x.a.qyc,1)?this.ga.Ob(x.a.qyc,2):this.DGc.value.create().U_a());return Q}}Object(f.a)(sf,"RenameDialogActor",null,[1111]);class qh{constructor(Q,Ca,sb){this.dialog=null;this.ga=Q;this.rO=Ca;this.Aib=sb}nJm(){const Q={};Q.nameInputProps={["type"]:"AppInputProps",["id"]:qh.nhc,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:ab.a.FL(this.rO.HA),["maxLength"]:this.Aib};
return Q}U_a(){const Q={["id"]:"RenameDialog",["bodyControls"]:this.nJm()};this.dialog=new a.a(!1,!1,!0);this.dialog.Ed=1;this.dialog.Pg="RenameDialog";this.dialog.gi(CommonUIStrings.l_RenameDialogTitle,Object(O.a)(this,this.Atg,"renameDialogHandler"),Q)}Atg(Q,Ca){if(Ca&&1===Q){if(Ca[qh.nhc]&&(Q=ab.a.FL(this.rO.HA),Ca=(Ca[qh.nhc]||"").trim(),Ca!==Q&&""!==Ca)){this.ga.Pb(x.a.cva,2,Ca);return}Vb.a.instance.$b(Nc.a.khc,{["Reason"]:td.a.Nni})}}}qh.nhc="txtDocumentName";Object(f.a)(qh,"ReactRenameDialog",
null,[1125]);class Ef{static get lh(){return a.a.ry(Ef.Qn,CommonUIStrings.l_RenameDialogLabel)}}Ef.Qn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(f.a)(Ef,"RenameDialogHtml",null,[]);class jg extends a.a{constructor(Q,Ca,sb){super();this.ga=Q;this.rO=Ca;this.Aib=sb;this.Pg="RenameDialog";this.lh=Ef.lh}U_a(){var Q=
{["txtDocumentName"]:ab.a.FL(this.rO.HA)};this.gi(CommonUIStrings.l_RenameDialogTitle,Object(O.a)(this,this.Atg,"renameDialogHandler"),Q);Q=document.getElementById(jg.nhc);0<this.Aib&&(Q.maxLength=this.Aib);Q.focus()}Atg(Q,Ca){if(1===Q&&(Q=ab.a.FL(this.rO.HA),Ca=(Ca[jg.nhc]||"").trim(),Ca!==Q&&""!==Ca)){this.ga.Pb(x.a.cva,2,Ca);return}Vb.a.instance.$b(Nc.a.khc,{["Reason"]:td.a.Nni})}}jg.nhc="txtDocumentName";Object(f.a)(jg,"RenameDialog",a.a,[1125]);class Fi{constructor(Q){this.HQa=null;this.Aib=
0;this.ga=Q;this._initialized=!1}initialize(Q,Ca){this.HQa=Q;this.Aib=Ca;this._initialized=!0}create(){return this._initialized?m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb.sH&&m.AFrameworkApplication.J.$("ReactRenameDialogIsEnabled")?new qh(this.ga,this.HQa,this.Aib):new jg(this.ga,this.HQa,this.Aib):null}}Object(f.a)(Fi,"RenameDialogFactory",null,[1103]);var hf=d(180),Ph=d(113);class mg{constructor(Q,Ca){this.ga=Q;this.Zb=Ca}Wb(){this.ga.qa(x.a.qyc,z.a.frame,Object(O.a)(this,this.M$o,
"showRenameFlyoutAction"))}Jml(){return C.d("setDocumentTitleFlyoutOpened")&&m.AFrameworkApplication.ta.Hb.KN}M$o(Q,Ca,sb){if(1===sb)return this.Jml()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}x_k(){mg.Ttn&&m.AFrameworkApplication.HI&&Ph.a.instance.Yb(new cd.a(5,1,5E3,()=>{32===this.ga.Ob(x.a.qyc,1)&&this.Zb&&this.Zb.currentScope.name===hf.AFrame.Jo&&(kd.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.Ob(x.a.qyc,2))}))}static get Ttn(){mg.mFd&&null!=
mg.mFd||(m.AFrameworkApplication.nd("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),mg.mFd=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return mg.mFd}}mg.mFd=null;Object(f.a)(mg,"RenameFlyoutActor",null,[1104]);class el{constructor(Q,Ca,sb,Xb,Cc){this.svl=null;this.im=Cc;this.lqh=sb;this.kqh=Xb;this.QSk=Q;this.vjb=Ca}get Ln(){return this.im.value}QFi(){if(!this.kqh())return 5;
if(this.vjb())return 1;if(this.Ln){if(this.lqh&&!this.Ln.Shi)return 3;if(!this.lqh&&!this.Ln.zqb)return 4}return this.QSk()?0:2}}Object(f.a)(el,"RenameProps",null,[1102]);class Tg{constructor(Q,Ca,sb,Xb,Cc,jd){this.Ns=!1;this.a_e=new xc.a;this.F6b=Ca;this.uB=sb;this.x5b=Xb;this.Ga=Cc;this.Aja=jd}enable(){this.Ns||(this.u6j(),this.BFg(),this.Ns=!0)}generateKey(Q,Ca,sb){return String.format("{0}/{1}/{2}",sb,Q,Ca)}tym(){const Q=ab.a.FL(this.F6b().HA);return this.generateKey(this.F6b().breadcrumbFolderName,
this.F6b().breadcrumbFolderUrl,Q)}uym(Q,Ca,sb){return Q&&Ca?this.generateKey(Q,Ca,sb):sb}YUl(Q,Ca,sb){return Q&&Q!==this.F6b().breadcrumbFolderName||Ca&&Ca!==this.F6b().breadcrumbFolderUrl?!0:sb!==ab.a.FL(this.F6b().HA)}u6j(){const Q=this.tym();this.a_e.W(Q,new Date)}Pkg(Q){this.R5o(Q)&&this.aMh(Q)}R5o(Q){const Ca=this.x5b();return Ca?this.Aja&&this.Aja.Mo||!Ca.hZf||!m.AFrameworkApplication.nVa?(this.WYj(Q),this.Ns=!1):!0:!1}Foj(Q,Ca,sb,Xb){const Cc=this.YUl(Q,Ca,sb);Q=this.uym(Q,Ca,sb);Ca=this.a_e.Ec(Q).returnValue;
Cc&&!Ca&&(this.rMi(Xb),wa.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.L6f));Cc||this.a_e.W(Q,this.uB())}}Object(f.a)(Tg,"ARenamedFileChecker",null,[1065]);class jh extends Tg{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe){super(Q,Ca,sb,Xb,Cc,jd);this.NMi=(Me,zf)=>{zf&&zf.lWb&&zf.ejj&&(zf.IXa("BreadcrumbDocName")||zf.IXa("BreadcrumbFolderName")||zf.IXa("BreadcrumbFolderUrl")||zf.IXa("DirectInvokeDAVUrl")||zf.IXa("EditDocInClientUrl"))&&(wa.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",
this.L6f),this.Pkg(zf))};this.EO=Cc;this.sLk=dd;this.TUe=oe}get L6f(){return"RenamedFileCheckerUsingSettingsRefresh"}BFg(){this.EO.WSc(this.NMi)}WYj(){this.EO.jtg(this.NMi)}aMh(Q){if(Q&&Q.lWb){const Ca=Q.lWb;this.Foj(Ca.jb("BreadcrumbFolderName"),Ca.jb("BreadcrumbFolderUrl"),Ca.jb("BreadcrumbDocName"),Q)}}rMi(Q){const Ca={OperationResult:0,classId:1};Q=Q.lWb;Ca.BreadcrumbFolderName=Q.jb("BreadcrumbFolderName");Ca.BreadcrumbFolderUrl=Q.jb("BreadcrumbFolderUrl");Ca.DirectInvokeDavUrl=Q.jb("DirectInvokeDAVUrl");
Ca.EditDocInClientUrl=Q.jb("EditDocInClientUrl");Q=Q.jb("BreadcrumbDocName");Ca.NewName=m.AFrameworkApplication.e0d?Q:ab.a.FL(Q);this.TUe.execute(sb=>{this.ofn(Ca,sb)})}ofn(Q,Ca){this.sLk().Nfd(Q,Ca)}}Object(f.a)(jh,"RenamedFileCheckerUsingSettingsRefresh",Tg,[]);class xg extends Tg{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf){super(Q,sb,Xb,Cc,jd,Me);this.JOc=this.xk=null;this.EJk=Ca;this.ga=dd;this.Gb=oe;zf&&zf.execute(uh=>{this.Xyo(uh)})}get L6f(){return"RenamedFileCheckerUsingTask"}Xyo(Q){this.xk=
Q;this.xk.WHa(Object(O.a)(this,this.Q_,"handleVisibilityChange"))}Q_(Q,Ca){!this.Ns||0!==Ca.newState&&1!==Ca.newState||this.JOc||(this.BFg(),this.Pkg(this.JOc))}BFg(){this.JOc=new cd.a(3,2,this.EJk(),Object(O.a)(this,this.Pkg,"performRenameFileCheckTick"),89);this.Gb.Yb(this.JOc)}WYj(Q){this.Gb.uf(Q)}aMh(Q){this.xk&&2===this.xk.DA?this.UAo(Q):m.AFrameworkApplication.nVa(Object(O.a)(this,this.Xsc,"onRefreshFilenameSuccess"),Object(O.a)(this,this.Dne,"onRefreshFilenameFailure"),!0)}UAo(Q){this.Gb.uf(Q);
this.JOc=null}Xsc(Q){Q&&this.Foj(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl,Q.NewName,null)}rMi(){this.ga.Ob(x.a.OOb,2)}Dne(){}}Object(f.a)(xg,"RenamedFileCheckerUsingTask",Tg,[]);var Of=d(77);class Zh{constructor(){this.Ga=this.Z=null;this.nz=()=>{const Q=m.AFrameworkApplication.ta.Hb.KN;m.AFrameworkApplication.M$c()&&Nf.instance.initialize(m.AFrameworkApplication.U2d,Q?null:m.AFrameworkApplication.Khi,Q?null:m.AFrameworkApplication.GEj||CommonUIStrings.l_RenameFileTooltip)&&(this.Z.register(el,
"Common.App.Rename.RenameProps").as(1071).Sd(()=>new el(()=>m.AFrameworkApplication.LNg,()=>m.AFrameworkApplication.tw,m.AFrameworkApplication.Ykd,m.AFrameworkApplication.M$c,new bc.a(()=>m.AFrameworkApplication.Ln))).ha(),Db.instance.Wb(),this.Ga.$("RenameDialogIsEnabled")&&(this.Z.resolve(1540).initialize(m.AFrameworkApplication.Ht,m.AFrameworkApplication.U2d),this.Z.resolve(1541).Wb()),this.Z.resolve(1542).Wb(),m.AFrameworkApplication.Ykd&&this.Z.resolve(1539).enable(),this.Z.resolve(1542).x_k())}}get name(){return"Common.App.RenameFile"}uc(Q){this.Z=
Q;this.Ga=m.AFrameworkApplication.J;this.Z.register(sf,"Common.App.Rename.RenameDialogActor").as(1541).Sd(()=>new sf(m.AFrameworkApplication.va,this.Z.rf(1543))).ha();this.Z.register(Fi,1540).as(1543).Sd(()=>new Fi(m.AFrameworkApplication.va)).ha();this.Z.register(1065,1539).Sd(()=>this.xKl()).ha();this.Z.register(mg,"Common.App.Rename.RenameFlyoutActor").as(1542).Sd(()=>new mg(m.AFrameworkApplication.va,Of.FocusManager.instance())).ha()}xKl(){if(this.Ga.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Q=
this.Z.Oa(1);if(Q&&Q.B1i)return new jh(()=>Q.fc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>m.AFrameworkApplication.Ht,()=>new Date,()=>m.AFrameworkApplication.Ln,Q,this.Z.Oa(117),()=>Db.instance,this.Z.Ra(7))}return new xg(()=>this.Ga.fc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ga.fc("RenamedFileCheckerPingIntervalInMs",12E4),()=>m.AFrameworkApplication.Ht,()=>new Date,()=>m.AFrameworkApplication.Ln,m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.oc,this.Z.Oa(117),
this.Z.Ra(103))}init(){this.Ga.xp(this.nz)}dispose(){}}Object(f.a)(Zh,"PackageManager",null,[0,1]);class Ei extends a.a{constructor(Q,Ca,sb){super(!1,!1,!0);this.YZb=(Xb,Cc)=>{if(1===Xb){Xb=Cc.ribbonLayoutChoice;const jd=Cc.showRibbonChoice;Cc.checkedNewLookToggle!==this.Mph&&appChrome.api.getToggleVNextLookHandler()();if(this.QCh!==Xb)appChrome.onRibbonModeToggle();this.yFh!==jd&&("AlwaysShow"===jd?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.Mph=Q;
this.QCh=Ca;this.yFh=sb}start(){this.gi("",this.YZb,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["checkedNewLookToggle"]:this.Mph,["ribbonLayoutChoice"]:this.QCh,["showRibbonChoice"]:this.yFh}})}}Object(f.a)(Ei,"RibbonSettingsDialog",a.a,[]);class Pf{constructor(Q){this.ga=Q}Wb(){this.ga.qa(x.a.Q$o,z.a.frame,this.R$o)}R$o(){let Q="SingleLineRibbon";const Ca=m.AFrameworkApplication.J.$("Fluent2StyleIsEnabled");"Multiline"===appChrome.selectors.getRibbonMode()&&(Q="ClassicRibbon");const sb=appChrome.selectors.getShyState().isActive?
"AutomaticallyHide":"AlwaysShow";(new Ei(Ca,Q,sb)).start();return 32}}Object(f.a)(Pf,"RibbonSettingsDialogActor",null,[1064]);class Gi{constructor(){this.Z=null}get name(){return"Common.App.RibbonSettings"}uc(Q){this.Z=Q;this.Z.register(Pf,"Common.App.RibbonSettings.RibbonSettingsDialogActor").as(1544).Sd(()=>new Pf(m.AFrameworkApplication.va)).ha()}init(){const Q=this.Z.Oa(1544);Q?Q.Wb():R.b(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){K.a.instance.Mc(new Gi)}}
Object(f.a)(Gi,"RibbonSettingsPackage",null,[0,1]);class Xk{static get lh(){return a.a.ry(Xk.Qn,CommonUIStrings.l_SaveACopyFileName)}}Xk.Qn="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(f.a)(Xk,"FileNameDialogHtml",
null,[]);class Sf extends a.a{constructor(Q,Ca,sb,Xb){super();this.JBd=this.dRa=null;this.ga=Q;this.xwa=Ca;this.Vbc=sb;this.Qe(1,CommonUIStrings.l_SaveButtonLabel);this.lh=Xk.lh;this.Pg="FileNameDialog-SaveACopy";this.Ah=Xb}EJa(Q,Ca,sb){this.JBd=Q;this.dRa=sb;Q={["txtFileName"]:ab.a.FL(m.AFrameworkApplication.Ht.HA),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,Ca)};this.gi(CommonUIStrings.l_SaveToOneDrive,Object(O.a)(this,this.T2d,"fileNameDialogHandler"),Q);wa.ULS.sendTraceTag(7174148,
216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}T2d(Q,Ca){1!==Q?wa.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Q=Ca.txtFileName.trim(),wa.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),Ca=ab.a.ola(m.AFrameworkApplication.fileName),Q&&""!==Q&&""!==Ca&&(Q+=Ca),this.Vbc.xEa(this.JBd,this.dRa,Q,this.Ah))}}Object(f.a)(Sf,"FileNameDialog",a.a,[1108]);class Pi{constructor(Q,
Ca,sb){this.ga=Q;this.xwa=Ca;this.Vbc=sb}create(Q){return new Sf(this.ga,this.xwa,this.Vbc,Q)}}Object(f.a)(Pi,"FileNameDialogFactory",null,[1080]);class El extends Hg.StandardDialog{constructor(Q){super();this.Gvg=Ca=>{1===Ca?(wa.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.Ob(x.a.Udb,2)):wa.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};this.Ed=1;this.Qe(1,CommonUIStrings.l_RetryButtonLabel);this.Qe(0,CommonUIStrings.l_DialogClose);this.ga=Q}oR(Q){wa.ULS.sendTraceTag(7165652,
216,50,"Show error dialog here {0}.",Q);this.Iy(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,this.Gvg)}}Object(f.a)(El,"RetryDialog",Hg.StandardDialog,[1077]);var Kh=d(1162);class Vi{}Vi.Wdb="SaveToCloudStorage";Vi.Udb="SaveACopy";Object(f.a)(Vi,"SaveToCloudStorageConstants",null,[]);class Bj{constructor(Q,Ca,sb,Xb){this.mLd=null;this.NMk=Q;this.Ga=sb;this.Sxh=Ca;this.rth=new v.a;this.Zd=Xb}Fpc(){return this.Ga.$("SaveToCloudStorageUIIsEnabled")}sqb(){return x.a.Wdb}tUd(){fd.a.Bte(Object(O.a)(this,
this.YJj,"saveToCloudActionDispatcher"));fd.a.E_c([new Kh.a(x.a.Wdb,z.a.frame,0)],this.Sxh.Lkc())}Wb(){const Q=this.Sxh.Lkc();Q?(Q.n2(()=>{this.rth.hg(!0)}),this.tUd()):wa.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}Lzj(){wa.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}YJj(Q,Ca,sb,Xb,Cc){Xb=m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb&&1===m.AFrameworkApplication.ta.Hb.Uk;var jd="";switch(Q){case x.a.Wdb:jd=
Vi.Wdb;break;case x.a.Udb:jd=Vi.Udb;break;default:wa.ULS.sendTraceTag(508372377,216,50,"SaveToCloudStorageActor Entry Point other than SaveToCloudStorage or SaveACopy")}if(Ca.contextId!==z.a.frame||Q!==this.sqb())return 2;if(!this.Fpc())return 8;if(1===sb)return Ke.SessionStatusManager.instance.Nk||m.AFrameworkApplication.wta?8:32;if(2===sb){this.Lzj();const dd=Xb&&jd===Vi.Wdb&&null===Cc&&m.AFrameworkApplication.J.$("FilePickerSkip_AfterSignIn_Fix")?{}:Cc;dd&&m.AFrameworkApplication.J.$("EntryPoint_SaveToCloudStorage")&&
(dd.SaveEntryPoint=jd);dd&&dd.FileDownloadUrl&&wa.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there");this.Zd&&(this.mLd=this.Zd.Xf("DialogShown","SaveToOneDriveReponseTime"));this.rth.task.continueWith(()=>{this.mLd&&(this.mLd.stop(),this.mLd=null);this.NMk.start(dd)});return 32}return 8}}Object(f.a)(Bj,"SaveToCloudStorageActor",null,[1106]);class ci extends Bj{constructor(Q,Ca,sb,Xb){super(Q,Ca,sb,Xb);this.jIk=Ca}Fpc(){return this.Ga.$("SaveACopyBrsIsEnabled")}sqb(){return x.a.Udb}tUd(){fd.a.Bte(Object(O.a)(this,
this.YJj,"saveToCloudActionDispatcher"));fd.a.E_c([new Kh.a(x.a.Udb,z.a.frame,0)],this.jIk.Lkc())}Lzj(){m.AFrameworkApplication.nd("CreateCopy_cf;CreateCopy_tf");wa.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(f.a)(ci,"SaveACopyActor",Bj,[]);class Mg{}Mg.default=0;Object(f.a)(Mg,"SaveToCloudErrorCodes",null,[]);class ij{constructor(Q,Ca,sb,Xb,Cc,jd){this.Ah=null;this.JOk=Q;this.mya=Ca;this.Vbc=sb;this.Ga=Xb;this.C4b=Cc;this.xJ=jd}start(Q){this.Ah=Q;
var Ca=null!==this.Ah&&this.Ah.hasOwnProperty("SaveEntryPoint")&&this.Ah.SaveEntryPoint.toString()===Vi.Wdb;if("SharePointOnlineConsumer"===this.Ga.jb("FileSource")){const sb=Na.a.instance.resolve(1545);if(sb){sb.start(null,Q);return}}this.mya.D8c?(Q=Object(Xa.a)(String,m.AFrameworkApplication.sessionStartInfoSettings.Host),m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb&&1===m.AFrameworkApplication.ta.Hb.Uk&&Ca&&("Open From URL"===Q||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",
!1))?(wa.ULS.sendTraceTag(508852051,216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.Vbc.xEa("root","https://onedrive.live.com",null,this.Ah)):(wa.ULS.sendTraceTag(6590559,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb&&1===m.AFrameworkApplication.ta.Hb.Uk?15:50,"User is signed in. We will show file picker."),this.Ill())):(wa.ULS.sendTraceTag(6590560,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb&&1===m.AFrameworkApplication.ta.Hb.Uk?
15:50,"User is not signed in. We will show sign in dialog."),this.Y$o())}Y$o(){this.JOk.create().EJa()}vq(){this.xJ().oR(Mg.default)}Ill(){try{wa.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let Q={["client_id"]:this.Ga.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.C4b||2===this.C4b)Q={["client_id"]:this.Ga.appSettings.UploadToSkyDriveClientId};WL.init(Q);wa.ULS.sendTraceTag(6590562,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb&&1===m.AFrameworkApplication.ta.Hb.Uk?
15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(O.a)(this,this.ME,"onSuccess"),Object(O.a)(this,this.onFailure,"onFailure"))}catch(Q){wa.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Q,Q.stack),this.vq()}}ME(Q){wa.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Q&&Q.data&&Q.data.folders&&this.Vbc.xEa(Q.data.folders[0].id,Q.data.folders[0].urls.viewInBrowser,
null,this.Ah)}onFailure(Q){if(Q&&Q.error){if("user_canceled"===Q.error.code){wa.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}wa.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Q.error.code,Q.error.message)}else wa.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.vq()}}Object(f.a)(ij,"SaveToCloudManager",null,[1105]);class fl extends ij{constructor(Q,Ca,sb,Xb,Cc,jd,dd){super(Ca,sb,
Xb,Cc,jd,dd);this.lwk=Q}ME(Q){Q&&Q.data&&Q.data.folders?(wa.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.lwk.create(this.Ah).EJa(Q.data.folders[0].id,Q.data.folders[0].name,Q.data.folders[0].urls.viewInBrowser)):(wa.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.vq())}onFailure(Q){Q&&Q.error&&"user_canceled"===Q.error.code&&wa.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(Q)}vq(){wa.ULS.sendTraceTag(7205458,
216,50,"Error occur in Save A Copy Manager.");super.vq()}}Object(f.a)(fl,"SaveACopyManager",ij,[]);var Mi=d(181);class dk{constructor(Q,Ca,sb,Xb,Cc){this.dRa=this.ul=this.EEc=null;this.H1=!1;this.Ah=this.J5a=null;this.mcf=Q;this.t4a=Ca;this.xJ=sb;this.Bj=Xb;this.Zd=Cc}Neb(){this.Bj&&1===this.Bj.state||(this.ul=this.t4a(),this.ul.message=CommonUIStrings.l_CommentProgressTooltip,this.ul.Ed=5,this.ul.Gu=!1,this.ul.rM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Wra(){this.ul&&(this.ul.close(),this.ul=
null)}N8(){1!==m.AFrameworkApplication.ta.state&&this.xJ().oR(Mg.default)}lZb(){wa.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");la.a.Cn(this.dRa,la.a.owa(3),void 0,"UploadToCloudManager.RedirectToFolder")}kZb(Q){var Ca=null!==this.Ah&&this.Ah.hasOwnProperty("SaveEntryPoint")&&this.Ah.SaveEntryPoint.toString()===Vi.Wdb;m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb&&1===m.AFrameworkApplication.ta.Hb.Uk&&Ca&&(Q+="&wdsvodm=true");let sb=Ca=!1;m.AFrameworkApplication.J&&
(Ca=m.AFrameworkApplication.J.$("SaveACopyIsEnabledForUiHost"),sb=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"));wa.ULS.sendTraceTag(6654163,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb&&1===m.AFrameworkApplication.ta.Hb.Uk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,Ca);if(Ca&&sb){wa.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Xb={};Xb[Ie.a.ovc]="1";Xb[Ie.a.documentUrl]=
Q;m.AFrameworkApplication.DN().execute(Cc=>{Cc.sendMessage(ag.a.SNb,Xb)})}else la.a.Cn(Q,la.a.owa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}xEa(Q,Ca,sb=null,Xb=null){wa.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Zd&&(this.J5a=this.Zd.Xf("DialogShown","SaveToOneDriveUploadTime"));this.Neb();this.dRa=Ca;this.EEc=this.mcf.create(Q,sb,Xb);this.Ah=Xb;this.$ka()}$ka(){wa.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.EEc.execute(Object(O.a)(this,this.O4n,
"onSaveToCloudUploadFinished"),Object(O.a)(this,this.N4n,"onSaveToCloudUploadFailed"))}O4n(Q){this.Wra();this.H1=!1;if(Q&&Q.data&&Q.data.Ee){var Ca;if(({hv:Ca}=$a.d(Q.data.Ee)).returnValue)if(Q=Ca,Q.StatusCode!==Mi.a.xz&&Q.StatusCode!==Mi.a.kgc)wa.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.N8();else{wa.ULS.sendTraceTag(6590603,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb&&1===m.AFrameworkApplication.ta.Hb.Uk?15:50,"UploadToCloudManager upload success.");
try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.kZb(Q.NewDocumentUrl):this.lZb()}catch(sb){wa.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",sb.toString())}this.jhd()}else wa.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ib.a.tsd(Q.data.Ee)}),this.N8()}else wa.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.N8()}N4n(Q){5!==Q.data.status&&12!==Q.data.status||this.H1?(wa.ULS.sendTraceTag(6590605,
216,10,"UploadToCloudManager HTTP failure with code: {0}",Q.data.status),this.Wra(),this.N8(),this.jhd()):(wa.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.H1=!0,this.$ka())}jhd(){this.J5a&&(this.J5a.stop(),this.J5a=null)}}Object(f.a)(dk,"UploadToCloudManager",null,[1096]);class zg extends dk{constructor(Q,Ca,sb,Xb,Cc,jd){super(Ca,sb,Xb,Cc,jd);this.ga=Q}S0f(){return!!this.Ah&&!!this.Ah.SaveEntryPoint&&"VersionHistory"===this.Ah.SaveEntryPoint.toString()}N8(){wa.ULS.sendTraceTag(7205459,
216,50,"Display Error for Save A Copy.");this.S0f()&&this.ga.Pb(x.a.Oue,2,{["FailureReason"]:"Unknown"});super.N8()}lZb(){wa.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.S0f()&&this.ga.Ob(x.a.xld,2);super.lZb()}kZb(Q){wa.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",Q);this.S0f()&&this.ga.Ob(x.a.xld,2);super.kZb(Q)}$ka(){this.Ah&&"true"===this.Ah.SkipSaveToHost?super.$ka():32!==this.ga.Ob(x.a.t_b,1)?(wa.ULS.sendTraceTag(8741711,
216,15,"The save file change is not supported, this operation may result in data loss"),super.$ka()):this.ga.Pb(x.a.t_b,2,[()=>{wa.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");dk.prototype.$ka.call(this)},()=>{wa.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.N8()}])}}Object(f.a)(zg,"SaveACopyUploadToCloudManager",dk,[]);var Gf=d(755),Ag=d(1160);class Ti{constructor(){this.Z=null;this.nz=
()=>{m.AFrameworkApplication.J.$("SaveACopyBrsIsEnabled")&&this.Z.resolve(1546).Wb()}}get name(){return"Common.App.SaveACopy"}init(){m.AFrameworkApplication.J.xp(this.nz)}dispose(){}uc(Q){this.Z=Q;this.Z.register(zg,1548).Sd(()=>new zg(m.AFrameworkApplication.va,Q.resolve(1547),()=>(new Ag.a).create(),()=>new El(m.AFrameworkApplication.va),m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.$r)).ha();this.Z.register(Pi,1551).as("Common.App.SaveACopy.IFileNameDialogFactory").Sd(()=>new Pi(m.AFrameworkApplication.va,
m.AFrameworkApplication.ta.Hb,Q.resolve(1548))).ha();this.Z.register(ci,1546).Sd(()=>new ci(Q.resolve(1549),Q.resolve(1550),m.AFrameworkApplication.J,m.AFrameworkApplication.ta.$r)).ha();this.Z.register(fl,1549).Sd(()=>new fl(Q.resolve(1551),Q.resolve(1552),Gf.a.instance,Q.resolve(1548),m.AFrameworkApplication.J,m.AFrameworkApplication.a7,()=>new El(m.AFrameworkApplication.va))).ha()}static main(){K.a.instance.Mc(new Ti)}}Object(f.a)(Ti,"PackageManager",null,[0,1]);var em=d(42);class Eg extends Hg.StandardDialog{constructor(Q,
Ca){super();this.X9b=!1;this.GQ=null;this.Gvg=sb=>{1===sb?(wa.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.GQ?this.ga.Pb(x.a.Hmd,2,[this.GQ,this.X9b]):this.ga.Ob(x.a.Hmd,2)):wa.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};this.ga=Q;this.DHc=Ca;this.nOa=!1}oR(Q,Ca,sb){this.GQ=Ca;this.X9b=sb;wa.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,sb);Q=this.Bof(Q);0===Q?(this.Ed=6,this.Qe(0,CommonUIStrings.l_DialogClose)):
(this.Ed=0,this.Qe(1,CommonUIStrings.l_DialogClose));0===Q&&wa.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Iy(em.a.aNo,this.Qqm(Q),this.Pqm(Q,Ca),this.Gvg,!0)}Bof(Q){return 0>Q||6<Q?(wa.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",Q),0):Q}Pqm(Q,Ca){Q=this.Bof(Q);return this.DHc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,
Ca),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,Ca),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}Qqm(Q){Q=this.Bof(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}Object(f.a)(Eg,"ErrorRetryDialog",Hg.StandardDialog,[1247]);class Md{constructor(Q,Ca){this.Ga=Q;this.ga=Ca;this.DHc=this.Ga.$("SaveToHostWithExtraCharsInFileName")}create(){return new Eg(this.ga,this.DHc)}}Object(f.a)(Md,"ErrorRetryDialogFactory",null,[1215]);class Re extends a.a{constructor(Q,Ca,sb,Xb,Cc,jd,dd=null){super();this.T9=null;this.ga=Ca;
this.xwa=Xb;this.K5a=jd;this.Ga=Q;this.xJ=Cc;this.Bj=sb;this.DHc=this.Ga.$("SaveToHostWithExtraCharsInFileName");this.Ah=dd;this.Qe(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.Bj}rgi(Q,Ca){this.tva(1,!!Q&&Q!==Ca);this.T9=document.getElementById(Re.Mni);aa.a.addHandler(this.T9,"change",Object(O.a)(this,this.Eme,"onFileNameChange"));aa.a.addHandler(this.T9,"input",Object(O.a)(this,this.Eme,"onFileNameChange"));this.T9.focus()}Lni(Q){return this.DHc?(new RegExp("["+this.wli('\\/:*?"<>|')+
"]")).test(Q):(new RegExp("["+this.wli('\\/:*?"<>|#{}%~&')+"]")).test(Q)}wli(Q){return Q.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}QRf(){const Q=ab.a.FL(m.AFrameworkApplication.Ht.HA);this.tva(1,!!this.T9&&""!==this.T9.value&&this.T9.value!==Q)}Eme(){this.T9&&window.setTimeout(()=>{this.QRf()},0)}T2d(Q,Ca){if(1!==Q)wa.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Q=Ca[Re.Mni];Ca=Re.Oqj in Ca?Ca[Re.Oqj]:!1;wa.ULS.sendTraceTag(23881883,
216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",ab.a.kAj(Q),Ca);const sb=ab.a.ola(m.AFrameworkApplication.fileName);(Q=Q?Q.trim():null)&&""!==Q&&""!==sb||1===this.ta.state?this.Lni(Q)?this.xJ.create().oR(1,Q,Ca):this.K5a.xEa(Q+sb,Ca,this.Ah):this.xJ.create().oR(2,Q,Ca)}}dispose(){this.T9&&(aa.a.removeHandler(this.T9,"change",Object(O.a)(this,this.Eme,"onFileNameChange")),aa.a.removeHandler(this.T9,"input",Object(O.a)(this,this.Eme,"onFileNameChange")),this.T9=
null);super.dispose()}}Re.Mni="txtFileName";Re.Oqj="chkOverwrite";Object(f.a)(Re,"FileNameDialogBase",a.a,[]);class Vm{static get lh(){return a.a.ry(Vm.Qn,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}Vm.Qn="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(f.a)(Vm,"FileNameDialogHtml",null,[]);class um extends Re{constructor(Q,Ca,sb,Xb,Cc,jd){super(Q,Ca,sb,Xb,Cc,jd);this.lh=Vm.lh;this.Pg="FileNameDialog-SaveAsToHost"}EJa(Q,Ca){const sb=ab.a.FL(m.AFrameworkApplication.Ht.HA);Ca={["txtFileName"]:Q||sb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:Ca};this.gi(CommonUIStrings.L_SaveAs,Object(O.a)(this,this.T2d,"fileNameDialogHandler"),Ca);this.rgi(Q,sb)}}Object(f.a)(um,"FileNameDialog",Re,[1248]);class ce{constructor(Q,Ca,
sb,Xb,Cc,jd){this.ga=Ca;this.Ga=Q;this.xwa=Xb;this.K5a=jd;this.xJ=Cc;this.Bj=sb}create(){return new um(this.Ga,this.ga,this.Bj,this.xwa,this.xJ,this.K5a)}}Object(f.a)(ce,"FileNameDialogFactory",null,[1216]);class nd{constructor(Q,Ca,sb){this.FJj=(Xb,Cc,jd,dd,oe)=>Cc.contextId!==z.a.frame||Xb!==x.a.Hmd?2:this.Ga.$("SaveAsToHostBrsIsEnabled")?1===jd?Ke.SessionStatusManager.instance.Nk||m.AFrameworkApplication.wta?8:32:2===jd?(wa.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),
Xb=this.tSe.create(),oe&&Object.getType(oe)===Array&&2===oe.length?Xb.EJa(oe[0],!!oe[1]):Xb.EJa(null,!1),32):8:8;this.K5a=sb;this.tSe=Ca;this.Ga=Q}Wb(){2===m.AFrameworkApplication.ta.Hb.Uk?m.AFrameworkApplication.va.fb(x.a.Hmd,z.a.frame,this.FJj,4):m.AFrameworkApplication.va.qa(x.a.Hmd,z.a.frame,this.FJj)}}Object(f.a)(nd,"SaveAsToHostActor",null,[]);class Sk{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe){this.ul=null;this.X9b=this.H1=!1;this.J5a=this.Ah=this.GQ=null;this.Ga=Ca;this.Fqa=this.Ga.appSettings.SaveAsToHostWebServiceBase;
this.Jnh=Xb;this.t4a=Cc;this.Gf=sb;this.xJ=jd;this.Zd=oe;this.Bj=dd;this.ga=Q;this.T2a=Ca.jb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Neb(){1!==this.Bj.state&&(this.ul=this.t4a(),this.ul.message=CommonUIStrings.l_CommentProgressTooltip,this.ul.Ed=5,this.ul.Gu=!1,this.ul.rM(CommonUIStrings.l_DefaultDialogTitle,null,null))}N8(Q=0){1!==this.Bj.state&&this.xJ.create().oR(Q,ab.a.FL(this.GQ),this.X9b)}lZb(){const Q=this.Ga.appSettings.BreadcrumbFolderUrl;wa.ULS.sendTraceTag(8194016,216,50,
"Redirecting to OneDrive for business Folder.");la.a.Cn(Q,la.a.owa(3),void 0,"UploadToHostManager.RedirectToFolder")}kZb(Q){let Ca=!1,sb=!1;this.Ga&&(Ca=this.Ga.$("SaveACopyIsEnabledForUiHost"),sb=this.Ga.$("UiHostSupportsDocRebootFeatures"));wa.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",Q,Ca,sb);if(Ca&&sb){wa.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Xb=
{};Xb[Ie.a.ovc]="1";Xb[Ie.a.documentUrl]=Q;Xb[Ie.a.reason]=uf.a.Mwg;m.AFrameworkApplication.DN().execute(Cc=>{Cc.sendMessage(ag.a.SNb,Xb)})}else Ca&&!sb&&m.AFrameworkApplication.IN?la.a.Cn(Q,la.a.owa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):la.a.Cn(Q,la.a.owa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}xEa(Q,Ca,sb=null){wa.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.Jnh&&!this.Jnh()&&this.Gf&&(this.Zd&&(this.J5a=this.Zd.Xf("DialogShown","SaveAsToHostUploadTime")),
this.Neb(),this.X9b=Ca,this.GQ=Q,(this.Ah=sb)&&"true"===this.Ah.SkipSaveToHost?this.X1d():this.$ka())}$ka(){32!==this.ga.Ob(x.a.t_b,1)?(wa.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.X1d()):this.ga.Pb(x.a.t_b,2,[()=>{wa.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.X1d()},(Q,Ca)=>{wa.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.N8(Ca)}])}M6n(Q){this.Wra();this.H1=!1;if(Q&&Q.data&&Q.data.Ee)if(({hv:Ca}=$a.d(Q.data.Ee)).returnValue)if(Q=Ca,Q.StatusCode!==Mi.a.xz&&Q.StatusCode!==Mi.a.kgc){wa.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Ca={};Ca.FailureReason=Q.StatusCode.toString();Ca.ExtraInfo=Q.ExtraInfo;this.f_a(Ca);this.N8(parseInt(Q.ExtraInfo))}else{wa.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.pug();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?
this.kZb(Q.NewDocumentUrl):this.lZb()}catch(sb){wa.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",sb.toString())}this.jhd()}else wa.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ib.a.tsd(Q.data.Ee)}),this.f_a({["FailureReason"]:"Failed to deserialize response"}),this.N8();else wa.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.f_a({["FailureReason"]:"null response"}),this.N8()}L6n(Q){5!==Q.data.status&&
12!==Q.data.status||this.H1?(wa.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,["HttpStatus"]:Q.data.He}),this.f_a({["FailureReason"]:Q.data.He.toString()}),this.Wra(),this.N8(),this.jhd()):(wa.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.H1=!0,this.Ah&&"true"===this.Ah.SkipSaveToHost?this.X1d():this.$ka())}Wra(){this.ul&&(this.ul.close(),this.ul=null)}jhd(){this.J5a&&(this.J5a.stop(),this.J5a=
null)}pug(){this.Ah&&"VersionHistory"===this.Ah.SaveEntryPoint&&this.ga.Ob(x.a.xld,2)}f_a(Q){this.Ah&&"VersionHistory"===this.Ah.SaveEntryPoint&&this.ga.Pb(x.a.Oue,2,Q)}X1d(){let Q=this.Fqa+this.T2a;Q=Za.a.pq(Q,"qs",ab.a.ej(m.AFrameworkApplication.xm));Q=Za.a.pq(Q,"n",ab.a.ej((new Date).getTime().toString()));Q=Za.a.pq(Q,"ov",ab.a.ej(this.X9b.toString()));Q=Za.a.pq(Q,"fn",ab.a.ej(this.GQ));this.Ah&&this.Ah.FileDownloadUrl&&(Q=Za.a.pq(Q,"furl",ab.a.ej(this.Ah.FileDownloadUrl)));this.Gf.Xj(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},
!1,2,Object(O.a)(this,this.M6n,"onUploadFinished"),Object(O.a)(this,this.L6n,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(f.a)(Sk,"UploadToHostManager",null,[1214]);class tg{constructor(){this.Z=null;this.nz=()=>{m.AFrameworkApplication.J.$("SaveAsToHostBrsIsEnabled")&&this.Z.resolve(1553).Wb()}}get name(){return"Common.App.SaveAsToHost"}init(){m.AFrameworkApplication.J.xp(this.nz)}uc(Q){this.Z=Q;this.Z.register(Md,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as(1554).Sd(()=>
new Md(m.AFrameworkApplication.J,m.AFrameworkApplication.va)).ha();this.Z.register(Sk,1555).as(1564).Sd(()=>new Sk(m.AFrameworkApplication.va,m.AFrameworkApplication.J,m.AFrameworkApplication.Ge,()=>m.AFrameworkApplication.Xl,()=>(new Ag.a).create(),Q.resolve(1554),m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.$r)).ha();this.Z.register(ce,1556).as("Common.App.SaveAsToHost.IFileNameDialogFactory").Sd(()=>new ce(m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.ta,
m.AFrameworkApplication.ta.Hb,Q.resolve(1554),Q.resolve(1555))).ha();this.Z.register(nd,1553).Sd(()=>new nd(m.AFrameworkApplication.J,Q.resolve(1556),Q.resolve(1555))).ha()}dispose(){}static main(){K.a.instance.Mc(new tg)}}Object(f.a)(tg,"SaveAsToHostPackage",null,[0,1]);class Bk extends Hg.StandardDialog{constructor(){super();this.Ed=0;this.Qe(1,CommonUIStrings.l_DialogClose)}oR(Q){this.Iy(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(f.a)(Bk,"ErrorDialog",
Hg.StandardDialog,[1077]);var jj=d(204);class af extends Hg.StandardDialog{constructor(Q,Ca,sb){super();this.Ian=Xb=>{0===Xb?(wa.ULS.sendTraceTag(6590598,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb&&1===m.AFrameworkApplication.ta.Hb.Uk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.$pe()};this.Coj=()=>{this.qma&&this.hide();wa.ULS.sendTraceTag(7143885,216,m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb&&1===m.AFrameworkApplication.ta.Hb.Uk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");
this.ga.Ob(x.a.Wdb,2)};this.ga=Q;this.mya=Ca;this.xwa=sb;this.zda=!1;this.Ed=1;this.xY(1);this.Qe(1,CommonUIStrings.l_SignIn);this.Qe(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}EJa(){this.mya.nPh(this.Coj);this.Mx(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,this.Ian)}xpl(){let Q="2";if(this.xwa)switch(this.xwa.Uk){case 3:Q="0";break;case 2:Q="3";break;case 1:Q="1"}return Q}hide(){this.mya.SCo(this.Coj);super.hide()}$pe(){var Q=m.AFrameworkApplication.J.$("SignInAspxInWebAppsPortalIsEnabled")?
"/start/signin.aspx":"Signin.aspx";Q=new jj.QueryStringBuilder(Q);Q.Ae("prompt","1");Q.Ae("cbcxt",this.xpl());m.AFrameworkApplication.Oja(Q);la.a.Cn(Q.toString(),"LoginWindow",void 0,"SignInDialog")}}Object(f.a)(af,"SignInDialog",Hg.StandardDialog,[1251]);class di{constructor(Q,Ca,sb){this.ga=Q;this.mya=Ca;this.xwa=sb}create(){return new af(this.ga,this.mya,this.xwa)}}Object(f.a)(di,"SignInDialogFactory",null,[1218]);class Fl{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.Fqa=Q;this.GQ=Ca;this.l7b=sb;this.JBd=
Xb;this.w5e=Cc;this.T2a=jd;this.Ah=dd}execute(Q,Ca){if(!m.AFrameworkApplication.Xl&&m.AFrameworkApplication.Ge){var sb=this.Fqa+this.T2a;sb=Za.a.pq(sb,"fo",ab.a.ej(this.JBd));sb=Za.a.pq(sb,"fn",ab.a.ej(this.GQ));sb=Za.a.pq(sb,"qs",ab.a.ej(this.w5e));sb=Za.a.pq(sb,"n",ab.a.ej((new Date).getTime().toString()));this.Ah&&this.Ah.FileDownloadUrl&&(sb=Za.a.pq(sb,"furl",ab.a.ej(this.Ah.FileDownloadUrl)));this.l7b&&(sb=Za.a.pq(sb,"fnn",ab.a.ej(this.l7b)));m.AFrameworkApplication.Ge.Xj(sb,1,"",{"Content-Type":"application/json; charset=utf-8"},
!1,2,Q,Ca,null)}}}Object(f.a)(Fl,"SkyDriveUploadCaller",null,[1249]);class kh{constructor(Q){this.Ga=Q;this.MJb=Q.appSettings.SkyDriveUploadWebServiceBase;this.GQ=Q.appSettings.FileName;this.T2a=Q.jb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Q,Ca,sb){return new Fl(this.MJb,this.GQ,Ca,Q,m.AFrameworkApplication.xm,this.T2a,sb)}}Object(f.a)(kh,"SkydriveUploadCallerFactory",null,[1217]);class Xf{constructor(){this.Z=null}get name(){return"Common.App.SaveToCloudStorage"}init(){m.AFrameworkApplication.J.$("SaveToCloudStorageUIIsEnabled")&&
this.Z.resolve(1557).Wb()}dispose(){}uc(Q){this.Z=Q;this.Z.register(di,1552).as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Sd(()=>new di(m.AFrameworkApplication.va,Gf.a.instance,m.AFrameworkApplication.ta.Hb)).ha();this.Z.register(kh,1547).as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Sd(()=>new kh(m.AFrameworkApplication.J)).ha();this.Z.register(Bj,1557).Sd(()=>new Bj(Q.resolve(1558),Q.resolve(1550),m.AFrameworkApplication.J,m.AFrameworkApplication.ta.$r)).ha();this.Z.register(dk,
1559).Sd(()=>new dk(Q.resolve(1547),()=>(new Ag.a).create(),()=>new Bk,m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.$r)).ha();this.Z.register(ij,1558).Sd(()=>new ij(Q.resolve(1552),Gf.a.instance,Q.resolve(1559),m.AFrameworkApplication.J,m.AFrameworkApplication.a7,()=>new Bk)).ha()}static main(){K.a.instance.Mc(new Xf)}}Object(f.a)(Xf,"PackageManager",null,[0,1]);class fh extends Hg.StandardDialog{constructor(){super();this.Ed=0;this.Qe(1,CommonUIStrings.l_DialogClose)}oR(Q,Ca){this.Pgi(Q,
Ca,em.a.cNo)}Pgi(Q,Ca,sb){wa.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",sb);this.Iy(sb,Q,Ca,null)}vyf(Q,Ca){wa.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Iy(em.a.eNo,Q,Ca,null,!0)}}Object(f.a)(fh,"ErrorDialog",Hg.StandardDialog,[1225]);class Cj{static get lh(){return a.a.ry(Cj.Qn,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Cj.Qn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(f.a)(Cj,"FileNameDialogHtml",null,[]);var Dj=d(93);class Vl extends Re{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe){super(Q,Ca,sb,Xb,Cc,jd,oe);this.djb=this.G7e=this.xT=null;this.xjl=CommonUIStrings.l_SaveToAnotherFolder;this.lh=Cj.lh;this.Pg="FileNameDialog-SaveToSharePoint";this.sPc=dd;this.wIk=oe}EJa(Q){const Ca=ab.a.FL(m.AFrameworkApplication.Ht.HA),sb=m.AFrameworkApplication.breadcrumbFolderName,Xb=m.AFrameworkApplication.breadcrumbBrandName,Cc={["txtFileName"]:Q||Ca};let jd=CommonUIStrings.L_SaveAs;
2===m.AFrameworkApplication.ta.Hb.Uk&&(jd=CommonUIStrings.L_SaveACopy);this.gi(jd,Object(O.a)(this,this.T2d,"fileNameDialogHandler"),Cc);this.rgi(Q,Ca);this.qxf.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");m.AFrameworkApplication.J.$("HideSaveToAnotherFolderButtonforUIHost")||(this.xT=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.G7e=ee.a.lSh(Q,this.xT,"anotherFolderDescribedBy"),this.xT.className=
"WACButton WACDialogButtonNormal",Q=!1,sb&&sb.length?(this.VMh(this.xT,this.G7e,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Xb,sb)),Q=this.TVk(Xb,sb)):this.VMh(this.xT,this.G7e,CommonUIStrings.l_CurrentOnlineFolder),this.SXk(this.xT),this.VVk(this.xT),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.xT,"SaveToAnotherLocationTwo"),wa.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.xT,
"SaveToAnotherLocationOne"),aa.a.addHandler(this.xT,S.a.click,Object(O.a)(this,this.hhg,"onSaveToAnotherLocationClick")),aa.a.addHandler(this.xT,S.a.kj,Object(O.a)(this,this.goj,"onSaveToAnotherLocationKeyDown")))}TVk(Q,Ca){let sb;sb=!1;const Xb=document.getElementById("currentLocation");Xb.innerText="";const Cc=this.wCi(Xb,Q),jd=this.wCi(Xb,Ca);let dd=255,oe=255;255<Cc+jd&&(dd=Math.max(238,408-Cc),oe=Math.max(170,408-jd),sb=!0);this.B_k(Xb,Q,oe,Ca,dd);return sb}wCi(Q,Ca){const sb=document.createElement("div");
sb.innerText=Ca;sb.style.visibility="hidden";Q.appendChild(sb);Ca=sb.clientWidth;Q.removeChild(sb);return Ca}B_k(Q,Ca,sb,Xb,Cc){Ca&&(this.UMh(Q,Ca,sb),this.s_k(Q));Xb&&this.UMh(Q,Xb,Cc)}UMh(Q,Ca,sb){const Xb=document.createElement("div");Xb.innerText=Ca;Xb.title=Ca;Xb.className="SaveToAnotherFolderBreadcrumb";Xb.style.maxWidth=sb.toString()+"px";Q.appendChild(Xb)}s_k(Q){const Ca=document.createElement("span");Ca.id="FolderSeparator";const sb=document.createElementNS("http://www.w3.org/2000/svg","svg");
sb.setAttribute("class","SeparatorCaret");const Xb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Xb.setAttribute("points","1 4 1 11 5 7.5");sb.appendChild(Xb);Ca.appendChild(sb);Q.appendChild(Ca)}VMh(Q,Ca,sb){sb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,sb);Ca&&(Ca.innerText=sb);Q.tabIndex=0;Q.setAttribute(ee.a.Sh,ee.a.X$)}VVk(Q){const Ca=document.createElement("span");Ca.id="anotherFolderText";Ca.innerText=this.xjl;Ca.className="AnotherFolderTextSpan";
Q.appendChild(Ca)}SXk(Q){const Ca=document.createElement("span");Ca.className="cui-img-cont-float cui-img-16by16 ";this.djb=document.createElementNS("http://www.w3.org/2000/svg","svg");this.djb.setAttribute("class","FolderIconSVG");const sb=document.createElementNS("http://www.w3.org/2000/svg","path");sb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.djb.appendChild(sb);Ca.appendChild(this.djb);Q.appendChild(Ca)}goj(Q){!Q||
Q.keyCode!==Dj.a.Tu&&Q.keyCode!==Dj.a.Xtd||this.hhg(Q)}hhg(){if(this.T9){const Q=ab.a.ola(m.AFrameworkApplication.fileName);let Ca=this.T9.value;this.hide();Ca&&""!==Ca&&""!==Q||1===this.ta.state?(""!==Q&&(Ca+=Q),this.Lni(Ca)?this.xJ.create().oR(1,Ca,!1):this.sPc.start(Ca,this.wIk)):this.xJ.create().oR(2,Ca,!1)}}$ol(Q){this.xT&&this.djb&&(Q?(this.xT.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.xT,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.djb,"DisabledFolderIconSVG")):(this.xT.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.xT,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.djb,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.xT,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.djb,"DisabledFolderIconSVG"))))}QRf(){super.QRf();this.$ol(!!this.T9&&""!==this.T9.value)}dispose(){this.xT&&(aa.a.removeHandler(this.xT,S.a.click,Object(O.a)(this,this.hhg,"onSaveToAnotherLocationClick")),aa.a.removeHandler(this.xT,S.a.kj,Object(O.a)(this,this.goj,
"onSaveToAnotherLocationKeyDown")),this.xT=null);super.dispose()}}Object(f.a)(Vl,"FileNameDialog",Re,[1252]);var kj=d(515),ql=d(277),Pl=d(1477),on=d(1687);class vl{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(f.a)(vl,"SaveAsDialogInput",null,[]);class co{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(f.a)(co,"SaveLocation",null,[]);var fm=d(91);class Hk{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me){this.x_e=
null;this.GQ="";this.Oqm=()=>{const zf=new hb.a;zf.add(this.Jpm());const uh=this.gMm();uh&&zf.addRange(uh);return Object.assign(new vl,{enableMoreLocations:!m.AFrameworkApplication.J.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.GQ,extension:ab.a.ola(this.rO.HA),saveLocations:zf.toArray(),scenario:"SaveToSharePoint"})};this.sPc=Q;this.xJ=Ca;this.Ah=Me;this.K5a=sb;this.Bj=Cc;this.rO=Xb;this.vJb=dd;this.Cac=oe;jd&&(this.x_e=new bc.a(()=>new Pl.a(jd.value,null)))}Jpm(){const Q=new kj.a(ql.a.vh());
Q.W("type","currentHost");return Object.assign(new co,{folderName:this.rO.breadcrumbFolderName,friendlyPath:this.rO.breadcrumbBrandName,properties:Q})}Qtn(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}gMm(){if(!this.x_e||!this.vJb)return null;var Q=this.x_e.value.NR("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.Kfj)return null;Q=Q.Kfj;const Ca=new hb.a;let sb=0,Xb=0;for(var Cc=0;Cc<Q.length;Cc++){var jd=
Q[Cc];if(!this.Qtn(jd))continue;sb++;if(!jd.sharepoint_info)continue;const dd=jd.url,oe=jd.sharepoint_info.site_url,Me=jd.title;jd=on.b(jd,m.AFrameworkApplication.isRtl);if(!(dd&&oe&&Me&&jd))continue;Xb++;const zf=new kj.a(ql.a.vh());zf.W("type","SharePoint");zf.W("siteUrl",oe);zf.W("folderUrl",dd);Xb++;Ca.add(Object.assign(new co,{folderName:Me,friendlyPath:jd,properties:zf}))}Cc=new Map;Cc.set("NumPlaces",Q.length.toString());Cc.set("NumSharepointPlaces",sb.toString());Cc.set("placesWithMetadata",
Xb.toString());va.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Cc);0<sb&&(Xb?.5>1*Xb/sb&&va.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):va.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return Ca}kJf(){const Q={};Q.inputPropsCallback=this.Oqm;return Q}EJa(Q){this.GQ=Q;this.GQ||(this.GQ=String.format(CommonUIStrings.l_SaveACopy_Filename,ab.a.FL(this.rO.HA)));
Q={["id"]:"SaveAsDialog",["bodyControls"]:this.kJf()};let Ca=CommonUIStrings.L_SaveAs;2===this.Bj.Hb.Uk&&(Ca=CommonUIStrings.L_SaveACopy);const sb=new a.a(!1,!1,!0);sb.Ed=1;sb.Pg="SaveAsDialog";sb.Qe(1,CommonUIStrings.l_SaveButtonLabel);sb.gi(Ca,Object(O.a)(this,this.ZMo,"saveAsDialogHandler"),Q)}h$o(Q,Ca){Q&&""!==Q&&""!==Ca||1===this.Bj.state?this.Ptn()?this.wDn(Q,Ca):(""!==Ca&&(Q+=Ca),this.sPc.start(Q,this.Ah)):(wa.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),
this.xJ.create().oR(2,Q,!1))}wDn(Q,Ca){va.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const sb=this.Cac.vtf(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.Cac.u6d(sb).then(Xb=>{if(Xb&&0<Xb.length){const Cc=Xb[0][Ie.a.qdo];Xb=Xb[0][Ie.a.rdo];if(""!==Cc&&""!==Xb)this.vJb.xEa(Xb,Q+Ca,Cc,this.Ah),va.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.xJ.create().oR(0,Q,!1);const jd=Tf.a.cH();jd&&(jd.set("SiteUrlAvailable",
""===Cc?"false":"true"),jd.set("FolderUrlAvailable",""===Xb?"false":"true"));va.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new fm.a,{extendedProperties:jd}))}}else this.xJ.create().oR(0,Q,!1),va.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Xb=>{"Canceled"===Xb?((Xb=Tf.a.cH())&&Xb.set("IsCanceled","true"),va.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new fm.a,{extendedProperties:Xb}))):
va.Health.instance.recordKpiFailure("SaveACopySFP",Xb,!1,!1,null)})}Ptn(){return this.Cac?this.Cac.c1f():(wa.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}ZMo(Q,Ca){if(Ca&&1===Q){Q=Ca.fileName;var sb=ab.a.ola(this.rO.HA);Ca.moreLocationsSelected&&this.h$o(Q,sb);if(Ca.locationCallback){var Xb=Ca.locationCallback();Xb?Xb.properties&&"currentHost"===Xb.properties.K("type")?this.K5a.xEa(Q+sb,!1,this.Ah):Xb.properties&&"SharePoint"===Xb.properties.K("type")?(Ca=Xb.properties.K("siteUrl"),
Xb=Xb.properties.K("folderUrl"),this.vJb.xEa(Xb,Q+sb,Ca,this.Ah)):wa.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):wa.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else wa.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(f.a)(Hk,"ReactSaveAsDialog",null,[1252]);class gn{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe=null,Me=null,zf=null){this.ga=Ca;this.Ga=Q;this.xwa=Xb;this.K5a=jd;this.xJ=Cc;this.Bj=sb;this.vDh=dd;this.bEk=oe;this.vJb=Me;this.Cac=
zf}create(Q){return this.Bj&&this.Bj.Hb.sH?new Hk(this.vDh,this.xJ,this.K5a,m.AFrameworkApplication.Ht,this.Bj,this.bEk,this.vJb,this.Cac,Q):new Vl(this.Ga,this.ga,this.Bj,this.xwa,this.xJ,this.K5a,this.vDh,Q)}}Object(f.a)(gn,"FileNameDialogFactory",null,[1224]);class Mm{constructor(Q,Ca,sb,Xb){this.mx=this.eNc=null;this.wQb=Cc=>{this.mx||3!==Cc.state||(this.mx=Cc)};this.MDb=Q;this.Bj=sb;this.DJk=Xb;this.Q2a=new bc.a(()=>new Pl.a(Ca.value,this.wQb))}get Bpj(){this.eNc||(this.Q2a.value.NR("Save As",
!0),this.mx&&this.mx.Tga&&this.mx.Tga.length&&(this.eNc=this.TDm(this.mx.Tga)));return this.eNc}start(Q){if(!this.Bpj)if(m.AFrameworkApplication.breadcrumbFolderUrl&&m.AFrameworkApplication.breadcrumbFolderUrl.length)this.eNc=m.AFrameworkApplication.breadcrumbFolderUrl;else return wa.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.mx),!1;const Ca=this.DJk();Ca.w$o();const sb=
Ca.NGm();if(!sb)return wa.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.MDb.start((Xb,Cc)=>{Ca.hide();Q(Xb,Cc)},()=>{this.onCancel(Ca)},sb,this.eNc);return!0}onCancel(Q){Q.hide();wa.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}TDm(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const Ca=Q.indexOf("/documents/");return-1!==Ca?Q.substring(0,Ca+1)+"_layouts/15/onedrive.aspx":""}}Object(f.a)(Mm,"OneDriveFilePickerHelper",null,
[1223]);class sk extends a.a{constructor(){super()}w$o(){this.dGc="FilePickerDialog";this.lh="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Pg="PickerDialog-MsoSp";this.showDialog("",null)}NGm(){return document.getElementById("FilePickerDiv")}$N(){}Yga(){}}Object(f.a)(sk,"PickerDialog",a.a,[1222]);class km{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.Ga=Q;this.tSe=sb;this.ga=Ca;this.sPc=Xb;this.MDb=Cc;this.dNc=jd;this.Lqk=dd}Wb(){const Q=this.MDb.Lkc();Q?kb.a.tta||this.Ga.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.fb(x.a.Cwc,z.a.frame,Object(O.a)(this,this.aKj,"saveToSharePointActionDispatcher"),64):(Q.wbb.continueWith(Ca=>{Ca.ij&&this.MDb.Zfg(Ca)}),this.tUd()):wa.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}tUd(){fd.a.Bte(Object(O.a)(this,this.aKj,"saveToSharePointActionDispatcher"));fd.a.E_c([new Kh.a(x.a.Cwc,z.a.frame,0)],this.MDb.Lkc())}get Fpc(){return this.Ga.$("SaveToAnotherFolderBrsIsEnabled")}get H_h(){return this.Ga.$("UserCanWriteRelative")}aKj(Q,
Ca,sb,Xb,Cc){return Ca.contextId!==z.a.frame||Q!==x.a.Cwc?2:this.Fpc&&(this.dNc.Bpj||this.H_h)?1===sb?Ke.SessionStatusManager.instance.Nk||m.AFrameworkApplication.wta?8:this.Lqk()?32:8:2===sb?(wa.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Cc&&Cc.SaveEntryPoint&&"VersionHistory"===Cc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.H_h?(wa.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.tSe.create(Cc).EJa(null)):(wa.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.sPc.start(null,Cc)),32):8:8}}Object(f.a)(km,"SaveToSharePointActor",null,[]);class jk{constructor(Q,Ca,sb,Xb){this.Ah=this.Qvh=null;this.vJb=Q;this.xJ=Ca;this.dNc=sb;this.Bj=Xb}start(Q,Ca){wa.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Qvh=Q;this.Ah=Ca;this.dNc.start((sb,Xb)=>{this.processResponse(sb,Xb)})||this.QDg()}processResponse(Q,Ca){if(Q)this.ME(Ca);else this.onFailure(Ca)}QDg(){1!==
this.Bj.state&&this.xJ().vyf(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}ME(Q){wa.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const Ca=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;let sb=null;if(Ca&&(sb=Q?this.tMm(Q):this.sMm(Ca))){this.vJb.xEa(Ca,this.Qvh,sb,this.Ah);return}wa.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!Ca,!sb)}wa.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.QDg()}sMm(Q){Q.endsWith("/")||(Q+="/");let Ca=0;for(let sb=0;sb<Q.length;sb++)if("/"===Q.charAt(sb)&&5===++Ca)return Q.substr(0,sb);return null}tMm(Q){Q.endsWith("/")&&(Q=Q.substring(0,Q.length-1));const Ca=Q.lastIndexOf("/");return-1!==Ca?Q.substring(0,Ca):null}onFailure(Q){wa.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");Q&&Q.error?wa.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",Q.error.errorCode,Q.error.message):wa.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.QDg()}}Object(f.a)(jk,"SaveToSharePointManager",null,[1221]);class gm{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe){this.Fqa=Q;this.GQ=Ca;this.l7b=Xb;this.w5e=jd;this.dRa=sb;this.WOk=Cc;this.T2a=dd;this.Ah=oe}execute(Q,Ca){if(!m.AFrameworkApplication.Xl&&
m.AFrameworkApplication.Ge){var sb=this.Fqa+this.T2a;sb=Za.a.pq(sb,"fu",ab.a.ej(this.dRa));sb=Za.a.pq(sb,"su",ab.a.ej(this.WOk));sb=Za.a.pq(sb,"fn",ab.a.ej(this.GQ));sb=Za.a.pq(sb,"n",ab.a.ej((new Date).getTime().toString()));this.Ah&&this.Ah.FileDownloadUrl&&(sb=Za.a.pq(sb,"furl",ab.a.ej(this.Ah.FileDownloadUrl)));sb=sb+"&"+this.w5e;this.l7b&&this.l7b.length?sb=Za.a.pq(sb,"fnn",ab.a.ej(this.l7b)):wa.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");wa.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");m.AFrameworkApplication.Ge.Xj(sb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,Ca,null,void 0,void 0,void 0,void 0,"9")}}}Object(f.a)(gm,"SharePointSaveAsCaller",null,[1250]);class wi{constructor(Q){this.MJb=Q.appSettings.SaveAsToHostWebServiceBase;this.GQ=Q.appSettings.FileName;this.T2a=Q.jb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Q,Ca,sb,Xb){return new gm(this.MJb,this.GQ,Q,Ca,sb,m.AFrameworkApplication.xm,
this.T2a,Xb)}}Object(f.a)(wi,"SharePointUploadCallerFactory",null,[1219]);var Nm=d(1261);class Ej{constructor(Q,Ca,sb,Xb,Cc){this.ul=this.EEc=null;this.sKe=!1;this.A7e=this.dRa=null;this.mcf=Ca;this.t4a=sb;this.xJ=Xb;this.Bj=Cc;this.ga=Q}xEa(Q,Ca,sb,Xb){this.sKe=!1;wa.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Neb();this.dRa=Q;Xb&&Xb.SaveEntryPoint&&(this.A7e=Xb.SaveEntryPoint);this.EEc=this.mcf.create(Q,Ca,sb,Xb);Xb&&"true"===Xb.SkipSaveToHost?
this.$ka():this.Jdm()}Jdm(){const Q=()=>{wa.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.$ka()};32!==this.ga.Pb(x.a.t_b,2,[()=>{wa.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.$ka()},Q])&&Q()}$ka(){wa.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.EEc.execute(Object(O.a)(this,this.Q4n,"onSaveToSharePointUploadFinished"),Object(O.a)(this,this.P4n,
"onSaveToSharePointUploadFailed"))}Q4n(Q){if(Q&&Q.data&&Q.data.Ee){var Ca;if(({hv:Ca}=$a.d(Q.data.Ee)).returnValue)if(Ca.StatusCode!==Mi.a.xz&&Ca.StatusCode!==Mi.a.kgc)wa.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,Ca.StatusCode),Ca.StatusCode!==Mi.a.tug&&this.uhi(Q.data.status)||(this.f_a(Ca.StatusCode.toString()),this.k9o(Ca.StatusCode));else{wa.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.pug();try{Ca.NewDocumentUrl?this.kZb(Ca.NewDocumentUrl):this.lZb()}catch(sb){wa.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",sb.toString())}}else wa.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ib.a.tsd(Q.data.Ee)}),this.Z_d()||(this.f_a("Failed to deserialize response"),this.Ppd())}else wa.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.Z_d()||(this.f_a("Unknown"),this.Ppd())}P4n(Q){Q&&Q.data?this.uhi(Q.data.status)||
(wa.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.f_a(Nm.a[Q.data.status]),this.Ppd()):(wa.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.Z_d()||(this.f_a("Unknown"),this.Ppd()))}Z_d(){if(!this.sKe)return wa.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.sKe=!0,this.$ka(),!0;wa.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}uhi(Q){wa.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
Q);return this.Z_d()}lZb(){wa.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");la.a.Cn(this.dRa,la.a.owa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}kZb(Q){let Ca=!1,sb=!1;m.AFrameworkApplication.J&&(Ca=m.AFrameworkApplication.J.$("SaveACopyIsEnabledForUiHost"),sb=m.AFrameworkApplication.J.$("UiHostSupportsDocRebootFeatures"));wa.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,Ca);if(Ca&&sb){wa.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const Xb={};Xb[Ie.a.ovc]="1";Xb[Ie.a.documentUrl]=Q;Xb[Ie.a.reason]=uf.a.Mwg;m.AFrameworkApplication.DN().execute(Cc=>{Cc.sendMessage(ag.a.SNb,Xb)})}else la.a.Cn(Q,la.a.owa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Neb(){this.Bj&&1===this.Bj.state||(this.ul=this.t4a(),this.ul.message=CommonUIStrings.l_CommentProgressTooltip,this.ul.Ed=5,this.ul.Gu=!1,this.ul.rM(CommonUIStrings.l_DefaultDialogTitle,null,null))}Wra(){this.ul&&(this.ul.close(),this.ul=null)}Ppd(){this.vq(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}i$o(){this.vq(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}q9o(){const Q=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.vq(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,em.a.$Mo)}vq(Q,Ca,sb=em.a.dNo){wa.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,Ca);this.Wra();1!==this.Bj.state&&this.xJ().Pgi(Q,Ca,sb)}k9o(Q){wa.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
Q);switch(Q){case Mi.a.vEe:this.i$o();break;case Mi.a.tug:this.q9o();break;default:this.Ppd()}}pug(){"VersionHistory"===this.A7e&&this.ga.Ob(x.a.xld,2)}f_a(Q){"VersionHistory"===this.A7e&&this.ga.Pb(x.a.Oue,2,{["FailureReason"]:Q})}}Object(f.a)(Ej,"UploadToSharePointManager",null,[1220]);var wl=d(537),rl=d(136);class ug{constructor(){this.llb=this.g1e=this.Y0e=this.Z=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}uc(Q){this.Z=Q;this.Y0e=wl.a.iq(Q.Ra(806));this.g1e=wl.a.iq(Q.Ra(807));
this.llb=wl.a.iq(Q.Ra(1029));rl.Task.WAA.call(null,this.Y0e,this.g1e,this.llb).continueWith(()=>{this.Tuo()})}Tuo(){this.Z.register(wi,1560).as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Sd(()=>new wi(m.AFrameworkApplication.J)).ha();this.Z.register(Ej,1561).as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Sd(()=>new Ej(m.AFrameworkApplication.va,this.Z.resolve(1560),()=>(new Ag.a).create(),()=>new fh,m.AFrameworkApplication.ta)).ha();this.Z.register(jk,"Common.App.SaveToSharePoint.SaveToSharePointManager").as(1545).Sd(()=>
new jk(this.Z.resolve(1561),()=>new fh,this.Z.resolve(1562),m.AFrameworkApplication.ta)).ha();this.Z.register(Mm,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as(1562).Sd(()=>new Mm(this.Z.resolve(1563),new bc.a(()=>this.Y0e.result),m.AFrameworkApplication.ta,()=>new sk)).ha();this.Z.register(gn,1565).Sd(()=>new gn(m.AFrameworkApplication.J,m.AFrameworkApplication.va,m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.Hb,this.Z.resolve(1554),this.Z.resolve(1564),this.Z.resolve(1545),new bc.a(()=>
this.g1e.result),this.Z.resolve(1561),this.llb?this.llb.result:null)).ha();this.Z.register(km,1566).Sd(()=>new km(m.AFrameworkApplication.J,m.AFrameworkApplication.va,this.Z.resolve(1565),this.Z.resolve(1545),this.Z.resolve(1563),this.Z.resolve(1562),()=>m.AFrameworkApplication.ta.Sml)).ha();m.AFrameworkApplication.J.$("SaveToAnotherFolderBrsIsEnabled")&&this.Z.resolve(1566).Wb()}static main(){K.a.instance.Mc(new ug)}}Object(f.a)(ug,"PackageManager",null,[0,1]);class Yk{}Object(f.a)(Yk,"StringDifference",
null,[1226]);class te{constructor(Q,Ca){this.charCode=Q;this.description=Ca}}Object(f.a)(te,"UBTableEntry",null,[]);class Un{}new te(8,"C0 Controls 1");new te(9,"Horizontal tab (HT)");new te(10,"Line feed (LF)");new te(12,"C0 Controls 2");new te(13,"Carriage return (CR)");new te(31,"C0 Controls 3");new te(32,"Space");new te(47,"ASCII Punctuation and Symbols 1");new te(57,"ASCII Digits");new te(64,"ASCII Punctuation and Symbols 2");new te(90,"Uppercase Latin Alphabet");new te(96,"ASCII Punctuation and Symbols 3");
new te(122,"Lowercase Latin Alphabet");new te(127,"U+0000..U+007F Basic Latin");new te(159,"C1 Controls");new te(160,"NB Space");new te(191,"Latin-1 Punctuation and Symbols");new te(255,"U+0080..U+00FF Latin-1 Supplement");new te(383,"U+0100..U+017F Latin Extended-A");new te(591,"U+0180..U+024F Latin Extended-B");new te(687,"U+0250..U+02AF IPA Extensions");new te(767,"U+02B0..U+02FF Spacing Modifier Letters");new te(879,"U+0300..U+036F Combining Diacritical Marks");new te(1023,"U+0370..U+03FF Greek and Coptic");
new te(1279,"U+0400..U+04FF Cyrillic");new te(1327,"U+0500..U+052F Cyrillic Supplement");new te(1423,"U+0530..U+058F Armenian");new te(1535,"U+0590..U+05FF Hebrew");new te(1791,"U+0600..U+06FF Arabic");new te(1871,"U+0700..U+074F Syriac");new te(1919,"U+0750..U+077F Arabic Supplement");new te(1983,"U+0780..U+07BF Thaana");new te(2047,"U+07C0..U+07FF NKo");new te(2111,"U+0800..U+083F Samaritan");new te(2143,"U+0840..U+085F Mandaic");new te(2303,"U+08A0..U+08FF Arabic Extended-A");new te(2431,"U+0900..U+097F Devanagari");
new te(2559,"U+0980..U+09FF Bengali");new te(2687,"U+0A00..U+0A7F Gurmukhi");new te(2815,"U+0A80..U+0AFF Gujarati");new te(2943,"U+0B00..U+0B7F Oriya");new te(3071,"U+0B80..U+0BFF Tamil");new te(3199,"U+0C00..U+0C7F Telugu");new te(3327,"U+0C80..U+0CFF Kannada");new te(3455,"U+0D00..U+0D7F Malayalam");new te(3583,"U+0D80..U+0DFF Sinhala");new te(3711,"U+0E00..U+0E7F Thai");new te(3839,"U+0E80..U+0EFF Lao");new te(4095,"U+0F00..U+0FFF Tibetan");new te(4255,"U+1000..U+109F Myanmar");new te(4351,"U+10A0..U+10FF Georgian");
new te(4607,"U+1100..U+11FF Hangul Jamo");new te(4991,"U+1200..U+137F Ethiopic");new te(5023,"U+1380..U+139F Ethiopic Supplement");new te(5119,"U+13A0..U+13FF Cherokee");new te(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new te(5791,"U+1680..U+169F Ogham");new te(5887,"U+16A0..U+16FF Runic");new te(5919,"U+1700..U+171F Tagalog");new te(5951,"U+1720..U+173F Hanunoo");new te(5983,"U+1740..U+175F Buhid");new te(6015,"U+1760..U+177F Tagbanwa");new te(6143,"U+1780..U+17FF Khmer");new te(6319,
"U+1800..U+18AF Mongolian");new te(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new te(6479,"U+1900..U+194F Limbu");new te(6527,"U+1950..U+197F Tai Le");new te(6623,"U+1980..U+19DF New Tai Lue");new te(6655,"U+19E0..U+19FF Khmer Symbols");new te(6687,"U+1A00..U+1A1F Buginese");new te(6831,"U+1A20..U+1AAF Tai Tham");new te(7039,"U+1B00..U+1B7F Balinese");new te(7103,"U+1B80..U+1BBF Sundanese");new te(7167,"U+1BC0..U+1BFF Batak");new te(7247,"U+1C00..U+1C4F Lepcha");new te(7295,
"U+1C50..U+1C7F Ol Chiki");new te(7375,"U+1CC0..U+1CCF Sundanese Supplement");new te(7423,"U+1CD0..U+1CFF Vedic Extensions");new te(7551,"U+1D00..U+1D7F Phonetic Extensions");new te(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new te(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new te(7935,"U+1E00..U+1EFF Latin Extended Additional");new te(8191,"U+1F00..U+1FFF Greek Extended");new te(8303,"U+2000..U+206F General Punctuation");new te(8351,"U+2070..U+209F Superscripts and Subscripts");
new te(8399,"U+20A0..U+20CF Currency Symbols");new te(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new te(8527,"U+2100..U+214F Letterlike Symbols");new te(8591,"U+2150..U+218F Number Forms");new te(8703,"U+2190..U+21FF Arrows");new te(8959,"U+2200..U+22FF Mathematical Operators");new te(9215,"U+2300..U+23FF Miscellaneous Technical");new te(9279,"U+2400..U+243F Control Pictures");new te(9311,"U+2440..U+245F Optical Character Recognition");new te(9471,"U+2460..U+24FF Enclosed Alphanumerics");
new te(9599,"U+2500..U+257F Box Drawing");new te(9631,"U+2580..U+259F Block Elements");new te(9727,"U+25A0..U+25FF Geometric Shapes");new te(9983,"U+2600..U+26FF Miscellaneous Symbols");new te(10175,"U+2700..U+27BF Dingbats");new te(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new te(10239,"U+27F0..U+27FF Supplemental Arrows-A");new te(10495,"U+2800..U+28FF Braille Patterns");new te(10623,"U+2900..U+297F Supplemental Arrows-B");new te(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");
new te(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new te(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new te(11359,"U+2C00..U+2C5F Glagolitic");new te(11391,"U+2C60..U+2C7F Latin Extended-C");new te(11519,"U+2C80..U+2CFF Coptic");new te(11567,"U+2D00..U+2D2F Georgian Supplement");new te(11647,"U+2D30..U+2D7F Tifinagh");new te(11743,"U+2D80..U+2DDF Ethiopic Extended");new te(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");new te(11903,"U+2E00..U+2E7F Supplemental Punctuation");
new te(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new te(12255,"U+2F00..U+2FDF Kangxi Radicals");new te(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new te(12351,"U+3000..U+303F CJK Symbols and Punctuation");new te(12447,"U+3040..U+309F Hiragana");new te(12543,"U+30A0..U+30FF Katakana");new te(12591,"U+3100..U+312F Bopomofo");new te(12687,"U+3130..U+318F Hangul Compatibility Jamo");new te(12703,"U+3190..U+319F Kanbun");new te(12735,"U+31A0..U+31BF Bopomofo Extended");new te(12783,
"U+31C0..U+31EF CJK Strokes");new te(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new te(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new te(13311,"U+3300..U+33FF CJK Compatibility");new te(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new te(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new te(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new te(42127,"U+A000..U+A48F Yi Syllables");new te(42191,"U+A490..U+A4CF Yi Radicals");new te(42239,"U+A4D0..U+A4FF Lisu");new te(42559,
"U+A500..U+A63F Vai");new te(42655,"U+A640..U+A69F Cyrillic Extended-B");new te(42751,"U+A6A0..U+A6FF Bamum");new te(42783,"U+A700..U+A71F Modifier Tone Letters");new te(43007,"U+A720..U+A7FF Latin Extended-D");new te(43055,"U+A800..U+A82F Syloti Nagri");new te(43071,"U+A830..U+A83F Common Indic Number Forms");new te(43135,"U+A840..U+A87F Phags-pa");new te(43231,"U+A880..U+A8DF Saurashtra");new te(43263,"U+A8E0..U+A8FF Devanagari Extended");new te(43311,"U+A900..U+A92F Kayah Li");new te(43359,"U+A930..U+A95F Rejang");
new te(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new te(43487,"U+A980..U+A9DF Javanese");new te(43615,"U+AA00..U+AA5F Cham");new te(43647,"U+AA60..U+AA7F Myanmar Extended-A");new te(43743,"U+AA80..U+AADF Tai Viet");new te(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new te(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new te(44031,"U+ABC0..U+ABFF Meetei Mayek");new te(55215,"U+AC00..U+D7AF Hangul Syllables");new te(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");new te(56191,"U+D800..U+DB7F High Surrogates");
new te(56319,"U+DB80..U+DBFF High Private Use Surrogates");new te(57343,"U+DC00..U+DFFF Low Surrogates");new te(63743,"U+E000..U+F8FF Private Use Area");new te(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new te(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new te(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new te(65039,"U+FE00..U+FE0F Variation Selectors");new te(65055,"U+FE10..U+FE1F Vertical Forms");new te(65071,"U+FE20..U+FE2F Combining Half Marks");new te(65103,"U+FE30..U+FE4F CJK Compatibility Forms");
new te(65135,"U+FE50..U+FE6F Small Form Variants");new te(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new te(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new te(65535,"U+FFF0..U+FFFF Specials");new te(65663,"U+10000..U+1007F Linear B Syllabary");new te(65791,"U+10080..U+100FF Linear B Ideograms");new te(65855,"U+10100..U+1013F Aegean Numbers");new te(65935,"U+10140..U+1018F Ancient Greek Numbers");new te(65999,"U+10190..U+101CF Ancient Symbols");new te(66047,"U+101D0..U+101FF Phaistos Disc");
new te(66207,"U+10280..U+1029F Lycian");new te(66271,"U+102A0..U+102DF Carian");new te(66351,"U+10300..U+1032F Old Italic");new te(66383,"U+10330..U+1034F Gothic");new te(66463,"U+10380..U+1039F Ugaritic");new te(66527,"U+103A0..U+103DF Old Persian");new te(66639,"U+10400..U+1044F Deseret");new te(66687,"U+10450..U+1047F Shavian");new te(66735,"U+10480..U+104AF Osmanya");new te(67647,"U+10800..U+1083F Cypriot Syllabary");new te(67679,"U+10840..U+1085F Imperial Aramaic");new te(67871,"U+10900..U+1091F Phoenician");
new te(67903,"U+10920..U+1093F Lydian");new te(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new te(68095,"U+109A0..U+109FF Meoritic Cursive");new te(68191,"U+10A00..U+10A5F Kharoshthi");new te(68223,"U+10A60..U+10A7F Old South Arabian");new te(68415,"U+10B00..U+10B3F Avestan");new te(68447,"U+10B40..U+10B5F Inscriptional Parthian");new te(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new te(68687,"U+10C00..U+10C4F Old Turkic");new te(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");new te(69759,
"U+11000..U+1107F Brahmi");new te(69839,"U+11080..U+110CF Kaithi");new te(69887,"U+110D0..U+110FF Sora Sompeng");new te(69967,"U+11100..U+1114F Chakma");new te(70111,"U+11180..U+111DF Sharada");new te(71375,"U+11680..U+116CF Takri");new te(74751,"U+12000..U+123FF Cuneiform");new te(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new te(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new te(92735,"U+16800..U+16A3F Bamum Supplement");new te(94111,"U+16F00..U+16F9F Miao");new te(110847,"U+1B000..U+1B0FF Kana Supplement");
new te(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new te(119295,"U+1D100..U+1D1FF Musical Symbols");new te(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new te(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new te(119679,"U+1D360..U+1D37F Counting Rod Numerals");new te(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new te(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new te(127023,"U+1F000..U+1F02F Mahjong Tiles");new te(127135,"U+1F030..U+1F09F Domino Tiles");
new te(127231,"U+1F0A0..U+1F0FF Playing Cards");new te(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new te(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new te(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new te(128591,"U+1F600..U+1F64F Emoticons");new te(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new te(128895,"U+1F700..U+1F77F Alchemical Symbols");new te(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");new te(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");
new te(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new te(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new te(917631,"U+E0000..U+E007F Tags");new te(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new te(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new te(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(f.a)(Un,"UnicodeBlocks",null,[1061]);class Wh{constructor(){this.Z=null}uc(Q){this.Z=Q;this.Z.register(Yk,"Common.App.SensitiveLogging.StringDifference").as(1567).ha();
this.Z.register(Un,"Common.App.SensitiveLogging.UnicodeBlocks").as(1568).ha()}get name(){return"Common.App.SensitiveLogging"}init(){this.Z.resolve(1567);this.Z.resolve(1568)}dispose(){}static main(){K.a.instance.Mc(new Wh)}}Object(f.a)(Wh,"SensitiveLoggingPackage",null,[0,1]);var cj;(function(Q){Q[Q.ofq=0]="myFiles";Q[Q.recent=1]="recent";Q[Q.GZp=2]="currentFolder";Q[Q.Itq=3]="yourPhone"})(cj||(cj={}));Object(f.b)("SharedFilePickerLandingLocation",cj);class Kf{constructor(Q){this.VRb=this.Guc=null;
this._initialized=!1;this.OTf=Q}K_c(Q){this._initialized||(Q.Gv(ag.a.tzj),Q.XE(ag.a.tzj,Object(O.a)(this,this.L3n,"onReceivedPickerResponse")),this._initialized=!0)}u6d(Q){return this.VRb=new Promise((Ca,sb)=>{const Xb={};Xb[Ie.a.pdo]=Q;this.Guc=(Cc,jd)=>{""===jd?(wa.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Ca(Cc)):("Canceled"===jd?wa.ULS.sendTraceTag(572548164,306,50,jd):wa.ULS.sendTraceTag(556901065,306,10,jd),sb(jd))};this.OTf.execute(Cc=>{this.K_c(Cc);Cc.sendMessage(ag.a.l8n,
Xb)})})}L3n(Q){this.Guc(Q.Values[Ie.a.mQo],void 0===Q.Values[Ie.a.Tkg]||null===Q.Values[Ie.a.Tkg]?"":Q.Values[Ie.a.Tkg])}c1f(){return m.AFrameworkApplication.J.$("UiHostCommonFilePicker")}vtf(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me=null){const zf={};zf[Ie.a.NPo]=Q;zf[Ie.a.titleText]=Ca;zf[Ie.a.Q5k]=sb;zf[Ie.a.R5k]=Xb;zf[Ie.a.T5k]=Cc;zf[Ie.a.LWl]=!0;zf[Ie.a.z8l]=jd;zf[Ie.a.tdo]=dd;zf[Ie.a.sdo]=cj[oe];C.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(zf[Ie.a.udo]="Dark");Me&&(null!=Me.mdc&&(zf[Ie.a.mdc]=
Me.mdc),null!=Me.Smc&&(zf[Ie.a.Smc]=Me.Smc));return zf}}Object(f.a)(Kf,"SharedFilePickerManager",null,[1060]);class nf{constructor(){this.Z=null}get name(){return"Common.App.SharedFilePicker"}uc(Q){this.Z=Q;Q.register(Kf,"Common.App.SharedFilePicker.SharedFilePickerManager").as(1029).ha().Sd(()=>new Kf(Q.Ra(7)))}init(){m.AFrameworkApplication.J.xp(()=>{this.L$a()})}L$a(){this.Z.resolve(1029)}dispose(){}static main(){K.a.instance.Mc(new nf)}}Object(f.a)(nf,"SharedFilePickerPackage",null,[0,1]);class bg extends Sys.EventArgs{constructor(){super()}}
Object(f.a)(bg,"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class Qg{}Object(f.a)(Qg,"TypingSpeedMeterWindow",null,[]);class ob{constructor(Q,Ca){new V.a;this.mme=()=>{};this.uB=Q;this.oj=Ca;this.oj.ngf(this.mme)}dispose(){this.oj.lEj(this.mme)}}Object(f.a)(ob,"TypingSpeedMeter",null,[1257]);class Lb{constructor(Q){this.iPd=null;this.Sq=new v.a;this.uB=Q}initialize(Q,Ca,sb,Xb){this.iPd||(this.iPd=new ob(this.uB,Q,Ca,sb,Xb),this.Sq.hg(this.iPd));return this.iPd}}Object(f.a)(Lb,"TypingSpeedMeterProvider",
null,[1230]);class fc{constructor(){this.Hbf=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(m.AFrameworkApplication.J.$("TypingSpeedMeterIsEnabled")){const Q=Na.a.instance.resolve(1569),Ca=wl.a.iq(Na.a.instance.Ra(100));Ca.continueWith(()=>{const sb=Ca.result.Sq.task;var Xb=new Ta.a(m.AFrameworkApplication.J.fc("TypingSpeedMeterWindowSamplingPercent",0)/100);Xb=new Pa.a(Object(O.a)(Xb,Xb.D0b,"shouldBeInSample"));const Cc=Wa.a.jH(12,1,Xb),jd=m.AFrameworkApplication.J.fc("TypingSpeedMeterWindowTimeoutMs",
5E3),dd=m.AFrameworkApplication.J.fc("TypingSpeedMeterMaxKeystrokesPerWindow",5);sb.CWR(()=>this.Hbf=Q.initialize(sb.result,Cc,jd,dd))})}}dispose(){this.Hbf&&this.Hbf.dispose()}uc(Q){Q.register(Lb,1569).as("Common.ITypingSpeedMeterProvider").ha().Sd(()=>new Lb(la.a.Le))}static main(){K.a.instance.Mc(new fc)}}Object(f.a)(fc,"TypingSpeedMeterPackage",null,[0,1]);class Jc{constructor(){this.events=[];this.rug=!1}static T2f(Q){return Q.ctrlKey&&"Control"!==Q.key||Q.altKey&&"Alt"!==Q.key||!!Jc.oyn[Q.key]}static Mhl(Q,
Ca){let sb;sb=Jc.T2f(Q)?Q.key:" "===Q.key?"Space":"CharacterKey";return null!=Ca?(Ca.altPressed=(!!Q.altKey).toString(),Ca.ctrlPressed=(!!Q.ctrlKey).toString(),Ca.key=sb,Ca.repeat=(!!Q.repeat).toString(),Ca.shiftPressed=(!!Q.shiftKey).toString(),Ca):{["altPressed"]:(!!Q.altKey).toString(),["ctrlPressed"]:(!!Q.ctrlKey).toString(),["key"]:sb,["repeat"]:(!!Q.repeat).toString(),["shiftPressed"]:(!!Q.shiftKey).toString()}}static P0i(Q){return window.performance&&window.performance.now&&Q.timeStamp<performance.now()}static Jli(Q){return!!Q&&
Jc.P0i(Q)&&Jc.T2f(Q)}static Kli(Q){return!!Q&&Jc.P0i(Q)&&!Jc.T2f(Q)}keyPressedEventHandlerStart(Q,Ca){Jc.Kli(Q)&&this.uYj(Q,Ca)}keyPressedEventHandlerEnd(Q){Jc.Kli(Q)&&this.$Yj(Q)}keyDownEventHandlerStart(Q,Ca){Jc.Jli(Q)&&this.uYj(Q,Ca)}keyDownEventHandlerEnd(Q){Jc.Jli(Q)&&this.$Yj(Q)}uYj(Q,Ca){Q={["metadata"]:Jc.Mhl(Q,Ca),["timeStamp"]:this.IAc(Q.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.IAc(performance.now()-Q.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};
this.events.push(Q);this.eyo()}$Yj(Q){if(0!==this.events.length){var Ca=this.IAc(Q.timeStamp);for(let sb=this.events.length-1;0<=sb;--sb){const Xb=this.events[sb];if(Xb.timeStamp===Ca){Xb.timeToHandlerFinishMs=this.IAc(performance.now()-Q.timeStamp);Xb.eventDurationMs=this.IAc(Xb.timeToHandlerFinishMs-Xb.timeToHandlerStartMs);break}}}}IAc(Q){return Number(Q.toFixed(2))}eyo(){if(!this.rug){const Q=document.createEvent("CustomEvent");Q.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(Q);
requestAnimationFrame(()=>{this.rug=!1;const Ca=performance.now();this.events.forEach(Xb=>{Xb.timeToRequestAnimationFrameMs=this.IAc(Ca-Xb.timeStamp)});var sb=document.createEvent("CustomEvent");sb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(sb);this.events=[];sb=document.createEvent("CustomEvent");sb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(sb)});this.rug=!0}}}Jc.oyn={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,
["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Tc{constructor(){this.Pue=this.Qbb=this.$Xa=this.Crc=null;this.Wtb=!1;this.Ovc=null;this.C1c=[];this.ktd=()=>{Tc.Cqn()&&null==this.Qbb?(this.$Xa=null,this.Qbb=requestAnimationFrame(this.mdd)):null!=this.Qbb&&(cancelAnimationFrame(this.Qbb),this.Qbb=null)};this.mdd=Q=>{if(null!=this.$Xa){const Ca=Q-this.$Xa;if(null==this.Crc||this.Crc<Ca)this.Crc=Ca;for(let sb=0;sb<Tc.ranges.length;++sb)if(Ca<
Tc.ranges[sb]){++this.C1c[sb];break}}this.$Xa=Q;this.Qbb=requestAnimationFrame(this.mdd)};this.TFj=()=>{if(null!=this.Crc){var Q={};for(var Ca=0;Ca<Tc.ranges.length;++Ca)Q[Tc.ranges[Ca]]=this.C1c[Ca],this.C1c[Ca]=0;Ca=performance.now();Q={["intervalStart"]:this.Ovc,["intervalEnd"]:Ca,["maxFrameLengthMs"]:this.Crc,["frameData"]:Q};var sb=document.createEvent("CustomEvent");sb.initCustomEvent("reportframetiming",!1,!1,Q);dispatchEvent(sb);this.Crc=null;this.Ovc=Ca}}}static e0f(){return!!window.performance&&
!!window.performance.now}start(Q){!this.Wtb&&Tc.e0f()&&(this.u2o(),this.Pue=setInterval(this.TFj,1E3*Q),this.Ovc=performance.now(),this.ktd(),document.addEventListener("visibilitychange",this.ktd),this.Wtb=!0)}stop(){this.Wtb&&(document.removeEventListener("visibilitychange",this.ktd),null!=this.Pue&&(clearInterval(this.Pue),this.Pue=null),null!=this.Qbb&&(cancelAnimationFrame(this.Qbb),this.Qbb=null),this.TFj(),this.Wtb=!1)}get Qab(){return this.Wtb}u2o(){this.C1c=[];for(let Q=0;Q<Tc.ranges.length;++Q)this.C1c.push(0)}}
Tc.Cqn=()=>"visible"===document.visibilityState;Tc.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class qd{create(Q){return new Ta.a(Q)}}Object(f.a)(qd,"RandomSamplerFactory",null,[1806]);var Wc=d(20),Zd=d(65);class ie{constructor(Q,Ca,sb,Xb,Cc){Q.HRd(()=>{Xb.old()});Q.zgf((jd,dd)=>{Xb.mld(dd.revisionId,dd.ocb)});Q.KRd((jd,dd)=>{Xb.x6m(dd.wCa,dd.ocb,dd.x1j)});Q.r2k(()=>{Xb.gug()});Ca.V2k((jd,dd)=>{Xb.Hmp(dd.DFj,dd.UCe,dd.actualValue)});Ca.D1k((jd,dd)=>{Xb.Gmp(dd.DFj,
dd.UCe,dd.actualValue)});Cc.VSc(()=>{Xb.Osd()});sb.TO((jd,dd)=>{6===dd.type&&Xb.vwc(dd.pA)})}}Object(f.a)(ie,"EventForwarder",null,[]);class vf{constructor(Q,Ca,sb){this.IGk=Q;this.zQ=sb;this.rbc=Ca}create(Q,Ca){return new ie(this.IGk,this.rbc,Q,Ca,this.zQ)}}Object(f.a)(vf,"EventForwarderFactory",null,[]);var vg=d(339);class Ch{}Ch.Btp="TypingToOutboundReplicationStart";Ch.X8n="OutboundReplicationStartToOutboundReplicationEnd";Ch.ZIj="RtcNotificationToInboundReplicationEnd";Ch.q5j="TypingToInboundReplicationEnd";
Object(f.a)(Ch,"PerfTrackerPhases",null,[]);class ek{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me=null){this.Mth=!1;this.S1e=5;this.bvh=50;this.w0e=20;this.e_e=this.f0e=this.nFa=null;this.SFc=this.GFc=0;this.S9e=this.aaf=!1;this.iOd=Array(7);this.hDc=null;this.Fkh=!1;this.JMe=null;this.ana={};this.EDd=Q;this.g2a=Ca;this.jFk=sb;this.Emh=Xb.create(Ch.ZIj,Cc,jd,20,!1);this.jPd=Xb.create(Ch.q5j,dd,oe,20,!0);if(this.Ga=m.AFrameworkApplication.J)this.Mth=this.Ga.$("LogSteppedInboundFrameIsEnabled"),this.w0e=this.Ga.fc("InboundFrameMaxNumberOfLongRunningTasks",
20),this.bvh=this.Ga.fc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.S1e=this.Ga.fc("InboundFrameNumberOfLastShortTasks",5);this.uCb=Me}get Eql(){null==this.JMe&&(this.JMe=!!this.Ga&&this.Ga.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.JMe}initialize(Q){this.nFa=Q}uGo(Q,Ca,sb=null){this.B2h();wa.ULS.shipAssertTag(8229761,324,0<Q.length);let Xb=!1;for(const jd of Q){const dd=jd.toString();if(dd in this.ana){var Cc=this.ana[dd];if(!Cc.Zwc){Cc.HMj(Q,Ca,sb);
if(Xb)this.Aaj(jd.toString(),Cc,null,null,this.iOd,null);else{const oe=this.C6l(),Me=this.Fgm(this.hDc);Xb=!0;this.Aaj(jd.toString(),Cc,oe,this.e_e,this.iOd,Me)}delete this.ana[dd]}}else Cc=this.EDd.create(this.Emh,this.jPd),Cc.HMj(Q,Ca),this.ana[dd]=Cc}this.S9e=!1}vwc(Q){wa.ULS.shipAssertTag(8257930,304,Q.p4i,"Expected data not sent on the wire");if(Q.p4i){if(Q.wve in this.ana){var Ca=this.ana[Q.wve];Ca.Jve||(Ca.vwc(Q.revisionId,Q.xqj,Q.LTj,Q.ocb),delete this.ana[Q.wve])}else Ca=this.EDd.create(this.Emh,
this.jPd),Ca.vwc(Q.revisionId,Q.xqj,Q.LTj,Q.ocb),this.ana[Q.wve]=Ca;this.B2h()}}m8m(){this.aaf||(this.f0e=Array(this.w0e),this.e_e=Array(this.S1e),this.SFc=this.GFc=0,this.iOd=[0,0,0,0,0,0,0,0],this.hDc=Array(3),this.hDc[1]=[0,0],this.hDc[2]=[0,0],this.aaf=!0)}w6o(Q){return!Q.TP&&Q.TN===fa.a.xFj&&(Q=vg.a(this.ana))&&Q[0]?!0:!1}oZn(Q){this.aaf=!1;const Ca=vg.a(this.ana);Ca&&Ca[0]&&(Q.TRT>=this.bvh&&this.GFc<this.w0e?this.f0e[this.GFc++]=Q:(this.e_e[this.SFc]=Q,this.SFc=this.SFc<this.S1e-1?this.SFc+
1:0),this.oIn(Q),this.EIn(Q))}nZn(){this.m8m();this.S9e=!0}oIn(Q){this.iOd[Q.TP]++}EIn(Q){if(Q&&Q.UI){const Ca=this.hDc[Q.UI];Ca[0]+=1;Ca[1]+=Q.TRT}}Fgm(Q){const Ca={};Q&&(Q[1]&&(Ca.Typing=Q[1]),Q[2]&&(Ca.Clicking=Q[2]));return Ca}C6l(){return this.GFc?this.f0e.slice(0,this.GFc-1):null}B2h(){var Q=vg.a(this.ana);if(Q&&(this.Fkh||this.$In(Q),Q.length>this.jFk))for(const Ca of Q){Q=this.ana[Ca];const sb=Q.createdTime,Xb=this.g2a();6E4<Xb-sb&&(R.b(8438528,304,50,"{0}",{["Not Received"]:Q.Zwc?"RtcNotification":
"ServerRevision",["Duration"]:Xb-sb}),Q.Zwc||R.b(42075798,304,15,"{0}",{["RevisionId"]:Ca,["Duration"]:Xb-sb}),delete this.ana[Ca])}}$In(Q){if(this.Eql&&this.uCb)for(const Ca of Q)if(Q=this.ana[Ca],Q.Jve&&!Q.Zwc&&(Q=Q.createdTime,2E3<this.g2a()-Q)){let sb=null;Wc.StaticActiveAppFrame.za()&&Wc.StaticActiveAppFrame.za().kb&&Wc.StaticActiveAppFrame.za().kb.ed&&(sb=Wc.StaticActiveAppFrame.za().kb.ed.xg);this.uCb.execute(Xb=>{Xb.flush(sb,1)});this.Fkh=!0}}Aaj(Q,Ca,sb,Xb,Cc,jd){this.Mth&&(Ca=Ca.sgm())&&
(Ca.RevisionId=Q,Ca.LRTWR=sb,Ca.LSTWR=Xb,Ca.TSD=Cc,Ca.UIWR=jd,this.nFa&&this.nFa.track(Ca))}}Object(f.a)(ek,"InboundMonitor",null,[1345]);class dj{constructor(Q,Ca,sb,Xb){this.mF=Ca;this.EDd=sb;this.oRk=Xb}create(Q,Ca,sb,Xb,Cc=null){return new ek(this.EDd,this.mF,50,this.oRk,Q,Ca,sb,Xb,Cc)}}Object(f.a)(dj,"InboundMonitorFactory",null,[1313]);var Cd=d(374);class gh{}gh.RFe="UserCount";gh.TKo="RevisionChainLength";Object(f.a)(gh,"PerfTrackerPivotNames",null,[]);class Xe{}Object(f.a)(Xe,"PerfTrackingContext",
null,[]);const xh=Q=>5>=Q?"5AndFewer":10>=Q?"6To10":15>=Q?"11To15":20>=Q?"15To20":25>=Q?"21To25":30>=Q?"26To30":"31AndAbove";class Pj{}Object(f.a)(Pj,"SteppedInboundFrame",null,[]);class tj{constructor(Q,Ca,sb,Xb,Cc){this.rkb=this.GDd=null;this.zmh=500;this.FDd=this.txa=this.CEb=this.X7b=this.fwd=-1;this.hTg=null;this.lEh=this.hDh=!1;this.MCh=null;this.wyh=this.gSa=0;this.m$b=Q;this.createdTime=Ca();this.IMd=!1;this.e3e=0;this.pGb=sb;this.hAk=Xb;this.jPd=Cc;m.AFrameworkApplication.J&&(this.zmh=m.AFrameworkApplication.J.fc("InboundFrameSamplingMinimalTotalTimeMs",
500))}get Jve(){return this.hDh}get Zwc(){return this.lEh}get fIj(){return this.MCh}get ocb(){return this.gSa}get W8n(){return this.wyh}get eOb(){return this.pGb()}vwc(Q,Ca,sb,Xb){this.Jve||(this.IMd=sb,this.e3e=Ca,this.fwd=Y.a.bQ(la.a.Le(),2),this.hTg=(new Date).toISOString(),this.rkb=Q,this.wyh=Xb,this.hDh=!0,this.Zwc?this.gki():(this.vYj(),Fa.a.instance.zA(Q.toString()+"Start"),Cd.a.instance.nje(2)))}HMj(Q,Ca,sb=null){this.Zwc||(this.gSa=Ca,this.lEh=!0,this.MCh=Q,this.FDd=Y.a.bQ(la.a.Le(),2),this.Jve&&
(Fa.a.instance.zA(this.rkb.toString()+"End"),sb&&(this.X7b=sb.HGj,this.CEb=sb.DNa,this.txa=sb.CFj),Cd.a.instance.PVd(),this.gki()))}sgm(){if(!(0<this.fwd&&0<this.X7b&&0<this.CEb&&0<this.txa&&0<this.FDd))return null;const Q=new Pj;Q.TT=Y.a.bQ(this.FDd-this.fwd,2);if(Q.TT<this.zmh)return null;Q.ST=this.hTg;Q.UC=this.eOb;Q.RS=Y.a.bQ(this.X7b-this.fwd,2);Q.SR=Y.a.bQ(this.CEb-this.X7b,2);Q.RRS=Y.a.bQ(this.txa-this.CEb,2);Q.RP=Y.a.bQ(this.FDd-this.txa,2);Q.ResponseLanded=Y.a.bQ(this.CEb,2);0<Q.RS?(Fa.a.instance.w0("RTCToRequestSent",
this.rkb.toString()+"Start","RequestInvoked"+this.X7b),Fa.a.instance.w0("RequestSentToResponseReceived","RequestInvoked"+this.X7b,"RequestCompleted"+this.CEb),Fa.a.instance.w0("ResponseReceivedToReplicationStart","RequestCompleted"+this.CEb,"ReplicationStart"+this.txa)):Fa.a.instance.w0("RTCToReplicationStart",this.rkb.toString()+"Start","ReplicationStart"+this.txa);Fa.a.instance.w0("Replication","ReplicationStart"+this.txa,this.rkb.toString()+"End");return Q}vYj(){this.GDd=this.m$b.create();this.GDd.start(Ch.ZIj,
Ch.q5j)}gki(){this.GDd||this.vYj();const Q=this.GDd.end(this.IMd,this.ZJl());this.hAk.Nue(Q);this.jPd.Nue(Q+this.e3e)}ZJl(){const Q={};Q[gh.RFe]=xh(this.eOb);var Ca=this.fIj.length;Q[gh.TKo]=9>=Ca?Ca.toString():"10AndAbove";return Object.assign(new Xe,{P:Q,FC:this.ocb,CFC:this.W8n+this.ocb,ID:this.rkb.toString(),CD:this.e3e,UC:this.eOb,RCL:this.fIj.length})}}Object(f.a)(tj,"InboundOperation",null,[1344]);class Fj{constructor(Q,Ca,sb){this.VQa=Q;this.g2a=Ca;this.pGb=sb}create(Q,Ca){return new tj(this.VQa,
this.g2a,this.pGb,Q,Ca)}}Object(f.a)(Fj,"InboundOperationFactory",null,[1312]);class lm{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me){this.JMd=!0;this.Dzh=this.vJd=null;this.tC=zf=>{this.Zh.tC(6,zf)};this.d3e=Q;this.qvk=Ca;this.CJk=sb;this.Zh=Xb;this.Ibf=Cc.create("TypingToOutboundReplicationStart",jd,dd,20,!1);this.q6e=Cc.create("OutboundReplicationStartToOutboundReplicationEnd",oe,Me,20,!1)}get Bkg(){return this.vJd}get Upe(){return this.Dzh}Osd(){!this.Bkg&&this.JMd&&(this.JMd=this.qvk())&&(this.vJd=
this.d3e.create(this.tC,this.CJk(),this.Ibf,this.q6e),this.Bkg.Osd())}old(){this.JMd=!0;this.Dzh=this.Bkg;this.Upe&&(this.vJd=null,this.Upe.old())}gug(){this.vJd=null}mld(Q,Ca){this.Upe&&this.Upe.mld(Q,Ca)}}Object(f.a)(lm,"OutboundMonitor",null,[]);class Oa{constructor(Q,Ca){this.d3e=Q;this.AIk=Ca}create(Q,Ca,sb,Xb,Cc,jd,dd){return new lm(this.d3e,Q,Ca,sb,this.AIk,Xb,Cc,jd,dd)}}Object(f.a)(Oa,"OutboundMonitorFactory",null,[]);var cc=d(46);class Lc{constructor(Q){this.Hkb=Q}get Mpo(){return this.Hkb}mb(Q){return!!this.Hkb&&
Q in this.Hkb}get p4i(){return this.mb(Lc.F0d)&&this.mb(Lc.e_b)&&this.mb(Lc.ICg)}get revisionId(){if(this.mb(Lc.e_b))return cc.a.Af(this.Hkb[Lc.e_b]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get wve(){if(this.mb(Lc.e_b))return this.Hkb[Lc.e_b];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get xqj(){if(this.mb(Lc.F0d))return Number.parseInvariant(this.Hkb[Lc.F0d]);throw Error.create("Unable to parse DurationKey key from dictionary into int");
}get LTj(){if(this.mb(Lc.e_b))return Boolean.parse(this.Hkb[Lc.ICg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get ocb(){if(this.mb(Lc.ddg))return Number.parseInvariant(this.Hkb[Lc.ddg]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static jHl(Q){return new Lc(Q)}static oHl(Q,Ca,sb,Xb){const Cc={};Cc[Lc.F0d]=Q.toString();Cc[Lc.e_b]=Ca.toString();Cc[Lc.ICg]=sb.toString();Cc[Lc.ddg]=Xb.toString();return new Lc(Cc)}}
Lc.e_b="RevisionID";Lc.F0d="Duration";Lc.ICg="ShouldSample";Lc.ddg="NumSequentialFailures";Object(f.a)(Lc,"ReplicationNotificationMessage",null,[1337]);class rd{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.rt=this.ki=0;this.IGb=this.yRc=null;this.SJe=[];this.AAh=null;this.WAd={};this.gSa=0;this.m$b=Q;this.iNk=Ca;this.g2a=sb;this.pGb=Xb;this.gFh=Cc;this.rkb=null;this.WAd.TypingStartStage=null;this.WAd.ReplicationStartStage="TypingStartStage";this.WAd.ReplicationEndStage="ReplicationStartStage";this.TJh=1<
this.eOb;this.Ibf=jd;this.q6e=dd}get eOb(){return this.pGb()}Osd(){this.zof("TypingStartStage")&&(this.Lqg("TypingStartStage"),wa.ULS.shipAssertTag(8257931,324,!this.IGb&&!this.rt,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.ki=this.g2a(),this.yRc=this.m$b.create(),this.kYj(this.yRc,Ch.Btp))}old(){if(this.zof("ReplicationStartStage")){this.Lqg("ReplicationStartStage");wa.ULS.shipAssertTag(8257932,324,!!this.yRc,"TypingStart not called");if(this.yRc){const Q=this.aki(this.yRc,
this.rkb);this.Ibf.Nue(Q)}this.IGb=this.m$b.create();this.kYj(this.IGb,Ch.X8n)}}mld(Q,Ca){this.zof("ReplicationEndStage")&&(this.Lqg("ReplicationEndStage"),this.rt=this.g2a(),this.gSa=Ca,wa.ULS.shipAssertTag(8257933,324,!!this.IGb,"ReplicationStart not called"),this.IGb&&(wa.ULS.shipAssertTag(8193425,324,!!this.IGb,"ReplicationStart not called"),Ca=this.aki(this.IGb,Q),this.q6e.Nue(Ca)),wa.ULS.shipAssertTag(8257934,324,!!this.ki,"StartTime not set. No message sent to other editors."),this.ki&&(Q=
Lc.oHl(this.rt-this.ki,Q,this.gFh,this.gSa),this.iNk(Q.Mpo)))}zof(Q){if(this.WAd[Q]===this.AAh)return!0;wa.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.mVk()});return!1}mVk(){const Q=new Sys.StringBuilder;Q.append("Actual Phase:");for(let Ca=0;Ca<this.SJe.length;Ca++)Q.append(" "+this.SJe[Ca]);return Q.toString()}Lqg(Q){this.SJe.push(Q);this.AAh=Q}kYj(Q,Ca){this.TJh&&Q.start(Ca)}aki(Q,Ca){if(!this.TJh)return-1;const sb={};sb[gh.RFe]=xh(this.eOb);Ca=Object.assign(new Xe,
{P:sb,FC:this.gSa,CFC:0,ID:Ca?Ca.toString():"",CD:0,UC:this.eOb,RCL:0});return Q.end(this.gFh,Ca)}}Object(f.a)(rd,"OutboundOperation",null,[1341]);class Oe{constructor(Q,Ca,sb){this.m$b=Q;this.g2a=Ca;this.pGb=sb}create(Q,Ca,sb,Xb){return new rd(this.m$b,Q,this.g2a,this.pGb,Ca,sb,Xb)}}Object(f.a)(Oe,"OutboundOperationFactory",null,[1311]);class xd{constructor(Q,Ca){this.lch=this._name=this.b6=null;this.Zd=Q;this.nFa=Ca}start(Q,Ca=null){this.b6=this.Zd.Xf("UserAction",Q);this._name=Q;this.lch=Ca}end(Q,
Ca){let sb=-1;Q&&(sb=this.b6.Hi,Ca.D=sb,Ca.CN=this.lch,Ca.CD+=sb,this.nFa.track(Ca,this._name));return sb}}Object(f.a)(xd,"PerfTracker",null,[1338]);class pa{constructor(Q,Ca){this.Zd=Q;this.nFa=Ca}create(){return new xd(this.Zd,this.nFa)}}Object(f.a)(pa,"PerfTrackerFactory",null,[1310]);class Fb{constructor(Q,Ca,sb){this.nNc=null;this.zIk=Q;this.Dmh=Ca;this.$Ah=sb}init(Q,Ca,sb,Xb,Cc,jd,dd){Ca=this.$Ah.create(Ca/100);sb=this.$Ah.create(sb/100);this.nNc=this.zIk.create(Object(O.a)(Ca,Ca.D0b,"shouldBeInSample"),
Object(O.a)(sb,sb.D0b,"shouldBeInSample"),Q,Xb,Cc,jd,dd)}Osd(){this.nNc.Osd()}old(){this.nNc.old()}gug(){this.nNc.gug()}mld(Q,Ca){this.nNc.mld(Q,Ca)}x6m(Q,Ca,sb=null){this.Dmh.uGo(Q,Ca,sb)}vwc(Q){Q=Lc.jHl(Q);this.Dmh.vwc(Q);Fa.a.instance.zA(Q.revisionId+"Start")}Hmp(Q,Ca,sb){R.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.xYd(Q,Ca,sb))}Gmp(Q,Ca,sb){R.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.xYd(Q,Ca,sb))}xYd(Q,Ca,sb){const Xb=
{};Xb.PhaseName=Q;Xb.ThresholdValue=Ca;Xb.ActualValue=sb;return Xb}}Object(f.a)(Fb,"ReplicationTelemetryManager",null,[]);var Mb=d(939);class Ic extends Mb.a{constructor(Q,Ca){super(Q,Ca);this.Qk=this.INd=0}yDa(Q){this.INd+=Q;this.Qk++}getValue(){return this.Qk?this.INd/this.Qk:0}j_a(){this.Qk=this.INd=0}}Object(f.a)(Ic,"AverageMetric",Mb.a,[]);class ld extends Mb.a{constructor(Q,Ca){super(Q,Ca);this.q$=0}yDa(Q){Q>this.q$&&(this.q$=Q)}getValue(){return this.q$}j_a(){this.q$=0}}Object(f.a)(ld,"MaxMetric",
Mb.a,[]);var Kd=d(1926);class ue extends Mb.a{constructor(Q,Ca,sb=100){super(Q,Ca);this.UGd=this.L9b=this.ebc=0;this.wLd=sb;this.h7e=new Kd.a(this.wLd)}yDa(Q){if(this.L9b===this.wLd){const Ca=this.h7e.dequeue();this.ebc-=Ca;this.L9b--}this.h7e.enqueue(Q);this.ebc+=Q;this.L9b++;Q=this.ebc/this.L9b;Q>this.UGd&&this.L9b===this.wLd&&(this.UGd=Q)}getValue(){return this.UGd}j_a(){this.UGd=0;this.h7e=new Kd.a(this.wLd);this.L9b=this.ebc=0}}Object(f.a)(ue,"MaxRollingAverageMetric",Mb.a,[]);class Ye extends Mb.a{constructor(Q,
Ca){super(Q,Ca);this.Qk=0}yDa(){this.Qk++}getValue(){return this.Qk}j_a(){this.Qk=0}}Object(f.a)(Ye,"CounterMetric",Mb.a,[]);class Bf{constructor(Q,Ca){var sb;this.JJb=Ca;this.hLe=new Ic(Q+"-AverageValue","Milliseconds");this.u0e=new ld(Q+"-MaxValue","Milliseconds");this.z0e=new ue(Q+"-MaxRollingAverageValue","Milliseconds");this.vOe=new Ye(Q+"-NumberOfEvents","Count");this.Sxa=new gb.a(Q+"-SlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.YJ("CoAuthLatencySlowTargetValue",3E3),m.AFrameworkApplication.J.YJ("CoAuthLatencySlowThresholdPercentile",
95),this.JJb);Ca=null===(sb=m.AFrameworkApplication.J)||void 0===sb?void 0:sb.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreaseWebLatencyVetoTime",!1);m.AFrameworkApplication.nd("12b7f130;h128e180");this.j4e=Ca?new gb.a(Q+"-BrokenSlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.YJ("CoAuthLatencyBrokenSlowTargetValueForWord",1E4),m.AFrameworkApplication.J.YJ("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.JJb):new gb.a(Q+"-BrokenSlowPercentileAtValue","Percentile",m.AFrameworkApplication.J.YJ("CoAuthLatencyBrokenSlowTargetValue",
5E3),m.AFrameworkApplication.J.YJ("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.JJb)}g4(Q){this.hLe.yDa(Q);this.u0e.yDa(Q);this.z0e.yDa(Q);this.vOe.yDa(Q);this.Sxa.yDa(Q);this.j4e.yDa(Q)}rte(){this.hLe.OZa();this.u0e.OZa();this.z0e.OZa();this.vOe.OZa();this.Sxa.OZa();this.j4e.OZa();this.hLe.j_a();this.u0e.j_a();this.z0e.j_a();this.vOe.j_a();this.Sxa.j_a();this.j4e.j_a()}}Object(f.a)(Bf,"ReplicationLatencyMetrics",null,[]);class Fg{constructor(){this.r_e=new xc.a}aAj(Q,Ca,sb){if(!(0>Ca)){if(!({value:Xb}=
this.r_e.Ec(Q,Xb)).returnValue){var Xb=new Bf(Q,sb);this.r_e.W(Q,Xb)}Xb.g4(Ca)}}rte(){for(const Q of this.r_e.values)Q.rte()}}Object(f.a)(Fg,"ReplicationTelemetryMetricsManager",null,[1309]);class ah{aAj(){}rte(){}}Object(f.a)(ah,"ReplicationTelemetryMetricsManagerStub",null,[1309]);class Rg{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.y5a=this.UOd=0;this.JFk=Q;this.n4e=sb;this.XHh=Xb;this.a$g=Cc;this.rbc=Ca;this.KFk=jd;this.JJb=dd}Nue(Q){this.JFk.aAj(this.n4e,Q,this.JJb);Q>this.XHh&&this.rbc.lmp(this.n4e,
this.XHh,Q);this.UOd+=Q;this.y5a++;this.UOd/this.y5a>this.a$g&&this.y5a>this.KFk&&this.rbc.Hcl(this.n4e,this.a$g,this.UOd/this.y5a)}}Object(f.a)(Rg,"TimeSpanVerifier",null,[1335]);class Dh{constructor(Q,Ca){this.MLk=Q;this.rbc=Ca}create(Q,Ca,sb,Xb,Cc){return new Rg(this.MLk,this.rbc,Q,Ca,sb,Xb,Cc)}}Object(f.a)(Dh,"TimeSpanVerifierFactory",null,[1308]);class ej extends Sys.EventArgs{constructor(Q,Ca,sb){super();this.DFj=Q;this.UCe=Ca;this.actualValue=sb}}Object(f.a)(ej,"TimeSpanVerifierEventArgs",
Sys.EventArgs,[]);class ak{constructor(){this.sa=new V.a}lmp(Q,Ca,sb){this.sa.raiseEvent("TSVTE",new ej(Q,Ca,sb))}Hcl(Q,Ca,sb){this.sa.raiseEvent("TSVATE",new ej(Q,Ca,sb))}V2k(Q){this.sa.addHandler("TSVTE",Q)}D1k(Q){this.sa.addHandler("TSVATE",Q)}}Object(f.a)(ak,"TimeSpanVerifierNotifier",null,[1307]);var df=d(1277);class dc{constructor(){this.Z=this.Ga=null}get name(){return"Box4.ReplicationTelemetry"}uc(Q){this.Ga=Q.resolve(71);this.Z=Q;if(this.Ga.$("Box4ReplicationTelemetryIsEnabled")){Q.ia(1572,
()=>new pa(Wc.StaticActiveAppFrame.za().$r,Wa.a.jH(20,1,new Ma.a))).ha();Q.ia(1571,()=>new ak).ha();this.Ga.$("Box4ReplicationTelemetryMetricsIsEnabled")?Q.ia(1570,()=>new Fg).ha():Q.ia(1570,()=>new ah).ha();Q.ia(1574,()=>new Dh(Q.resolve(1570),Q.resolve(1571))).ha();Q.ia(1573,()=>new Oe(Q.resolve(1572),()=>(new Date).getTime(),dc.zxi)).ha();Q.ia(1577,()=>new Oa(Q.resolve(1573),Q.resolve(1574))).ha();Q.ia(1575,()=>new Fj(Q.resolve(1572),()=>(new Date).getTime(),dc.zxi)).ha();var Ca=new dj(Q.resolve(1572),
()=>(new Date).getTime(),Q.resolve(1575),Q.resolve(1574)),sb=this.Ga.$("ComponentStateLoggingPackageIsEnabled")?this.Z.Ra(1576):null;Q.ia(1578,()=>Ca.create(this.Ga.fc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Ga.fc("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.Ga.fc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Ga.fc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),sb)).ha();Q.ia(1579,()=>new qd).ha();Q.ia(1580,()=>new Fb(Q.resolve(1577),
Q.resolve(1578),Q.resolve(1579))).ha();Q.ia(1581,()=>new vf(df.a.instance,Q.resolve(1571),Q.resolve(230)))}}init(){if(this.Ga.$("Box4ReplicationTelemetryIsEnabled")){var Q=this.Ga.fc("Box4ReplicationTelemetrySamplePercent",0),Ca=this.Ga.fc("Box4ReplicationTelemetryPhaseSamplePercent",0),sb=this.Ga.fc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Xb=this.Ga.fc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),Cc=this.Ga.fc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",
0),jd=this.Ga.fc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),dd=this;this.Z.Ra(545).execute(Me=>{Me.oD().continueWith(()=>{const zf=Me.oD().result,uh=dd.Z.resolve(1580);uh.init(zf,Q,Ca,sb,Xb,Cc,jd);dd.Z.resolve(1581).create(zf,uh);if(dd.Ga.$("LogSteppedInboundFrameIsEnabled")){const wj=wl.a.iq(dd.Z.Ra(100));wj.continueWith(()=>{const Sh=dd.Z.resolve(1578);var qi=new Pa.a(()=>!0);qi=Wa.a.jH(19,1,qi);Sh.initialize(qi);const yk=wj.result.Sq.task;yk.continueWith(()=>
{yk.result.ZQd(0,()=>Sh.S9e,Zo=>{Sh.oZn(Zo)});yk.result.ZQd(1,Zo=>Sh.w6o(Zo),()=>{Sh.nZn()})})})}wa.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var oe=this;m.AFrameworkApplication.JH(()=>{oe.Z.resolve(1570).rte()})}}dispose(){}static zxi(){const Q=Zd.a.vd();return Q?Q.Qii:0}}Object(f.a)(dc,"ReplicationTelemetryPackage",null,[0,1]);var zc=d(1260),je=d(11),Le=d(129),Ed=d(3),rj=d(81),ad=d(61),$f=d(36),dg=d(21),Wg=d(166),Ji=d(7),Gl=d(2127);class ma{static get lh(){return a.a.ry(ma.Qn,
Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}ma.Qn="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";Object(f.a)(ma,"InsertSymbolsDialogHtml",null,[]);class db extends Gl.a{constructor(Q,Ca,sb){super();this.U8b=this.dTa=
this.Elb=null;this.hWe=0;this.Wcn=Xb=>{1===Xb?(this.Ofg("symbol_d_"+db.PKc),this.Zb.WN(this.pN,!0),this.Zb.gu().Tk.oA(this.qJ),this.qJ.focus()):this.hide()};this.o_j=Xb=>{if(Xb.target!==this.U8b){const Cc=this.Zb.gu();Cc&&Cc.Tk&&(Cc.Tk.oA(Xb.target),this.U8b=Xb.target)}this.c5n(Xb.target.id)};this.xip=Xb=>{const Cc=Xb.Ef;if("a"!==Cc.tagName.toLowerCase())return!1;Xb.eventName===S.a.fD&&this.Ofg(Cc.id);this.Zb.WN(this.pN,!0);this.Zb.gu().Tk.oA(Cc);Cc.focus();return!0};this.zip=Xb=>{var Cc=Xb.Ef;if("a"!==
Cc.tagName.toLowerCase())return!1;const jd=parseInt(Cc.id.substr(Cc.id.lastIndexOf("_")+1));if(Xb.Nb.ctrlKey||Xb.Nb.altKey||Xb.Nb.keyCode>=Dj.a.$3b&&Xb.Nb.keyCode<=Dj.a.a4b)return!1;if(Xb.eventName===S.a.kj){Xb=Xb.Nb.keyCode;let dd=-1;Xb===Sys.UI.Key.enter?(this.Ofg(Cc.id),this.Zb.WN(this.pN,!0),this.Zb.gu().Tk.oA(Cc),Cc.focus()):Xb===Sys.UI.Key.up?dd=jd-15:Xb===Sys.UI.Key.down?dd=jd+15:Xb===Sys.UI.Key.left?dd=m.AFrameworkApplication.isRtl?jd+1:jd-1:Xb===Sys.UI.Key.right&&(dd=m.AFrameworkApplication.isRtl?
jd-1:jd+1);0<=dd&&(Cc=this.HOf("symbol_d_"+dd))&&Cc.focus()}return!0};this.ga=Q;this.Zb=Ca;this.Flb=sb;this.Qe(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Qe(0,CommonUIStrings.l_DialogClose);this.zda=!1;this.lh=ma.lh;this.Pg="InsertSymbolsDialog"}dispose(){0<db.fbf&&wa.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.hWe,db.fbf);db.Ieh++;wa.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",db.Ieh);
this.ga=this.Flb=null;super.dispose()}U_a(){this.gi(Box4Intl.Box4Strings.L_SymbolSingle,this.Wcn,null);this.hWe=0;db.Oeh++;wa.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",db.Oeh);const Q=this.HOf("symbol_d_"+db.PKc);Q&&Q.focus()}hide(){var Q=document.getElementById("symbolsContainer");if(Q&&(Q=Q.getElementsByTagName("a")))for(let Ca=0;Ca<Q.length;Ca++)aa.a.removeHandler(Q[Ca],S.a.focus,this.o_j);super.hide()}get wub(){return db.TKc}set wub(Q){db.TKc=Q}get qub(){return db.JKc}set qub(Q){db.JKc=
Q}Pba(){super.Pba();var Q=document.getElementById("symbolsContainer");if(Q&&(Q.innerHTML=this.Flb.shl(),Q=Q.getElementsByTagName("a")))for(let Ca=0;Ca<Q.length;Ca++)aa.a.addHandler(Q[Ca],S.a.focus,this.o_j)}$qa(){const Q=document.getElementById("symbolsContainer");Q&&(this.Elb||(this.Elb=this.xip,this.ur.nb(S.a.click,Q,this.Elb),this.ur.nb(S.a.fD,Q,this.Elb)),this.dTa||(this.dTa=this.zip,this.oe.nb(S.a.kj,Q,this.dTa),this.oe.nb(S.a.rv,Q,this.dTa),this.oe.nb(S.a.hi,Q,this.dTa)));super.$qa()}Qob(){const Q=
document.getElementById("symbolsContainer");Q&&(this.Elb&&(this.ur.xc(S.a.click,Q,this.Elb),this.ur.xc(S.a.fD,Q,this.Elb),this.Elb=null),this.dTa&&(this.oe.xc(S.a.kj,Q,this.dTa),this.oe.xc(S.a.rv,Q,this.dTa),this.oe.xc(S.a.hi,Q,this.dTa),this.dTa=null));super.Qob()}get NSf(){return!0}c5n(Q){this.wQj("symbol_d_"+db.PKc,!1);db.PKc=parseInt(Q.substr(Q.lastIndexOf("_")+1));this.wQj(Q,!0);if(Q=document.getElementById("SymbolNameValueLabel")){const Ca=this.n9d(db.PKc);Q.innerText=Ca.altText}}n9d(Q){const Ca=
this.Flb.QBe.YGg.value,sb=vg.a(Ca);return Ca[sb[Q]]}Ofg(Q){this.hWe++;db.fbf++;Q=parseInt(Q.substr(Q.lastIndexOf("_")+1));const Ca=this.n9d(Q),sb={};sb.SourceControlId="symbol_"+Q+"_"+Ca.OBe;this.ga.Pb(Ed.a.Hsb,2,sb);wa.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Q)}HOf(Q){const Ca=document.getElementById("symbolsContainer");return Ca?Ca.querySelector("#"+Q):null}wQj(Q,Ca){if(Q=this.HOf(Q))Ca?(Q.setAttribute("selected","true"),Q.setAttribute("aria-selected","true"),
Q.tabIndex=0):(Q.removeAttribute("selected"),Q.setAttribute("aria-selected","false"),Q.tabIndex=-1)}}db.PKc=0;db.TKc=null;db.JKc=null;db.Oeh=0;db.Ieh=0;db.fbf=0;Object(f.a)(db,"InsertSymbolsDialog",Gl.a,[]);class Ob{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.VNm=()=>this.Flb.hil();this.Pxj=(oe,Me,zf,uh,wj)=>{if(1===zf)return 32;oe=this.Flb.osj(wj);oe=String.format(this.Flb.yip,oe.character);wj[zc.a.InnerHTML]=oe;wj[zc.a.On]=!1;return 32};this.WWa=(oe,Me,zf,uh,wj)=>{if(({ne:oe,selected:zf,WWa:yk}=this.KYc(Me,
zf)).returnValue)return yk;var Sh=$f.a.qf(zf);let qi=!0;zf=8;var yk=this.Qc.Lc(15);yk.Ab(oe.qd);Sh||(zf=this.ga.Pf(Me,Ed.a.Qra,2,!0,uh,null),Me=32===zf,wa.ULS.shipAssertTag(6407387,348,Me,"DeleteForReplace did not succeed. Response is {0}",zf),qi=Me);qi&&(Me=oe.lb.Ng,Sh=$f.a.qf(Me),wa.ULS.shipAssertTag(6407388,348,Sh,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",Me.contextId),zf=8,Sh&&(zf=this.ga.Pf(Me,Ed.a.Hsb,2,!1,uh,wj),wa.ULS.shipAssertTag(6407389,348,32===zf,
"Insertion at IP context did not succeed. Response is {0}",zf),32===zf&&Of.FocusManager.instance().Eg(oe.CL)));yk.dispose();return zf};this.Vcn=(oe,Me,zf,uh,wj)=>{if(1===zf)return 32;if($f.a.eab(Me))return 2;oe=this.Flb.osj(wj);uh.Ft=oe.index;uh=this.$c.lg(Me.node);zf=uh.vb(11);wa.ULS.shipAssertTag(6379466,324,zf,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",Le.a[Me.node.type]);zf=this.Qc.Lc(15);zf.pu(uh);Ob.Bg.Ue(Me,oe.character,!0,!1);Me=dg.SelectionFactory.ve(uh.currentNode,
Me.cpBegin+1);this.ib.Kc(Me);zf.dispose();return 32};this.aYb=(oe,Me,zf,uh,wj)=>{if(1===zf)return 32;wj.MenuItems=this.ZPk.value;return 32};this.p_j=(oe,Me,zf)=>{({WWa:oe}=this.KYc(Me,zf));return oe};this.bVj=(oe,Me,zf)=>{2===zf&&(new db(this.ga,Of.FocusManager.instance(),Na.a.instance.resolve(1582))).U_a();return 32};this.Rog=()=>32;this.ga=Q;this.$c=Ca;this.ZPk=new bc.a(this.VNm);this.Qc=sb;this.Flb=Xb;this.Al=Cc;this.ib=jd;this.ao=dd}Wb(){this.ga.fb(Ed.a.Rog,je.a.application,this.Rog,96);this.ga.qa(Ed.a.aYb,
je.a.view,this.aYb);this.ga.qa(Ed.a.PBe,je.a.view,this.p_j);this.ga.qa(Ed.a.tse,je.a.view,this.Pxj);this.ga.qa(Ed.a.Hsb,je.a.view,this.WWa);this.ga.qa(Ed.a.aYb,je.a.Vc,this.aYb);this.ga.qa(Ed.a.PBe,je.a.Vc,this.p_j);this.ga.qa(Ed.a.tse,je.a.Vc,this.Pxj);this.ga.qa(Ed.a.Hsb,je.a.Vc,this.Vcn);this.ga.Pc(Ed.a.aYb,1124);this.ga.Pc(Ed.a.PBe,1036);this.ga.Pc(Ed.a.tse,1124);this.ga.Pc(Ed.a.Hsb,1036);m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("InsertMoreSymbolsIsEnabled")&&(this.ga.qa(Ed.a.c8c,
je.a.view,this.bVj),this.ga.qa(Ed.a.c8c,je.a.Vc,this.bVj),this.ga.Pc(Ed.a.c8c,1124))}KYc(Q,Ca){let sb,Xb=null;Q.view.ue&&(Xb=Q.view);sb=null;if(!Xb||!Xb.lb)return R.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Q.toString()),{returnValue:!0,ne:Xb,selected:sb,WWa:8};sb=Xb.lb.Ng;if(!sb)return{returnValue:!0,ne:Xb,selected:sb,WWa:2};if(this.Al.F2(sb)||this.Al.gma(sb))return{returnValue:!0,ne:Xb,selected:sb,WWa:8};
if(Xb.lb.gb.WL||this.ao&&this.ao.instance&&this.ao.instance.KX(sb)||$f.a.eab(Q.Ok))return{returnValue:!0,ne:Xb,selected:sb,WWa:2};if(Object(Wg.a)().bFa(Ji.ParagraphReader.IX,sb))return Q=8,Ob.Bc.$b(rj.a.Oe,{["Reason"]:ad.a.cR}),{returnValue:!0,ne:Xb,selected:sb,WWa:Q};Q=32;return 1===Ca?{returnValue:!0,ne:Xb,selected:sb,WWa:Q}:{returnValue:!1,ne:Xb,selected:sb,WWa:Q}}static get Bg(){return Ob.Qd||(Ob.Qd=Na.a.instance.resolve(323))}static set Bg(Q){Ob.Qd=Q}static get Bc(){return Vb.a.instance}}Ob.Qd=
null;Object(f.a)(Ob,"SymbolsActor",null,[1015]);class Qb{constructor(Q,Ca){this.OBe=Q;this.altText=Ca}}Object(f.a)(Qb,"Symbol",null,[]);class sc{constructor(){this.L$e=null;this.fHh=new bc.a(sc.yuf)}get YGg(){return this.fHh}UAi(Q){this.L$e||(this.L$e=vg.a(this.fHh.value));return Array.indexOf(this.L$e,Q)}static yuf(){const Q={};Q["\u2022"]=new Qb("\u2022",Box4Intl.Box4Strings.L_Bullet);Q["\u20ac"]=new Qb("\u20ac",Box4Intl.Box4Strings.L_EuroSign);Q["\u00a3"]=new Qb("\u00a3",Box4Intl.Box4Strings.L_PoundSign);
Q["\u00a5"]=new Qb("\u00a5",Box4Intl.Box4Strings.L_YenSign);Q["\u00a9"]=new Qb("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Q["\u00ae"]=new Qb("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Q["\u2122"]=new Qb("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Q["\u00b1"]=new Qb("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Q["\u2260"]=new Qb("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Q["\u2264"]=new Qb("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);Q["\u2265"]=new Qb("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);
Q["\u00f7"]=new Qb("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Q["\u00d7"]=new Qb("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Q["\u221e"]=new Qb("\u221e",Box4Intl.Box4Strings.L_Infinity);Q["\u00b5"]=new Qb("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Q["\u03b1"]=new Qb("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Q["\u03b2"]=new Qb("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);Q["\u03c0"]=new Qb("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Q["\u03a9"]=new Qb("\u03a9",
Box4Intl.Box4Strings.L_OhmSign);Q["\u03a3"]=new Qb("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Q["\u00b0"]=new Qb("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Q["\u0394"]=new Qb("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Q["\u263a"]=new Qb("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Q["\u2665"]=new Qb("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Q["\u20b9"]=new Qb("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);Q["\u00bf"]=new Qb("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);
Q["\u00a1"]=new Qb("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Q["\u2014"]=new Qb("\u2014",Box4Intl.Box4Strings.L_EmDash);Q["\u2026"]=new Qb("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Q["\u00c0"]=new Qb("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Q["\u00c1"]=new Qb("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Q["\u00c2"]=new Qb("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);Q["\u00c3"]=new Qb("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);
Q["\u00c4"]=new Qb("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Q["\u00c5"]=new Qb("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Q["\u00c6"]=new Qb("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Q["\u00c7"]=new Qb("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Q["\u00c8"]=new Qb("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Q["\u00c9"]=new Qb("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Q["\u00ca"]=new Qb("\u00ca",
Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Q["\u00cb"]=new Qb("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Q["\u00cc"]=new Qb("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Q["\u00cd"]=new Qb("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Q["\u00ce"]=new Qb("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Q["\u00cf"]=new Qb("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);Q["\u00d1"]=new Qb("\u00d1",
Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Q["\u00d2"]=new Qb("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Q["\u00d3"]=new Qb("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Q["\u00d4"]=new Qb("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Q["\u00d5"]=new Qb("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Q["\u00d6"]=new Qb("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Q["\u00d9"]=new Qb("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);
Q["\u00da"]=new Qb("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Q["\u00db"]=new Qb("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Q["\u00dc"]=new Qb("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Q["\u00df"]=new Qb("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Q["\u00e0"]=new Qb("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Q["\u00e1"]=new Qb("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Q["\u00e2"]=new Qb("\u00e2",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Q["\u00e3"]=new Qb("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Q["\u00e4"]=new Qb("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Q["\u00e5"]=new Qb("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Q["\u00e6"]=new Qb("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Q["\u00e7"]=new Qb("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);Q["\u00e8"]=new Qb("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);
Q["\u00e9"]=new Qb("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Q["\u00ea"]=new Qb("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Q["\u00eb"]=new Qb("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Q["\u00ec"]=new Qb("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Q["\u00ed"]=new Qb("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Q["\u00ee"]=new Qb("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Q["\u00ef"]=new Qb("\u00ef",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Q["\u00f1"]=new Qb("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Q["\u00f2"]=new Qb("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Q["\u00f3"]=new Qb("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Q["\u00f4"]=new Qb("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Q["\u00f5"]=new Qb("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);Q["\u00f6"]=new Qb("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);
Q["\u00f9"]=new Qb("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Q["\u00fa"]=new Qb("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Q["\u00fb"]=new Qb("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Q["\u00fc"]=new Qb("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Q["\u00ff"]=new Qb("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Q["\u011e"]=new Qb("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Q["\u011f"]=
new Qb("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Q["\u0130"]=new Qb("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Q["\u0131"]=new Qb("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Q["\u0152"]=new Qb("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Q["\u0153"]=new Qb("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Q["\u015e"]=new Qb("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);Q["\u015f"]=new Qb("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);
Q["\u0178"]=new Qb("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Q}}Object(f.a)(sc,"SymbolsLoader",null,[1014]);var Oc=d(414),vc=d(340),ub=d(208),ae=d(635),Ve=d(1353),ve=d(226),ef=d(96);class We{constructor(Q){this.QBe=Q}get yip(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}osj(Q){Q=Q.SourceControlId.split("_");const Ca={};2===Q.length?(Ca.character=Q[1],Ca.index=this.QBe.UAi(Ca.character)):(Ca.character=Q[2],Ca.index=parseInt(Q[1]));
return Ca}hil(){return this.aIi()}build(){return this.WNm()}shl(){const Q=new Sys.StringBuilder;Q.append('<table class="moreSymbolsTable">');const Ca=this.QBe.YGg.value,sb=vg.a(Ca);let Xb=0;for(;Xb<sb.length;){Xb%15||Q.append('<tr role="presentation">');const Cc=Ca[sb[Xb]];Q.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Xb,ab.a.$_(Cc.OBe),ab.a.$_(Cc.altText)));Xb++;Xb%15&&Xb!==sb.length||Q.append("</tr>")}Q.append("</table>");return Q.toString()}WNm(){const Q=this.aIi();return ve.o(Q)}aIi(){const Q=Object.assign(new Oc.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Q.MenuSectionList.push(this.N_k());m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("InsertMoreSymbolsIsEnabled")&&Q.MenuSectionList.push(this.NYk());return Q}NYk(){const Q=Object.assign(new vc.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),Ca=Object.assign(new ub.a,{Id:"btnMoreSymbols",Command:Ed.a.c8c.toString(),LabelText:ab.a.If(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:ab.a.If(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:m.AFrameworkApplication.Vs,Image16by16Class:ef.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Q.ControlList.push(Ca);return Q}N_k(){const Q=Object.assign(new vc.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
Ca=Object.assign(new ae.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),sb=this.QBe.YGg.value,Xb=vg.a(sb),Cc=Math.min(25,Xb.length);for(let dd=0;dd<Cc;dd++){var jd=sb[Xb[dd]];jd=Object.assign(new Ve.a,{Id:String.format("{0}{1}_{2}","symbol_",dd,jd.OBe),Character:jd.OBe,Command:Ed.a.Hsb.toString(),QueryCommand:Ed.a.tse.toString(),Alt:ab.a.If(jd.altText)});Ca.GalleryItems.push(jd)}Q.ControlList.push(Ca);
return Q}}Object(f.a)(We,"SymbolsUiBuilder",null,[1013]);var sg=d(49),ke=d(252),Ue=d(549),Eh=d(338);class xi{constructor(){this.Z=null}get name(){return"Box4.Symbols"}init(){m.AFrameworkApplication.J.$("InsertSymbolIsEnabled")&&this.Z.resolve(1583).Wb()}dispose(){}uc(Q){this.Z=Q;this.Z.register(sc,"Box4.Symbols.SymbolsLoader").as(1584).ha();this.Z.ia("Box4.Symbols.SymbolsUiBuilder",()=>new We(this.Z.resolve(1584))).as(1582).ha();this.Z.ia("Box4.Symbols.SymbolsActor",()=>new Ob(m.AFrameworkApplication.va,
new Ue.a,new Eh.a,this.Z.resolve(1582),ke.a.instance,sg.a.instance,this.Z.Ra(51))).as(1583).ha()}static main(){K.a.instance.Mc(new xi)}}Object(f.a)(xi,"Box4SymbolsPackage",null,[0,1]);var Xd=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},
Ge=d(1595),qg=d(1530),Ui=d(1500),Qh=d(2E3),zh=d(298),Si=d(413);class Xi{constructor(){this.IPa=null}uc(Q){this.container=Q}init(){this.IPa=this.container.resolve(1585)}dispose(){this.IPa&&this.IPa.dispose()}}Object(f.a)(Xi,"ALiveBooksAccessibilityCheckPackageManager",null,[0,1]);class Ql{get vBl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get wBl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get xBl(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get T8n(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Itc(){return CommonUIStrings.l_AccCheckerPaneTitle}get Nbo(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(f.a)(Ql,"AccessibilityCheckStringsProvider",null,[918]);class Zk{constructor(){this.cJj=this.contentId=null}}Object(f.a)(Zk,"ResultIds",null,[]);class Tj{constructor(Q,Ca){this._element=null;this.Fg=Ca;this.oe=Q}get element(){this._element||(this._element=this.wGl(),this.gB());return this._element}rBg(Q){this._element=Q}dispose(){this.element&&(this.Vca(),this.rBg(null))}gB(){this.Fg&&this.oe?(this.Fg.nb(S.a.click,this.element,Object(O.a)(this,this.onClick,"onClick")),this.oe.nb(S.a.kj,this.element,
Object(O.a)(this,this.VI,"onKeyPress"))):wa.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}Vca(){this.Fg&&this.oe&&(this.Fg.xc(S.a.click,this.element,Object(O.a)(this,this.onClick,"onClick")),this.oe.xc(S.a.kj,this.element,Object(O.a)(this,this.VI,"onKeyPress")))}onClick(){this.Llj();return!0}VI(Q){return this.bon(Q.Nb.keyCode)?(this.Llj(),!0):!1}bon(Q){return Q===Dj.a.Xtd||Q===Dj.a.Tu}}
Object(f.a)(Tj,"AInteractivePaneElement",null,[933,11]);var ji=d(454),Bd=d(76);class $h extends Tj{constructor(Q,Ca,sb){super(Q,Ca);this.l2e=sb}hide(){this.element.removeAttribute(ee.a.Sh);ee.a.Is(this.element,ee.a.EA,ee.a.qq);this.element.style.display="none"}show(){ee.a.Is(this.element,ee.a.EA,ee.a.WO);ee.a.Is(this.element,ee.a.Sh,ee.a.sjf);this.element.style.display="block"}wGl(){const Q=ji.b("div",this.Vhj,"AccCheckerNotification");ee.a.Is(Q,ee.a.oUh,ee.a.qq);ee.a.Is(Q,ee.a.Zja,this.Ncg);Q.tabIndex=
0;const Ca=ji.b("span",this.Uhj,"AccCheckerNotificationIcon");var sb=ef.createClusteredImage(16,16,"Info_16x16x32","",!0,"");Ca.appendChild(sb);sb=ji.b("span",this.Ncg,"AccCheckerNotificationText");Bd.a.Rx(sb,this.Whj);Q.appendChild(Ca);Q.appendChild(sb);return Q}Llj(){this.l2e()}}Object(f.a)($h,"APopupNotification",Tj,[980,933,11]);class rh extends $h{constructor(Q,Ca,sb,Xb){super(Q,Ca,sb);this.rya=Xb}get Vhj(){return"AccCheckerOutOfSyncNotificationId"}get Uhj(){return"AccCheckerOutOfSyncNotificationIconId"}get Ncg(){return"AccCheckerOutOfSyncNotificationTextId"}get Whj(){return this.rya.T8n}}
Object(f.a)(rh,"OutOfSyncNotification",$h,[]);class il extends $h{constructor(Q,Ca,sb,Xb){super(Q,Ca,sb);this.rya=Xb}get Vhj(){return"AccCheckerPartialResultNotificationId"}get Uhj(){return"AccCheckerPartialResultNotificationIconId"}get Ncg(){return"AccCheckerPartialResultNotificationTextId"}get Whj(){return this.rya.Nbo}}Object(f.a)(il,"PartialResultNotification",$h,[]);var Cg=d(185),Yn=d(29),vk=d(235);class mm{constructor(Q,Ca,sb,Xb=null,Cc=null,jd=null,dd=null){this.tCh=this.GO=this.oe=this.IPa=
null;this.UXa=Xb;this.Fg=Q;this.Zb=Ca;this.kq=sb;this.rya=dd||new Ql;this.b3e=Cc||new rh(this.UXa,this.Fg,Object(O.a)(this,this.kVl,"dimissOutOfSyncNotification"),this.rya);this.R3e=jd||new il(this.UXa,this.Fg,Object(O.a)(this,this.lVl,"dimissPartialResultNotification"),this.rya)}show(){}hide(){}get UXa(){return this.oe||(this.oe=m.AFrameworkApplication.ta.eF)}set UXa(Q){this.oe=Q}M9h(){}Vsa(){}dispose(){}Mfb(){}jfn(Q){var Ca=this.tCh[Q];Q=Ca.contentId;if((Ca=Ca.cJj+"")&&Ca.length){const sb=[];Array.add(sb,
Object.assign(new Yn.a,{name:"RuleID",string:Ca}));Cg.a.sendTelemetryEvent(Object.assign(new vk.a,{name:String.format("{0}.{1}",mm.WHg,"ViolationSelected"),dataFields:sb}))}this.gSn(Q)}gSn(Q){Q&&this.IPa.eWo(Q)||(this.Zb.WN(hf.AFrame.CLh,!1),this.L8o())}kVl(){this.Bpd(!1)}lVl(){this.UUj(!1)}L8o(){const Q=Object.assign(new Hg.StandardDialog(!0),{Gu:m.AFrameworkApplication.$fa,Ed:1,nOa:!1});Q.xY(1);Q.Qe(1,this.rya.vBl);Q.Qe(0,CommonUIStrings.l_DialogCancel);Q.AY(this.rya.xBl,this.rya.wBl,Ca=>{1===Ca&&
this.nXf()})}oil(Q){let Ca=null;if(Q.Results&&0<Q.Results.length){Ca={};let sb=0;for(const Xb of Q.Results)Xb.ResultId=mm.iUk+ ++sb,Q=new Zk,Q.contentId=Xb.ContentId,Q.cJj=Xb.RuleId,Ca[Xb.ResultId]=Q}return Ca}fIn(){Cg.a.addNamespaceMapping(mm.WHg,mm.Rkp);Cg.a.sendTelemetryEvent(Object.assign(new vk.a,{name:String.format("{0}.{1}",mm.WHg,"ShowTaskpane")}))}}mm.iUk="AccCheckResult";mm.WHg="Office.UX.AccChecker";mm.Rkp="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(f.a)(mm,
"BaseAccessibilityCheckPane",null,[919,11]);class Ud{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(f.a)(Ud,"AccCheckerTaskPaneProps",null,[]);var Fe=d(1738),Rc=d(1874),ui=d(1508),uj=d(197);class Ck extends mm{constructor(Q,Ca,sb,Xb,Cc=null,jd=null,dd,oe=null,Me=null){super(Ca,
sb,Xb,jd,void 0,void 0,oe);this.i8g=null;this.eBh=this.Q3e=this.IId=this.PLd=this.nLd=!1;this.gcf=null;this.daf=!!m.AFrameworkApplication.ta&&!!m.AFrameworkApplication.ta.Hb&&m.AFrameworkApplication.ta.Hb.J1f;this.$Hc=this.v9=null;this.LIc=0;this.PCd=null;this.i1=Cc;Me&&(this.v9=Me.FQd,this.$Hc=Me.a3p,this.LIc=Me.F5p);this.RC=new Rc.a}get isVisible(){return this.eBh}N_a(Q){this.eBh=Q}tyf(Q){Q&&(this.i8g=Q,Q.IsSuccess&&(this.tCh=this.oil(Q),Q.IsPartialResult&&this.UUj(!0)),this.nLd=!0,this.PLd=!1,
this.Vm())}Bpd(Q){this.isVisible&&Q!==this.IId&&(this.IId=Q,this.Vm())}UUj(Q){this.Q3e=Q;this.Vm()}yS(){this.PLd||uj.UISurfaces.Ov().then(Q=>{Fa.a.instance.zA(Ck.sBb+":PaneOpen:Start");Q.showTaskPane(Ck.sBb,this.TB());this.nXf();return null});this.isVisible?uj.UISurfaces.Ov().then(Q=>{Q.setSelectedTaskPane(Ck.sBb);return null}):this.fIn()}Vm(){uj.UISurfaces.Ov().then(Q=>{Q.updateTaskPane(Ck.sBb,this.TB());return null})}TB(){var Q=new Ud;this.RC.Byb(Q);Q=Object.assign(new ui.a,{title:this.rya.Itc,
hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:()=>{this.xca();this.N_a(!0);m.AFrameworkApplication.ta.Fe()},onClose:()=>{this.tha();this.N_a(!1);this.PLd=this.nLd=!1;this.Vm();m.AFrameworkApplication.ta.Fe()},isModernPane:!0});this.daf&&(Q.enableResize=!0,Q.minResizeWidth=268,Q.maxResizeWidth=920);return Q}initialize(Q){const Ca=this.Zb.ie(Ck.sBb);Ca.parent=hf.AFrame.Kq;Ca.YL=!0;this.IPa=Q;this.qVk()}dispose(){this.Mfb();this.b3e&&(this.b3e.dispose(),this.b3e=null);this.R3e&&(this.R3e.dispose(),
this.R3e=null);super.dispose()}qVk(){this.RC.XN(this.onRecheckExecute());this.RC.XN(this.ahm());this.RC.XN(this.HJm());this.RC.XN(this.onInvokeNavigateExecute());this.RC.XN(this.lwm());this.RC.XN(this.vEm());this.RC.XN(this.sGm());this.RC.XN(this.updateLastScanTime());this.RC.XN(this.showHelpPane())}onRecheckExecute(){return Q=>{Q.onRecheckExecute=()=>{this.nXf()}}}ahm(){return Q=>{Q.accessibilityCheckResultCollection=this.i8g}}HJm(){return Q=>{Q.resultsReady=this.nLd}}onInvokeNavigateExecute(){return Q=>
{Q.onInvokeNavigateExecute=Ca=>{this.jfn(Ca)}}}lwm(){return Q=>{Q.helpLink=this.d6l}}vEm(){return Q=>{Q.outOfSync=this.IId}}sGm(){return Q=>{Q.partialResult=this.Q3e}}updateLastScanTime(){return Q=>{Q.updateLastScanTime=Ca=>{this.gcf=Ca}}}showHelpPane(){return Q=>{Q.showHelpPane=()=>{m.AFrameworkApplication.J&&m.AFrameworkApplication.J.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?m.AFrameworkApplication.vL||this.XTh()?this.PCd?this.PCd():this.v9.value&&this.$Hc&&
this.LIc&&this.v9.value.Pb(this.LIc,2,this.$Hc):this.SVj():this.XTh()?this.PCd?this.PCd():this.v9.value&&this.$Hc&&this.LIc&&this.v9.value.Pb(this.LIc,2,this.$Hc):this.SVj()}}}XTh(){return!this.i1||!this.i1.value}SVj(){const Q=this.i1.value;if(Q){var Ca={};Ca.query=Ck.OKk+Ck.ezk;Ca=Object.assign(new Fe.a,{dV:Ca});Q.O8(Ck.AUe,Ca)}}nXf(){this.Q3e=this.IId=this.nLd=!1;this.gcf&&this.gcf();this.Vm();this.PLd=!0;this.IPa.tYn()}xca(){this.Zb.Eg(Ck.sBb)}tha(){this.bbb()&&this.Zb.Eg(this.Zb.bX)}bbb(){return!!this.Zb.currentScope&&
this.Zb.currentScope.name===Ck.sBb}}Ck.sBb="AccessibilityCheckerPane";Ck.ezk="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Ck.AUe="FA000000012";Ck.OKk="AssetID=";Object(f.a)(Ck,"ReactAccessibilityCheckPane",mm,[]);class Wm extends Ck{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me=null){super(Q,Ca,sb,Xb,Cc,jd,void 0,Me);this.Qvk=oe;this.g6=dd}get d6l(){return this.Qvk}yS(){this.g6.GUa();super.yS()}}Object(f.a)(Wm,"ReactLiveBooksAccessibilityCheckPane",Ck,[]);var Bm=d(1775),Xm=d(138),nj=d(104),ep=d(60),sj=d(119),Ik=
d(618),Yi=d(518),Rh;(function(Q){Q[Q.error=0]="error";Q[Q.warning=1]="warning";Q[Q.Qqq=2]="tip";Q[Q.z7p=3]="intelligentService"})(Rh||(Rh={}));Object(f.b)("AccessibilityRuleCategory",Rh);class ze{constructor(Q,Ca,sb=null){this.sJe=null;this.qph=this.Ynh=!1;this.vTa=Q;this.mwd=Ca;this.ga=sb;this.Qb.qa(x.a.Mul,z.a.frame,Object(O.a)(this,this.Opf,"closePane"))}get Qb(){return this.ga||(this.ga=m.AFrameworkApplication.va)}set Qb(Q){this.ga=Q}b2l(){this.Ynh||(this.vTa.initialize(this),this.mwd.initialize(this),
this.Ynh=!0)}tYn(){R.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.mwd.bMo()}yS(Q,Ca,sb){if(1===sb)return Ke.SessionStatusManager.instance.Nk?8:32;this.vTa.isVisible||this.b2l();this.v$o();return 32}Opf(Q,Ca,sb){1!==sb&&this.vTa.Vsa();return 32}p4n(){this.vTa.Bpd(!0)}tyf(Q){if(Q){if(Q.AccessibilityRules&&Object.keys(Q.AccessibilityRules).length){const sb=Q.AccessibilityRules;for(const Xb in sb){var Ca=Xb;const Cc=sb[Xb].RuleId+"";Ca!==Cc&&R.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
Ca,Cc)}this.sJe=sb}else!this.sJe&&Q.Results&&0<Q.Results.length?(R.b(18993251,200,15,"No accessibility rule definitions available"),Q.IsSuccess=!1):Q.AccessibilityRules=this.sJe;Q.IsSuccess||R.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.jBo(Q);this.WHn(Q);this.vTa.tyf(Q)}}jBo(Q){const Ca=Q.AccessibilityRules;if(Q=Q.Results)for(let sb=Q.length-1;0<=sb;sb--){const Xb=Q[sb];let Cc="";const jd=Xb.RuleId;Xb.ContentName||(Cc+="Result does not have content name. ");jd in Ca||(Cc+=String.format("No accessibility check rule exists for ID {0}.",
jd));0<Cc.length&&(R.b(36214999,200,15,"Omitting invalid accessibility check result: "+Cc),Array.removeAt(Q,sb))}}NKm(){return m.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):Na.a.instance.resolve(78).$D.loadScript("accessibility-checker-pane-strings")}v$o(){this.qph?this.vTa.yS():this.NKm().then(()=>{this.qph=!0;this.vTa.yS()}).catch(Q=>wa.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
Q))}WHn(Q){var Ca={};const sb={};var Xb=Q.Results,Cc=[];Array.add(Cc,Object.assign(new Yn.a,{name:"FinalViolationCount",int64:0}));Array.add(Cc,Object.assign(new Yn.a,{name:"FinalErrorCount",string:"0"}));Array.add(Cc,Object.assign(new Yn.a,{name:"FinalWarningCount",string:"0"}));Array.add(Cc,Object.assign(new Yn.a,{name:"FinalTipCount",string:"0"}));Array.add(Cc,Object.assign(new Yn.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Xb){for(const oe of Xb)if(Q.AccessibilityRules){var jd=Q.AccessibilityRules[oe.RuleId];
if(jd){if(Ca[Rh[jd.Category]]){let Me=Ca[Rh[jd.Category]];Ca[Rh[jd.Category]]=++Me}else Ca[Rh[jd.Category]]=1;sb[oe.RuleId]?(jd=sb[oe.RuleId],sb[oe.RuleId]=++jd):sb[oe.RuleId]=1}}Cc[0].int64=Xb.length;for(var dd in Ca)switch(Q=Ca[dd],Xb=dd,Xb="Final"+Xb.charAt(0).toUpperCase()+Xb.substring(1,Xb.length)+"Count",Xb){case "FinalErrorCount":Cc[1].string=Q.toString();break;case "FinalWarningCount":Cc[2].string=Q.toString();break;case "FinalTipCount":Cc[3].string=Q.toString();break;case "FinalIntelligentServiceCount":Cc[4].string=
Q.toString()}}Cg.a.sendTelemetryEvent(Object.assign(new vk.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Cc}));for(const oe in sb)Ca=oe,Cc=sb[oe],dd=[],Array.add(dd,Object.assign(new Yn.a,{name:"RuleID",string:Ca})),Array.add(dd,Object.assign(new Yn.a,{name:"FinalViolationCount",string:Cc.toString()})),Cg.a.sendTelemetryEvent(Object.assign(new vk.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:dd}))}dispose(){this.vTa&&
this.vTa.dispose();this.mwd&&this.mwd.dispose()}}Object(f.a)(ze,"AAccessibilityCheckManager",null,[33,11]);var Yf=d(453);const wb=[12,14,22,19,30,43,44];class gc extends ze{constructor(Q,Ca,sb,Xb,Cc,jd){super(Ca,sb,Q);this.Qb.qa(x.a.fDg,z.a.frame,this.yS.bind(this));this.Qb.fb(x.a.Hno,z.a.frame,this.Rxj.bind(this),96);this.TR=Cc;this.$Fk=Xb;this.sCk=jd;this.dtc=()=>{this.p4n()};this.Fxo()}Rxj(Q,Ca,sb,Xb,Cc){if(1===sb)return 32;Cc[Yf.a.On]=this.vTa.isVisible;return 32}eWo(Q){if(this.sCk)return wa.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;wa.ULS.shipAssertTag(20272215,334,!!Q);return this.$Fk.$Rn(Q)}Fxo(){for(const Q of wb){const Ca=this.TR.jf(Q);Ca.ro(this.dtc);Ca.wt(this.dtc);Ca.ly(this.dtc)}}uvp(){for(const Q of wb){const Ca=this.TR.jf(Q);Ca.XP(this.dtc);Ca.vS(this.dtc);Ca.bva(this.dtc)}}dispose(){super.dispose();this.uvp()}}Object(f.a)(gc,"WordAccessibilityCheckManager",ze,[]);var Sc=d(83),Xc=d(25),se=d(100),Qf=d(127),Jf=d(165),lf=d(5),tf=d(18),ei=d(480);class Ug{constructor(Q,
Ca,sb,Xb,Cc,jd,dd){this.an=null;this.iNb=0;this.$c=Ca;this.FG=sb;this.ib=Xb;this.ga=Cc;this.od=jd;this.Sy=Q;this.zd=dd}get oQ(){if(!this.an){const Q=this.$c.lg(this.Sy.ed);this.FG.GKg(Q);if(Q.vb(7)||Q.fd(7))this.an=Sc.a.Bt(Q,Q.origin)}return this.an}$Rn(Q){if(!Q||!Q.Qg||0>=Q.Qg.length)return wa.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var Ca=Array(Q.Qg.length);let sb=7,Xb=null;for(let jd=0;jd<Q.Qg.length;jd++)if(Xb=this.r$l(Q.Qg[jd])){if(7===sb)sb=this.iNb;else if(sb!==
this.iNb)return wa.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var Cc=this.zd.mZa(Xb.characterData,Xb.ra);const dd=Q.cpBegin?this.zd.FMb(Cc,Q.cpBegin):-1;Cc=Q.cpEnd?this.zd.FMb(Cc,Q.cpEnd):-1;if(-1>dd||-1>Cc)return wa.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;Ca[jd]=Xc.a.hU(dd,Cc,!1,Xb);switch(Q.contentType){case 5:if(!se.a.b6c(Ca[jd],!1))return!1;break;case 6:if(!Qf.a.K7(Ca[jd]))return!1;
break;case 7:Ca[jd]=Xc.a.hU(-1,-1,!1,Xb)}}else return!1;Ca=new Jf.Selection(Ca,!1);return this.b0o(Xb,Ca,Q.contentType)}r$l(Q){if(this.oQ)for(this.oQ.reset(),this.iNb=7;this.oQ.moveNext();){var Ca=this.oQ.currentNode.type;if(38===Ca||36===Ca||23===Ca)this.iNb=Ca;else if(12===Ca){Ca=this.oQ.currentNode;const sb=Ca.ka(lf.a.Zc,0);if(Q===sb)return Ca}}return null}l_j(Q){this.ga.Ob(tf.a.dX,2);this.ga.Ob(tf.a.U6,2);let Ca=2;switch(this.iNb){case 23:Ca=32;break;case 38:Ca=this.ga.Pb(tf.a.Acb,2,new ei.a(Q));
break;case 36:Ca=this.ga.Pb(tf.a.xub,2,new ei.a(Q));break;default:wa.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.iNb)}if(32===Ca)return!0;wa.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.iNb);return!1}b0o(Q,Ca,sb){if(this.l_j(Q)){Q=this.Sy.Fw;const Xb=this.ib.gb.currentSelection;Xb&&Xb.equals(Ca)&&this.od.Bha(Q,null);this.od.Bha(Q,Ca);switch(sb){case 0:case 1:this.ga.Ob(Ed.a.C_b,2);break;case 2:this.ga.Ob(Ed.a.Xmd,2);break;case 3:this.ga.Ob(Ed.a.aEa,
2)}return!0}return!1}}Object(f.a)(Ug,"WordAccessibilityCheckNavigateManager",null,[1306]);class Gc{constructor(Q){this.IPa=null;this.Ajh=Q}get fileId(){return this.Ajh?this.Ajh():null}initialize(Q){this.IPa=Q}bkj(Q){this.IPa.tyf(Q)}}Object(f.a)(Gc,"AAccessibilityCheckService",null,[920,11]);class Fn{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Q){Q=Sys.Serialization.JavaScriptSerializer.deserialize(Q);const Ca=Q.AccessibilityRules,
sb={};if(Ca)for(let Xb=0;Xb<Ca.length;++Xb){const Cc=Ca[Xb];sb[Cc.Key]=Cc.Value}Q.AccessibilityRules=sb;return Q}}Object(f.a)(Fn,"AccessibilityCheckResultCollection",null,[]);class Wl extends Gc{constructor(Q){super(Q);this.onFailure=(Ca,sb)=>{wa.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",sb);Ca=Object.assign(new Fn,{IsSuccess:!1});this.bkj(Ca)};this.ME=Ca=>{Ca=Wl.FJm(Ca);let sb=null;if(Ca)try{sb=this.CSl(Ca)}catch(Xb){wa.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",
Xb.message),sb=Object.assign(new Fn,{IsSuccess:!1})}else wa.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),sb=Object.assign(new Fn,{IsSuccess:!1});this.bkj(sb)}}dispose(){}static FJm(Q){let Ca=null;Q&&Q.hk&&(Ca=Q.hk[0]);return Ca?Ca.Body:null}}Object(f.a)(Wl,"ALiveBooksAccessibilityCheckService",Gc,[]);var Xg=d(839),Zi=d(996),Go=d(1345),Ym=d(256),Jk=d(448);class zo extends Ym.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}en(){return Jk.a.hUk}static construct(Q,
Ca){const sb=new zo;sb.FileId=Q;sb.IsCoauthorable=Ca;return sb}}Object(f.a)(zo,"WordAccessibilityCheckRequest",Ym.a,[]);class Li{}Object(f.a)(Li,"AccessibilityCheckRule",null,[]);var $k=d(183);class Kk{static parse(Q){switch(ab.a.xh(Q)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw Q=String.format("Invalid Accessibility result category: {0}",Q),$k.a.argument(Q);}}}Object(f.a)(Kk,"AccessibilityRuleCategoryParser",null,[]);class lq{constructor(){this.Category=
this.Text=this.Id=null}static bnp(Q){const Ca=new Li;Ca.RuleId=Q.Id;Ca.RuleName=Q.Text;Ca.Category=Kk.parse(Q.Category);return Ca}}Object(f.a)(lq,"WordAccessibilityCheckRule",null,[]);class jr{}Object(f.a)(jr,"AccessibilityCheckResult",null,[]);class mc{constructor(){this.cpEnd=this.cpBegin=this.Qg=null;this.contentType=0}}Object(f.a)(mc,"WordAccessibilityCheckContentId",null,[]);const wk=Q=>{switch(ab.a.xh(Q)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;
case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var Ho=d(1546);class Zl{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static $mp(Q){const Ca=new jr;Ca.RuleId=Q.RuleId;Ca.ContentName=Q.Label;const sb=new mc;sb.Qg=Q.ParaId;sb.cpBegin=Ho.b(Q.OS);sb.cpEnd=Ho.b(Q.OE);sb.contentType=wk(Q.ContentType);Ca.ContentId=sb;return Ca}}Object(f.a)(Zl,"WordAccessibilityViolation",null,
[]);class kr{constructor(){this.Violations=this.Rules=null}static anp(Q){const Ca=new Fn;try{var sb={};if(Q.Rules){for(let Xb=0;Xb<Q.Rules.length;++Xb){const Cc=lq.bnp(Q.Rules[Xb]);sb[Cc.RuleId]=Cc}Ca.AccessibilityRules=sb}if(Q.Violations){const Xb=Array(Q.Violations.length);for(sb=0;sb<Q.Violations.length;++sb)Xb[sb]=Zl.$mp(Q.Violations[sb]);Ca.Results=Xb}Ca.IsPartialResult=!1;Ca.IsSuccess=!0}catch(Xb){wa.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",
Xb.message),Ca.IsSuccess=!1}return Ca}}Object(f.a)(kr,"WordAccessibilityCheckResult",null,[]);class Io extends Wl{constructor(Q,Ca,sb){super(Q);this.XDb=Ca;this.mjb=sb}bMo(){const Q=Object.assign(new Xg.a,{Zq:zo.construct(this.fileId,this.mjb),status:Zi.a.DH,RE:"AccessibilityCheck"});this.XDb(Go.a.jUk,!1,this.ME,this.onFailure,Q,null,Q)}CSl(Q){Q=$a.b(Q);return kr.anp(Q)}}Object(f.a)(Io,"WordAccessibilityCheckService",Wl,[]);class Vo extends Xi{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}uc(Q){super.uc(Q);
Q.ia(1586,()=>new Wm(m.AFrameworkApplication.va,zh.a.instance,Of.FocusManager.instance(),Si.a.instance,Q.rf(1200),ed.KeyInputManager.instance,Bm.a.instance,m.AFrameworkApplication.J.jb("AccessibilityCheckerHelpUrl"))).ha();Q.ia(1587,()=>new Io(()=>m.AFrameworkApplication.rootQuerySignature,Yi.a.sU,Xm.PageReader.instance.f7d(Wc.StaticActiveAppFrame.za().kb.ed))).ha();Q.ia(1588,()=>new Ug(Wc.StaticActiveAppFrame.za().kb,Q.resolve(293),Object(nj.a)(),Q.resolve(327),m.AFrameworkApplication.va,Object(ep.a)(),
Q.resolve(1235))).ha();Q.ia(1585,()=>new gc(m.AFrameworkApplication.va,Q.resolve(1586),Q.resolve(1587),Q.resolve(1588),sj.a.ff.Pl,Ik.a.j$c)).ha()}init(){this.container.resolve(23).Qr.continueWith(()=>{Xi.prototype.init.call(this)})}}Object(f.a)(Vo,"WordAccCheckerPackageManager",Xi,[]);var Jo;(function(Q){Q[Q.c5p=0]="graphSpaceReplicatorNotSendingContent";Q[Q.W6p=1]="inboundRequestTakesTooLongToSendAfterRTC";Q[Q.l0p=2]="docxSaveMonitorKickoutElapsed"})(Jo||(Jo={}));Object(f.b)("ComponentLoggingScenario",
Jo);var eo=d(1338);class uc{flush(Q,Ca){const sb=this.Mqm(Q);sb.LoggingScenario=Jo[Ca];vg.a(sb).length?wa.ULS.sendTraceTag(594571986,3013,15,"{0}",sb):wa.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",eo.a[Q.k7a])}Mqm(Q){const Ca={};if(!Q)return Ca;const sb=new Kd.a;for(sb.enqueue(Q);!sb.isEmpty;){Q=sb.dequeue();const Xb=eo.a[Q.k7a];try{Ca[Xb]=Q.kD()}catch(Cc){wa.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",
Xb.toString(),{["Kind"]:"Exception",["Stack"]:Cc.stack,["Message"]:Cc.message,["FileName"]:Cc.fileName,["LineNumber"]:Cc.lineNumber})}if((Q=Q.eXd)&&Q.length)for(const Cc of Q)!Cc||eo.a[Cc.k7a]in Ca||sb.enqueue(Cc)}return Ca}}Object(f.a)(uc,"ComponentStateLogManager",null,[1011]);class hn{flush(){}}Object(f.a)(hn,"NoOpComponentStateLogManager",null,[1011]);class Mn{constructor(){this.Z=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.Z.resolve(1576)}dispose(){}uc(Q){this.Z=Q;m.AFrameworkApplication.J.$("ComponentStateLoggingPackageIsEnabled")?
Q.ia("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new uc).as(1576).ha():Q.ia("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new hn).as(1576).ha()}static main(){K.a.instance.Mc(new Mn)}}Object(f.a)(Mn,"WordEditorComponentStateLoggingPackage",null,[0,1]);var vm=d(1166),xl=d(641),kk=d(780),Hl=d(781),al=d(67);class Ng{constructor(Q,Ca=null,sb=-1,Xb=null){this.h2=Q;this.AKh=Xb||(()=>Ca);this.Izd=sb}Xj(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf=null,uh=!1,wj=null,Sh=null){const qi=
new XMLHttpRequest;let yk="";jd="";2===Ca?(yk="POST",sb&&(jd=sb)):yk="GET";Ca={};this.h2&&(Q=vm.a.GXk(Ca,Q,al.a.UFe,m.AFrameworkApplication.PAb,this.h2));qi.open(yk,Q,!0);this.mil(Ca,Q);if(Xb)for(const Hn in Xb)qi.setRequestHeader(Hn,ab.a.tP(Xb[Hn]));for(const Hn in Ca)qi.setRequestHeader(Hn,Ca[Hn]);Q=wj||this.Izd;0<Q&&(qi.timeout=Q);Q=[];Array.add(Q,al.a.H2);Xb=new Sys.Net.WebRequest;const Zo=new kk.a(1,2,Xb,Q,Cc,dd,oe,Me,uh,zf,Sh);qi.onreadystatechange=()=>{this.I3n(qi,Zo)};try{qi.send(jd)}catch(Hn){wa.ULS.sendTraceTag(24938643,
205,15,"Invoke failed in SimpleClientRequestSender")}return 1}dlc(){return 1}I3n(Q,Ca){if(this.Vql(Q,Ca)&&4===Q.readyState)if(Q.getResponseHeader(al.a.eki)&&m.AFrameworkApplication.A_c)m.AFrameworkApplication.A_c();else{var sb=Q.getResponseHeader(al.a.Gnf);vm.a.SEe(sb);this.NBp(Q,Ca);Q.status===Mi.a.xz?(Ca.status=2,Ca.xK(new Hl.a(Ca))):(Ca.status=Q.status&&Q.status!==Mi.a.Axb?Q.status===Mi.a.u8?5:3:7,Ca.e7(new xl.a(Ca)))}}mil(Q,Ca){Q["X-xhr"]=1;m.AFrameworkApplication.yXa&&(Q[al.a.O$i]=1);m.AFrameworkApplication.buildVersion&&
(Q[al.a.tsc]=ab.a.tP(m.AFrameworkApplication.buildVersion));let sb=null;this.AKh&&(sb=this.AKh());sb&&(Q[al.a.HOg]=sb);m.AFrameworkApplication.hN&&(Q[al.a.ILb]=ab.a.tP(m.AFrameworkApplication.hN),m.AFrameworkApplication.drc&&wa.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",Q[al.a.ILb]));m.AFrameworkApplication.accessToken&&(vm.a.V1h(Ca,m.AFrameworkApplication.m6)||(Q[al.a.XLh]=ab.a.tP(m.AFrameworkApplication.accessToken)),vm.a.V1h(Ca,m.AFrameworkApplication.Iqa)||(Q[al.a.YLh]=m.AFrameworkApplication.uTa.toString()));
m.AFrameworkApplication.userType&&(Q[al.a.gak]=ab.a.tP(m.AFrameworkApplication.userType))}NBp(Q,Ca){Ca.He=Q.status?Q.status:Mi.a.Axb;try{Ca.Ee=Q.responseText;if(void 0!==Ca.m_a&&null!==Ca.m_a){Ca.wi={};for(let sb=0;sb<Ca.m_a.length;++sb){const Xb=Ca.m_a[sb];Ca.wi[Xb]=Q.getResponseHeader(Xb)}}Ca.jze&&(Ca.sna=Q.responseText&&Q.responseText.length?Q.responseXML:null)}catch(sb){wa.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",
Ca.id,Ca.request.get_url(),4===Q.readyState)}}Vql(Q,Ca){return Q?Ca?!0:(wa.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),!1):(wa.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(Q,Ca,sb){return new Ng(Q,null,sb,Ca)}}Object(f.a)(Ng,"SimpleClientRequestSender",null,[1794]);class Ep{constructor(Q,Ca,sb){this.Gf=Q;this.ZMd=Ca;this.cBh=sb}Xj(Q,Ca,sb,Xb,Cc,
jd,dd,oe,Me,zf=null,uh=!1,wj=null,Sh=null,qi=null,yk=null,Zo=!1){return this.cBh?this.ZMd.Xj(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf,uh,Sh,qi):this.Gf.Xj(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf,uh,wj,Sh,qi,yk,Zo)}dlc(Q){return this.cBh?this.ZMd.dlc():this.Gf.dlc(Q)}}Object(f.a)(Ep,"ClientRequestAdapter",null,[1870]);var nm=d(220),Mf=d(257),Cm=d(230),Yg=d(1283),Uj=d(1292),Zm=d(1347),Tk=d(43),Wo=d(735),fo=d(596),Vn=d(88),po=d(578),Rp=d(606),dq;(function(Q){Q[Q.none=0]="none";Q[Q.Kui=1]="getCells";Q[Q.Cae=2]="hotStoreStatus";
Q[Q.MJj=3]="saveMonitor";Q[Q.bmq=4]="saveMonitor_LineageTombstone";Q[Q.lub=5]="kickoutExecutor"})(dq||(dq={}));Object(f.b)("MostRecentRevisionIdOrigin",dq);class Rl extends Sys.EventArgs{constructor(Q,Ca,sb,Xb){super();this.obb=Q;this.httpStatusCode=sb;this.gk=Xb}}Object(f.a)(Rl,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class yl{constructor(){this.A$=0}get isEmpty(){return!this.A$}OSc(Q){this.A$|=Q}N$c(Q){return!!(this.A$&Q)}clear(){this.A$=0}$Uc(){return!1}}Object(f.a)(yl,"DocxSaveMonitorRetryAttemptOnce",
null,[]);class fj{constructor(Q,Ca=3){this.A$=0;this.qLd=new Map;this.pFk=Q;this.iMk=Ca}get isEmpty(){return!this.A$}OSc(Q){this.A$|=Q;let Ca=this.qLd.get(Q)||0;this.qLd.set(Q,++Ca)}N$c(Q){return!!(this.A$&Q)}clear(){this.A$=0;this.qLd.clear()}$Uc(Q){return this.iMk&Q?(this.qLd.get(Q)||0)<this.pFk:!1}}Object(f.a)(fj,"DocxSaveMonitorRetryAttemptMany",null,[]);class Fp{static create(Q=!1,Ca=3,sb=0){return Q?new fj(Ca,sb):new yl}}Object(f.a)(Fp,"DocxSaveMonitorRetryAttemptFactory",null,[]);class Sl extends Ym.a{constructor(){super();
this.CellId=this.FileId=null}en(){return Jk.a.kLf}static construct(Q){const Ca=new Sl;Ca.FileId=Q.Lj().Fq;Ca.CellId=Vn.a(Q.Ic.id);return Ca}}Object(f.a)(Sl,"LastSavedRevisionRequest",Ym.a,[]);var Gp;(function(Q){Q[Q.Rfq=-1]="noResultYet";Q[Q.dsq=0]="upToDate";Q[Q.knq=1]="sessionLost";Q[Q.tsq=2]="userSignedOut";Q[Q.tjq=3]="previousRequestPending";Q[Q.Rue=4]="requestFailed";Q[Q.Xnq=5]="shuttingDown";Q[Q.wgq=6]="nullResponseData";Q[Q.U7p=7]="invalidResponseData";Q[Q.j2p=8]="failedRevisionLookup";Q[Q.mmq=
9]="savedWithinThreshold";Q[Q.dgq=10]="notSavedWarning";Q[Q.A8p=11]="kickoutThreshold";Q[Q.zrq=12]="unknownRevision";Q[Q.SYp=13]="contentNotYetLoaded";Q[Q.aTo=14]="sessionExpired";Q[Q.dnl=15]="canaryError";Q[Q.timeout=16]="timeout";Q[Q.B8p=17]="kickoutThreshold_Offline";Q[Q.x0p=18]="dssSessionDeleted";Q[Q.y0p=19]="dssSessionExpired";Q[Q.Ksq=20]="waitingForSessionTokenRefresh";Q[Q.z0p=21]="dssSessionNotFound"})(Gp||(Gp={}));Object(f.b)("SaveMonitorResult",Gp);class th{constructor(Q,Ca,sb,Xb,Cc,jd,
dd,oe,Me,zf,uh,wj,Sh,qi,yk,Zo,Hn,zn,At,Ba,Ra,Ga,xa,Ua,Kb,Zb=null,qc){this.cMc=0;this.A8b=!1;this.ROc=null;this.IKc=this.FZ=-1;this.U4e=null;this.SJd=0;this.TJd=!1;this.wGb=null;this.RMc=0;this.H7e=this.iIh=null;this.YV=this.ush=this.YGc=0;this.m_e=null;this.tph=!1;this.xk=null;this.ECh=this.$Md=0;this.bFh=!1;this.yam=()=>{var Bc;wa.ULS.sendTraceTag(524871194,th.Un,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.PU,["AppVisibilityState"]:Yg.a[null===(Bc=this.xk)||void 0===Bc?void 0:Bc.DA]});try{if(this.rIc){var Mc=
this.rIc();wa.ULS.sendTraceTag(509367249,th.Un,50,"Additional Details: {0}",Mc)}}catch(md){Bc=$a.c({["Kind"]:"Exception",["Stack"]:md.stack,["Message"]:md.message,["FileName"]:md.fileName,["LineNumber"]:md.lineNumber}),wa.ULS.sendTraceTag(509367062,th.Un,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Bc)}Bc=this.AFb;this.AFb=this.uB();if(this.Hda())this.AB.event(5),this.stop("session has shut down");else if(this.ljb===th.QHj&&this.UEa(this.HDb),Mc=
this.F7b())if(this.PU)this.AB.event(0);else if(this.F8b())this.AB.event(1),this.stop("session is lost"),m.AFrameworkApplication.nd("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.tph&&!this.con()&&(wa.ULS.sendTraceTag(554726995,th.Un,10,"DocxSaveMonitor: Session lost but not kicked out"),this.hK(Tk.a.Phi));else if(this.uqh())20!==this.AB.currentState?(this.AB.event(20),this.iIh=this.uB(),wa.ULS.sendTraceTag(593510691,th.Un,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",
this.kIh)):this.uB().getTime()-this.iIh.getTime()>this.kIh&&(this.AB.event(14),this.Zge(20,Tk.a.n0d,"TokenExpired"));else if(this.pDk())if(this.AFb=Bc,this.A8b)this.AB.event(3),this.uB().getTime()-this.ROc.getTime()>this.AZe&&(Bc=this.eNe.dlc(this.FZ),wa.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.FZ,Nm.a[Bc]),this.bLd&&this.bLd.log(),this.stop("stuck on previousRequestPending"),this.hK());else if(Bc=fo.b(Sl.construct(Mc)),this.A8b=
!0,this.ROc=this.RLk(),this.FZ=this.eNe.Xj(th.serviceUrl,2,Bc,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.Yql,this.Xql,null,void 0,void 0,this.A5e,this.OPc,void 0,void 0,!0),0>=this.FZ)this.A8b=!1,wa.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.FZ.toString());else{Bc=this.eNe.dlc(this.FZ);Mc=100;if(Bc&&1!==Bc||this.Jmh)Mc=50;wa.ULS.sendTraceTag(19161612,th.Un,Mc,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.FZ,["Status"]:Nm.a[Bc]});
this.bLd&&this.bLd.start(this.FZ)}else this.AB.event(2);else this.AB.event(13)};this.Xql=Bc=>{this.YV=this.mXd+1;let Mc=this.A8b=!1,md=!1;Bc=Bc.data;kb.a.om&&m.AFrameworkApplication.tga("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");Bc?(wa.ULS.sendTraceTag(22552773,th.Un,15,"Request failed {0}",{["Status"]:Bc.status,["HttpStatus"]:Bc.He,["Correlation"]:Bc.wi?Bc.wi[al.a.H2]:"",["Id"]:Bc.id,["ConsecutiveErrors"]:this.mXd,["Request.InvokedTime"]:Bc.rH,["Request.EnqueueTime"]:Bc.gsa,
["Request.CompletedTime"]:Bc.bP}),md=7===Bc.status||13===Bc.status,this.$Uc(2)&&md?(this.a2a.OSc(2),Mc=!0,this.IKc=Bc.He,this.AB.event(16)):this.$Uc(1)&&5===Bc.status?(this.a2a.OSc(1),Mc=!0,this.IKc=Bc.He,this.AB.event(15)):(this.AB.event(4),this.IKc=Bc.He)):(this.AB.event(4),wa.ULS.sendTraceTag(23425240,th.Un,15,"RequestFailed and event data is null"));if(!Mc&&(this.a2a.clear(),md?this.Zge(17,Tk.a.TYl,"while offline"):this.Zge(11,Tk.a.azf,"while online")))return;this.UEa(Mc?this.Jjm(md):this.HDb)};
this.Yql=Bc=>{this.YV=this.mXd+1;this.A8b=!1;var Mc={};this.a2a.clear();if(Bc=Bc.data){var md=Bc.wi?Bc.wi[al.a.H2]:"";Mc.HttpStatus=Bc.He;Mc.Correlation=md;Mc.Id=Bc.id;wa.ULS.sendTraceTag(23425242,th.Un,this.Jmh?50:100,"Request succeeded at the HTTP level {0}",Mc);this.IKc=Bc.He}else wa.ULS.sendTraceTag(23425241,th.Un,15,"Request succeeded with null response data");if(this.Hda()||!this.o0d)this.AB.event(5),this.stop("session has shut down");else if(!this.Gtn())if(Bc&&Bc.Ee)if(Bc=this.RUa(Bc.Ee))if(this.TH.qPa(Bc),
Bc.StatusCode)this.Z2f(Bc,Mc)||this.AB.event(8,Mc);else{this.YV=0;this.AFb=this.uB();this.S6e.clear();Mc={["LastSavedRevisionId"]:Bc.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:Bc.RevisionSequenceNumber};Bc=Vn.b(Bc.LastSavedRevisionId);this.wyb(Bc,3);var gd=this.CIf().r_a.d5c(Bc);if(gd){Bc=null;md=this.Qqb();gd=(gd=gd.KVa(md))?gd.id:cc.a.nil;let ud=md;for(;ud&&!ud.id.equals(gd);)Bc=ud,ud=ud.WG;this.aYm(Bc,Mc,md)||this.AB.event(9)}else this.GWm()||this.AB.event(12,Mc);this.UEa(this.dbc)&&
wa.ULS.sendTraceTag(22552774,th.Un,50,"Received response from server -- going back to normal interval")}else this.AB.event(7),this.$2f("invalid response",Mc);else this.AB.event(6),this.$2f("null response",Mc)};this.XJo=(Bc,Mc)=>{Bc={};Bc.DocxSaveMonitorState=Gp[Mc.newState];Bc.PreviousState=Gp[Mc.Jmg];Bc.PreviousStateHits=Mc.Kmg;Bc.PreviousStateTransitionTime=Mc.Lmg.toISOString();Bc.LastHttpStatus=this.IKc;Bc.LastSuccessTime=this.AFb.toISOString();this.ROc&&(Bc.LastRequestStartTime=this.ROc.toISOString());
Bc.LastSavedRevisionID=this.hke.toString();Bc.LastSavedRevisionIdOrigin=this.cMc;Bc.LastSavedRevisionIdSetTime=this.H7e?this.H7e.toISOString():null;Bc.IsViable=this.lf.rCa;Bc.IsNetworkConnected=this.lf.cB;Bc.IsExpired=this.lf.pba;Bc.HasEmergencyViewModeBeenDeployed=this.lf.Nk;Bc["Navigator.Online"]=window.navigator.onLine;const md=Mc.vfp;md&&th.eej(Bc,md);Mc=Mc.newState;switch(Mc){case 13:wa.ULS.sendTraceTag(5830086,th.Un,50,"{0}",Bc);break;case 1:wa.ULS.sendTraceTag(5884125,th.Un,50,"{0}",Bc);break;
case 0:wa.ULS.sendTraceTag(5830087,th.Un,50,"{0}",Bc);break;case 2:wa.ULS.sendTraceTag(5830088,th.Un,50,"{0}",Bc);break;case 3:wa.ULS.sendTraceTag(5830089,th.Un,50,"{0}",Bc);break;case 4:wa.ULS.sendTraceTag(5884126,th.Un,50,"{0}",Bc);break;case 5:wa.ULS.sendTraceTag(5884127,th.Un,50,"{0}",Bc);break;case 6:wa.ULS.shipAssertTag(5830090,th.Un,!1,"{0}",Bc);break;case 7:wa.ULS.shipAssertTag(5830091,th.Un,!1,"{0}",Bc);break;case 8:wa.ULS.sendTraceTag(5830092,th.Un,15,"{0}",Bc);break;case 10:wa.ULS.sendTraceTag(5830094,
th.Un,15,"{0}",Bc);break;case 9:wa.ULS.sendTraceTag(5884128,th.Un,50,"{0}",Bc);break;case 11:wa.ULS.sendTraceTag(5830096,th.Un,15,"{0}",Bc);break;case 17:wa.ULS.sendTraceTag(37835678,th.Un,15,"{0}",Bc);break;case 12:wa.ULS.sendTraceTag(5830095,th.Un,15,"{0}",Bc);break;case 18:wa.ULS.sendTraceTag(38122832,th.Un,15,"{0}",Bc);break;case 19:wa.ULS.sendTraceTag(38122833,th.Un,15,"{0}",Bc);break;case 21:wa.ULS.sendTraceTag(0,th.Un,15,"{0}",Bc);break;case 14:wa.ULS.sendTraceTag(6575508,th.Un,15,"{0}",Bc);
break;case 15:wa.ULS.sendTraceTag(36739287,th.Un,50,"{0}",Bc);break;case 16:wa.ULS.sendTraceTag(36767649,th.Un,15,"{0}",Bc);break;case 20:wa.ULS.sendTraceTag(593510690,th.Un,15,"{0}",Bc);break;default:wa.ULS.shipAssertTag(5884129,th.Un,!1,"Bad state:{0} logInfo:{1}",Mc,Bc)}};this.dbc=Q;this.HDb=Ca;this.ljb=Q;this.JKh=sb;this.iOk=Xb;this.A5e=jd;this.OPc=dd;this.O9b=oe;this.yfh=Me;this.eNe=zf;this.P1=uh;this.TH=wj;this.F7b=Sh;this.pDk=qi;this.F8b=yk;this.uqh=Zo;this.Hda=Hn;this.uB=zn;this.RLk=At;this.tph=
Kb;this.a2a=Fp.create(qc.isEnabled,qc.maxRetries,Ga.A$);this.S6e=new Rp.a;this.rIc=xa;this.AB=new Uj.a(-1);this.lf=Zb;this.AB.Mgf(this.XJo);this.bLd=Ba;this.AFb=zn();this.Jmh=Ra;this.Znk=qc.isEnabled?null:Ga;this.uCb=Ua;this.kIh=this.JKh;this.$0e=cc.a.nil;this.sa=new V.a;Na.a.instance.Ra(103).execute(Bc=>{this.xk=Bc;this.xk.WHa((Mc,md)=>{this.Q_(Mc,md)});this.e5e=Bc.DA});this.lf&&this.lf.smb((Bc,Mc)=>{this.Bga(Bc,Mc)});this.AZe=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",
Cc):Cc;this.ECh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",this.HDb):this.HDb;this.bFh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.$("StopDocxSaveMonitorKickoutIsEnabled"):!0;this.kMk=qc}Bga(Q,Ca){wa.ULS.sendTraceTag(528577692,th.Un,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Zm.a[Ca.xsc],Zm.a[Ca.acb]);1!==Ca.acb&&3!==Ca.acb&&(wa.ULS.sendTraceTag(528566343,
th.Un,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.a2a.N$c(1),this.a2a.N$c(2)),this.a2a.clear())}get o0d(){return this.YGc}get hke(){return this.$0e}get PU(){const Q=!this.Qqb()||this.hke.equals(this.Qqb().id);Q||wa.ULS.sendTraceTag(521413851,th.Un,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.Qqb().id.toString(),this.hke.toString());return Q}get QZi(){return this.uB().getTime()-
this.AFb.getTime()>this.AZe}get mXd(){return this.YV}get k7a(){return 3}get eXd(){let Q=null;Wc.StaticActiveAppFrame.za()&&Wc.StaticActiveAppFrame.za().kb&&Wc.StaticActiveAppFrame.za().kb.ed&&(Q=Wc.StaticActiveAppFrame.za().kb.ed.xg);return[Q,Ik.a.U0]}Q_(Q,Ca){var sb,Xb,Cc;Q={["VisibilityState"]:Yg.a[this.xk.DA],["IsVisible"]:this.xk.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.A8b,["KickoutIntervalElapsed"]:this.QZi,["LastSuccessfulIterationTime"]:null!==(sb=this.AFb)&&void 0!==sb?sb:"null",
["RequestStartTime"]:null!==(Xb=this.ROc)&&void 0!==Xb?Xb:"null",["SkippedKickouts"]:this.$Md,["LastSkippedKickoutAt"]:null!==(Cc=this.zsh)&&void 0!==Cc?Cc:"null"},["IsViable"]:this.lf.rCa,["IsNetworkConnected"]:this.lf.cB,["IsExpired"]:this.lf.pba,["HasEmergencyViewModeBeenDeployed"]:this.lf.Nk,["Navigator.Online"]:window.navigator.onLine};wa.ULS.sendTraceTag(539874775,th.Un,50,$a.c(Q));this.e5e!=this.xk.DA&&(0==Ca.oldState||1==Ca.oldState||0!==Ca.newState&&1!==Ca.newState||this.UEa(this.ECh),0===
this.xk.DA?kd.c(tf.a.fgl,void 0,void 0,void 0,void 0,void 0,Q):0===this.e5e&&kd.c(tf.a.ggl,void 0,void 0,void 0,void 0,void 0,Q),this.e5e=this.xk.DA)}start(){this.YGc=this.yfh.uob(this.yam,this.ljb)}UEa(Q){if(!this.o0d||this.ljb===Q)return!1;const Ca=this.ljb;this.ljb=Q;this.stop("changing save monitor interval from "+Ca+"ms to "+Q+"ms");this.start();return!0}wyb(Q,Ca){if(Ca>=this.cMc&&Q&&!cc.a.nil.equals(Q)){var sb=!this.$0e.equals(Q);this.cMc=Ca;this.$0e=Q;const Xb=this.uB();this.H7e=Xb;const Cc=
this.PU;sb&&(Ca={["Id"]:Q.toString(),["IsUpToDate"]:Cc,["Origin"]:dq[Ca]},this.m_e&&(Ca.LastUpToDateTime=this.m_e.toISOString()),(sb=this.CIf())&&sb.r_a&&(Q=sb.r_a.d5c(Q))&&(Ca.LastSavedCreationTime=Q.creationTime.toISOString()),wa.ULS.sendTraceTag(557320151,th.Un,50,"Updating Last Saved Revision: {0}",Ca));Cc&&(this.m_e=Xb)}else Ca<this.cMc?wa.ULS.sendTraceTag(572051800,th.Un,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.cMc,Ca):wa.ULS.sendTraceTag(572051801,th.Un,
15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',Ca)}stop(Q){this.uf(Q)}uf(Q){this.o0d&&(wa.ULS.sendTraceTag(5830084,th.Un,50,"Stopping DocxSaveMonitor because {0}!",Q),this.yfh.uf(this.o0d),this.YGc=0)}GWm(){if(0>=this.O9b)return!1;var Q=this.LDm();if(!Q)return this.U4e=null,this.SJd=0,this.TJd=!1;this.wGb=Q.z3d;this.wGb===this.U4e?this.SJd++:(this.U4e=this.wGb,this.SJd=1,this.TJd=!1);if(this.SJd<th.xPn)return!1;this.RMc=+this.uB()-+this.wGb;if(this.RMc<=this.O9b)return!1;if(!this.TJd)return this.TJd=
!0,this.Dyj(),!1;if(this.uCb)this.uCb.execute(Ca=>{Ca.flush(this,0)});else{Q="";try{this.rIc&&(Q=this.rIc())}catch(Ca){Q=$a.c({["Kind"]:"Exception",["Stack"]:Ca.stack,["Message"]:Ca.message,["FileName"]:Ca.fileName,["LineNumber"]:Ca.lineNumber}),wa.ULS.sendTraceTag(50426817,th.Un,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Q)}wa.ULS.sendTraceTag(50426818,th.Un,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",
this.wGb.toISOString(),this.RMc,this.O9b,Q)}this.O9b=-1;this.stop("Exceeded oldest allowed local revision");this.hK(Tk.a.UYl);return!0}LDm(){let Q=null,Ca=this.Qqb();for(;Ca&&!Ca.pma;)Q=Ca,Ca=Ca.WG;return Q}Gtn(){return this.F8b()?(this.AB.event(1),this.stop("session is lost"),!0):this.uqh()?(this.AB.event(14),wa.ULS.sendTraceTag(20029718,th.Un,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.hK(Tk.a.n0d),!0):!1}CIf(){const Q=this.F7b();return Q?Q.Ic:null}Qqb(){const Q=this.CIf();
return Q?Q.Am:null}$Uc(Q){return this.kMk.isEnabled?this.a2a.$Uc(Q):this.Znk.N$c(Q)&&!this.a2a.N$c(Q)}Jjm(Q){return Q?th.Tmp:th.QHj}Zge(Q,Ca,sb){if(this.QZi)if(this.xk&&!this.xk.isVisible)wa.ULS.sendTraceTag(540669727,th.Un,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.$Md+=1,this.zsh=this.uB();else return this.AB.event(Q,{}),this.stop("request failed after kickout interval "+sb),this.uCb&&this.uCb.execute(Xb=>{Xb.flush(this,2)}),this.hK(Ca),
!0;return!1}Z2f(Q,Ca){const sb=Q.StatusCode;return 88===sb||89===sb||236===sb?(Ca.KickoutDiagnostics=this.rIc(),88===sb?(Ca.Result="deleted DSS session",this.AB.event(18,Ca),this.stop("deleted DSS session"),this.hK(Tk.a.X5f)):89===sb?(Ca.Result="expired DSS session",this.AB.event(19,Ca),this.stop("expired DSS session"),this.hK(Tk.a.eVb)):(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",!1)&&(Q=Vn.b(Q.LastSavedRevisionId),
this.wyb(Q,4)),Ca.Result="DSS session not found",this.AB.event(21,Ca),this.stop("DSS session not found"),this.hK(Tk.a.aie)),!0):14===sb?(this.stop("DSS returned an unspecified failure"),this.hK(Tk.a.TDn),!0):104===sb?(this.stop("this operation is disabled on the server"),!0):this.$2f("unrecognized OperationResult: "+sb,Ca)}$2f(Q,Ca){if(!this.S6e.contains(Q))this.S6e.add(Q);else if(this.Zge(11,Tk.a.azf,Q))return Ca.ConsecutiveErrors=this.mXd,Ca.Reason=Q,wa.ULS.sendTraceTag(41997899,th.Un,15,"DocxSaveMonitor kickout. {0}",
Ca),!0;this.UEa(this.HDb);return!1}aYm(Q,Ca,sb){let Xb=!1;if(Q){const Cc=this.uB().getTime()-Q.creationTime.getTime();Cc>=this.JKh&&(Xb=!0,th.eej(Ca,this.PJm(Q,Cc,sb)),Cc>=this.AZe&&10===this.AB.currentState?(this.AB.event(11,Ca),this.stop("didn't save in time"),this.hK()):(this.AB.event(10,Ca),this.Dyj(),this.oFf()))}return Xb}y2k(Q){this.sa.addHandler(th.Fuj,Q)}Z1k(Q){this.sa.addHandler(th.vFf,Q)}rEj(Q){this.sa.removeHandler(th.vFf,Q)}Dyj(){this.sa.raiseEvent(th.Fuj)}RUa(Q){let Ca;return({group:Ca}=
po.a.N4(Q)).returnValue?Ca.Responses[0]:null}PJm(Q,Ca,sb){const Xb={};Xb.FirstUnsavedRevisionId=Q.id.toString();Xb.FirstUnsavedRevisionLengthToRoot=Q.xP;Xb.UnsavedTimeInMs=Ca;Xb.CurrentRevisionId=sb.id.toString();Xb.CurrentRevisionLengthToRoot=sb.xP;return Xb}oFf(){Yi.a.pFf(Go.a.MJj)}hK(Q=Tk.a.azf){this.iOk?this.bFh?(wa.ULS.sendTraceTag(509146274,th.Un,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",Q,this.ixi()),0==this.YGc&&this.start()):this.xk&&!this.xk.isVisible?
(wa.ULS.sendTraceTag(509146273,th.Un,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",Q,this.ixi()),0==this.YGc&&this.start()):(this.stop(th.Jyn),Q===Tk.a.n0d?this.P1.value.hK(Q,Object.assign(new Wo.a,{gka:4,g_:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,D6:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.P1.value.hK(Q,new Wo.a)):wa.ULS.sendTraceTag(19247383,th.Un,50,"Kickout disabled")}ixi(){const Q=
{};var Ca=Na.a.instance.resolve(438);Q.HasDataloss=!Ca.PU;Q.UnSavedRevisionsCount=Ca.J0a;Q.OldestUnsavedRevisionCreationTime=Ca.PU?"":Ca.Wjc().toString();Q.RevisionsWithOutServerRevisionSequenceNumbers=Ca.Qfc();Q.RevisionsWithServerRevisionSequenceNumbers=Ca.kYd();Q.RSNManager_Diagnostics=Ca.kD();if(Ca=Na.a.instance?Na.a.instance.Oa(443):null)Q.RunawayDataLossMonitor_Diagnostics=Ca.vJj;Q.DocxSaveMonitor_Diagnostics=this.kD();(Ca=Na.a.instance?Na.a.instance.Oa(402):null)&&(Q.LastSavedToHostDetailsManager_Diagnostics=
Ca.kD());this.xk&&(Q.VisibilityState=Yg.a[this.xk.DA]);return Q}kD(){const Q={};this.wGb&&(Q.ORT=this.wGb.toISOString());0<this.RMc&&(Q.AA=this.RMc);0<this.O9b&&(Q.MAA=this.O9b);0<this.$Md&&(Q.LSKO=this.zsh.toISOString());this.AB&&0<=this.AB.currentState&&(Q.SMS=Gp[this.AB.currentState]);const Ca={};m.AFrameworkApplication.rma&&(Ca.S=1);sj.a.YU&&(Ca.LS=1);this.lf&&(this.lf.Mo&&(Ca.KO=1),this.lf.pba&&(Ca.TE=1));this.xk&&(Ca.VS=Yg.a[this.xk.DA]);window.navigator&&(Ca.NW=!window.navigator.onLine);Q.AMD=
Ca;return Q}Vvm(){const Q={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};m.AFrameworkApplication.buildVersion&&(Q["X-OfficeVersion"]=ab.a.tP(m.AFrameworkApplication.buildVersion));m.AFrameworkApplication.accessToken&&(Q["X-AccessToken"]=ab.a.tP(m.AFrameworkApplication.accessToken),Q["X-AccessTokenTtl"]=m.AFrameworkApplication.uTa.toString());m.AFrameworkApplication.hN&&(Q["X-Key"]=ab.a.tP(m.AFrameworkApplication.hN));m.AFrameworkApplication.userType&&(Q["X-UserType"]=
ab.a.tP(m.AFrameworkApplication.userType));const Ca=m.AFrameworkApplication.Ge.c1;Ca&&(Q["X-WacCluster"]=ab.a.tP(Ca));m.AFrameworkApplication.userSessionId&&(Q["X-UserSessionId"]=ab.a.tP(m.AFrameworkApplication.userSessionId));return Q}Sdm(){var Q=this.lf?this.lf.networkState:null;if(1===Q||3===Q)wa.ULS.sendTraceTag(558158790,th.Un,15,"Not sending request because we dont have network.");else if(Q=this.F7b()){var Ca=new Sys.Net.WebRequest;Ca.set_httpVerb("POST");Ca.set_url(th.serviceUrl);var sb={};
sb.body=fo.b(Sl.construct(Q));sb.headers=this.Vvm();sb.method=Ca.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(Ca.getResolvedUrl(),sb).then(Xb=>{wa.ULS.sendTraceTag(561551382,th.Un,50,"Request succeeded at the HTTP level {0}",Xb.statusText);this.ush=Xb.status;return Xb.json()},Xb=>{wa.ULS.sendTraceTag(561551383,th.Un,15,"Request failed at the HTTP level {0}",Xb);return null}).then(Xb=>{Xb=JSON.stringify(Xb);this.Mql(Xb,this.ush);return Xb},()=>{wa.ULS.sendTraceTag(561551385,th.Un,
15,"Request succeeded with null response data");return""}):wa.ULS.sendTraceTag(561002076,th.Un,15,"Browser does not support Fetch.")}catch(Xb){wa.ULS.sendTraceTag(561551386,th.Un,15,String.format("Exception when attempting to get last revision save id : {0}",Xb))}}else wa.ULS.sendTraceTag(540079457,th.Un,15,"Target node is null, not sending last saved revision request.")}Mql(Q,Ca){let sb=cc.a.nil,Xb=!1,Cc=-1;Ca===Mi.a.xz&&((Q=this.RUa(Q))?(sb=Vn.b(Q.LastSavedRevisionId),Q.StatusCode||(Xb=!0,Cc=Q.StatusCode)):
wa.ULS.sendTraceTag(561002077,th.Un,50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(th.vFf,new Rl(sb,Xb,Ca,Cc))}static eej(Q,Ca){for(const sb in Ca)Q[sb]=Ca[sb]}con(){return Ke.SessionStatusManager.instance.Mo}}th.QHj=0;th.serviceUrl=sj.a.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";th.Jyn="kickout";th.Fuj="PS";th.vFf="FLSR";th.Un=343;th.xPn=5;th.Tmp=5E4;Object(f.a)(th,"DocxSaveMonitor",null,[1012,110]);class Vq{uob(Q,Ca){return window.setInterval(Q,
Ca)}uf(Q){window.clearInterval(Q)}}Vq.instance=new Vq;Object(f.a)(Vq,"DocxSaveMonitorTaskManager",null,[1010]);class tt{constructor(Q){this.FZ=0;this.qya=Q}start(Q){this.qya&&(this.FZ=Q,this.qya.reset())}log(){if(this.qya){var Q={};Q.RequstId=this.FZ;Q.InvokeCount=this.qya.v8c;Q.InvokeFailedCount=this.qya.w8c;Q.NoOpenConnectionCount=this.qya.jed;Q.SynchronousNotificationCount=this.qya.ard;Q.ResponseNotAvailable=this.qya.Qld;wa.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",
Q)}}}Object(f.a)(tt,"RequestLifeCycleTelemetryManager",null,[1009]);class fp{constructor(){this.Z=this.D7e=null;this.XKl=()=>{var Q=m.AFrameworkApplication.J;if(!Q.$("DocxSaveMonitorEnabled"))return null;var Ca=Q.$("DocxSaveMonitorKickoutEnabled");const sb=Q.fc("DocxSaveMonitorIntervalMs",6E4),Xb=Q.fc("DocxSaveMonitorFailureIntervalMs",5E3),Cc=Q.fc("DocxSaveMonitorWarningTimeMs",12E4),jd=Q.fc("DocxSaveMonitorKickoutTimeMs",6E5),dd=Q.fc("DocxSaveMonitorQueueTimeoutMs",6E4),oe=Q.fc("DocxSaveMonitorSentTimeoutMs",
12E4),Me=Q.fc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var zf=Q.$("DocxSaveMonitorTelemetryInfoEnabled");const uh=Q.$("DocxSaveMonitorInfoRequestLoggingEnabled");var wj=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),Sh=Q.$("DocxSaveMonitorRawWebRequestsEnabled")||wj;wj=Q.$("ComponentStateLoggingPackageIsEnabled");Q=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",
!1);var qi=m.AFrameworkApplication.Ge,yk=Sh?new Ng(m.AFrameworkApplication.userSessionId,qi.c1,qi.RZd):null;yk=new Ep(qi,yk,Sh);zf=zf&&qi&&!Sh?new tt(qi.eJ):null;Sh=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;qi=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const Zo=Fp.create(Sh,qi);Zo.OSc(1);
Zo.OSc(2);wj=wj?this.Z.Ra(1576):null;Ca=new th(sb,Xb,Cc,Ca,jd,dd,oe,Me,Vq.instance,yk,Na.a.instance.rf(441),Mf.a.instance,this.slc,()=>!m.AFrameworkApplication.Ske||Gf.a.instance.D8c,()=>sj.a.YU,Object(O.a)(nm.a.instance,nm.a.instance.zIa,"checkAndTriggerSessionHasExpired"),()=>m.AFrameworkApplication.Xl,()=>new Date,()=>new Date,zf,uh,Zo,this.Jhm,wj,Q,Na.a.instance.Oa(117)||Ke.SessionStatusManager.instance,{isEnabled:Sh,maxRetries:qi});Ca.start();wa.ULS.sendTraceTag(5884131,th.Un,50,"SaveMonitor initialized");
return Ca};this.slc=()=>{const Q=Wc.StaticActiveAppFrame.za().kb.Jc;return Q?Q.qd:null};this.Jhm=()=>{const Q={};m.AFrameworkApplication.oc&&(Q.TM=m.AFrameworkApplication.oc.kD());Cm.WoncaApp.mG&&(Q.RS=Cm.WoncaApp.mG.kD());Ik.a.U0&&(Q.CRS=Ik.a.U0.kD());Wc.StaticActiveAppFrame.za()&&Wc.StaticActiveAppFrame.za().kb&&Wc.StaticActiveAppFrame.za().kb.ed&&Wc.StaticActiveAppFrame.za().kb.ed.xg&&(Q.GSR=Wc.StaticActiveAppFrame.za().kb.ed.xg.kD());m.AFrameworkApplication.rma&&(Q.S=1);sj.a.YU&&(Q.LS=1);Zd.a.vd()&&
Zd.a.vd().xC.Mo&&(Q.KO=1);Q.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(Q)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(sj.a.yt||sj.a.nn)this.D7e=this.Z.resolve(1589)}dispose(){this.D7e&&this.D7e.stop("WordEditorDocxSaveMonitorPackage is being disposed")}uc(Q){this.Z=Q;(sj.a.yt||sj.a.nn)&&Q.ia(1589,this.XKl).as(436).ha()}static main(){K.a.instance.Mc(new fp)}}Object(f.a)(fp,"WordEditorDocxSaveMonitorPackage",null,[0,1]);var Dk=d(1017);class Nn{constructor(Q,
Ca){this.mo=Q;this.KOo=Object(Dk.b)(Ca)}async loadChunk(Q){return this.mo.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk(Q):(await this.KOo).$D.loadScript(Q)}}Object(f.a)(Nn,"WordOnlineChunksLoader",null,[]);class Em{constructor(){this.name="WordEditor.EditorAi.Entry"}uc(Q){Q.ia(1631,()=>new Nn(m.AFrameworkApplication.J,Q.Ra(78)))}init(){}dispose(){}static main(){K.a.instance.Mc(new Em)}}Object(f.a)(Em,"EditorAiEntryPackage",null,[0,1]);var Om;(function(Q){Q[Q.PGp=0]="version0";Q[Q.version1=
1]="version1"})(Om||(Om={}));Object(f.b)("FirstRunExperienceVersion",Om);class Il{get jif(){return"Word"}get m_h(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Om.PGp}get currentVersion(){return Om.version1}get wjn(){return Il.isEnabled()&&m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get Fpc(){return Il.isEnabled()&&m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get u3i(){return m.AFrameworkApplication.J.$("WordEditorFirstRunExperienceTestIsEnabled")}get Kbm(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get Dej(){return 24}get EIj(){return 4E3}get lmd(){return""}static isEnabled(){const Q=
m.AFrameworkApplication.sessionStartInfoSettings?m.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==Q&&"Automation"!==Q}}Object(f.a)(Il,"FirstRunExperienceLauncherSettings",null,[1036]);class Fm{constructor(Q){this.lih=Q}r9o(Q){void 0==m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CEBlockPopupEnabled",void 0)&&this.lih&&this.lih.s9o(Q)}}Object(f.a)(Fm,"FirstRunExperienceManager",null,[1035]);class Gn{constructor(){this.Z=null}get name(){return"WordEditor.FirstRunExperience"}uc(Q){this.Z=
Q;this.Z.ia(1591,()=>new Fm(this.Z.resolve(1590))).ha()}init(){const Q=this.Z.resolve(1591);Q&&Q.r9o(new Il)}dispose(){}}Object(f.a)(Gn,"WordEditorFirstRunExperiencePackageManager",null,[0,1]);class ka{constructor(Q,Ca){this.mOa=(sb,Xb,Cc,jd,dd)=>{var oe,Me;if(1===Cc)return dd=null===(Me=null===(oe=Xb.view.lb)||void 0===oe?void 0:oe.gb)||void 0===Me?void 0:Me.currentSelection,(null===dd||void 0===dd?0:dd.HN)||sb===tf.a.Apd&&(null===dd||void 0===dd?0:dd.kXa)?32:8;if(2===Cc){oe=this.bjb.Qj.isVisible;
this.bjb.mA(!0,1===dd);Me=0;switch(sb){case tf.a.PUj:dd=1;break;case tf.a.QUj:dd=2;break;case tf.a.Dze:dd=2;Me=1;break;case tf.a.Eze:dd=1;Me=2;break;case tf.a.Apd:dd=1;Me=3;break;case tf.a.lDe:dd=this.bjb.ygc;break;default:Me=dd=0}oe&&sb===tf.a.mOa||this.bjb.zWo(dd,Me);return 32}return 8};this.pae=(sb,Xb,Cc,jd,dd)=>{this.toggleButton(dd,!1);return this.Yul(Cc)};this.lDe=(sb,Xb,Cc,jd,dd)=>this.bjb.Qj.isVisible?this.pae(sb,Xb,Cc,jd,dd):this.mOa(sb,Xb,Cc,jd,dd);this.ga=Q;this.bjb=Ca}dispose(){this.bjb&&
this.bjb.dispose()}Wb(){this.ga.qa(tf.a.lDe,je.a.view,this.lDe);this.ga.fb(tf.a.mOa,je.a.view,this.mOa,4);this.ga.qa(tf.a.pae,je.a.view,this.pae);this.ga.fb(tf.a.Dze,je.a.view,this.mOa,4);this.ga.qa(tf.a.Eze,je.a.view,this.mOa);this.ga.qa(tf.a.Apd,je.a.view,this.mOa)}Yul(Q){if(1===Q)return 32;this.bjb.mA(!1);return 32}toggleButton(Q,Ca){Q&&(Q[Yf.a.On]=Ca)}}Object(f.a)(ka,"FormatPictureActor",null,[11]);class Va{constructor(Q){this.$Ib=!1;this.Qj=Q}get ygc(){return this.Qj.ANl}zWo(Q,Ca){switch(Q){case 0:case 1:this.Qj.x$o(Ca);
break;case 2:this.Qj.I$o(Ca)}}mA(Q,Ca=!1){this.$Ib||this.HVf();Q?this.Qj.yS(Ca):this.Qj.Vsa()}dispose(){this.Qj.dispose()}HVf(){this.$Ib||(this.Qj.initialize(),this.$Ib=!0)}}Object(f.a)(Va,"FormatPictureManager",null,[1008,11]);var yb=d(336),Yb=d(178),oc=d(155);class Vc{}Vc.ES=oc.a.w4d;Vc.Htc=1;Vc.Itc=WordEditorIntl.WordEditorStrings.L_FormatPicture;Vc.cAa="FormatPictureTaskPaneData";Object(f.a)(Vc,"FormatPicturePaneConstants",null,[]);class yd{constructor(){this.type="FormatPictureTaskPaneProps";
this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(f.a)(yd,"FormatPictureTaskPaneProps",null,[]);class Jd{constructor(Q,Ca,sb,Xb){this.T7e=0;this.zGc=this.Aqa=null;this.ALd=this.tLd=this.qGd=this.qxd=this.SOd=0;this.Xt=this.A6b=!1;this.LOe=0;this.k5n=()=>{this.oOj()};this.An=
()=>{let Cc=!1;Cc=this.ymo()||Cc;Cc=this.kdb()||Cc;Cc=this.jdb()||Cc;Cc=this.Ouc()||Cc;(Cc=this.umo()||Cc)&&this.Vm()};this.g6=Q;this.YDk=Ca;this.v_e=sb;this.Fg=Xb}initialize(){this.u2();this.Ina()}get isVisible(){return this.Xt}yS(Q){this.Ipd(Q)}Vsa(){this.tha();this.I1m()}x$o(Q){this.xQj(Q,1)}I$o(Q){this.xQj(Q,2)}xQj(Q,Ca){this.LOe=Ca;this.T7e=Q}get ANl(){return this.LOe}dispose(){}u2(){this.g6.GUa();this.T7e=this.LOe=0}get focusManager(){return this.YDk.value}get Qb(){return this.v_e.value}bbb(){return!!this.focusManager.currentScope&&
this.focusManager.currentScope.name===Vc.ES}oOj(){this.focusManager.Eg(Vc.ES)}Ina(){const Q=this.focusManager.ie(Vc.ES);Q.parent=hf.AFrame.Kq;Q.Pja(this.k5n)}tha(){this.bbb()&&this.focusManager.Eg(this.focusManager.bX)}Ipd(Q){uj.UISurfaces.Ov().then(Ca=>{Ca.showTaskPane(Vc.ES,this.TB(Q));this.isVisible&&Q&&this.focusManager.Eg(Vc.ES);return null})}Vm(){uj.UISurfaces.Ov().then(Q=>{Q.updateTaskPane(Vc.ES,this.TB(!1));return null})}I1m(){uj.UISurfaces.Ov().then(Q=>{Q.hideTaskPane(Vc.ES,2);return null})}TB(){const Q=
new yd;this.O2o(Q);return Object.assign(new ui.a,{title:Vc.Itc,hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:Ca=>{this.Xt=!0;Wc.StaticActiveAppFrame.za().d6a(this.An);Wc.StaticActiveAppFrame.za().Fe();this.oOj();this.Fg.DSc(Vc.ES,Ca)},onClose:()=>{this.tha();this.Xt=!1;Wc.StaticActiveAppFrame.za().Hvc(this.An);Wc.StaticActiveAppFrame.za().Fe()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}O2o(Q){const Ca=C.e().numberFormatInfo;Q.section=this.T7e;Q.numberFormatInfo=
"object"===typeof Ca?Ca:null;Q.title=this.Aqa;Q.description=this.zGc;Q.topCrop=this.SOd;Q.bottomCrop=this.qxd;Q.leftCrop=this.qGd;Q.rightCrop=this.tLd;Q.rotationAngle=this.ALd;Q.onTitleChange=this.onTitleChange();Q.onDescriptionChange=this.onDescriptionChange();Q.onCropSpinButtonChange=this.onCropSpinButtonChange();Q.onRotationSpinButtonChange=this.onRotationSpinButtonChange();Q.disabled=this.A6b}onTitleChange(){return Q=>{if(Q!==this.Aqa){this.Aqa=Q;var Ca=new yb.DictionaryPropertySet;Ca.setValue(Yb.a.lsb,
Q);this.Qb.Pb(Ed.a.Snd,2,Ca);this.Vm()}}}onDescriptionChange(){return Q=>{if(Q!==this.zGc){var Ca=new yb.DictionaryPropertySet;Ca.setValue(Yb.a.a0,Q);this.zGc=Q;this.Qb.Pb(Ed.a.U_b,2,Ca);this.Vm()}}}onCropSpinButtonChange(){return(Q,Ca)=>{const sb=new yb.DictionaryPropertySet;switch(Ca){case 0:this.SOd=Q;sb.setValue(Yb.a.qsb,Q);this.Qb.Pb(tf.a.c7c,2,sb);break;case 1:this.qxd=Q;sb.setValue(Yb.a.nsb,Q);this.Qb.Pb(tf.a.$6c,2,sb);break;case 2:this.qGd=Q;sb.setValue(Yb.a.osb,Q);this.Qb.Pb(tf.a.a7c,2,sb);
break;case 3:this.tLd=Q,sb.setValue(Yb.a.psb,Q),this.Qb.Pb(tf.a.b7c,2,sb)}this.Vm()}}onRotationSpinButtonChange(){return Q=>{this.ALd=Q;const Ca=new yb.DictionaryPropertySet;Ca.setValue(Yb.a.j7c,0);Ca.setValue(Yb.a.CX,Q);this.Qb.Pb(Ed.a.gba,2,Ca);this.Vm()}}ymo(){const Q=2===this.Qb.Pb(Ed.a.Snd,1,null),Ca=Q!==this.A6b;this.A6b=Q;return Ca}kdb(){var Q=new yb.DictionaryPropertySet;this.Qb.Pb(Ed.a.kdb,2,Q);Q=Q.ka(Yb.a.lsb,"");const Ca=Q!==this.Aqa;this.Aqa=Q;return Ca}jdb(){var Q=new yb.DictionaryPropertySet;
this.Qb.Pb(Ed.a.jdb,2,Q);Q=Q.ka(Yb.a.a0,"");const Ca=Q!==this.zGc;this.zGc=Q;return Ca}Ouc(){var Q=new yb.DictionaryPropertySet;this.Qb.Pb(tf.a.Nid,2,Q);const Ca=Q.ka(Yb.a.qsb,0),sb=Q.ka(Yb.a.nsb,0),Xb=Q.ka(Yb.a.osb,0);Q=Q.ka(Yb.a.psb,0);const Cc=Ca!==this.SOd||sb!==this.qxd||Xb!==this.qGd||Q!==this.tLd;this.SOd=Ca;this.qxd=sb;this.qGd=Xb;this.tLd=Q;return Cc}umo(){var Q=new yb.DictionaryPropertySet;this.Qb.Pb(Ed.a.HYb,2,Q);Q=Q.ka(Yb.a.CX,0);const Ca=Q!==this.ALd;this.ALd=Q;return Ca}}Object(f.a)(Jd,
"ReactFormatPicturePane",null,[1007,11]);class Pd{constructor(){this.RBd=this.Z=null}get name(){return"WordEditor.FormatPicture"}uc(Q){this.Z=Q;this.Z.ia(1593,()=>new Va(this.Z.resolve(1592))).ha();this.Z.ia(1592,()=>new Jd(Bm.a.instance,new bc.a(()=>Of.FocusManager.instance()),new bc.a(()=>m.AFrameworkApplication.va),zh.a.instance)).ha();this.Z.ia(1594,()=>new ka(m.AFrameworkApplication.va,this.Z.resolve(1593))).ha()}init(){if(Ik.a.mPg||Ik.a.Bck)this.RBd=this.Z.resolve(1594),this.RBd.Wb(),Wc.StaticActiveAppFrame.za().Fe()}dispose(){this.RBd&&
this.RBd.dispose()}static main(){K.a.instance.Mc(new Pd)}}Object(f.a)(Pd,"WordEditorFormatPicturePackage",null,[0,1]);var Qe=d(1369),Cf=d(523),Wf=d(1155);class gg extends Ym.a{constructor(){super();this.Prompt=0;this.FileId=null}en(){return Jk.a.uUm}static construct(Q,Ca){const sb=new gg;sb.FileId=Q;sb.Prompt=Ca;return sb}}Object(f.a)(gg,"GraphMergeConsentChangedRequest",Ym.a,[]);var Jg=d(512);class Lh extends Jg.a{constructor(){super();this.Location=this.FileId=null}en(){return Jk.a.beo}static construct(Q,
Ca){const sb=new Lh;sb.FileId=Q;sb.Location=Ca;return sb}}Object(f.a)(Lh,"PlayGraphMergeReplayRequest",Jg.a,[]);class Qj{constructor(Q,Ca,sb,Xb,Cc,jd=null,dd=null){this.jm=!1;this.KQ=null;this.eEh=this.dZe=!1;this.mrf=()=>{if(this.vFa.Y$d)this.dZe=!0;else if(this.dZe=!1,!this.ASo){this.eEh=!0;var oe=this.kQa.rDa;wa.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",oe===Wf.a.nrf);if(oe===Wf.a.GWc||oe===Wf.a.nrf)oe=gg.construct(this.jT(),oe),this.nt(oe)}};this.EMi=(oe,Me)=>{Me&&Me.f9f&&
Me.f9f.wtf&&!this.vFa.y3i&&(this.vFa.t6j(),this.vFa.Y$d=!0,this.nt(Me.f9f.wtf))};this.CMi=(oe,Me)=>{Me&&Me.sud&&this.vFa.t6j()};this.DMi=(oe,Me)=>{Me&&(Me.ShowMergePrompt&&this.kQa.sGj(this.mrf),m.AFrameworkApplication.fh&&(m.AFrameworkApplication.fh.SessionMergeInfo|=Me.PartMergeInfo))};this.jT=Q;this.kQd=sb;this.vFa=Xb;this.kQa=Cc;this.kQd&&this.kQd.d2k(this.EMi);this.TH=jd||Mf.a.instance;if(!dd){const oe=new Cf.a;dd=Me=>oe.Qaa(0,Me)}this.Ipk=dd}get Own(){return this.dZe}get ASo(){return this.eEh}nt(Q){const Ca=
new Xg.a;Ca.Zq=Q;Ca.status=Zi.a.DH;Ca.RE="GraphMerge";const sb=this.Ipk(()=>{this.Pld(Ca,Q.en()===Jk.a.v$h)});sb.TG(Ca);sb.t_()}Pld(Q,Ca){this.jm||(Ca&&(this.vFa.Y$d=!1),2===Q.statusCode&&!ua.a.CTb(Q.hk)&&1===Q.hk.length&&Q.hk[0]?(Q=Q.hk[0],Q.StatusCode?this.vFa.tAg():Ca&&this.kQa.sGj(this.mrf),this.TH.qPa(Q),this.Own&&this.mrf()):this.vFa.tAg())}Vvb(Q){this.KQ=Q;this.KQ.rKb(this.CMi);this.KQ.Ycc(this.DMi)}dispose(){this.jm||(this.kQd&&this.kQd.qDo(this.EMi),this.KQ&&(this.KQ.EZb(this.CMi),this.KQ.Ukd(this.DMi)),
this.jm=!0)}}Object(f.a)(Qj,"GraphMergeBackupManager",null,[1032,11]);class Uk{constructor(Q,Ca=null,sb=null,Xb=null){this.oLe=0;this.XXe=!1;this.Frh=new Date(0);this.Y$d=!1;this.kQa=Q;this.uB=Ca||(()=>new Date);sb||(sb=m.AFrameworkApplication.J?m.AFrameworkApplication.J.fc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.LFk=sb;Xb||(Xb=m.AFrameworkApplication.J?m.AFrameworkApplication.J.fc("WordEditorGraphMergeMaxBackups",1):1);this.uuh=Xb}get xvn(){return+this.uB()-+this.Frh<this.LFk}get y3i(){return this.kQa.rDa===
Wf.a.automatic?!1:this.kQa.rDa===Wf.a.GWc?!0:this.XXe||this.Y$d||this.xvn}t6j(){this.Frh=this.uB();this.oLe++;this.oLe>=this.uuh&&this.tAg()}tAg(){this.XXe||(this.XXe=!0,wa.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.oLe,this.uuh))}}Object(f.a)(Uk,"GraphMergeBackupThrottler",null,[1031]);class gj{constructor(Q,Ca,sb=null){this.ykh=!1;this.D9=Q;this.fwk=Ca;null==sb&&(sb=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("WordEditorGraphMergeBypassConsentPrompt"));
this.k5e=sb?Wf.a.automatic:Wf.a.gre}get rDa(){return this.k5e}sGj(Q){if(!this.ykh&&this.rDa===Wf.a.gre){var Ca=this.fwk.value;Ca&&Ca.isFeatureEnabled(44)&&(this.ykh=!0,this.D9.execute(sb=>{sb.E9o(()=>{this.Vzl(Q)},()=>{this.GWc(Q)})}))}}GWc(Q){this.rDa===Wf.a.gre&&(wa.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.k5e=Wf.a.GWc,Q());this.LCj()}Vzl(Q){this.rDa===Wf.a.gre&&(wa.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),
this.k5e=Wf.a.nrf,Q());this.LCj()}LCj(){this.D9.execute(Q=>{Q.C1m()})}}Object(f.a)(gj,"GraphMergeCollectionConsentManager",null,[1027]);class Vj extends Sys.EventArgs{constructor(Q){super();this.f9f=Q}}Object(f.a)(Vj,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var om=d(877),Hj=d(1036),pn=d(614),ki;(function(Q){Q[Q.none=0]="none";Q[Q.Kk=1]="failure";Q[Q.Qza=2]="crash";Q[Q.success=3]="success"})(ki||(ki={}));Object(f.b)("GraphMergeReplayReason",ki);var Wq=d(1783),gp=d(1780),wm=d(58),si=d(221),sl=
d(177);class tl{constructor(Q,Ca,sb,Xb,Cc,jd){this.Zng=this.Vg=null;this.dad=this.QOg=!1;this.Yl=null;this.ppd=Q.runtime.ppd;this.ku=Q;this.kf=Ca;this.hh=sb;this.Xo=Xb;this.Izl=Cc;this.DLi=jd}}Object(f.a)(tl,"GraphNodeComplexMergeState",null,[]);var Gm=d(1479),go=d(1458);class vi{constructor(Q,Ca=null){this.wg=Q;this.y9b=Ca||this.U3c()}get dvb(){return this.y9b}get kf(){return this.wg}U3c(){return[Object(O.a)(this,this.lbp,"simpleMerge"),Object(O.a)(this,this.Tyl,"complexMerge")]}U2o(Q,Ca,sb,Xb,Cc,
jd){Ca=new tl(Q,sb,new bc.a(()=>new Gm.a(Xb?Xb.Gm:null,Cc)),new bc.a(()=>new Gm.a(Xb?Xb.Gm:null,jd)),new bc.a(()=>new Gm.a(jd,Cc)),Ca.w$h(Cc,()=>Q.runtime.qc));Ca.Vg=Xb.Bbc;Ca.Zng=new si.a;return Ca}merge(Q,Ca,sb,Xb,Cc,jd){Ca=this.U2o(Q,Ca,sb,Xb,Cc,jd);sb=!0;for(Xb=0;Xb<this.dvb.length&&sb;Xb++)(sb=(0,this.dvb[Xb])(Ca))||Q.logger.xie("GraphNodeMerge.GetMergeFunctions()",Xb);if(Q=Ca.dad&&Ca.Yl?new go.a(Ca.Yl,!1):null)switch(Q.j1o(Ca.Vg),(Q?Q.Gm:Cc).wc){case wm.a.Wd:Ca.ku.runtime.kte.gBl.W(Q.Gm.id,
Q.Gm);break;case wm.a.$mb:Ca.ku.runtime.kte.Sel.W(Q.Gm.id,Q.Gm);break;case wm.a.lL:Ca.ku.runtime.kte.Mxl.W(Q.Gm.id,Q.Gm);break;case wm.a.paragraphNode:Ca.ku.runtime.Mje.add(Q.Gm.id)}return{returnValue:Ca.dad,Yl:Q}}lbp(Q){if(Q.ku.runtime.qc&&Q.ku.runtime.qc.Erb(1000005)&&0<Q.Vg.count)return!0;var Ca=Q.DLi.ore;return Q.Xo.value.c9c(Ca)&&Q.Izl.value.c9c(Ca)?Q.hh.value.c9c(Ca)?!0:(Ca=Q.Xo.value.Kf,Q.dad=!0,Q.Yl=Ca.$O(),!1):(Q.dad=!0,!1)}Tyl(Q){const Ca=Q.Xo.value.Kf;Q.ppd&&sl.a.instance.Ua(4018183,1,
4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",Ca.id,Ca.wc);const sb=Q.DLi.EKg(Q);Q.dad=sb;sl.a.instance.Ua(4018184,1,sb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",sb?"Succeeded":"Failed",Ca.id,Ca.wc,!!Q.Yl);return sb}}Object(f.a)(vi,"GraphNodeMerge",null,[1327]);var hp;(function(Q){Q[Q.none=0]="none";Q[Q.tZp=1]="crashesOnly";Q[Q.pkq=2]="rejectionsAndCrashes";Q[Q.GVp=3]="allMerges"})(hp||(hp={}));Object(f.b)("GraphMergeBackupCases",hp);var Sp=d(1334),
eq=d(1281);class Hr extends Ym.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=Sp.a.none;this.RequestId=this.ObjectSpaceId=null;this.Source=eq.a.none;this.Reason=ki.none;this.Prompt=0}en(){return Jk.a.v$h}static construct(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf,uh){const wj=new Hr;wj.FileId=Q;wj.BaseRevisions=Ca;wj.TheirRevisions=sb;wj.YourRevisions=Xb;wj.IgnoreConflictsInLastServerRevision=
Cc;wj.MergeHint=jd;wj.ObjectSpaceId=dd?Vn.a(dd):null;wj.RequestId=oe?Vn.a(oe):null;wj.Source=Me;wj.Reason=zf;wj.Prompt=uh;return wj}}Object(f.a)(Hr,"CreateGraphMergeReplayRequest",Ym.a,[]);var yi=d(808),mq=d(240),ip=d(13),$i=d(1922),vj=d(2008);class Xq{constructor(Q,Ca=null,sb=null){this.RXl=(Xb,Cc)=>{let jd=Xb;var dd=Cc,oe=this.Vjb.get(Xb);if(!oe)return{JNa:jd,XZb:dd};dd=new si.a;dd.add(oe);var Me=this.eGb.get(Xb)||this.MH.K(Xb);oe=new si.a;oe.add(Me);Me=new si.a;Me.add(this.MH.K(Xb));wa.ULS.sendTraceTag(17409890,
318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.BJ.yQf,this.BJ.Gma,this.PBi(oe),this.PBi(dd));var zf=this.kCi(this.BJ.Gma);this.gbm(zf,Xb,dd);oe=new $i.a(zf,Me,zf.input.Gma===Sp.a.eCc?oe:dd,zf.input.Gma===Sp.a.eCc?dd:oe,this.kCi(Sp.a.eCc),oe,dd);dd=new si.a;for(Me=0;Me<Cc.length;Me++){this.BJ.gJ("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const uh=({Jdb:jd,hva:zf}=oe.ctd(Xb,Cc.K(Me))).returnValue;dd.add(zf);
uh?wa.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Xb,Cc.K(Me),jd,zf):wa.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",Xb)}return{JNa:jd,XZb:dd}};this.BJ=Q;this.MH=Q.Kn;this.Vjb=Q.Rlp;this.eGb=Q.aNp;this.IEk=Q.SDn;this.wg=Ca||new Hj.a;this.jJk=sb||this.RXl}JZc(Q){const Ca=
new si.a;for(let sb=0;sb<Q.length;sb++){const Xb=this.JXl(Q.K(sb));Ca.add(Xb)}return Ca}IZc(Q,Ca,sb){const Xb=Q.xv===Q.OA&&Q.startCp===Q.endCp;Ca&&({JNa:Q.xv,hva:Q.startCp}=this.P0a(Q.xv,Q.startCp,Q.xv),Xb&&(Q.OA=Q.xv,Q.endCp=Q.startCp));sb&&!Xb&&({JNa:Q.OA,hva:Q.endCp}=this.P0a(Q.OA,Q.endCp,Q.OA));return Q}JXl(Q){if(Q.xv===Q.OA){var Ca=new si.a;Ca.add(Q.startCp);Ca.add(Q.endCp);({JNa:Q,XZb:Ca}=this.UMg(Q.xv,Ca));return new yi.a(Q,Ca.K(0),Q,Ca.K(1))}Ca=new si.a;var sb=new si.a;let Xb;Ca.add(Q.startCp);
({JNa:Ca,XZb:Xb}=this.UMg(Q.xv,Ca));sb.add(Q.endCp);({JNa:Q,XZb:sb}=this.UMg(Q.OA,sb));return new yi.a(Ca,Xb.K(0),Q,sb.K(0))}UMg(Q,Ca){let sb=Q,Xb=Ca;if(!this.MH.K(Q))return wa.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",Q),{JNa:sb,XZb:Xb};if(this.Vjb.get(Q))({JNa:sb,XZb:Xb}=this.jJk(Q,Ca,sb,Xb));else if(this.BJ.UUf&&!this.BJ.UUf.K(this.BJ.UUf.length-1).y3(Q)){Xb=new si.a;for(let Cc=0;Cc<
Ca.length;Cc++){let jd;({JNa:sb,hva:jd}=this.P0a(Q,Ca.K(Cc),sb));Xb.add(jd)}}return{JNa:sb,XZb:Xb}}PBi(Q){let Ca="";Q.forEach(sb=>{Ca+=sb.hAc();Ca+=" ";return!0});return Ca}kCi(Q){const Ca=Na.a.instance.Oa(23),sb=new vj.a;sb.input.source=this.BJ.yQf;sb.input.Gma=this.BJ.Gma;sb.input.v0c=()=>Ca;sb.runtime.Kn=this.MH;sb.runtime.MIa=this.BJ.oyl;Q===Sp.a.eCc?(sb.runtime.QA=this.eGb,sb.runtime.zv=this.Vjb,sb.runtime.y2d=this.BJ.K5i,sb.runtime.CEe=this.BJ.f6i):Q===Sp.a.NCe&&(sb.runtime.QA=this.Vjb,sb.runtime.zv=
this.eGb,sb.runtime.y2d=this.BJ.f6i,sb.runtime.CEe=this.BJ.K5i);sb.runtime.qc=Ca;return sb}gbm(Q,Ca,sb){if(Q.runtime.QA.mb(mq.a.cO)){var Xb=Q.runtime.QA.K(mq.a.cO);Xb=this.wg.getPropertyObjectIds(Xb,lf.a.JY);if(1===Xb.length&&(Xb=Xb.K(0),Q.runtime.QA.mb(Xb)&&(Xb=Q.runtime.QA.K(Xb),3===this.wg.getPropertyInt32(Xb,lf.a.DAb)))){const Cc=this.wg.getPropertyString(Xb,lf.a.koa),jd=this.wg.getPropertyString(Xb,lf.a.E2b);Ca.toString()===Cc&&Cc===jd&&(Ca=this.wg.getPropertyObjectId(Xb,lf.a.gtd),Q.runtime.QA.mb(Ca)&&
sb.add(Q.runtime.QA.K(Ca)))}}}FFm(Q,Ca){let sb=0;for(let Xb=0;Xb<Q.length;Xb++)if(Ca.equals(Q.K(Xb)))return sb=Xb,{returnValue:!0,idx:sb};return{returnValue:!1,idx:sb}}P0a(Q,Ca){const sb=this.IEk&&!!this.eGb.K(Q)&&!this.MH.K(Q);let Xb=Q,Cc=Ca,jd=!1,dd=!1;(sb?this.eGb:this.Vjb).forEach((oe,Me)=>{this.BJ.gJ("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(this.V_f(Me.wc)&&this.MH.K(oe)){Me=null;if(sb){Me=this.p4c(uh=>this.eGb.K(uh)||this.MH.K(uh),oe);var zf=this.Zee(Me,
Q)}else zf=this.p4c(uh=>this.MH.K(uh),oe),zf=this.Zee(zf,Q);if(zf&&(dd=!0,Me||(Me=this.p4c(uh=>this.eGb.K(uh)||this.MH.K(uh),oe)),oe=this.p4c(uh=>this.Vjb.K(uh)||this.MH.K(uh),oe),zf=0,({idx:zf}=this.FFm(Me,Q)).returnValue)){for(let uh=zf+1;uh<Me.length;uh++)if(this.Zee(oe,Me.K(uh)))return Cc=0,Xb=Me.K(uh),jd=!0,!1;for(--zf;0<=zf;zf--)if(this.Zee(oe,Me.K(zf)))return Cc=Number.MAX_VALUE,Xb=Me.K(zf),jd=!0,!1}}return!0});jd||(wa.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",
Q,Ca,sb,dd),this.BJ.yQf===eq.a.undo&&(wa.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Xb),({jpi:Ca}=this.Wtm()).returnValue?(Xb=Ca,Cc=0,wa.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Xb)):wa.ULS.sendTraceTag(17340242,
318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Xb)));return{JNa:Xb,hva:Cc}}Wtm(){let Q=cc.a.nil,Ca=new si.a;this.Vjb.forEach((sb,Xb)=>{this.BJ.gJ("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");return this.V_f(Xb.wc)?(Ca=this.p4c(Cc=>this.Vjb.K(Cc)||this.MH.K(Cc),sb),!1):!0});return 0<Ca.length?(Q=Ca.K(0),{returnValue:!0,jpi:Q}):{returnValue:!1,jpi:Q}}V_f(Q){return Q===wm.a.xH||Q===wm.a.Ep||Q===wm.a.Xna||Q===wm.a.Nca}p4c(Q,
Ca){var sb=Q(Ca);Ca=new si.a;if(!this.V_f(sb.wc))return Ca;sb=this.wg.getPropertyObjectIds(sb,ip.a.qg);for(let Xb=0;Xb<sb.length;Xb++){const Cc=new si.a;this.IMf(Q,sb.K(Xb),Cc);Ca.wD(Ca.length,Cc)}return Ca}IMf(Q,Ca,sb){var Xb=Q(Ca);if(Xb)if(Xb.wc===wm.a.paragraphNode)sb.add(Ca);else if(Xb.wc===wm.a.dY)Ca=this.wg.getPropertyObjectIds(Xb,ip.a.aH).tg(0),this.IMf(Q,Ca,sb);else if(Xb.wc===wm.a.Ep||Xb.wc===wm.a.Xna||Xb.wc===wm.a.Nca)for(Ca=this.wg.getPropertyObjectIds(Xb,ip.a.qg),Xb=0;Xb<Ca.length;Xb++)this.IMf(Q,
Ca.K(Xb),sb)}Zee(Q,Ca){for(let sb=0;sb<Q.length;sb++)if(Ca.equals(Q.K(sb)))return!0;return!1}}Object(f.a)(Xq,"GraphMergeSelectionRecordUpdater",null,[]);var lk=d(645),lr=d(292);class Ir extends Wq.a{constructor(Q=null,Ca=null,sb=null,Xb=null,Cc=null,jd=null,dd=null,oe=null,Me=null,zf=null,uh=null){var wj;super();this.Yai=Sh=>{const qi=Sh.KJ,yk=Wc.StaticActiveAppFrame.za().kb.ed;return Object(lk.b)({jB:Sh,ym:qi,fileId:yk.fileId,bha:yk.bha,contextId:yk.contextId,g2d:qi?qi.id:cc.a.nil,Mdb:this.Mdb,cee:!1,
qbe:!0,cellId:yk.Ic.id},!0,yk.Ic.store)};this.jT=Q||(()=>m.AFrameworkApplication.rootQuerySignature);Ca||(Ca=Sh=>new om.a(Sh));this.KCh=Ca;this.wg=sb||new Hj.a;this.dbh=dd||new gp.ChildNodeListMerge(this.kf);this.S$b=oe;this.Mdb||(this.S$b=(Sh,qi,yk)=>new pn.a(Sh,qi,yk));this.y9b=Xb||this.U3c();this.Mib=Cc||new Qh.a;this.dkh=jd||new vi(this.kf);this.Cuh=(null===(wj=m.AFrameworkApplication.J)||void 0===wj?void 0:wj.fc("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.vFa=Me;this.kQa=zf;this.k$d=
this.NTl(uh);this.Bhh=()=>Na.a.instance.Oa(23)}NTl(Q){Q||(Q=hp.none,Q=m.AFrameworkApplication.J?m.AFrameworkApplication.J.fc("WordEditorGraphMergeBackupCasesBrowser",Q):Q);return Q}uKa(){return(new Date).getTime()}iZj(Q,...Ca){return String.format.apply(null,[Q].concat(Ca))}qmp(Q){throw $k.a.invalidOperation(Q);}o6d(Q){return String.format("Name: {0}, Message: {1}, Stack: {2}",Q.name,Q.message,Q.stack)}Ogo(Q){if(this.vFa&&this.vFa.y3i||!this.Rhp(Q))return null;this.UGn(Q);let Ca;({edl:Xb,Qlp:Cc,$Mp:Ca}=
this.fLl(Q,this.Yai));const sb=Wq.a.ovm(Q);var Xb=Hr.construct(this.jT(),Xb.IEa(),Cc.IEa(),Ca.IEa(),Q.input.cSb,Q.input.Gma,Q.input.kl,Q.input.UVb,Q.input.source,sb,this.kQa.rDa);var Cc=Q.output.bM;sb===ki.success&&0<Cc.length&&(Xb.MergedRevision=this.Yai(Q.output.bM.last()));return Xb}JZc(Q,Ca){return(new Xq(Q)).JZc(Ca)}IZc(Q,Ca,sb,Xb){return(new Xq(Q)).IZc(Ca,sb,Xb)}}Object(f.a)(Ir,"GraphMerger",Wq.a,[]);Object(lr.a)(vi,{merge:!0});class jp extends Ir{constructor(Q,Ca=null,sb=null){super(Q,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,Ca,sb);this.sa=new V.a}get rDa(){return this.kQa?this.kQa.rDa:Wf.a.unknown}get CNb(){return null}set CNb(Q){}d2k(Q){this.sa.addHandler(jp.xQf,Q)}qDo(Q){this.sa.removeHandler(jp.xQf,Q)}vCg(){return!1}SVb(Q,Ca,sb,Xb,Cc,jd,dd){(Q=super.SVb(Q,Ca,sb,Xb,Cc,jd,dd))&&this.sa.raiseEvent(jp.xQf,new Vj(Q));return Q}}jp.xQf="GMC";Object(f.a)(jp,"WordEditorGraphMerger",Ir,[1028,1029,1030]);class rp{constructor(){this.Z=null}get name(){return"WordEditor.GraphMerge"}uc(Q){this.Z=
Q;this.Z.ia("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new gj(this.Z.Ra(677),new bc.a(()=>Q.Oa(23)))).as(693).ha();this.Z.ia("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new Uk(this.Z.resolve(693))).as(1595).ha();this.Z.ia("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new jp(()=>m.AFrameworkApplication.rootQuerySignature,this.Z.resolve(1595),this.Z.resolve(693))).as(1596).ha();this.Z.ia("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Qj(()=>m.AFrameworkApplication.rootQuerySignature,
m.AFrameworkApplication.va,this.Z.resolve(1596),this.Z.resolve(1595),this.Z.resolve(693))).as(696).ha()}init(){sj.a.GS||(sj.a.GS=Qe.a.waa());const Q=this.Z.resolve(1596);sj.a.GS.Xdl(Q);this.Z.resolve(696)}dispose(){let Q=this.Z.Oa(696);Q&&Q.dispose()}}Object(f.a)(rp,"GraphMergePackage",null,[0,1]);var Nk=d(289);class mr{constructor(Q){this.vNe="FontPicker";this.BXe=null;this.JOb=Ca=>{this.BXe=Ca.isEnabled;Ca=appChrome.actions.updateFontPickerLicenseState(this.vNe,Ca.isEnabled);appChrome.api.dispatch(Ca)};
this.Sgb=Q;this.cBd=this.Sgb.Yua(Nk.a.SUb,this.JOb);this.Sgb.isFeatureEnabled(Nk.a.SUb,!1).then(Ca=>{this.BXe=Ca})}get isLicensed(){return this.BXe}dispose(){this.Sgb.CZb(Nk.a.SUb,this.cBd)}}Object(f.a)(mr,"ModernFontPickerFeatureHelper",null,[1962,11]);var vn=d(484),Yr=d(636),jn=d(1658);class Ao{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(f.a)(Ao,"FontInfoTaskPaneProps",
null,[]);class Zn{constructor(Q,Ca,sb,Xb=null){this.zbf=this.kZ=this.cBd=null;this._state=this.V8b=0;this.onOpen=()=>{this._state=2;this.bO()};this.onShow=Cc=>{0!==this._state&&(this._state=2,1===Cc&&(this.V8b=Cc),this.bO())};this.onClose=()=>{this.V8b=this._state=0;this.blur()};this.onHide=()=>{this._state=1;this.V8b=0};this.onUpsellButtonClicked=()=>{this.Sgb.launchUpsellExperience(jn.a.experienceId)};this.v_e=Q;this.Sgb=Ca;this.Gpk=sb;this.Zb=Xb}get Qb(){return this.v_e.value}initialize(){this.Qb.qa(x.a.uug,
z.a.frame,Object(O.a)(this,this.uug,"requestFontInfo"));this.cBd=this.Sgb.Yua(Nk.a.SUb,Object(O.a)(this,this.JOb,"featureStateChangeCallback"));this.Ina()}yS(Q=!1){const Ca=uj.UISurfaces.Ov(),sb=this.Sgb.isFeatureEnabled(Nk.a.SUb,!1),Xb=[];Xb.push(Ca);Xb.push(sb);Promise.all(Xb).then(Cc=>{Cc[0].showTaskPane(jn.a.gPb,this.TB(Cc[1]));Q&&this.bO()})}jBp(Q){uj.UISurfaces.Ov().then(Ca=>{Ca.updateTaskPane(jn.a.gPb,this.TB(Q));return null})}JOb(Q){this.jBp(Q.isEnabled)}uug(Q,Ca,sb,Xb,Cc){this.kZ=Cc.CommandValueId;
this.zbf=Cc.Trigger;this.V8b=Cc.InputMethod;this.yS(2===this._state&&1===this.V8b);return 32}TB(Q){const Ca=new Ao;Ca.onUpsellButtonClicked=this.onUpsellButtonClicked;Ca.fontName=this.kZ;Ca.isLicensed=Q;Ca.trigger=this.zbf;Ca.helpArticleUrl=this.gAl();Ca.paneId=jn.a.gPb;Q=this.n8m();Q.contentProps=Ca;return Q}n8m(){return Object.assign(new ui.a,{title:jn.a.Itc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:this.onOpen,onClose:this.onClose,
onShow:this.onShow,onHide:this.onHide})}Ina(){if(this.Zb){var Q=this.Zb.ie(jn.a.gPb);Q.parent=hf.AFrame.Kq;Q.YL=!0}}bO(){this.Zb&&1===this.V8b&&this.Zb.Eg(jn.a.gPb)}blur(){this.Zb&&this.Zb.currentScope&&this.Zb.currentScope.name===jn.a.gPb&&this.Zb.Eg(this.Zb.bX)}dispose(){this.Sgb.CZb(Nk.a.SUb,this.cBd)}gAl(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.Gpk,this.kwm(),"WDWAENDUSER",m.AFrameworkApplication.lcid)}kwm(){switch(this.zbf){case "missing":return"hlpFontInfoMissingFont";
case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Zn.Dgl(this.kZ)}static Dgl(Q){let Ca="hlpFontInfo";for(let sb=0;sb<Q.length;++sb){const Xb=ab.a.charAt(Q,sb);if(255<Q.charCodeAt(sb)||ab.a.B8c(Xb))Ca+=Xb}return Ca}}Object(f.a)(Zn,"FontInfoPane",null,[1936,11]);class Tp extends Zn{constructor(Q,Ca,sb,Xb,Cc){super(Q,Ca,Xb.jb("FontInfoHelpBaseUrl"),Cc);this.g6=sb}yS(Q){this.u2();super.yS(Q)}JOb(Q){super.JOb(Q);
Wc.StaticActiveAppFrame.za().Fe()}u2(){this.g6.GUa()}}Object(f.a)(Tp,"WordEditorFontInfoPane",Zn,[]);class Js{constructor(){this.u7b=this.iHd=this.eIc=this.Z=null}get name(){return"WordEditor.ModernFontPicker"}uc(Q){this.Z=Q;Q.ia(1597,()=>new mr(this.Z.resolve(4))).ha();Q.ia(1598,()=>new Tp(new bc.a(()=>m.AFrameworkApplication.va),this.Z.resolve(4),Bm.a.instance,m.AFrameworkApplication.J,Of.FocusManager.instance())).ha()}init(){this.iHd=this.Z.resolve(1597);this.eIc=this.Z.resolve(1598);this.eIc.initialize();
m.AFrameworkApplication.J.$("IsAnonymousUser")||((this.u7b=this.Z.Oa(Yr.a))?this.u7b.initialize():wa.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));Wc.StaticActiveAppFrame.za().Fe()}dispose(){this.eIc&&(this.eIc.dispose(),this.eIc=null);this.iHd&&(this.iHd.dispose(),this.iHd=null);this.u7b&&(this.u7b.uza(),this.u7b=null)}static main(){Object(vn.a)()&&K.a.instance.Mc(new Js)}}Object(f.a)(Js,"ModernFontPickerPackage",null,[0,1]);var Di=d(66),ig=d(6),Hi=d(750),Ok=
d(30),Hp=d(1098);class Og{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf,uh,wj=null){this.j1=sb;this.$c=Q;this.Qc=Ca;this.Rh=Cc;this.VPa=jd;this.WY=dd;this.Iah=oe;this.Hah=Me;this.zz=zf;this.btk=wj||Og.Bx}get Ph(){return this.zz?this.zz.Ph:!1}ySi(Q){return this.nLa(Q,0)}Xan(Q){return this.nLa(Q,1)}nLa(Q,Ca){let sb=null;if(this.Ph&&this.WY&&(this.Hah.instance&&this.Hah.instance.bPa(Q),Ca?1===Ca&&(sb=this.WY.TBi(Q.node)):sb=this.WY.zIf(Q.node,Q.cpBegin,Q.Fb),sb&&!sb.ka(lf.a.mba,!1)))return wa.ULS.shipAssertTag(24749379,
368,!1,"Try to insert page break to inconvertible inline content control"),2;const Xb=ig.a.vU(this.$c.Vl());Xb.set(Q.node);Xb.vb(10);const Cc=this.Qc.Lc(15);Cc.pu(Xb);Ca?Ok.OutlineElementNavigator.ke(Xb):(this.tEa(Xb,Q),this.j1.RAc(Q.node,Dj.a.Tu));Q=Ji.ParagraphReader.fn(Xb.currentNode);this.wcn(Xb);this.Ph&&sb&&this.Iah&&(Ca=new hb.a,Ca.add(Xb.currentNode),this.Iah.RMh(Ca,sb.id));this.yXo(Q);Cc.dispose();return 32}yXo(Q){Q=dg.SelectionFactory.ve(Q,0);sg.a.instance.Kc(Q)}wcn(Q){this.Rh.gz(Q,!0,!0,
null,!1,!1);Q=Ok.OutlineElementNavigator.Me(Q);this.Yan(Q)}tEa(Q,Ca){const sb=Ok.OutlineElementNavigator.ke(Q);if(Ca.cpBegin||this.Ph&&(!this.Ph||-1!==Ca.Fb)){Zd.a.vd().wn&&Ca.cpBegin!==Ji.ParagraphReader.textLength(Ca.node)&&Zd.a.vd().Fk.NG(Ca.node);this.Rh.gz(Q,!1,!0,null,!1,!0);var Xb=ig.a.vU(this.$c.Vl());Xb.set(sb);this.Rh.Jca(Xb,Q,Ca,!0,!0,!0)}}Yan(Q){Q=this.btk(Q);this.VPa.XSi(Q)}static dH(){return new Og(new Ue.a,new Eh.a,Na.a.instance.resolve(70),Hp.a.instance,Na.a.instance.resolve(16),Na.a.instance.resolve(953),
Na.a.instance.Oa(13),Na.a.instance.Oa(205),Na.a.instance.Ra(87),Na.a.instance.Oa(11),Na.a.instance.resolve(10))}static get instance(){return null!=Og.XZg?Og.XZg:Og.XZg=Og.dH()}static Bx(Q){return Xc.a.Bx(Q)}}Object(f.a)(Og,"PageBreakInserter",null,[1073]);class $m{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe){this.zcn=(Me,zf,uh,wj)=>{var Sh=zf.view,qi=Sh.lb.Ng;if(!qi)return 2;if(!this.wof(zf))return 8;if(1===uh)return 32;let yk=!0;uh=8;const Zo=this.BYe(qi);qi=this.Qc.Lc(15);qi.Ab(Sh.qd);qi.Ei=Me;Zo||(uh=this.ga.Pf(zf,
Ed.a.Qra,2,!0,wj,null),Me=32===uh,wa.ULS.shipAssertTag(4208012,314,Me),yk=Me);yk&&(Sh=Sh.lb.Ng,Me=this.BYe(Sh),wa.ULS.shipAssertTag(4208013,314,Me,"{0}",{["ContextId"]:zf.contextId}),uh=8,Me&&(uh=this.iWe.ySi(Sh),wa.ULS.shipAssertTag(4208014,314,32===uh)));qi.dispose();32===uh&&this.Xd.ev(10);return uh};this.ycn=(Me,zf,uh)=>{if(!zf||zf.contextId!==je.a.Vc)return 8;if(1===uh)return zf.contextId===je.a.Vc?32:8;if(2===uh){if(!this.wof(zf))return 8;Me=this.iWe.ySi(zf);32===Me&&this.Xd.ev(10);return Me}return 32};
this.xcn=(Me,zf,uh)=>{if(!zf||zf.contextId!==je.a.table)return 8;if(1===uh)return 32;if(2===uh){if(!this.wof(zf))return 8;Me=this.iWe.Xan(zf);32===Me&&this.Xd.ev(10);return Me}return 32};this.ga=Q;this.iWe=Ca;this.Qc=sb;this.ao=Xb;this.BYe=Cc;this.Al=jd;this.iCk=dd;this.Xd=oe}Wb(){this.ga.qa(tf.a.nLa,je.a.view,this.zcn);this.ga.qa(tf.a.nLa,je.a.Vc,this.ycn);this.ga.qa(tf.a.nLa,je.a.table,this.xcn);this.ga.Pc(tf.a.nLa,4)}y8(){const Q=Of.FocusManager.instance().ie(Di.a.GF);hf.AFrame.gj(Q,ed.KeyInputManager.lc(Dj.a.Tu,
ed.KeyInputManager.mi),tf.a.nLa)}Wnn(Q){return this.yy(Q.iterator)}Rrn(Q){Q=Q.K(0);const Ca=$f.a.yk(Q,!0,!1);if(this.yy(Ca.Qa.iterator))return!0;Q=$f.a.yk(Q,!1,!1);return this.yy(Q.Qa.iterator)}yy(Q){return Q.vb(14)}wof(Q){let Ca=null,sb=Q;if(sb.contextId===je.a.view){Ca=sb.view;if(!Ca.features.HGg)return!1;sb=Ca.lb.Ng;if(!sb)return!1}else{const Xb=ig.a.Za(sb.node);if(Xb.vb(36)||Xb.vb(38)||Xb.vb(40)||Xb.vb(14))return!1}return Hi.a.dma(Q)?!1:sb.contextId===je.a.table?this.Al.Hnn(sb.node):!this.Al.Fnn(sb)||
this.ao&&this.ao.instance&&this.ao.instance.KX(sb)?!1:((Q=this.BYe(sb))?this.Wnn(sb):this.Rrn(Ca.lb.gb))||Q&&this.iCk(sb,!0)?!1:!0}static dH(){return new $m(m.AFrameworkApplication.va,Og.instance,new Eh.a,Na.a.instance.Ra(51),$f.a.qf,ke.a.instance,se.a.ZBa,Na.a.instance.resolve(46).instance)}static get instance(){return null!=$m.PYg?$m.PYg:$m.PYg=$m.dH()}}Object(f.a)($m,"PageBreakActor",null,[1026]);class ai{constructor(){this.n3e=this.Z=null}get name(){return"WordEditor.PageBreak"}uc(Q){this.Z=Q}init(){this.Z.resolve(23).Qr.continueWith(()=>
{this.No()})}No(){this.n3e=$m.instance;this.n3e.Wb();this.n3e.y8();Wc.StaticActiveAppFrame.za().Fe()}dispose(){}}Object(f.a)(ai,"PackageManager",null,[0,1]);var Yq=d(1370),xk=d(1371),Wj=d(300),wn=d(205),nr=d(227),zi=d(274),Jl=d(472);class Lk{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.cHb=null;this.sa=new V.a;this.POe=1;this.UFd=-1;this.c4a=null;this.uua=()=>{this.dnf()};this.ib=Ca;this.Gb=sb;this.eAd=Xb;this.$K=Cc;this.HC=jd;this.a6=dd;this.enable()}get qZd(){return this.POe}nRj(Q){this.POe!==Q&&(this.POe=
Q,this.sa.raiseEvent("X"),this.ife&&this.DMg())}get ife(){const Q=Na.a.instance.Oa(1599);return Q?Q.ife:!0}get xl(){return this.$K.value}get hl(){return Cd.a.instance}n1k(Q){this.sa.addHandler("X",Q)}DMg(){this.hl.ee(()=>{this.a6.sS(Jl.a.Uqj)},"CPC:UPN")}enable(){this.ib.BA(this.uua);this.dnf()}dnf(){if(!this.c4a||1>=this.c4a.count)this.nRj(1);else{var Q=this.ib.gb.currentSelection;if(Q){var Ca=Q.Jf?Q.Wc:Q.Qa;!Ca||0>Ca.cpBegin||(Q=Ca.node)&&Ji.ParagraphReader.Vb(Q)&&this.pnn(Q)&&(this.cHb&&(this.Gb.uf(this.cHb),
this.cHb=null),this.cHb=new cd.a(2,1,400,sb=>{this.B9l(sb,Ca)},62),this.Gb.Yb(this.cHb))}}}pnn(Q){Q=ig.a.Za(Q);return Q.vb(35)||Q.vb(37)||Q.vb(39)?!1:!0}U8j(Q){this.c4a=Q;this.n7j()}n7j(){if(-1!==this.UFd){var Q=this.C9l(this.UFd);-1!==Q&&this.nRj(Q)}}B9l(Q,Ca){this.cHb===Q&&(this.cHb=null,this.UFd=this.Vgm(Ca),-1!==this.UFd&&this.n7j())}C9l(Q){if(!this.c4a)return-1;for(let Ca=0;Ca<this.c4a.count;Ca++){const sb=this.c4a.K(Ca);if(Q>sb.BLh&&Q<sb.BLh+sb.height)return sb.Fh}return-1}Vgm(Q){var Ca=this.ZFm(Q);
if(!Ca||!Ca.htmlElement)return-1;const sb=Ca.getBounds();Q=this.apm(Q,Ca);if(!Q)return-1;Ca=la.a.gWa(this.eAd.Icb,Ca.htmlElement).y;return Q.y+Math.floor(Q.height/2)-sb.y+Ca}ZFm(Q){return Q.node.Ce(this.xl.sc)}apm(Q,Ca){Q=this.HC?this.HC.Lza(Q,!0):Q.cpBegin;return zi.a.Cr(Ca,Q)}disable(){this.ib.hha(this.uua)}}Object(f.a)(Lk,"CurrentPageCalculator",null,[1324,1319]);class Ko{constructor(Q){Ko.v1=Q}get rvf(){return Ko.v1}get qZd(){return this.rvf.qZd}Q0l(){this.rvf.enable()}rVl(){this.rvf.disable()}}
Ko.v1=null;Object(f.a)(Ko,"WebViewCurrentPageManager",null,[1323]);var Xo=d(106);class Ip extends Sys.EventArgs{constructor(Q,Ca){super();this.Ugj=Ca}}Object(f.a)(Ip,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class an extends Sys.EventArgs{constructor(Q,Ca,sb){super();this.delta=Q;this.Ugj=sb}}Object(f.a)(an,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class rs{constructor(Q,Ca,sb){this.tAh=this.bKd=-1;this.rNc=null;this.sa=new V.a;this.t1e=!1;this.nrj=(Xb,Cc)=>{this.t1e=this.cql();Cc.pwb||
this.HHc.value.measure(this.Xpl)};this.Xpl=()=>{const Xb=this.Icb.clientHeight;this.Wpl(Xb);this.fql(Xb)};this.Iig=(Xb,Cc)=>{Cc.property===Xo.a.CR&&(Xb=Cc.node)&&Xb.ka(Xo.a.CR,!1)&&(Xb=Xb.Ce(this.xl.sc))&&(Xb=Xb.htmlElement)&&this.Y3a.add(Xb)};this.$K=Q;this.HHc=Ca;this.Y3a=new hb.a;this.CTf();this.Cga=this.Cga.bind(this);sb.sKb(this.Cga);0===sb.Et&&this.nM()}nM(){this.xl.DPh(this.nrj)}K0a(){this.xl.hEj(this.nrj)}get xl(){return this.$K.value}Cga(Q,Ca){this.rNc=null;0===Ca.AMa?this.nM():this.K0a()}get Icb(){this.rNc||
(this.rNc=this.xl.qd.Ce(this.xl.sc).Icb,wa.ULS.shipAssertTag(34136386,336,!!this.rNc));return this.rNc}s2k(Q){this.sa.addHandler("OnPageContentSizeChangeKey",Q)}Wpl(Q){Q!==this.tAh&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new Ip(Q,this.t1e)),this.tAh=Q)}fql(Q){Q!==this.bKd&&(-1!==this.bKd&&this.sa.raiseEvent("OnPageContentSizeChangeKey",new an(Q-this.bKd,Q,this.t1e)),this.bKd=this.Icb.clientHeight)}cql(){let Q=!1;for(let Ca=this.Y3a.count-1;0<=Ca;Ca--)this.Y3a.K(Ca).hasChildNodes()&&(this.Y3a.removeAt(Ca),
Q=!0);return Q}CTf(){sj.a.ff.Pl.jf(23).ro(this.Iig)}}Object(f.a)(rs,"DocumentSizeManager",null,[]);var Bo=d(53),Co=d(228);class zl{constructor(Q){this.$K=Q}get xl(){const Q=this.$K.value;wa.ULS.shipAssertTag(37820298,336,Q.jj,"OutlineManager.PageView is not a PageView.");return Q}$xe(Q,Ca){const sb=Bo.a.sj(zl.ig.qD(Q),1);Ca+=sb;Q.Ce(this.xl.sc).htmlElement.firstChild.style.minHeight=Ca+"px"}Byi(){const Q=ig.a.Za(this.xl.qd);Q.yq();Q.$d();wa.ULS.shipAssertTag(37820299,336,10===Q.so.type);return Q.so}gBi(){const Q=
ig.a.Za(this.xl.qd);Q.yq();Q.O_();wa.ULS.shipAssertTag(37820300,336,10===Q.so.type);return Q.so}UHm(Q){const Ca=ig.a.Za(this.xl.qd);Ca.yq();Ca.$d();let sb=Ca.so,Xb=null;for(;Q!==sb&&Ca.Mk();)Xb=sb,sb=Ca.so;wa.ULS.shipAssertTag(37820301,336,10===Ca.so.type);return Xb}static get ig(){return Co.a.instance}}Object(f.a)(zl,"OutlineManager",null,[1322]);class bk{constructor(Q){this.GGa=0;this.h5=null;this.iDg=Ca=>{for(const sb of Ca.em)this.hDg(sb)};this.Gb=Q}yoe(){this.h5||(this.h5=this.YXc())}lWd(){this.h5&&
0<bk.i2c(this.h5).length&&this.Gb.Yb(this.h5);this.h5=null}YXc(){return Object.assign(new cd.a(3,1,250,this.iDg,166),{em:[]})}gAg(Q){this.GGa=Q}xpd(Q){if(Q){Q.style.width=this.GGa+"px";if(this.h5)var Ca=this.h5;else Ca=this.YXc(),this.Gb.Yb(Ca);bk.i2c(Ca).push(Q)}}t6c(Q){Q&&(Q.style.width="0px",this.hTf(Q))}Vsd(Q,Ca){Ca?this.xpd(Q):this.t6c(Q)}hDg(Q){Q.style.width===this.GGa+"px"&&(this.y2c(Q).style.visibility="visible")}hTf(Q){Q&&(this.y2c(Q).style.visibility="hidden")}y2c(Q){Q=Q.childNodes;wa.ULS.shipAssertTag(24958351,
336,1===Q.length,"Expected 1 child div in the page adornment, found "+Q.length);return Q[0]}static i2c(Q){return Q.em}}Object(f.a)(bk,"PageAdornmentAnimationManager",null,[1321]);class hm{constructor(Q){this.Ym=Q;this.Nda=new Rd.a;this.Oda=new Rd.a}QIa(Q){Q=ig.a.Za(Q);if(Q.yq()&&Q.Gq()){Q.$d();do 10===Q.nf&&this.Clg(Q.currentNode),Q.Fu();while(8!==Q.nf)}}I0b(Q){const Ca=Q.Fh;var sb=this.UQb(Q.f2b);if(!this.Nda.mb(sb))return wa.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+
sb),!1;Q=this.Nda.K(sb);wa.ULS.shipAssertTag(24958353,336,this.Oda.mb(sb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");sb=this.Oda.K(sb);return this.cTf(Q,Ca,sb)}H0b(Q){const Ca=Q.Fh;var sb=this.UQb(Q.f2b);if(!this.Nda.mb(sb))return wa.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+sb),!1;Q=this.Nda.K(sb);wa.ULS.shipAssertTag(24958355,336,this.Oda.mb(sb),
"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");sb=this.Oda.K(sb);return this.aFf(Q,Ca,sb)}WOf(Q){if(!Q)return wa.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var Ca=Q.STd;if(!Ca)return wa.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",Q.Fh)),0;Ca=this.Ym.ZPb(Ca);if(!Ca)return wa.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),
0;Ca=this.Ym.Dla(Ca);const sb=1===Q.Fh;Q=!(Q.Fh%2);return 1===Ca?1:2===Ca?sb?2:1:3===Ca?Q?3:4:sb?2:Q?3:4}Clg(Q){if(10===Q.type){var Ca=new Rd.a,sb=this.Ym.ZPb(Q);wa.ULS.shipAssertTag(24958356,336,!!sb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Xb=this.Ym.Dla(sb);Q=this.UQb(Q);this.SMg(Q,Xb);this.RMg(Q,Ca);sb=ig.a.Za(sb);if(sb.Gq()){sb.$d();do Q=sb.currentNode,Xb=this.Ym.A3c(Q),Q=this.Ym.vOi(Q),Ca.add(Xb,Q),sb.Fu();
while(36===sb.nf)}}}SMg(Q,Ca){this.Oda.mb(Q)?this.Oda.W(Q,Ca):this.Oda.add(Q,Ca)}RMg(Q,Ca){this.Nda.mb(Q)?this.Nda.W(Q,Ca):this.Nda.add(Q,Ca)}UQb(Q){wa.ULS.shipAssertTag(24958358,336,10===Q.type,"Expected node of type Outline but received node of type "+Q.type);return Q.ka(lf.a.yna,0)}cTf(Q,Ca,sb){const Xb=1===Ca;Ca=!(Ca%2);switch(sb){case 2:if(Xb){if(Q.mb(2))return Q.K(2)}else if(Q.mb(0))return Q.K(0);break;case 3:if(Ca){if(Q.mb(1))return Q.K(1)}else if(Q.mb(0))return Q.K(0);break;case 4:if(Xb){if(Q.mb(2))return Q.K(2)}else if(Ca){if(Q.mb(1))return Q.K(1)}else if(Q.mb(0))return Q.K(0);
break;case 1:if(Q.mb(0))return Q.K(0)}return!1}aFf(Q,Ca,sb){const Xb=1===Ca;Ca=!(Ca%2);switch(sb){case 2:if(Xb){if(Q.mb(5))return Q.K(5)}else if(Q.mb(3))return Q.K(3);break;case 3:if(Ca){if(Q.mb(4))return Q.K(4)}else if(Q.mb(3))return Q.K(3);break;case 4:if(Xb){if(Q.mb(5))return Q.K(5)}else if(Ca){if(Q.mb(4))return Q.K(4)}else if(Q.mb(3))return Q.K(3);break;case 1:if(Q.mb(3))return Q.K(3)}return!1}}Object(f.a)(hm,"PageAdornmentContentManager",null,[1320]);var ut=d(847);class Jr{constructor(Q,Ca,sb,
Xb,Cc,jd,dd,oe,Me){this.aOg(Q,Ca,sb,jd,dd,oe,Me);this.Fh=Q;this.zr=Ca;this.Zu=sb;this.f2b=Xb;this.STd=Cc;this.Wnb=jd;this.fmc=dd;this.$ic=oe;this.drj=Me}get top(){return this.zr}get height(){return this.Zu}Fod(Q){this.zr!==Q&&(this.Wnb.style.top=Q+"px",this.zr=Q)}Lzg(Q){this.height!==Q&&(this.Wnb.style.height=Q+"px",this.Zu=Q)}aOg(Q,Ca,sb,Xb,Cc,jd,dd){wa.ULS.shipAssertTag(37244961,336,0<Q,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",Q);wa.ULS.shipAssertTag(37244962,
336,0<=Ca,"PageAdornmentContainer: top parameter value {0} is unexpected value.",Ca);wa.ULS.shipAssertTag(37244963,336,0<=sb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",sb,Ca);wa.ULS.shipAssertTag(37244992,336,!!Xb,"PageAdornmentContainer: containerDomElement parameter is null.");wa.ULS.shipAssertTag(37244993,336,!!Cc,"PageAdornmentContainer: headerLabelDomElement parameter is null.");wa.ULS.shipAssertTag(37244994,336,!!jd,"PageAdornmentContainer: footerLabelDomElement parameter is null.");
wa.ULS.shipAssertTag(37244995,336,!!dd,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(f.a)(Jr,"PageAdornmentContainer",null,[1352]);class Ii{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf,uh,wj){this.Ykh="headerFooterTab";this.oOd=null;this.Xt=!0;this.tUe=0;this.MZe=null;this.u$a=!1;this.UWb=Sh=>{this.IWn(Sh.Uy);return!0};this.FD=()=>!0;this.IRb=()=>{this.Fsf()&&(this.u$a=!1,this.vwp(),this.MZe=new Date)};this.ZWb=Sh=>{this.u$a||this.SY.xpd(Sh.Uy);return!0};this.YWb=Sh=>
{this.u$a||(Sh=Sh.Uy,this.NCg(Sh)||this.SY.t6c(Sh));return!0};this.Ovo=()=>{let Sh=Array.dequeue(this.c6e);for(;Sh;)this.nM(Sh),Sh=Array.dequeue(this.c6e);this.oOd=null};this.$K=Q;this.Fg=Ca;this.tG=sb;this.Ioa=Xb;this.ga=Cc;this.ml=jd;this.SY=dd;this.LFa=oe;this.rRa=Me;this.Gb=zf;this.Ga=uh;this.c6e=[];this.c5=new Map;this.Ny=wj;this.rRa.GRd(this.IRb);this.ay=!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb.A3;if(this.vEd=(this.vWe=!!this.Ga&&this.Ga.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&
!!this.Ga&&this.Ga.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===Wc.StaticActiveAppFrame.za().fL.getLayoutBreakpoint()&&(this.Xt=!1),Wc.StaticActiveAppFrame.za().fL.registerLayoutBreakpointChanged(this.Ykh,Sh=>{switch(Sh){case "Small":this.TOi();break;default:this.qVj()}})}get xl(){return this.$K.value}qVj(){try{this.q$o()}catch(Q){wa.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}TOi(){try{this.F1m()}catch(Q){wa.ULS.shipAssertTag(37244998,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}JBo(){for(const Q of this.c5.keys())this.Ste(Q)}QIa(){try{this.dzl()}catch(Q){wa.ULS.shipAssertTag(37244999,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}U8j(Q){try{this.cBp(Q)}catch(Ca){wa.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",Ca.message)}}dispose(){try{this.Vup(),this.Avp(),this.rRa&&this.rRa.oEj(this.IRb)}catch(Q){wa.ULS.shipAssertTag(37245001,
336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",Q.message,Q.stack)}}IWn(Q){const Ca=this.y9c(Q),sb=this.Mvi(Q);sb?(kd.b("OpenHeaderFooterFromWebViewAdornment"),Q=this.LFa.WOf(sb),this.ga.Pb(Ca?tf.a.pGe:tf.a.gud,2,Q),this.u$a=!0):(wa.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+Q.id),this.ga.Ob(tf.a.Vbe,2))}Vup(){this.c5.forEach(Q=>{this.K0a(Q)})}Avp(){this.ay&&(this.vEd&&(Wc.StaticActiveAppFrame.za().fL.unregisterLayoutBreakpointChanged(this.Ykh),
this.vEd=!1),this.ay=!1)}K0a(Q){if(Q){var Ca=Q.fmc;Q=Q.$ic;Bd.a.Ota(Ca)&&Bd.a.Ota(Q)?(this.ml.xc(S.a.hS,Ca,this.ZWb),this.ml.xc(S.a.hS,Q,this.ZWb),this.ml.xc(S.a.cM,Ca,this.YWb),this.ml.xc(S.a.cM,Q,this.YWb),this.Fg.xc(S.a.click,Ca,this.UWb),this.Fg.xc(S.a.click,Q,this.UWb),this.tG.xc(Ca,Ii.LWb),this.tG.xc(Q,Ii.LWb),this.Ioa.xc(S.a.lz,Ca,this.FD),this.Ioa.xc(S.a.lz,Q,this.FD)):wa.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}Rno(Q){this.c6e.push(Q);
this.oOd||(this.oOd=new cd.a(2,1,50,this.Ovo),this.Gb.Yb(this.oOd))}nM(Q){if(Q){var Ca=Q.fmc;Q=Q.$ic;Bd.a.Ota(Ca)&&Bd.a.Ota(Q)?(this.ml.nb(S.a.hS,Ca,this.ZWb),this.ml.nb(S.a.hS,Q,this.ZWb),this.ml.nb(S.a.cM,Ca,this.YWb),this.ml.nb(S.a.cM,Q,this.YWb),this.Fg.nb(S.a.click,Ca,this.UWb),this.Fg.nb(S.a.click,Q,this.UWb),this.tG.nb(Ca,Ii.LWb),this.tG.nb(Q,Ii.LWb),this.Ioa.nb(S.a.lz,Ca,this.FD),this.Ioa.nb(S.a.lz,Q,this.FD)):wa.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}q$o(){if(!this.Xt){for(const Q of this.c5.values())Q.Wnb.style.display=
"block";this.Xt=!0}}F1m(){this.Xt&&(this.c5.forEach(Q=>{Q.Wnb.style.display="none"}),this.Xt=!1)}dzl(){this.LFa.QIa(this.xl.qd)}cBp(Q){this.SY.yoe();var Ca=0;const sb=new hb.a;this.QIa();const Xb=this.Iym();for(var Cc of Q)Q=Cc.Fh,this.W9n(Cc)||this.Ste(Cc.Fh),this.c5.has(Q)?this.Lxp(Cc):this.IFl(Cc),Ca=Q,sb.add(Q);for(Cc=1;Cc<=Ca;Cc++)sb.contains(Cc)||this.Ste(Cc);for(Ca+=1;Ca<=Xb;Ca++)this.Ste(Ca);this.SY.lWd()}W9n(Q){return this.c5.has(Q.Fh)?this.c5.get(Q.Fh).f2b.id===Q.f2b.id:!1}Iym(){let Q=0;
this.c5.forEach((Ca,sb)=>{sb>Q&&(Q=sb)});return Q}IFl(Q){const Ca=Q.f2b.Ce(this.xl.sc);if(Ca){var sb=Q.Fh;Q=this.FXc(sb,Q.top,Q.height,Ca.afa,Q.f2b,Q.STd);this.Rno(Q);this.HLg(Q);this.iNg(Q);this.vEd&&!this.Xt&&(Q.Wnb.style.display="none");this.c5.set(sb,Q)}}FXc(Q,Ca,sb,Xb,Cc,jd){const dd=ji.b("div","","PageAdornmentContainer");dd.style.top=Ca+"px";dd.style.height=sb+"px";Xb.appendChild(dd);this.fnf(dd,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Xb=this.duf(Q);
dd.appendChild(Xb);const oe=this.ztf(Q);dd.appendChild(oe);const Me=this.ptf(Q);dd.appendChild(Me);m.AFrameworkApplication.isRtl&&(dd.classList.add("Rtl"),oe.classList.add("Rtl"),Me.classList.add("Rtl"));return new Jr(Q,Ca,sb,Cc,jd,dd,oe,Me,Xb)}ztf(Q){Q=ji.b("div","h"+Q,this.Ny?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.Ny?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=ut.a.RBc;const Ca=ji.b("span","","");Ca.innerText=WordEditorIntl.WordEditorStrings.l_Header;
Ca.style.whiteSpace="nowrap";Q.appendChild(Ca);return Q}ptf(Q){Q=ji.b("div","f"+Q,this.Ny?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.Ny?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=ut.a.RBc;const Ca=ji.b("span","","");Ca.innerText=WordEditorIntl.WordEditorStrings.l_Footer;Ca.style.whiteSpace="nowrap";Q.appendChild(Ca);return Q}duf(Q){const Ca=ji.b("div","","PageAdornmentNumberLabel");Ca.innerText=Q.toString();return Ca}fnf(Q,Ca,sb){if(!this.tUe){const Xb=
ji.b("p","","");Xb.innerText=Ca;Xb.style.whiteSpace="nowrap";Xb.style.visibility="hidden";Q.appendChild(Xb);Ca=ji.b("p","","");Ca.innerText=sb;Ca.style.whiteSpace="nowrap";Ca.style.visibility="hidden";Q.appendChild(Ca);this.tUe=Q.clientWidth;this.SY.gAg(this.tUe);Q.removeChild(Xb);Q.removeChild(Ca)}}Ste(Q){if(this.c5.has(Q)){var Ca=this.c5.get(Q);this.K0a(Ca);Bd.a.Fy(Ca.Wnb);this.c5.delete(Q)}}Lxp(Q){if(this.c5.has(Q.Fh)){var Ca=this.c5.get(Q.Fh);Ca.Fod(Q.top);Ca.Lzg(Q.height);this.HLg(Ca);this.iNg(Ca)}else wa.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}vwp(){this.SY.yoe();this.QIa();this.c5.forEach(Q=>{this.HLg(Q);this.iNg(Q)});this.SY.lWd()}HLg(Q){const Ca=Q.fmc,sb=Q.$ic,Xb=this.LFa.I0b(Q),Cc=this.LFa.H0b(Q);this.jDp(Q,Xb,Cc);this.SY.Vsd(Ca,Xb);this.SY.Vsd(sb,Cc)}jDp(Q,Ca=!0,sb=!0){const Xb=Q.fmc;Q=Q.$ic;3!==m.AFrameworkApplication.va.mode?(Xb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,Q.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Xb.title=
Ca?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,Q.title=sb?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}NCg(Q){const Ca=this.Mvi(Q);return Ca?this.y9c(Q)?this.LFa.I0b(Ca):this.LFa.H0b(Ca):(wa.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}Mvi(Q){Q=Q.id;Q=Q.substring(1,Q.length);Q=Number.parseInvariant(Q);return this.c5.has(Q)?this.c5.get(Q):(wa.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+Q),null)}y9c(Q){return Q.id.length?"h"===Q.id.substring(0,1):(wa.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}iNg(Q){const Ca=Q.height;Ca<Ii.HPn?(Q.fmc.classList.add(Ii.Yrb),Q.$ic.classList.add(Ii.Yrb)):(Q.fmc.classList.remove(Ii.Yrb),Q.$ic.classList.remove(Ii.Yrb));Ca<Ii.IPn?(Q.drj.classList.add(Ii.Yrb),Q.Wnb.classList.add(Ii.Yrb)):(Q.drj.classList.remove(Ii.Yrb),Q.Wnb.classList.remove(Ii.Yrb))}Fsf(){return!this.MZe||
Y.a.SSf(this.MZe,500)}static LWb(){return!0}}Ii.Yrb="Hidden";Ii.HPn=120;Ii.IPn=50;Object(f.a)(Ii,"PageAdornmentManager",null,[1318,11,1319]);class ho{constructor(Q,Ca){this.epe=new hb.a;this.epe.add(Q);this.epe.add(Ca)}}Object(f.a)(ho,"PageElementManagerList",null,[]);var Kr=d(55);class im{constructor(Q,Ca){this.io=Q;this.Z9b=[];this.XM=Ca}eCj(){for(let Q=0,Ca=this.Z9b.length;Q<Ca;Q++)Bd.a.Fy(this.Z9b[Q]);Array.clear(this.Z9b)}uxi(Q,Ca,sb,Xb,Cc,jd){let dd=Math.min(Xb.x-jd.x,Cc.x-jd.x);Xb=Math.min(jd.x+
jd.width-(Xb.x+Xb.width),jd.x+jd.width-(Cc.x+Cc.width));Ca+=Cc.y-jd.y;({Wma:Ca,Cba:dd,una:Xb}=this.C4k(Ca,dd,Xb));Q=this.WEm(Q,dd,Xb,dd,Xb,sb);Q.style.top=Ca+"px";Q.style.zIndex="0";this.Z9b.push(Q);Kr.d(Q,!0);return Q}X7d(Q){return Q?Q.querySelector(".PageBreakBorderSpan"):null}WEm(Q,Ca,sb,Xb,Cc,jd){return Q?this.EOm(Ca,sb,Xb,Cc,jd):this.pFm(Xb,Cc,jd)}C4k(Q,Ca,sb){Ca/=this.io.instance.Cj;sb/=this.io.instance.Cj;Q/=this.io.instance.Cj;return{Wma:Q,Cba:Ca,una:sb}}xmn(Q){return this.l4i(Q)&&this.$qj(Q)?
(Q=this.HQb(Q))&&Q.offsetParent?!1:!0:!1}wmn(Q){return!this.l4i(Q)||this.$qj(Q)?!1:!0}WU(){}HQb(Q){if(!Q.Ujg)return null;let Ca=null;Q.otb&&!Q.jga?(Q=this.X7d(Q.Ujg))&&(Ca=Q):Ca=Q.Ujg;return Ca}l4i(Q){return Q.otb&&!Q.jga&&Q.paragraphNode?!0:!1}$qj(Q){Q=Q.paragraphNode;return!!Q&&!!Q.anchor}WZh(Q,Ca){Q=la.a.qKa(Q);Ca=la.a.qKa(Ca);return(Q-Ca)/this.io.instance.Cj}jnf(Q,Ca){Q=la.a.qKa(Q);Ca=la.a.qKa(Ca);return(Q-Ca)/this.io.instance.Cj}Ocd(){this.W8j(!1)}Ncd(){this.W8j(!0)}W8j(Q){for(let Ca=0,sb=this.Z9b.length;Ca<
sb;Ca++){const Xb=this.Z9b[Ca];"PageEndMarker.Para"===Xb.id?im.$8j(Xb,Q):"PageEndMarker.Table"===Xb.id&&im.V9j(Xb,Q)}}pFm(Q,Ca,sb){if(!im.Tbc){im.Tbc=ji.b("div","PageEndMarker.Para","PageEndMarker");var Xb=ji.b("div","","Current FullWidth");Xb.style.borderTopColor=this.XM.YAa();im.Tbc.appendChild(Xb);Xb=ji.b("div","","Stale LeftWing");const Cc=ji.b("div","","Stale RightWing");Xb.style.borderTopColor=this.XM.YAa();Cc.style.borderTopColor=this.XM.YAa();im.Tbc.appendChild(Xb);im.Tbc.appendChild(Cc)}Xb=
im.Tbc.cloneNode(!0);Xb.childNodes[1].style.width=Q-10+"px";Xb.childNodes[2].style.width=Ca-10+"px";im.$8j(Xb,sb);return Xb}EOm(Q,Ca,sb,Xb,Cc){if(!im.uJb){im.uJb=ji.b("div","PageEndMarker.Table","PageEndMarker");var jd=ji.b("div","","Current LeftWing"),dd=ji.b("div","","Current RightWing");jd.style.borderTopColor=this.XM.YAa();dd.style.borderTopColor=this.XM.YAa();im.uJb.appendChild(jd);im.uJb.appendChild(dd);jd=ji.b("div","","Stale LeftWing");dd=ji.b("div","","Stale RightWing");jd.style.borderTopColor=
this.XM.YAa();dd.style.borderTopColor=this.XM.YAa();im.uJb.appendChild(jd);im.uJb.appendChild(dd)}jd=im.uJb.cloneNode(!0);jd.childNodes[0].style.width=Q+"px";jd.childNodes[1].style.width=Ca+"px";jd.childNodes[2].style.width=sb-10+"px";jd.childNodes[3].style.width=Xb-10+"px";im.V9j(jd,Cc);return jd}static $8j(Q,Ca){Ca?im.AKn(Q):im.BKn(Q)}static BKn(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="block"}static AKn(Q){Q.childNodes[0].style.display=
"block";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="none"}static V9j(Q,Ca){Ca?im.GKn(Q):im.HKn(Q)}static HKn(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="block";Q.childNodes[3].style.display="block"}static GKn(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="none";Q.childNodes[3].style.display="none"}}im.Tbc=null;im.uJb=null;Object(f.a)(im,"PageEndDOMHelper",
null,[]);class kn{constructor(Q,Ca){this.nHb=this.zAh=null;this.io=Q;this.oj=Ca}SFg(Q,Ca){try{this.tgp(Q,Ca)}catch(sb){wa.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",sb.message)}}Ayl(Q,Ca,sb,Xb,Cc,jd){this.oj.ee(()=>{try{this.Byl(Q,Ca,sb,Xb,Cc,jd)}catch(dd){wa.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",dd.message)}},"PEMPC:CP")}tgp(Q,Ca){this.zAh=Q;
this.nHb=Ca}Byl(Q,Ca,sb,Xb,Cc,jd){var dd=this.zAh;if(dd&&Q){var oe=dd.count,Me=Q.count;if(oe&&Me){var zf=this.e$l(dd,Q);if(zf.count){var uh=this.io.Cj,wj=this.wfc(zf)/uh,Sh=this.X5h(zf)/uh;Q=this.t3d(dd,Q);if(Q.count){dd=this.wfc(Q)/uh;uh=this.X5h(Q)/uh;var qi=!0;for(var yk=0;yk<zf.count;yk++)if(zf.K(yk)){qi=!1;break}var Zo=yk=0;this.nHb&&Ca&&(yk=this.nkl(this.nHb,Ca),Zo=Ca.count-this.nHb.count);wa.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:Xb,["EstimatedPageCount"]:oe,["CalculatedPageCount"]:Me,
["InOrderAverageDelta"]:wj,["InOrderStandardDeviation"]:Sh,["ShortestAverageDelta"]:dd,["ShortestStandardDeviation"]:uh,["PositionsShouldBeUpdated"]:sb,["DocumentHeightChanged"]:Cc,["DeltasAllZero"]:qi,["HeaderFooterOpenSinceLastResponse"]:jd,["DeltaInViewport"]:yk,["ChangeInViewportMarkerCount"]:Zo});Cc||jd||qi||(wa.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),Ca=zf.toArray().toString(),sb=Q.toArray().toString(),
wa.ULS.sendTraceTag(35726603,336,50,"{0} {1}",Ca,sb))}}}}else wa.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}nkl(Q,Ca){const sb=new hb.a;for(const Xb of Q)sb.add(Xb.top);if(!sb.count)return-1;Q=new hb.a;for(const Xb of Ca)Q.add(Xb.top);if(!Q.count)return-1;Ca=this.t3d(sb,Q);return this.wfc(Ca)/this.io.Cj}wfc(Q){if(!Q.count)return 0;let Ca=0;for(let sb=0;sb<Q.count;sb++)Ca+=Q.K(sb);return Ca/Q.count}X5h(Q){if(!Q.count)return 0;
const Ca=this.wfc(Q);let sb=0;for(let Xb=0;Xb<Q.count;Xb++){const Cc=Q.K(Xb)-Ca;sb+=Cc*Cc}return Math.sqrt(sb/Q.count)}e$l(Q,Ca){const sb=new hb.a;if(!Q.count||!Ca.count)return sb;Q.Sc((Cc,jd)=>Cc-jd);Ca.Sc((Cc,jd)=>Cc-jd);const Xb=Math.min(Q.count,Ca.count);for(let Cc=0;Cc<Xb;Cc++){const jd=Math.abs(Q.K(Cc)-Ca.K(Cc));sb.add(jd)}return sb}t3d(Q,Ca){const sb=new hb.a;if(!Q.count||!Ca.count)return sb;var Xb=Q.count<=Ca.count;const Cc=Xb?Q:Ca;Q=Xb?Ca:Q;for(Ca=0;Ca<Cc.count;Ca++){Xb=Cc.K(Ca);let dd=Math.abs(Xb-
Q.K(0)),oe=0;for(let Me=1;Me<Q.count;Me++){var jd=Q.K(Me);jd=Math.abs(Xb-jd);jd<dd&&(dd=jd,oe=Me)}sb.add(dd);Q.removeAt(oe)}return sb}}Object(f.a)(kn,"PageEndMarkerPositionComparer",null,[1317]);var Lo=d(404),qo=d(592);class pm{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf){this.zr=Q;this._pageNumber=Ca;this.otb=sb;this.jga=Xb;this.Ujg=Cc;this.cG=jd;this.xH=dd;this.Ayh=oe;this.paragraphNode=Me;this.fY=zf}get top(){return this.zr}get Fh(){return this._pageNumber}get l9n(){return this.Ayh}Fod(Q){this.zr=
Q}aye(Q){this._pageNumber=Q}zPj(Q){this.Ayh=Q}}Object(f.a)(pm,"PageEndMarker",null,[]);class bn{constructor(){this.Df=null;this.bhj=0}}Object(f.a)(bn,"PageEndMarkerToRestore",null,[]);class ro{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.Iig=(oe,Me)=>{Me.property===Xo.a.CR&&(oe=Me.node)&&oe.ka(Xo.a.CR,!1)&&this.WPd.contains(oe.id)&&(Me=oe.Ce(this.xl.sc))&&(Me=Me.htmlElement)&&(this.WPd.remove(oe.id),this.Y3a.add(Me))};this.$K=Q;this.io=Ca;this.nSa=sb;this.Fz=Xb;this.r3e=Cc;this.S1=jd;this.Pq=dd;this.uu=
new hb.a;this.$9b=new hb.a;this.tJb=new Rd.a;this.WPd=new qo.a(new Lo.a);this.Y3a=new hb.a;this.c$b=!!Cc;this.CTf()}get xl(){const Q=this.$K.value;wa.ULS.shipAssertTag(37052750,336,Q.jj,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return Q}gBc(Q){try{this.DAp(Q)}catch(Ca){this.Fz.WU(Ca.message+" "+Ca.stack),wa.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",Ca.message)}}RZk(Q){try{this.SZk(Q)}catch(Ca){this.Fz.WU(Ca.message+
" "+Ca.stack),wa.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",Ca.message)}}oll(Q){try{return this.pll(Q)}catch(Ca){this.Fz.WU(Ca.message+" "+Ca.stack),wa.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",Ca.message)}return!1}QJo(){try{this.RJo()}catch(Q){this.Fz.WU(Q.message+" "+Q.stack),wa.ULS.sendTraceTag(37052753,336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",
Q.message)}}D4c(){try{return this.qJm()}catch(Q){return this.Fz.WU(Q.message+" "+Q.stack),wa.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",Q.message),null}}QMg(){try{this.fCp()}catch(Q){this.Fz.WU(Q.message+" "+Q.stack),wa.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",Q.message)}}Nof(){try{return this.Drl()}catch(Q){return this.Fz.WU(Q.message+
" "+Q.stack),wa.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",Q.message),!1}}ocn(Q){try{this.pcn(Q)}catch(Ca){this.Fz.WU(Ca.message+" "+Ca.stack),wa.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",Ca.message)}}DAp(Q){if(Q){this.qtl();for(let Ca=0;Ca<Q.length;Ca++){const sb=Ca+1,Xb=this.pAl(Q[Ca],sb);this.uu.add(Xb);this.tJb.add(sb,Xb)}}}pcn(Q){let Ca=
!1;for(const sb of Q)if(sb)if(0<sb.ex)for(const Xb of sb.wWf)Ca=this.nRd(Xb,sb.xH)||Ca;else if(0>sb.ex){Ca=!0;for(const Xb of sb.n_d)this.QRl(Xb.Fh)}Ca&&this.Utg()}SZk(Q){const Ca=this.Qvi(Q.paragraphNode);this.nRd(Q,Ca)&&this.Utg()}QRl(Q){const Ca=Q-1;0>Ca||this.uu.count<=Ca||(this.uu.removeAt(Ca),this.tJb.mb(Q)&&this.tJb.remove(Q))}qJm(){const Q=new hb.a;for(const Ca of this.uu)this.Toc(Ca)&&Q.add(Ca);return Q}nRd(Q,Ca){if(!Q)return wa.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),
!1;Ca=this.nAl(Q,Ca);Q=Q.Ohn?-1:Q.Fh;let sb=!1,Xb;this.tJb.mb(Q)?(Xb=this.tJb.K(Q).Fh,Ca.aye(Xb),this.uu.W(Xb-1,Ca),this.tJb.remove(Q)):(Xb=Ca.Fh,this.uu.insert(Xb-1,Ca),sb=!0);return sb}pAl(Q,Ca){return new pm(0,Ca,Q.HardBreak,!1,null,null,null,0,null,null)}nAl(Q,Ca){const sb=Q.twb,Xb=Q.Fh,Cc=Q.fY,jd=!!Cc&&Cc.HardBreak,dd=Q.jga,oe=Q.paragraphNode,Me=this.xDi(Ca),zf=Q.cG;var uh=this.zMf(zf);if(!uh)return wa.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),
null;let wj=null;jd&&(wj=this.Fz.X7d(Q.twb));Q=this.Fz.WZh(wj||sb,Me);uh=this.Fz.jnf(wj||sb,uh);return new pm(uh,Xb,jd,dd,sb,zf,Ca,Q,oe,Cc)}pll(Q){this.$9b=new hb.a;this.c$b&&this.r3e.reset();this.zAo();this.vcp();this.D4k();this.cll(Q);return 0<this.$9b.count}zAo(){for(let Q=0;Q<this.uu.count;Q++){const Ca=this.uu.K(Q);this.Fz.xmn(Ca)?this.WIn(Ca):(this.Fz.wmn(Ca)||this.Toc(Ca)&&!this.zMf(Ca.cG))&&this.kDj(Ca)}}D4k(){let Q=0,Ca=null;var sb=0;let Xb=0;for(let Cc=0;Cc<this.uu.count;Cc++){const jd=
this.uu.K(Cc);this.Toc(jd)&&(jd.otb&&(Xb+=this.SZh(jd,sb,Xb)),Ca&&Ca.id===jd.cG.id||(Ca=jd.cG,Xb=Q=0),jd.otb&&!jd.jga&&(Q=this.$kl(jd)),sb=jd.top+Q+Xb,jd.Fod(sb))}this.SZh(null,sb,Xb);this.rAo()}SZh(Q,Ca,sb){let Xb=null;this.c$b&&(Xb=this.r3e.dll(Q,Ca,sb));return Xb?Xb.delta:0}RJo(){if(this.$9b){for(let Q=0;Q<this.$9b.count;Q++){const Ca=this.$9b.K(Q);Bd.a.BVo(Ca.Df,Ca.bhj)}this.c$b&&this.r3e.NJo()}}fCp(){if(!this.c$b){var Q=this.nSa.gBi();if(this.uu.count){var Ca=this.nSa.Byi();for(let Cc=0;Cc<this.uu.count;Cc++){var sb=
this.uu.K(Cc);if(this.Toc(sb)&&sb.jga){sb=this.nSa.UHm(sb.cG);var Xb=0<Cc?this.uu.K(Cc-1).cG:Ca;Xb=Cc&&sb.id===Xb.id?this.uu.K(Cc-1).top:0;this.nSa.$xe(sb,Xb)}}Ca=this.uu.K(this.uu.count-1);Ca.jga?this.nSa.$xe(Q,0):this.nSa.$xe(Q,Ca.top)}else this.nSa.$xe(Q,0)}}vcp(){this.uu.Sc((Q,Ca)=>Q.Fh-Ca.Fh)}Utg(){for(let Q=0;Q<this.uu.count;Q++)this.uu.K(Q).aye(Q+1)}$kl(Q){return Q?this.VZh(Q)-Q.top:(wa.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}mll(Q){if(!Q)return 0;
const Ca=this.xDi(Q.xH);return Ca?this.Fz.WZh(this.Fz.HQb(Q),Ca):0}VZh(Q){if(!Q)return 0;const Ca=this.Fz.HQb(Q);Q=this.zMf(Q.cG);return Q?this.Fz.jnf(Ca,Q):(wa.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),0)}rAo(){let Q=0,Ca=!1,sb=null,Xb=!1;for(let Cc=this.uu.count-1;0<=Cc;Cc--){const jd=this.uu.K(Cc);this.Toc(jd)&&(sb&&sb.id===jd.cG.id||(Ca=!sb,sb=jd.cG,Q=this.FEm(sb)),jd.otb?(Ca=!1,Q=jd.top):this.c$b&&
Ca||!(jd.top>Q)||(this.kDj(jd),Bd.a.Fy(this.Fz.HQb(jd)),Xb=!0))}Xb&&this.Utg()}kDj(Q){this.uu.contains(Q)&&(this.c$b&&this.S1.KBo(Q),this.uu.remove(Q))}Toc(Q){return Q?(Q=this.Fz.HQb(Q))&&Q.offsetParent?!0:!1:(wa.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),!1)}Drl(){let Q=!1;for(let Ca=this.Y3a.count-1;0<=Ca;Ca--)this.Y3a.K(Ca).hasChildNodes()&&(this.Y3a.removeAt(Ca),Q=!0);return Q}WIn(Q){(Q=this.Qvi(Q.paragraphNode))&&(this.WPd.contains(Q.id)||this.WPd.add(Q.id))}CTf(){this.Pq&&
this.Pq.jf(23).ro(this.Iig)}cll(Q){for(let Ca=this.uu.count-1;0<=Ca;Ca--){const sb=this.uu.K(Ca);this.Toc(sb)&&this.bll(sb,Q)}}bll(Q,Ca){const sb=this.VZh(Q),Xb=this.mll(Q);Q.otb?(Q.Fod(sb),Q.zPj(Xb)):(Ca=Ca?sb-Q.top:Xb-Q.l9n,Q.Fod(sb-Ca),Q.zPj(Xb-Ca),1<Math.abs(Ca)&&this.o_o(this.Fz.HQb(Q),Ca))}zMf(Q){if(!Q)return null;Q=Q.Ce(this.xl.sc);return Q?Q.htmlElement:(wa.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}xDi(Q){return Q?(Q=Q.Ce(this.xl.sc))?
Q.htmlElement:null:null}Qvi(Q){Q=ig.a.Za(Q);return Q.vb(23)?Q.fd(23):null}EEm(Q){if(!Q)return null;Q=Q.Ce(this.xl.sc);return Q?la.a.getElementBounds(Q.htmlElement):(wa.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}FEm(Q){return(Q=this.EEm(Q))?Q.height/this.io.Cj:0}o_o(Q,Ca){Ca=(Bd.a.Yrm(Q)-Ca)*this.io.Cj;this.$9b.add(Object.assign(new bn,{Df:Q,bhj:Ca}))}qtl(){this.uu=new hb.a;this.tJb=new Rd.a}}Object(f.a)(ro,"PageEndMarkerPositionUpdater",null,
[1316]);var ln=d(357),qm=d(184),Mo=d(26),On=d(353),nq=d(15),xm;(function(Q){Q[Q.Lcb=0]="para";Q[Q.Qjp=1]="tableSplit";Q[Q.Upq=2]="tableRowSplit"})(xm||(xm={}));Object(f.b)("PageEndType",xm);class Kl{constructor(Q,Ca,sb,Xb,Cc,jd,dd=!1,oe=!1,Me=!1,zf=!1,uh=!1){this.aOg(Ca,sb,Xb,Cc,jd,Me,uh);this.position=Q;this.Fh=Ca;this.paragraphNode=sb;this.fY=Xb;this.twb=Cc;this.cG=jd;this.hma=dd;this.G3i=oe;this.Ohn=Me;this.jga=zf;this.qfe=uh}aye(Q){this.Fh=Q}aOg(Q,Ca,sb,Xb,Cc,jd,dd){dd||(wa.ULS.shipAssertTag(38326881,
336,!!Cc,"PageEndDetails: outlineNode parameter value is null."),wa.ULS.shipAssertTag(24126528,336,0<=Q,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",Q),wa.ULS.shipAssertTag(24126529,336,!!Ca||jd,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),wa.ULS.shipAssertTag(24126530,336,!!sb||jd,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),wa.ULS.shipAssertTag(24126531,336,!!Xb||jd,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static XHl(Q,
Ca){return Kl.$sf(0,Q,null,Ca,!0,!1)}static YHl(Q){return Kl.$sf(0,0,null,Q,!1,!0)}static $sf(Q,Ca,sb,Xb,Cc,jd){return new Kl(Q,Ca,null,null,sb,Xb,Cc,jd,!0)}static agc(Q,Ca){return new Kl(0,Q,null,Ca,null,null,void 0,void 0,void 0,void 0,!0)}}Object(f.a)(Kl,"PageEndDetails",null,[]);class Vk{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe,Me,zf,uh,wj,Sh,qi,yk,Zo,Hn,zn,At,Ba){this.Qxa=!0;this.sOe=0;this.XId=this.uUe=this.wUe=this.vQe=this.p3e=this.eUe=!1;this.RKd=this.IHb=null;this.TXe=!0;this.KWb=()=>{this.Ocd()};
this.Bfg=()=>{this.wUe=!1};this.Cfg=()=>{this.uUe=this.wUe=!0};this.v2n=(Ra,Ga)=>{1>=Math.abs(Ga.delta)||(this.vQe=!0,this.V8j(!Ga.Ugj))};this.cuo=Ra=>{Ra===this.IHb&&(this.IHb=null);if(this.Qxa){var Ga=Ra.em;if(Ra=this.Z3a.get(Ga.id))for(this.Z3a.W(Ga.id,new hb.a),wa.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",Ra.count,Ga.id),this.Pda&&this.Pda.QIa(),Ga=0;Ga<Ra.count;Ga++){const xa=Ra.K(Ga),Ua=xa.fY;Ua.HardBreak||(Bd.a.Fy(xa.twb),
this.Htg(Ua))}}};this.buo=()=>{this.RKd=null;this.Qxa&&this.Xma&&0<this.Xma.count&&(wa.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.gBc(this.Xma.toArray(),this.Qxa))};this.$K=Q;this.Fi=Ca;this.Pda=sb;this.NQ=Xb;this.Jyh=Cc;this.mkb=jd;Vk.Fz=oe;this.Ojh=Me;this.cL=zf;this.Gb=uh;this.Oxk=wj;this.Zd=qi;this.S1=Zo;this.t3e=Hn;this.e$b=zn;this.v1=At;this.I9b=new ln.a;this.a$b=new hb.a;this.Xma=new hb.a;this.Z3a=new ln.a;this.zQ=Sh;this.AG=Ba;this.kpe=this.kpe.bind(this);
this.mpe=this.mpe.bind(this);this.Yjd=this.Yjd.bind(this);this.Cga=this.Cga.bind(this);this.zQ.VSc(this.KWb);this.q3e=!1;yk&&(yk.fQh(this.Cfg),yk.GRd(this.Bfg));dd&&dd.s2k(this.v2n);this.AG.sKb(this.Cga)}get ife(){return this.TXe}get xl(){return this.$K.value}get Gj(){return this.Fi.value}gBc(Q,Ca){const sb=this.Zd.Xf("Task","UpdateMarkers");this.rgp();this.Qxa=Ca;Vk.Fz.eCj();this.I9b=new ln.a;this.a$b.clear();this.Xma.clear();this.Z3a=new ln.a;this.TXe=this.eUe=!1;this.NQ&&this.NQ.gBc(Q);this.V2l();
this.sOe=Q.length;this.S1&&this.S1.reset(Q);this.Pda&&this.Pda.QIa();for(const Xb of Q)this.Xma.add(Xb),this.Htg(Xb);Ca&&this.NQ&&this.t3e&&this.t3e.isEnabled&&(Q=this.NQ.D4c(),this.t3e.qIa(Q));this.zyl();this.vQe=this.p3e=!1;this.uUe=this.wUe;Object(qm.a)()&&Vk.xUf&&this.NQ.QMg();this.mkb.aBp(this.NQ.D4c(),this.Xma.count);this.TXe=!0;this.v1.DMg();sb.stop();wa.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:sb.Hi,["RenderedLineCount"]:this.sOe,["AvgDurationPerPageInMs"]:sb.Hi/
this.FDi()})}HDi(){const Q=this.NQ.D4c();if(!Q)return null;const Ca=Bd.a.tX(),sb=new hb.a;for(const Xb of Q)this.Aqn(Xb,Ca)&&sb.add(Xb);return sb}Aqn(Q,Ca){if(!Q)return!1;Q=Vk.Fz.HQb(Q);if(!Q)return!1;Q=la.a.qKa(Q);return 0<=Q&&Q<=Ca}Lsi(){const Q=new hb.a;if(!this.Z3a)return wa.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),Q;const Ca=this.Z3a.keys;for(let Cc=0;Cc<Ca.length;Cc++){var sb=Ca.K(Cc);if(sb=this.Z3a.K(sb))for(let jd=
0;jd<sb.count;jd++){var Xb=sb.K(jd);Xb.fY.HardBreak||Xb.twb.classList.contains("Hidden")||(Xb=la.a.qKa(Xb.twb),Q.add(Xb))}}return Q}rgp(){const Q=this.Lsi(),Ca=this.HDi();this.Jyh.SFg(Q,Ca);this.e$b&&this.e$b.isEnabled&&this.e$b.SFg(Ca)}zyl(){if(!(25<this.FDi())){var Q=this.Lsi(),Ca=this.HDi();this.Jyh.Ayl(Q,Ca,this.p3e,this.eUe,this.vQe,this.uUe);this.e$b&&this.e$b.isEnabled&&this.e$b.qIa(Ca)}}Cga(){this.Pda.JBo();this.qfi()}qfi(){this.XId&&(this.xl.hEj(this.kpe),this.xl.LDo(this.mpe),this.xl.rDo(this.Yjd),
this.XId=!1)}V2l(){this.XId||(this.xl.DPh(this.kpe),this.xl.d3k(this.mpe),this.xl.bQh(this.Yjd),this.XId=!0)}Htg(Q){if(this.q3e)return!0;Q=this.QEo(Q);if(!Q)return!1;this.S1&&this.S1.JXm(Q);this.NQ&&(this.NQ.RZk(Q),this.mkb.S8j(this.NQ.D4c()),Object(qm.a)()&&Vk.xUf&&this.NQ.QMg());return!0}QEo(Q){let Ca=this.aK(Q.ParaId);if(!Ca)return null;if(!Ca.anchor||!Ca.qk)return this.XOh(Q,Ca),null;let sb,Xb;if(Q.HardBreak){var Cc=Ji.ParagraphReader.mg(Ca,!0,!0,!0);this.eao(Cc)&&(Ca=Cc);if(!({Wma:Cc,xH:sb,rwb:Xb}=
this.Orp(Q,Ca)).returnValue)return null;this.eUe=!0}else if(!({fpe:Cc,xH:sb,rwb:Xb}=this.REo(Q,Ca)).returnValue)return null;return this.nRd(Ca,Q,Cc,sb,Xb)}eao(Q){return Q?(Q=Q.Ce(this.xl.sc))?!!Vk.Fz.X7d(Q.htmlElement):!1:!1}REo(Q,Ca){var sb=Q.PageEndType;let Xb,Cc=0,jd=null;if(!sb){if(!({Wma:Q,Cjg:Xb}=this.IDi(Q,Ca)).returnValue)return{returnValue:!1,fpe:Cc,xH:jd,rwb:null}}else if(!({Wma:Q,hCe:Xb}=this.XEm(Q,Ca)).returnValue)return{returnValue:!1,fpe:Cc,xH:jd,rwb:null};var dd=ig.a.Za(Ca);dd.Ld();
jd=dd.fd(23);Ca=jd.Ce(this.xl.sc).getBounds();dd=dd.p_a().Ce(this.xl.sc);if(!dd)return wa.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.xl.sc),{returnValue:!1,fpe:Cc,xH:jd,rwb:null};const oe=dd.getBounds();Cc=Q-Ca.y;sb=Vk.Fz.uxi(sb,Cc,this.Qxa,Xb,Ca,oe);dd.afa.appendChild(sb);return{returnValue:!0,fpe:Cc,xH:jd,rwb:sb}}Orp(Q,Ca){let sb=null;const Xb=Ca.Ce(this.xl.sc);var Cc=0;let jd=null;if(this.Nge(Q,Xb,Ca))return{returnValue:!1,Wma:Cc,xH:sb,rwb:jd};sb=Vk.Agj(Ca);
const dd=sb.Ce(this.xl.sc);if(!dd)return wa.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.xl.sc),{returnValue:!1,Wma:Cc,xH:sb,rwb:jd};Cc=dd.getBounds();Cc=zi.a.Cr(Xb,Q.CP).y-Cc.y;jd=this.Jvm(Ca);return{returnValue:!0,Wma:Cc,xH:sb,rwb:jd}}Jvm(Q){return Q.Ce(this.xl.sc).htmlElement}aK(Q){const Ca=this.cL.irb(Q);if(Ca!==cc.a.nil){const sb=this.Gj.Eb(Ca);if(sb)return sb}wa.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",
Q,Ca);return null}IDi(Q,Ca){const sb=Q.CP;let Xb=0,Cc=null;const jd=Ca.Ce(this.xl.sc);if(this.Nge(Q,jd,Ca))return{returnValue:!1,Wma:Xb,Cjg:Cc};Cc=jd.getBounds();Xb=sb?this.Ojh(Object(Xa.a)(163,jd),sb):Cc.y-this.Oxk(jd);return{returnValue:!0,Wma:Xb,Cjg:Cc}}XEm(Q,Ca){let sb=null,Xb=0;var Cc=Q.PageEndType;let jd=ig.a.Za(Ca);jd.Ld();if(!Mo.TableReader.yy(jd))return wa.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",Q.ParaId),
{returnValue:({Wma:Xb,Cjg:sb}=this.IDi(Q,Ca)).returnValue,Wma:Xb,hCe:sb};if(Cc===xm.Qjp){nq.returnToContainingRow(jd);Cc=jd.currentNode.Ce(this.xl.sc);if(this.Nge(Q,Cc,Ca))return{returnValue:!1,Wma:Xb,hCe:sb};Xb=Cc.getBounds().y}else{Cc=Ca.Ce(this.xl.sc);if(this.Nge(Q,Cc,Ca))return{returnValue:!1,Wma:Xb,hCe:sb};Xb=this.Ojh(Object(Xa.a)(163,Cc),Q.CP)}--Xb;Ca=null;do Q=Ca,Ca=jd.fd(14);while(Ca);jd=ig.a.Za(Q);jd.Ld();nq.moveToFirstRow(jd);sb=jd.currentNode.Ce(this.xl.sc).getBounds();return{returnValue:!0,
Wma:Xb,hCe:sb}}Nge(Q,Ca,sb){if(!Ca||Ca.c8(16))return this.XOh(Q,sb),!0;Ca=Ca.getBounds();return Ca.width||Ca.height?!1:(this.eOh(Q),!0)}eOh(Q){this.a$b.contains(Q)||this.a$b.add(Q)}XOh(Q,Ca){Ca=Ca.id;let sb;({value:sb}=this.I9b.Ec(Ca)).returnValue||(sb=new hb.a,this.I9b.W(Ca,sb));sb.add(Q)}kpe(){const Q=new hb.a;for(let Ca=this.a$b.count-1;0<=Ca;Ca--){const sb=this.a$b.K(Ca);this.Htg(sb)||Q.add(sb)}this.a$b=Q;this.Nof()}Nof(){this.NQ&&this.NQ.Nof()&&this.V8j(!1)}V8j(Q){this.NQ&&(this.NQ.oll(Q)&&(this.p3e=
!0),this.NQ.QJo(),this.mkb.S8j(this.NQ.D4c()),Object(qm.a)()&&Vk.xUf&&this.NQ.QMg())}mpe(Q,Ca){try{const sb=Ca.id;if(this.I9b.mb(sb)){const Xb=this.I9b.K(sb);for(Q=0;Q<Xb.count;Q++)this.eOh(Xb.K(Q));this.I9b.remove(sb)}}catch(sb){}}Ocd(){this.Qxa&&(this.Qxa=!1,Vk.Fz.Ocd())}Ncd(){this.Qxa||(this.Qxa=!0,Vk.Fz.Ncd())}rVj(){this.q3e=!1;this.Xma&&this.gBc(this.Xma.toArray(),this.Qxa);this.Pda&&this.Pda.qVj()}UOi(){this.q3e=!0;Vk.Fz.eCj();this.Pda&&this.Pda.TOi();this.S1&&this.S1.G1m()}nRd(Q,Ca,sb,Xb,Cc){const jd=
this.Xma.indexOf(Ca)+1;if(0>jd)return null;const dd=nr.WordSectionNavigator.instance.jS(Q),oe=this.jga(Ca,Q);Q=new Kl(sb,jd,Q,Ca,Cc,dd,!Q||!Ca||!Cc,!1,!1,oe);this.Z3a.mb(Xb.id)||this.Z3a.W(Xb.id,new hb.a);this.Z3a.K(Xb.id).add(Q);return Q}jga(Q,Ca){if(!Q||!Q.HardBreak)return!1;Q=ig.a.Za(Ca);Q.vb(7);if(Q.bK())return!1;Q.fd(23);return Q.bK()?!1:!0}Qqg(Q){this.Qxa&&(Q.anchor&&Q.qk?!(Q=Vk.Agj(Q))||this.IHb&&this.IHb.em&&this.IHb.em.id===Q.id||(this.IHb=Object.assign(new cd.a(3,1,500,this.cuo),{em:Q}),
this.Gb.Yb(this.IHb)):wa.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}Yjd(){this.Qxa&&!this.RKd&&this.Xma&&0<this.Xma.count&&(this.RKd=new cd.a(3,1,500,this.buo),this.Gb.Yb(this.RKd))}dispose(){this.xl&&this.qfi();this.AG.gtg(this.Cga);this.zQ.lue(this.KWb)}static get xUf(){null==Vk.zVe&&(Vk.zVe=m.AFrameworkApplication.J.$("ImageOverflowUpdateHeightIsEnabled"));return Vk.zVe}static Fvm(Q){let Ca=0;try{const sb=Q.htmlElement,Xb=Bd.a.OP(sb.firstChild.style.marginTop);
Q=0;const Cc=Vk.dNf(sb.parentNode);if(Cc){const jd=Cc.firstChild;jd&&jd.classList.contains("ParaWrappingDiv")&&(Q=Bd.a.OP(jd.firstChild.style.marginBottom))}Ca=Math.max(Xb,Q)/2}catch(sb){}return Ca}static dNf(Q){let Ca=Q.previousSibling;if(!Ca){var sb=Q.parentNode;Bd.a.n_f(sb)&&(sb=sb.parentNode)&&(Ca=sb.previousSibling)}if(!Ca&&(Q=Q.parentNode,Q.classList.contains("OutlineGroup")||wa.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",Q.tagName,
Q.className),(Q=Q.previousSibling)&&Q.hasChildNodes())){Ca=Q.lastChild;do{if(Ca.classList.contains("OutlineElement")||Bd.a.n_f(Ca)&&Ca.classList.contains(On.a.Nqc))break;Ca=Ca.previousSibling}while(Ca)}if(Ca){if(Ca.classList.contains(On.a.Nqc))return Ca.lastChild.lastChild;if(Bd.a.n_f(Ca))return Ca.lastChild}return Ca}static Agj(Q){Q=ig.a.Za(Q);return Q.vb(23)?Q.fd(23):null}FDi(){return this.sOe+1}}Vk.Fz=null;Vk.zVe=null;Object(f.a)(Vk,"PageEndMarkers",null,[1033,1034,11]);var xn=d(174);class No{constructor(Q,
Ca,sb){this.h9n=".Outline";this.$K=Q;this.io=Ca;this.Fz=sb}get xl(){const Q=this.$K.value;wa.ULS.shipAssertTag(38416594,336,Q.jj,"Invalid PageView.");return Q}Rjc(Q){return(Q=Q.cG)?this.vDi(Q):(wa.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}vDi(Q){let Ca,sb;return(Ca=Q.Ce(this.xl.sc))&&(sb=Ca.htmlElement)?sb.querySelector(this.h9n):(wa.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}Pvi(Q){Q=Ok.OutlineElementNavigator.Cm(Q.paragraphNode);let Ca;
return Q&&(Ca=Q.Ce(this.xl.sc))?Ca.htmlElement:(wa.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}IZh(Q,Ca){const sb=this.NSm(Q);return this.hll(Q,Ca)-sb}qxi(Q){return this.ADi(Q.cG,Q.Fh)}ADi(Q,Ca){if(!Q)return-1;var sb=Q.ka(lf.a.vw,-1);sb=Bo.a.sj(sb,1);var Xb=Q.ka(lf.a.marginTop,-1);Xb=Bo.a.sj(Xb,1);Q=Q.ka(lf.a.marginBottom,-1);Q=Bo.a.sj(Q,1);return 1===Ca?sb-Q:sb-(Xb+Q)}ORl(Q){Q&&Bd.a.Fy(Q.twb)}$Mf(Q){if(Q.G3i||Q.jga)return 0;if(Q.hma)return Q=this.Rjc(Q),la.a.getElementBounds(Q).height/
this.io.Cj;const Ca=this.Rjc(Q);return this.Fz.jnf(this.GDi(Q),Ca)}sFl(Q,Ca,sb){sb=sb.Ce(this.xl.sc).getBounds();Q=Q.Ce(this.xl.sc);const Xb=Q.getBounds();sb.y=Xb.y;Ca=this.Fz.uxi(xm.Lcb,Ca*this.io.Cj,!1,sb,sb,Xb);Q.afa.appendChild(Ca);return Ca}pTi(Q,Ca){if(Q&&!Q.qfe)if(Q.hma){if(Q=this.Rjc(Q))Q.style.paddingBottom=Ca+"px"}else if(Q.fY&&Q.fY.HardBreak)if(Q.jga){if(Q=this.cFi(Q))Q.style.paddingBottom=Ca+"px"}else{if(Q=this.Pvi(Q))Q.style.paddingTop=Ca+"px"}else wa.ULS.shipAssertTag(39077394,336,!1,
"Applying blank space on a page which is not hard break or last page.")}UQh(Q,Ca){Ca=this.Rjc(Ca);Q=this.Rjc(Q);return la.a.qKa(Ca)-la.a.qKa(Q)}dFi(Q){Q=ig.a.Za(Q.cG);Q.vb(7);return Q.bK()}r0i(Q){if(!Q||Q.qfe)return!1;if(Q.hma||Q.G3i)return!0;Q=this.GDi(Q);return!!Q&&Bd.a.efa(Q)}WU(Q){this.Fz.WU(Q)}cFi(Q){return(Q=this.dFi(Q))?(Q=Q.Wl(this.xl.sc).htmlElement,Q?Q:(wa.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}GDi(Q){return Q.fY&&Q.fY.HardBreak&&!Q.jga?this.Fz.X7d(Q.twb):
Q.twb}NSm(Q){if(Q.hma){Q=this.Rjc(Q);if(!Q)return wa.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;Q=xn.a.bC(Q);return Bd.a.xla(Q.paddingBottom)}if(Q.fY&&Q.fY.HardBreak){if(Q.jga)return(Q=this.cFi(Q))?Bd.a.xla(Q.style.paddingBottom):-1;Q=this.Pvi(Q);return Q?Bd.a.xla(Q.style.paddingTop):(wa.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}hll(Q,Ca){return this.$Mf(Q)-Ca}}Object(f.a)(No,"PageFullHeightDOMHelper",null,[]);class Hh{constructor(){this.delta=
this.Wbk=this.ex=0;this.Vma=null;this.pVa=this.tvj=0;this.xH=null;this.TIa=0;this.wWf=new hb.a;this.n_d=new hb.a;this.PSn=new hb.a}}Object(f.a)(Hh,"PageFullHeightInfo",null,[]);class Zr{constructor(Q,Ca){this.VGa=Q;this.Gz=Ca}TZh(Q,Ca){try{return this.ell(Q,Ca)}catch(sb){return this.Gz.WU(sb.message+" "+sb.stack),wa.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",sb.message),null}}ell(Q,Ca){wa.ULS.shipAssertTag(38416596,336,Q.hma||Q.fY.HardBreak);
const sb=this.Gz.$Mf(Q),Xb=this.Gz.IZh(Q,Ca),Cc=this.VGa.EZh(Q,Xb);Q=Object.assign(new Hh,{TIa:Xb,pVa:Cc,Vma:Q});this.Nzp(Q);Q.Wbk=Q.pVa-Q.TIa;Q.delta=Ca+Cc+Q.delta-sb;return Q}Nzp(Q){Q.TIa>Q.pVa?this.Ozp(Q):0>Q.TIa&&this.qMg(Q)}qMg(Q){let Ca=Q.Vma.Fh;for(;0>Q.TIa;)Q.ex--,Q.delta-=this.VGa.e3c(Ca),Q.TIa+=this.VGa.e3c(Ca-1),Ca--;Q.pVa=this.VGa.e3c(Ca)}Ozp(Q){const Ca=this.Gz.qxi(Q.Vma);Q.ex=Math.floor((Q.TIa-Q.pVa)/Ca)+1;Q.delta=Q.ex*Ca;Q.TIa-=Q.pVa+(Q.ex-1)*Ca;Q.pVa=Ca}}Object(f.a)(Zr,"PageFullHeightInfoCalculator",
null,[]);class Rt{constructor(Q,Ca,sb,Xb){this.z5a=0;this.pTa=null;this.VGa=Q;this.OGb=Ca;this.WZ=sb;this.Gz=Xb;this.NBh=new hb.a}get L0(){return this.NBh}JXm(Q){try{this.YRf(Q)}catch(Ca){this.Gz.WU(Ca.message+" "+Ca.stack),wa.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",Ca.message)}}reset(Q){try{this.hIo(Q)}catch(Ca){this.Gz.WU(Ca.message+" "+Ca.stack),wa.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",
Ca.message)}}G1m(){try{this.H1m()}catch(Q){this.Gz.WU(Q.message+" "+Q.stack),wa.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",Q.message)}}qcn(Q){try{this.rcn(Q)}catch(Ca){this.Gz.WU(Ca.message+" "+Ca.stack),wa.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",Ca.message)}}KBo(Q){try{this.LBo(Q)}catch(Ca){this.Gz.WU("Pagination: "+Ca.message+" "+Ca.stack),wa.ULS.sendTraceTag(39387716,
336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",Ca.message)}}u9m(){var Q=this.WZ.$Jf(),Ca=this.WZ.aBi();Q=Kl.YHl(Q);Ca=Kl.XHl(this.z5a,Ca);this.L0.W(0,Q);this.YRf(Ca)}lIo(){var Q=nr.WordSectionNavigator.instance.aBi();(Q=this.Gz.vDi(Q).parentNode)&&""!==Q.style.minHeight&&(Q.style.minHeight="")}u$m(Q){this.NBh=new hb.a;this.L0.add(null);for(let Ca=0;Ca<Q.length;Ca++){const sb=Kl.agc(Ca+1,Q[Ca]);this.L0.add(sb)}this.L0.add(Kl.agc(Q.length+1,null))}e$m(Q){this.VGa.rIo(Q)}QIo(){if(this.L0)for(const Q of this.L0)Q&&
this.WYi(Q)&&this.Gz.pTi(Q,0)}YRf(Q){const Ca=this.OHm(Q);if(this.Gz.r0i(Ca)){let sb=this.Gz.$Mf(Ca);Q.cG!==Ca.cG&&(sb+=this.Gz.UQh(Q,Ca));this.lkl(Q,sb);this.WYi(Q)&&this.Itg(Q,sb)}else this.pTa.add(Q),20<this.pTa.count&&wa.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.pTa.count);this.L0.W(Q.Fh,Q);this.xXm(Q)}H1m(){this.QIo()}hIo(Q){this.z5a=Q.length+1;this.pTa=new hb.a;this.u$m(Q);this.e$m(this.z5a);this.u9m();this.lIo()}rcn(Q){this.VGa.eBp(Q);for(const Ca of Q){if(!Ca){wa.ULS.sendTraceTag(38916955,
336,10,"info is null.");return}if(0<Ca.ex){Q=Ca.Vma.Fh;for(const sb of Ca.wWf)this.L0.insert(Q,sb),Q++}else if(0>Ca.ex)for(const sb of Ca.n_d)this.L0.remove(sb),this.pTa.contains(sb)&&this.pTa.remove(sb)}this.lFj()}LBo(Q){Q=Q.Fh;this.VGa.MBo(Q);this.L0.removeAt(Q);for(const Ca of this.pTa)Ca.Fh===Q&&this.pTa.remove(Ca);this.lFj()}lkl(Q,Ca){Ca=this.Gz.IZh(Q,Ca);this.VGa.EZh(Q,Ca)}Itg(Q,Ca){Q.fY&&Q.fY.HardBreak||this.OGb.Itg(Q,Ca)}xXm(Q){Q=Q.Fh+1;for(const Ca of this.pTa)if(Ca&&Ca.Fh===Q){this.YRf(Ca);
this.pTa.remove(Ca);break}}lFj(){for(let Q=0;Q<this.L0.count;Q++){const Ca=this.L0.K(Q);Ca&&Ca.aye(Q)}}WYi(Q){Q=this.REm(Q);return 2===Q||1===Q}OHm(Q){return this.L0.K(Q.Fh-1)}REm(Q){return Q.hma?2:Q.fY&&Q.fY.HardBreak?1:0}}Object(f.a)(Rt,"PageFullHeightManager",null,[1349]);class oq{constructor(Q,Ca,sb,Xb){this.OGb=Q;this.VGa=Ca;this.WZ=sb;this.Gz=Xb}create(){return new Rt(this.VGa,this.OGb,this.WZ,this.Gz)}}Object(f.a)(oq,"PageFullHeightManagerFactory",null,[]);var kp=d(1080),Do=d(708);class pq{constructor(Q,
Ca,sb,Xb,Cc){this.b$b=null;this.S1=Q;this.NQ=Ca;this.tNc=sb;this.OGb=Xb;this.Gz=Cc}reset(){this.b$b=new hb.a}dll(Q,Ca,sb){try{return this.fll(Q,Ca,sb)}catch(Xb){return wa.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Xb.message),null}}NJo(){try{this.OJo()}catch(Q){wa.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",Q.message)}}fll(Q,Ca,sb){if(!this.S1.L0.count)return null;
const Xb=this.VEm(Q,!Q);if(!Xb||Xb.qfe)return wa.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Xb.fY&&Xb.fY.HardBreak)return null;var Cc=this.S1.L0.K(Xb.Fh-1);return this.Gz.r0i(Cc)&&(Ca-=sb,Xb.cG!==Cc.cG&&(Ca+=this.Gz.UQh(Xb,Cc)),(Cc=this.tNc.TZh(Xb,Ca))&&1<Math.abs(Cc.delta))?(Cc.tvj=Ca,Cc.xH=this.CEm(Q,Xb),this.b$b.add(Cc),this.qMg(Cc),Cc):null}CEm(Q,Ca){return Ca&&Ca.hma?(Q=Object(Xa.a)(Do.a,Ji.ParagraphReader.xE(Ca.cG)),Q=ig.a.Za(Q),Q.yq(),Object(Xa.a)(kp.a,
Q.fd(23))):Q&&Q.otb?Q.xH:null}OJo(){this.b$b.Sc((Q,Ca)=>Ca.Vma.Fh-Q.Vma.Fh);for(const Q of this.b$b)this.OGb.YEj(Q);this.iBp()}iBp(){this.NQ.value.ocn(this.b$b);this.S1.qcn(this.b$b)}VEm(Q,Ca){return Ca?this.S1.L0.K(this.S1.L0.count-1):this.S1.L0.K(Q.Fh)}qMg(Q){let Ca=Q.Vma.Fh;const sb=-Q.ex;for(let Xb=0;Xb<sb;Xb++)Ca--,Q.n_d.add(this.S1.L0.K(Ca))}}Object(f.a)(pq,"PageFullHeightPositionUpdater",null,[1348]);class $r{constructor(Q,Ca,sb,Xb,Cc){this.S1=Q;this.NQ=Ca;this.tNc=sb;this.OGb=Xb;this.Gz=Cc}create(){return new pq(this.S1,
this.NQ,this.tNc,this.OGb,this.Gz)}}Object(f.a)($r,"PageFullHeightPositionUpdaterFactory",null,[]);class sp{constructor(Q,Ca){this.Gz=Q;this.tNc=Ca}Itg(Q,Ca){try{this.UEo(Q,Ca)}catch(sb){this.Gz.WU(sb.message+" "+sb.stack),wa.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",sb.message)}}YEj(Q){try{this.TEo(Q)}catch(Ca){this.Gz.WU(Ca.message+" "+Ca.stack),wa.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",Ca.message)}}UEo(Q,
Ca){wa.ULS.shipAssertTag(38285913,336,Q.hma||Q.fY.HardBreak);Q=this.tNc.TZh(Q,Ca);this.YEj(Q)}TEo(Q){this.SEo(Q);this.KEo(Q)}KEo(Q){0<Q.ex?this.Acn(Q):0>Q.ex&&this.PRl(Q)}SEo(Q){this.Gz.pTi(Q.Vma,Q.Wbk)}Acn(Q){let Ca=Q.tvj+Q.pVa;for(let Xb=0;Xb<Q.ex;Xb++){var sb=Q.Vma.Fh+Xb;const Cc=Q.Vma.jga?this.Gz.dFi(Q.Vma):Q.Vma.cG;sb=this.rFl(Cc,Q.xH,Ca,sb);Q.wWf.add(sb);Q.PSn.add(Ca);Ca+=Q.pVa}}PRl(Q){for(const Ca of Q.n_d)this.Gz.ORl(Ca)}rFl(Q,Ca,sb,Xb){Ca=this.Gz.sFl(Q,sb,Ca);return Kl.$sf(sb,Xb,Ca,Q,!1,
!1)}}Object(f.a)(sp,"PageFullHeightRenderer",null,[]);class Ks{constructor(Q){this.fqg=Q}}Object(f.a)(Ks,"PageHeightDeltaResult",null,[1346]);class vt{constructor(Q,Ca,sb){this.$p=null;this.Gz=Q;this.oj=Ca;sb.execute(Xb=>{Xb.register(this)})}get Fdd(){return"PageHeightDelta"}get result(){return this.$p}get Ccg(){return 1}get dxg(){return 500}get isEnabled(){return!0}Qcg(){this.$p=null}qIa(Q){this.oj.ee(()=>{try{this.SUc(Q)}catch(Ca){wa.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",
Ca.message)}},"PHDM:C")}SUc(Q){this.$p=null;Q=this.TUc(Q);-1!==Q&&(this.$p=new Ks(Q))}TUc(Q){if(!Q.count)return-1;let Ca=0,sb=0;for(const Xb of Q)Q=this.gll(Xb),-1!==Q&&(Ca+=Q,sb++);return sb?Ca/sb:-1}gll(Q){if(!Q.aln)return-1;const Ca=this.Gz.ADi(Q.STd,Q.Fh);return-1===Ca?-1:Math.abs(Q.height-Ca)}}Object(f.a)(vt,"PageHeightDeltaMetric",null,[1314]);class St{constructor(Q){this.G2a=null;this.Gz=Q}e3c(Q){return this.G2a.K(Q-1)}rIo(Q){this.G2a=new hb.a;for(let Ca=0;Ca<Q;Ca++)this.G2a.add(-1)}EZh(Q,
Ca){if(this.Bqn(Q))return this.G2a.K(Q.Fh-1);Ca=this.Fkl(Q,Ca);this.sgp(Q,Ca);return Ca}eBp(Q){for(const Ca of Q)this.dBp(Ca)}sgp(Q,Ca){this.G2a.W(Q.Fh-1,Ca)}MBo(Q){this.G2a.removeAt(Q-1)}dBp(Q){if(Q)if(0<Q.ex){var Ca=Q.Vma.Fh;for(var sb=0;sb<Q.ex;sb++)this.G2a.insert(Ca,Q.pVa)}else if(0>Q.ex)for(Ca=-Q.ex,Q=Q.Vma.Fh-Ca,sb=0;sb<Ca;sb++)this.G2a.removeAt(Q)}Bqn(Q){return-1!==this.G2a.K(Q.Fh-1)}Fkl(Q,Ca){if(Q.hma||Q.fY.HardBreak)Q=this.Gz.qxi(Q),Ca=Ca<Q?Q:Ca;return Ca}}Object(f.a)(St,"PageHeightStorage",
null,[]);var $l=d(251);class Hc{constructor(Q){this.fqg=Q}}Object(f.a)(Hc,"PageLevelDeltaResult",null,[1346]);class qn{constructor(Q,Ca,sb,Xb){this.$p=null;this.$K=Q;this.yya=Ca;this.oj=sb;Xb.execute(Cc=>{Cc.register(this)})}get xl(){const Q=this.$K.value;wa.ULS.shipAssertTag(39081438,336,Q.jj,"PageLevelDeltaMetric.PageView is not a PageView.");return Q}get Fdd(){return"PageLevelDelta"}get result(){return this.$p}get Ccg(){return 0}get dxg(){return 60}get isEnabled(){return!0}Qcg(){this.$p=null}qIa(Q){this.oj.ee(()=>
{try{this.SUc(Q)}catch(Ca){wa.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",Ca.message)}},"PLDM:C")}SUc(Q){this.$p=null;Q=this.TUc(Q);-1!==Q&&(this.$p=new Hc(Q))}TUc(Q){if(!Q.count)return-1;let Ca=0,sb=0;for(const Xb of Q)Q=this.ill(Xb),-1!==Q&&(Ca+=Q,sb++);return sb?Ca/sb:-1}ill(Q){if(Q.otb)return-1;var Ca=Q.fY.CP;Q=Q.paragraphNode;wa.ULS.shipAssertTag(39081441,336,!!Q);Q=Q.Ce(this.xl.sc);wa.ULS.shipAssertTag(39081442,324,Object($l.a)(163,Q));
let sb;({Y8h:Ca,V6i:Q,vIj:sb}=this.Ukl(Q,Bd.a.Vz(Q.htmlElement).length,Ca));return Q&&sb?Math.min(Ca.x-Q.x,sb.x-Ca.x):(wa.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}Ukl(Q,Ca,sb){let Xb,Cc,jd,dd=Cc=sb,oe=jd=Xb=null;if(sb>Ca)return wa.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{Y8h:oe,WAn:dd,V6i:jd,tLo:Cc,vIj:Xb};oe=this.yya.Cr(Q,
sb);for(var Me=0,zf=sb;Me<=zf;){const uh=Math.floor((Me+zf)/2),wj=this.yya.Cr(Q,uh);if(Me===zf){dd=uh;jd=wj;break}wj.y+wj.height<=oe.y?Me=uh+1:zf=uh}for(;sb<=Ca;){Me=Math.ceil((sb+Ca)/2);zf=this.yya.Cr(Q,Me);if(sb===Ca){Cc=Me;Xb=zf;break}zf.y>=oe.y+oe.height?Ca=Me-1:sb=Me}return{Y8h:oe,WAn:dd,V6i:jd,tLo:Cc,vIj:Xb}}}Object(f.a)(qn,"PageLevelDeltaMetric",null,[1314]);class Zq{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.Fh=Q;this.top=Ca;this.BLh=sb;this.height=Xb;this.f2b=Cc;this.STd=jd;this.aln=dd}}Object(f.a)(Zq,
"Page",null,[]);class Kj{constructor(Q,Ca,sb,Xb,Cc){this.W9b=null;this.eHh=0;this.$K=Q;this.eAd=Ca;this.Iyh=sb;this.nSa=Xb;this.Kyh=Cc;this.c4a=new hb.a}get xl(){const Q=this.$K.value;wa.ULS.shipAssertTag(37007393,336,Q.jj,"PageManager.PageView is not a PageView.");return Q}get Fl(){return this.c4a}S8j(Q){Q=this.xzj(Q);this.T8j(Q)}aBp(Q,Ca){this.eHh=Ca;Q=this.xzj(Q);this.T8j(Q);this.Kyh.isEnabled&&this.Kyh.qIa(Q)}xzj(Q){this.c4a=new hb.a;this.W9b=new ln.a(0);const Ca=new hb.a;if(!Q)return this.Fl;
var sb=0,Xb=null;for(let Cc=0;Cc<Q.count;Cc++){const jd=Q.K(Cc);sb=jd.Fh;Xb=this.MYd(sb,Xb,jd);this.Fl.add(Xb);!Kj.r1e&&0>Xb.height&&Ca.add(Xb);Xb=jd}Q=this.MYd(sb+1,Xb,null);this.Fl.add(Q);!Kj.r1e&&0>Q.height&&Ca.add(Q);for(const Cc of Ca)Kj.r1e=!0,wa.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+Cc.Fh);return this.Fl}MYd(Q,Ca,sb){const Xb=Ca?Ca.cG:this.nSa.Byi(),Cc=sb?sb.cG:this.nSa.gBi();var jd=this.BDi(Xb);const dd=this.BDi(Cc),oe=Ca?this.QZh(Ca):0;jd=
oe+jd;const Me=sb?this.QZh(sb):this.eAd.Icb.clientHeight-dd;return new Zq(Q,oe,jd,Xb.id===Cc.id?Me-oe:Me+dd-jd,Xb,Cc,(sb?sb.Fh:this.eHh+1)===(Ca?Ca.Fh:0)+1)}QZh(Q){return Q.jga?0:Q.top}T8j(Q){if(this.Iyh.epe)for(const Ca of this.Iyh.epe)Ca&&Ca.U8j(Q)}BDi(Q){this.W9b||(this.W9b=new ln.a(0));if(this.W9b.mb(Q.id))return this.W9b.K(Q.id);var Ca=Q.Ce(this.xl.sc);if(!Ca)return wa.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;Ca=la.a.gWa(this.eAd.Icb,Ca.htmlElement).y;
this.W9b.W(Q.id,Ca);return Ca}}Kj.r1e=!1;Object(f.a)(Kj,"PageManager",null,[1315]);var Pm=d(1265);class pk{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe){this.jWj=oe;this.PNg=this.Jcb=!1;this.ysc=(Me,zf)=>{0!==zf.AMa||this.PNg?this.ogi():this.Gji()};this.ga=Q;this.a6=Ca;this.QKh=sb;this.uu=Xb;this.Bj=Cc;this.Nyh=jd;this.bL=dd;oe||(this.Jcb=0===this.bL.Et,this.bL.Zcc(this.ysc))}Wb(){this.ga.fb(tf.a.ljd,je.a.application,this.ljd.bind(this),96);this.ga.fb(tf.a.Bse,je.a.application,this.Bse.bind(this),96);this.ga.fb(tf.a.qDe,
je.a.application,this.qDe.bind(this),96);this.ga.fb(tf.a.nDe,je.a.application,this.nDe.bind(this),8)}qDe(Q,Ca,sb){return 1===sb?32:this.ga.Ob(tf.a.w0a,2)}nDe(Q,Ca,sb,Xb){if(1===sb)return this.jWj?8:0===this.bL.Et?32:8;this.Jcb?(this.ogi(),this.PNg=!0):(this.Gji(),this.PNg=!1);this.Bj.Fe();Xb.Ft=this.Jcb?1:0;return 32}ljd(Q,Ca,sb,Xb,Cc){if(1===sb)return 32;Q=this.Nyh.getTotalPageCount();-1===Q?Q="":this.Jcb||1===this.bL.Et||2===this.bL.Et?(Ca=this.Nyh.Npm(),Ca>Q&&(Q=Ca),Q=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,
Ca,Q)):Q=1===Q?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,Q):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,Q);Cc[Pm.a.Visible]=!0;Cc[Pm.a.LabelText]=Q;return 32}Bse(Q,Ca,sb,Xb,Cc){if(1===sb)return 32;Cc[Yf.a.On]=this.Jcb;return 32}Gji(){this.Jcb||this.jWj||(this.QKh.Q0l(),this.uu.rVj(),this.Jcb=!0)}ogi(){this.Jcb&&(this.QKh.rVl(),this.uu.UOi(),this.Jcb=!1)}}Object(f.a)(pk,"PaginationActor",null,[]);class mn{constructor(Q){this.fqg=Q}}Object(f.a)(mn,"PaginationDeltaResult",
null,[1346]);class Ll{constructor(Q,Ca){this.nHb=this.gBd=null;this.oj=Q;Ca.execute(sb=>{sb.register(this)})}get Fdd(){return"PaginationDelta"}get result(){return this.gBd}get Ccg(){return 1}get dxg(){return 200}get isEnabled(){return!0}Qcg(){this.gBd=null}qIa(Q){this.oj.ee(()=>{try{this.SUc(Q)}catch(Ca){wa.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",Ca.message)}},"PDM:C")}SFg(Q){this.nHb=Q}SUc(Q){this.gBd=null;Q=this.TUc(this.nHb,Q);-1!==
Q&&(this.gBd=new mn(Q))}TUc(Q,Ca){if(!(Q&&Ca&&Q.count&&Ca.count))return-1;const sb=new hb.a;for(const Xb of Q)sb.add(Xb.top);Q=new hb.a;for(const Xb of Ca)Q.add(Xb.top);Ca=this.t3d(sb,Q);return this.wfc(Ca)}wfc(Q){if(!Q.count)return 0;let Ca=0;for(let sb=0;sb<Q.count;sb++)Ca+=Q.K(sb);return Ca/Q.count}t3d(Q,Ca){const sb=new hb.a;if(!Q.count||!Ca.count)return sb;var Xb=Q.count<=Ca.count;const Cc=Xb?Q:Ca;Q=Xb?Ca:Q;for(Ca=0;Ca<Cc.count;Ca++){Xb=Cc.K(Ca);let dd=Math.abs(Xb-Q.K(0)),oe=0;for(let Me=1;Me<
Q.count;Me++){var jd=Q.K(Me);jd=Math.abs(Xb-jd);jd<dd&&(dd=jd,oe=Me)}sb.add(dd);Q.removeAt(oe)}return sb}}Object(f.a)(Ll,"PaginationDeltaMetric",null,[1314]);var $q=d(462),lj=d(1285),Eq=d(2110);class fq extends $q.a{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe=null){super();this.KQ=null;this.rOe=0;this.z5a=-1;this.lEb=!1;this.fV=()=>{wa.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.qgi()};this.yfg=()=>{if(0==this.AG.Et){var Me=this.KQ.lr;cc.a.xt(Me,this.d9b)||
(this.d9b=Me,this.j1n(this.y3a,this.d9b))}};this.AG=Q;this.Cga=this.Cga.bind(this);this.AG.sKb(this.Cga);this.ga=Ca;this.uu=sb;this.v1=Xb;this.cqa=Cc;this.B_e=oe||Mf.a.instance;this.d9b=this.y3a=cc.a.nil;this.WDk=dd;jd.CWR(()=>jd.result.xC.Vya(this.fV));this.Ygc();this.ll=new lj.a(1E3);this.ll.Q7a();this.cqa.register(this)}get Hma(){return"Pagination"}get Xyf(){return this.WDk.value}get TOa(){return this.z5a}m2o(Q){this.z5a!==Q&&(this.z5a=Q,this.v1.DMg())}Cga(){this.y3a=this.d9b=cc.a.nil;this.Ygc()}Vvb(Q){this.KQ=
Q;this.KQ.rKb(this.yfg);this.Gcc(this.KQ.node)}j1n(Q,Ca){cc.a.xt(Q,Ca)?(this.uu.Ncd(),this.Ygc()):(this.uu.Ocd(),this.efp())}Z0l(){this.enabled=2}Ygc(){this.enabled=0}efp(){this.rOe=0;this.Z0l();this.RA(null,null,null)}tBa(){return sj.a.YU||Zd.a.vd().xC.Mo?!1:!!(this.enabled&2)&&this.ll.S_()}RA(){this.ll.yVa();this.cqa.sY()}jD(){}dba(){return 0===this.enabled?!1:this.le&&this.le.status===Zi.a.xS?!0:this.tBa()}CNa(){if(1===this._state)this.le.Zq=Eq.a.Qea(m.AFrameworkApplication.rootQuerySignature,
this.y3a),this.le.RE="Pagination",this.le.status=Zi.a.DH,this._state=3;else if(3===this._state&&this.le&&this.le.status===Zi.a.xS)if(m.AFrameworkApplication.Xl)this._state=4;else if(this.ll.R4(),this.ll.hba(),this._state=1,this.rOe++,2!==this.le.statusCode)this.Zgc();else if(1!==(this.le.hk?this.le.hk.length:0))this.Zgc();else{var Q=this.le.hk[0];this.B_e.qPa(Q);104===Q.StatusCode?this.qgi():101===Q.StatusCode?this.Zgc():3===Q.StatusCode?this.Zgc():Q.StatusCode?this.Zgc():Q.PageEnds?(this.m2o(Q.PageEnds.length+
1),this.y3a=Vn.b(Q.LastKnownPaginationRevision),wa.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.z5a,this.y3a),this.uu.gBc(Q.PageEnds,cc.a.xt(this.y3a,this.d9b)),this.Xyf.Xma=Q.PageEnds,this.v1.dnf(),wa.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.z5a,this.y3a),
this.AVl()):this.Zgc()}}qgi(){this.KQ&&this.KQ.EZb(this.yfg);this.Ygc()}Zgc(){60<this.rOe&&this.Ygc()}AVl(){cc.a.xt(this.y3a,this.d9b)&&this.Ygc()}dispose(){this.KQ&&(this.KQ.EZb(this.yfg),this.KQ.node&&this.Fkd(this.KQ.node),this.KQ=null);this.AG.gtg(this.Cga)}Gcc(Q){Q&&(Q.addListener(this),this.lEb=!0)}Fkd(Q){this.lEb&&Q&&(Q.removeListener(this),this.lEb=!1)}TWb(Q){this.Fkd(Q)}IMa(){}qcb(Q){(Q=Q.ud.Am)&&this.dZn(this.y3a,Q.id)}dZn(Q,Ca){cc.a.xt(Q,Ca)&&this.uu.Ncd()}}Object(f.a)(fq,"PaginationReplicator",
$q.a,[1025,11,228]);class kl{get ife(){return!0}gBc(){}Ocd(){}Ncd(){}rVj(){}UOi(){}dispose(){}Qqg(){}Yjd(){}}Object(f.a)(kl,"PageEndMarkersNoOp",null,[1033,1034,11]);class as{dispose(){}Vvb(){}get TOa(){return-1}}Object(f.a)(as,"PaginationReplicatorNoOp",null,[1025,11]);class bs{constructor(){this.Pda=this.uu=this.v1=this.QOe=this.AJ=null;this.Exa=!1;this.u7k=()=>{this.VRh()}}get name(){return"WordEditor.Pagination"}uc(Q){this.Z=Q;this.Cd=this.Z.resolve(23);this.Z.ia(1603,()=>new ho(this.Z.resolve(1600),
this.Z.resolve(1601))).ha();this.Z.ia(1604,()=>new zl(new bc.a(()=>Wc.StaticActiveAppFrame.za().kb.Jc))).as("WordEditor.Pagination.IOutlineManager").ha();this.Z.ia("WordEditor.Pagination.PageManager",()=>new Kj(new bc.a(()=>Wc.StaticActiveAppFrame.za().kb.Jc),this.Z.resolve(1602),this.Z.resolve(1603),this.Z.resolve(1604),this.Z.resolve(1605))).as(1620).ha();this.Z.ia(484,()=>this.Z.resolve(114).Pra?new as:new fq(this.Z.resolve(76),m.AFrameworkApplication.va,this.Z.resolve(1599),this.Z.resolve(1601),
Ik.a.U0,Zd.a.Rsa(),new bc.a(()=>this.Z.resolve(488)))).ha();this.Z.ia(486,()=>new Ko(this.Z.resolve(1601))).ha();this.Z.ia("WordEditor.Pagination.PageLevelDeltaMetric",()=>new qn(new bc.a(()=>Wc.StaticActiveAppFrame.za().kb.Jc),this.Z.resolve(18),Cd.a.instance,this.Z.Ra(1606))).ha();this.Z.ia(1605,()=>new vt(this.Z.resolve(1607),Cd.a.instance,this.Z.Ra(1606))).ha();this.Z.ia(1621,()=>new Ll(Cd.a.instance,this.Z.Ra(1606))).ha();this.Z.ia(1609,()=>new St(this.Z.resolve(1607))).ha();this.Z.ia(1607,()=>
new No(new bc.a(()=>Wc.StaticActiveAppFrame.za().kb.Jc),this.Z.resolve(6),this.Z.resolve(1608))).ha();this.Z.ia(1610,()=>new Zr(this.Z.resolve(1609),this.Z.resolve(1607))).ha();this.Z.ia(1613,()=>new sp(this.Z.resolve(1607),this.Z.resolve(1610))).ha();this.Z.ia(1614,()=>new $r(this.Z.resolve(1611),this.Z.rf(1612),this.Z.resolve(1610),this.Z.resolve(1613),this.Z.resolve(1607))).ha();this.Z.ia(1615,()=>this.Z.resolve(1614).create()).ha();this.Z.ia(1612,()=>new ro(new bc.a(()=>Wc.StaticActiveAppFrame.za().kb.Jc),
this.Z.resolve(6),this.Z.resolve(1604),this.Z.resolve(1608),this.Z.resolve(1615),this.Z.resolve(1611),sj.a.ff.Pl)).as(1618).ha();this.Z.ia(1616,()=>new oq(this.Z.resolve(1613),this.Z.resolve(1609),nr.WordSectionNavigator.instance,this.Z.resolve(1607))).ha();this.Z.ia(1611,()=>this.Z.resolve(1616).create()).ha();this.Z.ia("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new kn(this.Z.resolve(6),Cd.a.instance)).as(1619).ha();this.Z.ia(1625,()=>new pk(m.AFrameworkApplication.va,this.Z.resolve(586),
this.Z.resolve(486),this.Z.resolve(1599),m.AFrameworkApplication.ta,this.Z.resolve(487),this.Z.resolve(76),this.Z.resolve(114).Pra)).ha();this.Z.ia(1602,()=>new rs(new bc.a(()=>Wc.StaticActiveAppFrame.za().kb.Jc),Yq.a.get_instance(),this.Z.resolve(76))).ha();this.Z.ia(1601,()=>new Lk(m.AFrameworkApplication.va,sg.a.instance,Ph.a.instance,this.Z.resolve(1602),new bc.a(()=>Wc.StaticActiveAppFrame.za().kb.Jc),this.Z.Oa(17),this.Z.resolve(586))).as(1622).ha();this.Z.ia(1599,()=>{this.Z.resolve(114).Pra?
this.uu=new kl:this.uu=new Vk(new bc.a(()=>Wc.StaticActiveAppFrame.za().kb.Jc),new bc.a(()=>Wc.StaticActiveAppFrame.za().kb.ed.ud),this.Z.resolve(1617),this.Z.resolve(1618),this.Z.resolve(1619),this.Z.resolve(1620),this.Z.resolve(1602),this.Z.resolve(1608),zi.a.k4c,this.Z.resolve(442),Ph.a.instance,Vk.Fvm,this.Z.resolve(230),new xk.a,this.Z.resolve(983),this.Z.resolve(1611),null,this.Z.resolve(1621),this.Z.resolve(1622),this.Z.resolve(76));return this.uu}).as(651).ha();this.Z.ia(1608,()=>new im(this.Z.Ra(6),
this.Z.resolve(319))).ha();this.Z.ia("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new bk(m.AFrameworkApplication.oc)).as(1623).ha();this.Z.ia("WordEditor.Pagination.PageAdornmentContentManager",()=>new hm(this.Z.resolve(468))).as(1624).ha();this.Z.ia(1600,()=>this.Pda=new Ii(new bc.a(()=>Wc.StaticActiveAppFrame.za().kb.Jc),zh.a.instance,Wj.a.instance,wc.a.instance,m.AFrameworkApplication.va,wn.a.instance,this.Z.resolve(1623),this.Z.resolve(1624),this.Z.resolve(983),Ph.a.instance,m.AFrameworkApplication.J,
!!sj.a.instance&&sj.a.instance.Bta)).as(1617).ha()}init(){this.Cd.Qr.continueWith(()=>{this.No()})}No(){const Q=Wc.StaticActiveAppFrame.za().kb;Q.QBa?this.VRh():Q.Sja(this.u7k)}VRh(){this.Exa||(this.Exa=!0,this.QOe=Na.a.instance.resolve(486),this.v1=Na.a.instance.resolve(1622),this.AJ=Na.a.instance.resolve(484),Na.a.instance.resolve(1625).Wb())}dispose(){this.Pda&&(this.Pda.dispose(),this.Pda=null);this.uu&&(this.uu.dispose(),this.uu=null);this.AJ&&(this.AJ.dispose(),this.AJ=null);this.v1&&(this.v1.disable(),
this.v1=null);this.QOe&&(this.QOe=null)}}Object(f.a)(bs,"PackageManager",null,[0,1]);class ss{constructor(){this.Z=null}uc(Q){this.Z=Q||Na.a.instance}dispose(){}}Object(f.a)(ss,"TellMePackage",null,[0,1]);var Qm=d(1389),or=d(1393),Qi=d(346),Hm=d(1388),io=d(1271);class gl{constructor(Q=null,Ca=null,sb=null,Xb,Cc=null){this.$Je=null;this.I8g=!1;this.aih=this.E4b=null;this.zOk=this.YEh=this.Eok=this.bih=!1;this.Myd=null;this.Vok=null==Ca?m.AFrameworkApplication.NKb:Ca;this.EAk=null==sb?m.AFrameworkApplication.m3:
sb;this.ePk=null==Cc?m.AFrameworkApplication.Reb:Cc;this.gzk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeHelpOnHelpIsEnabled");this.QQk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeCommandHookIsEnabled");this.k2o(!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeIgnoreQueryForHelp"));this.HQk=!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb.lad;this.IQk=!Hm.a.tta()&&!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMePeopleSuggestionIsEnabled");
this.GQk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeFileSuggestionIsEnabled");this.jwk=!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb.J0b;this.JQk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.fOk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("HelpShowsTopSearchResult");this.nIk=this.fpd||this.epd;this.lIk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("OnlineCommandSuggestionsIsEnabled");
this.mIk=this.A_f;this.WCk=!!m.AFrameworkApplication.J&&this.p0a&&m.AFrameworkApplication.J.$("StyledHeaderInLabelIsEnabled");this.Fxk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.kyk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.txk=m.AFrameworkApplication.J?parseFloat(m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.SCk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.$("SmartLookupNoteSearchIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.xCk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.sDk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",
!1);this.aBk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.dxn||this.uqn);this.Gac=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.NPk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):
"https://substrate.office.com/search/api/v1/suggestions";this.nyk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.gOk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.SOk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.vOk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("ShowFindInDocumentInZeroTermSearchBox")||this.AS;this.gDk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.$("TellMeTemplateProviderIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.tCk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);
this.LCk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===m.AFrameworkApplication.uiCulture;this.dDk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.$("TellMeFeedbackProviderIsEnabled")||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.uDk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.Hok=this.p0a&&
!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.Nyk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.YOk=!!m.AFrameworkApplication.J&&(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==m.AFrameworkApplication.J.jb("Application"));
this.dqk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.ISk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMePerformanceMarkerEnabled");this.cBk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.gBk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.jyk=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.fDk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeNotesSuggestionIsEnabled")||this.lvn;this.eBk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.fBk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.dBk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.lvk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.mvk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.kvk=!!m.AFrameworkApplication.J&&
m.AFrameworkApplication.p8h&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.KQk=this.r3i&&(this.fig||this.gig||this.bgd||this.p0a&&Hm.a.Hta()&&!!m.AFrameworkApplication.J&&(this.Xxc||this.O0b||this.P0b||this.Q0b||this.R0b||m.AFrameworkApplication.J.$("ShowAnswerSearchResults")||m.AFrameworkApplication.J.$("ShowDefinitionSearchResults")||m.AFrameworkApplication.J.$("ShowEntitySearchResults")||m.AFrameworkApplication.J.$("ShowWolframSearchResults")));
this.Fnk=!!m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.$("AppsForOfficeThirdPartyIsDisabled")&&m.AFrameworkApplication.J.$("AppsForOfficeAllowExternalMarketplace")&&m.AFrameworkApplication.n6a;this.Gnk=!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("AppsForOfficePrivateCatalogIsEnabled");this.d9m(Q||{});this.Q7e="2918242107";this.P7e="1454393937";this.WGb={};this.Nlb=[];this.cCl=[Hm.a.fEe]}get application(){return this.E4b}get NKb(){return this.Vok}get jPo(){return this.Q7e}get iPo(){return this.P7e}get DDf(){return this.aih}get woi(){return this.bih}get m3(){return this.EAk}get Reb(){return this.ePk}get JKb(){return this.Eok}get o1m(){return this.gzk}get glp(){return this.QQk}get r3i(){return!0}get Wkp(){return this.KQk}get p5o(){return this.YEh}k2o(Q){this.YEh=
Q}get p0a(){return this.HQk}get prd(){return this.IQk}get nrd(){return this.GQk}get Y7l(){return this.jwk}get Ukp(){return this.JQk}get ODe(){return!1}get bgd(){return this.nIk}get fig(){return this.lIk}get gig(){return this.mIk}get cbb(){return!1}get kge(){return!1}get q1f(){return this.WCk}get tze(){return this.zOk}get Xxc(){return!1}get W6o(){return!1}get SAn(){return""}get MLf(){return 2}get HIm(){return 4}get IIm(){return 5}get WGi(){return""}get Wsm(){return this.Fxk}get mHi(){return this.kyk}get YGi(){return 1E3}get XGi(){return 1E-6}get thp(){return this.NPk}get qGg(){return!1}get IZj(){return!1}get Osn(){return this.LCk}get Qfe(){return!1}get Rfe(){return!1}get A_i(){return!1}get z_i(){return!1}get lvn(){return!1}get s3i(){return!1}get g3d(){return!1}get Ryb(){return!1}get O0b(){return!1}get P0b(){return!1}get Q0b(){return!1}get R0b(){return!1}get fpd(){return this.fOk}get Txc(){return this.gOk}get epd(){return!1}get HIf(){return null}get Jfe(){return!1}get lze(){return this.vOk}get bDi(){return 0}get Jmm(){return this.txk}get THi(){return this.nyk}get bun(){return this.SCk}get sXf(){return this.aBk}get kze(){return this.Gac}get XBm(){return-3.9}get AS(){return this.SOk}get mad(){return this.gDk}get O_f(){return this.tCk}get K1f(){return this.dDk}get Mmb(){return this.Hok}get nxn(){return this.uDk}get qBa(){return this.Nyk}get yWj(){return this.YOk}get Ufl(){return this.dqk}get MFe(){return this.ISk}get Xce(){return this.cBk}get Zfn(){return this.gBk}get nw(){return this.jyk}get bub(){return this.fDk}get Xfn(){return this.eBk}get Yfn(){return this.fBk}get Wfn(){return this.dBk}get Z3k(){return this.Fnk}get $3k(){return this.Gnk}get Ska(){return this.lvk}get Z0d(){return this.mvk}get Rhc(){return this.kvk}get dxn(){return this.sDk}get uqn(){return this.xCk}get WTb(){return!!m.AFrameworkApplication.ta&&
m.AFrameworkApplication.ta.Hb.Cs}get Cs(){return!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb.Cs}get kpn(){return!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb.Vxc}get pTn(){return ef.getImageClass("OfficeAssistant_32x32x32")}w6d(){return Promise.reject("GetFindMatchCount method is not overridden")}Ege(Q){return Array.contains(appChrome.selectors.getVisibleControlIds(),Q)}Bde(){return!1}get Tee(){return!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeModelRankerEnabled")}get A0j(){return m.AFrameworkApplication.J?
m.AFrameworkApplication.J.jb("TellMeServiceHelpClassifierModelName"):""}get A_f(){return!!m.AFrameworkApplication.J&&m.AFrameworkApplication.J.$("TellMeMultiLingualCommandModelEnabled")}get HRb(){return"NoOpHeaderUi"}get WBl(){return this.Myd}get parameterData(){return this.WGb}get Psp(){return this.Nlb}y3l(){if(this.$Je&&!this.I8g&&(this.I8g=!0,this.Jyb(this.$Je),this.Cs)){var Q=Na.a.instance.resolve(665);Q=(new io.a(Q)).L4d(this.$Je.iJ);appChrome.api.dispatch(Q)}}Jyb(){}eUl(Q){const Ca=[];for(let sb=
0;sb<Q.length;++sb)Q[sb].V7o?Ca.push(new Qi.a(Q[sb].Jn,Hm.a.P4j+sb.toString())):Ca.push(new Qi.a(Q[sb].standard,Hm.a.fEe+sb.toString()));return Ca}d9m(Q){const Ca={};for(const sb in Q){const Xb=sb,Cc=Q[sb];for(const jd in Cc){const dd=jd,oe=Cc[jd];(Ca[dd]||(Ca[dd]={}))[Xb]=oe}}this.Myd=Ca}get B0j(){return""}get nVj(){return!1}}Object(f.a)(gl,"TellMeApplicationData",null,[2002]);class rn{constructor(Q,Ca=null,sb=!1){this.standard=Q;this.Jn=Ca;this.V7o=sb}}Object(f.a)(rn,"TryQuerySet",null,[]);class Yo{constructor(){this.ovh=
this.pvh=null}get kQn(){return this.ovh}Bka(Q){this.pvh=Q;return this.Utf(Q)}EUn(){this.ovh=this.pvh}m7d(Q){return 8===Q.type?String.format(CommonUIStrings.l_FindInDocumentText,Q.NE):Q.NE}gIf(Q){return Q.NE}}Object(f.a)(Yo,"ParameterizedCommand",null,[]);class lp extends Yo{constructor(Q){super();this.Y$c=Q}get commandId(){return this.Y$c?"DefinitionsParameterized":"DefinitionButton"}get Rjg(){return"Definition"}Utf(Q){const Ca=ab.a.If(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
Q.NE));return ve.a(Hm.a.Luf(Q.value),x.a.mwf.toString(),Ca,Hm.a.AWf,null,ab.a.If(Hm.a.YMb(Q.NE)),Ca,null,null)}m7d(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.NE)}gIf(Q){return Hm.a.YMb(Q.NE)}}Object(f.a)(lp,"DefinitionsParameterizedCommand",Yo,[]);class cp extends Yo{constructor(Q){super();this.Y$c=Q}get commandId(){return this.Y$c?m.AFrameworkApplication.ta.Hb.rln?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get Rjg(){return"Find"}Utf(Q){const Ca=
ab.a.If(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,Q.NE));return ve.a(Hm.a.Luf(Q.value),x.a.Kic.toString(),Ca,"Find_16x16x32",null,ab.a.If(Q.NE),Ca,null,null)}m7d(Q){return String.format(CommonUIStrings.l_TextWithQuotation,Q.NE)}}Object(f.a)(cp,"FindParameterizedCommand",Yo,[]);class wt extends Yo{constructor(Q){super();this.Y$c=Q}get commandId(){return this.Y$c?"SynonymsParameterized":"SynonymButton"}get Rjg(){return"Synonym"}Utf(Q){const Ca=ab.a.If(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
Q.NE));return ve.a(Hm.a.Luf(Q.value),x.a.mwf.toString(),Ca,Hm.a.AWf,null,ab.a.If(Hm.a.YMb(Q.NE)),Ca,null,null)}m7d(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.NE)}gIf(Q){return Hm.a.YMb(Q.NE)}}Object(f.a)(wt,"SynonymsParameterizedCommand",Yo,[]);var tp=d(2128),Lr=d(2156),cs=d(2163),Ia=d(2114),Ab=d(2115),hc=d(1525);class Kc extends tp.a{constructor(){super(...arguments);this.uT=null;this.t5a=Lr.a.createInstance(this,cs.a.instance,hc.a.instance,!0,
!0)}static get instance(){return Kc._instance}Iic(){this.uT(this.t5a.Ek.doa);this.t5a.M6a(!0)}w6d(Q){const Ca=new Promise((sb,Xb)=>{this.uT=sb;setTimeout(()=>{Xb("Find manager execution timed out");this.t5a.M6a(!0)},500)});Q=Ia.a.createQuery(Q,Ab.a.none);this.t5a.find(Q);return Ca}}Kc._instance=new Kc;Object(f.a)(Kc,"TellMeFindStatusSpy",tp.a,[]);class wd extends gl{constructor(Q){super({});this.E4b="Word";this.Sxk=Q;m.AFrameworkApplication.J.$("TellMeFindInDocumentIsEnabled")&&(this.bih=!0,this.aih=
this.g3d?"FindWithMatchesParameterized":"FindParameterized");Q=new lp(this.WTb);const Ca=new wt(this.WTb);this.parameterData[Q.commandId]=Q;this.parameterData[Ca.commandId]=Ca;Q=new cp(this.WTb);this.parameterData[Q.commandId]=Q;m.AFrameworkApplication.J.$("TellMeTryQueriesIsEnabled")&&(Q=[new rn(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new rn(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new rn(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new rn(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new rn(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.Nlb=this.eUl(Q))}w6d(Q){return Kc.instance.w6d(Q)}get Odb(){return Di.a.kva}get HRb(){return Di.a.BWa}Jyb(Q){var Ca=m.AFrameworkApplication.J;Q=Q.iJ;Q.WordCountFlyout=!this.Sxk();Q.SelectAllButton=!Ca.$("TellMeSelectAllResultIsEnabled");const sb=Ca.$("TellMeDesktopUpSellIsEnabled");let Xb=m.AFrameworkApplication.lge;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Xb));Xb=!1;Q.TextBoxUpSellButton=
!sb||Xb;Q.TableOfContentsUpSellButton=!sb||Xb;Q.SmartArtUpSellButton=!sb||Xb;Q.WordArtUpSellButton=!sb||Xb;Q.MultiColumnLayoutUpSellButton=!sb||Xb;Q.InsertEquationUpSellButton=!sb||Xb;Q.TrackChangesUpSellButton=!sb||Xb;Q.ShapesUpSellButton=!sb||Xb;Q.LabelsUpSellButton=!sb||Xb;Q.InsertCitationUpSellButton=!sb||Xb;Q.TextBoxUpSellButtonEnterprise=!sb||!Xb;Q.TableOfContentsUpSellButtonEnterprise=!sb||!Xb;Q.SmartArtUpSellButtonEnterprise=!sb||!Xb;Q.WordArtUpSellButtonEnterprise=!sb||!Xb;Q.MultiColumnLayoutUpSellButtonEnterprise=
!sb||!Xb;Q.InsertEquationUpSellButtonEnterprise=!sb||!Xb;Q.TrackChangesUpSellButtonEnterprise=!sb||!Xb;Q.ShapesUpSellButtonEnterprise=!sb||!Xb;Q.LabelsUpSellButtonEnterprise=!sb||!Xb;Q.InsertCitationUpSellButtonEnterprise=!sb||!Xb;Ca=!Ca.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!m.AFrameworkApplication.m3;Q.SynonymButton=Ca;Q.DefinitionButton=Ca}get B0j(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get qGg(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",
!1)}get A0j(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Xxc(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get A_f(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get MLf(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get nVj(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",
!1)}get kge(){return m.AFrameworkApplication.J.$("TellMeRankerLoggingIsEnabled")&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get Tee(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get Qfe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get Rfe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",
!1)}get YGi(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get XGi(){return 1E-6*m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",1)}get A_i(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get z_i(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",
!1)}get WGi(){return m.AFrameworkApplication.J.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get s3i(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get bDi(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get r3i(){return m.AFrameworkApplication.J.$("TellMeServiceForSearchIsEnabled")}get ODe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",
!1)}get cbb(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get tze(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get IZj(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get Jfe(){return m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",
!1)}get O0b(){return m.AFrameworkApplication.J.$("ShowAnswerSearchResults")}get P0b(){return m.AFrameworkApplication.J.$("ShowDefinitionSearchResults")}get Q0b(){return m.AFrameworkApplication.J.$("ShowEntitySearchResults")}get R0b(){return m.AFrameworkApplication.J.$("ShowWolframSearchResults")}get HIf(){return m.AFrameworkApplication.J.$("ModernFontPickerIsEnabled")?{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(f.a)(wd,"WordEditorTellMeApplicationData",gl,[]);var ye=d(1456),gf;
(function(Q){Q[Q.none=0]="none";Q[Q.KOg=1]="waitAll";Q[Q.Ppq=2]="synchronizeFast";Q[Q.Hip=3]="synchronizeSlow"})(gf||(gf={}));Object(f.b)("ProviderSynchronizationType",gf);var Ce;(function(Q){Q[Q.immediate=0]="immediate";Q[Q.KOg=1]="waitAll";Q[Q.Npq=2]="synchronizeAndWaitAll";Q[Q.Opq=3]="synchronizeAndWaitForRanker"})(Ce||(Ce={}));Object(f.b)("MenuUpdatePolicy",Ce);var Zf=d(1397),Kg=d(1395),T=d(1602),ia=d(1398),nb=d(1446),Tb=d(120),na=d(297);class Da extends tp.a{constructor(Q){super();this.FTk=Q}Iic(){this.FTk.update()}}
Object(f.a)(Da,"TellMeFindStatusManager",tp.a,[]);class Ya{constructor(Q){this.Jlb=this.dah=null;this.ki=0;this.ZDd="TellMeWAC.";const Ca=Q.DDf;this.jc=Q;this.qBd=Ca;this.s_e=Object.assign(new ye.a,{landingTab:"Indoc",data:null});Q=new Da(this);this.t5a=Lr.a.createInstance(Q,cs.a.instance,hc.a.instance,!0,!0)}zN(){return"WordFindInDocument"}rX(){return this.jc.MLf?this.jc.MLf===Ce.KOg?gf.KOg:gf.Hip:gf.none}gK(Q,Ca){this.wwn(Q)?(this.Jlb=Q,this.dah=Ca,Q=Ia.a.createQuery(Q.Wg,Ab.a.none),this.ki=window.performance.now(),
this.t5a.find(Q)):Ca.Qt(new Zf.a(Q))}update(){this.hSo(Math.round(window.performance.now()-this.ki));var Q=String.format(CommonUIStrings.l_TextWithQuotation,this.Jlb.Wg);var Ca=m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Hb.Ryb?Hm.a.HUa(this.Jlb.Wg,15,this.s_e):ab.a.If(this.Jlb.Wg);const sb=[];sb.push(appChrome.actions.setControlLabel(this.qBd,Q));sb.push(appChrome.actions.setCompoundButtonCommandValueId(this.qBd,Ca));sb.push(appChrome.actions.updateCompoundButtonDescription(this.qBd,this.vPf()));
appChrome.api.dispatch(sb);Q=new Kg.a(this.qBd,T.a.MHe,this.Jlb.Wg,this.t5a.Ek.doa.toString());Ca=new ia.a(nb.a.MHe);Ca.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;Ca.jy(Q);const Xb=new Zf.a(this.Jlb);Xb.kw(Ca);window.requestAnimationFrame(()=>{this.dah.Qt(Xb)});this.t5a.M6a(!0);this.iSo(Math.round(window.performance.now()-this.ki))}vPf(){const Q=this.t5a.Ek.doa.toString();return"1"===Q?String.format(CommonUIStrings.l_SearchResultText,Q):String.format(CommonUIStrings.l_SearchResultsText,
Q)}wwn(Q){return!!Q&&!!Q.Wg&&""!==Q.Wg.trim()}hSo(Q){const Ca={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.Jlb.Wg.length};this.sendActivityEvent(Ca,Q)}iSo(Q){const Ca={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.Jlb.Wg.length};this.sendActivityEvent(Ca,Q)}sendActivityEvent(Q,Ca){Q=
Tb.a.qI(Q);Cg.a.XNa(Object.assign(new na.a,{name:"Latency",dataFields:Q,durationMs:Ca}),this.ZDd)}}Object(f.a)(Ya,"WordFindInDocumentWithMatchesProvider",null,[1024]);class Pb{constructor(Q,Ca){this.Qb=Q;this.rce=Ca}U$a(Q,Ca,sb){return this.rce.U$a(0,Q,Ca,sb)}insertHtmlText(Q){return Q?32===this.YVf(Q):!1}YVf(Q){return this.executeCommand(Ed.a.Vqa,Q)}executeCommand(Q,Ca){const sb=new yb.DictionaryPropertySet;sb.setValue(Yb.a.hY,Ca);sb.setValue(Yb.a.$Da,!1);Ca=this.Qb.Ob(Q,1);32===Ca&&(Ca=this.Qb.Pb(Q,
2,sb));return Ca}}Object(f.a)(Pb,"WordInsertContentHandler",null,[1023]);class pc extends ss{constructor(){super();this.nz=()=>{if(m.AFrameworkApplication.bIg){var Q=Wc.StaticActiveAppFrame.za().Hb.gOf(x.a.su);Q.g9c?this.Utj():Q.n2(this.LOo);var Ca=new wd(()=>!1);Qm.TellMeActor.instance.initialize(Ca,null,null,null,null,null,Object(O.a)(Wc.StaticActiveAppFrame.za(),Wc.StaticActiveAppFrame.za().t4d,"forceUpdateRibbonControls"),m.AFrameworkApplication.J,this.Z.Ra(4),this.Z.Ra(5),this.Z.Ra(2));Qm.TellMeActor.instance.Luo(Q);
Qm.TellMeActor.instance.Wwo(new Pb(m.AFrameworkApplication.va,this.Z.Oa(702)));Ca.woi&&Ca.g3d&&Qm.TellMeActor.instance.UG(new Ya(Ca),or.a.su)}};this.LOo=()=>{this.Utj()}}get name(){return"WordEditor.TellMe"}init(){m.AFrameworkApplication.J.xp(this.nz)}Utj(){Wc.StaticActiveAppFrame.za().Fe()}}Object(f.a)(pc,"WordEditorTellMePackage",ss,[]);class Pc{constructor(){this.Z=null;this.D0j=(Q,Ca,sb)=>{2===sb&&(Q=new Hg.StandardDialog,Q.Ed=0,Q.Nna(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,
null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.Z.resolve(23).Qr.continueWith(()=>{this.No()})}dispose(){}No(){if(this.Z.resolve(23).isFeatureEnabled(118)){m.AFrameworkApplication.va.fb(tf.a.$ck,je.a.view,this.D0j,96);var Q=Of.FocusManager.instance().ie(Di.a.GF);hf.AFrame.gj(Q,ed.KeyInputManager.lc(Dj.a.Cgb,5|ed.KeyInputManager.mi),tf.a.$ck)}}uc(Q){this.Z=Q}static main(){K.a.instance.Mc(new Pc)}}Object(f.a)(Pc,"WordEditorTestFeaturePackage",null,[0,1]);var hd=d(1358),Hd=d(111);
class Sd{constructor(Q,Ca){this.$Ij=Q;this.Qb=Ca;this.Mwe=(sb,Xb,Cc,jd,dd)=>{if(1===Cc)return 32;this.$Ij.tC(9,dd,!1);return 32};this.nS=(sb,Xb)=>{if(9===Xb.type){var Cc;(sb=Xb.pA)?("string"===typeof sb?Cc=sb:"data"===sb.type&&(Cc=Hd.a.Zai(sb.Lho,sb.newState,sb.o2o)),Cc&&Sd.MSc(Cc)):wa.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.bkd()}bkd(){this.Qb.qa(tf.a.Mwe,z.a.frame,this.Mwe);this.$Ij.TO(this.nS)}dispose(){}static MSc(Q){Q=Wc.StaticActiveAppFrame.za().lK.zka(Q,
!1);Q.image=5;Q.Ola="CoAuth_AuthorStatus_16x16x32";Wc.StaticActiveAppFrame.za().lK.Pz(Q)}}Object(f.a)(Sd,"TrackChangeNotificationActor",null,[]);class Ae{constructor(){this.Zh=this.sbf=this.Z=null;this.Qfd=()=>{if(this.Zh=hd.a.k5c().result)this.Z.ia(1626,()=>new Sd(this.Zh,m.AFrameworkApplication.va)).ha(),this.sbf=this.Z.resolve(1626)}}get name(){return"WordEditor.TrackChangeNotificationActor"}uc(Q){this.Z=Q}init(){this.Z.resolve(23).Qr.continueWith(()=>{this.No()})}No(){hd.a.k5c().continueWith(this.Qfd)}dispose(){this.sbf&&
this.sbf.dispose()}}Object(f.a)(Ae,"WordEditorTrackChangeNotificationActorPackageManager",null,[0,1]);var og=d(102),qf=d(1366),Be=d(2105);class kf{}kf.xLg="UnsavedChanges";kf.yLg="UnsavedChangesThemed";kf.ONo="SavedChanges";kf.$5j="UnsavedChangesOpenPipe";kf.Svp="UnsavedChangesOpenPipeCssClassNameThemed";kf.Z5j="UnsavedChangesClosePipe";kf.Pvp="UnsavedChangesClosePipeThemed";kf.Qvp="UnsavedChanges";kf.Rvp="UnsavedChangesThemed";kf.zLg="UnsavedChangesIndicatorPositionRef";Object(f.a)(kf,"UnsavedChangesHighlightUtils",
null,[]);class Nh extends qf.a{constructor(Q,Ca){super();this.Tia=Q;this.Ny=Ca;this.I5=[this.Ny?new Be.a(kf.yLg,kf.Rvp):new Be.a(kf.xLg,kf.Qvp)]}get Mfa(){return!0}get csb(){return 4}get z$a(){return this.I5}RMa(Q,Ca){if(this.Tia){var sb=this.Tia.J9f;if(sb&&sb.count&&sb.contains(Q.id))for(Q=Ca.pNa("span"),Ca=0;Ca<Q.length;Ca++)sb=Q[Ca],Ca||sb.classList.add(this.Ny?kf.Svp:kf.$5j),Ca===Q.length-1&&sb.classList.add(this.Ny?kf.Pvp:kf.Z5j),sb.classList.add(this.Ny?kf.yLg:kf.xLg)}}S9a(){}}Object(f.a)(Nh,
"UnsavedChangesHighlightActor",qf.a,[]);var yh=d(1032);class of{constructor(Q){this.SOe=null;this.Tia=Q;this.wXe=!1}get key(){return"UnsavedChangesHighlight"}get Jv(){return"UnsavedChanges"}reset(Q){if(this.Tia){Q=Q.node;if(Ji.ParagraphReader.Vb(Q)){const Ca=this.Tia.J9f;if(Ca&&Ca.contains(Q.id)){this.wXe=!0;this.SOe=Q.id;return}}this.wXe=!1;this.SOe=cc.a.nil}}MEa(){let Q=null;return this.wXe?(Q=Object.assign(new yh.a,{fG:this.key,contentObject:this.SOe,description:null}),{returnValue:!0,OG:Q}):{returnValue:!1,
OG:Q}}}Object(f.a)(of,"UnsavedChangesHighlightCpContentDetailsProvider",null,[144,136]);class Ne{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.mvh=null;this.G9=Q;this.lf=Ca;this.JZ=sb;this.g$=Xb;this.wIh=Cc;this.gqa=jd;this.Ny=dd;this.lf.Vya(this.fV.bind(this))}get J9f(){return this.mvh}g2m(){if(this.G9){if(1===this.G9.fqf){if(0===this.G9.r3f&&this.G9.Hpj()){this.mvh=this.G9.fke;const Q=this.G9.Tsd;this.G9.PNo.forEach(this.gVl.bind(this));Q.forEach(this.h2m.bind(this));0<Q.length&&this.TWl(this.JZ);return 0}return this.Cqo(this.G9.r3f)}return 2}return 1}Cqo(Q){switch(Q){case 0:return this.G9.eOi()?
5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}$Oi(Q,Ca,sb){if(Ca)if(sb){sb=Ca.querySelectorAll("span");for(let Xb=0;Xb<sb.length;Xb++){const Cc=sb[Xb];Xb||Cc.classList.add(kf.$5j);Xb===sb.length-1&&Cc.classList.add(kf.Z5j);Cc.classList.add(this.Ny?kf.yLg:kf.xLg)}Ca.classList.add(kf.zLg);Q&&this.g$.eBc(Q)}else Ca.classList.add(kf.ONo)}kmc(Q,Ca){const sb=this.dQm(Q);if(Q&&(Q=Q.Ce(Wc.StaticActiveAppFrame.za().kb.Jc.sc)))if(Q.og&&Q.og.Dj&&0!==Q.og.Dj.count)for(const Xb of Q.og.Dj)this.$Oi(sb,
Xb,Ca);else this.$Oi(sb,Q.htmlElement,Ca)}dQm(Q){return this.wIh&&(Q=this.wIh.dRb(Q))&&Q&&(Q=Q.Ce(Wc.StaticActiveAppFrame.za().kb.Jc.sc))?Q:null}h2m(Q){this.kmc(Q,!0);return!0}gVl(Q){this.kmc(Q,!1);return!0}TWl(Q){Q&&Q.continueWith(()=>{Q.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}fV(Q,Ca){Ca===Sys.EventArgs.Empty?wa.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):Ca&&Ca.errorCode?this.gqa.PU||
(Q=this.g2m(),wa.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",Q),va.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==Q&&4!==Q&&this.qpp(Q)):wa.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",Ca?"Error Code":"Kickout Event Args")}qpp(Q){let Ca;const sb=new fm.a;sb.extendedProperties=new Map;sb.extendedProperties.set("HighlightUnsavedChangesResult",Q.toString());sb.extendedProperties.set("UnsavedChangesCollectionResult",
"-1");switch(Q){case 1:case 2:case 6:Ca="HighlightInternalError";break;case 5:Ca="ChangeOutsideCanvas"}6!==Q&&5!==Q||sb.extendedProperties.set("UnsavedChangesCollectionResult",this.G9.r3f.toString());Ca&&(va.Health.instance.recordQosError(Ca,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,sb),va.Health.instance.recordKpiFailure("UnsavedChangesHighlight",Ca,!0,!0,sb))}dispose(){this.lf.FZb(this.fV.bind(this))}}Object(f.a)(Ne,"UnsavedChangesHighlighter",null,[11]);var yf=d(859),Bg=d(702),Dg=d(1364);class ll extends Dg.a{constructor(Q,
Ca){super();this.Tia=Q;this.Ny=Ca}Q_a(Q){if(!this.Tia)return!1;const Ca=this.Tia.J9f;return Ca?Ca.contains(Q.Cb.id)||Q.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}Skl(Q,Ca){Ca=Q.jLa?Q.jLa[Ca]?Q.jLa[Ca].style?Q.jLa[Ca].style.marginLeft:null:null:null;var sb=Q.Cba;Q=1440<=sb?-(sb/1440*96):Q.J6a(0,96,this.zoom);sb=0;Ca&&(Ca=Ca.match(/^(\d+)px/))&&Ca[1]&&(sb=Number(Ca[1]));return Q-sb}Bll(Q,Ca,sb){return Sys.UI.DomElement.getBounds(Q).y-sb.B7[Ca].y}Ikl(Q){return Sys.UI.DomElement.getBounds(Q).height}pai(Q,
Ca,sb,Xb){let Cc;Cc=this.Skl(sb,Ca);Ca=this.Bll(Q,Ca,sb);Q=this.Ikl(Q);Xb=yf.a.createElement(Xb,Bg.a.div);Xb.className=this.Ny?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Xb.style.left=Cc+"px";Xb.style.top=Ca+"px";Xb.style.height=Q+"px";return Xb}F$h(Q,Ca,sb,Xb){const Cc=[],jd=Q.querySelectorAll("."+kf.zLg);if(0===jd.length&&Q.classList.contains(kf.zLg))sb=this.pai(Q,Ca,sb,Xb),sb.rka=Ca,Cc.push(sb);else for(Q=0;Q<jd.length;Q++){const dd=this.pai(jd[Q],Ca,sb,Xb);dd.rka=Ca;Cc.push(dd)}return Cc}DUa(Q){let Ca=
[];var sb=Q.V3;const Xb=sb.Jh.ownerDocument;if(sb.Mj){let Cc=0;for(const jd of sb.og.Dj)(sb=this.F$h(jd,Cc,Q,Xb))&&(Ca=Ca.concat(sb)),Cc+=1}else Ca=this.F$h(sb.htmlElement,0,Q,Xb);return Ca}}Object(f.a)(ll,"UnsavedChangesIndicatorActor",Dg.a,[]);class hj{constructor(){this.mZ=this.Zx=this.hRa=this.g$=this.JDd=this.Tia=null}get name(){return"WordEditor.UnsavedChangesHighlight"}uc(){}init(){this.g$=Na.a.instance.resolve(363).instance;this.Tia=new Ne(Na.a.instance.resolve(490),Ke.SessionStatusManager.instance,
wl.a.iq(Na.a.instance.Ra(618)),this.g$,Na.a.instance.resolve(597),Na.a.instance.resolve(438),!!sj.a.instance&&sj.a.instance.Bta);this.hRa=Na.a.instance.Ra(325);this.mZ=Na.a.instance.resolve(369).instance;this.JDd=new ll(this.Tia,!!sj.a.instance&&sj.a.instance.Bta);this.g$.yNa(this.JDd);this.hRa&&this.hRa.execute(Q=>{Q.nY(new of(this.Tia))});this.Zx=new Nh(this.Tia,!!sj.a.instance&&sj.a.instance.Bta);this.mZ.vdb(this.Zx)}dispose(){this.g$&&this.JDd&&this.g$.JEe(this.JDd);this.mZ&&this.Zx&&this.mZ.oLg(this.Zx);
og.a.LD(this.Tia)}static main(){K.a.instance.Mc(new hj)}}Object(f.a)(hj,"WordEditorUnsavedChangesHighlightPackage",null,[0,1,11]);var Ek=d(123);class Xl{constructor(Q,Ca,sb){this.ga=Q;this.io=Ca;this.Ga=sb}Wb(){this.Ga.$("ZoomPopupDialogIsEnabled")&&(this.ga.qa(x.a.tyc,z.a.frame,Object(O.a)(this.io,this.io.tyc,"showZoomDialog")),this.ga.fb(x.a.Nno,z.a.frame,Object(O.a)(this.io,this.io.tnj,"onQueryZoomText"),96),this.ga.qa(x.a.Pud,z.a.frame,Object(O.a)(this.io,this.io.vdk,"zoomDialogTabFocusHandler")),
this.ga.qa(x.a.Oud,z.a.frame,Object(O.a)(this.io,this.io.vdk,"zoomDialogTabFocusHandler")));this.Ga.$("ZoomSliderIsEnabled")&&(this.ga.fb(x.a.Zxj,z.a.frame,Object(O.a)(this.io,this.io.B3n,"onQueryZoomPercentage"),96),this.ga.fb(x.a.xdk,z.a.frame,Object(O.a)(this.io,this.io.e7n,"onZoomToPercentage"),96),this.ga.qa(x.a.qNp,z.a.frame,Ek.ActionManager.$f))}}Object(f.a)(Xl,"CommonZoomActor",null,[1926]);class Vh extends Xl{constructor(Q,Ca,sb){super(Q,Ca,sb);this.Kja=Ca}Wb(){super.Wb();this.Ga.$("ZoomPopupDialogIsEnabled")&&
(this.ga.qa(tf.a.PPg,z.a.frame,Ek.ActionManager.$f),this.ga.qa(tf.a.iHe,z.a.frame,Object(O.a)(this.Kja,this.Kja.pNp,"zoomTo100")));this.ga.qa(tf.a.F3b,z.a.frame,Object(O.a)(this.Kja,this.Kja.F3b,"zoomToPageWidth"));this.ga.qa(x.a.usb,z.a.frame,Object(O.a)(this.Kja,this.Kja.usb,"increaseZoom"));this.ga.qa(x.a.Gob,z.a.frame,Object(O.a)(this.Kja,this.Kja.Gob,"decreaseZoom"));this.ga.qa(tf.a.Dxg,z.a.frame,Object(O.a)(this.Kja,this.Kja.Z1o,"setZoomLevelFromRibbon"));this.ga.fb(tf.a.Ywb,z.a.frame,Object(O.a)(this.Kja,
this.Kja.tnj,"onQueryZoomText"),96);this.ga.fb(tf.a.Ise,je.a.application,Object(O.a)(this.Kja,this.Kja.A3n,"onQueryZoomLevelLabelText"),96);this.ga.qa(Ed.a.Xbi,z.a.frame,Ek.ActionManager.$f);this.ga.qa(Ed.a.Wbi,z.a.frame,Ek.ActionManager.$f);this.ga.qa(Ed.a.aci,z.a.frame,Ek.ActionManager.$f);this.ga.qa(Ed.a.Ybi,z.a.frame,Ek.ActionManager.$f);this.ga.qa(tf.a.noa,z.a.frame,Ek.ActionManager.$f)}}Object(f.a)(Vh,"WordEditorZoomActor",Xl,[]);class ar{constructor(Q,Ca){this.zoom=Q;this.W5k=Ca}}Object(f.a)(ar,
"SetCustomZoomArgs",null,[]);var Ix=d(1110);class ds{constructor(Q,Ca){this.kPl=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.lPl=[ds.uxf,ds.B_d,"200","150","100","75","50"];this.Lra=3;this.CQ=0;this.delta=.1;this.g4f=0;this.hd=new V.a;this.Ai=null;this.J=Q;this.Qb=Ca;this.pRj(1)}get Cj(){return this.CQ}pRj(Q){this.CQ=Q}get wYc(){return Math.round(100*this.Cj)}get bTn(){return Math.floor(this.wYc/10)/10+this.delta}get aTn(){return Math.ceil(this.wYc/
10)/10-this.delta}get ga(){return m.AFrameworkApplication.va}M3k(Q){this.hd.addHandler("ZoomChanged",Q)}ZDo(Q){this.hd.removeHandler("ZoomChanged",Q)}oY(Q){this.M3k(Q)}BNa(Q){this.ZDo(Q)}xBj(){}qDj(){}wBj(){}pDj(){}Qud(Q){this.wdk(Q,this.Cj)}wdk(Q,Ca){null!==Q&&xn.a.aQj(Q,Ca)}pBg(Q,Ca=!0){let sb=Q*=100;this.J&&this.J.$("DoNotAutoScrollAfterPinchIsEnabled")&&(sb=new ar(Q,Ca));this.UNj(sb)}Y1o(Q,Ca=!1){this.noa(Q,3|(Ca?0:4))}c7n(Q,Ca,sb){if(1===Q)return 32;Q=sb/100;Q<this.Jdd?Q=this.Jdd:Q>this.kdd&&
(Q=this.kdd);this.noa(Q,1);Ca&&(Ca.Ft=Math.floor(100*Q));return 32}tnj(Q,Ca,sb,Xb,Cc){if(1===sb)return 32;Q=ab.a.lKa(this.wYc,6,m.AFrameworkApplication.numberFormat);Cc.Value=Q;Cc.LabelText=Q;return 32}e7n(Q,Ca,sb,Xb,Cc){return 1===sb?32:this.c7n(sb,Xb,Cc.value)}B3n(Q,Ca,sb,Xb,Cc){Cc.MinValue=100*this.Jdd;Cc.MaxValue=100*this.kdd;Cc.value=this.wYc;return 32}FKi(){return this.kPl}GKi(){return this.lPl}Spm(){let Q=Math.floor(100*this.Cj).toString();1===this.Lra?Q=ds.uxf:2===this.Lra&&(Q=ds.B_d);return Q}usb(Q,
Ca,sb){if(1===sb)return 32;this.xcd(this.Qb?this.Qb.pE:0,"IncreaseZoom");this.Lra=0;this.noa(this.bTn);return 32}Gob(Q,Ca,sb){if(1===sb)return 32;this.xcd(this.Qb?this.Qb.pE:0,"DecreaseZoom");this.Lra=0;this.noa(this.aTn);return 32}Z1o(Q,Ca,sb,Xb,Cc){if(1===sb)return 32;this.xcd(this.Qb?this.Qb.pE:0,"SetZoomLevelFromRibbon");Q=Cc.Value;if(Q.toLowerCase().startsWith("fit"))return Q=new cd.a(0,1,0,()=>{this.F3b(0,null,2,null,null)},138,void 0,!0),Ph.a.instance.Yb(Q),32;Q=parseInt(Q)/100;if(isNaN(Q))return 2;
this.Lra=0;this.noa(Q);return 32}xcd(Q,Ca){wa.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",Q,Ca,m.AFrameworkApplication.ta.Hb.Cs)}tyc(Q,Ca,sb){if(1===sb)return 32;wa.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const Q=this.Spm();this.Ai=new Ix.a(this.FKi(),this.GKi(),Object(O.a)(this,this.lZm,"handleZoomDialogResult"),Of.FocusManager.instance(),!0);this.Ai.tyc(CommonUIStrings.l_ZoomDialogTitle,
Q)}Pjn(Q){return Q.toLowerCase()===ds.uxf.toLowerCase()}Qjn(Q){return Q.toLowerCase()===ds.B_d.toLowerCase()}lZm(Q){if(Q){if(this.Pjn(Q)){this.Lra=1;var Ca=32}else if(this.Qjn(Q))this.Lra=2,Ca=this.F3b(0,null,2,null,null);else if(Ca=Number.parseInvariant(Q)){this.Lra=0;let sb=Ca;this.J&&this.J.$("DoNotAutoScrollAfterPinchIsEnabled")&&(sb=new ar(Ca,!0));Ca=this.UNj(sb)}else Ca=8;32===Ca?wa.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:Q}):wa.ULS.sendTraceTag(7156360,353,
10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}else wa.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}Dpo(){this.hd.raiseEvent("ZoomChanged",null)}Ayj(){}Wpg(){}vdk(Q){if(!this.Ai)return 2;var Ca=this.Ai.focusManager.gu().Tk.Hra;if(Ca===this.Ai.sB&&Q===x.a.Pud||Ca===this.Ai.qJ&&Q===x.a.Oud)this.Ai.aKb||this.Ai.UPo(),this.Ai.focusManager.gu().Tk.oA(this.Ai.aKb);else if(Ca.id.startsWith(this.Ai.qjd)||Ca.className.startsWith(this.Ai.gyj))Ca=null,Q===x.a.Pud?Ca=this.Ai.qJ:
Q===x.a.Oud&&(Ca=this.Ai.sB),this.Ai.focusManager.gu().Tk.oA(Ca),Sys.UI.DomElement.removeCssClass(this.Ai.aKb.parentNode,this.Ai.Fpg);else if(Q===x.a.Pud)this.Ai.focusManager.gu().Rrc();else if(Q===x.a.Oud)this.Ai.focusManager.gu().Prc();else return 2;return 32}}ds.uxf="FullPage";ds.B_d="PageWidth";Object(f.a)(ds,"ZoomManager",null,[1006]);var es;(function(Q){Q[Q.wcj=0]="manual";Q[Q.d3p=1]="fitToFullPage";Q[Q.spi=2]="fitWidth";Q[Q.teg=3]="onBoot"})(es||(es={}));Object(f.b)("ZoomStatus",es);d(1266);
var ts;(function(Q){Q[Q.normal=0]="normal";Q[Q.coo=1]="quiet";Q[Q.sgi=2]="disableScrollUpdate";Q[Q.HVl=4]="disableUiControlUpdate"})(ts||(ts={}));Object(f.b)("ZoomUpdateFlags",ts);var xt=d(280),$s=d(333),yt=d(1022);class Jp extends ds{constructor(Q,Ca,sb,Xb,Cc,jd,dd){super(Q,Ca);this.EJp=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.FJp=[ds.B_d,"200","150","125","100","75","50"];this.lcf=this.eHj=!1;this.U9g="AutoFitForAdaptiveLayout";this.Fwk="FitPageWidthFailure";this.xSk=
"UpdateZoomFailure";this.RTk="wwf";this.Bdf=null;this.vAj=()=>{this.Lra===es.spi&&this.lEf()};this.qNl=oe=>{if(oe.ctrlKey){m.AFrameworkApplication.va.Ob(Ed.a.Ybi,2);oe=oe.zIp;if(!oe)return!1;this.noa(this.Cj-(0<oe?.1:-.1));this.xcd(6,"CtrlScroll");return!0}return!1};this.d7n=()=>{wa.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.WZ=sb;this.ml=Xb;this.Zb=Cc;this.Fg=jd;this.tIc=dd;this.nrh=Q.$("KeepViewAfterZoomIsEnabled");this.STk=Q.$("ZoomShortCutIsEnabled");
this.MSk=Q.$("DoNotAutoScrollAfterPinchIsEnabled");this.nBk=(this.vWe=Q.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&Q.$("AutoFitForSmallScreenModeIsEnabled");this.Euk=Q.$("DoNotProcessUpdateZoomActionIsEnabled");this.TTk=Q.$("ZoomSliderIsEnabled");this.gB()}get appName(){return"WordEditor"}get kdd(){return 4}get Jdd(){return.1}get rNl(){return wacBoot.CtrlWheelMetrics}k3k(Q){this.hd.addHandler("PinchStart",Q)}ODo(Q){this.hd.removeHandler("PinchStart",Q)}j3k(Q){this.hd.addHandler("PinchEnd",Q)}NDo(Q){this.hd.removeHandler("PinchEnd",
Q)}get IH(){return null!=this.w4g?this.w4g:this.w4g=Na.a.instance.Oa(586)}k$j(Q){Q=!(Q&ts.HVl);const Ca=vb.a.get_instance().isCompleted(7);return Q&&Ca?(Q={SelectZoomOption:"ComboBoxModel"},Wc.StaticActiveAppFrame.za()&&Wc.StaticActiveAppFrame.za().lJ(Q),this.ADp(),!0):!1}noa(Q,Ca=ts.normal){let sb=!0;this.Euk||m.AFrameworkApplication.va.Ob(tf.a.noa,2);if(this.Cj===Q)return this.lcf||(this.lcf=this.k$j(Ca)),sb;Q>this.kdd?Q=this.kdd:Q<this.Jdd&&(Q=this.Jdd);var Xb=!!(Ca&ts.coo);1===Q||Xb||m.AFrameworkApplication.va.Ob(tf.a.PPg,
2);try{Xb=null;Wc.StaticActiveAppFrame.za()&&Object($l.a)(yt.a,Wc.StaticActiveAppFrame.za().kb.Jc)&&(Xb=Wc.StaticActiveAppFrame.za().kb.Jc);let Cc=-1,jd=-1,dd=-1;const oe=!(Ca&ts.sgi);this.nrh&&oe&&(Cc=$f.a.jSm(sg.a.instance.gb.currentSelection,Xb),jd=Xb.uK.scrollLeft,dd=Xb.uK.scrollTop);const Me=this.Cj;this.pRj(Q);this.Dpo();this.lcf=this.k$j(Ca);oe&&this.cCp(Xb,Cc,jd,dd,Me)}catch(Cc){sb=!1,wa.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",Cc)}return sb}cCp(Q,Ca,sb,Xb,Cc){Q&&Q.isActive?
this.nrh?0<=Ca&&100>=Ca?Q.ys.n4(100-Ca,!0,!0):Q.ys.gyn(sb,Xb,Cc,this.Cj):Q.ys.n4():wa.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}pNp(Q,Ca,sb){2===sb&&(this.xcd(this.Qb?this.Qb.pE:0,"ZoomTo100"),this.Lra=es.wcj,this.noa(1));return 32}UNj(Q){this.Lra=es.wcj;let Ca,sb=!0;if(this.MSk){if(!Object($l.a)(ar,Q))return wa.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;Ca=Q.zoom/100;sb=Q.W5k}else Ca=Number.parseInvariant(String.format("{0}",
Q))/100;wa.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",Ca);Q=ts.normal;sb||(Q=ts.sgi);this.noa(Ca,Q);return 32}F3b(Q,Ca,sb){if(1===sb)return 32;wa.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(kd.a)("ZoomToPageWidth",!0);this.Lra=es.spi;this.d3l();return this.lEf()}A3n(Q,Ca,sb,Xb,Cc){if(1===sb)return 32;Q=ab.a.lKa(this.wYc,6,m.AFrameworkApplication.numberFormat);Cc[xt.a.labelText]=Q;return 32}FKi(){return this.EJp}GKi(){return this.FJp}d3l(){this.eHj||
(Wc.StaticActiveAppFrame.za()?(Wc.StaticActiveAppFrame.za().o2(this.vAj),this.eHj=!0):wa.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}lEf(){var Q=this.WZ.$Jf();if(!Q)return 8;for(var Ca=0;Q;)Ca=Math.max(Ca,Co.a.instance.Mv(Q)),Q=this.WZ.$3c(Q);Q=Bo.a.sj(Ca,0);(Ca=this.tIc())&&Ca.Tye()&&(Q+=wacBoot.ShiftUtils.getFloatingObjectsContainerWidth());Q+=2*$s.a.tPg;Q=Wc.StaticActiveAppFrame.za().nG.offsetWidth/Q;this.noa(Q);return 32}ADp(){this.IH&&
(this.TTk?(this.IH.sS(Jl.a.kNp),this.IH.sS(Jl.a.mNp)):this.IH.sS(Jl.a.nNp))}Tfp(Q){Q||(Q=window.self.CtrlWheelMetrics);if(Q){var Ca=Q.ctrlWheelOccurred;if("boolean"!==typeof Ca)wa.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{wa.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",Ca);try{Q.stop()}catch(sb){wa.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",sb)}}}else wa.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}gB(){this.Tfp(this.rNl);
if(this.ml){var Q=document.getElementById(Di.a.j0d);Q&&this.ml.nb(S.a.ivb,Q,this.qNl)}this.Zb&&(Q=this.Zb.ie(Di.a.GF),this.STk&&(Q.bindAction(ed.KeyInputManager.lc(Dj.a.wBc,ed.KeyInputManager.mi),x.a.usb),Q.bindAction(ed.KeyInputManager.lc(Dj.a.Vtd,ed.KeyInputManager.mi),x.a.usb),Q.bindAction(ed.KeyInputManager.lc(Dj.a.xBc,ed.KeyInputManager.mi),x.a.Gob),Q.bindAction(ed.KeyInputManager.lc(Dj.a.yBc,ed.KeyInputManager.mi),x.a.Gob),Q.bindAction(ed.KeyInputManager.lc(Dj.a.Wvd,ed.KeyInputManager.mi),tf.a.iHe)));
this.Fg&&(this.Bdf=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.Fg.nb(S.a.click,this.Bdf,this.d7n);this.nBk&&(Wc.StaticActiveAppFrame.za().fL.registerLayoutBreakpointChanged("canvas",Ca=>{this.ckf(Ca)}),Wc.StaticActiveAppFrame.za().fL.registerBoundingWindowRectsChanged("canvas",()=>{this.ckf(Wc.StaticActiveAppFrame.za().fL.getLayoutBreakpoint())}))}ckf(Q){let Ca=!0,sb="";if(this.Lra!==es.teg)return Ca;va.Health.instance.recordKpiUsage(this.U9g,0,this.RTk,null);switch(Q){case "Small":8===
this.lEf()&&(sb=this.Fwk,Ca=!1);break;default:1===this.Cj||this.noa(1)||(sb=this.xSk,Ca=!1)}Ca||va.Health.instance.recordKpiFailure(this.U9g,sb,!0,!0,null);return Ca}xBj(Q){this.k3k(Q)}qDj(Q){this.ODo(Q)}wBj(Q){this.j3k(Q)}pDj(Q){this.NDo(Q)}Ayj(){this.hd.raiseEvent("PinchStart",null)}Wpg(){this.hd.raiseEvent("PinchEnd",null)}}Object(f.a)(Jp,"WordEditorZoomManager",ds,[1005,1006]);class Tt{constructor(){this.Z=null}get name(){return"WordEditor.Zoom"}init(){if(m.AFrameworkApplication.J.$("ZoomPopupDialogIsEnabled")){const Q=
this.Z.resolve(1627),Ca=this.Z.resolve(1628);Q.Wb();Sys.UI.DomElement.overrideGetBounds=!0;m.AFrameworkApplication.J.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&m.AFrameworkApplication.J.$("AutoFitForSmallScreenModeIsEnabled")&&Ca&&vb.a.get_instance().$k(4,()=>{Ca.ckf(Wc.StaticActiveAppFrame.za().fL.getLayoutBreakpoint())||wa.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}uc(Q){this.Z=Q;m.AFrameworkApplication.J.$("ZoomPopupDialogIsEnabled")&&
(this.Z.ia(1628,()=>new Jp(m.AFrameworkApplication.J,m.AFrameworkApplication.va,nr.WordSectionNavigator.instance,wn.a.instance,Of.FocusManager.instance(),zh.a.instance,()=>Q.Oa(362))).ha().as(6).as(606),this.Z.ia(1627,()=>new Vh(m.AFrameworkApplication.va,this.Z.resolve(1628),m.AFrameworkApplication.J)).ha())}static main(){K.a.instance.Mc(new Tt)}}Object(f.a)(Tt,"ZoomPackage",null,[0,1]);var up=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},
children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",
Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",
Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",
Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",
For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",
Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",
HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},fs;(function(Q){Q[Q.cQp=0]="Healthy";Q[Q.ZQp=1]="MissedScan";
Q[Q.kRp=2]="NeedsReset";Q[Q.KOp=3]="CriticalUnresponsive";Q[Q.BQp=4]="KickoutComponent"})(fs||(fs={}));Object(f.b)("TimerBasedWatchDogStatus",fs);class am{constructor(Q,Ca,sb){this.OLd=this.Lrh=this.Psh=this.V5b=this.HGa=0;this.Qej=3;this.QZd=3E4;this.ubc=Q;this.tCb=Ca;this.vLi=sb}PDa(){this.HGa=0}async gQn(){const Q=Date.now(),Ca=this.ubc.sqc;this.OLd++;if(this.Lrh==Ca&&this.p7o(Q,this.Psh))return{["WatchDogScanTime"]:Q,["LastComponentScanTime"]:Ca,["ComponentStatus"]:fs[this.V5b],["ActionTaken"]:"None. Skipping to Match Interval"};
this.Lrh=Ca;this.Psh=Q;this.tCb=this.ubc.fci;this.V5b=this.Kvi(Q,Ca);3===this.V5b&&(await this.Vtp(),this.V5b=this.Kvi(Q,this.ubc.sqc));return this.n6k(this.V5b,Q,Ca)}Qwn(){return 0===this.V5b}Kvi(Q,Ca){let sb=0;Q>Ca+Math.max(this.tCb,this.QZd)+this.vLi&&(sb=0===this.HGa?1:this.HGa<this.Qej?2:this.HGa===this.Qej?3:4);return sb}n6k(Q,Ca,sb){const Xb={};Xb.WatchDogScanNumber=this.OLd;Xb.WatchDogScanTime=Ca;Xb.LastComponentScanTime=sb;Xb.ComponentStatus=fs[Q];Xb.ExpectedComponentScanInterval=this.tCb;
Xb.GraceTimeInMS=this.vLi;Xb.ActualTimeBetweenWatchDogAndComponentScans=Ca-sb;switch(Q){case 0:Xb.ActionTaken="None";this.HGa=0;break;case 1:this.HGa++;Xb.ActionTaken="Missed Scan, Wait to Restart component";break;case 2:this.HGa++;Xb.ActionTaken="Component restarted";wa.ULS.sendTraceTag(509686347,3037,20,"Restarting Component with interval {0}",this.tCb);this.ubc.KYj();this.ubc.TXj(Math.min(this.tCb,this.QZd/2));break;case 3:this.HGa++;Xb["ActionTaken?"]="Attempted Synchronous run: "+fs[Q];break;
case 4:wa.ULS.sendTraceTag(512570578,3037,15,"Component is not Responding. WatchDog would kickout now"),Xb["ActionTaken?"]="Kickout",Xb.ShouldKickout=!0,this.HGa++}Xb.NextExpectedComponentScanTimeInMs=sb+(this.HGa+1)*this.tCb;Xb.MissedScans=this.HGa;return Xb}async Vtp(){return this.ubc.Vqi()}p7o(Q,Ca){return Ca+this.tCb>Q}}Object(f.a)(am,"TimerBasedWatchDog",null,[1560]);class $n{constructor(Q,Ca,sb,Xb,Cc,jd,dd,oe){this.hZ=null;this.SNc=this.pja=0;this.xFb=new Date(Date.UTC(0,1,1,0,0));this.PK={};
this.mPc=this.lPc=0;this.Y1h=async()=>{var Me;wa.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",this.lPc++);if(this.lf.Mo)this.Hld(),this.stop(),wa.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",this.fy.J0a);else{this.xFb=new Date;var zf={};zf.DocxSaveMonitor_IsUpToDate=null===(Me=this.hZ)||void 0===Me?void 0:Me.PU;zf.RSNManager_IsUpToDate=this.fy.PU;zf.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=
this.fy.Qfc();zf.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.fy.kYd();wa.ULS.sendTraceTag(521413850,3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",zf);if(this.xk&&!this.xk.isVisible)wa.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",this.fy.J0a),this.Mgo();else if(Me=this.fy.wXc(this.LLd),0<Me){Me=this.Cti(Me);wa.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(Me));this.jUl&&wa.ULS.sendTraceTag(524158796,
3038,15,"Diagnostic Log :{0}",this.kD());if(0==this.pja)this.SNc=this.sqc;else if(1<this.pja){wa.ULS.sendTraceTag(524137233,3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.pja,this.sqc-this.SNc);if(this.Fhn&&(!await this.fy.Q$d(this.NZm)||0===this.fy.wXc(this.LLd))){this.Hld();return}this.Ccj(Me,this.sqc);this.PK.ShouldKickout&&(wa.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.PK)),this.P1.uUb(this.wym()))}this.pja++}else this.Hld(),this.Tql()}};this.Z1h=async()=>
{await this.Y1h();this.$Xj()};this.fy=Q;this.lf=Ca;this.P1=dd;this.oNk=oe;this.rDh=Xb;this.LLd=Cc;this.JMk=jd;this.hZ=Na.a.instance.Oa(436);this.PK.ShouldKickout=!1;this.Rkg=this.hdo;this.wtj=this.ido;sb.execute(Me=>{this.xk=Me});this.lf.Vya(this.fV.bind(this))}get sqc(){return this.xFb.getTime()}Cti(Q){return{["NumberOfStaleRevisions"]:Q,["BrowserIsOnline"]:Zm.a[this.lf.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.lf.Mo,["IsSessionExpired"]:this.lf.pba,["IsSessionLost"]:this.lf.Koc,
["HasEmergencyViewDeployed"]:this.lf.Nk,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),["VisibilityManager_AppVisibilityState"]:this.xk?Yg.a[this.xk.DA]:"undefined"}}fV(Q,Ca){if(Ca){Q=Date.now();var sb=this.fy.wXc(this.LLd);0<sb&&(sb=this.Cti(sb),this.Ccj(sb,Q));this.qMo();this.KGn(Ca.errorCode)}this.stop();this.hZ=Na.a.instance.Oa(436)}Tql(){this.fy.dae(this.JMk)&&this.bwp()}bwp(){wa.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");
this.oNk.Jnf();Yi.a.pFf(Go.a.eMo)}wym(){return this.Htn?Tk.a.DKp:this.lf.pba?Tk.a.Qck:Tk.a.CKp}stop(){0!==this.mPc&&(window.clearInterval(this.mPc),this.mPc=0);wa.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async Vqi(){this.KUp&&this.stop();this.Z1h();wa.ULS.sendTraceTag(509101133,3038,50,"RDLM running Synchronously")}Pep(Q){this.mPc=window.setTimeout(this.Z1h,Q);wa.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.Hld()}$Xj(){this.mPc=window.setInterval(this.Y1h,this.rDh);
wa.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");this.Hld()}qMo(){this.Qri(this.PK);wa.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.PK))}get vJj(){const Q=Object.assign({},this.PK);this.Qri(Q);return Q}Qri(Q){Q.shouldKickout||(0==this.fy.wXc(this.LLd)?(Q.NoKickoutReason="No Stale Revisions",Q.OldestRevisionCreationTime=this.fy.Wjc()):this.xk&&!this.xk.isVisible?(Q.NoKickoutReason="Session not active",Q.VisibilityManager_AppVisibilityState=this.xk.DA):this.j2i&&this.pja<=this.wtj?
(Q.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",Q.ScansWithPersistentRunawayDataLoss=this.pja):this.pja<=this.Rkg?(Q.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",Q.ScansWithPersistentRunawayDataLoss=this.pja):Q.NoKickoutReason="undefined");Q.LastScanTime=this.xFb.toISOString();Q.RunCounter=this.lPc}kD(){const Q={};this.hZ&&(Q.DSM=this.hZ.kD());this.fy&&(Q.RSN=this.fy.kD());return Q}Hld(){wa.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",
this.pja,this.SNc);this.SNc=this.pja=0}Mgo(){this.pja=Math.min(this.Rkg-1,this.pja);this.SNc=Date.now()}j2i(){return 0===this.xk.DA&&this.lf.cB&&!this.lf.Koc&&!this.lf.pba&&!this.lf.Nk}Ccj(Q,Ca){this.pja>this.wtj&&this.j2i()?this.PK.ShouldKickout||(this.PK.ShouldKickout=!0,this.Rri("Persistent RunawayDataLoss detected in active session",Ca,Q)):this.pja>this.Rkg&&!this.PK.ShouldKickout&&(this.PK.ShouldKickout=!0,this.Rri("Runaway DataLoss persists for more than 3 minutes.",Ca,Q))}Rri(Q,Ca,sb){this.PK.KickoutTime=
(new Date(Ca)).toISOString();this.PK.KickoutReason=Q;this.PK.DSM_isUpToDate=this.hZ?this.hZ.PU:"Undefined";this.PK.SessionInfo=sb}KGn(Q){const Ca=this.PK.ShouldKickout;va.Health.instance.recordKpiUsage($n.jIe,1,$n.B2d,null);const sb=new Map;Q&&sb.set("ErrorCode",Q.toString());Ca?(sb.set("ShouldKickout","true"),sb.set("KickoutTime",this.PK.KickoutTime),sb.set("Reason",this.PK.KickoutReason),va.Health.instance.recordKpiSuccess($n.jIe,Object.assign(new fm.a,{extendedProperties:sb}))):(sb.set("ShouldKickout",
"false"),Q=this.PK.NoKickoutReason,sb.set("Reason",Q),va.Health.instance.recordKpiFailure($n.jIe,Q,!1,!1,Object.assign(new fm.a,{extendedProperties:sb})))}KYj(){wa.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");this.stop()}TXj(Q){wa.ULS.sendTraceTag(509686348,3037,50,"RunawayDataLossMonitor started with interval {0}",Q);this.Pep(Q)}get jUl(){return null!=this.lVg?this.lVg:this.lVg=m.AFrameworkApplication.J&&m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",
!0)}get NZm(){return null!=this.fYg?this.fYg:this.fYg=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",3E3):3E3}get Fhn(){return null!=this.B_g?this.B_g:this.B_g=m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",!0)}get ido(){return null!=this.k3g?this.k3g:this.k3g=m.AFrameworkApplication.J.fc("RunawayDataLossMinimumScansBeforeKickout",1)}get hdo(){return null!=this.j3g?
this.j3g:this.j3g=m.AFrameworkApplication.J.fc("RunawayDataLossMaximumScansBeforeKickout",5)}get Htn(){return 1===this.lf.networkState||3===this.lf.networkState}get fci(){return this.rDh}}$n.jIe="RunAwayDataLossKickout";$n.B2d="wwrelfc";Object(f.a)($n,"RunawayDataLossMonitor",null,[1001,1002]);class gq{constructor(){this.jeh=3E4;this.Jtk=24E4;this.Ktk=12E4;this.Z=this.MLd=null}get name(){return 443}init(){if(sj.a.yt||sj.a.nn)this.MLd=this.Z.resolve(this.name),this.MLd.$Xj(),this.Z.resolve(1629),0==
m.AFrameworkApplication.fh.RunawayDatalossSystemStartedAt&&m.AFrameworkApplication.fh.Mcj()}WKl(){return new $n(this.Z.resolve(438),this.Z.resolve(117)||Ke.SessionStatusManager.instance,this.Z.Ra(103),m.AFrameworkApplication.J.fc("RunawayDataLossScanIntervalInMs",this.jeh),this.EMo,this.Ktk,Na.a.instance.Oa(456),Cm.WoncaApp.mG)}uc(Q){if(sj.a.yt||sj.a.nn)this.Z=Q,Q.ia(this.name,this.WKl.bind(this)).as("WordEditor.IRunawayDataLossMonitor").ha(),this.Nrg()}dispose(){this.MLd&&this.MLd.stop()}static main(){K.a.instance.Mc(new gq)}Nrg(){this.Z.ia(1629,
()=>new am(this.Z.resolve(this.name),m.AFrameworkApplication.J.fc("RunawayDataLossScanIntervalInMs",this.jeh),m.AFrameworkApplication.J.fc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}get EMo(){return m.AFrameworkApplication.J.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",this.FMo)}get FMo(){return m.AFrameworkApplication.J.fc("RunawayDataLossKickoutIntervalInMs",this.Jtk)}}Object(f.a)(gq,"WordEditorRunawayDataLossMonitorPackage",null,[0,1]);class Fq{constructor(Q,
Ca){this.oMk=Q;this.pMk=Ca}}Object(f.a)(Fq,"LastSavedToHostDetailsEventArgs",null,[1017]);class zt{constructor(Q,Ca,sb,Xb,Cc,jd,dd){this.sRk=5E4;this.Kaf=0;this.xFb=new Date(Date.UTC(0,1,1,0,0));this.otk=6E4;this.lPc=this.a9b=0;this.sa=new V.a;this.WRo=()=>{wa.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",this.lPc++);this.lf.Mo||this.fjc().then(oe=>{this.sa.raiseEvent(zt.$5i,oe);this.Csh=new Date;oe=this.dbc;this.xk&&!this.xk.isVisible&&(oe=this.OPk);
this.UEa(oe)}).catch(oe=>{this.UEa(this.PPm(oe))})};this.ZMd=Q;this.lf=sb;this.TH=Cc;this.fy=jd;this.dbc=Ca.fc("LastSavedToHostDetailsIntervalMs",6E4);this.HDb=Ca.fc("LastSavedToHostDetailsFailureIntervalMs",5E3);this.OPk=Ca.fc("LastSavedToHostDetailsSuccessIntervalOnHidden",this.dbc);this.OPc=Ca.fc("LastSavedToHostDetailsSentTimeoutMs",12E4);this.A5e=Ca.fc("Microsoft.Office.WordOnline.LastSavedToHostDetailsQueueTimeoutMs",3E4);this.Csh=new Date;Xb.execute(oe=>{this.xk=oe;this.xk.WHa((Me,zf)=>{this.Q_(zf)})});
this.Gf=dd;0==m.AFrameworkApplication.fh.RunawayDatalossSystemStartedAt&&m.AFrameworkApplication.fh.Mcj();this.UEa(this.dbc)}Q_(Q){0!==Q.newState&&1!==Q.newState||0===Q.oldState||1===Q.oldState||this.lf.Mo||(this.UEa(this.Kaf),wa.ULS.sendTraceTag(521412808,3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",this.Csh,this.Kaf))}yta(){return 1==this.lf.networkState}fjc(){this.xFb=new Date;return new Promise((Q,Ca)=>{if(this.yta())wa.ULS.sendTraceTag(525214230,
3037,15,"Network is offline. Not Attempting to send request."),Ca(0);else if(this.lf.pba)wa.ULS.sendTraceTag(524154146,3037,15,"Waiting for token to refresh. Not attempting to send request."),Ca(2);else if(this.fy.PU)wa.ULS.sendTraceTag(509641685,3037,50,"Session is up to date. Not attempting to send request."),Ca(3);else{var sb=fo.b(Sl.construct(this.slc())),Xb={"Content-Type":"application/json; charset=utf-8"};wa.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");if(this.w7o)sj.a.Uzc.nt({url:zt.serviceUrl,
method:"POST",body:sb,headers:Xb,Wwc:this.OPc,oYf:!0}).then(jd=>{this.Fjo(jd,Q,Ca)}).catch(()=>{Ca(0)});else if(this.x7o){var Cc=0;Cc=this.Gf.Xj(zt.serviceUrl,2,sb,Xb,!1,0,jd=>this.a6i(jd,Q,Ca),jd=>this.b6i(jd,Ca),null,null,!1,this.A5e,this.OPc,null,null,!0);0>=Cc&&(wa.ULS.sendTraceTag(525214231,3037,15,"Invalid request id returned "+Cc.toString()),Ca(0))}else Cc=0,Cc=this.ZMd.Xj(zt.serviceUrl,2,sb,Xb,!1,0,jd=>this.a6i(jd,Q,Ca),jd=>this.b6i(jd,Ca),null,null,!0,this.OPc),0>=Cc&&(wa.ULS.sendTraceTag(508650827,
3037,15,"Invalid request id returned "+Cc.toString()),Ca(0))}})}Fjo(Q,Ca,sb){const Xb={},Cc=Q.headers.get(al.a.H2);Xb.HttpStatus=Q.status;Xb.Correlation=Cc;wa.ULS.sendTraceTag(508650831,3037,50,"LastSavedRevisionID Response Summary: {0}",Xb);Q.ok?Q.text().then(jd=>{jd=this.RUa(jd);jd||(wa.ULS.sendTraceTag(508650829,3037,15,"LastSavedRevisionResponse is null"),sb(2));this.TH.qPa(jd);Ca(new Fq(jd.LastSavedRevisionId,jd.RevisionSequenceNumber))}).catch(jd=>{wa.ULS.sendTraceTag(508650828,3037,15,"Failed to parse LastSavedRevisionResponse. Exception: {0}",
jd.toString());sb(2)}):(wa.ULS.sendTraceTag(508650830,3037,15,"LastSavedRevisionResponse failed with status code: {0}",Q.status),Q.status===Mi.a.u8?sb(1):Q.status===Mi.a.Axb?sb(0):sb(2))}b6i(Q,Ca){let sb=2;if(Q=Q.data){if(5===Q.status)sb=1;else if(7===Q.status||13===Q.status)sb=0;wa.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",Q.status))}else wa.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");Ca(sb)}a6i(Q,
Ca,sb){if(Q=Q.data){var Xb={},Cc=Q.wi?Q.wi[al.a.H2]:"";Xb.HttpStatus=Q.He;Xb.Correlation=Cc;Xb.Id=Q.id;wa.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",Xb);(Q=this.RUa(Q.Ee))?(this.TH.qPa(Q),Ca(new Fq(Q.LastSavedRevisionId,Q.RevisionSequenceNumber))):(wa.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),sb(2))}else wa.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),sb(2)}UEa(Q){0!==this.a9b&&window.clearTimeout(this.a9b);this.a9b=
window.setTimeout(this.WRo,Q);wa.ULS.sendTraceTag(525100416,3037,50,"LastSavedToHostDetails request queued with timeout "+Q)}slc(){const Q=Wc.StaticActiveAppFrame.za().kb.Jc;return Q?Q.qd:null}PPm(Q){return 1===Q?this.Kaf:0===Q?this.sRk:3===Q?this.dbc:this.HDb}RUa(Q){let Ca;return({group:Ca}=po.a.N4(Q)).returnValue?Ca.Responses[0]:null}I3k(Q){this.sa.addHandler(zt.$5i,Q)}async Vqi(){const Q=new Promise((Ca,sb)=>{window.setTimeout(sb,3E3)});await Promise.race([Q,this.fjc()]).then(()=>{wa.ULS.sendTraceTag(509100305,
3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>{wa.ULS.sendTraceTag(509100304,3038,15,"LSTHDM ran Synchronously: Failure")})}KYj(){0!==this.a9b&&(wa.ULS.sendTraceTag(509215702,3037,50,"LastSavedToHostDetails Stopped"),window.clearTimeout(this.a9b),this.a9b=0)}TXj(Q){wa.ULS.sendTraceTag(509686350,3037,50,"LastSavedToHostDetails started with interval {0}",Q);this.UEa(Q)}get sqc(){return this.xFb.getTime()}get fci(){return this.otk}kD(){const Q={};Q.LastScanTime=this.xFb.toISOString();Q.RunCounter=
this.lPc;return Q}get w7o(){return null!=this.e4g?this.e4g:this.e4g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseCRMV2",!1):!1}get x7o(){return null!=this.f4g?this.f4g:this.f4g=m.AFrameworkApplication.J?m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.SwitchToClientRequestManager",!1):!1}}zt.$5i="ULSTHD";zt.serviceUrl=sj.a.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";Object(f.a)(zt,"LastSavedToHostDetailsManager",
null,[1003,1002]);class at{constructor(Q,Ca,sb){this.N_m=Q;this.TDa=Ca;this.tzn=sb;this.wkg=()=>{const Xb=this.N_m();return 32!==Xb?Xb:!this.TDa||this.TDa.PU?32:8};this.fAp=(Xb,Cc,jd,dd,oe)=>{this.tzn.UEa(parseInt(oe.toString()));return 32}}Wb(Q){Q.qa(tf.a.wkg,je.a.view,this.wkg);Q.qa(tf.a.x7j,je.a.view,this.fAp);Q.Pc(tf.a.x7j,101)}}Object(f.a)(at,"LastSavedToHostDetailsManagerActor",null,[]);class ao{constructor(){this.Z=null}get name(){return"WordEditor.LastSavedToHost"}uc(Q){const Ca=m.AFrameworkApplication.J;
this.Z=Q;const sb=new Ng(m.AFrameworkApplication.userSessionId,m.AFrameworkApplication.Ge.c1,m.AFrameworkApplication.Ge.RZd);this.Z.ia(402,()=>new zt(sb,Ca,this.Z.Oa(117)||Ke.SessionStatusManager.instance,this.Z.Ra(103),Mf.a.instance,this.Z.resolve(438),m.AFrameworkApplication.Ge)).ha();this.Nrg()}init(){(new at(()=>Cm.WoncaApp.mG.RNi(),this.Z.resolve(438),this.Z.resolve(402))).Wb(m.AFrameworkApplication.va);this.Z.resolve(402);this.Z.resolve(1630)}dispose(){}static main(){K.a.instance.Mc(new ao)}Nrg(){this.Z.ia(1630,
()=>new am(this.Z.resolve(402),m.AFrameworkApplication.J.fc("LastSavedToHostDetailsIntervalMs",6E4),m.AFrameworkApplication.J.fc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}}Object(f.a)(ao,"LastSavedToHostDetailsPackage",null,[0,1]);var zy=d(1425),rm=d(1478);class Kp{constructor(Q,Ca,sb,Xb){this.hDl=Q;this.AMb=Ca;this.fDl=sb;this.appSettings=Xb;this.qql=async()=>{const Cc=rm.b.wEa(),jd=Promise.race([this.$0n(),new Promise(dd=>setTimeout(()=>dd(!1),5E3))]);wa.ULS.sendTraceTag(508863558,3048,50,
"Copilot Compose feature condition check took: {0}ms",Cc.M0d);return jd};this.$0n=async()=>{if(!this.lln||!this.mhn)return!1;await this.LOg();return await this.fDl.xof()&&await this.hDl.xof()?!0:!1};this.Mkn=new bc.a(this.qql)}async isEnabled(){return this.Mkn.value}get lln(){const Q=this.AMb.isInsertActionEnabled,Ca=this.AMb.isRewriteActionEnabled,sb=this.AMb.isVisualizeAsTableEnabled;return this.AMb.isStartActionEnabled||Q||Ca||sb}get mhn(){return kb.a.yj?this.AMb.isFirefoxAllowed:!0}async LOg(){return new Promise(Q=>
{this.appSettings.xp(()=>{Q(!0)})})}}Object(f.a)(Kp,"CopilotComposeFeatureCondition",null,[]);class bt{constructor(Q){this.pfd=async()=>{const Ca=await this.R7i.value;await this.J7c(Ca);return Ca};this.O9n=K.a.instance;this.R7i=new bc.a(Q);this.U9m=new bc.a(this.pfd)}async Z6(){await this.R7i.value}async K_c(){return await this.U9m.value}async J7c(Q){K.a.instance.Mc(Q);return new Promise(Ca=>{this.O9n.registerOnPackageInit(Q.name,Ca)})}}Object(f.a)(bt,"LazyLoadedPackage",null,[]);var Sv=d(2166),gs=
d(2129);const Mr=new bt(()=>Promise.all([d.e(4),d.e(2),d.e(11)]).then(d.bind(null,2149)).then(Q=>Q.instance));class us{constructor(Q,Ca){this.RJp=Q;this.logger=Ca;this.pfd=async()=>{await this.logger.measureActivityPerformanceAsync(this.Gyf,{name:"Initialize",dataFields:[...Object(gs.a)(Sv.a.getFields({featureName:"CopilotCompose",Unf:Sv.a.oCc.ContentGeneration,yic:Sv.a.wgb.IsEnabled,isUserInitiated:!1}))]})};this.Gyf=async()=>{await Promise.all([Mr.Z6(),this.RJp.loadChunk("copilotComposeUx")]);await Mr.K_c()}}initialize(){this.pfd().catch(Q=>
{wa.ULS.jA(508913495,3048,10,Q,"Failed to initialize CopilotCompose")})}}Object(f.a)(us,"CopilotComposeInitializer",null,[]);class Kw{constructor(Q,Ca){this.appSettings=Q;this.p8k=Ca;this.m4f="Copilot";this.Bjl="Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped";this.D9n="Microsoft.Office.WordOnline.CopilotLicensePaywallNoPassOverrideEnabled"}async xof(){const Q=await this.Oql();wa.ULS.sendTraceTag(508859584,3048,50,"License check result: {0}",Q);return 1===Q||0===Q}async Oql(){if(this.gml())return 0;
const Q=rm.b.wEa(),Ca=await this.DSf();wa.ULS.sendTraceTag(508863556,3048,50,"License check took: {0}ms",Q.M0d);return Ca?this.O5o()?3:1:2}gml(){return this.appSettings.getBooleanFeatureGate(this.Bjl,!1)}O5o(){return this.appSettings.getBooleanFeatureGate(this.D9n,!1)}async DSf(){return(await Object(Dk.b)(this.p8k)).isFeatureEnabled(this.m4f,!1)}}Object(f.a)(Kw,"CopilotComposeLicenseCondition",null,[]);class Up{constructor(Q){this.appSettings=Q}get isStartActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStartActionEnabled",
!1)}get isInsertActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsInsertActionEnabled",!1)}get isRewriteActionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteActionEnabled",!1)}get isStreamingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsStreamingEnabled",!1)}get isAutoOpenOnStartEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAutoOpenOnStartEnabled",
!1)}get isNonEmptyStartEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsNonEmptyStartEnabled",!1)}get isCiqEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotComposeCiqEnabled",!1)}get isCiqMultilingualEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsCiqMultilingualEnabled",!1)}get isCiqBrowseCloudFilesEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isCiqBrowseCloudFilesEnabled",
!1)}get isCopilotPluginsEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isCopilotPluginsEnabled",!1)}get isLogToAshaEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsLogToAshaEnabled",!1)}get isTableRenderingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.CopilotCompose.isTableRenderingEnabled",!1)}get isStylizedTableRenderingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isStylizedTableRenderingEnabled",
!1)}get isGranularStreamingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsGranularStreamingEnabled",!1)}get streamingWordsPerSecond(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingWordsPerSecond",0)}get isFirefoxAllowed(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsFirefoxAllowed",!1)}get streamingChunkGenerationTimeoutMs(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.StreamingChunkGenerationTimeoutMs",
2E4)}get isAdminControlEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCopilotAdminControlEnabled",!1)}get isFeedbackSdkEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.FeedbackSdkEnabled",!1)}get isSupportedLanguagesLinkEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsSupportedLanguagesLinkEnabled",!1)}get isAutoAcceptFixEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAutoAcceptFixEnabled",
!1)}get isMultiTurnEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsMultiTurnEnabled",!1)}get isProactiveSurveysEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsProactiveSurveysEnabled",!1)}get isRewriteV2Enabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsRewriteStreamingWorkflowEnabled",!1)}get isRewriteFormattedInsertionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.isRewriteFormattedInsertionEnabled",
!0)}get insertTextContextParagraphsCountLimit(){return this.appSettings.getIntFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.InsertTextContextParagraphsCountLimit",6)}get isMultiTurnExpandedInputEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsMultiTurnExpandedInputEnabled",!1)}get isDesignerSuggestionsSuppressionEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsDesignerSuggestionsSuppressionEnabled",
!1)}get isSetParagraphLanguageEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsSetParagraphLanguageEnabled",!1)}get isWrongIntentUnhighlightEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsWrongIntentUnhighlightEnabled",!0)}get isDynamicAnchoringEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsDynamicAnchoringEnabled",!1)}get isVisualizeAsTableEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsVisualizeAsTableEnabled",
!1)}get isNewLineAutoAcceptFixEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsNewLineAutoAcceptFixEnabled",!0)}get isPromptAssistanceEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsPromptAssistanceEnabled",!1)}get isAiRewriteGranularChunkingEnabled(){return this.appSettings.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotCompose.IsAiRewriteGranularChunkingEnabled",!0)}}Object(f.a)(Up,
"CopilotComposeFeatureGatesImpl",null,[]);class Jx{constructor(Q,Ca){this.bWc=Q;this.AMb=Ca}async xof(){if(!this.AMb.isAdminControlEnabled)return!0;const Q=rm.b.wEa();try{return!await (await Object(Dk.b)(this.bWc)).rN("CopilotContentGeneration",!0)}finally{wa.ULS.sendTraceTag(508651538,3048,50,"Admin policy check took: {0}ms",Q.M0d)}}}Object(f.a)(Jx,"CopilotComposeAdminPolicyCondition",null,[]);class gi extends zy.a{constructor(){super(...arguments);this.name="WordEditor.Copilot.ComposeEntry"}XUa(Q){Q.ia(1632,
()=>new rm.a(Q.resolve(1348),"CopilotCompose")).ha()}ZUa(){const Q=Na.a.instance;(new us(Q.resolve(1631),Q.resolve(1632))).initialize()}YUa(){}static main(){gi.Som().isEnabled().then(Q=>{Q&&K.a.instance.Mc(new gi)}).catch(()=>{wa.ULS.sendTraceTag(508859807,3048,10,"Feature condition check for Copilot Compose failed with error")})}static Som(){const Q=Na.a.instance;Q.ia(1633,()=>new Up(m.AFrameworkApplication.J)).ha();Q.ia(1634,()=>new Kw(m.AFrameworkApplication.J,Q.Ra(4))).ha();Q.ia(1635,()=>new Jx(Q.Ra(84),
Q.resolve(1633))).ha();Q.ia(691,()=>new Kp(Q.resolve(1634),Q.resolve(1633),Q.resolve(1635),m.AFrameworkApplication.J)).ha();return Q.resolve(691)}}Object(f.a)(gi,"CopilotComposeEntryPackage",zy.a,[]);var Ay=d(1429);class Fk extends Ay.a{constructor(Q){var Ca;super("BooleanFeatureGateConditionId");this.Js=Q.Js;this.u0c=Q.u0c;this.defaultValue=null!==(Ca=Q.defaultValue)&&void 0!==Ca?Ca:!1}initialize(){super.initialize();const Q=m.AFrameworkApplication.J;Q.xp(()=>{const Ca=Q.getBooleanFeatureGate(this.u0c,
this.defaultValue);this.oi(Ca)})}oi(Q){super.oi(Q);wa.ULS.sendTraceTag(512369937,3028,50,this.O6(this.Js,Q,`featureGate=${this.u0c}`))}}Object(f.a)(Fk,"BooleanFeatureGateCondition",Ay.a,[]);class Lp extends Ay.a{constructor(Q){var Ca;super("DocumentOwnerConditionId");this.Js=Q.Js;this.WBg=null!==(Ca=Q.WBg)&&void 0!==Ca?Ca:!0}initialize(){super.initialize();const Q=m.AFrameworkApplication.J;Q.xp(()=>{const Ca=Q.$("IsDocumentOwner");this.oi(Ca===this.WBg)})}oi(Q){super.oi(Q);wa.ULS.sendTraceTag(508958623,
3028,50,this.O6(this.Js,Q))}}Object(f.a)(Lp,"DocumentOwnerCondition",Ay.a,[]);var By=d(1390);class yn extends By.a{constructor(Q,Ca,sb){super("LicensePaywallCondition");this.Gbc=Q.Js;this.gwk=Q.m7l;this.Ga=Ca;this.Bv=sb}initialize(){super.initialize();this.lDl()}Vd(){super.Vd()}lDl(){this.Ga.xp(()=>{!this.Ga.$("IsAnonymousUser")&&this.Bv?this.Bv.execute(Q=>{this.q_e=Date.now();Q.isFeatureEnabled(this.gwk,!1).then(Ca=>{this.q_e=Date.now()-this.q_e;this.oi(Ca)})}):this.oi(!1)})}oi(Q){super.oi(Q);wa.ULS.sendTraceTag(508884163,
3028,50,this.O6(this.Gbc,Q,"Latency for license check: "+this.q_e.toString()+"ms"))}}Object(f.a)(yn,"LicensePaywallCondition",By.a,[]);var br=d(1796),Ut=d(1464);class Vt extends Ut.a{constructor(Q){super(23,Q,null,3028,"SkittleInitializationTriggered")}}Object(f.a)(Vt,"SkittleInitializationTriggerModel",Ut.a,[]);var ml=d(531);class sm{constructor(){this.Gga=(Q,Ca)=>{Ca.succeeded||wa.ULS.sendTraceTag(508618435,3049,10,"Async loading of skittle module failed")}}A$m(Q){const Ca=ml.a.Instance().AQb().prb("WordEditor.Skittles");
Ca.Goc()||this.xDn(Q).then(()=>{Ca.Vqc(this.Gga)}).catch(()=>{wa.ULS.sendTraceTag(508618436,3049,10,"Async loading of skittle ux chunk failed")})}async xDn(Q){return m.AFrameworkApplication.J.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):(await Object(Dk.b)(Q)).$D.loadScript("copilotSummarySkittleUx")}}Object(f.a)(sm,"SkittlesProxyConsumerImpl",null,[1058]);class mf{static xMm(){return new sm}}Object(f.a)(mf,"SkittlesProxyConsumerFactory",null,[]);class Pn{constructor(Q,
Ca){this.FWj=Q;this.exg=Ca;this.xWi=!1;this.Wfd=async(sb,Xb)=>{if(Xb.Eha){Object(kd.a)("SkittleInitializationTriggered");for(const Cc of this.FWj)Cc.LDa(this.Wfd),Cc.Vd();this.xWi||(this.xWi=!0,mf.xMm().A$m(this.exg))}}}initialize(){wa.ULS.sendTraceTag(508621533,3049,50,"SkittleInitializer has begun initializing skittle trigger models");for(const Q of this.FWj)Q.Lqa(this.Wfd),Q.initialize()}}Object(f.a)(Pn,"SkittleInitializer",null,[]);class bm extends zy.a{get name(){return"WordEditor.SkittleEntryPackage"}XUa(Q){this.container=
Q}ZUa(){const Q=new hb.a;if(m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",!1)){var Ca=Q.push,sb=this.container,Xb=sb.resolve(1172);sb=sb.Ra(4);var Cc=new Fk({Js:24,u0c:"Microsoft.Office.WordOnline.CopilotSummarySkittle"});const jd=new Fk({Js:24,u0c:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),dd=new Lp({Js:24,WBg:!1});Cc=new hb.a([Cc,jd,dd]);m.AFrameworkApplication.nd("fbc73697;a29b4114");m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",
!1)&&(sb=new yn({Js:24,m7l:"Copilot"},m.AFrameworkApplication.J,sb),Cc.add(sb));m.AFrameworkApplication.nd("f5gia801;0f27g313");m.AFrameworkApplication.J&&!m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",!1)&&(Xb=new br.a({Js:24},Xb),Cc.add(Xb));Ca.call(Q,new Vt(Cc))}0!==Q.count&&(new Pn(Q,this.container.Ra(78))).initialize()}YUa(){}static main(){K.a.instance.Mc(new bm)}}Object(f.a)(bm,"SkittleEntryPackage",zy.a,[]);Type.registerNamespace("B4RT");
Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");
Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");xi.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");L;Type.registerNamespace("CACPU");Aa.main();
Type.registerNamespace("CAEventTimingMeter");tb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");qb.main();Type.registerNamespace("Common.App.GestureInput");Bb.main();Type.registerNamespace("Common.App.GestureManager");lc.main();Type.registerNamespace("Common.ModernFontPicker");null==m.AFrameworkApplication.J||m.AFrameworkApplication.J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),K.a.instance.Mc(new Rf));
Type.registerNamespace("Common.App.O365Shell");rc.main();Type.registerNamespace("Common.App.PhoneLink");xe.main();Type.registerNamespace("Common.App.SensitiveLogging");Wh.main();Type.registerNamespace("Common.App.Rename");K.a.instance.Mc(new Zh,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");K.a.instance.Mc(new dh);Type.registerNamespace("Common.App.SaveAsToHost");tg.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Xf.main();Type.registerNamespace("Common.App.SaveACopy");
Ti.main();Type.registerNamespace("Common.App.SaveToSharePoint");ug.main();Type.registerNamespace("Common.App.SharedFilePicker");nf.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");fc.main();Xd;K.a.instance.Mc(new bs);fp.main();up;Pd.main();K.a.instance.Mc(new Gn);Js.main();Ge.a.prototype.toString=qg.a.prototype.toString;
Ui.a.ELi=new Qh.a;K.a.instance.Mc(new rp);Tt.main();K.a.instance.Mc(new Vo);K.a.instance.Mc(new ai);K.a.instance.Mc(new pc);Pc.main();Mn.main();hj.main();Type.registerNamespace("NLRT");K.a.instance.Mc(new dc);Type.registerNamespace("Common.App.AccessibilitySettings");E.main();Type.registerNamespace("Common.App.RibbonSettings");Gi.main();K.a.instance.Mc(new Ae);Em.main();bm.main();gi.main();gq.main();ao.main();window.EventTiming={EventTimingMeter:Jc,FrameTimingMeter:Tc}},2166:function(I,J,d){function m(u,
v,F){return{name:u,dataType:0,value:v,classification:F?F:4}}function f(u,v,F,y,G){void 0===G&&(G=4);y&&u.push(m("".concat(v?v+"."+F:F),y,G))}function a(u,v,F,y){if("boolean"===typeof y){var G=u.push;v="".concat(v?v+"."+F:F);G.call(u,{name:v,dataType:1,value:y,classification:4})}}d.d(J,"a",function(){return z});var l;(function(u){u.Web="Web";u.Desktop="Desktop";u.Universal="Universal";u.Mobile="Mobile";u.Win32="Win32";u.iOS="iOS";u.Android="Android"})(l||(l={}));var w;(function(u){u.Automation="Automation";
u.Dogfood="Dogfood";u.Microsoft="Microsoft";u.Insiders="Insiders";u.Production="Production"})(w||(w={}));var z;(function(u){(function(v){v.IsEnabled="IsEnabled";v.IsSeen="IsSeen";v.IsTried="IsTried";v.IsKept="IsKept";v.IsRejected="IsRejected"})(u.wgb||(u.wgb={}));(function(v){v.ContentGeneration="Content Generation";v.Commanding="Commanding";v.QAandSummaries="QA and Summaries";v.Collaboration="Collaboration";v.Suggestions="Suggestions"})(u.oCc||(u.oCc={}));(function(v){v.Chat="Chat";v.Canvas="Canvas"})(u.EntryPoint||
(u.EntryPoint={}));u.getFields=function(v){var F=[];f(F,"Copilot","FeatureActionType",v.yic);a(F,"Copilot","IsUserInitiated",v.isUserInitiated);f(F,"Copilot","FeatureName",v.featureName);f(F,"Copilot","SubFeatureName",v.xpq);f(F,"Copilot","Capability",v.Unf);a(F,"Copilot","IsThumbsUp",v.O1f);f(F,"Copilot","EntryPoint",v.entryPoint);F.push(m("zC.".concat("Copilot"),"Office.System.Copilot"));return F}})(z||(z={}));var x;(function(u){(function(v){v.Pillar="Pillar";v.Error="Error"})(u.EventType||(u.EventType=
{}));u.getFields=function(v){var F=[];f(F,"Asha","EventType",v.eventType);f(F,"Asha","Pillar",v.Kdo);f(F,"Asha","Scenario",v.scenario);f(F,"Asha","Veto",v.GBc);f(F,"Asha","Error",v.error);a(F,"Asha","InStaging",v.inStaging);a(F,"Asha","IsSessionEndingError",v.isSessionEndingError);a(F,"Asha","IsIntentional",v.isIntentional);a(F,"Asha","IsInternal",v.isInternal);F.push(m("zC.".concat("Asha"),"Office.System.Asha"));return F}})(x||(x={}))}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/22809443/wdjs/WordEditorDSReduceInitialBundle.box4.dll2.js.map